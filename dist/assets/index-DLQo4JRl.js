var b3=Object.defineProperty;var w3=(n,r,s)=>r in n?b3(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s;var t_=(n,r,s)=>w3(n,typeof r!="symbol"?r+"":r,s);function rA(n,r){for(var s=0;s<r.length;s++){const u=r[s];if(typeof u!="string"&&!Array.isArray(u)){for(const m in u)if(m!=="default"&&!(m in n)){const y=Object.getOwnPropertyDescriptor(u,m);y&&Object.defineProperty(n,m,y.get?y:{enumerable:!0,get:()=>u[m]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))u(m);new MutationObserver(m=>{for(const y of m)if(y.type==="childList")for(const T of y.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&u(T)}).observe(document,{childList:!0,subtree:!0});function s(m){const y={};return m.integrity&&(y.integrity=m.integrity),m.referrerPolicy&&(y.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?y.credentials="include":m.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function u(m){if(m.ep)return;m.ep=!0;const y=s(m);fetch(m.href,y)}})();var vp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Uf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function iA(n){if(n.__esModule)return n;var r=n.default;if(typeof r=="function"){var s=function u(){return this instanceof u?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};s.prototype=r.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(n).forEach(function(u){var m=Object.getOwnPropertyDescriptor(n,u);Object.defineProperty(s,u,m.get?m:{enumerable:!0,get:function(){return n[u]}})}),s}var X0={exports:{}},n_={},Y0={exports:{}},pi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gE;function S3(){if(gE)return pi;gE=1;var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),T=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),F=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),G=Symbol.iterator;function J(nt){return nt===null||typeof nt!="object"?null:(nt=G&&nt[G]||nt["@@iterator"],typeof nt=="function"?nt:null)}var te={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,j={};function ne(nt,Rt,Nt){this.props=nt,this.context=Rt,this.refs=j,this.updater=Nt||te}ne.prototype.isReactComponent={},ne.prototype.setState=function(nt,Rt){if(typeof nt!="object"&&typeof nt!="function"&&nt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,nt,Rt,"setState")},ne.prototype.forceUpdate=function(nt){this.updater.enqueueForceUpdate(this,nt,"forceUpdate")};function oe(){}oe.prototype=ne.prototype;function pe(nt,Rt,Nt){this.props=nt,this.context=Rt,this.refs=j,this.updater=Nt||te}var se=pe.prototype=new oe;se.constructor=pe,H(se,ne.prototype),se.isPureReactComponent=!0;var ie=Array.isArray,ce=Object.prototype.hasOwnProperty,we={current:null},xe={key:!0,ref:!0,__self:!0,__source:!0};function $e(nt,Rt,Nt){var gn,Mt={},$t=null,Ut=null;if(Rt!=null)for(gn in Rt.ref!==void 0&&(Ut=Rt.ref),Rt.key!==void 0&&($t=""+Rt.key),Rt)ce.call(Rt,gn)&&!xe.hasOwnProperty(gn)&&(Mt[gn]=Rt[gn]);var hn=arguments.length-2;if(hn===1)Mt.children=Nt;else if(1<hn){for(var xn=Array(hn),Le=0;Le<hn;Le++)xn[Le]=arguments[Le+2];Mt.children=xn}if(nt&&nt.defaultProps)for(gn in hn=nt.defaultProps,hn)Mt[gn]===void 0&&(Mt[gn]=hn[gn]);return{$$typeof:n,type:nt,key:$t,ref:Ut,props:Mt,_owner:we.current}}function Ze(nt,Rt){return{$$typeof:n,type:nt.type,key:Rt,ref:nt.ref,props:nt.props,_owner:nt._owner}}function ae(nt){return typeof nt=="object"&&nt!==null&&nt.$$typeof===n}function ke(nt){var Rt={"=":"=0",":":"=2"};return"$"+nt.replace(/[=:]/g,function(Nt){return Rt[Nt]})}var ct=/\/+/g;function Xe(nt,Rt){return typeof nt=="object"&&nt!==null&&nt.key!=null?ke(""+nt.key):Rt.toString(36)}function st(nt,Rt,Nt,gn,Mt){var $t=typeof nt;($t==="undefined"||$t==="boolean")&&(nt=null);var Ut=!1;if(nt===null)Ut=!0;else switch($t){case"string":case"number":Ut=!0;break;case"object":switch(nt.$$typeof){case n:case r:Ut=!0}}if(Ut)return Ut=nt,Mt=Mt(Ut),nt=gn===""?"."+Xe(Ut,0):gn,ie(Mt)?(Nt="",nt!=null&&(Nt=nt.replace(ct,"$&/")+"/"),st(Mt,Rt,Nt,"",function(Le){return Le})):Mt!=null&&(ae(Mt)&&(Mt=Ze(Mt,Nt+(!Mt.key||Ut&&Ut.key===Mt.key?"":(""+Mt.key).replace(ct,"$&/")+"/")+nt)),Rt.push(Mt)),1;if(Ut=0,gn=gn===""?".":gn+":",ie(nt))for(var hn=0;hn<nt.length;hn++){$t=nt[hn];var xn=gn+Xe($t,hn);Ut+=st($t,Rt,Nt,xn,Mt)}else if(xn=J(nt),typeof xn=="function")for(nt=xn.call(nt),hn=0;!($t=nt.next()).done;)$t=$t.value,xn=gn+Xe($t,hn++),Ut+=st($t,Rt,Nt,xn,Mt);else if($t==="object")throw Rt=String(nt),Error("Objects are not valid as a React child (found: "+(Rt==="[object Object]"?"object with keys {"+Object.keys(nt).join(", ")+"}":Rt)+"). If you meant to render a collection of children, use an array instead.");return Ut}function et(nt,Rt,Nt){if(nt==null)return nt;var gn=[],Mt=0;return st(nt,gn,"","",function($t){return Rt.call(Nt,$t,Mt++)}),gn}function gt(nt){if(nt._status===-1){var Rt=nt._result;Rt=Rt(),Rt.then(function(Nt){(nt._status===0||nt._status===-1)&&(nt._status=1,nt._result=Nt)},function(Nt){(nt._status===0||nt._status===-1)&&(nt._status=2,nt._result=Nt)}),nt._status===-1&&(nt._status=0,nt._result=Rt)}if(nt._status===1)return nt._result.default;throw nt._result}var zt={current:null},at={transition:null},Ye={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:at,ReactCurrentOwner:we};function Bt(){throw Error("act(...) is not supported in production builds of React.")}return pi.Children={map:et,forEach:function(nt,Rt,Nt){et(nt,function(){Rt.apply(this,arguments)},Nt)},count:function(nt){var Rt=0;return et(nt,function(){Rt++}),Rt},toArray:function(nt){return et(nt,function(Rt){return Rt})||[]},only:function(nt){if(!ae(nt))throw Error("React.Children.only expected to receive a single React element child.");return nt}},pi.Component=ne,pi.Fragment=s,pi.Profiler=m,pi.PureComponent=pe,pi.StrictMode=u,pi.Suspense=I,pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ye,pi.act=Bt,pi.cloneElement=function(nt,Rt,Nt){if(nt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+nt+".");var gn=H({},nt.props),Mt=nt.key,$t=nt.ref,Ut=nt._owner;if(Rt!=null){if(Rt.ref!==void 0&&($t=Rt.ref,Ut=we.current),Rt.key!==void 0&&(Mt=""+Rt.key),nt.type&&nt.type.defaultProps)var hn=nt.type.defaultProps;for(xn in Rt)ce.call(Rt,xn)&&!xe.hasOwnProperty(xn)&&(gn[xn]=Rt[xn]===void 0&&hn!==void 0?hn[xn]:Rt[xn])}var xn=arguments.length-2;if(xn===1)gn.children=Nt;else if(1<xn){hn=Array(xn);for(var Le=0;Le<xn;Le++)hn[Le]=arguments[Le+2];gn.children=hn}return{$$typeof:n,type:nt.type,key:Mt,ref:$t,props:gn,_owner:Ut}},pi.createContext=function(nt){return nt={$$typeof:T,_currentValue:nt,_currentValue2:nt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},nt.Provider={$$typeof:y,_context:nt},nt.Consumer=nt},pi.createElement=$e,pi.createFactory=function(nt){var Rt=$e.bind(null,nt);return Rt.type=nt,Rt},pi.createRef=function(){return{current:null}},pi.forwardRef=function(nt){return{$$typeof:i,render:nt}},pi.isValidElement=ae,pi.lazy=function(nt){return{$$typeof:B,_payload:{_status:-1,_result:nt},_init:gt}},pi.memo=function(nt,Rt){return{$$typeof:F,type:nt,compare:Rt===void 0?null:Rt}},pi.startTransition=function(nt){var Rt=at.transition;at.transition={};try{nt()}finally{at.transition=Rt}},pi.unstable_act=Bt,pi.useCallback=function(nt,Rt){return zt.current.useCallback(nt,Rt)},pi.useContext=function(nt){return zt.current.useContext(nt)},pi.useDebugValue=function(){},pi.useDeferredValue=function(nt){return zt.current.useDeferredValue(nt)},pi.useEffect=function(nt,Rt){return zt.current.useEffect(nt,Rt)},pi.useId=function(){return zt.current.useId()},pi.useImperativeHandle=function(nt,Rt,Nt){return zt.current.useImperativeHandle(nt,Rt,Nt)},pi.useInsertionEffect=function(nt,Rt){return zt.current.useInsertionEffect(nt,Rt)},pi.useLayoutEffect=function(nt,Rt){return zt.current.useLayoutEffect(nt,Rt)},pi.useMemo=function(nt,Rt){return zt.current.useMemo(nt,Rt)},pi.useReducer=function(nt,Rt,Nt){return zt.current.useReducer(nt,Rt,Nt)},pi.useRef=function(nt){return zt.current.useRef(nt)},pi.useState=function(nt){return zt.current.useState(nt)},pi.useSyncExternalStore=function(nt,Rt,Nt){return zt.current.useSyncExternalStore(nt,Rt,Nt)},pi.useTransition=function(){return zt.current.useTransition()},pi.version="18.3.1",pi}var _E;function uw(){return _E||(_E=1,Y0.exports=S3()),Y0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yE;function T3(){if(yE)return n_;yE=1;var n=uw(),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,m=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function T(i,I,F){var B,G={},J=null,te=null;F!==void 0&&(J=""+F),I.key!==void 0&&(J=""+I.key),I.ref!==void 0&&(te=I.ref);for(B in I)u.call(I,B)&&!y.hasOwnProperty(B)&&(G[B]=I[B]);if(i&&i.defaultProps)for(B in I=i.defaultProps,I)G[B]===void 0&&(G[B]=I[B]);return{$$typeof:r,type:i,key:J,ref:te,props:G,_owner:m.current}}return n_.Fragment=s,n_.jsx=T,n_.jsxs=T,n_}var vE;function E3(){return vE||(vE=1,X0.exports=T3()),X0.exports}var _e=E3(),rv={},K0={exports:{}},tl={},J0={exports:{}},Q0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xE;function C3(){return xE||(xE=1,function(n){function r(at,Ye){var Bt=at.length;at.push(Ye);e:for(;0<Bt;){var nt=Bt-1>>>1,Rt=at[nt];if(0<m(Rt,Ye))at[nt]=Ye,at[Bt]=Rt,Bt=nt;else break e}}function s(at){return at.length===0?null:at[0]}function u(at){if(at.length===0)return null;var Ye=at[0],Bt=at.pop();if(Bt!==Ye){at[0]=Bt;e:for(var nt=0,Rt=at.length,Nt=Rt>>>1;nt<Nt;){var gn=2*(nt+1)-1,Mt=at[gn],$t=gn+1,Ut=at[$t];if(0>m(Mt,Bt))$t<Rt&&0>m(Ut,Mt)?(at[nt]=Ut,at[$t]=Bt,nt=$t):(at[nt]=Mt,at[gn]=Bt,nt=gn);else if($t<Rt&&0>m(Ut,Bt))at[nt]=Ut,at[$t]=Bt,nt=$t;else break e}}return Ye}function m(at,Ye){var Bt=at.sortIndex-Ye.sortIndex;return Bt!==0?Bt:at.id-Ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;n.unstable_now=function(){return y.now()}}else{var T=Date,i=T.now();n.unstable_now=function(){return T.now()-i}}var I=[],F=[],B=1,G=null,J=3,te=!1,H=!1,j=!1,ne=typeof setTimeout=="function"?setTimeout:null,oe=typeof clearTimeout=="function"?clearTimeout:null,pe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(at){for(var Ye=s(F);Ye!==null;){if(Ye.callback===null)u(F);else if(Ye.startTime<=at)u(F),Ye.sortIndex=Ye.expirationTime,r(I,Ye);else break;Ye=s(F)}}function ie(at){if(j=!1,se(at),!H)if(s(I)!==null)H=!0,gt(ce);else{var Ye=s(F);Ye!==null&&zt(ie,Ye.startTime-at)}}function ce(at,Ye){H=!1,j&&(j=!1,oe($e),$e=-1),te=!0;var Bt=J;try{for(se(Ye),G=s(I);G!==null&&(!(G.expirationTime>Ye)||at&&!ke());){var nt=G.callback;if(typeof nt=="function"){G.callback=null,J=G.priorityLevel;var Rt=nt(G.expirationTime<=Ye);Ye=n.unstable_now(),typeof Rt=="function"?G.callback=Rt:G===s(I)&&u(I),se(Ye)}else u(I);G=s(I)}if(G!==null)var Nt=!0;else{var gn=s(F);gn!==null&&zt(ie,gn.startTime-Ye),Nt=!1}return Nt}finally{G=null,J=Bt,te=!1}}var we=!1,xe=null,$e=-1,Ze=5,ae=-1;function ke(){return!(n.unstable_now()-ae<Ze)}function ct(){if(xe!==null){var at=n.unstable_now();ae=at;var Ye=!0;try{Ye=xe(!0,at)}finally{Ye?Xe():(we=!1,xe=null)}}else we=!1}var Xe;if(typeof pe=="function")Xe=function(){pe(ct)};else if(typeof MessageChannel<"u"){var st=new MessageChannel,et=st.port2;st.port1.onmessage=ct,Xe=function(){et.postMessage(null)}}else Xe=function(){ne(ct,0)};function gt(at){xe=at,we||(we=!0,Xe())}function zt(at,Ye){$e=ne(function(){at(n.unstable_now())},Ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(at){at.callback=null},n.unstable_continueExecution=function(){H||te||(H=!0,gt(ce))},n.unstable_forceFrameRate=function(at){0>at||125<at?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ze=0<at?Math.floor(1e3/at):5},n.unstable_getCurrentPriorityLevel=function(){return J},n.unstable_getFirstCallbackNode=function(){return s(I)},n.unstable_next=function(at){switch(J){case 1:case 2:case 3:var Ye=3;break;default:Ye=J}var Bt=J;J=Ye;try{return at()}finally{J=Bt}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(at,Ye){switch(at){case 1:case 2:case 3:case 4:case 5:break;default:at=3}var Bt=J;J=at;try{return Ye()}finally{J=Bt}},n.unstable_scheduleCallback=function(at,Ye,Bt){var nt=n.unstable_now();switch(typeof Bt=="object"&&Bt!==null?(Bt=Bt.delay,Bt=typeof Bt=="number"&&0<Bt?nt+Bt:nt):Bt=nt,at){case 1:var Rt=-1;break;case 2:Rt=250;break;case 5:Rt=1073741823;break;case 4:Rt=1e4;break;default:Rt=5e3}return Rt=Bt+Rt,at={id:B++,callback:Ye,priorityLevel:at,startTime:Bt,expirationTime:Rt,sortIndex:-1},Bt>nt?(at.sortIndex=Bt,r(F,at),s(I)===null&&at===s(F)&&(j?(oe($e),$e=-1):j=!0,zt(ie,Bt-nt))):(at.sortIndex=Rt,r(I,at),H||te||(H=!0,gt(ce))),at},n.unstable_shouldYield=ke,n.unstable_wrapCallback=function(at){var Ye=J;return function(){var Bt=J;J=Ye;try{return at.apply(this,arguments)}finally{J=Bt}}}}(Q0)),Q0}var bE;function M3(){return bE||(bE=1,J0.exports=C3()),J0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wE;function I3(){if(wE)return tl;wE=1;var n=uw(),r=M3();function s(_){for(var x="https://reactjs.org/docs/error-decoder.html?invariant="+_,z=1;z<arguments.length;z++)x+="&args[]="+encodeURIComponent(arguments[z]);return"Minified React error #"+_+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,m={};function y(_,x){T(_,x),T(_+"Capture",x)}function T(_,x){for(m[_]=x,_=0;_<x.length;_++)u.add(x[_])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),I=Object.prototype.hasOwnProperty,F=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B={},G={};function J(_){return I.call(G,_)?!0:I.call(B,_)?!1:F.test(_)?G[_]=!0:(B[_]=!0,!1)}function te(_,x,z,U){if(z!==null&&z.type===0)return!1;switch(typeof x){case"function":case"symbol":return!0;case"boolean":return U?!1:z!==null?!z.acceptsBooleans:(_=_.toLowerCase().slice(0,5),_!=="data-"&&_!=="aria-");default:return!1}}function H(_,x,z,U){if(x===null||typeof x>"u"||te(_,x,z,U))return!0;if(U)return!1;if(z!==null)switch(z.type){case 3:return!x;case 4:return x===!1;case 5:return isNaN(x);case 6:return isNaN(x)||1>x}return!1}function j(_,x,z,U,ee,le,Ie){this.acceptsBooleans=x===2||x===3||x===4,this.attributeName=U,this.attributeNamespace=ee,this.mustUseProperty=z,this.propertyName=_,this.type=x,this.sanitizeURL=le,this.removeEmptyString=Ie}var ne={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){ne[_]=new j(_,0,!1,_,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var x=_[0];ne[x]=new j(x,1,!1,_[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(_){ne[_]=new j(_,2,!1,_.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){ne[_]=new j(_,2,!1,_,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){ne[_]=new j(_,3,!1,_.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(_){ne[_]=new j(_,3,!0,_,null,!1,!1)}),["capture","download"].forEach(function(_){ne[_]=new j(_,4,!1,_,null,!1,!1)}),["cols","rows","size","span"].forEach(function(_){ne[_]=new j(_,6,!1,_,null,!1,!1)}),["rowSpan","start"].forEach(function(_){ne[_]=new j(_,5,!1,_.toLowerCase(),null,!1,!1)});var oe=/[\-:]([a-z])/g;function pe(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var x=_.replace(oe,pe);ne[x]=new j(x,1,!1,_,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var x=_.replace(oe,pe);ne[x]=new j(x,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(_){var x=_.replace(oe,pe);ne[x]=new j(x,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(_){ne[_]=new j(_,1,!1,_.toLowerCase(),null,!1,!1)}),ne.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(_){ne[_]=new j(_,1,!1,_.toLowerCase(),null,!0,!0)});function se(_,x,z,U){var ee=ne.hasOwnProperty(x)?ne[x]:null;(ee!==null?ee.type!==0:U||!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(H(x,z,ee,U)&&(z=null),U||ee===null?J(x)&&(z===null?_.removeAttribute(x):_.setAttribute(x,""+z)):ee.mustUseProperty?_[ee.propertyName]=z===null?ee.type===3?!1:"":z:(x=ee.attributeName,U=ee.attributeNamespace,z===null?_.removeAttribute(x):(ee=ee.type,z=ee===3||ee===4&&z===!0?"":""+z,U?_.setAttributeNS(U,x,z):_.setAttribute(x,z))))}var ie=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ce=Symbol.for("react.element"),we=Symbol.for("react.portal"),xe=Symbol.for("react.fragment"),$e=Symbol.for("react.strict_mode"),Ze=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),ke=Symbol.for("react.context"),ct=Symbol.for("react.forward_ref"),Xe=Symbol.for("react.suspense"),st=Symbol.for("react.suspense_list"),et=Symbol.for("react.memo"),gt=Symbol.for("react.lazy"),zt=Symbol.for("react.offscreen"),at=Symbol.iterator;function Ye(_){return _===null||typeof _!="object"?null:(_=at&&_[at]||_["@@iterator"],typeof _=="function"?_:null)}var Bt=Object.assign,nt;function Rt(_){if(nt===void 0)try{throw Error()}catch(z){var x=z.stack.trim().match(/\n( *(at )?)/);nt=x&&x[1]||""}return`
`+nt+_}var Nt=!1;function gn(_,x){if(!_||Nt)return"";Nt=!0;var z=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(x)if(x=function(){throw Error()},Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(Vt){var U=Vt}Reflect.construct(_,[],x)}else{try{x.call()}catch(Vt){U=Vt}_.call(x.prototype)}else{try{throw Error()}catch(Vt){U=Vt}_()}}catch(Vt){if(Vt&&U&&typeof Vt.stack=="string"){for(var ee=Vt.stack.split(`
`),le=U.stack.split(`
`),Ie=ee.length-1,lt=le.length-1;1<=Ie&&0<=lt&&ee[Ie]!==le[lt];)lt--;for(;1<=Ie&&0<=lt;Ie--,lt--)if(ee[Ie]!==le[lt]){if(Ie!==1||lt!==1)do if(Ie--,lt--,0>lt||ee[Ie]!==le[lt]){var vt=`
`+ee[Ie].replace(" at new "," at ");return _.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",_.displayName)),vt}while(1<=Ie&&0<=lt);break}}}finally{Nt=!1,Error.prepareStackTrace=z}return(_=_?_.displayName||_.name:"")?Rt(_):""}function Mt(_){switch(_.tag){case 5:return Rt(_.type);case 16:return Rt("Lazy");case 13:return Rt("Suspense");case 19:return Rt("SuspenseList");case 0:case 2:case 15:return _=gn(_.type,!1),_;case 11:return _=gn(_.type.render,!1),_;case 1:return _=gn(_.type,!0),_;default:return""}}function $t(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case xe:return"Fragment";case we:return"Portal";case Ze:return"Profiler";case $e:return"StrictMode";case Xe:return"Suspense";case st:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case ke:return(_.displayName||"Context")+".Consumer";case ae:return(_._context.displayName||"Context")+".Provider";case ct:var x=_.render;return _=_.displayName,_||(_=x.displayName||x.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case et:return x=_.displayName||null,x!==null?x:$t(_.type)||"Memo";case gt:x=_._payload,_=_._init;try{return $t(_(x))}catch{}}return null}function Ut(_){var x=_.type;switch(_.tag){case 24:return"Cache";case 9:return(x.displayName||"Context")+".Consumer";case 10:return(x._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=x.render,_=_.displayName||_.name||"",x.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return x;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $t(x);case 8:return x===$e?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x}return null}function hn(_){switch(typeof _){case"boolean":case"number":case"string":case"undefined":return _;case"object":return _;default:return""}}function xn(_){var x=_.type;return(_=_.nodeName)&&_.toLowerCase()==="input"&&(x==="checkbox"||x==="radio")}function Le(_){var x=xn(_)?"checked":"value",z=Object.getOwnPropertyDescriptor(_.constructor.prototype,x),U=""+_[x];if(!_.hasOwnProperty(x)&&typeof z<"u"&&typeof z.get=="function"&&typeof z.set=="function"){var ee=z.get,le=z.set;return Object.defineProperty(_,x,{configurable:!0,get:function(){return ee.call(this)},set:function(Ie){U=""+Ie,le.call(this,Ie)}}),Object.defineProperty(_,x,{enumerable:z.enumerable}),{getValue:function(){return U},setValue:function(Ie){U=""+Ie},stopTracking:function(){_._valueTracker=null,delete _[x]}}}}function Dn(_){_._valueTracker||(_._valueTracker=Le(_))}function pn(_){if(!_)return!1;var x=_._valueTracker;if(!x)return!0;var z=x.getValue(),U="";return _&&(U=xn(_)?_.checked?"true":"false":_.value),_=U,_!==z?(x.setValue(_),!0):!1}function zn(_){if(_=_||(typeof document<"u"?document:void 0),typeof _>"u")return null;try{return _.activeElement||_.body}catch{return _.body}}function _t(_,x){var z=x.checked;return Bt({},x,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:z??_._wrapperState.initialChecked})}function er(_,x){var z=x.defaultValue==null?"":x.defaultValue,U=x.checked!=null?x.checked:x.defaultChecked;z=hn(x.value!=null?x.value:z),_._wrapperState={initialChecked:U,initialValue:z,controlled:x.type==="checkbox"||x.type==="radio"?x.checked!=null:x.value!=null}}function pr(_,x){x=x.checked,x!=null&&se(_,"checked",x,!1)}function qn(_,x){pr(_,x);var z=hn(x.value),U=x.type;if(z!=null)U==="number"?(z===0&&_.value===""||_.value!=z)&&(_.value=""+z):_.value!==""+z&&(_.value=""+z);else if(U==="submit"||U==="reset"){_.removeAttribute("value");return}x.hasOwnProperty("value")?ir(_,x.type,z):x.hasOwnProperty("defaultValue")&&ir(_,x.type,hn(x.defaultValue)),x.checked==null&&x.defaultChecked!=null&&(_.defaultChecked=!!x.defaultChecked)}function _n(_,x,z){if(x.hasOwnProperty("value")||x.hasOwnProperty("defaultValue")){var U=x.type;if(!(U!=="submit"&&U!=="reset"||x.value!==void 0&&x.value!==null))return;x=""+_._wrapperState.initialValue,z||x===_.value||(_.value=x),_.defaultValue=x}z=_.name,z!==""&&(_.name=""),_.defaultChecked=!!_._wrapperState.initialChecked,z!==""&&(_.name=z)}function ir(_,x,z){(x!=="number"||zn(_.ownerDocument)!==_)&&(z==null?_.defaultValue=""+_._wrapperState.initialValue:_.defaultValue!==""+z&&(_.defaultValue=""+z))}var cr=Array.isArray;function Er(_,x,z,U){if(_=_.options,x){x={};for(var ee=0;ee<z.length;ee++)x["$"+z[ee]]=!0;for(z=0;z<_.length;z++)ee=x.hasOwnProperty("$"+_[z].value),_[z].selected!==ee&&(_[z].selected=ee),ee&&U&&(_[z].defaultSelected=!0)}else{for(z=""+hn(z),x=null,ee=0;ee<_.length;ee++){if(_[ee].value===z){_[ee].selected=!0,U&&(_[ee].defaultSelected=!0);return}x!==null||_[ee].disabled||(x=_[ee])}x!==null&&(x.selected=!0)}}function On(_,x){if(x.dangerouslySetInnerHTML!=null)throw Error(s(91));return Bt({},x,{value:void 0,defaultValue:void 0,children:""+_._wrapperState.initialValue})}function fi(_,x){var z=x.value;if(z==null){if(z=x.children,x=x.defaultValue,z!=null){if(x!=null)throw Error(s(92));if(cr(z)){if(1<z.length)throw Error(s(93));z=z[0]}x=z}x==null&&(x=""),z=x}_._wrapperState={initialValue:hn(z)}}function Dt(_,x){var z=hn(x.value),U=hn(x.defaultValue);z!=null&&(z=""+z,z!==_.value&&(_.value=z),x.defaultValue==null&&_.defaultValue!==z&&(_.defaultValue=z)),U!=null&&(_.defaultValue=""+U)}function Ft(_){var x=_.textContent;x===_._wrapperState.initialValue&&x!==""&&x!==null&&(_.value=x)}function sn(_){switch(_){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tn(_,x){return _==null||_==="http://www.w3.org/1999/xhtml"?sn(x):_==="http://www.w3.org/2000/svg"&&x==="foreignObject"?"http://www.w3.org/1999/xhtml":_}var Pn,ur=function(_){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(x,z,U,ee){MSApp.execUnsafeLocalFunction(function(){return _(x,z,U,ee)})}:_}(function(_,x){if(_.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _)_.innerHTML=x;else{for(Pn=Pn||document.createElement("div"),Pn.innerHTML="<svg>"+x.valueOf().toString()+"</svg>",x=Pn.firstChild;_.firstChild;)_.removeChild(_.firstChild);for(;x.firstChild;)_.appendChild(x.firstChild)}});function Bn(_,x){if(x){var z=_.firstChild;if(z&&z===_.lastChild&&z.nodeType===3){z.nodeValue=x;return}}_.textContent=x}var Hn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zr=["Webkit","ms","Moz","O"];Object.keys(Hn).forEach(function(_){Zr.forEach(function(x){x=x+_.charAt(0).toUpperCase()+_.substring(1),Hn[x]=Hn[_]})});function Lr(_,x,z){return x==null||typeof x=="boolean"||x===""?"":z||typeof x!="number"||x===0||Hn.hasOwnProperty(_)&&Hn[_]?(""+x).trim():x+"px"}function qr(_,x){_=_.style;for(var z in x)if(x.hasOwnProperty(z)){var U=z.indexOf("--")===0,ee=Lr(z,x[z],U);z==="float"&&(z="cssFloat"),U?_.setProperty(z,ee):_[z]=ee}}var Yn=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ar(_,x){if(x){if(Yn[_]&&(x.children!=null||x.dangerouslySetInnerHTML!=null))throw Error(s(137,_));if(x.dangerouslySetInnerHTML!=null){if(x.children!=null)throw Error(s(60));if(typeof x.dangerouslySetInnerHTML!="object"||!("__html"in x.dangerouslySetInnerHTML))throw Error(s(61))}if(x.style!=null&&typeof x.style!="object")throw Error(s(62))}}function si(_,x){if(_.indexOf("-")===-1)return typeof x.is=="string";switch(_){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $n=null;function Zi(_){return _=_.target||_.srcElement||window,_.correspondingUseElement&&(_=_.correspondingUseElement),_.nodeType===3?_.parentNode:_}var ra=null,Wi=null,ai=null;function Fi(_){if(_=ec(_)){if(typeof ra!="function")throw Error(s(280));var x=_.stateNode;x&&(x=Lu(x),ra(_.stateNode,_.type,x))}}function ia(_){Wi?ai?ai.push(_):ai=[_]:Wi=_}function vs(){if(Wi){var _=Wi,x=ai;if(ai=Wi=null,Fi(_),x)for(_=0;_<x.length;_++)Fi(x[_])}}function Do(_,x){return _(x)}function ht(){}var ge=!1;function be(_,x,z){if(ge)return _(x,z);ge=!0;try{return Do(_,x,z)}finally{ge=!1,(Wi!==null||ai!==null)&&(ht(),vs())}}function Re(_,x){var z=_.stateNode;if(z===null)return null;var U=Lu(z);if(U===null)return null;z=U[x];e:switch(x){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(U=!U.disabled)||(_=_.type,U=!(_==="button"||_==="input"||_==="select"||_==="textarea")),_=!U;break e;default:_=!1}if(_)return null;if(z&&typeof z!="function")throw Error(s(231,x,typeof z));return z}var qe=!1;if(i)try{var We={};Object.defineProperty(We,"passive",{get:function(){qe=!0}}),window.addEventListener("test",We,We),window.removeEventListener("test",We,We)}catch{qe=!1}function tt(_,x,z,U,ee,le,Ie,lt,vt){var Vt=Array.prototype.slice.call(arguments,3);try{x.apply(z,Vt)}catch(yn){this.onError(yn)}}var mt=!1,it=null,yt=!1,bt=null,Et={onError:function(_){mt=!0,it=_}};function Xt(_,x,z,U,ee,le,Ie,lt,vt){mt=!1,it=null,tt.apply(Et,arguments)}function un(_,x,z,U,ee,le,Ie,lt,vt){if(Xt.apply(this,arguments),mt){if(mt){var Vt=it;mt=!1,it=null}else throw Error(s(198));yt||(yt=!0,bt=Vt)}}function an(_){var x=_,z=_;if(_.alternate)for(;x.return;)x=x.return;else{_=x;do x=_,x.flags&4098&&(z=x.return),_=x.return;while(_)}return x.tag===3?z:null}function Vn(_){if(_.tag===13){var x=_.memoizedState;if(x===null&&(_=_.alternate,_!==null&&(x=_.memoizedState)),x!==null)return x.dehydrated}return null}function tr(_){if(an(_)!==_)throw Error(s(188))}function Kn(_){var x=_.alternate;if(!x){if(x=an(_),x===null)throw Error(s(188));return x!==_?null:_}for(var z=_,U=x;;){var ee=z.return;if(ee===null)break;var le=ee.alternate;if(le===null){if(U=ee.return,U!==null){z=U;continue}break}if(ee.child===le.child){for(le=ee.child;le;){if(le===z)return tr(ee),_;if(le===U)return tr(ee),x;le=le.sibling}throw Error(s(188))}if(z.return!==U.return)z=ee,U=le;else{for(var Ie=!1,lt=ee.child;lt;){if(lt===z){Ie=!0,z=ee,U=le;break}if(lt===U){Ie=!0,U=ee,z=le;break}lt=lt.sibling}if(!Ie){for(lt=le.child;lt;){if(lt===z){Ie=!0,z=le,U=ee;break}if(lt===U){Ie=!0,U=le,z=ee;break}lt=lt.sibling}if(!Ie)throw Error(s(189))}}if(z.alternate!==U)throw Error(s(190))}if(z.tag!==3)throw Error(s(188));return z.stateNode.current===z?_:x}function Xn(_){return _=Kn(_),_!==null?Wr(_):null}function Wr(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var x=Wr(_);if(x!==null)return x;_=_.sibling}return null}var Nr=r.unstable_scheduleCallback,wr=r.unstable_cancelCallback,Hr=r.unstable_shouldYield,Xr=r.unstable_requestPaint,Vr=r.unstable_now,Yo=r.unstable_getCurrentPriorityLevel,no=r.unstable_ImmediatePriority,go=r.unstable_UserBlockingPriority,Aa=r.unstable_NormalPriority,Pa=r.unstable_LowPriority,lh=r.unstable_IdlePriority,Mc=null,Ko=null;function ch(_){if(Ko&&typeof Ko.onCommitFiberRoot=="function")try{Ko.onCommitFiberRoot(Mc,_,void 0,(_.current.flags&128)===128)}catch{}}var Jo=Math.clz32?Math.clz32:Pp,ll=Math.log,Ic=Math.LN2;function Pp(_){return _>>>=0,_===0?32:31-(ll(_)/Ic|0)|0}var dd=64,Ac=4194304;function cl(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function Pc(_,x){var z=_.pendingLanes;if(z===0)return 0;var U=0,ee=_.suspendedLanes,le=_.pingedLanes,Ie=z&268435455;if(Ie!==0){var lt=Ie&~ee;lt!==0?U=cl(lt):(le&=Ie,le!==0&&(U=cl(le)))}else Ie=z&~ee,Ie!==0?U=cl(Ie):le!==0&&(U=cl(le));if(U===0)return 0;if(x!==0&&x!==U&&!(x&ee)&&(ee=U&-U,le=x&-x,ee>=le||ee===16&&(le&4194240)!==0))return x;if(U&4&&(U|=z&16),x=_.entangledLanes,x!==0)for(_=_.entanglements,x&=U;0<x;)z=31-Jo(x),ee=1<<z,U|=_[z],x&=~ee;return U}function Rp(_,x){switch(_){case 1:case 2:case 4:return x+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ls(_,x){for(var z=_.suspendedLanes,U=_.pingedLanes,ee=_.expirationTimes,le=_.pendingLanes;0<le;){var Ie=31-Jo(le),lt=1<<Ie,vt=ee[Ie];vt===-1?(!(lt&z)||lt&U)&&(ee[Ie]=Rp(lt,x)):vt<=x&&(_.expiredLanes|=lt),le&=~lt}}function zs(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function Ds(){var _=dd;return dd<<=1,!(dd&4194240)&&(dd=64),_}function Os(_){for(var x=[],z=0;31>z;z++)x.push(_);return x}function Fs(_,x,z){_.pendingLanes|=x,x!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,x=31-Jo(x),_[x]=z}function uh(_,x){var z=_.pendingLanes&~x;_.pendingLanes=x,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=x,_.mutableReadLanes&=x,_.entangledLanes&=x,x=_.entanglements;var U=_.eventTimes;for(_=_.expirationTimes;0<z;){var ee=31-Jo(z),le=1<<ee;x[ee]=0,U[ee]=-1,_[ee]=-1,z&=~le}}function Rc(_,x){var z=_.entangledLanes|=x;for(_=_.entanglements;z;){var U=31-Jo(z),ee=1<<U;ee&x|_[U]&x&&(_[U]|=x),z&=~ee}}var ri=0;function ul(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var hd,pd,kc,Bs,fd,wu=!1,kr=[],Ul=null,Fn=null,Ra=null,Cr=new Map,$l=new Map,bo=[],kp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lc(_,x){switch(_){case"focusin":case"focusout":Ul=null;break;case"dragenter":case"dragleave":Fn=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":Cr.delete(x.pointerId);break;case"gotpointercapture":case"lostpointercapture":$l.delete(x.pointerId)}}function fn(_,x,z,U,ee,le){return _===null||_.nativeEvent!==le?(_={blockedOn:x,domEventName:z,eventSystemFlags:U,nativeEvent:le,targetContainers:[ee]},x!==null&&(x=ec(x),x!==null&&pd(x)),_):(_.eventSystemFlags|=U,x=_.targetContainers,ee!==null&&x.indexOf(ee)===-1&&x.push(ee),_)}function Ur(_,x,z,U,ee){switch(x){case"focusin":return Ul=fn(Ul,_,x,z,U,ee),!0;case"dragenter":return Fn=fn(Fn,_,x,z,U,ee),!0;case"mouseover":return Ra=fn(Ra,_,x,z,U,ee),!0;case"pointerover":var le=ee.pointerId;return Cr.set(le,fn(Cr.get(le)||null,_,x,z,U,ee)),!0;case"gotpointercapture":return le=ee.pointerId,$l.set(le,fn($l.get(le)||null,_,x,z,U,ee)),!0}return!1}function zr(_){var x=xl(_.target);if(x!==null){var z=an(x);if(z!==null){if(x=z.tag,x===13){if(x=Vn(z),x!==null){_.blockedOn=x,fd(_.priority,function(){kc(z)});return}}else if(x===3&&z.stateNode.current.memoizedState.isDehydrated){_.blockedOn=z.tag===3?z.stateNode.containerInfo:null;return}}}_.blockedOn=null}function Uo(_){if(_.blockedOn!==null)return!1;for(var x=_.targetContainers;0<x.length;){var z=ql(_.domEventName,_.eventSystemFlags,x[0],_.nativeEvent);if(z===null){z=_.nativeEvent;var U=new z.constructor(z.type,z);$n=U,z.target.dispatchEvent(U),$n=null}else return x=ec(z),x!==null&&pd(x),_.blockedOn=z,!1;x.shift()}return!0}function Vl(_,x,z){Uo(_)&&z.delete(x)}function Pr(){wu=!1,Ul!==null&&Uo(Ul)&&(Ul=null),Fn!==null&&Uo(Fn)&&(Fn=null),Ra!==null&&Uo(Ra)&&(Ra=null),Cr.forEach(Vl),$l.forEach(Vl)}function Gl(_,x){_.blockedOn===x&&(_.blockedOn=null,wu||(wu=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Pr)))}function Ns(_){function x(ee){return Gl(ee,_)}if(0<kr.length){Gl(kr[0],_);for(var z=1;z<kr.length;z++){var U=kr[z];U.blockedOn===_&&(U.blockedOn=null)}}for(Ul!==null&&Gl(Ul,_),Fn!==null&&Gl(Fn,_),Ra!==null&&Gl(Ra,_),Cr.forEach(x),$l.forEach(x),z=0;z<bo.length;z++)U=bo[z],U.blockedOn===_&&(U.blockedOn=null);for(;0<bo.length&&(z=bo[0],z.blockedOn===null);)zr(z),z.blockedOn===null&&bo.shift()}var oa=ie.ReactCurrentBatchConfig,_o=!0;function ui(_,x,z,U){var ee=ri,le=oa.transition;oa.transition=null;try{ri=1,zc(_,x,z,U)}finally{ri=ee,oa.transition=le}}function Wf(_,x,z,U){var ee=ri,le=oa.transition;oa.transition=null;try{ri=4,zc(_,x,z,U)}finally{ri=ee,oa.transition=le}}function zc(_,x,z,U){if(_o){var ee=ql(_,x,z,U);if(ee===null)Uc(_,x,U,Dc,z),Lc(_,U);else if(Ur(ee,_,x,z,U))U.stopPropagation();else if(Lc(_,U),x&4&&-1<kp.indexOf(_)){for(;ee!==null;){var le=ec(ee);if(le!==null&&hd(le),le=ql(_,x,z,U),le===null&&Uc(_,x,U,Dc,z),le===ee)break;ee=le}ee!==null&&U.stopPropagation()}else Uc(_,x,U,null,z)}}var Dc=null;function ql(_,x,z,U){if(Dc=null,_=Zi(U),_=xl(_),_!==null)if(x=an(_),x===null)_=null;else if(z=x.tag,z===13){if(_=Vn(x),_!==null)return _;_=null}else if(z===3){if(x.stateNode.current.memoizedState.isDehydrated)return x.tag===3?x.stateNode.containerInfo:null;_=null}else x!==_&&(_=null);return Dc=_,null}function md(_){switch(_){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yo()){case no:return 1;case go:return 4;case Aa:case Pa:return 16;case lh:return 536870912;default:return 16}default:return 16}}var sa=null,wo=null,js=null;function lo(){if(js)return js;var _,x=wo,z=x.length,U,ee="value"in sa?sa.value:sa.textContent,le=ee.length;for(_=0;_<z&&x[_]===ee[_];_++);var Ie=z-_;for(U=1;U<=Ie&&x[z-U]===ee[le-U];U++);return js=ee.slice(_,1<U?1-U:void 0)}function ka(_){var x=_.keyCode;return"charCode"in _?(_=_.charCode,_===0&&x===13&&(_=13)):_=x,_===10&&(_=13),32<=_||_===13?_:0}function La(){return!0}function gi(){return!1}function Xi(_){function x(z,U,ee,le,Ie){this._reactName=z,this._targetInst=ee,this.type=U,this.nativeEvent=le,this.target=Ie,this.currentTarget=null;for(var lt in _)_.hasOwnProperty(lt)&&(z=_[lt],this[lt]=z?z(le):le[lt]);return this.isDefaultPrevented=(le.defaultPrevented!=null?le.defaultPrevented:le.returnValue===!1)?La:gi,this.isPropagationStopped=gi,this}return Bt(x.prototype,{preventDefault:function(){this.defaultPrevented=!0;var z=this.nativeEvent;z&&(z.preventDefault?z.preventDefault():typeof z.returnValue!="unknown"&&(z.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var z=this.nativeEvent;z&&(z.stopPropagation?z.stopPropagation():typeof z.cancelBubble!="unknown"&&(z.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),x}var $o={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_){return _.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bi=Xi($o),dl=Bt({},$o,{view:0,detail:0}),aa=Xi(dl),ga,Wl,_a,dh=Bt({},dl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Eu,button:0,buttons:0,relatedTarget:function(_){return _.relatedTarget===void 0?_.fromElement===_.srcElement?_.toElement:_.fromElement:_.relatedTarget},movementX:function(_){return"movementX"in _?_.movementX:(_!==_a&&(_a&&_.type==="mousemove"?(ga=_.screenX-_a.screenX,Wl=_.screenY-_a.screenY):Wl=ga=0,_a=_),ga)},movementY:function(_){return"movementY"in _?_.movementY:Wl}}),za=Xi(dh),Hf=Bt({},dh,{dataTransfer:0}),hh=Xi(Hf),xs=Bt({},dl,{relatedTarget:0}),Su=Xi(xs),ph=Bt({},$o,{animationName:0,elapsedTime:0,pseudoElement:0}),Zf=Xi(ph),gd=Bt({},$o,{clipboardData:function(_){return"clipboardData"in _?_.clipboardData:window.clipboardData}}),gg=Xi(gd),_g=Bt({},$o,{data:0}),Tu=Xi(_g),_d={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ya={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yf(_){var x=this.nativeEvent;return x.getModifierState?x.getModifierState(_):(_=ya[_])?!!x[_]:!1}function Eu(){return Yf}var Da=Bt({},dl,{key:function(_){if(_.key){var x=_d[_.key]||_.key;if(x!=="Unidentified")return x}return _.type==="keypress"?(_=ka(_),_===13?"Enter":String.fromCharCode(_)):_.type==="keydown"||_.type==="keyup"?Xf[_.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Eu,charCode:function(_){return _.type==="keypress"?ka(_):0},keyCode:function(_){return _.type==="keydown"||_.type==="keyup"?_.keyCode:0},which:function(_){return _.type==="keypress"?ka(_):_.type==="keydown"||_.type==="keyup"?_.keyCode:0}}),yg=Xi(Da),vg=Bt({},dh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kf=Xi(vg),Jf=Bt({},dl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Eu}),Cu=Xi(Jf),vr=Bt({},$o,{propertyName:0,elapsedTime:0,pseudoElement:0}),kn=Xi(vr),fh=Bt({},dh,{deltaX:function(_){return"deltaX"in _?_.deltaX:"wheelDeltaX"in _?-_.wheelDeltaX:0},deltaY:function(_){return"deltaY"in _?_.deltaY:"wheelDeltaY"in _?-_.wheelDeltaY:"wheelDelta"in _?-_.wheelDelta:0},deltaZ:0,deltaMode:0}),Jn=Xi(fh),mh=[9,13,27,32],va=i&&"CompositionEvent"in window,Nn=null;i&&"documentMode"in document&&(Nn=document.documentMode);var Lp=i&&"TextEvent"in window&&!Nn,yd=i&&(!va||Nn&&8<Nn&&11>=Nn),Oc=" ",Fc=!1;function Mu(_,x){switch(_){case"keyup":return mh.indexOf(x.keyCode)!==-1;case"keydown":return x.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function So(_){return _=_.detail,typeof _=="object"&&"data"in _?_.data:null}var To=!1;function gh(_,x){switch(_){case"compositionend":return So(x);case"keypress":return x.which!==32?null:(Fc=!0,Oc);case"textInput":return _=x.data,_===Oc&&Fc?null:_;default:return null}}function tn(_,x){if(To)return _==="compositionend"||!va&&Mu(_,x)?(_=lo(),js=wo=sa=null,To=!1,_):null;switch(_){case"paste":return null;case"keypress":if(!(x.ctrlKey||x.altKey||x.metaKey)||x.ctrlKey&&x.altKey){if(x.char&&1<x.char.length)return x.char;if(x.which)return String.fromCharCode(x.which)}return null;case"compositionend":return yd&&x.locale!=="ko"?null:x.data;default:return null}}var _h={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oa(_){var x=_&&_.nodeName&&_.nodeName.toLowerCase();return x==="input"?!!_h[_.type]:x==="textarea"}function Eo(_,x,z,U){ia(U),x=Md(x,"onChange"),0<x.length&&(z=new Bi("onChange","change",null,z,U),_.push({event:z,listeners:x}))}var Iu=null,Hl=null;function hl(_){Eh(_,0)}function pl(_){var x=Vo(_);if(pn(x))return _}function Zl(_,x){if(_==="change")return x}var Bc=!1;if(i){var Xl;if(i){var zp="oninput"in document;if(!zp){var Qf=document.createElement("div");Qf.setAttribute("oninput","return;"),zp=typeof Qf.oninput=="function"}Xl=zp}else Xl=!1;Bc=Xl&&(!document.documentMode||9<document.documentMode)}function yh(){Iu&&(Iu.detachEvent("onpropertychange",Dp),Hl=Iu=null)}function Dp(_){if(_.propertyName==="value"&&pl(Hl)){var x=[];Eo(x,Hl,_,Zi(_)),be(hl,x)}}function em(_,x,z){_==="focusin"?(yh(),Iu=x,Hl=z,Iu.attachEvent("onpropertychange",Dp)):_==="focusout"&&yh()}function tm(_){if(_==="selectionchange"||_==="keyup"||_==="keydown")return pl(Hl)}function vh(_,x){if(_==="click")return pl(x)}function Nc(_,x){if(_==="input"||_==="change")return pl(x)}function xg(_,x){return _===x&&(_!==0||1/_===1/x)||_!==_&&x!==x}var xa=typeof Object.is=="function"?Object.is:xg;function jc(_,x){if(xa(_,x))return!0;if(typeof _!="object"||_===null||typeof x!="object"||x===null)return!1;var z=Object.keys(_),U=Object.keys(x);if(z.length!==U.length)return!1;for(U=0;U<z.length;U++){var ee=z[U];if(!I.call(x,ee)||!xa(_[ee],x[ee]))return!1}return!0}function xh(_){for(;_&&_.firstChild;)_=_.firstChild;return _}function Op(_,x){var z=xh(_);_=0;for(var U;z;){if(z.nodeType===3){if(U=_+z.textContent.length,_<=x&&U>=x)return{node:z,offset:x-_};_=U}e:{for(;z;){if(z.nextSibling){z=z.nextSibling;break e}z=z.parentNode}z=void 0}z=xh(z)}}function us(_,x){return _&&x?_===x?!0:_&&_.nodeType===3?!1:x&&x.nodeType===3?us(_,x.parentNode):"contains"in _?_.contains(x):_.compareDocumentPosition?!!(_.compareDocumentPosition(x)&16):!1:!1}function Fp(){for(var _=window,x=zn();x instanceof _.HTMLIFrameElement;){try{var z=typeof x.contentWindow.location.href=="string"}catch{z=!1}if(z)_=x.contentWindow;else break;x=zn(_.document)}return x}function vd(_){var x=_&&_.nodeName&&_.nodeName.toLowerCase();return x&&(x==="input"&&(_.type==="text"||_.type==="search"||_.type==="tel"||_.type==="url"||_.type==="password")||x==="textarea"||_.contentEditable==="true")}function bh(_){var x=Fp(),z=_.focusedElem,U=_.selectionRange;if(x!==z&&z&&z.ownerDocument&&us(z.ownerDocument.documentElement,z)){if(U!==null&&vd(z)){if(x=U.start,_=U.end,_===void 0&&(_=x),"selectionStart"in z)z.selectionStart=x,z.selectionEnd=Math.min(_,z.value.length);else if(_=(x=z.ownerDocument||document)&&x.defaultView||window,_.getSelection){_=_.getSelection();var ee=z.textContent.length,le=Math.min(U.start,ee);U=U.end===void 0?le:Math.min(U.end,ee),!_.extend&&le>U&&(ee=U,U=le,le=ee),ee=Op(z,le);var Ie=Op(z,U);ee&&Ie&&(_.rangeCount!==1||_.anchorNode!==ee.node||_.anchorOffset!==ee.offset||_.focusNode!==Ie.node||_.focusOffset!==Ie.offset)&&(x=x.createRange(),x.setStart(ee.node,ee.offset),_.removeAllRanges(),le>U?(_.addRange(x),_.extend(Ie.node,Ie.offset)):(x.setEnd(Ie.node,Ie.offset),_.addRange(x)))}}for(x=[],_=z;_=_.parentNode;)_.nodeType===1&&x.push({element:_,left:_.scrollLeft,top:_.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<x.length;z++)_=x[z],_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}var xd=i&&"documentMode"in document&&11>=document.documentMode,fl=null,Fa=null,Yl=null,bd=!1;function Kl(_,x,z){var U=z.window===z?z.document:z.nodeType===9?z:z.ownerDocument;bd||fl==null||fl!==zn(U)||(U=fl,"selectionStart"in U&&vd(U)?U={start:U.selectionStart,end:U.selectionEnd}:(U=(U.ownerDocument&&U.ownerDocument.defaultView||window).getSelection(),U={anchorNode:U.anchorNode,anchorOffset:U.anchorOffset,focusNode:U.focusNode,focusOffset:U.focusOffset}),Yl&&jc(Yl,U)||(Yl=U,U=Md(Fa,"onSelect"),0<U.length&&(x=new Bi("onSelect","select",null,x,z),_.push({event:x,listeners:U}),x.target=fl)))}function ml(_,x){var z={};return z[_.toLowerCase()]=x.toLowerCase(),z["Webkit"+_]="webkit"+x,z["Moz"+_]="moz"+x,z}var Ba={animationend:ml("Animation","AnimationEnd"),animationiteration:ml("Animation","AnimationIteration"),animationstart:ml("Animation","AnimationStart"),transitionend:ml("Transition","TransitionEnd")},gl={},Na={};i&&(Na=document.createElement("div").style,"AnimationEvent"in window||(delete Ba.animationend.animation,delete Ba.animationiteration.animation,delete Ba.animationstart.animation),"TransitionEvent"in window||delete Ba.transitionend.transition);function ja(_){if(gl[_])return gl[_];if(!Ba[_])return _;var x=Ba[_],z;for(z in x)if(x.hasOwnProperty(z)&&z in Na)return gl[_]=x[z];return _}var wd=ja("animationend"),wh=ja("animationiteration"),Sd=ja("animationstart"),Ua=ja("transitionend"),Tr=new Map,Bp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _l(_,x){Tr.set(_,x),y(x,[_])}for(var Sh=0;Sh<Bp.length;Sh++){var yl=Bp[Sh],nm=yl.toLowerCase(),_i=yl[0].toUpperCase()+yl.slice(1);_l(nm,"on"+_i)}_l(wd,"onAnimationEnd"),_l(wh,"onAnimationIteration"),_l(Sd,"onAnimationStart"),_l("dblclick","onDoubleClick"),_l("focusin","onFocus"),_l("focusout","onBlur"),_l(Ua,"onTransitionEnd"),T("onMouseEnter",["mouseout","mouseover"]),T("onMouseLeave",["mouseout","mouseover"]),T("onPointerEnter",["pointerout","pointerover"]),T("onPointerLeave",["pointerout","pointerover"]),y("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),y("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),y("onBeforeInput",["compositionend","keypress","textInput","paste"]),y("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Td="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Td));function Th(_,x,z){var U=_.type||"unknown-event";_.currentTarget=z,un(U,x,void 0,_),_.currentTarget=null}function Eh(_,x){x=(x&4)!==0;for(var z=0;z<_.length;z++){var U=_[z],ee=U.event;U=U.listeners;e:{var le=void 0;if(x)for(var Ie=U.length-1;0<=Ie;Ie--){var lt=U[Ie],vt=lt.instance,Vt=lt.currentTarget;if(lt=lt.listener,vt!==le&&ee.isPropagationStopped())break e;Th(ee,lt,Vt),le=vt}else for(Ie=0;Ie<U.length;Ie++){if(lt=U[Ie],vt=lt.instance,Vt=lt.currentTarget,lt=lt.listener,vt!==le&&ee.isPropagationStopped())break e;Th(ee,lt,Vt),le=vt}}}if(yt)throw _=bt,yt=!1,bt=null,_}function Ri(_,x){var z=x[Ql];z===void 0&&(z=x[Ql]=new Set);var U=_+"__bubble";z.has(U)||(rm(x,_,2,!1),z.add(U))}function Ed(_,x,z){var U=0;x&&(U|=4),rm(z,_,U,x)}var Cd="_reactListening"+Math.random().toString(36).slice(2);function Au(_){if(!_[Cd]){_[Cd]=!0,u.forEach(function(z){z!=="selectionchange"&&(bg.has(z)||Ed(z,!1,_),Ed(z,!0,_))});var x=_.nodeType===9?_:_.ownerDocument;x===null||x[Cd]||(x[Cd]=!0,Ed("selectionchange",!1,x))}}function rm(_,x,z,U){switch(md(x)){case 1:var ee=ui;break;case 4:ee=Wf;break;default:ee=zc}z=ee.bind(null,x,z,_),ee=void 0,!qe||x!=="touchstart"&&x!=="touchmove"&&x!=="wheel"||(ee=!0),U?ee!==void 0?_.addEventListener(x,z,{capture:!0,passive:ee}):_.addEventListener(x,z,!0):ee!==void 0?_.addEventListener(x,z,{passive:ee}):_.addEventListener(x,z,!1)}function Uc(_,x,z,U,ee){var le=U;if(!(x&1)&&!(x&2)&&U!==null)e:for(;;){if(U===null)return;var Ie=U.tag;if(Ie===3||Ie===4){var lt=U.stateNode.containerInfo;if(lt===ee||lt.nodeType===8&&lt.parentNode===ee)break;if(Ie===4)for(Ie=U.return;Ie!==null;){var vt=Ie.tag;if((vt===3||vt===4)&&(vt=Ie.stateNode.containerInfo,vt===ee||vt.nodeType===8&&vt.parentNode===ee))return;Ie=Ie.return}for(;lt!==null;){if(Ie=xl(lt),Ie===null)return;if(vt=Ie.tag,vt===5||vt===6){U=le=Ie;continue e}lt=lt.parentNode}}U=U.return}be(function(){var Vt=le,yn=Zi(z),wn=[];e:{var vn=Tr.get(_);if(vn!==void 0){var Zn=Bi,nr=_;switch(_){case"keypress":if(ka(z)===0)break e;case"keydown":case"keyup":Zn=yg;break;case"focusin":nr="focus",Zn=Su;break;case"focusout":nr="blur",Zn=Su;break;case"beforeblur":case"afterblur":Zn=Su;break;case"click":if(z.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Zn=za;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Zn=hh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Zn=Cu;break;case wd:case wh:case Sd:Zn=Zf;break;case Ua:Zn=kn;break;case"scroll":Zn=aa;break;case"wheel":Zn=Jn;break;case"copy":case"cut":case"paste":Zn=gg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Zn=Kf}var or=(x&4)!==0,co=!or&&_==="scroll",Ot=or?vn!==null?vn+"Capture":null:vn;or=[];for(var St=Vt,jt;St!==null;){jt=St;var An=jt.stateNode;if(jt.tag===5&&An!==null&&(jt=An,Ot!==null&&(An=Re(St,Ot),An!=null&&or.push(vl(St,An,jt)))),co)break;St=St.return}0<or.length&&(vn=new Zn(vn,nr,null,z,yn),wn.push({event:vn,listeners:or}))}}if(!(x&7)){e:{if(vn=_==="mouseover"||_==="pointerover",Zn=_==="mouseout"||_==="pointerout",vn&&z!==$n&&(nr=z.relatedTarget||z.fromElement)&&(xl(nr)||nr[ba]))break e;if((Zn||vn)&&(vn=yn.window===yn?yn:(vn=yn.ownerDocument)?vn.defaultView||vn.parentWindow:window,Zn?(nr=z.relatedTarget||z.toElement,Zn=Vt,nr=nr?xl(nr):null,nr!==null&&(co=an(nr),nr!==co||nr.tag!==5&&nr.tag!==6)&&(nr=null)):(Zn=null,nr=Vt),Zn!==nr)){if(or=za,An="onMouseLeave",Ot="onMouseEnter",St="mouse",(_==="pointerout"||_==="pointerover")&&(or=Kf,An="onPointerLeave",Ot="onPointerEnter",St="pointer"),co=Zn==null?vn:Vo(Zn),jt=nr==null?vn:Vo(nr),vn=new or(An,St+"leave",Zn,z,yn),vn.target=co,vn.relatedTarget=jt,An=null,xl(yn)===Vt&&(or=new or(Ot,St+"enter",nr,z,yn),or.target=jt,or.relatedTarget=co,An=or),co=An,Zn&&nr)t:{for(or=Zn,Ot=nr,St=0,jt=or;jt;jt=Co(jt))St++;for(jt=0,An=Ot;An;An=Co(An))jt++;for(;0<St-jt;)or=Co(or),St--;for(;0<jt-St;)Ot=Co(Ot),jt--;for(;St--;){if(or===Ot||Ot!==null&&or===Ot.alternate)break t;or=Co(or),Ot=Co(Ot)}or=null}else or=null;Zn!==null&&Ch(wn,vn,Zn,or,!1),nr!==null&&co!==null&&Ch(wn,co,nr,or,!0)}}e:{if(vn=Vt?Vo(Vt):window,Zn=vn.nodeName&&vn.nodeName.toLowerCase(),Zn==="select"||Zn==="input"&&vn.type==="file")var fr=Zl;else if(Oa(vn))if(Bc)fr=Nc;else{fr=tm;var mr=em}else(Zn=vn.nodeName)&&Zn.toLowerCase()==="input"&&(vn.type==="checkbox"||vn.type==="radio")&&(fr=vh);if(fr&&(fr=fr(_,Vt))){Eo(wn,fr,z,yn);break e}mr&&mr(_,vn,Vt),_==="focusout"&&(mr=vn._wrapperState)&&mr.controlled&&vn.type==="number"&&ir(vn,"number",vn.value)}switch(mr=Vt?Vo(Vt):window,_){case"focusin":(Oa(mr)||mr.contentEditable==="true")&&(fl=mr,Fa=Vt,Yl=null);break;case"focusout":Yl=Fa=fl=null;break;case"mousedown":bd=!0;break;case"contextmenu":case"mouseup":case"dragend":bd=!1,Kl(wn,z,yn);break;case"selectionchange":if(xd)break;case"keydown":case"keyup":Kl(wn,z,yn)}var Ir;if(va)e:{switch(_){case"compositionstart":var jr="onCompositionStart";break e;case"compositionend":jr="onCompositionEnd";break e;case"compositionupdate":jr="onCompositionUpdate";break e}jr=void 0}else To?Mu(_,z)&&(jr="onCompositionEnd"):_==="keydown"&&z.keyCode===229&&(jr="onCompositionStart");jr&&(yd&&z.locale!=="ko"&&(To||jr!=="onCompositionStart"?jr==="onCompositionEnd"&&To&&(Ir=lo()):(sa=yn,wo="value"in sa?sa.value:sa.textContent,To=!0)),mr=Md(Vt,jr),0<mr.length&&(jr=new Tu(jr,_,null,z,yn),wn.push({event:jr,listeners:mr}),Ir?jr.data=Ir:(Ir=So(z),Ir!==null&&(jr.data=Ir)))),(Ir=Lp?gh(_,z):tn(_,z))&&(Vt=Md(Vt,"onBeforeInput"),0<Vt.length&&(yn=new Tu("onBeforeInput","beforeinput",null,z,yn),wn.push({event:yn,listeners:Vt}),yn.data=Ir))}Eh(wn,x)})}function vl(_,x,z){return{instance:_,listener:x,currentTarget:z}}function Md(_,x){for(var z=x+"Capture",U=[];_!==null;){var ee=_,le=ee.stateNode;ee.tag===5&&le!==null&&(ee=le,le=Re(_,z),le!=null&&U.unshift(vl(_,le,ee)),le=Re(_,x),le!=null&&U.push(vl(_,le,ee))),_=_.return}return U}function Co(_){if(_===null)return null;do _=_.return;while(_&&_.tag!==5);return _||null}function Ch(_,x,z,U,ee){for(var le=x._reactName,Ie=[];z!==null&&z!==U;){var lt=z,vt=lt.alternate,Vt=lt.stateNode;if(vt!==null&&vt===U)break;lt.tag===5&&Vt!==null&&(lt=Vt,ee?(vt=Re(z,le),vt!=null&&Ie.unshift(vl(z,vt,lt))):ee||(vt=Re(z,le),vt!=null&&Ie.push(vl(z,vt,lt)))),z=z.return}Ie.length!==0&&_.push({event:x,listeners:Ie})}var Mh=/\r\n?/g,Ih=/\u0000|\uFFFD/g;function Ah(_){return(typeof _=="string"?_:""+_).replace(Mh,`
`).replace(Ih,"")}function Pu(_,x,z){if(x=Ah(x),Ah(_)!==x&&z)throw Error(s(425))}function $c(){}var Id=null,Ad=null;function Ru(_,x){return _==="textarea"||_==="noscript"||typeof x.children=="string"||typeof x.children=="number"||typeof x.dangerouslySetInnerHTML=="object"&&x.dangerouslySetInnerHTML!==null&&x.dangerouslySetInnerHTML.__html!=null}var Ph=typeof setTimeout=="function"?setTimeout:void 0,im=typeof clearTimeout=="function"?clearTimeout:void 0,Vc=typeof Promise=="function"?Promise:void 0,wg=typeof queueMicrotask=="function"?queueMicrotask:typeof Vc<"u"?function(_){return Vc.resolve(null).then(_).catch(Sg)}:Ph;function Sg(_){setTimeout(function(){throw _})}function Np(_,x){var z=x,U=0;do{var ee=z.nextSibling;if(_.removeChild(z),ee&&ee.nodeType===8)if(z=ee.data,z==="/$"){if(U===0){_.removeChild(ee),Ns(x);return}U--}else z!=="$"&&z!=="$?"&&z!=="$!"||U++;z=ee}while(z);Ns(x)}function Jl(_){for(;_!=null;_=_.nextSibling){var x=_.nodeType;if(x===1||x===3)break;if(x===8){if(x=_.data,x==="$"||x==="$!"||x==="$?")break;if(x==="/$")return null}}return _}function om(_){_=_.previousSibling;for(var x=0;_;){if(_.nodeType===8){var z=_.data;if(z==="$"||z==="$!"||z==="$?"){if(x===0)return _;x--}else z==="/$"&&x++}_=_.previousSibling}return null}var ku=Math.random().toString(36).slice(2),bs="__reactFiber$"+ku,Gc="__reactProps$"+ku,ba="__reactContainer$"+ku,Ql="__reactEvents$"+ku,sm="__reactListeners$"+ku,am="__reactHandles$"+ku;function xl(_){var x=_[bs];if(x)return x;for(var z=_.parentNode;z;){if(x=z[ba]||z[bs]){if(z=x.alternate,x.child!==null||z!==null&&z.child!==null)for(_=om(_);_!==null;){if(z=_[bs])return z;_=om(_)}return x}_=z,z=_.parentNode}return null}function ec(_){return _=_[bs]||_[ba],!_||_.tag!==5&&_.tag!==6&&_.tag!==13&&_.tag!==3?null:_}function Vo(_){if(_.tag===5||_.tag===6)return _.stateNode;throw Error(s(33))}function Lu(_){return _[Gc]||null}var wa=[],tc=-1;function Us(_){return{current:_}}function Ai(_){0>tc||(_.current=wa[tc],wa[tc]=null,tc--)}function ki(_,x){tc++,wa[tc]=_.current,_.current=x}var $a={},Mo=Us($a),ds=Us(!1),nc=$a;function Va(_,x){var z=_.type.contextTypes;if(!z)return $a;var U=_.stateNode;if(U&&U.__reactInternalMemoizedUnmaskedChildContext===x)return U.__reactInternalMemoizedMaskedChildContext;var ee={},le;for(le in z)ee[le]=x[le];return U&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=x,_.__reactInternalMemoizedMaskedChildContext=ee),ee}function ws(_){return _=_.childContextTypes,_!=null}function Pd(){Ai(ds),Ai(Mo)}function Rh(_,x,z){if(Mo.current!==$a)throw Error(s(168));ki(Mo,x),ki(ds,z)}function Rd(_,x,z){var U=_.stateNode;if(x=x.childContextTypes,typeof U.getChildContext!="function")return z;U=U.getChildContext();for(var ee in U)if(!(ee in x))throw Error(s(108,Ut(_)||"Unknown",ee));return Bt({},z,U)}function zu(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||$a,nc=Mo.current,ki(Mo,_),ki(ds,ds.current),!0}function kd(_,x,z){var U=_.stateNode;if(!U)throw Error(s(169));z?(_=Rd(_,x,nc),U.__reactInternalMemoizedMergedChildContext=_,Ai(ds),Ai(Mo),ki(Mo,_)):Ai(ds),ki(ds,z)}var $s=null,Du=!1,rc=!1;function kh(_){$s===null?$s=[_]:$s.push(_)}function Lh(_){Du=!0,kh(_)}function Sa(){if(!rc&&$s!==null){rc=!0;var _=0,x=ri;try{var z=$s;for(ri=1;_<z.length;_++){var U=z[_];do U=U(!0);while(U!==null)}$s=null,Du=!1}catch(ee){throw $s!==null&&($s=$s.slice(_+1)),Nr(no,Sa),ee}finally{ri=x,rc=!1}}return null}var ic=[],oc=0,zh=null,bl=0,Qo=[],dn=0,wl=null,Ga=1,yo="";function Vs(_,x){ic[oc++]=bl,ic[oc++]=zh,zh=_,bl=x}function Mn(_,x,z){Qo[dn++]=Ga,Qo[dn++]=yo,Qo[dn++]=wl,wl=_;var U=Ga;_=yo;var ee=32-Jo(U)-1;U&=~(1<<ee),z+=1;var le=32-Jo(x)+ee;if(30<le){var Ie=ee-ee%5;le=(U&(1<<Ie)-1).toString(32),U>>=Ie,ee-=Ie,Ga=1<<32-Jo(x)+ee|z<<ee|U,yo=le+_}else Ga=1<<le|z<<ee|U,yo=_}function Ld(_){_.return!==null&&(Vs(_,1),Mn(_,1,0))}function Dh(_){for(;_===zh;)zh=ic[--oc],ic[oc]=null,bl=ic[--oc],ic[oc]=null;for(;_===wl;)wl=Qo[--dn],Qo[dn]=null,yo=Qo[--dn],Qo[dn]=null,Ga=Qo[--dn],Qo[dn]=null}var Ss=null,es=null,Ni=!1,Ts=null;function Oh(_,x){var z=Qa(5,null,null,0);z.elementType="DELETED",z.stateNode=x,z.return=_,x=_.deletions,x===null?(_.deletions=[z],_.flags|=16):x.push(z)}function jp(_,x){switch(_.tag){case 5:var z=_.type;return x=x.nodeType!==1||z.toLowerCase()!==x.nodeName.toLowerCase()?null:x,x!==null?(_.stateNode=x,Ss=_,es=Jl(x.firstChild),!0):!1;case 6:return x=_.pendingProps===""||x.nodeType!==3?null:x,x!==null?(_.stateNode=x,Ss=_,es=null,!0):!1;case 13:return x=x.nodeType!==8?null:x,x!==null?(z=wl!==null?{id:Ga,overflow:yo}:null,_.memoizedState={dehydrated:x,treeContext:z,retryLane:1073741824},z=Qa(18,null,null,0),z.stateNode=x,z.return=_,_.child=z,Ss=_,es=null,!0):!1;default:return!1}}function zd(_){return(_.mode&1)!==0&&(_.flags&128)===0}function la(_){if(Ni){var x=es;if(x){var z=x;if(!jp(_,x)){if(zd(_))throw Error(s(418));x=Jl(z.nextSibling);var U=Ss;x&&jp(_,x)?Oh(U,z):(_.flags=_.flags&-4097|2,Ni=!1,Ss=_)}}else{if(zd(_))throw Error(s(418));_.flags=_.flags&-4097|2,Ni=!1,Ss=_}}}function Fh(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;Ss=_}function Ou(_){if(_!==Ss)return!1;if(!Ni)return Fh(_),Ni=!0,!1;var x;if((x=_.tag!==3)&&!(x=_.tag!==5)&&(x=_.type,x=x!=="head"&&x!=="body"&&!Ru(_.type,_.memoizedProps)),x&&(x=es)){if(zd(_))throw ts(),Error(s(418));for(;x;)Oh(_,x),x=Jl(x.nextSibling)}if(Fh(_),_.tag===13){if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(s(317));e:{for(_=_.nextSibling,x=0;_;){if(_.nodeType===8){var z=_.data;if(z==="/$"){if(x===0){es=Jl(_.nextSibling);break e}x--}else z!=="$"&&z!=="$!"&&z!=="$?"||x++}_=_.nextSibling}es=null}}else es=Ss?Jl(_.stateNode.nextSibling):null;return!0}function ts(){for(var _=es;_;)_=Jl(_.nextSibling)}function Gs(){es=Ss=null,Ni=!1}function qc(_){Ts===null?Ts=[_]:Ts.push(_)}var Bh=ie.ReactCurrentBatchConfig;function qa(_,x,z){if(_=z.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(z._owner){if(z=z._owner,z){if(z.tag!==1)throw Error(s(309));var U=z.stateNode}if(!U)throw Error(s(147,_));var ee=U,le=""+_;return x!==null&&x.ref!==null&&typeof x.ref=="function"&&x.ref._stringRef===le?x.ref:(x=function(Ie){var lt=ee.refs;Ie===null?delete lt[le]:lt[le]=Ie},x._stringRef=le,x)}if(typeof _!="string")throw Error(s(284));if(!z._owner)throw Error(s(290,_))}return _}function Wc(_,x){throw _=Object.prototype.toString.call(x),Error(s(31,_==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":_))}function Up(_){var x=_._init;return x(_._payload)}function qs(_){function x(Ot,St){if(_){var jt=Ot.deletions;jt===null?(Ot.deletions=[St],Ot.flags|=16):jt.push(St)}}function z(Ot,St){if(!_)return null;for(;St!==null;)x(Ot,St),St=St.sibling;return null}function U(Ot,St){for(Ot=new Map;St!==null;)St.key!==null?Ot.set(St.key,St):Ot.set(St.index,St),St=St.sibling;return Ot}function ee(Ot,St){return Ot=su(Ot,St),Ot.index=0,Ot.sibling=null,Ot}function le(Ot,St,jt){return Ot.index=jt,_?(jt=Ot.alternate,jt!==null?(jt=jt.index,jt<St?(Ot.flags|=2,St):jt):(Ot.flags|=2,St)):(Ot.flags|=1048576,St)}function Ie(Ot){return _&&Ot.alternate===null&&(Ot.flags|=2),Ot}function lt(Ot,St,jt,An){return St===null||St.tag!==6?(St=pm(jt,Ot.mode,An),St.return=Ot,St):(St=ee(St,jt),St.return=Ot,St)}function vt(Ot,St,jt,An){var fr=jt.type;return fr===xe?yn(Ot,St,jt.props.children,An,jt.key):St!==null&&(St.elementType===fr||typeof fr=="object"&&fr!==null&&fr.$$typeof===gt&&Up(fr)===St.type)?(An=ee(St,jt.props),An.ref=qa(Ot,St,jt),An.return=Ot,An):(An=sf(jt.type,jt.key,jt.props,null,Ot.mode,An),An.ref=qa(Ot,St,jt),An.return=Ot,An)}function Vt(Ot,St,jt,An){return St===null||St.tag!==4||St.stateNode.containerInfo!==jt.containerInfo||St.stateNode.implementation!==jt.implementation?(St=fm(jt,Ot.mode,An),St.return=Ot,St):(St=ee(St,jt.children||[]),St.return=Ot,St)}function yn(Ot,St,jt,An,fr){return St===null||St.tag!==7?(St=Xu(jt,Ot.mode,An,fr),St.return=Ot,St):(St=ee(St,jt),St.return=Ot,St)}function wn(Ot,St,jt){if(typeof St=="string"&&St!==""||typeof St=="number")return St=pm(""+St,Ot.mode,jt),St.return=Ot,St;if(typeof St=="object"&&St!==null){switch(St.$$typeof){case ce:return jt=sf(St.type,St.key,St.props,null,Ot.mode,jt),jt.ref=qa(Ot,null,St),jt.return=Ot,jt;case we:return St=fm(St,Ot.mode,jt),St.return=Ot,St;case gt:var An=St._init;return wn(Ot,An(St._payload),jt)}if(cr(St)||Ye(St))return St=Xu(St,Ot.mode,jt,null),St.return=Ot,St;Wc(Ot,St)}return null}function vn(Ot,St,jt,An){var fr=St!==null?St.key:null;if(typeof jt=="string"&&jt!==""||typeof jt=="number")return fr!==null?null:lt(Ot,St,""+jt,An);if(typeof jt=="object"&&jt!==null){switch(jt.$$typeof){case ce:return jt.key===fr?vt(Ot,St,jt,An):null;case we:return jt.key===fr?Vt(Ot,St,jt,An):null;case gt:return fr=jt._init,vn(Ot,St,fr(jt._payload),An)}if(cr(jt)||Ye(jt))return fr!==null?null:yn(Ot,St,jt,An,null);Wc(Ot,jt)}return null}function Zn(Ot,St,jt,An,fr){if(typeof An=="string"&&An!==""||typeof An=="number")return Ot=Ot.get(jt)||null,lt(St,Ot,""+An,fr);if(typeof An=="object"&&An!==null){switch(An.$$typeof){case ce:return Ot=Ot.get(An.key===null?jt:An.key)||null,vt(St,Ot,An,fr);case we:return Ot=Ot.get(An.key===null?jt:An.key)||null,Vt(St,Ot,An,fr);case gt:var mr=An._init;return Zn(Ot,St,jt,mr(An._payload),fr)}if(cr(An)||Ye(An))return Ot=Ot.get(jt)||null,yn(St,Ot,An,fr,null);Wc(St,An)}return null}function nr(Ot,St,jt,An){for(var fr=null,mr=null,Ir=St,jr=St=0,as=null;Ir!==null&&jr<jt.length;jr++){Ir.index>jr?(as=Ir,Ir=null):as=Ir.sibling;var Si=vn(Ot,Ir,jt[jr],An);if(Si===null){Ir===null&&(Ir=as);break}_&&Ir&&Si.alternate===null&&x(Ot,Ir),St=le(Si,St,jr),mr===null?fr=Si:mr.sibling=Si,mr=Si,Ir=as}if(jr===jt.length)return z(Ot,Ir),Ni&&Vs(Ot,jr),fr;if(Ir===null){for(;jr<jt.length;jr++)Ir=wn(Ot,jt[jr],An),Ir!==null&&(St=le(Ir,St,jr),mr===null?fr=Ir:mr.sibling=Ir,mr=Ir);return Ni&&Vs(Ot,jr),fr}for(Ir=U(Ot,Ir);jr<jt.length;jr++)as=Zn(Ir,Ot,jr,jt[jr],An),as!==null&&(_&&as.alternate!==null&&Ir.delete(as.key===null?jr:as.key),St=le(as,St,jr),mr===null?fr=as:mr.sibling=as,mr=as);return _&&Ir.forEach(function(Ku){return x(Ot,Ku)}),Ni&&Vs(Ot,jr),fr}function or(Ot,St,jt,An){var fr=Ye(jt);if(typeof fr!="function")throw Error(s(150));if(jt=fr.call(jt),jt==null)throw Error(s(151));for(var mr=fr=null,Ir=St,jr=St=0,as=null,Si=jt.next();Ir!==null&&!Si.done;jr++,Si=jt.next()){Ir.index>jr?(as=Ir,Ir=null):as=Ir.sibling;var Ku=vn(Ot,Ir,Si.value,An);if(Ku===null){Ir===null&&(Ir=as);break}_&&Ir&&Ku.alternate===null&&x(Ot,Ir),St=le(Ku,St,jr),mr===null?fr=Ku:mr.sibling=Ku,mr=Ku,Ir=as}if(Si.done)return z(Ot,Ir),Ni&&Vs(Ot,jr),fr;if(Ir===null){for(;!Si.done;jr++,Si=jt.next())Si=wn(Ot,Si.value,An),Si!==null&&(St=le(Si,St,jr),mr===null?fr=Si:mr.sibling=Si,mr=Si);return Ni&&Vs(Ot,jr),fr}for(Ir=U(Ot,Ir);!Si.done;jr++,Si=jt.next())Si=Zn(Ir,Ot,jr,Si.value,An),Si!==null&&(_&&Si.alternate!==null&&Ir.delete(Si.key===null?jr:Si.key),St=le(Si,St,jr),mr===null?fr=Si:mr.sibling=Si,mr=Si);return _&&Ir.forEach(function(jx){return x(Ot,jx)}),Ni&&Vs(Ot,jr),fr}function co(Ot,St,jt,An){if(typeof jt=="object"&&jt!==null&&jt.type===xe&&jt.key===null&&(jt=jt.props.children),typeof jt=="object"&&jt!==null){switch(jt.$$typeof){case ce:e:{for(var fr=jt.key,mr=St;mr!==null;){if(mr.key===fr){if(fr=jt.type,fr===xe){if(mr.tag===7){z(Ot,mr.sibling),St=ee(mr,jt.props.children),St.return=Ot,Ot=St;break e}}else if(mr.elementType===fr||typeof fr=="object"&&fr!==null&&fr.$$typeof===gt&&Up(fr)===mr.type){z(Ot,mr.sibling),St=ee(mr,jt.props),St.ref=qa(Ot,mr,jt),St.return=Ot,Ot=St;break e}z(Ot,mr);break}else x(Ot,mr);mr=mr.sibling}jt.type===xe?(St=Xu(jt.props.children,Ot.mode,An,jt.key),St.return=Ot,Ot=St):(An=sf(jt.type,jt.key,jt.props,null,Ot.mode,An),An.ref=qa(Ot,St,jt),An.return=Ot,Ot=An)}return Ie(Ot);case we:e:{for(mr=jt.key;St!==null;){if(St.key===mr)if(St.tag===4&&St.stateNode.containerInfo===jt.containerInfo&&St.stateNode.implementation===jt.implementation){z(Ot,St.sibling),St=ee(St,jt.children||[]),St.return=Ot,Ot=St;break e}else{z(Ot,St);break}else x(Ot,St);St=St.sibling}St=fm(jt,Ot.mode,An),St.return=Ot,Ot=St}return Ie(Ot);case gt:return mr=jt._init,co(Ot,St,mr(jt._payload),An)}if(cr(jt))return nr(Ot,St,jt,An);if(Ye(jt))return or(Ot,St,jt,An);Wc(Ot,jt)}return typeof jt=="string"&&jt!==""||typeof jt=="number"?(jt=""+jt,St!==null&&St.tag===6?(z(Ot,St.sibling),St=ee(St,jt),St.return=Ot,Ot=St):(z(Ot,St),St=pm(jt,Ot.mode,An),St.return=Ot,Ot=St),Ie(Ot)):z(Ot,St)}return co}var Jr=qs(!0),Hc=qs(!1),Zc=Us(null),sc=null,ca=null,Nh=null;function $p(){Nh=ca=sc=null}function ac(_){var x=Zc.current;Ai(Zc),_._currentValue=x}function lc(_,x,z){for(;_!==null;){var U=_.alternate;if((_.childLanes&x)!==x?(_.childLanes|=x,U!==null&&(U.childLanes|=x)):U!==null&&(U.childLanes&x)!==x&&(U.childLanes|=x),_===z)break;_=_.return}}function Wt(_,x){sc=_,Nh=ca=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&x&&(rs=!0),_.firstContext=null)}function nn(_){var x=_._currentValue;if(Nh!==_)if(_={context:_,memoizedValue:x,next:null},ca===null){if(sc===null)throw Error(s(308));ca=_,sc.dependencies={lanes:0,firstContext:_}}else ca=ca.next=_;return x}var Es=null;function bi(_){Es===null?Es=[_]:Es.push(_)}function ft(_,x,z,U){var ee=x.interleaved;return ee===null?(z.next=z,bi(x)):(z.next=ee.next,ee.next=z),x.interleaved=z,Wa(_,U)}function Wa(_,x){_.lanes|=x;var z=_.alternate;for(z!==null&&(z.lanes|=x),z=_,_=_.return;_!==null;)_.childLanes|=x,z=_.alternate,z!==null&&(z.childLanes|=x),z=_,_=_.return;return z.tag===3?z.stateNode:null}var Ta=!1;function Dd(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vp(_,x){_=_.updateQueue,x.updateQueue===_&&(x.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function Ha(_,x){return{eventTime:_,lane:x,tag:0,payload:null,callback:null,next:null}}function Sl(_,x,z){var U=_.updateQueue;if(U===null)return null;if(U=U.shared,je&2){var ee=U.pending;return ee===null?x.next=x:(x.next=ee.next,ee.next=x),U.pending=x,Wa(_,z)}return ee=U.interleaved,ee===null?(x.next=x,bi(U)):(x.next=ee.next,ee.next=x),U.interleaved=x,Wa(_,z)}function Tl(_,x,z){if(x=x.updateQueue,x!==null&&(x=x.shared,(z&4194240)!==0)){var U=x.lanes;U&=_.pendingLanes,z|=U,x.lanes=z,Rc(_,z)}}function lm(_,x){var z=_.updateQueue,U=_.alternate;if(U!==null&&(U=U.updateQueue,z===U)){var ee=null,le=null;if(z=z.firstBaseUpdate,z!==null){do{var Ie={eventTime:z.eventTime,lane:z.lane,tag:z.tag,payload:z.payload,callback:z.callback,next:null};le===null?ee=le=Ie:le=le.next=Ie,z=z.next}while(z!==null);le===null?ee=le=x:le=le.next=x}else ee=le=x;z={baseState:U.baseState,firstBaseUpdate:ee,lastBaseUpdate:le,shared:U.shared,effects:U.effects},_.updateQueue=z;return}_=z.lastBaseUpdate,_===null?z.firstBaseUpdate=x:_.next=x,z.lastBaseUpdate=x}function jh(_,x,z,U){var ee=_.updateQueue;Ta=!1;var le=ee.firstBaseUpdate,Ie=ee.lastBaseUpdate,lt=ee.shared.pending;if(lt!==null){ee.shared.pending=null;var vt=lt,Vt=vt.next;vt.next=null,Ie===null?le=Vt:Ie.next=Vt,Ie=vt;var yn=_.alternate;yn!==null&&(yn=yn.updateQueue,lt=yn.lastBaseUpdate,lt!==Ie&&(lt===null?yn.firstBaseUpdate=Vt:lt.next=Vt,yn.lastBaseUpdate=vt))}if(le!==null){var wn=ee.baseState;Ie=0,yn=Vt=vt=null,lt=le;do{var vn=lt.lane,Zn=lt.eventTime;if((U&vn)===vn){yn!==null&&(yn=yn.next={eventTime:Zn,lane:0,tag:lt.tag,payload:lt.payload,callback:lt.callback,next:null});e:{var nr=_,or=lt;switch(vn=x,Zn=z,or.tag){case 1:if(nr=or.payload,typeof nr=="function"){wn=nr.call(Zn,wn,vn);break e}wn=nr;break e;case 3:nr.flags=nr.flags&-65537|128;case 0:if(nr=or.payload,vn=typeof nr=="function"?nr.call(Zn,wn,vn):nr,vn==null)break e;wn=Bt({},wn,vn);break e;case 2:Ta=!0}}lt.callback!==null&&lt.lane!==0&&(_.flags|=64,vn=ee.effects,vn===null?ee.effects=[lt]:vn.push(lt))}else Zn={eventTime:Zn,lane:vn,tag:lt.tag,payload:lt.payload,callback:lt.callback,next:null},yn===null?(Vt=yn=Zn,vt=wn):yn=yn.next=Zn,Ie|=vn;if(lt=lt.next,lt===null){if(lt=ee.shared.pending,lt===null)break;vn=lt,lt=vn.next,vn.next=null,ee.lastBaseUpdate=vn,ee.shared.pending=null}}while(!0);if(yn===null&&(vt=wn),ee.baseState=vt,ee.firstBaseUpdate=Vt,ee.lastBaseUpdate=yn,x=ee.shared.interleaved,x!==null){ee=x;do Ie|=ee.lane,ee=ee.next;while(ee!==x)}else le===null&&(ee.shared.lanes=0);ut|=Ie,_.lanes=Ie,_.memoizedState=wn}}function cc(_,x,z){if(_=x.effects,x.effects=null,_!==null)for(x=0;x<_.length;x++){var U=_[x],ee=U.callback;if(ee!==null){if(U.callback=null,U=z,typeof ee!="function")throw Error(s(191,ee));ee.call(U)}}}var El={},Ws=Us(El),Cl=Us(El),Fu=Us(El);function Za(_){if(_===El)throw Error(s(174));return _}function Hs(_,x){switch(ki(Fu,x),ki(Cl,_),ki(Ws,El),_=x.nodeType,_){case 9:case 11:x=(x=x.documentElement)?x.namespaceURI:Tn(null,"");break;default:_=_===8?x.parentNode:x,x=_.namespaceURI||null,_=_.tagName,x=Tn(x,_)}Ai(Ws),ki(Ws,x)}function ns(){Ai(Ws),Ai(Cl),Ai(Fu)}function uc(_){Za(Fu.current);var x=Za(Ws.current),z=Tn(x,_.type);x!==z&&(ki(Cl,_),ki(Ws,z))}function Gp(_){Cl.current===_&&(Ai(Ws),Ai(Cl))}var Qr=Us(0);function Uh(_){for(var x=_;x!==null;){if(x.tag===13){var z=x.memoizedState;if(z!==null&&(z=z.dehydrated,z===null||z.data==="$?"||z.data==="$!"))return x}else if(x.tag===19&&x.memoizedProps.revealOrder!==void 0){if(x.flags&128)return x}else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===_)break;for(;x.sibling===null;){if(x.return===null||x.return===_)return null;x=x.return}x.sibling.return=x.return,x=x.sibling}return null}var Xc=[];function li(){for(var _=0;_<Xc.length;_++)Xc[_]._workInProgressVersionPrimary=null;Xc.length=0}var Dr=ie.ReactCurrentDispatcher,Bu=ie.ReactCurrentBatchConfig,Go=0,Li=null,ji=null,vo=null,hs=!1,ua=!1,Zs=0,dc=0;function Io(){throw Error(s(321))}function Nu(_,x){if(x===null)return!1;for(var z=0;z<x.length&&z<_.length;z++)if(!xa(_[z],x[z]))return!1;return!0}function Od(_,x,z,U,ee,le){if(Go=le,Li=x,x.memoizedState=null,x.updateQueue=null,x.lanes=0,Dr.current=_===null||_.memoizedState===null?Jp:Ui,_=z(U,ee),ua){le=0;do{if(ua=!1,Zs=0,25<=le)throw Error(s(301));le+=1,vo=ji=null,x.updateQueue=null,Dr.current=Xh,_=z(U,ee)}while(ua)}if(Dr.current=Zh,x=ji!==null&&ji.next!==null,Go=0,vo=ji=Li=null,hs=!1,x)throw Error(s(300));return _}function Fd(){var _=Zs!==0;return Zs=0,_}function da(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vo===null?Li.memoizedState=vo=_:vo=vo.next=_,vo}function Ao(){if(ji===null){var _=Li.alternate;_=_!==null?_.memoizedState:null}else _=ji.next;var x=vo===null?Li.memoizedState:vo.next;if(x!==null)vo=x,ji=_;else{if(_===null)throw Error(s(310));ji=_,_={memoizedState:ji.memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},vo===null?Li.memoizedState=vo=_:vo=vo.next=_}return vo}function Yc(_,x){return typeof x=="function"?x(_):x}function ju(_){var x=Ao(),z=x.queue;if(z===null)throw Error(s(311));z.lastRenderedReducer=_;var U=ji,ee=U.baseQueue,le=z.pending;if(le!==null){if(ee!==null){var Ie=ee.next;ee.next=le.next,le.next=Ie}U.baseQueue=ee=le,z.pending=null}if(ee!==null){le=ee.next,U=U.baseState;var lt=Ie=null,vt=null,Vt=le;do{var yn=Vt.lane;if((Go&yn)===yn)vt!==null&&(vt=vt.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),U=Vt.hasEagerState?Vt.eagerState:_(U,Vt.action);else{var wn={lane:yn,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};vt===null?(lt=vt=wn,Ie=U):vt=vt.next=wn,Li.lanes|=yn,ut|=yn}Vt=Vt.next}while(Vt!==null&&Vt!==le);vt===null?Ie=U:vt.next=lt,xa(U,x.memoizedState)||(rs=!0),x.memoizedState=U,x.baseState=Ie,x.baseQueue=vt,z.lastRenderedState=U}if(_=z.interleaved,_!==null){ee=_;do le=ee.lane,Li.lanes|=le,ut|=le,ee=ee.next;while(ee!==_)}else ee===null&&(z.lanes=0);return[x.memoizedState,z.dispatch]}function Uu(_){var x=Ao(),z=x.queue;if(z===null)throw Error(s(311));z.lastRenderedReducer=_;var U=z.dispatch,ee=z.pending,le=x.memoizedState;if(ee!==null){z.pending=null;var Ie=ee=ee.next;do le=_(le,Ie.action),Ie=Ie.next;while(Ie!==ee);xa(le,x.memoizedState)||(rs=!0),x.memoizedState=le,x.baseQueue===null&&(x.baseState=le),z.lastRenderedState=le}return[le,U]}function $h(){}function Po(_,x){var z=Li,U=Ao(),ee=x(),le=!xa(U.memoizedState,ee);if(le&&(U.memoizedState=ee,rs=!0),U=U.queue,eu(Kc.bind(null,z,U,_),[_]),U.getSnapshot!==x||le||vo!==null&&vo.memoizedState.tag&1){if(z.flags|=2048,Jc(9,Bd.bind(null,z,U,ee,x),void 0,null),pt===null)throw Error(s(349));Go&30||Vh(z,x,ee)}return ee}function Vh(_,x,z){_.flags|=16384,_={getSnapshot:x,value:z},x=Li.updateQueue,x===null?(x={lastEffect:null,stores:null},Li.updateQueue=x,x.stores=[_]):(z=x.stores,z===null?x.stores=[_]:z.push(_))}function Bd(_,x,z,U){x.value=z,x.getSnapshot=U,ps(x)&&Nd(_)}function Kc(_,x,z){return z(function(){ps(x)&&Nd(_)})}function ps(_){var x=_.getSnapshot;_=_.value;try{var z=x();return!xa(_,z)}catch{return!0}}function Nd(_){var x=Wa(_,1);x!==null&&Wn(x,_,1,-1)}function Gh(_){var x=da();return typeof _=="function"&&(_=_()),x.memoizedState=x.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yc,lastRenderedState:_},x.queue=_,_=_.dispatch=$d.bind(null,Li,_),[x.memoizedState,_]}function Jc(_,x,z,U){return _={tag:_,create:x,destroy:z,deps:U,next:null},x=Li.updateQueue,x===null?(x={lastEffect:null,stores:null},Li.updateQueue=x,x.lastEffect=_.next=_):(z=x.lastEffect,z===null?x.lastEffect=_.next=_:(U=z.next,z.next=_,_.next=U,x.lastEffect=_)),_}function hc(){return Ao().memoizedState}function pc(_,x,z,U){var ee=da();Li.flags|=_,ee.memoizedState=Jc(1|x,z,void 0,U===void 0?null:U)}function Qc(_,x,z,U){var ee=Ao();U=U===void 0?null:U;var le=void 0;if(ji!==null){var Ie=ji.memoizedState;if(le=Ie.destroy,U!==null&&Nu(U,Ie.deps)){ee.memoizedState=Jc(x,z,le,U);return}}Li.flags|=_,ee.memoizedState=Jc(1|x,z,le,U)}function qh(_,x){return pc(8390656,8,_,x)}function eu(_,x){return Qc(2048,8,_,x)}function Wh(_,x){return Qc(4,2,_,x)}function jd(_,x){return Qc(4,4,_,x)}function $u(_,x){if(typeof x=="function")return _=_(),x(_),function(){x(null)};if(x!=null)return _=_(),x.current=_,function(){x.current=null}}function qp(_,x,z){return z=z!=null?z.concat([_]):null,Qc(4,4,$u.bind(null,x,_),z)}function Hh(){}function Wp(_,x){var z=Ao();x=x===void 0?null:x;var U=z.memoizedState;return U!==null&&x!==null&&Nu(x,U[1])?U[0]:(z.memoizedState=[_,x],_)}function Hp(_,x){var z=Ao();x=x===void 0?null:x;var U=z.memoizedState;return U!==null&&x!==null&&Nu(x,U[1])?U[0]:(_=_(),z.memoizedState=[_,x],_)}function Zp(_,x,z){return Go&21?(xa(z,x)||(z=Ds(),Li.lanes|=z,ut|=z,_.baseState=!0),x):(_.baseState&&(_.baseState=!1,rs=!0),_.memoizedState=z)}function Ud(_,x){var z=ri;ri=z!==0&&4>z?z:4,_(!0);var U=Bu.transition;Bu.transition={};try{_(!1),x()}finally{ri=z,Bu.transition=U}}function Vu(){return Ao().memoizedState}function Cs(_,x,z){var U=Fr(_);if(z={lane:U,action:z,hasEagerState:!1,eagerState:null,next:null},Xp(_))Yp(x,z);else if(z=ft(_,x,z,U),z!==null){var ee=xr();Wn(z,_,U,ee),Kp(z,x,U)}}function $d(_,x,z){var U=Fr(_),ee={lane:U,action:z,hasEagerState:!1,eagerState:null,next:null};if(Xp(_))Yp(x,ee);else{var le=_.alternate;if(_.lanes===0&&(le===null||le.lanes===0)&&(le=x.lastRenderedReducer,le!==null))try{var Ie=x.lastRenderedState,lt=le(Ie,z);if(ee.hasEagerState=!0,ee.eagerState=lt,xa(lt,Ie)){var vt=x.interleaved;vt===null?(ee.next=ee,bi(x)):(ee.next=vt.next,vt.next=ee),x.interleaved=ee;return}}catch{}finally{}z=ft(_,x,ee,U),z!==null&&(ee=xr(),Wn(z,_,U,ee),Kp(z,x,U))}}function Xp(_){var x=_.alternate;return _===Li||x!==null&&x===Li}function Yp(_,x){ua=hs=!0;var z=_.pending;z===null?x.next=x:(x.next=z.next,z.next=x),_.pending=x}function Kp(_,x,z){if(z&4194240){var U=x.lanes;U&=_.pendingLanes,z|=U,x.lanes=z,Rc(_,z)}}var Zh={readContext:nn,useCallback:Io,useContext:Io,useEffect:Io,useImperativeHandle:Io,useInsertionEffect:Io,useLayoutEffect:Io,useMemo:Io,useReducer:Io,useRef:Io,useState:Io,useDebugValue:Io,useDeferredValue:Io,useTransition:Io,useMutableSource:Io,useSyncExternalStore:Io,useId:Io,unstable_isNewReconciler:!1},Jp={readContext:nn,useCallback:function(_,x){return da().memoizedState=[_,x===void 0?null:x],_},useContext:nn,useEffect:qh,useImperativeHandle:function(_,x,z){return z=z!=null?z.concat([_]):null,pc(4194308,4,$u.bind(null,x,_),z)},useLayoutEffect:function(_,x){return pc(4194308,4,_,x)},useInsertionEffect:function(_,x){return pc(4,2,_,x)},useMemo:function(_,x){var z=da();return x=x===void 0?null:x,_=_(),z.memoizedState=[_,x],_},useReducer:function(_,x,z){var U=da();return x=z!==void 0?z(x):x,U.memoizedState=U.baseState=x,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:x},U.queue=_,_=_.dispatch=Cs.bind(null,Li,_),[U.memoizedState,_]},useRef:function(_){var x=da();return _={current:_},x.memoizedState=_},useState:Gh,useDebugValue:Hh,useDeferredValue:function(_){return da().memoizedState=_},useTransition:function(){var _=Gh(!1),x=_[0];return _=Ud.bind(null,_[1]),da().memoizedState=_,[x,_]},useMutableSource:function(){},useSyncExternalStore:function(_,x,z){var U=Li,ee=da();if(Ni){if(z===void 0)throw Error(s(407));z=z()}else{if(z=x(),pt===null)throw Error(s(349));Go&30||Vh(U,x,z)}ee.memoizedState=z;var le={value:z,getSnapshot:x};return ee.queue=le,qh(Kc.bind(null,U,le,_),[_]),U.flags|=2048,Jc(9,Bd.bind(null,U,le,z,x),void 0,null),z},useId:function(){var _=da(),x=pt.identifierPrefix;if(Ni){var z=yo,U=Ga;z=(U&~(1<<32-Jo(U)-1)).toString(32)+z,x=":"+x+"R"+z,z=Zs++,0<z&&(x+="H"+z.toString(32)),x+=":"}else z=dc++,x=":"+x+"r"+z.toString(32)+":";return _.memoizedState=x},unstable_isNewReconciler:!1},Ui={readContext:nn,useCallback:Wp,useContext:nn,useEffect:eu,useImperativeHandle:qp,useInsertionEffect:Wh,useLayoutEffect:jd,useMemo:Hp,useReducer:ju,useRef:hc,useState:function(){return ju(Yc)},useDebugValue:Hh,useDeferredValue:function(_){var x=Ao();return Zp(x,ji.memoizedState,_)},useTransition:function(){var _=ju(Yc)[0],x=Ao().memoizedState;return[_,x]},useMutableSource:$h,useSyncExternalStore:Po,useId:Vu,unstable_isNewReconciler:!1},Xh={readContext:nn,useCallback:Wp,useContext:nn,useEffect:eu,useImperativeHandle:qp,useInsertionEffect:Wh,useLayoutEffect:jd,useMemo:Hp,useReducer:Uu,useRef:hc,useState:function(){return Uu(Yc)},useDebugValue:Hh,useDeferredValue:function(_){var x=Ao();return ji===null?x.memoizedState=_:Zp(x,ji.memoizedState,_)},useTransition:function(){var _=Uu(Yc)[0],x=Ao().memoizedState;return[_,x]},useMutableSource:$h,useSyncExternalStore:Po,useId:Vu,unstable_isNewReconciler:!1};function Ea(_,x){if(_&&_.defaultProps){x=Bt({},x),_=_.defaultProps;for(var z in _)x[z]===void 0&&(x[z]=_[z]);return x}return x}function Qp(_,x,z,U){x=_.memoizedState,z=z(U,x),z=z==null?x:Bt({},x,z),_.memoizedState=z,_.lanes===0&&(_.updateQueue.baseState=z)}var Xa={isMounted:function(_){return(_=_._reactInternals)?an(_)===_:!1},enqueueSetState:function(_,x,z){_=_._reactInternals;var U=xr(),ee=Fr(_),le=Ha(U,ee);le.payload=x,z!=null&&(le.callback=z),x=Sl(_,le,ee),x!==null&&(Wn(x,_,ee,U),Tl(x,_,ee))},enqueueReplaceState:function(_,x,z){_=_._reactInternals;var U=xr(),ee=Fr(_),le=Ha(U,ee);le.tag=1,le.payload=x,z!=null&&(le.callback=z),x=Sl(_,le,ee),x!==null&&(Wn(x,_,ee,U),Tl(x,_,ee))},enqueueForceUpdate:function(_,x){_=_._reactInternals;var z=xr(),U=Fr(_),ee=Ha(z,U);ee.tag=2,x!=null&&(ee.callback=x),x=Sl(_,ee,U),x!==null&&(Wn(x,_,U,z),Tl(x,_,U))}};function ef(_,x,z,U,ee,le,Ie){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(U,le,Ie):x.prototype&&x.prototype.isPureReactComponent?!jc(z,U)||!jc(ee,le):!0}function Vd(_,x,z){var U=!1,ee=$a,le=x.contextType;return typeof le=="object"&&le!==null?le=nn(le):(ee=ws(x)?nc:Mo.current,U=x.contextTypes,le=(U=U!=null)?Va(_,ee):$a),x=new x(z,le),_.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Xa,_.stateNode=x,x._reactInternals=_,U&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=ee,_.__reactInternalMemoizedMaskedChildContext=le),x}function Gu(_,x,z,U){_=x.state,typeof x.componentWillReceiveProps=="function"&&x.componentWillReceiveProps(z,U),typeof x.UNSAFE_componentWillReceiveProps=="function"&&x.UNSAFE_componentWillReceiveProps(z,U),x.state!==_&&Xa.enqueueReplaceState(x,x.state,null)}function Ca(_,x,z,U){var ee=_.stateNode;ee.props=z,ee.state=_.memoizedState,ee.refs={},Dd(_);var le=x.contextType;typeof le=="object"&&le!==null?ee.context=nn(le):(le=ws(x)?nc:Mo.current,ee.context=Va(_,le)),ee.state=_.memoizedState,le=x.getDerivedStateFromProps,typeof le=="function"&&(Qp(_,x,le,z),ee.state=_.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(x=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),x!==ee.state&&Xa.enqueueReplaceState(ee,ee.state,null),jh(_,z,ee,U),ee.state=_.memoizedState),typeof ee.componentDidMount=="function"&&(_.flags|=4194308)}function Ma(_,x){try{var z="",U=x;do z+=Mt(U),U=U.return;while(U);var ee=z}catch(le){ee=`
Error generating stack: `+le.message+`
`+le.stack}return{value:_,source:x,stack:ee,digest:null}}function wi(_,x,z){return{value:_,source:null,stack:z??null,digest:x??null}}function Xs(_,x){try{console.error(x.value)}catch(z){setTimeout(function(){throw z})}}var tf=typeof WeakMap=="function"?WeakMap:Map;function qu(_,x,z){z=Ha(-1,z),z.tag=3,z.payload={element:null};var U=x.value;return z.callback=function(){cn||(cn=!0,mn=U),Xs(_,x)},z}function nf(_,x,z){z=Ha(-1,z),z.tag=3;var U=_.type.getDerivedStateFromError;if(typeof U=="function"){var ee=x.value;z.payload=function(){return U(ee)},z.callback=function(){Xs(_,x)}}var le=_.stateNode;return le!==null&&typeof le.componentDidCatch=="function"&&(z.callback=function(){Xs(_,x),typeof U!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var Ie=x.stack;this.componentDidCatch(x.value,{componentStack:Ie!==null?Ie:""})}),z}function Yh(_,x,z){var U=_.pingCache;if(U===null){U=_.pingCache=new tf;var ee=new Set;U.set(x,ee)}else ee=U.get(x),ee===void 0&&(ee=new Set,U.set(x,ee));ee.has(z)||(ee.add(z),_=Ja.bind(null,_,x,z),x.then(_,_))}function Wu(_){do{var x;if((x=_.tag===13)&&(x=_.memoizedState,x=x!==null?x.dehydrated!==null:!0),x)return _;_=_.return}while(_!==null);return null}function cm(_,x,z,U,ee){return _.mode&1?(_.flags|=65536,_.lanes=ee,_):(_===x?_.flags|=65536:(_.flags|=128,z.flags|=131072,z.flags&=-52805,z.tag===1&&(z.alternate===null?z.tag=17:(x=Ha(-1,1),x.tag=2,Sl(z,x,1))),z.lanes|=1),_)}var Tg=ie.ReactCurrentOwner,rs=!1;function Oo(_,x,z,U){x.child=_===null?Hc(x,null,z,U):Jr(x,_.child,z,U)}function tu(_,x,z,U,ee){z=z.render;var le=x.ref;return Wt(x,ee),U=Od(_,x,z,U,le,ee),z=Fd(),_!==null&&!rs?(x.updateQueue=_.updateQueue,x.flags&=-2053,_.lanes&=~ee,Ms(_,x,ee)):(Ni&&z&&Ld(x),x.flags|=1,Oo(_,x,U,ee),x.child)}function nu(_,x,z,U,ee){if(_===null){var le=z.type;return typeof le=="function"&&!Eg(le)&&le.defaultProps===void 0&&z.compare===null&&z.defaultProps===void 0?(x.tag=15,x.type=le,Ya(_,x,le,U,ee)):(_=sf(z.type,null,U,x,x.mode,ee),_.ref=x.ref,_.return=x,x.child=_)}if(le=_.child,!(_.lanes&ee)){var Ie=le.memoizedProps;if(z=z.compare,z=z!==null?z:jc,z(Ie,U)&&_.ref===x.ref)return Ms(_,x,ee)}return x.flags|=1,_=su(le,U),_.ref=x.ref,_.return=x,x.child=_}function Ya(_,x,z,U,ee){if(_!==null){var le=_.memoizedProps;if(jc(le,U)&&_.ref===x.ref)if(rs=!1,x.pendingProps=U=le,(_.lanes&ee)!==0)_.flags&131072&&(rs=!0);else return x.lanes=_.lanes,Ms(_,x,ee)}return Il(_,x,z,U,ee)}function ha(_,x,z){var U=x.pendingProps,ee=U.children,le=_!==null?_.memoizedState:null;if(U.mode==="hidden")if(!(x.mode&1))x.memoizedState={baseLanes:0,cachePool:null,transitions:null},ki(It,Je),Je|=z;else{if(!(z&1073741824))return _=le!==null?le.baseLanes|z:z,x.lanes=x.childLanes=1073741824,x.memoizedState={baseLanes:_,cachePool:null,transitions:null},x.updateQueue=null,ki(It,Je),Je|=_,null;x.memoizedState={baseLanes:0,cachePool:null,transitions:null},U=le!==null?le.baseLanes:z,ki(It,Je),Je|=U}else le!==null?(U=le.baseLanes|z,x.memoizedState=null):U=z,ki(It,Je),Je|=U;return Oo(_,x,ee,z),x.child}function Ml(_,x){var z=x.ref;(_===null&&z!==null||_!==null&&_.ref!==z)&&(x.flags|=512,x.flags|=2097152)}function Il(_,x,z,U,ee){var le=ws(z)?nc:Mo.current;return le=Va(x,le),Wt(x,ee),z=Od(_,x,z,U,le,ee),U=Fd(),_!==null&&!rs?(x.updateQueue=_.updateQueue,x.flags&=-2053,_.lanes&=~ee,Ms(_,x,ee)):(Ni&&U&&Ld(x),x.flags|=1,Oo(_,x,z,ee),x.child)}function Al(_,x,z,U,ee){if(ws(z)){var le=!0;zu(x)}else le=!1;if(Wt(x,ee),x.stateNode===null)fs(_,x),Vd(x,z,U),Ca(x,z,U,ee),U=!0;else if(_===null){var Ie=x.stateNode,lt=x.memoizedProps;Ie.props=lt;var vt=Ie.context,Vt=z.contextType;typeof Vt=="object"&&Vt!==null?Vt=nn(Vt):(Vt=ws(z)?nc:Mo.current,Vt=Va(x,Vt));var yn=z.getDerivedStateFromProps,wn=typeof yn=="function"||typeof Ie.getSnapshotBeforeUpdate=="function";wn||typeof Ie.UNSAFE_componentWillReceiveProps!="function"&&typeof Ie.componentWillReceiveProps!="function"||(lt!==U||vt!==Vt)&&Gu(x,Ie,U,Vt),Ta=!1;var vn=x.memoizedState;Ie.state=vn,jh(x,U,Ie,ee),vt=x.memoizedState,lt!==U||vn!==vt||ds.current||Ta?(typeof yn=="function"&&(Qp(x,z,yn,U),vt=x.memoizedState),(lt=Ta||ef(x,z,lt,U,vn,vt,Vt))?(wn||typeof Ie.UNSAFE_componentWillMount!="function"&&typeof Ie.componentWillMount!="function"||(typeof Ie.componentWillMount=="function"&&Ie.componentWillMount(),typeof Ie.UNSAFE_componentWillMount=="function"&&Ie.UNSAFE_componentWillMount()),typeof Ie.componentDidMount=="function"&&(x.flags|=4194308)):(typeof Ie.componentDidMount=="function"&&(x.flags|=4194308),x.memoizedProps=U,x.memoizedState=vt),Ie.props=U,Ie.state=vt,Ie.context=Vt,U=lt):(typeof Ie.componentDidMount=="function"&&(x.flags|=4194308),U=!1)}else{Ie=x.stateNode,Vp(_,x),lt=x.memoizedProps,Vt=x.type===x.elementType?lt:Ea(x.type,lt),Ie.props=Vt,wn=x.pendingProps,vn=Ie.context,vt=z.contextType,typeof vt=="object"&&vt!==null?vt=nn(vt):(vt=ws(z)?nc:Mo.current,vt=Va(x,vt));var Zn=z.getDerivedStateFromProps;(yn=typeof Zn=="function"||typeof Ie.getSnapshotBeforeUpdate=="function")||typeof Ie.UNSAFE_componentWillReceiveProps!="function"&&typeof Ie.componentWillReceiveProps!="function"||(lt!==wn||vn!==vt)&&Gu(x,Ie,U,vt),Ta=!1,vn=x.memoizedState,Ie.state=vn,jh(x,U,Ie,ee);var nr=x.memoizedState;lt!==wn||vn!==nr||ds.current||Ta?(typeof Zn=="function"&&(Qp(x,z,Zn,U),nr=x.memoizedState),(Vt=Ta||ef(x,z,Vt,U,vn,nr,vt)||!1)?(yn||typeof Ie.UNSAFE_componentWillUpdate!="function"&&typeof Ie.componentWillUpdate!="function"||(typeof Ie.componentWillUpdate=="function"&&Ie.componentWillUpdate(U,nr,vt),typeof Ie.UNSAFE_componentWillUpdate=="function"&&Ie.UNSAFE_componentWillUpdate(U,nr,vt)),typeof Ie.componentDidUpdate=="function"&&(x.flags|=4),typeof Ie.getSnapshotBeforeUpdate=="function"&&(x.flags|=1024)):(typeof Ie.componentDidUpdate!="function"||lt===_.memoizedProps&&vn===_.memoizedState||(x.flags|=4),typeof Ie.getSnapshotBeforeUpdate!="function"||lt===_.memoizedProps&&vn===_.memoizedState||(x.flags|=1024),x.memoizedProps=U,x.memoizedState=nr),Ie.props=U,Ie.state=nr,Ie.context=vt,U=Vt):(typeof Ie.componentDidUpdate!="function"||lt===_.memoizedProps&&vn===_.memoizedState||(x.flags|=4),typeof Ie.getSnapshotBeforeUpdate!="function"||lt===_.memoizedProps&&vn===_.memoizedState||(x.flags|=1024),U=!1)}return rf(_,x,z,U,le,ee)}function rf(_,x,z,U,ee,le){Ml(_,x);var Ie=(x.flags&128)!==0;if(!U&&!Ie)return ee&&kd(x,z,!1),Ms(_,x,le);U=x.stateNode,Tg.current=x;var lt=Ie&&typeof z.getDerivedStateFromError!="function"?null:U.render();return x.flags|=1,_!==null&&Ie?(x.child=Jr(x,_.child,null,le),x.child=Jr(x,null,lt,le)):Oo(_,x,lt,le),x.memoizedState=U.state,ee&&kd(x,z,!0),x.child}function Gd(_){var x=_.stateNode;x.pendingContext?Rh(_,x.pendingContext,x.pendingContext!==x.context):x.context&&Rh(_,x.context,!1),Hs(_,x.containerInfo)}function um(_,x,z,U,ee){return Gs(),qc(ee),x.flags|=256,Oo(_,x,z,U),x.child}var of={dehydrated:null,treeContext:null,retryLane:0};function ru(_){return{baseLanes:_,cachePool:null,transitions:null}}function qo(_,x,z){var U=x.pendingProps,ee=Qr.current,le=!1,Ie=(x.flags&128)!==0,lt;if((lt=Ie)||(lt=_!==null&&_.memoizedState===null?!1:(ee&2)!==0),lt?(le=!0,x.flags&=-129):(_===null||_.memoizedState!==null)&&(ee|=1),ki(Qr,ee&1),_===null)return la(x),_=x.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(x.mode&1?_.data==="$!"?x.lanes=8:x.lanes=1073741824:x.lanes=1,null):(Ie=U.children,_=U.fallback,le?(U=x.mode,le=x.child,Ie={mode:"hidden",children:Ie},!(U&1)&&le!==null?(le.childLanes=0,le.pendingProps=Ie):le=af(Ie,U,0,null),_=Xu(_,U,z,null),le.return=x,_.return=x,le.sibling=_,x.child=le,x.child.memoizedState=ru(z),x.memoizedState=of,_):Hu(x,Ie));if(ee=_.memoizedState,ee!==null&&(lt=ee.dehydrated,lt!==null))return dm(_,x,Ie,U,lt,ee,z);if(le){le=U.fallback,Ie=x.mode,ee=_.child,lt=ee.sibling;var vt={mode:"hidden",children:U.children};return!(Ie&1)&&x.child!==ee?(U=x.child,U.childLanes=0,U.pendingProps=vt,x.deletions=null):(U=su(ee,vt),U.subtreeFlags=ee.subtreeFlags&14680064),lt!==null?le=su(lt,le):(le=Xu(le,Ie,z,null),le.flags|=2),le.return=x,U.return=x,U.sibling=le,x.child=U,U=le,le=x.child,Ie=_.child.memoizedState,Ie=Ie===null?ru(z):{baseLanes:Ie.baseLanes|z,cachePool:null,transitions:Ie.transitions},le.memoizedState=Ie,le.childLanes=_.childLanes&~z,x.memoizedState=of,U}return le=_.child,_=le.sibling,U=su(le,{mode:"visible",children:U.children}),!(x.mode&1)&&(U.lanes=z),U.return=x,U.sibling=null,_!==null&&(z=x.deletions,z===null?(x.deletions=[_],x.flags|=16):z.push(_)),x.child=U,x.memoizedState=null,U}function Hu(_,x){return x=af({mode:"visible",children:x},_.mode,0,null),x.return=_,_.child=x}function qd(_,x,z,U){return U!==null&&qc(U),Jr(x,_.child,null,z),_=Hu(x,x.pendingProps.children),_.flags|=2,x.memoizedState=null,_}function dm(_,x,z,U,ee,le,Ie){if(z)return x.flags&256?(x.flags&=-257,U=wi(Error(s(422))),qd(_,x,Ie,U)):x.memoizedState!==null?(x.child=_.child,x.flags|=128,null):(le=U.fallback,ee=x.mode,U=af({mode:"visible",children:U.children},ee,0,null),le=Xu(le,ee,Ie,null),le.flags|=2,U.return=x,le.return=x,U.sibling=le,x.child=U,x.mode&1&&Jr(x,_.child,null,Ie),x.child.memoizedState=ru(Ie),x.memoizedState=of,le);if(!(x.mode&1))return qd(_,x,Ie,null);if(ee.data==="$!"){if(U=ee.nextSibling&&ee.nextSibling.dataset,U)var lt=U.dgst;return U=lt,le=Error(s(419)),U=wi(le,U,void 0),qd(_,x,Ie,U)}if(lt=(Ie&_.childLanes)!==0,rs||lt){if(U=pt,U!==null){switch(Ie&-Ie){case 4:ee=2;break;case 16:ee=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ee=32;break;case 536870912:ee=268435456;break;default:ee=0}ee=ee&(U.suspendedLanes|Ie)?0:ee,ee!==0&&ee!==le.retryLane&&(le.retryLane=ee,Wa(_,ee),Wn(U,_,ee,-1))}return Ci(),U=wi(Error(s(421))),qd(_,x,Ie,U)}return ee.data==="$?"?(x.flags|=128,x.child=_.child,x=Xd.bind(null,_),ee._reactRetry=x,null):(_=le.treeContext,es=Jl(ee.nextSibling),Ss=x,Ni=!0,Ts=null,_!==null&&(Qo[dn++]=Ga,Qo[dn++]=yo,Qo[dn++]=wl,Ga=_.id,yo=_.overflow,wl=x),x=Hu(x,U.children),x.flags|=4096,x)}function fc(_,x,z){_.lanes|=x;var U=_.alternate;U!==null&&(U.lanes|=x),lc(_.return,x,z)}function Zu(_,x,z,U,ee){var le=_.memoizedState;le===null?_.memoizedState={isBackwards:x,rendering:null,renderingStartTime:0,last:U,tail:z,tailMode:ee}:(le.isBackwards=x,le.rendering=null,le.renderingStartTime=0,le.last=U,le.tail=z,le.tailMode=ee)}function Ys(_,x,z){var U=x.pendingProps,ee=U.revealOrder,le=U.tail;if(Oo(_,x,U.children,z),U=Qr.current,U&2)U=U&1|2,x.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=x.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&fc(_,z,x);else if(_.tag===19)fc(_,z,x);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===x)break e;for(;_.sibling===null;){if(_.return===null||_.return===x)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}U&=1}if(ki(Qr,U),!(x.mode&1))x.memoizedState=null;else switch(ee){case"forwards":for(z=x.child,ee=null;z!==null;)_=z.alternate,_!==null&&Uh(_)===null&&(ee=z),z=z.sibling;z=ee,z===null?(ee=x.child,x.child=null):(ee=z.sibling,z.sibling=null),Zu(x,!1,ee,z,le);break;case"backwards":for(z=null,ee=x.child,x.child=null;ee!==null;){if(_=ee.alternate,_!==null&&Uh(_)===null){x.child=ee;break}_=ee.sibling,ee.sibling=z,z=ee,ee=_}Zu(x,!0,z,null,le);break;case"together":Zu(x,!1,null,null,void 0);break;default:x.memoizedState=null}return x.child}function fs(_,x){!(x.mode&1)&&_!==null&&(_.alternate=null,x.alternate=null,x.flags|=2)}function Ms(_,x,z){if(_!==null&&(x.dependencies=_.dependencies),ut|=x.lanes,!(z&x.childLanes))return null;if(_!==null&&x.child!==_.child)throw Error(s(153));if(x.child!==null){for(_=x.child,z=su(_,_.pendingProps),x.child=z,z.return=x;_.sibling!==null;)_=_.sibling,z=z.sibling=su(_,_.pendingProps),z.return=x;z.sibling=null}return x.child}function mc(_,x,z){switch(x.tag){case 3:Gd(x),Gs();break;case 5:uc(x);break;case 1:ws(x.type)&&zu(x);break;case 4:Hs(x,x.stateNode.containerInfo);break;case 10:var U=x.type._context,ee=x.memoizedProps.value;ki(Zc,U._currentValue),U._currentValue=ee;break;case 13:if(U=x.memoizedState,U!==null)return U.dehydrated!==null?(ki(Qr,Qr.current&1),x.flags|=128,null):z&x.child.childLanes?qo(_,x,z):(ki(Qr,Qr.current&1),_=Ms(_,x,z),_!==null?_.sibling:null);ki(Qr,Qr.current&1);break;case 19:if(U=(z&x.childLanes)!==0,_.flags&128){if(U)return Ys(_,x,z);x.flags|=128}if(ee=x.memoizedState,ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),ki(Qr,Qr.current),U)break;return null;case 22:case 23:return x.lanes=0,ha(_,x,z)}return Ms(_,x,z)}var iu,Wd,Or,Pl;iu=function(_,x){for(var z=x.child;z!==null;){if(z.tag===5||z.tag===6)_.appendChild(z.stateNode);else if(z.tag!==4&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===x)break;for(;z.sibling===null;){if(z.return===null||z.return===x)return;z=z.return}z.sibling.return=z.return,z=z.sibling}},Wd=function(){},Or=function(_,x,z,U){var ee=_.memoizedProps;if(ee!==U){_=x.stateNode,Za(Ws.current);var le=null;switch(z){case"input":ee=_t(_,ee),U=_t(_,U),le=[];break;case"select":ee=Bt({},ee,{value:void 0}),U=Bt({},U,{value:void 0}),le=[];break;case"textarea":ee=On(_,ee),U=On(_,U),le=[];break;default:typeof ee.onClick!="function"&&typeof U.onClick=="function"&&(_.onclick=$c)}Ar(z,U);var Ie;z=null;for(Vt in ee)if(!U.hasOwnProperty(Vt)&&ee.hasOwnProperty(Vt)&&ee[Vt]!=null)if(Vt==="style"){var lt=ee[Vt];for(Ie in lt)lt.hasOwnProperty(Ie)&&(z||(z={}),z[Ie]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(m.hasOwnProperty(Vt)?le||(le=[]):(le=le||[]).push(Vt,null));for(Vt in U){var vt=U[Vt];if(lt=ee!=null?ee[Vt]:void 0,U.hasOwnProperty(Vt)&&vt!==lt&&(vt!=null||lt!=null))if(Vt==="style")if(lt){for(Ie in lt)!lt.hasOwnProperty(Ie)||vt&&vt.hasOwnProperty(Ie)||(z||(z={}),z[Ie]="");for(Ie in vt)vt.hasOwnProperty(Ie)&&lt[Ie]!==vt[Ie]&&(z||(z={}),z[Ie]=vt[Ie])}else z||(le||(le=[]),le.push(Vt,z)),z=vt;else Vt==="dangerouslySetInnerHTML"?(vt=vt?vt.__html:void 0,lt=lt?lt.__html:void 0,vt!=null&&lt!==vt&&(le=le||[]).push(Vt,vt)):Vt==="children"?typeof vt!="string"&&typeof vt!="number"||(le=le||[]).push(Vt,""+vt):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(m.hasOwnProperty(Vt)?(vt!=null&&Vt==="onScroll"&&Ri("scroll",_),le||lt===vt||(le=[])):(le=le||[]).push(Vt,vt))}z&&(le=le||[]).push("style",z);var Vt=le;(x.updateQueue=Vt)&&(x.flags|=4)}},Pl=function(_,x,z,U){z!==U&&(x.flags|=4)};function Hd(_,x){if(!Ni)switch(_.tailMode){case"hidden":x=_.tail;for(var z=null;x!==null;)x.alternate!==null&&(z=x),x=x.sibling;z===null?_.tail=null:z.sibling=null;break;case"collapsed":z=_.tail;for(var U=null;z!==null;)z.alternate!==null&&(U=z),z=z.sibling;U===null?x||_.tail===null?_.tail=null:_.tail.sibling=null:U.sibling=null}}function Wo(_){var x=_.alternate!==null&&_.alternate.child===_.child,z=0,U=0;if(x)for(var ee=_.child;ee!==null;)z|=ee.lanes|ee.childLanes,U|=ee.subtreeFlags&14680064,U|=ee.flags&14680064,ee.return=_,ee=ee.sibling;else for(ee=_.child;ee!==null;)z|=ee.lanes|ee.childLanes,U|=ee.subtreeFlags,U|=ee.flags,ee.return=_,ee=ee.sibling;return _.subtreeFlags|=U,_.childLanes=z,x}function Zd(_,x,z){var U=x.pendingProps;switch(Dh(x),x.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(x),null;case 1:return ws(x.type)&&Pd(),Wo(x),null;case 3:return U=x.stateNode,ns(),Ai(ds),Ai(Mo),li(),U.pendingContext&&(U.context=U.pendingContext,U.pendingContext=null),(_===null||_.child===null)&&(Ou(x)?x.flags|=4:_===null||_.memoizedState.isDehydrated&&!(x.flags&256)||(x.flags|=1024,Ts!==null&&(yi(Ts),Ts=null))),Wd(_,x),Wo(x),null;case 5:Gp(x);var ee=Za(Fu.current);if(z=x.type,_!==null&&x.stateNode!=null)Or(_,x,z,U,ee),_.ref!==x.ref&&(x.flags|=512,x.flags|=2097152);else{if(!U){if(x.stateNode===null)throw Error(s(166));return Wo(x),null}if(_=Za(Ws.current),Ou(x)){U=x.stateNode,z=x.type;var le=x.memoizedProps;switch(U[bs]=x,U[Gc]=le,_=(x.mode&1)!==0,z){case"dialog":Ri("cancel",U),Ri("close",U);break;case"iframe":case"object":case"embed":Ri("load",U);break;case"video":case"audio":for(ee=0;ee<Td.length;ee++)Ri(Td[ee],U);break;case"source":Ri("error",U);break;case"img":case"image":case"link":Ri("error",U),Ri("load",U);break;case"details":Ri("toggle",U);break;case"input":er(U,le),Ri("invalid",U);break;case"select":U._wrapperState={wasMultiple:!!le.multiple},Ri("invalid",U);break;case"textarea":fi(U,le),Ri("invalid",U)}Ar(z,le),ee=null;for(var Ie in le)if(le.hasOwnProperty(Ie)){var lt=le[Ie];Ie==="children"?typeof lt=="string"?U.textContent!==lt&&(le.suppressHydrationWarning!==!0&&Pu(U.textContent,lt,_),ee=["children",lt]):typeof lt=="number"&&U.textContent!==""+lt&&(le.suppressHydrationWarning!==!0&&Pu(U.textContent,lt,_),ee=["children",""+lt]):m.hasOwnProperty(Ie)&&lt!=null&&Ie==="onScroll"&&Ri("scroll",U)}switch(z){case"input":Dn(U),_n(U,le,!0);break;case"textarea":Dn(U),Ft(U);break;case"select":case"option":break;default:typeof le.onClick=="function"&&(U.onclick=$c)}U=ee,x.updateQueue=U,U!==null&&(x.flags|=4)}else{Ie=ee.nodeType===9?ee:ee.ownerDocument,_==="http://www.w3.org/1999/xhtml"&&(_=sn(z)),_==="http://www.w3.org/1999/xhtml"?z==="script"?(_=Ie.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild)):typeof U.is=="string"?_=Ie.createElement(z,{is:U.is}):(_=Ie.createElement(z),z==="select"&&(Ie=_,U.multiple?Ie.multiple=!0:U.size&&(Ie.size=U.size))):_=Ie.createElementNS(_,z),_[bs]=x,_[Gc]=U,iu(_,x,!1,!1),x.stateNode=_;e:{switch(Ie=si(z,U),z){case"dialog":Ri("cancel",_),Ri("close",_),ee=U;break;case"iframe":case"object":case"embed":Ri("load",_),ee=U;break;case"video":case"audio":for(ee=0;ee<Td.length;ee++)Ri(Td[ee],_);ee=U;break;case"source":Ri("error",_),ee=U;break;case"img":case"image":case"link":Ri("error",_),Ri("load",_),ee=U;break;case"details":Ri("toggle",_),ee=U;break;case"input":er(_,U),ee=_t(_,U),Ri("invalid",_);break;case"option":ee=U;break;case"select":_._wrapperState={wasMultiple:!!U.multiple},ee=Bt({},U,{value:void 0}),Ri("invalid",_);break;case"textarea":fi(_,U),ee=On(_,U),Ri("invalid",_);break;default:ee=U}Ar(z,ee),lt=ee;for(le in lt)if(lt.hasOwnProperty(le)){var vt=lt[le];le==="style"?qr(_,vt):le==="dangerouslySetInnerHTML"?(vt=vt?vt.__html:void 0,vt!=null&&ur(_,vt)):le==="children"?typeof vt=="string"?(z!=="textarea"||vt!=="")&&Bn(_,vt):typeof vt=="number"&&Bn(_,""+vt):le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&le!=="autoFocus"&&(m.hasOwnProperty(le)?vt!=null&&le==="onScroll"&&Ri("scroll",_):vt!=null&&se(_,le,vt,Ie))}switch(z){case"input":Dn(_),_n(_,U,!1);break;case"textarea":Dn(_),Ft(_);break;case"option":U.value!=null&&_.setAttribute("value",""+hn(U.value));break;case"select":_.multiple=!!U.multiple,le=U.value,le!=null?Er(_,!!U.multiple,le,!1):U.defaultValue!=null&&Er(_,!!U.multiple,U.defaultValue,!0);break;default:typeof ee.onClick=="function"&&(_.onclick=$c)}switch(z){case"button":case"input":case"select":case"textarea":U=!!U.autoFocus;break e;case"img":U=!0;break e;default:U=!1}}U&&(x.flags|=4)}x.ref!==null&&(x.flags|=512,x.flags|=2097152)}return Wo(x),null;case 6:if(_&&x.stateNode!=null)Pl(_,x,_.memoizedProps,U);else{if(typeof U!="string"&&x.stateNode===null)throw Error(s(166));if(z=Za(Fu.current),Za(Ws.current),Ou(x)){if(U=x.stateNode,z=x.memoizedProps,U[bs]=x,(le=U.nodeValue!==z)&&(_=Ss,_!==null))switch(_.tag){case 3:Pu(U.nodeValue,z,(_.mode&1)!==0);break;case 5:_.memoizedProps.suppressHydrationWarning!==!0&&Pu(U.nodeValue,z,(_.mode&1)!==0)}le&&(x.flags|=4)}else U=(z.nodeType===9?z:z.ownerDocument).createTextNode(U),U[bs]=x,x.stateNode=U}return Wo(x),null;case 13:if(Ai(Qr),U=x.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(Ni&&es!==null&&x.mode&1&&!(x.flags&128))ts(),Gs(),x.flags|=98560,le=!1;else if(le=Ou(x),U!==null&&U.dehydrated!==null){if(_===null){if(!le)throw Error(s(318));if(le=x.memoizedState,le=le!==null?le.dehydrated:null,!le)throw Error(s(317));le[bs]=x}else Gs(),!(x.flags&128)&&(x.memoizedState=null),x.flags|=4;Wo(x),le=!1}else Ts!==null&&(yi(Ts),Ts=null),le=!0;if(!le)return x.flags&65536?x:null}return x.flags&128?(x.lanes=z,x):(U=U!==null,U!==(_!==null&&_.memoizedState!==null)&&U&&(x.child.flags|=8192,x.mode&1&&(_===null||Qr.current&1?kt===0&&(kt=3):Ci())),x.updateQueue!==null&&(x.flags|=4),Wo(x),null);case 4:return ns(),Wd(_,x),_===null&&Au(x.stateNode.containerInfo),Wo(x),null;case 10:return ac(x.type._context),Wo(x),null;case 17:return ws(x.type)&&Pd(),Wo(x),null;case 19:if(Ai(Qr),le=x.memoizedState,le===null)return Wo(x),null;if(U=(x.flags&128)!==0,Ie=le.rendering,Ie===null)if(U)Hd(le,!1);else{if(kt!==0||_!==null&&_.flags&128)for(_=x.child;_!==null;){if(Ie=Uh(_),Ie!==null){for(x.flags|=128,Hd(le,!1),U=Ie.updateQueue,U!==null&&(x.updateQueue=U,x.flags|=4),x.subtreeFlags=0,U=z,z=x.child;z!==null;)le=z,_=U,le.flags&=14680066,Ie=le.alternate,Ie===null?(le.childLanes=0,le.lanes=_,le.child=null,le.subtreeFlags=0,le.memoizedProps=null,le.memoizedState=null,le.updateQueue=null,le.dependencies=null,le.stateNode=null):(le.childLanes=Ie.childLanes,le.lanes=Ie.lanes,le.child=Ie.child,le.subtreeFlags=0,le.deletions=null,le.memoizedProps=Ie.memoizedProps,le.memoizedState=Ie.memoizedState,le.updateQueue=Ie.updateQueue,le.type=Ie.type,_=Ie.dependencies,le.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),z=z.sibling;return ki(Qr,Qr.current&1|2),x.child}_=_.sibling}le.tail!==null&&Vr()>on&&(x.flags|=128,U=!0,Hd(le,!1),x.lanes=4194304)}else{if(!U)if(_=Uh(Ie),_!==null){if(x.flags|=128,U=!0,z=_.updateQueue,z!==null&&(x.updateQueue=z,x.flags|=4),Hd(le,!0),le.tail===null&&le.tailMode==="hidden"&&!Ie.alternate&&!Ni)return Wo(x),null}else 2*Vr()-le.renderingStartTime>on&&z!==1073741824&&(x.flags|=128,U=!0,Hd(le,!1),x.lanes=4194304);le.isBackwards?(Ie.sibling=x.child,x.child=Ie):(z=le.last,z!==null?z.sibling=Ie:x.child=Ie,le.last=Ie)}return le.tail!==null?(x=le.tail,le.rendering=x,le.tail=x.sibling,le.renderingStartTime=Vr(),x.sibling=null,z=Qr.current,ki(Qr,U?z&1|2:z&1),x):(Wo(x),null);case 22:case 23:return Ei(),U=x.memoizedState!==null,_!==null&&_.memoizedState!==null!==U&&(x.flags|=8192),U&&x.mode&1?Je&1073741824&&(Wo(x),x.subtreeFlags&6&&(x.flags|=8192)):Wo(x),null;case 24:return null;case 25:return null}throw Error(s(156,x.tag))}function Ka(_,x){switch(Dh(x),x.tag){case 1:return ws(x.type)&&Pd(),_=x.flags,_&65536?(x.flags=_&-65537|128,x):null;case 3:return ns(),Ai(ds),Ai(Mo),li(),_=x.flags,_&65536&&!(_&128)?(x.flags=_&-65537|128,x):null;case 5:return Gp(x),null;case 13:if(Ai(Qr),_=x.memoizedState,_!==null&&_.dehydrated!==null){if(x.alternate===null)throw Error(s(340));Gs()}return _=x.flags,_&65536?(x.flags=_&-65537|128,x):null;case 19:return Ai(Qr),null;case 4:return ns(),null;case 10:return ac(x.type._context),null;case 22:case 23:return Ei(),null;case 24:return null;default:return null}}var pa=!1,vi=!1,Is=typeof WeakSet=="function"?WeakSet:Set,Ln=null;function ou(_,x){var z=_.ref;if(z!==null)if(typeof z=="function")try{z(null)}catch(U){Mi(_,x,U)}else z.current=null}function Fo(_,x,z){try{z()}catch(U){Mi(_,x,U)}}var hm=!1;function h(_,x){if(Id=_o,_=Fp(),vd(_)){if("selectionStart"in _)var z={start:_.selectionStart,end:_.selectionEnd};else e:{z=(z=_.ownerDocument)&&z.defaultView||window;var U=z.getSelection&&z.getSelection();if(U&&U.rangeCount!==0){z=U.anchorNode;var ee=U.anchorOffset,le=U.focusNode;U=U.focusOffset;try{z.nodeType,le.nodeType}catch{z=null;break e}var Ie=0,lt=-1,vt=-1,Vt=0,yn=0,wn=_,vn=null;t:for(;;){for(var Zn;wn!==z||ee!==0&&wn.nodeType!==3||(lt=Ie+ee),wn!==le||U!==0&&wn.nodeType!==3||(vt=Ie+U),wn.nodeType===3&&(Ie+=wn.nodeValue.length),(Zn=wn.firstChild)!==null;)vn=wn,wn=Zn;for(;;){if(wn===_)break t;if(vn===z&&++Vt===ee&&(lt=Ie),vn===le&&++yn===U&&(vt=Ie),(Zn=wn.nextSibling)!==null)break;wn=vn,vn=wn.parentNode}wn=Zn}z=lt===-1||vt===-1?null:{start:lt,end:vt}}else z=null}z=z||{start:0,end:0}}else z=null;for(Ad={focusedElem:_,selectionRange:z},_o=!1,Ln=x;Ln!==null;)if(x=Ln,_=x.child,(x.subtreeFlags&1028)!==0&&_!==null)_.return=x,Ln=_;else for(;Ln!==null;){x=Ln;try{var nr=x.alternate;if(x.flags&1024)switch(x.tag){case 0:case 11:case 15:break;case 1:if(nr!==null){var or=nr.memoizedProps,co=nr.memoizedState,Ot=x.stateNode,St=Ot.getSnapshotBeforeUpdate(x.elementType===x.type?or:Ea(x.type,or),co);Ot.__reactInternalSnapshotBeforeUpdate=St}break;case 3:var jt=x.stateNode.containerInfo;jt.nodeType===1?jt.textContent="":jt.nodeType===9&&jt.documentElement&&jt.removeChild(jt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(An){Mi(x,x.return,An)}if(_=x.sibling,_!==null){_.return=x.return,Ln=_;break}Ln=x.return}return nr=hm,hm=!1,nr}function t(_,x,z){var U=x.updateQueue;if(U=U!==null?U.lastEffect:null,U!==null){var ee=U=U.next;do{if((ee.tag&_)===_){var le=ee.destroy;ee.destroy=void 0,le!==void 0&&Fo(x,z,le)}ee=ee.next}while(ee!==U)}}function a(_,x){if(x=x.updateQueue,x=x!==null?x.lastEffect:null,x!==null){var z=x=x.next;do{if((z.tag&_)===_){var U=z.create;z.destroy=U()}z=z.next}while(z!==x)}}function p(_){var x=_.ref;if(x!==null){var z=_.stateNode;switch(_.tag){case 5:_=z;break;default:_=z}typeof x=="function"?x(_):x.current=_}}function v(_){var x=_.alternate;x!==null&&(_.alternate=null,v(x)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(x=_.stateNode,x!==null&&(delete x[bs],delete x[Gc],delete x[Ql],delete x[sm],delete x[am])),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function b(_){return _.tag===5||_.tag===3||_.tag===4}function E(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||b(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function k(_,x,z){var U=_.tag;if(U===5||U===6)_=_.stateNode,x?z.nodeType===8?z.parentNode.insertBefore(_,x):z.insertBefore(_,x):(z.nodeType===8?(x=z.parentNode,x.insertBefore(_,z)):(x=z,x.appendChild(_)),z=z._reactRootContainer,z!=null||x.onclick!==null||(x.onclick=$c));else if(U!==4&&(_=_.child,_!==null))for(k(_,x,z),_=_.sibling;_!==null;)k(_,x,z),_=_.sibling}function O(_,x,z){var U=_.tag;if(U===5||U===6)_=_.stateNode,x?z.insertBefore(_,x):z.appendChild(_);else if(U!==4&&(_=_.child,_!==null))for(O(_,x,z),_=_.sibling;_!==null;)O(_,x,z),_=_.sibling}var N=null,$=!1;function W(_,x,z){for(z=z.child;z!==null;)Z(_,x,z),z=z.sibling}function Z(_,x,z){if(Ko&&typeof Ko.onCommitFiberUnmount=="function")try{Ko.onCommitFiberUnmount(Mc,z)}catch{}switch(z.tag){case 5:vi||ou(z,x);case 6:var U=N,ee=$;N=null,W(_,x,z),N=U,$=ee,N!==null&&($?(_=N,z=z.stateNode,_.nodeType===8?_.parentNode.removeChild(z):_.removeChild(z)):N.removeChild(z.stateNode));break;case 18:N!==null&&($?(_=N,z=z.stateNode,_.nodeType===8?Np(_.parentNode,z):_.nodeType===1&&Np(_,z),Ns(_)):Np(N,z.stateNode));break;case 4:U=N,ee=$,N=z.stateNode.containerInfo,$=!0,W(_,x,z),N=U,$=ee;break;case 0:case 11:case 14:case 15:if(!vi&&(U=z.updateQueue,U!==null&&(U=U.lastEffect,U!==null))){ee=U=U.next;do{var le=ee,Ie=le.destroy;le=le.tag,Ie!==void 0&&(le&2||le&4)&&Fo(z,x,Ie),ee=ee.next}while(ee!==U)}W(_,x,z);break;case 1:if(!vi&&(ou(z,x),U=z.stateNode,typeof U.componentWillUnmount=="function"))try{U.props=z.memoizedProps,U.state=z.memoizedState,U.componentWillUnmount()}catch(lt){Mi(z,x,lt)}W(_,x,z);break;case 21:W(_,x,z);break;case 22:z.mode&1?(vi=(U=vi)||z.memoizedState!==null,W(_,x,z),vi=U):W(_,x,z);break;default:W(_,x,z)}}function Y(_){var x=_.updateQueue;if(x!==null){_.updateQueue=null;var z=_.stateNode;z===null&&(z=_.stateNode=new Is),x.forEach(function(U){var ee=Kh.bind(null,_,U);z.has(U)||(z.add(U),U.then(ee,ee))})}}function he(_,x){var z=x.deletions;if(z!==null)for(var U=0;U<z.length;U++){var ee=z[U];try{var le=_,Ie=x,lt=Ie;e:for(;lt!==null;){switch(lt.tag){case 5:N=lt.stateNode,$=!1;break e;case 3:N=lt.stateNode.containerInfo,$=!0;break e;case 4:N=lt.stateNode.containerInfo,$=!0;break e}lt=lt.return}if(N===null)throw Error(s(160));Z(le,Ie,ee),N=null,$=!1;var vt=ee.alternate;vt!==null&&(vt.return=null),ee.return=null}catch(Vt){Mi(ee,x,Vt)}}if(x.subtreeFlags&12854)for(x=x.child;x!==null;)ue(x,_),x=x.sibling}function ue(_,x){var z=_.alternate,U=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(he(x,_),me(_),U&4){try{t(3,_,_.return),a(3,_)}catch(or){Mi(_,_.return,or)}try{t(5,_,_.return)}catch(or){Mi(_,_.return,or)}}break;case 1:he(x,_),me(_),U&512&&z!==null&&ou(z,z.return);break;case 5:if(he(x,_),me(_),U&512&&z!==null&&ou(z,z.return),_.flags&32){var ee=_.stateNode;try{Bn(ee,"")}catch(or){Mi(_,_.return,or)}}if(U&4&&(ee=_.stateNode,ee!=null)){var le=_.memoizedProps,Ie=z!==null?z.memoizedProps:le,lt=_.type,vt=_.updateQueue;if(_.updateQueue=null,vt!==null)try{lt==="input"&&le.type==="radio"&&le.name!=null&&pr(ee,le),si(lt,Ie);var Vt=si(lt,le);for(Ie=0;Ie<vt.length;Ie+=2){var yn=vt[Ie],wn=vt[Ie+1];yn==="style"?qr(ee,wn):yn==="dangerouslySetInnerHTML"?ur(ee,wn):yn==="children"?Bn(ee,wn):se(ee,yn,wn,Vt)}switch(lt){case"input":qn(ee,le);break;case"textarea":Dt(ee,le);break;case"select":var vn=ee._wrapperState.wasMultiple;ee._wrapperState.wasMultiple=!!le.multiple;var Zn=le.value;Zn!=null?Er(ee,!!le.multiple,Zn,!1):vn!==!!le.multiple&&(le.defaultValue!=null?Er(ee,!!le.multiple,le.defaultValue,!0):Er(ee,!!le.multiple,le.multiple?[]:"",!1))}ee[Gc]=le}catch(or){Mi(_,_.return,or)}}break;case 6:if(he(x,_),me(_),U&4){if(_.stateNode===null)throw Error(s(162));ee=_.stateNode,le=_.memoizedProps;try{ee.nodeValue=le}catch(or){Mi(_,_.return,or)}}break;case 3:if(he(x,_),me(_),U&4&&z!==null&&z.memoizedState.isDehydrated)try{Ns(x.containerInfo)}catch(or){Mi(_,_.return,or)}break;case 4:he(x,_),me(_);break;case 13:he(x,_),me(_),ee=_.child,ee.flags&8192&&(le=ee.memoizedState!==null,ee.stateNode.isHidden=le,!le||ee.alternate!==null&&ee.alternate.memoizedState!==null||(Ct=Vr())),U&4&&Y(_);break;case 22:if(yn=z!==null&&z.memoizedState!==null,_.mode&1?(vi=(Vt=vi)||yn,he(x,_),vi=Vt):he(x,_),me(_),U&8192){if(Vt=_.memoizedState!==null,(_.stateNode.isHidden=Vt)&&!yn&&_.mode&1)for(Ln=_,yn=_.child;yn!==null;){for(wn=Ln=yn;Ln!==null;){switch(vn=Ln,Zn=vn.child,vn.tag){case 0:case 11:case 14:case 15:t(4,vn,vn.return);break;case 1:ou(vn,vn.return);var nr=vn.stateNode;if(typeof nr.componentWillUnmount=="function"){U=vn,z=vn.return;try{x=U,nr.props=x.memoizedProps,nr.state=x.memoizedState,nr.componentWillUnmount()}catch(or){Mi(U,z,or)}}break;case 5:ou(vn,vn.return);break;case 22:if(vn.memoizedState!==null){Me(wn);continue}}Zn!==null?(Zn.return=vn,Ln=Zn):Me(wn)}yn=yn.sibling}e:for(yn=null,wn=_;;){if(wn.tag===5){if(yn===null){yn=wn;try{ee=wn.stateNode,Vt?(le=ee.style,typeof le.setProperty=="function"?le.setProperty("display","none","important"):le.display="none"):(lt=wn.stateNode,vt=wn.memoizedProps.style,Ie=vt!=null&&vt.hasOwnProperty("display")?vt.display:null,lt.style.display=Lr("display",Ie))}catch(or){Mi(_,_.return,or)}}}else if(wn.tag===6){if(yn===null)try{wn.stateNode.nodeValue=Vt?"":wn.memoizedProps}catch(or){Mi(_,_.return,or)}}else if((wn.tag!==22&&wn.tag!==23||wn.memoizedState===null||wn===_)&&wn.child!==null){wn.child.return=wn,wn=wn.child;continue}if(wn===_)break e;for(;wn.sibling===null;){if(wn.return===null||wn.return===_)break e;yn===wn&&(yn=null),wn=wn.return}yn===wn&&(yn=null),wn.sibling.return=wn.return,wn=wn.sibling}}break;case 19:he(x,_),me(_),U&4&&Y(_);break;case 21:break;default:he(x,_),me(_)}}function me(_){var x=_.flags;if(x&2){try{e:{for(var z=_.return;z!==null;){if(b(z)){var U=z;break e}z=z.return}throw Error(s(160))}switch(U.tag){case 5:var ee=U.stateNode;U.flags&32&&(Bn(ee,""),U.flags&=-33);var le=E(_);O(_,le,ee);break;case 3:case 4:var Ie=U.stateNode.containerInfo,lt=E(_);k(_,lt,Ie);break;default:throw Error(s(161))}}catch(vt){Mi(_,_.return,vt)}_.flags&=-3}x&4096&&(_.flags&=-4097)}function ve(_,x,z){Ln=_,Se(_)}function Se(_,x,z){for(var U=(_.mode&1)!==0;Ln!==null;){var ee=Ln,le=ee.child;if(ee.tag===22&&U){var Ie=ee.memoizedState!==null||pa;if(!Ie){var lt=ee.alternate,vt=lt!==null&&lt.memoizedState!==null||vi;lt=pa;var Vt=vi;if(pa=Ie,(vi=vt)&&!Vt)for(Ln=ee;Ln!==null;)Ie=Ln,vt=Ie.child,Ie.tag===22&&Ie.memoizedState!==null?Fe(ee):vt!==null?(vt.return=Ie,Ln=vt):Fe(ee);for(;le!==null;)Ln=le,Se(le),le=le.sibling;Ln=ee,pa=lt,vi=Vt}Pe(_)}else ee.subtreeFlags&8772&&le!==null?(le.return=ee,Ln=le):Pe(_)}}function Pe(_){for(;Ln!==null;){var x=Ln;if(x.flags&8772){var z=x.alternate;try{if(x.flags&8772)switch(x.tag){case 0:case 11:case 15:vi||a(5,x);break;case 1:var U=x.stateNode;if(x.flags&4&&!vi)if(z===null)U.componentDidMount();else{var ee=x.elementType===x.type?z.memoizedProps:Ea(x.type,z.memoizedProps);U.componentDidUpdate(ee,z.memoizedState,U.__reactInternalSnapshotBeforeUpdate)}var le=x.updateQueue;le!==null&&cc(x,le,U);break;case 3:var Ie=x.updateQueue;if(Ie!==null){if(z=null,x.child!==null)switch(x.child.tag){case 5:z=x.child.stateNode;break;case 1:z=x.child.stateNode}cc(x,Ie,z)}break;case 5:var lt=x.stateNode;if(z===null&&x.flags&4){z=lt;var vt=x.memoizedProps;switch(x.type){case"button":case"input":case"select":case"textarea":vt.autoFocus&&z.focus();break;case"img":vt.src&&(z.src=vt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(x.memoizedState===null){var Vt=x.alternate;if(Vt!==null){var yn=Vt.memoizedState;if(yn!==null){var wn=yn.dehydrated;wn!==null&&Ns(wn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}vi||x.flags&512&&p(x)}catch(vn){Mi(x,x.return,vn)}}if(x===_){Ln=null;break}if(z=x.sibling,z!==null){z.return=x.return,Ln=z;break}Ln=x.return}}function Me(_){for(;Ln!==null;){var x=Ln;if(x===_){Ln=null;break}var z=x.sibling;if(z!==null){z.return=x.return,Ln=z;break}Ln=x.return}}function Fe(_){for(;Ln!==null;){var x=Ln;try{switch(x.tag){case 0:case 11:case 15:var z=x.return;try{a(4,x)}catch(vt){Mi(x,z,vt)}break;case 1:var U=x.stateNode;if(typeof U.componentDidMount=="function"){var ee=x.return;try{U.componentDidMount()}catch(vt){Mi(x,ee,vt)}}var le=x.return;try{p(x)}catch(vt){Mi(x,le,vt)}break;case 5:var Ie=x.return;try{p(x)}catch(vt){Mi(x,Ie,vt)}}}catch(vt){Mi(x,x.return,vt)}if(x===_){Ln=null;break}var lt=x.sibling;if(lt!==null){lt.return=x.return,Ln=lt;break}Ln=x.return}}var De=Math.ceil,Oe=ie.ReactCurrentDispatcher,ze=ie.ReactCurrentOwner,Ne=ie.ReactCurrentBatchConfig,je=0,pt=null,ot=null,Ve=0,Je=0,It=Us(0),kt=0,Ht=null,ut=0,Lt=0,xt=0,Gt=null,At=null,Ct=0,on=1/0,Zt=null,cn=!1,mn=null,jn=null,In=!1,Rn=null,Gn=0,br=0,dr=null,Yr=-1,ci=0;function xr(){return je&6?Vr():Yr!==-1?Yr:Yr=Vr()}function Fr(_){return _.mode&1?je&2&&Ve!==0?Ve&-Ve:Bh.transition!==null?(ci===0&&(ci=Ds()),ci):(_=ri,_!==0||(_=window.event,_=_===void 0?16:md(_.type)),_):1}function Wn(_,x,z,U){if(50<br)throw br=0,dr=null,Error(s(185));Fs(_,z,U),(!(je&2)||_!==pt)&&(_===pt&&(!(je&2)&&(Lt|=z),kt===4&&Yi(_,Ve)),Cn(_,U),z===1&&je===0&&!(x.mode&1)&&(on=Vr()+500,Du&&Sa()))}function Cn(_,x){var z=_.callbackNode;Ls(_,x);var U=Pc(_,_===pt?Ve:0);if(U===0)z!==null&&wr(z),_.callbackNode=null,_.callbackPriority=0;else if(x=U&-U,_.callbackPriority!==x){if(z!=null&&wr(z),x===1)_.tag===0?Lh(qi.bind(null,_)):kh(qi.bind(null,_)),wg(function(){!(je&6)&&Sa()}),z=null;else{switch(ul(U)){case 1:z=no;break;case 4:z=go;break;case 16:z=Aa;break;case 536870912:z=lh;break;default:z=Aa}z=hy(z,Br.bind(null,_))}_.callbackPriority=x,_.callbackNode=z}}function Br(_,x){if(Yr=-1,ci=0,je&6)throw Error(s(327));var z=_.callbackNode;if(os()&&_.callbackNode!==z)return null;var U=Pc(_,_===pt?Ve:0);if(U===0)return null;if(U&30||U&_.expiredLanes||x)x=io(_,U);else{x=U;var ee=je;je|=2;var le=Mr();(pt!==_||Ve!==x)&&(Zt=null,on=Vr()+500,Gr(_,x));do try{Ho();break}catch(lt){ii(_,lt)}while(!0);$p(),Oe.current=le,je=ee,ot!==null?x=0:(pt=null,Ve=0,x=kt)}if(x!==0){if(x===2&&(ee=zs(_),ee!==0&&(U=ee,x=$r(_,ee))),x===1)throw z=Ht,Gr(_,0),Yi(_,U),Cn(_,Vr()),z;if(x===6)Yi(_,U);else{if(ee=_.current.alternate,!(U&30)&&!Ro(ee)&&(x=io(_,U),x===2&&(le=zs(_),le!==0&&(U=le,x=$r(_,le))),x===1))throw z=Ht,Gr(_,0),Yi(_,U),Cn(_,Vr()),z;switch(_.finishedWork=ee,_.finishedLanes=U,x){case 0:case 1:throw Error(s(345));case 2:gs(_,At,Zt);break;case 3:if(Yi(_,U),(U&130023424)===U&&(x=Ct+500-Vr(),10<x)){if(Pc(_,0)!==0)break;if(ee=_.suspendedLanes,(ee&U)!==U){xr(),_.pingedLanes|=_.suspendedLanes&ee;break}_.timeoutHandle=Ph(gs.bind(null,_,At,Zt),x);break}gs(_,At,Zt);break;case 4:if(Yi(_,U),(U&4194240)===U)break;for(x=_.eventTimes,ee=-1;0<U;){var Ie=31-Jo(U);le=1<<Ie,Ie=x[Ie],Ie>ee&&(ee=Ie),U&=~le}if(U=ee,U=Vr()-U,U=(120>U?120:480>U?480:1080>U?1080:1920>U?1920:3e3>U?3e3:4320>U?4320:1960*De(U/1960))-U,10<U){_.timeoutHandle=Ph(gs.bind(null,_,At,Zt),U);break}gs(_,At,Zt);break;case 5:gs(_,At,Zt);break;default:throw Error(s(329))}}}return Cn(_,Vr()),_.callbackNode===z?Br.bind(null,_):null}function $r(_,x){var z=Gt;return _.current.memoizedState.isDehydrated&&(Gr(_,x).flags|=256),_=io(_,x),_!==2&&(x=At,At=z,x!==null&&yi(x)),_}function yi(_){At===null?At=_:At.push.apply(At,_)}function Ro(_){for(var x=_;;){if(x.flags&16384){var z=x.updateQueue;if(z!==null&&(z=z.stores,z!==null))for(var U=0;U<z.length;U++){var ee=z[U],le=ee.getSnapshot;ee=ee.value;try{if(!xa(le(),ee))return!1}catch{return!1}}}if(z=x.child,x.subtreeFlags&16384&&z!==null)z.return=x,x=z;else{if(x===_)break;for(;x.sibling===null;){if(x.return===null||x.return===_)return!0;x=x.return}x.sibling.return=x.return,x=x.sibling}}return!0}function Yi(_,x){for(x&=~xt,x&=~Lt,_.suspendedLanes|=x,_.pingedLanes&=~x,_=_.expirationTimes;0<x;){var z=31-Jo(x),U=1<<z;_[z]=-1,x&=~U}}function qi(_){if(je&6)throw Error(s(327));os();var x=Pc(_,0);if(!(x&1))return Cn(_,Vr()),null;var z=io(_,x);if(_.tag!==0&&z===2){var U=zs(_);U!==0&&(x=U,z=$r(_,U))}if(z===1)throw z=Ht,Gr(_,0),Yi(_,x),Cn(_,Vr()),z;if(z===6)throw Error(s(345));return _.finishedWork=_.current.alternate,_.finishedLanes=x,gs(_,At,Zt),Cn(_,Vr()),null}function ro(_,x){var z=je;je|=1;try{return _(x)}finally{je=z,je===0&&(on=Vr()+500,Du&&Sa())}}function Ki(_){Rn!==null&&Rn.tag===0&&!(je&6)&&os();var x=je;je|=1;var z=Ne.transition,U=ri;try{if(Ne.transition=null,ri=1,_)return _()}finally{ri=U,Ne.transition=z,je=x,!(je&6)&&Sa()}}function Ei(){Je=It.current,Ai(It)}function Gr(_,x){_.finishedWork=null,_.finishedLanes=0;var z=_.timeoutHandle;if(z!==-1&&(_.timeoutHandle=-1,im(z)),ot!==null)for(z=ot.return;z!==null;){var U=z;switch(Dh(U),U.tag){case 1:U=U.type.childContextTypes,U!=null&&Pd();break;case 3:ns(),Ai(ds),Ai(Mo),li();break;case 5:Gp(U);break;case 4:ns();break;case 13:Ai(Qr);break;case 19:Ai(Qr);break;case 10:ac(U.type._context);break;case 22:case 23:Ei()}z=z.return}if(pt=_,ot=_=su(_.current,null),Ve=Je=x,kt=0,Ht=null,xt=Lt=ut=0,At=Gt=null,Es!==null){for(x=0;x<Es.length;x++)if(z=Es[x],U=z.interleaved,U!==null){z.interleaved=null;var ee=U.next,le=z.pending;if(le!==null){var Ie=le.next;le.next=ee,U.next=Ie}z.pending=U}Es=null}return _}function ii(_,x){do{var z=ot;try{if($p(),Dr.current=Zh,hs){for(var U=Li.memoizedState;U!==null;){var ee=U.queue;ee!==null&&(ee.pending=null),U=U.next}hs=!1}if(Go=0,vo=ji=Li=null,ua=!1,Zs=0,ze.current=null,z===null||z.return===null){kt=1,Ht=x,ot=null;break}e:{var le=_,Ie=z.return,lt=z,vt=x;if(x=Ve,lt.flags|=32768,vt!==null&&typeof vt=="object"&&typeof vt.then=="function"){var Vt=vt,yn=lt,wn=yn.tag;if(!(yn.mode&1)&&(wn===0||wn===11||wn===15)){var vn=yn.alternate;vn?(yn.updateQueue=vn.updateQueue,yn.memoizedState=vn.memoizedState,yn.lanes=vn.lanes):(yn.updateQueue=null,yn.memoizedState=null)}var Zn=Wu(Ie);if(Zn!==null){Zn.flags&=-257,cm(Zn,Ie,lt,le,x),Zn.mode&1&&Yh(le,Vt,x),x=Zn,vt=Vt;var nr=x.updateQueue;if(nr===null){var or=new Set;or.add(vt),x.updateQueue=or}else nr.add(vt);break e}else{if(!(x&1)){Yh(le,Vt,x),Ci();break e}vt=Error(s(426))}}else if(Ni&&lt.mode&1){var co=Wu(Ie);if(co!==null){!(co.flags&65536)&&(co.flags|=256),cm(co,Ie,lt,le,x),qc(Ma(vt,lt));break e}}le=vt=Ma(vt,lt),kt!==4&&(kt=2),Gt===null?Gt=[le]:Gt.push(le),le=Ie;do{switch(le.tag){case 3:le.flags|=65536,x&=-x,le.lanes|=x;var Ot=qu(le,vt,x);lm(le,Ot);break e;case 1:lt=vt;var St=le.type,jt=le.stateNode;if(!(le.flags&128)&&(typeof St.getDerivedStateFromError=="function"||jt!==null&&typeof jt.componentDidCatch=="function"&&(jn===null||!jn.has(jt)))){le.flags|=65536,x&=-x,le.lanes|=x;var An=nf(le,lt,x);lm(le,An);break e}}le=le.return}while(le!==null)}ms(z)}catch(fr){x=fr,ot===z&&z!==null&&(ot=z=z.return);continue}break}while(!0)}function Mr(){var _=Oe.current;return Oe.current=Zh,_===null?Zh:_}function Ci(){(kt===0||kt===3||kt===2)&&(kt=4),pt===null||!(ut&268435455)&&!(Lt&268435455)||Yi(pt,Ve)}function io(_,x){var z=je;je|=2;var U=Mr();(pt!==_||Ve!==x)&&(Zt=null,Gr(_,x));do try{ei();break}catch(ee){ii(_,ee)}while(!0);if($p(),je=z,Oe.current=U,ot!==null)throw Error(s(261));return pt=null,Ve=0,kt}function ei(){for(;ot!==null;)As(ot)}function Ho(){for(;ot!==null&&!Hr();)As(ot)}function As(_){var x=Yd(_.alternate,_,Je);_.memoizedProps=_.pendingProps,x===null?ms(_):ot=x,ze.current=null}function ms(_){var x=_;do{var z=x.alternate;if(_=x.return,x.flags&32768){if(z=Ka(z,x),z!==null){z.flags&=32767,ot=z;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{kt=6,ot=null;return}}else if(z=Zd(z,x,Je),z!==null){ot=z;return}if(x=x.sibling,x!==null){ot=x;return}ot=x=_}while(x!==null);kt===0&&(kt=5)}function gs(_,x,z){var U=ri,ee=Ne.transition;try{Ne.transition=null,ri=1,is(_,x,z,U)}finally{Ne.transition=ee,ri=U}return null}function is(_,x,z,U){do os();while(Rn!==null);if(je&6)throw Error(s(327));z=_.finishedWork;var ee=_.finishedLanes;if(z===null)return null;if(_.finishedWork=null,_.finishedLanes=0,z===_.current)throw Error(s(177));_.callbackNode=null,_.callbackPriority=0;var le=z.lanes|z.childLanes;if(uh(_,le),_===pt&&(ot=pt=null,Ve=0),!(z.subtreeFlags&2064)&&!(z.flags&2064)||In||(In=!0,hy(Aa,function(){return os(),null})),le=(z.flags&15990)!==0,z.subtreeFlags&15990||le){le=Ne.transition,Ne.transition=null;var Ie=ri;ri=1;var lt=je;je|=4,ze.current=null,h(_,z),ue(z,_),bh(Ad),_o=!!Id,Ad=Id=null,_.current=z,ve(z),Xr(),je=lt,ri=Ie,Ne.transition=le}else _.current=z;if(In&&(In=!1,Rn=_,Gn=ee),le=_.pendingLanes,le===0&&(jn=null),ch(z.stateNode),Cn(_,Vr()),x!==null)for(U=_.onRecoverableError,z=0;z<x.length;z++)ee=x[z],U(ee.value,{componentStack:ee.stack,digest:ee.digest});if(cn)throw cn=!1,_=mn,mn=null,_;return Gn&1&&_.tag!==0&&os(),le=_.pendingLanes,le&1?_===dr?br++:(br=0,dr=_):br=0,Sa(),null}function os(){if(Rn!==null){var _=ul(Gn),x=Ne.transition,z=ri;try{if(Ne.transition=null,ri=16>_?16:_,Rn===null)var U=!1;else{if(_=Rn,Rn=null,Gn=0,je&6)throw Error(s(331));var ee=je;for(je|=4,Ln=_.current;Ln!==null;){var le=Ln,Ie=le.child;if(Ln.flags&16){var lt=le.deletions;if(lt!==null){for(var vt=0;vt<lt.length;vt++){var Vt=lt[vt];for(Ln=Vt;Ln!==null;){var yn=Ln;switch(yn.tag){case 0:case 11:case 15:t(8,yn,le)}var wn=yn.child;if(wn!==null)wn.return=yn,Ln=wn;else for(;Ln!==null;){yn=Ln;var vn=yn.sibling,Zn=yn.return;if(v(yn),yn===Vt){Ln=null;break}if(vn!==null){vn.return=Zn,Ln=vn;break}Ln=Zn}}}var nr=le.alternate;if(nr!==null){var or=nr.child;if(or!==null){nr.child=null;do{var co=or.sibling;or.sibling=null,or=co}while(or!==null)}}Ln=le}}if(le.subtreeFlags&2064&&Ie!==null)Ie.return=le,Ln=Ie;else e:for(;Ln!==null;){if(le=Ln,le.flags&2048)switch(le.tag){case 0:case 11:case 15:t(9,le,le.return)}var Ot=le.sibling;if(Ot!==null){Ot.return=le.return,Ln=Ot;break e}Ln=le.return}}var St=_.current;for(Ln=St;Ln!==null;){Ie=Ln;var jt=Ie.child;if(Ie.subtreeFlags&2064&&jt!==null)jt.return=Ie,Ln=jt;else e:for(Ie=St;Ln!==null;){if(lt=Ln,lt.flags&2048)try{switch(lt.tag){case 0:case 11:case 15:a(9,lt)}}catch(fr){Mi(lt,lt.return,fr)}if(lt===Ie){Ln=null;break e}var An=lt.sibling;if(An!==null){An.return=lt.return,Ln=An;break e}Ln=lt.return}}if(je=ee,Sa(),Ko&&typeof Ko.onPostCommitFiberRoot=="function")try{Ko.onPostCommitFiberRoot(Mc,_)}catch{}U=!0}return U}finally{ri=z,Ne.transition=x}}return!1}function _s(_,x,z){x=Ma(z,x),x=qu(_,x,1),_=Sl(_,x,1),x=xr(),_!==null&&(Fs(_,1,x),Cn(_,x))}function Mi(_,x,z){if(_.tag===3)_s(_,_,z);else for(;x!==null;){if(x.tag===3){_s(x,_,z);break}else if(x.tag===1){var U=x.stateNode;if(typeof x.type.getDerivedStateFromError=="function"||typeof U.componentDidCatch=="function"&&(jn===null||!jn.has(U))){_=Ma(z,_),_=nf(x,_,1),x=Sl(x,_,1),_=xr(),x!==null&&(Fs(x,1,_),Cn(x,_));break}}x=x.return}}function Ja(_,x,z){var U=_.pingCache;U!==null&&U.delete(x),x=xr(),_.pingedLanes|=_.suspendedLanes&z,pt===_&&(Ve&z)===z&&(kt===4||kt===3&&(Ve&130023424)===Ve&&500>Vr()-Ct?Gr(_,0):xt|=z),Cn(_,x)}function gc(_,x){x===0&&(_.mode&1?(x=Ac,Ac<<=1,!(Ac&130023424)&&(Ac=4194304)):x=1);var z=xr();_=Wa(_,x),_!==null&&(Fs(_,x,z),Cn(_,z))}function Xd(_){var x=_.memoizedState,z=0;x!==null&&(z=x.retryLane),gc(_,z)}function Kh(_,x){var z=0;switch(_.tag){case 13:var U=_.stateNode,ee=_.memoizedState;ee!==null&&(z=ee.retryLane);break;case 19:U=_.stateNode;break;default:throw Error(s(314))}U!==null&&U.delete(x),gc(_,z)}var Yd;Yd=function(_,x,z){if(_!==null)if(_.memoizedProps!==x.pendingProps||ds.current)rs=!0;else{if(!(_.lanes&z)&&!(x.flags&128))return rs=!1,mc(_,x,z);rs=!!(_.flags&131072)}else rs=!1,Ni&&x.flags&1048576&&Mn(x,bl,x.index);switch(x.lanes=0,x.tag){case 2:var U=x.type;fs(_,x),_=x.pendingProps;var ee=Va(x,Mo.current);Wt(x,z),ee=Od(null,x,U,_,ee,z);var le=Fd();return x.flags|=1,typeof ee=="object"&&ee!==null&&typeof ee.render=="function"&&ee.$$typeof===void 0?(x.tag=1,x.memoizedState=null,x.updateQueue=null,ws(U)?(le=!0,zu(x)):le=!1,x.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,Dd(x),ee.updater=Xa,x.stateNode=ee,ee._reactInternals=x,Ca(x,U,_,z),x=rf(null,x,U,!0,le,z)):(x.tag=0,Ni&&le&&Ld(x),Oo(null,x,ee,z),x=x.child),x;case 16:U=x.elementType;e:{switch(fs(_,x),_=x.pendingProps,ee=U._init,U=ee(U._payload),x.type=U,ee=x.tag=fy(U),_=Ea(U,_),ee){case 0:x=Il(null,x,U,_,z);break e;case 1:x=Al(null,x,U,_,z);break e;case 11:x=tu(null,x,U,_,z);break e;case 14:x=nu(null,x,U,Ea(U.type,_),z);break e}throw Error(s(306,U,""))}return x;case 0:return U=x.type,ee=x.pendingProps,ee=x.elementType===U?ee:Ea(U,ee),Il(_,x,U,ee,z);case 1:return U=x.type,ee=x.pendingProps,ee=x.elementType===U?ee:Ea(U,ee),Al(_,x,U,ee,z);case 3:e:{if(Gd(x),_===null)throw Error(s(387));U=x.pendingProps,le=x.memoizedState,ee=le.element,Vp(_,x),jh(x,U,null,z);var Ie=x.memoizedState;if(U=Ie.element,le.isDehydrated)if(le={element:U,isDehydrated:!1,cache:Ie.cache,pendingSuspenseBoundaries:Ie.pendingSuspenseBoundaries,transitions:Ie.transitions},x.updateQueue.baseState=le,x.memoizedState=le,x.flags&256){ee=Ma(Error(s(423)),x),x=um(_,x,U,z,ee);break e}else if(U!==ee){ee=Ma(Error(s(424)),x),x=um(_,x,U,z,ee);break e}else for(es=Jl(x.stateNode.containerInfo.firstChild),Ss=x,Ni=!0,Ts=null,z=Hc(x,null,U,z),x.child=z;z;)z.flags=z.flags&-3|4096,z=z.sibling;else{if(Gs(),U===ee){x=Ms(_,x,z);break e}Oo(_,x,U,z)}x=x.child}return x;case 5:return uc(x),_===null&&la(x),U=x.type,ee=x.pendingProps,le=_!==null?_.memoizedProps:null,Ie=ee.children,Ru(U,ee)?Ie=null:le!==null&&Ru(U,le)&&(x.flags|=32),Ml(_,x),Oo(_,x,Ie,z),x.child;case 6:return _===null&&la(x),null;case 13:return qo(_,x,z);case 4:return Hs(x,x.stateNode.containerInfo),U=x.pendingProps,_===null?x.child=Jr(x,null,U,z):Oo(_,x,U,z),x.child;case 11:return U=x.type,ee=x.pendingProps,ee=x.elementType===U?ee:Ea(U,ee),tu(_,x,U,ee,z);case 7:return Oo(_,x,x.pendingProps,z),x.child;case 8:return Oo(_,x,x.pendingProps.children,z),x.child;case 12:return Oo(_,x,x.pendingProps.children,z),x.child;case 10:e:{if(U=x.type._context,ee=x.pendingProps,le=x.memoizedProps,Ie=ee.value,ki(Zc,U._currentValue),U._currentValue=Ie,le!==null)if(xa(le.value,Ie)){if(le.children===ee.children&&!ds.current){x=Ms(_,x,z);break e}}else for(le=x.child,le!==null&&(le.return=x);le!==null;){var lt=le.dependencies;if(lt!==null){Ie=le.child;for(var vt=lt.firstContext;vt!==null;){if(vt.context===U){if(le.tag===1){vt=Ha(-1,z&-z),vt.tag=2;var Vt=le.updateQueue;if(Vt!==null){Vt=Vt.shared;var yn=Vt.pending;yn===null?vt.next=vt:(vt.next=yn.next,yn.next=vt),Vt.pending=vt}}le.lanes|=z,vt=le.alternate,vt!==null&&(vt.lanes|=z),lc(le.return,z,x),lt.lanes|=z;break}vt=vt.next}}else if(le.tag===10)Ie=le.type===x.type?null:le.child;else if(le.tag===18){if(Ie=le.return,Ie===null)throw Error(s(341));Ie.lanes|=z,lt=Ie.alternate,lt!==null&&(lt.lanes|=z),lc(Ie,z,x),Ie=le.sibling}else Ie=le.child;if(Ie!==null)Ie.return=le;else for(Ie=le;Ie!==null;){if(Ie===x){Ie=null;break}if(le=Ie.sibling,le!==null){le.return=Ie.return,Ie=le;break}Ie=Ie.return}le=Ie}Oo(_,x,ee.children,z),x=x.child}return x;case 9:return ee=x.type,U=x.pendingProps.children,Wt(x,z),ee=nn(ee),U=U(ee),x.flags|=1,Oo(_,x,U,z),x.child;case 14:return U=x.type,ee=Ea(U,x.pendingProps),ee=Ea(U.type,ee),nu(_,x,U,ee,z);case 15:return Ya(_,x,x.type,x.pendingProps,z);case 17:return U=x.type,ee=x.pendingProps,ee=x.elementType===U?ee:Ea(U,ee),fs(_,x),x.tag=1,ws(U)?(_=!0,zu(x)):_=!1,Wt(x,z),Vd(x,U,ee),Ca(x,U,ee,z),rf(null,x,U,!0,_,z);case 19:return Ys(_,x,z);case 22:return ha(_,x,z)}throw Error(s(156,x.tag))};function hy(_,x){return Nr(_,x)}function py(_,x,z,U){this.tag=_,this.key=z,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=x,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=U,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qa(_,x,z,U){return new py(_,x,z,U)}function Eg(_){return _=_.prototype,!(!_||!_.isReactComponent)}function fy(_){if(typeof _=="function")return Eg(_)?1:0;if(_!=null){if(_=_.$$typeof,_===ct)return 11;if(_===et)return 14}return 2}function su(_,x){var z=_.alternate;return z===null?(z=Qa(_.tag,x,_.key,_.mode),z.elementType=_.elementType,z.type=_.type,z.stateNode=_.stateNode,z.alternate=_,_.alternate=z):(z.pendingProps=x,z.type=_.type,z.flags=0,z.subtreeFlags=0,z.deletions=null),z.flags=_.flags&14680064,z.childLanes=_.childLanes,z.lanes=_.lanes,z.child=_.child,z.memoizedProps=_.memoizedProps,z.memoizedState=_.memoizedState,z.updateQueue=_.updateQueue,x=_.dependencies,z.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext},z.sibling=_.sibling,z.index=_.index,z.ref=_.ref,z}function sf(_,x,z,U,ee,le){var Ie=2;if(U=_,typeof _=="function")Eg(_)&&(Ie=1);else if(typeof _=="string")Ie=5;else e:switch(_){case xe:return Xu(z.children,ee,le,x);case $e:Ie=8,ee|=8;break;case Ze:return _=Qa(12,z,x,ee|2),_.elementType=Ze,_.lanes=le,_;case Xe:return _=Qa(13,z,x,ee),_.elementType=Xe,_.lanes=le,_;case st:return _=Qa(19,z,x,ee),_.elementType=st,_.lanes=le,_;case zt:return af(z,ee,le,x);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case ae:Ie=10;break e;case ke:Ie=9;break e;case ct:Ie=11;break e;case et:Ie=14;break e;case gt:Ie=16,U=null;break e}throw Error(s(130,_==null?_:typeof _,""))}return x=Qa(Ie,z,x,ee),x.elementType=_,x.type=U,x.lanes=le,x}function Xu(_,x,z,U){return _=Qa(7,_,U,x),_.lanes=z,_}function af(_,x,z,U){return _=Qa(22,_,U,x),_.elementType=zt,_.lanes=z,_.stateNode={isHidden:!1},_}function pm(_,x,z){return _=Qa(6,_,null,x),_.lanes=z,_}function fm(_,x,z){return x=Qa(4,_.children!==null?_.children:[],_.key,x),x.lanes=z,x.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},x}function Cg(_,x,z,U,ee){this.tag=x,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Os(0),this.expirationTimes=Os(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Os(0),this.identifierPrefix=U,this.onRecoverableError=ee,this.mutableSourceEagerHydrationData=null}function _c(_,x,z,U,ee,le,Ie,lt,vt){return _=new Cg(_,x,z,lt,vt),x===1?(x=1,le===!0&&(x|=8)):x=0,le=Qa(3,null,null,x),_.current=le,le.stateNode=_,le.memoizedState={element:U,isDehydrated:z,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dd(le),_}function ss(_,x,z){var U=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:we,key:U==null?null:""+U,children:_,containerInfo:x,implementation:z}}function Mg(_){if(!_)return $a;_=_._reactInternals;e:{if(an(_)!==_||_.tag!==1)throw Error(s(170));var x=_;do{switch(x.tag){case 3:x=x.stateNode.context;break e;case 1:if(ws(x.type)){x=x.stateNode.__reactInternalMemoizedMergedChildContext;break e}}x=x.return}while(x!==null);throw Error(s(171))}if(_.tag===1){var z=_.type;if(ws(z))return Rd(_,z,x)}return x}function Jh(_,x,z,U,ee,le,Ie,lt,vt){return _=_c(z,U,!0,_,ee,le,Ie,lt,vt),_.context=Mg(null),z=_.current,U=xr(),ee=Fr(z),le=Ha(U,ee),le.callback=x??null,Sl(z,le,ee),_.current.lanes=ee,Fs(_,ee,U),Cn(_,U),_}function mm(_,x,z,U){var ee=x.current,le=xr(),Ie=Fr(ee);return z=Mg(z),x.context===null?x.context=z:x.pendingContext=z,x=Ha(le,Ie),x.payload={element:_},U=U===void 0?null:U,U!==null&&(x.callback=U),_=Sl(ee,x,Ie),_!==null&&(Wn(_,ee,Ie,le),Tl(_,ee,Ie)),Ie}function gm(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return _.child.stateNode;default:return _.child.stateNode}}function Qh(_,x){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var z=_.retryLane;_.retryLane=z!==0&&z<x?z:x}}function _m(_,x){Qh(_,x),(_=_.alternate)&&Qh(_,x)}var Yu=typeof reportError=="function"?reportError:function(_){console.error(_)};function Kd(_){this._internalRoot=_}ym.prototype.render=Kd.prototype.render=function(_){var x=this._internalRoot;if(x===null)throw Error(s(409));mm(_,x,null,null)},ym.prototype.unmount=Kd.prototype.unmount=function(){var _=this._internalRoot;if(_!==null){this._internalRoot=null;var x=_.containerInfo;Ki(function(){mm(null,_,null,null)}),x[ba]=null}};function ym(_){this._internalRoot=_}ym.prototype.unstable_scheduleHydration=function(_){if(_){var x=Bs();_={blockedOn:null,target:_,priority:x};for(var z=0;z<bo.length&&x!==0&&x<bo[z].priority;z++);bo.splice(z,0,_),z===0&&zr(_)}};function Ig(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)}function vm(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11&&(_.nodeType!==8||_.nodeValue!==" react-mount-point-unstable "))}function my(){}function Fx(_,x,z,U,ee){if(ee){if(typeof U=="function"){var le=U;U=function(){var Vt=gm(Ie);le.call(Vt)}}var Ie=Jh(x,U,_,0,null,!1,!1,"",my);return _._reactRootContainer=Ie,_[ba]=Ie.current,Au(_.nodeType===8?_.parentNode:_),Ki(),Ie}for(;ee=_.lastChild;)_.removeChild(ee);if(typeof U=="function"){var lt=U;U=function(){var Vt=gm(vt);lt.call(Vt)}}var vt=_c(_,0,!1,null,null,!1,!1,"",my);return _._reactRootContainer=vt,_[ba]=vt.current,Au(_.nodeType===8?_.parentNode:_),Ki(function(){mm(x,vt,z,U)}),vt}function xm(_,x,z,U,ee){var le=z._reactRootContainer;if(le){var Ie=le;if(typeof ee=="function"){var lt=ee;ee=function(){var vt=gm(Ie);lt.call(vt)}}mm(x,Ie,_,ee)}else Ie=Fx(z,x,_,ee,U);return gm(Ie)}hd=function(_){switch(_.tag){case 3:var x=_.stateNode;if(x.current.memoizedState.isDehydrated){var z=cl(x.pendingLanes);z!==0&&(Rc(x,z|1),Cn(x,Vr()),!(je&6)&&(on=Vr()+500,Sa()))}break;case 13:Ki(function(){var U=Wa(_,1);if(U!==null){var ee=xr();Wn(U,_,1,ee)}}),_m(_,1)}},pd=function(_){if(_.tag===13){var x=Wa(_,134217728);if(x!==null){var z=xr();Wn(x,_,134217728,z)}_m(_,134217728)}},kc=function(_){if(_.tag===13){var x=Fr(_),z=Wa(_,x);if(z!==null){var U=xr();Wn(z,_,x,U)}_m(_,x)}},Bs=function(){return ri},fd=function(_,x){var z=ri;try{return ri=_,x()}finally{ri=z}},ra=function(_,x,z){switch(x){case"input":if(qn(_,z),x=z.name,z.type==="radio"&&x!=null){for(z=_;z.parentNode;)z=z.parentNode;for(z=z.querySelectorAll("input[name="+JSON.stringify(""+x)+'][type="radio"]'),x=0;x<z.length;x++){var U=z[x];if(U!==_&&U.form===_.form){var ee=Lu(U);if(!ee)throw Error(s(90));pn(U),qn(U,ee)}}}break;case"textarea":Dt(_,z);break;case"select":x=z.value,x!=null&&Er(_,!!z.multiple,x,!1)}},Do=ro,ht=Ki;var Bx={usingClientEntryPoint:!1,Events:[ec,Vo,Lu,ia,vs,ro]},Jd={findFiberByHostInstance:xl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Nx={bundleType:Jd.bundleType,version:Jd.version,rendererPackageName:Jd.rendererPackageName,rendererConfig:Jd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ie.ReactCurrentDispatcher,findHostInstanceByFiber:function(_){return _=Xn(_),_===null?null:_.stateNode},findFiberByHostInstance:Jd.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{Mc=au.inject(Nx),Ko=au}catch{}}return tl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bx,tl.createPortal=function(_,x){var z=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ig(x))throw Error(s(200));return ss(_,x,null,z)},tl.createRoot=function(_,x){if(!Ig(_))throw Error(s(299));var z=!1,U="",ee=Yu;return x!=null&&(x.unstable_strictMode===!0&&(z=!0),x.identifierPrefix!==void 0&&(U=x.identifierPrefix),x.onRecoverableError!==void 0&&(ee=x.onRecoverableError)),x=_c(_,1,!1,null,null,z,!1,U,ee),_[ba]=x.current,Au(_.nodeType===8?_.parentNode:_),new Kd(x)},tl.findDOMNode=function(_){if(_==null)return null;if(_.nodeType===1)return _;var x=_._reactInternals;if(x===void 0)throw typeof _.render=="function"?Error(s(188)):(_=Object.keys(_).join(","),Error(s(268,_)));return _=Xn(x),_=_===null?null:_.stateNode,_},tl.flushSync=function(_){return Ki(_)},tl.hydrate=function(_,x,z){if(!vm(x))throw Error(s(200));return xm(null,_,x,!0,z)},tl.hydrateRoot=function(_,x,z){if(!Ig(_))throw Error(s(405));var U=z!=null&&z.hydratedSources||null,ee=!1,le="",Ie=Yu;if(z!=null&&(z.unstable_strictMode===!0&&(ee=!0),z.identifierPrefix!==void 0&&(le=z.identifierPrefix),z.onRecoverableError!==void 0&&(Ie=z.onRecoverableError)),x=Jh(x,null,_,1,z??null,ee,!1,le,Ie),_[ba]=x.current,Au(_),U)for(_=0;_<U.length;_++)z=U[_],ee=z._getVersion,ee=ee(z._source),x.mutableSourceEagerHydrationData==null?x.mutableSourceEagerHydrationData=[z,ee]:x.mutableSourceEagerHydrationData.push(z,ee);return new ym(x)},tl.render=function(_,x,z){if(!vm(x))throw Error(s(200));return xm(null,_,x,!1,z)},tl.unmountComponentAtNode=function(_){if(!vm(_))throw Error(s(40));return _._reactRootContainer?(Ki(function(){xm(null,null,_,!1,function(){_._reactRootContainer=null,_[ba]=null})}),!0):!1},tl.unstable_batchedUpdates=ro,tl.unstable_renderSubtreeIntoContainer=function(_,x,z,U){if(!vm(z))throw Error(s(200));if(_==null||_._reactInternals===void 0)throw Error(s(38));return xm(_,x,z,!1,U)},tl.version="18.3.1-next-f1338f8080-20240426",tl}var SE;function oA(){if(SE)return K0.exports;SE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),K0.exports=I3(),K0.exports}var TE;function A3(){if(TE)return rv;TE=1;var n=oA();return rv.createRoot=n.createRoot,rv.hydrateRoot=n.hydrateRoot,rv}var P3=A3();const $_={black:"#000",white:"#fff"},Fm={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Bm={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Nm={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},jm={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Um={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},r_={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},R3={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function oh(n,...r){const s=new URL(`https://mui.com/production-error/?code=${n}`);return r.forEach(u=>s.searchParams.append("args[]",u)),`Minified MUI error #${n}; visit ${s} for the full message.`}const ax="$$material";function $v(){return $v=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var u in s)({}).hasOwnProperty.call(s,u)&&(n[u]=s[u])}return n},$v.apply(null,arguments)}var fe=uw();const Vi=Uf(fe),w1=rA({__proto__:null,default:Vi},[fe]);function k3(n){if(n.sheet)return n.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===n)return document.styleSheets[r]}function L3(n){var r=document.createElement("style");return r.setAttribute("data-emotion",n.key),n.nonce!==void 0&&r.setAttribute("nonce",n.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var z3=function(){function n(s){var u=this;this._insertTag=function(m){var y;u.tags.length===0?u.insertionPoint?y=u.insertionPoint.nextSibling:u.prepend?y=u.container.firstChild:y=u.before:y=u.tags[u.tags.length-1].nextSibling,u.container.insertBefore(m,y),u.tags.push(m)},this.isSpeedy=s.speedy===void 0?!0:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var r=n.prototype;return r.hydrate=function(u){u.forEach(this._insertTag)},r.insert=function(u){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(L3(this));var m=this.tags[this.tags.length-1];if(this.isSpeedy){var y=k3(m);try{y.insertRule(u,y.cssRules.length)}catch{}}else m.appendChild(document.createTextNode(u));this.ctr++},r.flush=function(){this.tags.forEach(function(u){var m;return(m=u.parentNode)==null?void 0:m.removeChild(u)}),this.tags=[],this.ctr=0},n}(),ma="-ms-",Vv="-moz-",zi="-webkit-",sA="comm",dw="rule",hw="decl",D3="@import",aA="@keyframes",O3="@layer",F3=Math.abs,lx=String.fromCharCode,B3=Object.assign;function N3(n,r){return ea(n,0)^45?(((r<<2^ea(n,0))<<2^ea(n,1))<<2^ea(n,2))<<2^ea(n,3):0}function lA(n){return n.trim()}function j3(n,r){return(n=r.exec(n))?n[0]:n}function Di(n,r,s){return n.replace(r,s)}function S1(n,r){return n.indexOf(r)}function ea(n,r){return n.charCodeAt(r)|0}function V_(n,r,s){return n.slice(r,s)}function id(n){return n.length}function pw(n){return n.length}function iv(n,r){return r.push(n),n}function U3(n,r){return n.map(r).join("")}var cx=1,Jm=1,cA=0,al=0,ls=0,lg="";function ux(n,r,s,u,m,y,T){return{value:n,root:r,parent:s,type:u,props:m,children:y,line:cx,column:Jm,length:T,return:""}}function i_(n,r){return B3(ux("",null,null,"",null,null,0),n,{length:-n.length},r)}function $3(){return ls}function V3(){return ls=al>0?ea(lg,--al):0,Jm--,ls===10&&(Jm=1,cx--),ls}function Nl(){return ls=al<cA?ea(lg,al++):0,Jm++,ls===10&&(Jm=1,cx++),ls}function ad(){return ea(lg,al)}function kv(){return al}function ey(n,r){return V_(lg,n,r)}function G_(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function uA(n){return cx=Jm=1,cA=id(lg=n),al=0,[]}function dA(n){return lg="",n}function Lv(n){return lA(ey(al-1,T1(n===91?n+2:n===40?n+1:n)))}function G3(n){for(;(ls=ad())&&ls<33;)Nl();return G_(n)>2||G_(ls)>3?"":" "}function q3(n,r){for(;--r&&Nl()&&!(ls<48||ls>102||ls>57&&ls<65||ls>70&&ls<97););return ey(n,kv()+(r<6&&ad()==32&&Nl()==32))}function T1(n){for(;Nl();)switch(ls){case n:return al;case 34:case 39:n!==34&&n!==39&&T1(ls);break;case 40:n===41&&T1(n);break;case 92:Nl();break}return al}function W3(n,r){for(;Nl()&&n+ls!==57;)if(n+ls===84&&ad()===47)break;return"/*"+ey(r,al-1)+"*"+lx(n===47?n:Nl())}function H3(n){for(;!G_(ad());)Nl();return ey(n,al)}function Z3(n){return dA(zv("",null,null,null,[""],n=uA(n),0,[0],n))}function zv(n,r,s,u,m,y,T,i,I){for(var F=0,B=0,G=T,J=0,te=0,H=0,j=1,ne=1,oe=1,pe=0,se="",ie=m,ce=y,we=u,xe=se;ne;)switch(H=pe,pe=Nl()){case 40:if(H!=108&&ea(xe,G-1)==58){S1(xe+=Di(Lv(pe),"&","&\f"),"&\f")!=-1&&(oe=-1);break}case 34:case 39:case 91:xe+=Lv(pe);break;case 9:case 10:case 13:case 32:xe+=G3(H);break;case 92:xe+=q3(kv()-1,7);continue;case 47:switch(ad()){case 42:case 47:iv(X3(W3(Nl(),kv()),r,s),I);break;default:xe+="/"}break;case 123*j:i[F++]=id(xe)*oe;case 125*j:case 59:case 0:switch(pe){case 0:case 125:ne=0;case 59+B:oe==-1&&(xe=Di(xe,/\f/g,"")),te>0&&id(xe)-G&&iv(te>32?CE(xe+";",u,s,G-1):CE(Di(xe," ","")+";",u,s,G-2),I);break;case 59:xe+=";";default:if(iv(we=EE(xe,r,s,F,B,m,i,se,ie=[],ce=[],G),y),pe===123)if(B===0)zv(xe,r,we,we,ie,y,G,i,ce);else switch(J===99&&ea(xe,3)===110?100:J){case 100:case 108:case 109:case 115:zv(n,we,we,u&&iv(EE(n,we,we,0,0,m,i,se,m,ie=[],G),ce),m,ce,G,i,u?ie:ce);break;default:zv(xe,we,we,we,[""],ce,0,i,ce)}}F=B=te=0,j=oe=1,se=xe="",G=T;break;case 58:G=1+id(xe),te=H;default:if(j<1){if(pe==123)--j;else if(pe==125&&j++==0&&V3()==125)continue}switch(xe+=lx(pe),pe*j){case 38:oe=B>0?1:(xe+="\f",-1);break;case 44:i[F++]=(id(xe)-1)*oe,oe=1;break;case 64:ad()===45&&(xe+=Lv(Nl())),J=ad(),B=G=id(se=xe+=H3(kv())),pe++;break;case 45:H===45&&id(xe)==2&&(j=0)}}return y}function EE(n,r,s,u,m,y,T,i,I,F,B){for(var G=m-1,J=m===0?y:[""],te=pw(J),H=0,j=0,ne=0;H<u;++H)for(var oe=0,pe=V_(n,G+1,G=F3(j=T[H])),se=n;oe<te;++oe)(se=lA(j>0?J[oe]+" "+pe:Di(pe,/&\f/g,J[oe])))&&(I[ne++]=se);return ux(n,r,s,m===0?dw:i,I,F,B)}function X3(n,r,s){return ux(n,r,s,sA,lx($3()),V_(n,2,-2),0)}function CE(n,r,s,u){return ux(n,r,s,hw,V_(n,0,u),V_(n,u+1,-1),u)}function Zm(n,r){for(var s="",u=pw(n),m=0;m<u;m++)s+=r(n[m],m,n,r)||"";return s}function Y3(n,r,s,u){switch(n.type){case O3:if(n.children.length)break;case D3:case hw:return n.return=n.return||n.value;case sA:return"";case aA:return n.return=n.value+"{"+Zm(n.children,u)+"}";case dw:n.value=n.props.join(",")}return id(s=Zm(n.children,u))?n.return=n.value+"{"+s+"}":""}function K3(n){var r=pw(n);return function(s,u,m,y){for(var T="",i=0;i<r;i++)T+=n[i](s,u,m,y)||"";return T}}function J3(n){return function(r){r.root||(r=r.return)&&n(r)}}function hA(n){var r=Object.create(null);return function(s){return r[s]===void 0&&(r[s]=n(s)),r[s]}}var Q3=function(r,s,u){for(var m=0,y=0;m=y,y=ad(),m===38&&y===12&&(s[u]=1),!G_(y);)Nl();return ey(r,al)},ez=function(r,s){var u=-1,m=44;do switch(G_(m)){case 0:m===38&&ad()===12&&(s[u]=1),r[u]+=Q3(al-1,s,u);break;case 2:r[u]+=Lv(m);break;case 4:if(m===44){r[++u]=ad()===58?"&\f":"",s[u]=r[u].length;break}default:r[u]+=lx(m)}while(m=Nl());return r},tz=function(r,s){return dA(ez(uA(r),s))},ME=new WeakMap,nz=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var s=r.value,u=r.parent,m=r.column===u.column&&r.line===u.line;u.type!=="rule";)if(u=u.parent,!u)return;if(!(r.props.length===1&&s.charCodeAt(0)!==58&&!ME.get(u))&&!m){ME.set(r,!0);for(var y=[],T=tz(s,y),i=u.props,I=0,F=0;I<T.length;I++)for(var B=0;B<i.length;B++,F++)r.props[F]=y[I]?T[I].replace(/&\f/g,i[B]):i[B]+" "+T[I]}}},rz=function(r){if(r.type==="decl"){var s=r.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(r.return="",r.value="")}};function pA(n,r){switch(N3(n,r)){case 5103:return zi+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return zi+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return zi+n+Vv+n+ma+n+n;case 6828:case 4268:return zi+n+ma+n+n;case 6165:return zi+n+ma+"flex-"+n+n;case 5187:return zi+n+Di(n,/(\w+).+(:[^]+)/,zi+"box-$1$2"+ma+"flex-$1$2")+n;case 5443:return zi+n+ma+"flex-item-"+Di(n,/flex-|-self/,"")+n;case 4675:return zi+n+ma+"flex-line-pack"+Di(n,/align-content|flex-|-self/,"")+n;case 5548:return zi+n+ma+Di(n,"shrink","negative")+n;case 5292:return zi+n+ma+Di(n,"basis","preferred-size")+n;case 6060:return zi+"box-"+Di(n,"-grow","")+zi+n+ma+Di(n,"grow","positive")+n;case 4554:return zi+Di(n,/([^-])(transform)/g,"$1"+zi+"$2")+n;case 6187:return Di(Di(Di(n,/(zoom-|grab)/,zi+"$1"),/(image-set)/,zi+"$1"),n,"")+n;case 5495:case 3959:return Di(n,/(image-set\([^]*)/,zi+"$1$`$1");case 4968:return Di(Di(n,/(.+:)(flex-)?(.*)/,zi+"box-pack:$3"+ma+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+zi+n+n;case 4095:case 3583:case 4068:case 2532:return Di(n,/(.+)-inline(.+)/,zi+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(id(n)-1-r>6)switch(ea(n,r+1)){case 109:if(ea(n,r+4)!==45)break;case 102:return Di(n,/(.+:)(.+)-([^]+)/,"$1"+zi+"$2-$3$1"+Vv+(ea(n,r+3)==108?"$3":"$2-$3"))+n;case 115:return~S1(n,"stretch")?pA(Di(n,"stretch","fill-available"),r)+n:n}break;case 4949:if(ea(n,r+1)!==115)break;case 6444:switch(ea(n,id(n)-3-(~S1(n,"!important")&&10))){case 107:return Di(n,":",":"+zi)+n;case 101:return Di(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+zi+(ea(n,14)===45?"inline-":"")+"box$3$1"+zi+"$2$3$1"+ma+"$2box$3")+n}break;case 5936:switch(ea(n,r+11)){case 114:return zi+n+ma+Di(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return zi+n+ma+Di(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return zi+n+ma+Di(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return zi+n+ma+n+n}return n}var iz=function(r,s,u,m){if(r.length>-1&&!r.return)switch(r.type){case hw:r.return=pA(r.value,r.length);break;case aA:return Zm([i_(r,{value:Di(r.value,"@","@"+zi)})],m);case dw:if(r.length)return U3(r.props,function(y){switch(j3(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Zm([i_(r,{props:[Di(y,/:(read-\w+)/,":"+Vv+"$1")]})],m);case"::placeholder":return Zm([i_(r,{props:[Di(y,/:(plac\w+)/,":"+zi+"input-$1")]}),i_(r,{props:[Di(y,/:(plac\w+)/,":"+Vv+"$1")]}),i_(r,{props:[Di(y,/:(plac\w+)/,ma+"input-$1")]})],m)}return""})}},oz=[iz],sz=function(r){var s=r.key;if(s==="css"){var u=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(u,function(j){var ne=j.getAttribute("data-emotion");ne.indexOf(" ")!==-1&&(document.head.appendChild(j),j.setAttribute("data-s",""))})}var m=r.stylisPlugins||oz,y={},T,i=[];T=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(j){for(var ne=j.getAttribute("data-emotion").split(" "),oe=1;oe<ne.length;oe++)y[ne[oe]]=!0;i.push(j)});var I,F=[nz,rz];{var B,G=[Y3,J3(function(j){B.insert(j)})],J=K3(F.concat(m,G)),te=function(ne){return Zm(Z3(ne),J)};I=function(ne,oe,pe,se){B=pe,te(ne?ne+"{"+oe.styles+"}":oe.styles),se&&(H.inserted[oe.name]=!0)}}var H={key:s,sheet:new z3({key:s,container:T,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:y,registered:{},insert:I};return H.sheet.hydrate(i),H},eb={exports:{}},$i={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE;function az(){if(IE)return $i;IE=1;var n=typeof Symbol=="function"&&Symbol.for,r=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,u=n?Symbol.for("react.fragment"):60107,m=n?Symbol.for("react.strict_mode"):60108,y=n?Symbol.for("react.profiler"):60114,T=n?Symbol.for("react.provider"):60109,i=n?Symbol.for("react.context"):60110,I=n?Symbol.for("react.async_mode"):60111,F=n?Symbol.for("react.concurrent_mode"):60111,B=n?Symbol.for("react.forward_ref"):60112,G=n?Symbol.for("react.suspense"):60113,J=n?Symbol.for("react.suspense_list"):60120,te=n?Symbol.for("react.memo"):60115,H=n?Symbol.for("react.lazy"):60116,j=n?Symbol.for("react.block"):60121,ne=n?Symbol.for("react.fundamental"):60117,oe=n?Symbol.for("react.responder"):60118,pe=n?Symbol.for("react.scope"):60119;function se(ce){if(typeof ce=="object"&&ce!==null){var we=ce.$$typeof;switch(we){case r:switch(ce=ce.type,ce){case I:case F:case u:case y:case m:case G:return ce;default:switch(ce=ce&&ce.$$typeof,ce){case i:case B:case H:case te:case T:return ce;default:return we}}case s:return we}}}function ie(ce){return se(ce)===F}return $i.AsyncMode=I,$i.ConcurrentMode=F,$i.ContextConsumer=i,$i.ContextProvider=T,$i.Element=r,$i.ForwardRef=B,$i.Fragment=u,$i.Lazy=H,$i.Memo=te,$i.Portal=s,$i.Profiler=y,$i.StrictMode=m,$i.Suspense=G,$i.isAsyncMode=function(ce){return ie(ce)||se(ce)===I},$i.isConcurrentMode=ie,$i.isContextConsumer=function(ce){return se(ce)===i},$i.isContextProvider=function(ce){return se(ce)===T},$i.isElement=function(ce){return typeof ce=="object"&&ce!==null&&ce.$$typeof===r},$i.isForwardRef=function(ce){return se(ce)===B},$i.isFragment=function(ce){return se(ce)===u},$i.isLazy=function(ce){return se(ce)===H},$i.isMemo=function(ce){return se(ce)===te},$i.isPortal=function(ce){return se(ce)===s},$i.isProfiler=function(ce){return se(ce)===y},$i.isStrictMode=function(ce){return se(ce)===m},$i.isSuspense=function(ce){return se(ce)===G},$i.isValidElementType=function(ce){return typeof ce=="string"||typeof ce=="function"||ce===u||ce===F||ce===y||ce===m||ce===G||ce===J||typeof ce=="object"&&ce!==null&&(ce.$$typeof===H||ce.$$typeof===te||ce.$$typeof===T||ce.$$typeof===i||ce.$$typeof===B||ce.$$typeof===ne||ce.$$typeof===oe||ce.$$typeof===pe||ce.$$typeof===j)},$i.typeOf=se,$i}var AE;function lz(){return AE||(AE=1,eb.exports=az()),eb.exports}var tb,PE;function cz(){if(PE)return tb;PE=1;var n=lz(),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},u={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},m={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},y={};y[n.ForwardRef]=u,y[n.Memo]=m;function T(H){return n.isMemo(H)?m:y[H.$$typeof]||r}var i=Object.defineProperty,I=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,B=Object.getOwnPropertyDescriptor,G=Object.getPrototypeOf,J=Object.prototype;function te(H,j,ne){if(typeof j!="string"){if(J){var oe=G(j);oe&&oe!==J&&te(H,oe,ne)}var pe=I(j);F&&(pe=pe.concat(F(j)));for(var se=T(H),ie=T(j),ce=0;ce<pe.length;++ce){var we=pe[ce];if(!s[we]&&!(ne&&ne[we])&&!(ie&&ie[we])&&!(se&&se[we])){var xe=B(j,we);try{i(H,we,xe)}catch{}}}}return H}return tb=te,tb}cz();var uz=!0;function fA(n,r,s){var u="";return s.split(" ").forEach(function(m){n[m]!==void 0?r.push(n[m]+";"):m&&(u+=m+" ")}),u}var fw=function(r,s,u){var m=r.key+"-"+s.name;(u===!1||uz===!1)&&r.registered[m]===void 0&&(r.registered[m]=s.styles)},mw=function(r,s,u){fw(r,s,u);var m=r.key+"-"+s.name;if(r.inserted[s.name]===void 0){var y=s;do r.insert(s===y?"."+m:"",y,r.sheet,!0),y=y.next;while(y!==void 0)}};function dz(n){for(var r=0,s,u=0,m=n.length;m>=4;++u,m-=4)s=n.charCodeAt(u)&255|(n.charCodeAt(++u)&255)<<8|(n.charCodeAt(++u)&255)<<16|(n.charCodeAt(++u)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,r=(s&65535)*1540483477+((s>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(m){case 3:r^=(n.charCodeAt(u+2)&255)<<16;case 2:r^=(n.charCodeAt(u+1)&255)<<8;case 1:r^=n.charCodeAt(u)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var hz={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pz=/[A-Z]|^ms/g,fz=/_EMO_([^_]+?)_([^]*?)_EMO_/g,mA=function(r){return r.charCodeAt(1)===45},RE=function(r){return r!=null&&typeof r!="boolean"},nb=hA(function(n){return mA(n)?n:n.replace(pz,"-$&").toLowerCase()}),kE=function(r,s){switch(r){case"animation":case"animationName":if(typeof s=="string")return s.replace(fz,function(u,m,y){return od={name:m,styles:y,next:od},m})}return hz[r]!==1&&!mA(r)&&typeof s=="number"&&s!==0?s+"px":s};function q_(n,r,s){if(s==null)return"";var u=s;if(u.__emotion_styles!==void 0)return u;switch(typeof s){case"boolean":return"";case"object":{var m=s;if(m.anim===1)return od={name:m.name,styles:m.styles,next:od},m.name;var y=s;if(y.styles!==void 0){var T=y.next;if(T!==void 0)for(;T!==void 0;)od={name:T.name,styles:T.styles,next:od},T=T.next;var i=y.styles+";";return i}return mz(n,r,s)}case"function":{if(n!==void 0){var I=od,F=s(n);return od=I,q_(n,r,F)}break}}var B=s;if(r==null)return B;var G=r[B];return G!==void 0?G:B}function mz(n,r,s){var u="";if(Array.isArray(s))for(var m=0;m<s.length;m++)u+=q_(n,r,s[m])+";";else for(var y in s){var T=s[y];if(typeof T!="object"){var i=T;r!=null&&r[i]!==void 0?u+=y+"{"+r[i]+"}":RE(i)&&(u+=nb(y)+":"+kE(y,i)+";")}else if(Array.isArray(T)&&typeof T[0]=="string"&&(r==null||r[T[0]]===void 0))for(var I=0;I<T.length;I++)RE(T[I])&&(u+=nb(y)+":"+kE(y,T[I])+";");else{var F=q_(n,r,T);switch(y){case"animation":case"animationName":{u+=nb(y)+":"+F+";";break}default:u+=y+"{"+F+"}"}}}return u}var LE=/label:\s*([^\s;{]+)\s*(;|$)/g,od;function ty(n,r,s){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var u=!0,m="";od=void 0;var y=n[0];if(y==null||y.raw===void 0)u=!1,m+=q_(s,r,y);else{var T=y;m+=T[0]}for(var i=1;i<n.length;i++)if(m+=q_(s,r,n[i]),u){var I=y;m+=I[i]}LE.lastIndex=0;for(var F="",B;(B=LE.exec(m))!==null;)F+="-"+B[1];var G=dz(m)+F;return{name:G,styles:m,next:od}}var gz=function(r){return r()},gA=w1.useInsertionEffect?w1.useInsertionEffect:!1,_A=gA||gz,zE=gA||fe.useLayoutEffect,yA=fe.createContext(typeof HTMLElement<"u"?sz({key:"css"}):null);yA.Provider;var gw=function(r){return fe.forwardRef(function(s,u){var m=fe.useContext(yA);return r(s,m,u)})},dx=fe.createContext({}),_w={}.hasOwnProperty,E1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",_z=function(r,s){var u={};for(var m in s)_w.call(s,m)&&(u[m]=s[m]);return u[E1]=r,u},yz=function(r){var s=r.cache,u=r.serialized,m=r.isStringTag;return fw(s,u,m),_A(function(){return mw(s,u,m)}),null},vz=gw(function(n,r,s){var u=n.css;typeof u=="string"&&r.registered[u]!==void 0&&(u=r.registered[u]);var m=n[E1],y=[u],T="";typeof n.className=="string"?T=fA(r.registered,y,n.className):n.className!=null&&(T=n.className+" ");var i=ty(y,void 0,fe.useContext(dx));T+=r.key+"-"+i.name;var I={};for(var F in n)_w.call(n,F)&&F!=="css"&&F!==E1&&(I[F]=n[F]);return I.className=T,s&&(I.ref=s),fe.createElement(fe.Fragment,null,fe.createElement(yz,{cache:r,serialized:i,isStringTag:typeof m=="string"}),fe.createElement(m,I))}),xz=vz,bz=function(r,s){var u=arguments;if(s==null||!_w.call(s,"css"))return fe.createElement.apply(void 0,u);var m=u.length,y=new Array(m);y[0]=xz,y[1]=_z(r,s);for(var T=2;T<m;T++)y[T]=u[T];return fe.createElement.apply(null,y)};(function(n){var r;r||(r=n.JSX||(n.JSX={}))})(bz);var wz=gw(function(n,r){var s=n.styles,u=ty([s],void 0,fe.useContext(dx)),m=fe.useRef();return zE(function(){var y=r.key+"-global",T=new r.sheet.constructor({key:y,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),i=!1,I=document.querySelector('style[data-emotion="'+y+" "+u.name+'"]');return r.sheet.tags.length&&(T.before=r.sheet.tags[0]),I!==null&&(i=!0,I.setAttribute("data-emotion",y),T.hydrate([I])),m.current=[T,i],function(){T.flush()}},[r]),zE(function(){var y=m.current,T=y[0],i=y[1];if(i){y[1]=!1;return}if(u.next!==void 0&&mw(r,u.next,!0),T.tags.length){var I=T.tags[T.tags.length-1].nextElementSibling;T.before=I,T.flush()}r.insert("",u,T,!1)},[r,u.name]),null});function yw(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return ty(r)}function ny(){var n=yw.apply(void 0,arguments),r="animation-"+n.name;return{name:r,styles:"@keyframes "+r+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var Sz=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Tz=hA(function(n){return Sz.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91}),Ez=Tz,Cz=function(r){return r!=="theme"},DE=function(r){return typeof r=="string"&&r.charCodeAt(0)>96?Ez:Cz},OE=function(r,s,u){var m;if(s){var y=s.shouldForwardProp;m=r.__emotion_forwardProp&&y?function(T){return r.__emotion_forwardProp(T)&&y(T)}:y}return typeof m!="function"&&u&&(m=r.__emotion_forwardProp),m},Mz=function(r){var s=r.cache,u=r.serialized,m=r.isStringTag;return fw(s,u,m),_A(function(){return mw(s,u,m)}),null},Iz=function n(r,s){var u=r.__emotion_real===r,m=u&&r.__emotion_base||r,y,T;s!==void 0&&(y=s.label,T=s.target);var i=OE(r,s,u),I=i||DE(m),F=!I("as");return function(){var B=arguments,G=u&&r.__emotion_styles!==void 0?r.__emotion_styles.slice(0):[];if(y!==void 0&&G.push("label:"+y+";"),B[0]==null||B[0].raw===void 0)G.push.apply(G,B);else{var J=B[0];G.push(J[0]);for(var te=B.length,H=1;H<te;H++)G.push(B[H],J[H])}var j=gw(function(ne,oe,pe){var se=F&&ne.as||m,ie="",ce=[],we=ne;if(ne.theme==null){we={};for(var xe in ne)we[xe]=ne[xe];we.theme=fe.useContext(dx)}typeof ne.className=="string"?ie=fA(oe.registered,ce,ne.className):ne.className!=null&&(ie=ne.className+" ");var $e=ty(G.concat(ce),oe.registered,we);ie+=oe.key+"-"+$e.name,T!==void 0&&(ie+=" "+T);var Ze=F&&i===void 0?DE(se):I,ae={};for(var ke in ne)F&&ke==="as"||Ze(ke)&&(ae[ke]=ne[ke]);return ae.className=ie,pe&&(ae.ref=pe),fe.createElement(fe.Fragment,null,fe.createElement(Mz,{cache:oe,serialized:$e,isStringTag:typeof se=="string"}),fe.createElement(se,ae))});return j.displayName=y!==void 0?y:"Styled("+(typeof m=="string"?m:m.displayName||m.name||"Component")+")",j.defaultProps=r.defaultProps,j.__emotion_real=j,j.__emotion_base=m,j.__emotion_styles=G,j.__emotion_forwardProp=i,Object.defineProperty(j,"toString",{value:function(){return"."+T}}),j.withComponent=function(ne,oe){var pe=n(ne,$v({},s,oe,{shouldForwardProp:OE(j,oe,!0)}));return pe.apply(void 0,G)},j}},Az=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],C1=Iz.bind(null);Az.forEach(function(n){C1[n]=C1(n)});var rb={exports:{}},ib,FE;function Pz(){if(FE)return ib;FE=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ib=n,ib}var ob,BE;function Rz(){if(BE)return ob;BE=1;var n=Pz();function r(){}function s(){}return s.resetWarningCache=r,ob=function(){function u(T,i,I,F,B,G){if(G!==n){var J=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw J.name="Invariant Violation",J}}u.isRequired=u;function m(){return u}var y={array:u,bigint:u,bool:u,func:u,number:u,object:u,string:u,symbol:u,any:u,arrayOf:m,element:u,elementType:u,instanceOf:m,node:u,objectOf:m,oneOf:m,oneOfType:m,shape:m,exact:m,checkPropTypes:s,resetWarningCache:r};return y.PropTypes=y,y},ob}var NE;function kz(){return NE||(NE=1,rb.exports=Rz()()),rb.exports}var Lz=kz();const Qi=Uf(Lz);function zz(n){return n==null||Object.keys(n).length===0}function Dz(n){const{styles:r,defaultTheme:s={}}=n,u=typeof r=="function"?m=>r(zz(m)?s:m):r;return _e.jsx(wz,{styles:u})}/**
 * @mui/styled-engine v6.4.0
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function vA(n,r){return C1(n,r)}function Oz(n,r){Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=r(n.__emotion_styles))}const jE=[];function UE(n){return jE[0]=n,ty(jE)}var sb={exports:{}},Hi={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $E;function Fz(){if($E)return Hi;$E=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),T=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),te=Symbol.for("react.client.reference");function H(j){if(typeof j=="object"&&j!==null){var ne=j.$$typeof;switch(ne){case n:switch(j=j.type,j){case s:case m:case u:case I:case F:return j;default:switch(j=j&&j.$$typeof,j){case T:case i:case G:case B:return j;case y:return j;default:return ne}}case r:return ne}}}return Hi.ContextConsumer=y,Hi.ContextProvider=T,Hi.Element=n,Hi.ForwardRef=i,Hi.Fragment=s,Hi.Lazy=G,Hi.Memo=B,Hi.Portal=r,Hi.Profiler=m,Hi.StrictMode=u,Hi.Suspense=I,Hi.SuspenseList=F,Hi.isContextConsumer=function(j){return H(j)===y},Hi.isContextProvider=function(j){return H(j)===T},Hi.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===n},Hi.isForwardRef=function(j){return H(j)===i},Hi.isFragment=function(j){return H(j)===s},Hi.isLazy=function(j){return H(j)===G},Hi.isMemo=function(j){return H(j)===B},Hi.isPortal=function(j){return H(j)===r},Hi.isProfiler=function(j){return H(j)===m},Hi.isStrictMode=function(j){return H(j)===u},Hi.isSuspense=function(j){return H(j)===I},Hi.isSuspenseList=function(j){return H(j)===F},Hi.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===s||j===m||j===u||j===I||j===F||j===J||typeof j=="object"&&j!==null&&(j.$$typeof===G||j.$$typeof===B||j.$$typeof===T||j.$$typeof===y||j.$$typeof===i||j.$$typeof===te||j.getModuleId!==void 0)},Hi.typeOf=H,Hi}var VE;function Bz(){return VE||(VE=1,sb.exports=Fz()),sb.exports}var xA=Bz();function sd(n){if(typeof n!="object"||n===null)return!1;const r=Object.getPrototypeOf(n);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function bA(n){if(fe.isValidElement(n)||xA.isValidElementType(n)||!sd(n))return n;const r={};return Object.keys(n).forEach(s=>{r[s]=bA(n[s])}),r}function ks(n,r,s={clone:!0}){const u=s.clone?{...n}:n;return sd(n)&&sd(r)&&Object.keys(r).forEach(m=>{fe.isValidElement(r[m])||xA.isValidElementType(r[m])?u[m]=r[m]:sd(r[m])&&Object.prototype.hasOwnProperty.call(n,m)&&sd(n[m])?u[m]=ks(n[m],r[m],s):s.clone?u[m]=sd(r[m])?bA(r[m]):r[m]:u[m]=r[m]}),u}const Nz=n=>{const r=Object.keys(n).map(s=>({key:s,val:n[s]}))||[];return r.sort((s,u)=>s.val-u.val),r.reduce((s,u)=>({...s,[u.key]:u.val}),{})};function jz(n){const{values:r={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:s="px",step:u=5,...m}=n,y=Nz(r),T=Object.keys(y);function i(J){return`@media (min-width:${typeof r[J]=="number"?r[J]:J}${s})`}function I(J){return`@media (max-width:${(typeof r[J]=="number"?r[J]:J)-u/100}${s})`}function F(J,te){const H=T.indexOf(te);return`@media (min-width:${typeof r[J]=="number"?r[J]:J}${s}) and (max-width:${(H!==-1&&typeof r[T[H]]=="number"?r[T[H]]:te)-u/100}${s})`}function B(J){return T.indexOf(J)+1<T.length?F(J,T[T.indexOf(J)+1]):i(J)}function G(J){const te=T.indexOf(J);return te===0?i(T[1]):te===T.length-1?I(T[te]):F(J,T[T.indexOf(J)+1]).replace("@media","@media not all and")}return{keys:T,values:y,up:i,down:I,between:F,only:B,not:G,unit:s,...m}}function Uz(n,r){if(!n.containerQueries)return r;const s=Object.keys(r).filter(u=>u.startsWith("@container")).sort((u,m)=>{var T,i;const y=/min-width:\s*([0-9.]+)/;return+(((T=u.match(y))==null?void 0:T[1])||0)-+(((i=m.match(y))==null?void 0:i[1])||0)});return s.length?s.reduce((u,m)=>{const y=r[m];return delete u[m],u[m]=y,u},{...r}):r}function $z(n,r){return r==="@"||r.startsWith("@")&&(n.some(s=>r.startsWith(`@${s}`))||!!r.match(/^@\d/))}function Vz(n,r){const s=r.match(/^@([^/]+)?\/?(.+)?$/);if(!s)return null;const[,u,m]=s,y=Number.isNaN(+u)?u||0:+u;return n.containerQueries(m).up(y)}function Gz(n){const r=(y,T)=>y.replace("@media",T?`@container ${T}`:"@container");function s(y,T){y.up=(...i)=>r(n.breakpoints.up(...i),T),y.down=(...i)=>r(n.breakpoints.down(...i),T),y.between=(...i)=>r(n.breakpoints.between(...i),T),y.only=(...i)=>r(n.breakpoints.only(...i),T),y.not=(...i)=>{const I=r(n.breakpoints.not(...i),T);return I.includes("not all and")?I.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):I}}const u={},m=y=>(s(u,y),u);return s(m),{...n,containerQueries:m}}const qz={borderRadius:4};function k_(n,r){return r?ks(n,r,{clone:!1}):n}const hx={xs:0,sm:600,md:900,lg:1200,xl:1536},GE={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${hx[n]}px)`},Wz={containerQueries:n=>({up:r=>{let s=typeof r=="number"?r:hx[r]||r;return typeof s=="number"&&(s=`${s}px`),n?`@container ${n} (min-width:${s})`:`@container (min-width:${s})`}})};function gu(n,r,s){const u=n.theme||{};if(Array.isArray(r)){const y=u.breakpoints||GE;return r.reduce((T,i,I)=>(T[y.up(y.keys[I])]=s(r[I]),T),{})}if(typeof r=="object"){const y=u.breakpoints||GE;return Object.keys(r).reduce((T,i)=>{if($z(y.keys,i)){const I=Vz(u.containerQueries?u:Wz,i);I&&(T[I]=s(r[i],i))}else if(Object.keys(y.values||hx).includes(i)){const I=y.up(i);T[I]=s(r[i],i)}else{const I=i;T[I]=r[I]}return T},{})}return s(r)}function wA(n={}){var s;return((s=n.keys)==null?void 0:s.reduce((u,m)=>{const y=n.up(m);return u[y]={},u},{}))||{}}function SA(n,r){return n.reduce((s,u)=>{const m=s[u];return(!m||Object.keys(m).length===0)&&delete s[u],s},r)}function Hz(n,...r){const s=wA(n),u=[s,...r].reduce((m,y)=>ks(m,y),{});return SA(Object.keys(s),u)}function Zz(n,r){if(typeof n!="object")return{};const s={},u=Object.keys(r);return Array.isArray(n)?u.forEach((m,y)=>{y<n.length&&(s[m]=!0)}):u.forEach(m=>{n[m]!=null&&(s[m]=!0)}),s}function ab({values:n,breakpoints:r,base:s}){const u=s||Zz(n,r),m=Object.keys(u);if(m.length===0)return n;let y;return m.reduce((T,i,I)=>(Array.isArray(n)?(T[i]=n[I]!=null?n[I]:n[y],y=I):typeof n=="object"?(T[i]=n[i]!=null?n[i]:n[y],y=i):T[i]=n,T),{})}function Yt(n){if(typeof n!="string")throw new Error(oh(7));return n.charAt(0).toUpperCase()+n.slice(1)}function px(n,r,s=!0){if(!r||typeof r!="string")return null;if(n&&n.vars&&s){const u=`vars.${r}`.split(".").reduce((m,y)=>m&&m[y]?m[y]:null,n);if(u!=null)return u}return r.split(".").reduce((u,m)=>u&&u[m]!=null?u[m]:null,n)}function Gv(n,r,s,u=s){let m;return typeof n=="function"?m=n(s):Array.isArray(n)?m=n[s]||u:m=px(n,s)||u,r&&(m=r(m,u,n)),m}function Xo(n){const{prop:r,cssProperty:s=n.prop,themeKey:u,transform:m}=n,y=T=>{if(T[r]==null)return null;const i=T[r],I=T.theme,F=px(I,u)||{};return gu(T,i,G=>{let J=Gv(F,m,G);return G===J&&typeof G=="string"&&(J=Gv(F,m,`${r}${G==="default"?"":Yt(G)}`,G)),s===!1?J:{[s]:J}})};return y.propTypes={},y.filterProps=[r],y}function Xz(n){const r={};return s=>(r[s]===void 0&&(r[s]=n(s)),r[s])}const Yz={m:"margin",p:"padding"},Kz={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},qE={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Jz=Xz(n=>{if(n.length>2)if(qE[n])n=qE[n];else return[n];const[r,s]=n.split(""),u=Yz[r],m=Kz[s]||"";return Array.isArray(m)?m.map(y=>u+y):[u+m]}),vw=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],xw=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...vw,...xw];function ry(n,r,s,u){const m=px(n,r,!0)??s;return typeof m=="number"||typeof m=="string"?y=>typeof y=="string"?y:typeof m=="string"?`calc(${y} * ${m})`:m*y:Array.isArray(m)?y=>{if(typeof y=="string")return y;const T=Math.abs(y),i=m[T];return y>=0?i:typeof i=="number"?-i:`-${i}`}:typeof m=="function"?m:()=>{}}function fx(n){return ry(n,"spacing",8)}function Rf(n,r){return typeof r=="string"||r==null?r:n(r)}function Qz(n,r){return s=>n.reduce((u,m)=>(u[m]=Rf(r,s),u),{})}function eD(n,r,s,u){if(!r.includes(s))return null;const m=Jz(s),y=Qz(m,u),T=n[s];return gu(n,T,y)}function TA(n,r){const s=fx(n.theme);return Object.keys(n).map(u=>eD(n,r,u,s)).reduce(k_,{})}function Bo(n){return TA(n,vw)}Bo.propTypes={};Bo.filterProps=vw;function No(n){return TA(n,xw)}No.propTypes={};No.filterProps=xw;function EA(n=8,r=fx({spacing:n})){if(n.mui)return n;const s=(...u)=>(u.length===0?[1]:u).map(y=>{const T=r(y);return typeof T=="number"?`${T}px`:T}).join(" ");return s.mui=!0,s}function mx(...n){const r=n.reduce((u,m)=>(m.filterProps.forEach(y=>{u[y]=m}),u),{}),s=u=>Object.keys(u).reduce((m,y)=>r[y]?k_(m,r[y](u)):m,{});return s.propTypes={},s.filterProps=n.reduce((u,m)=>u.concat(m.filterProps),[]),s}function xc(n){return typeof n!="number"?n:`${n}px solid`}function Cc(n,r){return Xo({prop:n,themeKey:"borders",transform:r})}const tD=Cc("border",xc),nD=Cc("borderTop",xc),rD=Cc("borderRight",xc),iD=Cc("borderBottom",xc),oD=Cc("borderLeft",xc),sD=Cc("borderColor"),aD=Cc("borderTopColor"),lD=Cc("borderRightColor"),cD=Cc("borderBottomColor"),uD=Cc("borderLeftColor"),dD=Cc("outline",xc),hD=Cc("outlineColor"),gx=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const r=ry(n.theme,"shape.borderRadius",4),s=u=>({borderRadius:Rf(r,u)});return gu(n,n.borderRadius,s)}return null};gx.propTypes={};gx.filterProps=["borderRadius"];mx(tD,nD,rD,iD,oD,sD,aD,lD,cD,uD,gx,dD,hD);const _x=n=>{if(n.gap!==void 0&&n.gap!==null){const r=ry(n.theme,"spacing",8),s=u=>({gap:Rf(r,u)});return gu(n,n.gap,s)}return null};_x.propTypes={};_x.filterProps=["gap"];const yx=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const r=ry(n.theme,"spacing",8),s=u=>({columnGap:Rf(r,u)});return gu(n,n.columnGap,s)}return null};yx.propTypes={};yx.filterProps=["columnGap"];const vx=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const r=ry(n.theme,"spacing",8),s=u=>({rowGap:Rf(r,u)});return gu(n,n.rowGap,s)}return null};vx.propTypes={};vx.filterProps=["rowGap"];const pD=Xo({prop:"gridColumn"}),fD=Xo({prop:"gridRow"}),mD=Xo({prop:"gridAutoFlow"}),gD=Xo({prop:"gridAutoColumns"}),_D=Xo({prop:"gridAutoRows"}),yD=Xo({prop:"gridTemplateColumns"}),vD=Xo({prop:"gridTemplateRows"}),xD=Xo({prop:"gridTemplateAreas"}),bD=Xo({prop:"gridArea"});mx(_x,yx,vx,pD,fD,mD,gD,_D,yD,vD,xD,bD);function Xm(n,r){return r==="grey"?r:n}const wD=Xo({prop:"color",themeKey:"palette",transform:Xm}),SD=Xo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Xm}),TD=Xo({prop:"backgroundColor",themeKey:"palette",transform:Xm});mx(wD,SD,TD);function Fl(n){return n<=1&&n!==0?`${n*100}%`:n}const ED=Xo({prop:"width",transform:Fl}),bw=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const r=s=>{var m,y,T,i,I;const u=((T=(y=(m=n.theme)==null?void 0:m.breakpoints)==null?void 0:y.values)==null?void 0:T[s])||hx[s];return u?((I=(i=n.theme)==null?void 0:i.breakpoints)==null?void 0:I.unit)!=="px"?{maxWidth:`${u}${n.theme.breakpoints.unit}`}:{maxWidth:u}:{maxWidth:Fl(s)}};return gu(n,n.maxWidth,r)}return null};bw.filterProps=["maxWidth"];const CD=Xo({prop:"minWidth",transform:Fl}),MD=Xo({prop:"height",transform:Fl}),ID=Xo({prop:"maxHeight",transform:Fl}),AD=Xo({prop:"minHeight",transform:Fl});Xo({prop:"size",cssProperty:"width",transform:Fl});Xo({prop:"size",cssProperty:"height",transform:Fl});const PD=Xo({prop:"boxSizing"});mx(ED,bw,CD,MD,ID,AD,PD);const iy={border:{themeKey:"borders",transform:xc},borderTop:{themeKey:"borders",transform:xc},borderRight:{themeKey:"borders",transform:xc},borderBottom:{themeKey:"borders",transform:xc},borderLeft:{themeKey:"borders",transform:xc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:xc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:gx},color:{themeKey:"palette",transform:Xm},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Xm},backgroundColor:{themeKey:"palette",transform:Xm},p:{style:No},pt:{style:No},pr:{style:No},pb:{style:No},pl:{style:No},px:{style:No},py:{style:No},padding:{style:No},paddingTop:{style:No},paddingRight:{style:No},paddingBottom:{style:No},paddingLeft:{style:No},paddingX:{style:No},paddingY:{style:No},paddingInline:{style:No},paddingInlineStart:{style:No},paddingInlineEnd:{style:No},paddingBlock:{style:No},paddingBlockStart:{style:No},paddingBlockEnd:{style:No},m:{style:Bo},mt:{style:Bo},mr:{style:Bo},mb:{style:Bo},ml:{style:Bo},mx:{style:Bo},my:{style:Bo},margin:{style:Bo},marginTop:{style:Bo},marginRight:{style:Bo},marginBottom:{style:Bo},marginLeft:{style:Bo},marginX:{style:Bo},marginY:{style:Bo},marginInline:{style:Bo},marginInlineStart:{style:Bo},marginInlineEnd:{style:Bo},marginBlock:{style:Bo},marginBlockStart:{style:Bo},marginBlockEnd:{style:Bo},displayPrint:{cssProperty:!1,transform:n=>({"@media print":{display:n}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:_x},rowGap:{style:vx},columnGap:{style:yx},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Fl},maxWidth:{style:bw},minWidth:{transform:Fl},height:{transform:Fl},maxHeight:{transform:Fl},minHeight:{transform:Fl},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function RD(...n){const r=n.reduce((u,m)=>u.concat(Object.keys(m)),[]),s=new Set(r);return n.every(u=>s.size===Object.keys(u).length)}function kD(n,r){return typeof n=="function"?n(r):n}function LD(){function n(s,u,m,y){const T={[s]:u,theme:m},i=y[s];if(!i)return{[s]:u};const{cssProperty:I=s,themeKey:F,transform:B,style:G}=i;if(u==null)return null;if(F==="typography"&&u==="inherit")return{[s]:u};const J=px(m,F)||{};return G?G(T):gu(T,u,H=>{let j=Gv(J,B,H);return H===j&&typeof H=="string"&&(j=Gv(J,B,`${s}${H==="default"?"":Yt(H)}`,H)),I===!1?j:{[I]:j}})}function r(s){const{sx:u,theme:m={}}=s||{};if(!u)return null;const y=m.unstable_sxConfig??iy;function T(i){let I=i;if(typeof i=="function")I=i(m);else if(typeof i!="object")return i;if(!I)return null;const F=wA(m.breakpoints),B=Object.keys(F);let G=F;return Object.keys(I).forEach(J=>{const te=kD(I[J],m);if(te!=null)if(typeof te=="object")if(y[J])G=k_(G,n(J,te,m,y));else{const H=gu({theme:m},te,j=>({[J]:j}));RD(H,te)?G[J]=r({sx:te,theme:m}):G=k_(G,H)}else G=k_(G,n(J,te,m,y))}),Uz(m,SA(B,G))}return Array.isArray(u)?u.map(T):T(u)}return r}const kf=LD();kf.filterProps=["sx"];function zD(n,r){var u;const s=this;if(s.vars){if(!((u=s.colorSchemes)!=null&&u[n])||typeof s.getColorSchemeSelector!="function")return{};let m=s.getColorSchemeSelector(n);return m==="&"?r:((m.includes("data-")||m.includes("."))&&(m=`*:where(${m.replace(/\s*&$/,"")}) &`),{[m]:r})}return s.palette.mode===n?r:{}}function oy(n={},...r){const{breakpoints:s={},palette:u={},spacing:m,shape:y={},...T}=n,i=jz(s),I=EA(m);let F=ks({breakpoints:i,direction:"ltr",components:{},palette:{mode:"light",...u},spacing:I,shape:{...qz,...y}},T);return F=Gz(F),F.applyStyles=zD,F=r.reduce((B,G)=>ks(B,G),F),F.unstable_sxConfig={...iy,...T==null?void 0:T.unstable_sxConfig},F.unstable_sx=function(G){return kf({sx:G,theme:this})},F}function DD(n){return Object.keys(n).length===0}function OD(n=null){const r=fe.useContext(dx);return!r||DD(r)?n:r}const FD=oy();function xx(n=FD){return OD(n)}function BD({styles:n,themeId:r,defaultTheme:s={}}){const u=xx(s),m=typeof n=="function"?n(r&&u[r]||u):n;return _e.jsx(Dz,{styles:m})}const ND=n=>{var u;const r={systemProps:{},otherProps:{}},s=((u=n==null?void 0:n.theme)==null?void 0:u.unstable_sxConfig)??iy;return Object.keys(n).forEach(m=>{s[m]?r.systemProps[m]=n[m]:r.otherProps[m]=n[m]}),r};function ww(n){const{sx:r,...s}=n,{systemProps:u,otherProps:m}=ND(s);let y;return Array.isArray(r)?y=[u,...r]:typeof r=="function"?y=(...T)=>{const i=r(...T);return sd(i)?{...u,...i}:u}:y={...u,...r},{...m,sx:y}}const WE=n=>n,jD=()=>{let n=WE;return{configure(r){n=r},generate(r){return n(r)},reset(){n=WE}}},CA=jD();function MA(n){var r,s,u="";if(typeof n=="string"||typeof n=="number")u+=n;else if(typeof n=="object")if(Array.isArray(n)){var m=n.length;for(r=0;r<m;r++)n[r]&&(s=MA(n[r]))&&(u&&(u+=" "),u+=s)}else for(s in n)n[s]&&(u&&(u+=" "),u+=s);return u}function Sn(){for(var n,r,s=0,u="",m=arguments.length;s<m;s++)(n=arguments[s])&&(r=MA(n))&&(u&&(u+=" "),u+=r);return u}function UD(n={}){const{themeId:r,defaultTheme:s,defaultClassName:u="MuiBox-root",generateClassName:m}=n,y=vA("div",{shouldForwardProp:i=>i!=="theme"&&i!=="sx"&&i!=="as"})(kf);return fe.forwardRef(function(I,F){const B=xx(s),{className:G,component:J="div",...te}=ww(I);return _e.jsx(y,{as:J,ref:F,className:Sn(G,m?m(u):u),theme:r&&B[r]||B,...te})})}const $D={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function sr(n,r,s="Mui"){const u=$D[r];return u?`${s}-${u}`:`${CA.generate(n)}-${r}`}function ar(n,r,s="Mui"){const u={};return r.forEach(m=>{u[m]=sr(n,m,s)}),u}function IA(n){const{variants:r,...s}=n,u={variants:r,style:UE(s),isProcessed:!0};return u.style===s||r&&r.forEach(m=>{typeof m.style!="function"&&(m.style=UE(m.style))}),u}const VD=oy();function lb(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}function GD(n){return n?(r,s)=>s[n]:null}function qD(n,r,s){n.theme=HD(n.theme)?s:n.theme[r]||n.theme}function Dv(n,r){const s=typeof r=="function"?r(n):r;if(Array.isArray(s))return s.flatMap(u=>Dv(n,u));if(Array.isArray(s==null?void 0:s.variants)){let u;if(s.isProcessed)u=s.style;else{const{variants:m,...y}=s;u=y}return AA(n,s.variants,[u])}return s!=null&&s.isProcessed?s.style:s}function AA(n,r,s=[]){var m;let u;e:for(let y=0;y<r.length;y+=1){const T=r[y];if(typeof T.props=="function"){if(u??(u={...n,...n.ownerState,ownerState:n.ownerState}),!T.props(u))continue}else for(const i in T.props)if(n[i]!==T.props[i]&&((m=n.ownerState)==null?void 0:m[i])!==T.props[i])continue e;typeof T.style=="function"?(u??(u={...n,...n.ownerState,ownerState:n.ownerState}),s.push(T.style(u))):s.push(T.style)}return s}function PA(n={}){const{themeId:r,defaultTheme:s=VD,rootShouldForwardProp:u=lb,slotShouldForwardProp:m=lb}=n;function y(i){qD(i,r,s)}return(i,I={})=>{Oz(i,ce=>ce.filter(we=>we!==kf));const{name:F,slot:B,skipVariantsResolver:G,skipSx:J,overridesResolver:te=GD(XD(B)),...H}=I,j=G!==void 0?G:B&&B!=="Root"&&B!=="root"||!1,ne=J||!1;let oe=lb;B==="Root"||B==="root"?oe=u:B?oe=m:ZD(i)&&(oe=void 0);const pe=vA(i,{shouldForwardProp:oe,label:WD(),...H}),se=ce=>{if(typeof ce=="function"&&ce.__emotion_real!==ce)return function(xe){return Dv(xe,ce)};if(sd(ce)){const we=IA(ce);return we.variants?function($e){return Dv($e,we)}:we.style}return ce},ie=(...ce)=>{const we=[],xe=ce.map(se),$e=[];if(we.push(y),F&&te&&$e.push(function(ct){var gt,zt;const st=(zt=(gt=ct.theme.components)==null?void 0:gt[F])==null?void 0:zt.styleOverrides;if(!st)return null;const et={};for(const at in st)et[at]=Dv(ct,st[at]);return te(ct,et)}),F&&!j&&$e.push(function(ct){var et,gt;const Xe=ct.theme,st=(gt=(et=Xe==null?void 0:Xe.components)==null?void 0:et[F])==null?void 0:gt.variants;return st?AA(ct,st):null}),ne||$e.push(kf),Array.isArray(xe[0])){const ke=xe.shift(),ct=new Array(we.length).fill(""),Xe=new Array($e.length).fill("");let st;st=[...ct,...ke,...Xe],st.raw=[...ct,...ke.raw,...Xe],we.unshift(st)}const Ze=[...we,...xe,...$e],ae=pe(...Ze);return i.muiName&&(ae.muiName=i.muiName),ae};return pe.withConfig&&(ie.withConfig=pe.withConfig),ie}}function WD(n,r){return void 0}function HD(n){for(const r in n)return!1;return!0}function ZD(n){return typeof n=="string"&&n.charCodeAt(0)>96}function XD(n){return n&&n.charAt(0).toLowerCase()+n.slice(1)}const RA=PA();function W_(n,r){const s={...r};for(const u in n)if(Object.prototype.hasOwnProperty.call(n,u)){const m=u;if(m==="components"||m==="slots")s[m]={...n[m],...s[m]};else if(m==="componentsProps"||m==="slotProps"){const y=n[m],T=r[m];if(!T)s[m]=y||{};else if(!y)s[m]=T;else{s[m]={...T};for(const i in y)if(Object.prototype.hasOwnProperty.call(y,i)){const I=i;s[m][I]=W_(y[I],T[I])}}}else s[m]===void 0&&(s[m]=n[m])}return s}function YD(n){const{theme:r,name:s,props:u}=n;return!r||!r.components||!r.components[s]||!r.components[s].defaultProps?u:W_(r.components[s].defaultProps,u)}function kA({props:n,name:r,defaultTheme:s,themeId:u}){let m=xx(s);return u&&(m=m[u]||m),YD({theme:m,name:r,props:n})}const _u=typeof window<"u"?fe.useLayoutEffect:fe.useEffect;function Sf(n,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER){return Math.max(r,Math.min(n,s))}function Sw(n,r=0,s=1){return Sf(n,r,s)}function KD(n){n=n.slice(1);const r=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let s=n.match(r);return s&&s[0].length===1&&(s=s.map(u=>u+u)),s?`rgb${s.length===4?"a":""}(${s.map((u,m)=>m<3?parseInt(u,16):Math.round(parseInt(u,16)/255*1e3)/1e3).join(", ")})`:""}function wp(n){if(n.type)return n;if(n.charAt(0)==="#")return wp(KD(n));const r=n.indexOf("("),s=n.substring(0,r);if(!["rgb","rgba","hsl","hsla","color"].includes(s))throw new Error(oh(9,n));let u=n.substring(r+1,n.length-1),m;if(s==="color"){if(u=u.split(" "),m=u.shift(),u.length===4&&u[3].charAt(0)==="/"&&(u[3]=u[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(m))throw new Error(oh(10,m))}else u=u.split(",");return u=u.map(y=>parseFloat(y)),{type:s,values:u,colorSpace:m}}const JD=n=>{const r=wp(n);return r.values.slice(0,3).map((s,u)=>r.type.includes("hsl")&&u!==0?`${s}%`:s).join(" ")},E_=(n,r)=>{try{return JD(n)}catch{return n}};function bx(n){const{type:r,colorSpace:s}=n;let{values:u}=n;return r.includes("rgb")?u=u.map((m,y)=>y<3?parseInt(m,10):m):r.includes("hsl")&&(u[1]=`${u[1]}%`,u[2]=`${u[2]}%`),r.includes("color")?u=`${s} ${u.join(" ")}`:u=`${u.join(", ")}`,`${r}(${u})`}function LA(n){n=wp(n);const{values:r}=n,s=r[0],u=r[1]/100,m=r[2]/100,y=u*Math.min(m,1-m),T=(F,B=(F+s/30)%12)=>m-y*Math.max(Math.min(B-3,9-B,1),-1);let i="rgb";const I=[Math.round(T(0)*255),Math.round(T(8)*255),Math.round(T(4)*255)];return n.type==="hsla"&&(i+="a",I.push(r[3])),bx({type:i,values:I})}function M1(n){n=wp(n);let r=n.type==="hsl"||n.type==="hsla"?wp(LA(n)).values:n.values;return r=r.map(s=>(n.type!=="color"&&(s/=255),s<=.03928?s/12.92:((s+.055)/1.055)**2.4)),Number((.2126*r[0]+.7152*r[1]+.0722*r[2]).toFixed(3))}function QD(n,r){const s=M1(n),u=M1(r);return(Math.max(s,u)+.05)/(Math.min(s,u)+.05)}function Oi(n,r){return n=wp(n),r=Sw(r),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${r}`:n.values[3]=r,bx(n)}function ov(n,r,s){try{return Oi(n,r)}catch{return n}}function Lf(n,r){if(n=wp(n),r=Sw(r),n.type.includes("hsl"))n.values[2]*=1-r;else if(n.type.includes("rgb")||n.type.includes("color"))for(let s=0;s<3;s+=1)n.values[s]*=1-r;return bx(n)}function eo(n,r,s){try{return Lf(n,r)}catch{return n}}function zf(n,r){if(n=wp(n),r=Sw(r),n.type.includes("hsl"))n.values[2]+=(100-n.values[2])*r;else if(n.type.includes("rgb"))for(let s=0;s<3;s+=1)n.values[s]+=(255-n.values[s])*r;else if(n.type.includes("color"))for(let s=0;s<3;s+=1)n.values[s]+=(1-n.values[s])*r;return bx(n)}function to(n,r,s){try{return zf(n,r)}catch{return n}}function zA(n,r=.15){return M1(n)>.5?Lf(n,r):zf(n,r)}function sv(n,r,s){try{return zA(n,r)}catch{return n}}function I1(...n){return n.reduce((r,s)=>s==null?r:function(...m){r.apply(this,m),s.apply(this,m)},()=>{})}function Tw(n,r=166){let s;function u(...m){const y=()=>{n.apply(this,m)};clearTimeout(s),s=setTimeout(y,r)}return u.clear=()=>{clearTimeout(s)},u}function L_(n,r){var s,u,m;return fe.isValidElement(n)&&r.indexOf(n.type.muiName??((m=(u=(s=n.type)==null?void 0:s._payload)==null?void 0:u.value)==null?void 0:m.muiName))!==-1}function cs(n){return n&&n.ownerDocument||document}function yu(n){return cs(n).defaultView||window}function A1(n,r){typeof n=="function"?n(r):n&&(n.current=r)}let HE=0;function eO(n){const[r,s]=fe.useState(n),u=n||r;return fe.useEffect(()=>{r==null&&(HE+=1,s(`mui-${HE}`))},[r]),u}const tO={...w1},ZE=tO.useId;function ah(n){if(ZE!==void 0){const r=ZE();return n??r}return eO(n)}function Df({controlled:n,default:r,name:s,state:u="value"}){const{current:m}=fe.useRef(n!==void 0),[y,T]=fe.useState(r),i=m?n:y,I=fe.useCallback(F=>{m||T(F)},[]);return[i,I]}function il(n){const r=fe.useRef(n);return _u(()=>{r.current=n}),fe.useRef((...s)=>(0,r.current)(...s)).current}function ao(...n){return fe.useMemo(()=>n.every(r=>r==null)?null:r=>{n.forEach(s=>{A1(s,r)})},n)}const XE={};function DA(n,r){const s=fe.useRef(XE);return s.current===XE&&(s.current=n(r)),s}const nO=[];function rO(n){fe.useEffect(n,nO)}class wx{constructor(){t_(this,"currentId",null);t_(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});t_(this,"disposeEffect",()=>this.clear)}static create(){return new wx}start(r,s){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,s()},r)}}function Cf(){const n=DA(wx.create).current;return rO(n.disposeEffect),n}function Sp(n){try{return n.matches(":focus-visible")}catch{}return!1}function OA(n=window){const r=n.document.documentElement.clientWidth;return n.innerWidth-r}const FA=n=>{const r=fe.useRef({});return fe.useEffect(()=>{r.current=n}),r.current},BA={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function lr(n,r,s=void 0){const u={};for(const m in n){const y=n[m];let T="",i=!0;for(let I=0;I<y.length;I+=1){const F=y[I];F&&(T+=(i===!0?"":" ")+r(F),i=!1,s&&s[F]&&(T+=" "+s[F]))}u[m]=T}return u}function iO(n){return typeof n=="string"}function NA(n,r,s){return n===void 0||iO(n)?r:{...r,ownerState:{...r.ownerState,...s}}}function If(n,r=[]){if(n===void 0)return{};const s={};return Object.keys(n).filter(u=>u.match(/^on[A-Z]/)&&typeof n[u]=="function"&&!r.includes(u)).forEach(u=>{s[u]=n[u]}),s}function YE(n){if(n===void 0)return{};const r={};return Object.keys(n).filter(s=>!(s.match(/^on[A-Z]/)&&typeof n[s]=="function")).forEach(s=>{r[s]=n[s]}),r}function jA(n){const{getSlotProps:r,additionalProps:s,externalSlotProps:u,externalForwardedProps:m,className:y}=n;if(!r){const te=Sn(s==null?void 0:s.className,y,m==null?void 0:m.className,u==null?void 0:u.className),H={...s==null?void 0:s.style,...m==null?void 0:m.style,...u==null?void 0:u.style},j={...s,...m,...u};return te.length>0&&(j.className=te),Object.keys(H).length>0&&(j.style=H),{props:j,internalRef:void 0}}const T=If({...m,...u}),i=YE(u),I=YE(m),F=r(T),B=Sn(F==null?void 0:F.className,s==null?void 0:s.className,y,m==null?void 0:m.className,u==null?void 0:u.className),G={...F==null?void 0:F.style,...s==null?void 0:s.style,...m==null?void 0:m.style,...u==null?void 0:u.style},J={...F,...s,...I,...i};return B.length>0&&(J.className=B),Object.keys(G).length>0&&(J.style=G),{props:J,internalRef:F.ref}}function UA(n,r,s){return typeof n=="function"?n(r,s):n}function rl(n){var G;const{elementType:r,externalSlotProps:s,ownerState:u,skipResolvingSlotProps:m=!1,...y}=n,T=m?{}:UA(s,u),{props:i,internalRef:I}=jA({...y,externalSlotProps:T}),F=ao(I,T==null?void 0:T.ref,(G=n.additionalProps)==null?void 0:G.ref);return NA(r,{...i,ref:F},u)}function Cp(n){var r;return parseInt(fe.version,10)>=19?((r=n==null?void 0:n.props)==null?void 0:r.ref)||null:(n==null?void 0:n.ref)||null}const oO=fe.createContext(),cg=()=>fe.useContext(oO)??!1,sO=fe.createContext(void 0);function aO(n){const{theme:r,name:s,props:u}=n;if(!r||!r.components||!r.components[s])return u;const m=r.components[s];return m.defaultProps?W_(m.defaultProps,u):!m.styleOverrides&&!m.variants?W_(m,u):u}function lO({props:n,name:r}){const s=fe.useContext(sO);return aO({props:n,name:r,theme:{components:s}})}const KE={theme:void 0};function cO(n){let r,s;return function(m){let y=r;return(y===void 0||m.theme!==s)&&(KE.theme=m.theme,y=IA(n(KE)),r=y,s=m.theme),y}}function uO(n=""){function r(...u){if(!u.length)return"";const m=u[0];return typeof m=="string"&&!m.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${n?`${n}-`:""}${m}${r(...u.slice(1))})`:`, ${m}`}return(u,...m)=>`var(--${n?`${n}-`:""}${u}${r(...m)})`}const JE=(n,r,s,u=[])=>{let m=n;r.forEach((y,T)=>{T===r.length-1?Array.isArray(m)?m[Number(y)]=s:m&&typeof m=="object"&&(m[y]=s):m&&typeof m=="object"&&(m[y]||(m[y]=u.includes(y)?[]:{}),m=m[y])})},dO=(n,r,s)=>{function u(m,y=[],T=[]){Object.entries(m).forEach(([i,I])=>{(!s||!s([...y,i]))&&I!=null&&(typeof I=="object"&&Object.keys(I).length>0?u(I,[...y,i],Array.isArray(I)?[...T,i]:T):r([...y,i],I,T))})}u(n)},hO=(n,r)=>typeof r=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(u=>n.includes(u))||n[n.length-1].toLowerCase().includes("opacity")?r:`${r}px`:r;function cb(n,r){const{prefix:s,shouldSkipGeneratingVar:u}=r||{},m={},y={},T={};return dO(n,(i,I,F)=>{if((typeof I=="string"||typeof I=="number")&&(!u||!u(i,I))){const B=`--${s?`${s}-`:""}${i.join("-")}`,G=hO(i,I);Object.assign(m,{[B]:G}),JE(y,i,`var(${B})`,F),JE(T,i,`var(${B}, ${G})`,F)}},i=>i[0]==="vars"),{css:m,vars:y,varsWithDefaults:T}}function pO(n,r={}){const{getSelector:s=ne,disableCssColorScheme:u,colorSchemeSelector:m}=r,{colorSchemes:y={},components:T,defaultColorScheme:i="light",...I}=n,{vars:F,css:B,varsWithDefaults:G}=cb(I,r);let J=G;const te={},{[i]:H,...j}=y;if(Object.entries(j||{}).forEach(([se,ie])=>{const{vars:ce,css:we,varsWithDefaults:xe}=cb(ie,r);J=ks(J,xe),te[se]={css:we,vars:ce}}),H){const{css:se,vars:ie,varsWithDefaults:ce}=cb(H,r);J=ks(J,ce),te[i]={css:se,vars:ie}}function ne(se,ie){var we,xe;let ce=m;if(m==="class"&&(ce=".%s"),m==="data"&&(ce="[data-%s]"),m!=null&&m.startsWith("data-")&&!m.includes("%s")&&(ce=`[${m}="%s"]`),se){if(ce==="media")return n.defaultColorScheme===se?":root":{[`@media (prefers-color-scheme: ${((xe=(we=y[se])==null?void 0:we.palette)==null?void 0:xe.mode)||se})`]:{":root":ie}};if(ce)return n.defaultColorScheme===se?`:root, ${ce.replace("%s",String(se))}`:ce.replace("%s",String(se))}return":root"}return{vars:J,generateThemeVars:()=>{let se={...F};return Object.entries(te).forEach(([,{vars:ie}])=>{se=ks(se,ie)}),se},generateStyleSheets:()=>{var $e,Ze;const se=[],ie=n.defaultColorScheme||"light";function ce(ae,ke){Object.keys(ke).length&&se.push(typeof ae=="string"?{[ae]:{...ke}}:ae)}ce(s(void 0,{...B}),B);const{[ie]:we,...xe}=te;if(we){const{css:ae}=we,ke=(Ze=($e=y[ie])==null?void 0:$e.palette)==null?void 0:Ze.mode,ct=!u&&ke?{colorScheme:ke,...ae}:{...ae};ce(s(ie,{...ct}),ct)}return Object.entries(xe).forEach(([ae,{css:ke}])=>{var st,et;const ct=(et=(st=y[ae])==null?void 0:st.palette)==null?void 0:et.mode,Xe=!u&&ct?{colorScheme:ct,...ke}:{...ke};ce(s(ae,{...Xe}),Xe)}),se}}}function fO(n){return function(s){return n==="media"?`@media (prefers-color-scheme: ${s})`:n?n.startsWith("data-")&&!n.includes("%s")?`[${n}="${s}"] &`:n==="class"?`.${s} &`:n==="data"?`[data-${s}] &`:`${n.replace("%s",s)} &`:"&"}}const mO=oy(),gO=RA("div",{name:"MuiContainer",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`maxWidth${Yt(String(s.maxWidth))}`],s.fixed&&r.fixed,s.disableGutters&&r.disableGutters]}}),_O=n=>kA({props:n,name:"MuiContainer",defaultTheme:mO}),yO=(n,r)=>{const s=I=>sr(r,I),{classes:u,fixed:m,disableGutters:y,maxWidth:T}=n,i={root:["root",T&&`maxWidth${Yt(String(T))}`,m&&"fixed",y&&"disableGutters"]};return lr(i,s,u)};function vO(n={}){const{createStyledComponent:r=gO,useThemeProps:s=_O,componentName:u="MuiContainer"}=n,m=r(({theme:T,ownerState:i})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!i.disableGutters&&{paddingLeft:T.spacing(2),paddingRight:T.spacing(2),[T.breakpoints.up("sm")]:{paddingLeft:T.spacing(3),paddingRight:T.spacing(3)}}}),({theme:T,ownerState:i})=>i.fixed&&Object.keys(T.breakpoints.values).reduce((I,F)=>{const B=F,G=T.breakpoints.values[B];return G!==0&&(I[T.breakpoints.up(B)]={maxWidth:`${G}${T.breakpoints.unit}`}),I},{}),({theme:T,ownerState:i})=>({...i.maxWidth==="xs"&&{[T.breakpoints.up("xs")]:{maxWidth:Math.max(T.breakpoints.values.xs,444)}},...i.maxWidth&&i.maxWidth!=="xs"&&{[T.breakpoints.up(i.maxWidth)]:{maxWidth:`${T.breakpoints.values[i.maxWidth]}${T.breakpoints.unit}`}}}));return fe.forwardRef(function(i,I){const F=s(i),{className:B,component:G="div",disableGutters:J=!1,fixed:te=!1,maxWidth:H="lg",classes:j,...ne}=F,oe={...F,component:G,disableGutters:J,fixed:te,maxWidth:H},pe=yO(oe,u);return _e.jsx(m,{as:G,ownerState:oe,className:Sn(pe.root,B),ref:I,...ne})})}const xO=oy(),bO=RA("div",{name:"MuiStack",slot:"Root",overridesResolver:(n,r)=>r.root});function wO(n){return kA({props:n,name:"MuiStack",defaultTheme:xO})}function SO(n,r){const s=fe.Children.toArray(n).filter(Boolean);return s.reduce((u,m,y)=>(u.push(m),y<s.length-1&&u.push(fe.cloneElement(r,{key:`separator-${y}`})),u),[])}const TO=n=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[n],EO=({ownerState:n,theme:r})=>{let s={display:"flex",flexDirection:"column",...gu({theme:r},ab({values:n.direction,breakpoints:r.breakpoints.values}),u=>({flexDirection:u}))};if(n.spacing){const u=fx(r),m=Object.keys(r.breakpoints.values).reduce((I,F)=>((typeof n.spacing=="object"&&n.spacing[F]!=null||typeof n.direction=="object"&&n.direction[F]!=null)&&(I[F]=!0),I),{}),y=ab({values:n.direction,base:m}),T=ab({values:n.spacing,base:m});typeof y=="object"&&Object.keys(y).forEach((I,F,B)=>{if(!y[I]){const J=F>0?y[B[F-1]]:"column";y[I]=J}}),s=ks(s,gu({theme:r},T,(I,F)=>n.useFlexGap?{gap:Rf(u,I)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${TO(F?y[F]:n.direction)}`]:Rf(u,I)}}))}return s=Hz(r.breakpoints,s),s};function CO(n={}){const{createStyledComponent:r=bO,useThemeProps:s=wO,componentName:u="MuiStack"}=n,m=()=>lr({root:["root"]},I=>sr(u,I),{}),y=r(EO);return fe.forwardRef(function(I,F){const B=s(I),G=ww(B),{component:J="div",direction:te="column",spacing:H=0,divider:j,children:ne,className:oe,useFlexGap:pe=!1,...se}=G,ie={direction:te,spacing:H,useFlexGap:pe},ce=m();return _e.jsx(y,{as:J,ownerState:ie,ref:F,className:Sn(ce.root,oe),...se,children:j?SO(ne,j):ne})})}function $A(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:$_.white,default:$_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const MO=$A();function VA(){return{text:{primary:$_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:$_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const QE=VA();function eC(n,r,s,u){const m=u.light||u,y=u.dark||u*1.5;n[r]||(n.hasOwnProperty(s)?n[r]=n[s]:r==="light"?n.light=zf(n.main,m):r==="dark"&&(n.dark=Lf(n.main,y)))}function IO(n="light"){return n==="dark"?{main:Nm[200],light:Nm[50],dark:Nm[400]}:{main:Nm[700],light:Nm[400],dark:Nm[800]}}function AO(n="light"){return n==="dark"?{main:Bm[200],light:Bm[50],dark:Bm[400]}:{main:Bm[500],light:Bm[300],dark:Bm[700]}}function PO(n="light"){return n==="dark"?{main:Fm[500],light:Fm[300],dark:Fm[700]}:{main:Fm[700],light:Fm[400],dark:Fm[800]}}function RO(n="light"){return n==="dark"?{main:jm[400],light:jm[300],dark:jm[700]}:{main:jm[700],light:jm[500],dark:jm[900]}}function kO(n="light"){return n==="dark"?{main:Um[400],light:Um[300],dark:Um[700]}:{main:Um[800],light:Um[500],dark:Um[900]}}function LO(n="light"){return n==="dark"?{main:r_[400],light:r_[300],dark:r_[700]}:{main:"#ed6c02",light:r_[500],dark:r_[900]}}function Ew(n){const{mode:r="light",contrastThreshold:s=3,tonalOffset:u=.2,...m}=n,y=n.primary||IO(r),T=n.secondary||AO(r),i=n.error||PO(r),I=n.info||RO(r),F=n.success||kO(r),B=n.warning||LO(r);function G(j){return QD(j,QE.text.primary)>=s?QE.text.primary:MO.text.primary}const J=({color:j,name:ne,mainShade:oe=500,lightShade:pe=300,darkShade:se=700})=>{if(j={...j},!j.main&&j[oe]&&(j.main=j[oe]),!j.hasOwnProperty("main"))throw new Error(oh(11,ne?` (${ne})`:"",oe));if(typeof j.main!="string")throw new Error(oh(12,ne?` (${ne})`:"",JSON.stringify(j.main)));return eC(j,"light",pe,u),eC(j,"dark",se,u),j.contrastText||(j.contrastText=G(j.main)),j};let te;return r==="light"?te=$A():r==="dark"&&(te=VA()),ks({common:{...$_},mode:r,primary:J({color:y,name:"primary"}),secondary:J({color:T,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:J({color:i,name:"error"}),warning:J({color:B,name:"warning"}),info:J({color:I,name:"info"}),success:J({color:F,name:"success"}),grey:R3,contrastThreshold:s,getContrastText:G,augmentColor:J,tonalOffset:u,...te},m)}function zO(n){const r={};return Object.entries(n).forEach(u=>{const[m,y]=u;typeof y=="object"&&(r[m]=`${y.fontStyle?`${y.fontStyle} `:""}${y.fontVariant?`${y.fontVariant} `:""}${y.fontWeight?`${y.fontWeight} `:""}${y.fontStretch?`${y.fontStretch} `:""}${y.fontSize||""}${y.lineHeight?`/${y.lineHeight} `:""}${y.fontFamily||""}`)}),r}function DO(n,r){return{toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}},...r}}function OO(n){return Math.round(n*1e5)/1e5}const tC={textTransform:"uppercase"},nC='"Roboto", "Helvetica", "Arial", sans-serif';function FO(n,r){const{fontFamily:s=nC,fontSize:u=14,fontWeightLight:m=300,fontWeightRegular:y=400,fontWeightMedium:T=500,fontWeightBold:i=700,htmlFontSize:I=16,allVariants:F,pxToRem:B,...G}=typeof r=="function"?r(n):r,J=u/14,te=B||(ne=>`${ne/I*J}rem`),H=(ne,oe,pe,se,ie)=>({fontFamily:s,fontWeight:ne,fontSize:te(oe),lineHeight:pe,...s===nC?{letterSpacing:`${OO(se/oe)}em`}:{},...ie,...F}),j={h1:H(m,96,1.167,-1.5),h2:H(m,60,1.2,-.5),h3:H(y,48,1.167,0),h4:H(y,34,1.235,.25),h5:H(y,24,1.334,0),h6:H(T,20,1.6,.15),subtitle1:H(y,16,1.75,.15),subtitle2:H(T,14,1.57,.1),body1:H(y,16,1.5,.15),body2:H(y,14,1.43,.15),button:H(T,14,1.75,.4,tC),caption:H(y,12,1.66,.4),overline:H(y,12,2.66,1,tC),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ks({htmlFontSize:I,pxToRem:te,fontFamily:s,fontSize:u,fontWeightLight:m,fontWeightRegular:y,fontWeightMedium:T,fontWeightBold:i,...j},G,{clone:!1})}const BO=.2,NO=.14,jO=.12;function xo(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${BO})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${NO})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${jO})`].join(",")}const UO=["none",xo(0,2,1,-1,0,1,1,0,0,1,3,0),xo(0,3,1,-2,0,2,2,0,0,1,5,0),xo(0,3,3,-2,0,3,4,0,0,1,8,0),xo(0,2,4,-1,0,4,5,0,0,1,10,0),xo(0,3,5,-1,0,5,8,0,0,1,14,0),xo(0,3,5,-1,0,6,10,0,0,1,18,0),xo(0,4,5,-2,0,7,10,1,0,2,16,1),xo(0,5,5,-3,0,8,10,1,0,3,14,2),xo(0,5,6,-3,0,9,12,1,0,3,16,2),xo(0,6,6,-3,0,10,14,1,0,4,18,3),xo(0,6,7,-4,0,11,15,1,0,4,20,3),xo(0,7,8,-4,0,12,17,2,0,5,22,4),xo(0,7,8,-4,0,13,19,2,0,5,24,4),xo(0,7,9,-4,0,14,21,2,0,5,26,4),xo(0,8,9,-5,0,15,22,2,0,6,28,5),xo(0,8,10,-5,0,16,24,2,0,6,30,5),xo(0,8,11,-5,0,17,26,2,0,6,32,5),xo(0,9,11,-5,0,18,28,2,0,7,34,6),xo(0,9,12,-6,0,19,29,2,0,7,36,6),xo(0,10,13,-6,0,20,31,3,0,8,38,7),xo(0,10,13,-6,0,21,33,3,0,8,40,7),xo(0,10,14,-6,0,22,35,3,0,8,42,7),xo(0,11,14,-7,0,23,36,3,0,9,44,8),xo(0,11,15,-7,0,24,38,3,0,9,46,8)],$O={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},VO={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function rC(n){return`${Math.round(n)}ms`}function GO(n){if(!n)return 0;const r=n/36;return Math.min(Math.round((4+15*r**.25+r/5)*10),3e3)}function qO(n){const r={...$O,...n.easing},s={...VO,...n.duration};return{getAutoHeightDuration:GO,create:(m=["all"],y={})=>{const{duration:T=s.standard,easing:i=r.easeInOut,delay:I=0,...F}=y;return(Array.isArray(m)?m:[m]).map(B=>`${B} ${typeof T=="string"?T:rC(T)} ${i} ${typeof I=="string"?I:rC(I)}`).join(",")},...n,easing:r,duration:s}}const WO={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function HO(n){return sd(n)||typeof n>"u"||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||Array.isArray(n)}function GA(n={}){const r={...n};function s(u){const m=Object.entries(u);for(let y=0;y<m.length;y++){const[T,i]=m[y];!HO(i)||T.startsWith("unstable_")?delete u[T]:sd(i)&&(u[T]={...i},s(u[T]))}}return s(r),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(r,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function P1(n={},...r){const{breakpoints:s,mixins:u={},spacing:m,palette:y={},transitions:T={},typography:i={},shape:I,...F}=n;if(n.vars)throw new Error(oh(20));const B=Ew(y),G=oy(n);let J=ks(G,{mixins:DO(G.breakpoints,u),palette:B,shadows:UO.slice(),typography:FO(B,i),transitions:qO(T),zIndex:{...WO}});return J=ks(J,F),J=r.reduce((te,H)=>ks(te,H),J),J.unstable_sxConfig={...iy,...F==null?void 0:F.unstable_sxConfig},J.unstable_sx=function(H){return kf({sx:H,theme:this})},J.toRuntimeSource=GA,J}function R1(n){let r;return n<1?r=5.11916*n**2:r=4.5*Math.log(n+1)+2,Math.round(r*10)/1e3}const ZO=[...Array(25)].map((n,r)=>{if(r===0)return"none";const s=R1(r);return`linear-gradient(rgba(255 255 255 / ${s}), rgba(255 255 255 / ${s}))`});function qA(n){return{inputPlaceholder:n==="dark"?.5:.42,inputUnderline:n==="dark"?.7:.42,switchTrackDisabled:n==="dark"?.2:.12,switchTrack:n==="dark"?.3:.38}}function WA(n){return n==="dark"?ZO:[]}function XO(n){const{palette:r={mode:"light"},opacity:s,overlays:u,...m}=n,y=Ew(r);return{palette:y,opacity:{...qA(y.mode),...s},overlays:u||WA(y.mode),...m}}function YO(n){var r;return!!n[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!n[0].match(/sxConfig$/)||n[0]==="palette"&&!!((r=n[1])!=null&&r.match(/(mode|contrastThreshold|tonalOffset)/))}const KO=n=>[...[...Array(25)].map((r,s)=>`--${n?`${n}-`:""}overlays-${s}`),`--${n?`${n}-`:""}palette-AppBar-darkBg`,`--${n?`${n}-`:""}palette-AppBar-darkColor`],JO=n=>(r,s)=>{const u=n.rootSelector||":root",m=n.colorSchemeSelector;let y=m;if(m==="class"&&(y=".%s"),m==="data"&&(y="[data-%s]"),m!=null&&m.startsWith("data-")&&!m.includes("%s")&&(y=`[${m}="%s"]`),n.defaultColorScheme===r){if(r==="dark"){const T={};return KO(n.cssVarPrefix).forEach(i=>{T[i]=s[i],delete s[i]}),y==="media"?{[u]:s,"@media (prefers-color-scheme: dark)":{[u]:T}}:y?{[y.replace("%s",r)]:T,[`${u}, ${y.replace("%s",r)}`]:s}:{[u]:{...s,...T}}}if(y&&y!=="media")return`${u}, ${y.replace("%s",String(r))}`}else if(r){if(y==="media")return{[`@media (prefers-color-scheme: ${String(r)})`]:{[u]:s}};if(y)return y.replace("%s",String(r))}return u};function QO(n,r){r.forEach(s=>{n[s]||(n[s]={})})}function rn(n,r,s){!n[r]&&s&&(n[r]=s)}function C_(n){return typeof n!="string"||!n.startsWith("hsl")?n:LA(n)}function th(n,r){`${r}Channel`in n||(n[`${r}Channel`]=E_(C_(n[r])))}function e4(n){return typeof n=="number"?`${n}px`:typeof n=="string"||typeof n=="function"||Array.isArray(n)?n:"8px"}const ed=n=>{try{return n()}catch{}},t4=(n="mui")=>uO(n);function ub(n,r,s,u){if(!r)return;r=r===!0?{}:r;const m=u==="dark"?"dark":"light";if(!s){n[u]=XO({...r,palette:{mode:m,...r==null?void 0:r.palette}});return}const{palette:y,...T}=P1({...s,palette:{mode:m,...r==null?void 0:r.palette}});return n[u]={...r,palette:y,opacity:{...qA(m),...r==null?void 0:r.opacity},overlays:(r==null?void 0:r.overlays)||WA(m)},T}function n4(n={},...r){const{colorSchemes:s={light:!0},defaultColorScheme:u,disableCssColorScheme:m=!1,cssVarPrefix:y="mui",shouldSkipGeneratingVar:T=YO,colorSchemeSelector:i=s.light&&s.dark?"media":void 0,rootSelector:I=":root",...F}=n,B=Object.keys(s)[0],G=u||(s.light&&B!=="light"?"light":B),J=t4(y),{[G]:te,light:H,dark:j,...ne}=s,oe={...ne};let pe=te;if((G==="dark"&&!("dark"in s)||G==="light"&&!("light"in s))&&(pe=!0),!pe)throw new Error(oh(21,G));const se=ub(oe,pe,F,G);H&&!oe.light&&ub(oe,H,void 0,"light"),j&&!oe.dark&&ub(oe,j,void 0,"dark");let ie={defaultColorScheme:G,...se,cssVarPrefix:y,colorSchemeSelector:i,rootSelector:I,getCssVar:J,colorSchemes:oe,font:{...zO(se.typography),...se.font},spacing:e4(F.spacing)};Object.keys(ie.colorSchemes).forEach(Ze=>{const ae=ie.colorSchemes[Ze].palette,ke=ct=>{const Xe=ct.split("-"),st=Xe[1],et=Xe[2];return J(ct,ae[st][et])};if(ae.mode==="light"&&(rn(ae.common,"background","#fff"),rn(ae.common,"onBackground","#000")),ae.mode==="dark"&&(rn(ae.common,"background","#000"),rn(ae.common,"onBackground","#fff")),QO(ae,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),ae.mode==="light"){rn(ae.Alert,"errorColor",eo(ae.error.light,.6)),rn(ae.Alert,"infoColor",eo(ae.info.light,.6)),rn(ae.Alert,"successColor",eo(ae.success.light,.6)),rn(ae.Alert,"warningColor",eo(ae.warning.light,.6)),rn(ae.Alert,"errorFilledBg",ke("palette-error-main")),rn(ae.Alert,"infoFilledBg",ke("palette-info-main")),rn(ae.Alert,"successFilledBg",ke("palette-success-main")),rn(ae.Alert,"warningFilledBg",ke("palette-warning-main")),rn(ae.Alert,"errorFilledColor",ed(()=>ae.getContrastText(ae.error.main))),rn(ae.Alert,"infoFilledColor",ed(()=>ae.getContrastText(ae.info.main))),rn(ae.Alert,"successFilledColor",ed(()=>ae.getContrastText(ae.success.main))),rn(ae.Alert,"warningFilledColor",ed(()=>ae.getContrastText(ae.warning.main))),rn(ae.Alert,"errorStandardBg",to(ae.error.light,.9)),rn(ae.Alert,"infoStandardBg",to(ae.info.light,.9)),rn(ae.Alert,"successStandardBg",to(ae.success.light,.9)),rn(ae.Alert,"warningStandardBg",to(ae.warning.light,.9)),rn(ae.Alert,"errorIconColor",ke("palette-error-main")),rn(ae.Alert,"infoIconColor",ke("palette-info-main")),rn(ae.Alert,"successIconColor",ke("palette-success-main")),rn(ae.Alert,"warningIconColor",ke("palette-warning-main")),rn(ae.AppBar,"defaultBg",ke("palette-grey-100")),rn(ae.Avatar,"defaultBg",ke("palette-grey-400")),rn(ae.Button,"inheritContainedBg",ke("palette-grey-300")),rn(ae.Button,"inheritContainedHoverBg",ke("palette-grey-A100")),rn(ae.Chip,"defaultBorder",ke("palette-grey-400")),rn(ae.Chip,"defaultAvatarColor",ke("palette-grey-700")),rn(ae.Chip,"defaultIconColor",ke("palette-grey-700")),rn(ae.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),rn(ae.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),rn(ae.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),rn(ae.LinearProgress,"primaryBg",to(ae.primary.main,.62)),rn(ae.LinearProgress,"secondaryBg",to(ae.secondary.main,.62)),rn(ae.LinearProgress,"errorBg",to(ae.error.main,.62)),rn(ae.LinearProgress,"infoBg",to(ae.info.main,.62)),rn(ae.LinearProgress,"successBg",to(ae.success.main,.62)),rn(ae.LinearProgress,"warningBg",to(ae.warning.main,.62)),rn(ae.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.11)`),rn(ae.Slider,"primaryTrack",to(ae.primary.main,.62)),rn(ae.Slider,"secondaryTrack",to(ae.secondary.main,.62)),rn(ae.Slider,"errorTrack",to(ae.error.main,.62)),rn(ae.Slider,"infoTrack",to(ae.info.main,.62)),rn(ae.Slider,"successTrack",to(ae.success.main,.62)),rn(ae.Slider,"warningTrack",to(ae.warning.main,.62));const ct=sv(ae.background.default,.8);rn(ae.SnackbarContent,"bg",ct),rn(ae.SnackbarContent,"color",ed(()=>ae.getContrastText(ct))),rn(ae.SpeedDialAction,"fabHoverBg",sv(ae.background.paper,.15)),rn(ae.StepConnector,"border",ke("palette-grey-400")),rn(ae.StepContent,"border",ke("palette-grey-400")),rn(ae.Switch,"defaultColor",ke("palette-common-white")),rn(ae.Switch,"defaultDisabledColor",ke("palette-grey-100")),rn(ae.Switch,"primaryDisabledColor",to(ae.primary.main,.62)),rn(ae.Switch,"secondaryDisabledColor",to(ae.secondary.main,.62)),rn(ae.Switch,"errorDisabledColor",to(ae.error.main,.62)),rn(ae.Switch,"infoDisabledColor",to(ae.info.main,.62)),rn(ae.Switch,"successDisabledColor",to(ae.success.main,.62)),rn(ae.Switch,"warningDisabledColor",to(ae.warning.main,.62)),rn(ae.TableCell,"border",to(ov(ae.divider,1),.88)),rn(ae.Tooltip,"bg",ov(ae.grey[700],.92))}if(ae.mode==="dark"){rn(ae.Alert,"errorColor",to(ae.error.light,.6)),rn(ae.Alert,"infoColor",to(ae.info.light,.6)),rn(ae.Alert,"successColor",to(ae.success.light,.6)),rn(ae.Alert,"warningColor",to(ae.warning.light,.6)),rn(ae.Alert,"errorFilledBg",ke("palette-error-dark")),rn(ae.Alert,"infoFilledBg",ke("palette-info-dark")),rn(ae.Alert,"successFilledBg",ke("palette-success-dark")),rn(ae.Alert,"warningFilledBg",ke("palette-warning-dark")),rn(ae.Alert,"errorFilledColor",ed(()=>ae.getContrastText(ae.error.dark))),rn(ae.Alert,"infoFilledColor",ed(()=>ae.getContrastText(ae.info.dark))),rn(ae.Alert,"successFilledColor",ed(()=>ae.getContrastText(ae.success.dark))),rn(ae.Alert,"warningFilledColor",ed(()=>ae.getContrastText(ae.warning.dark))),rn(ae.Alert,"errorStandardBg",eo(ae.error.light,.9)),rn(ae.Alert,"infoStandardBg",eo(ae.info.light,.9)),rn(ae.Alert,"successStandardBg",eo(ae.success.light,.9)),rn(ae.Alert,"warningStandardBg",eo(ae.warning.light,.9)),rn(ae.Alert,"errorIconColor",ke("palette-error-main")),rn(ae.Alert,"infoIconColor",ke("palette-info-main")),rn(ae.Alert,"successIconColor",ke("palette-success-main")),rn(ae.Alert,"warningIconColor",ke("palette-warning-main")),rn(ae.AppBar,"defaultBg",ke("palette-grey-900")),rn(ae.AppBar,"darkBg",ke("palette-background-paper")),rn(ae.AppBar,"darkColor",ke("palette-text-primary")),rn(ae.Avatar,"defaultBg",ke("palette-grey-600")),rn(ae.Button,"inheritContainedBg",ke("palette-grey-800")),rn(ae.Button,"inheritContainedHoverBg",ke("palette-grey-700")),rn(ae.Chip,"defaultBorder",ke("palette-grey-700")),rn(ae.Chip,"defaultAvatarColor",ke("palette-grey-300")),rn(ae.Chip,"defaultIconColor",ke("palette-grey-300")),rn(ae.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),rn(ae.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),rn(ae.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),rn(ae.LinearProgress,"primaryBg",eo(ae.primary.main,.5)),rn(ae.LinearProgress,"secondaryBg",eo(ae.secondary.main,.5)),rn(ae.LinearProgress,"errorBg",eo(ae.error.main,.5)),rn(ae.LinearProgress,"infoBg",eo(ae.info.main,.5)),rn(ae.LinearProgress,"successBg",eo(ae.success.main,.5)),rn(ae.LinearProgress,"warningBg",eo(ae.warning.main,.5)),rn(ae.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.13)`),rn(ae.Slider,"primaryTrack",eo(ae.primary.main,.5)),rn(ae.Slider,"secondaryTrack",eo(ae.secondary.main,.5)),rn(ae.Slider,"errorTrack",eo(ae.error.main,.5)),rn(ae.Slider,"infoTrack",eo(ae.info.main,.5)),rn(ae.Slider,"successTrack",eo(ae.success.main,.5)),rn(ae.Slider,"warningTrack",eo(ae.warning.main,.5));const ct=sv(ae.background.default,.98);rn(ae.SnackbarContent,"bg",ct),rn(ae.SnackbarContent,"color",ed(()=>ae.getContrastText(ct))),rn(ae.SpeedDialAction,"fabHoverBg",sv(ae.background.paper,.15)),rn(ae.StepConnector,"border",ke("palette-grey-600")),rn(ae.StepContent,"border",ke("palette-grey-600")),rn(ae.Switch,"defaultColor",ke("palette-grey-300")),rn(ae.Switch,"defaultDisabledColor",ke("palette-grey-600")),rn(ae.Switch,"primaryDisabledColor",eo(ae.primary.main,.55)),rn(ae.Switch,"secondaryDisabledColor",eo(ae.secondary.main,.55)),rn(ae.Switch,"errorDisabledColor",eo(ae.error.main,.55)),rn(ae.Switch,"infoDisabledColor",eo(ae.info.main,.55)),rn(ae.Switch,"successDisabledColor",eo(ae.success.main,.55)),rn(ae.Switch,"warningDisabledColor",eo(ae.warning.main,.55)),rn(ae.TableCell,"border",eo(ov(ae.divider,1),.68)),rn(ae.Tooltip,"bg",ov(ae.grey[700],.92))}th(ae.background,"default"),th(ae.background,"paper"),th(ae.common,"background"),th(ae.common,"onBackground"),th(ae,"divider"),Object.keys(ae).forEach(ct=>{const Xe=ae[ct];ct!=="tonalOffset"&&Xe&&typeof Xe=="object"&&(Xe.main&&rn(ae[ct],"mainChannel",E_(C_(Xe.main))),Xe.light&&rn(ae[ct],"lightChannel",E_(C_(Xe.light))),Xe.dark&&rn(ae[ct],"darkChannel",E_(C_(Xe.dark))),Xe.contrastText&&rn(ae[ct],"contrastTextChannel",E_(C_(Xe.contrastText))),ct==="text"&&(th(ae[ct],"primary"),th(ae[ct],"secondary")),ct==="action"&&(Xe.active&&th(ae[ct],"active"),Xe.selected&&th(ae[ct],"selected")))})}),ie=r.reduce((Ze,ae)=>ks(Ze,ae),ie);const ce={prefix:y,disableCssColorScheme:m,shouldSkipGeneratingVar:T,getSelector:JO(ie)},{vars:we,generateThemeVars:xe,generateStyleSheets:$e}=pO(ie,ce);return ie.vars=we,Object.entries(ie.colorSchemes[ie.defaultColorScheme]).forEach(([Ze,ae])=>{ie[Ze]=ae}),ie.generateThemeVars=xe,ie.generateStyleSheets=$e,ie.generateSpacing=function(){return EA(F.spacing,fx(this))},ie.getColorSchemeSelector=fO(i),ie.spacing=ie.generateSpacing(),ie.shouldSkipGeneratingVar=T,ie.unstable_sxConfig={...iy,...F==null?void 0:F.unstable_sxConfig},ie.unstable_sx=function(ae){return kf({sx:ae,theme:this})},ie.toRuntimeSource=GA,ie}function iC(n,r,s){n.colorSchemes&&s&&(n.colorSchemes[r]={...s!==!0&&s,palette:Ew({...s===!0?{}:s.palette,mode:r})})}function HA(n={},...r){const{palette:s,cssVariables:u=!1,colorSchemes:m=s?void 0:{light:!0},defaultColorScheme:y=s==null?void 0:s.mode,...T}=n,i=y||"light",I=m==null?void 0:m[i],F={...m,...s?{[i]:{...typeof I!="boolean"&&I,palette:s}}:void 0};if(u===!1){if(!("colorSchemes"in n))return P1(n,...r);let B=s;"palette"in n||F[i]&&(F[i]!==!0?B=F[i].palette:i==="dark"&&(B={mode:"dark"}));const G=P1({...n,palette:B},...r);return G.defaultColorScheme=i,G.colorSchemes=F,G.palette.mode==="light"&&(G.colorSchemes.light={...F.light!==!0&&F.light,palette:G.palette},iC(G,"dark",F.dark)),G.palette.mode==="dark"&&(G.colorSchemes.dark={...F.dark!==!0&&F.dark,palette:G.palette},iC(G,"light",F.light)),G}return!s&&!("light"in F)&&i==="light"&&(F.light=!0),n4({...T,colorSchemes:F,defaultColorScheme:i,...typeof u!="boolean"&&u},...r)}const Cw=HA();function Mp(){const n=xx(Cw);return n[ax]||n}function sy(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const ta=n=>sy(n)&&n!=="classes",Jt=PA({themeId:ax,defaultTheme:Cw,rootShouldForwardProp:ta});function r4(n){return _e.jsx(BD,{...n,defaultTheme:Cw,themeId:ax})}function i4(n){return function(s){return _e.jsx(r4,{styles:typeof n=="function"?u=>n({theme:u,...s}):n})}}function o4(){return ww}const rr=cO;function gr(n){return lO(n)}function s4(n){return sr("MuiSvgIcon",n)}ar("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const a4=n=>{const{color:r,fontSize:s,classes:u}=n,m={root:["root",r!=="inherit"&&`color${Yt(r)}`,`fontSize${Yt(s)}`]};return lr(m,s4,u)},l4=Jt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.color!=="inherit"&&r[`color${Yt(s.color)}`],r[`fontSize${Yt(s.fontSize)}`]]}})(rr(({theme:n})=>{var r,s,u,m,y,T,i,I,F,B,G,J,te,H;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(m=(r=n.transitions)==null?void 0:r.create)==null?void 0:m.call(r,"fill",{duration:(u=(s=(n.vars??n).transitions)==null?void 0:s.duration)==null?void 0:u.shorter}),variants:[{props:j=>!j.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((T=(y=n.typography)==null?void 0:y.pxToRem)==null?void 0:T.call(y,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((I=(i=n.typography)==null?void 0:i.pxToRem)==null?void 0:I.call(i,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((B=(F=n.typography)==null?void 0:F.pxToRem)==null?void 0:B.call(F,35))||"2.1875rem"}},...Object.entries((n.vars??n).palette).filter(([,j])=>j&&j.main).map(([j])=>{var ne,oe;return{props:{color:j},style:{color:(oe=(ne=(n.vars??n).palette)==null?void 0:ne[j])==null?void 0:oe.main}}}),{props:{color:"action"},style:{color:(J=(G=(n.vars??n).palette)==null?void 0:G.action)==null?void 0:J.active}},{props:{color:"disabled"},style:{color:(H=(te=(n.vars??n).palette)==null?void 0:te.action)==null?void 0:H.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),qv=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiSvgIcon"}),{children:m,className:y,color:T="inherit",component:i="svg",fontSize:I="medium",htmlColor:F,inheritViewBox:B=!1,titleAccess:G,viewBox:J="0 0 24 24",...te}=u,H=fe.isValidElement(m)&&m.type==="svg",j={...u,color:T,component:i,fontSize:I,instanceFontSize:r.fontSize,inheritViewBox:B,viewBox:J,hasSvgAsChild:H},ne={};B||(ne.viewBox=J);const oe=a4(j);return _e.jsxs(l4,{as:i,className:Sn(oe.root,y),focusable:"false",color:F,"aria-hidden":G?void 0:!0,role:G?"img":void 0,ref:s,...ne,...te,...H&&m.props,ownerState:j,children:[H?m.props.children:m,G?_e.jsx("title",{children:G}):null]})});qv.muiName="SvgIcon";function Ti(n,r){function s(u,m){return _e.jsx(qv,{"data-testid":`${r}Icon`,ref:m,...u,children:n})}return s.muiName=qv.muiName,fe.memo(fe.forwardRef(s))}function ZA(n,r){if(n==null)return{};var s={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(r.indexOf(u)!==-1)continue;s[u]=n[u]}return s}function k1(n,r){return k1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,u){return s.__proto__=u,s},k1(n,r)}function XA(n,r){n.prototype=Object.create(r.prototype),n.prototype.constructor=n,k1(n,r)}var Sx=oA();const av=Uf(Sx),oC={disabled:!1},Wv=Vi.createContext(null);var c4=function(r){return r.scrollTop},M_="unmounted",xf="exited",bf="entering",Hm="entered",L1="exiting",vu=function(n){XA(r,n);function r(u,m){var y;y=n.call(this,u,m)||this;var T=m,i=T&&!T.isMounting?u.enter:u.appear,I;return y.appearStatus=null,u.in?i?(I=xf,y.appearStatus=bf):I=Hm:u.unmountOnExit||u.mountOnEnter?I=M_:I=xf,y.state={status:I},y.nextCallback=null,y}r.getDerivedStateFromProps=function(m,y){var T=m.in;return T&&y.status===M_?{status:xf}:null};var s=r.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(m){var y=null;if(m!==this.props){var T=this.state.status;this.props.in?T!==bf&&T!==Hm&&(y=bf):(T===bf||T===Hm)&&(y=L1)}this.updateStatus(!1,y)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var m=this.props.timeout,y,T,i;return y=T=i=m,m!=null&&typeof m!="number"&&(y=m.exit,T=m.enter,i=m.appear!==void 0?m.appear:T),{exit:y,enter:T,appear:i}},s.updateStatus=function(m,y){if(m===void 0&&(m=!1),y!==null)if(this.cancelNextCallback(),y===bf){if(this.props.unmountOnExit||this.props.mountOnEnter){var T=this.props.nodeRef?this.props.nodeRef.current:av.findDOMNode(this);T&&c4(T)}this.performEnter(m)}else this.performExit();else this.props.unmountOnExit&&this.state.status===xf&&this.setState({status:M_})},s.performEnter=function(m){var y=this,T=this.props.enter,i=this.context?this.context.isMounting:m,I=this.props.nodeRef?[i]:[av.findDOMNode(this),i],F=I[0],B=I[1],G=this.getTimeouts(),J=i?G.appear:G.enter;if(!m&&!T||oC.disabled){this.safeSetState({status:Hm},function(){y.props.onEntered(F)});return}this.props.onEnter(F,B),this.safeSetState({status:bf},function(){y.props.onEntering(F,B),y.onTransitionEnd(J,function(){y.safeSetState({status:Hm},function(){y.props.onEntered(F,B)})})})},s.performExit=function(){var m=this,y=this.props.exit,T=this.getTimeouts(),i=this.props.nodeRef?void 0:av.findDOMNode(this);if(!y||oC.disabled){this.safeSetState({status:xf},function(){m.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:L1},function(){m.props.onExiting(i),m.onTransitionEnd(T.exit,function(){m.safeSetState({status:xf},function(){m.props.onExited(i)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(m,y){y=this.setNextCallback(y),this.setState(m,y)},s.setNextCallback=function(m){var y=this,T=!0;return this.nextCallback=function(i){T&&(T=!1,y.nextCallback=null,m(i))},this.nextCallback.cancel=function(){T=!1},this.nextCallback},s.onTransitionEnd=function(m,y){this.setNextCallback(y);var T=this.props.nodeRef?this.props.nodeRef.current:av.findDOMNode(this),i=m==null&&!this.props.addEndListener;if(!T||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var I=this.props.nodeRef?[this.nextCallback]:[T,this.nextCallback],F=I[0],B=I[1];this.props.addEndListener(F,B)}m!=null&&setTimeout(this.nextCallback,m)},s.render=function(){var m=this.state.status;if(m===M_)return null;var y=this.props,T=y.children;y.in,y.mountOnEnter,y.unmountOnExit,y.appear,y.enter,y.exit,y.timeout,y.addEndListener,y.onEnter,y.onEntering,y.onEntered,y.onExit,y.onExiting,y.onExited,y.nodeRef;var i=ZA(y,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Vi.createElement(Wv.Provider,{value:null},typeof T=="function"?T(m,i):Vi.cloneElement(Vi.Children.only(T),i))},r}(Vi.Component);vu.contextType=Wv;vu.propTypes={};function $m(){}vu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:$m,onEntering:$m,onEntered:$m,onExit:$m,onExiting:$m,onExited:$m};vu.UNMOUNTED=M_;vu.EXITED=xf;vu.ENTERING=bf;vu.ENTERED=Hm;vu.EXITING=L1;function u4(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Mw(n,r){var s=function(y){return r&&fe.isValidElement(y)?r(y):y},u=Object.create(null);return n&&fe.Children.map(n,function(m){return m}).forEach(function(m){u[m.key]=s(m)}),u}function d4(n,r){n=n||{},r=r||{};function s(B){return B in r?r[B]:n[B]}var u=Object.create(null),m=[];for(var y in n)y in r?m.length&&(u[y]=m,m=[]):m.push(y);var T,i={};for(var I in r){if(u[I])for(T=0;T<u[I].length;T++){var F=u[I][T];i[u[I][T]]=s(F)}i[I]=s(I)}for(T=0;T<m.length;T++)i[m[T]]=s(m[T]);return i}function Mf(n,r,s){return s[r]!=null?s[r]:n.props[r]}function h4(n,r){return Mw(n.children,function(s){return fe.cloneElement(s,{onExited:r.bind(null,s),in:!0,appear:Mf(s,"appear",n),enter:Mf(s,"enter",n),exit:Mf(s,"exit",n)})})}function p4(n,r,s){var u=Mw(n.children),m=d4(r,u);return Object.keys(m).forEach(function(y){var T=m[y];if(fe.isValidElement(T)){var i=y in r,I=y in u,F=r[y],B=fe.isValidElement(F)&&!F.props.in;I&&(!i||B)?m[y]=fe.cloneElement(T,{onExited:s.bind(null,T),in:!0,exit:Mf(T,"exit",n),enter:Mf(T,"enter",n)}):!I&&i&&!B?m[y]=fe.cloneElement(T,{in:!1}):I&&i&&fe.isValidElement(F)&&(m[y]=fe.cloneElement(T,{onExited:s.bind(null,T),in:F.props.in,exit:Mf(T,"exit",n),enter:Mf(T,"enter",n)}))}}),m}var f4=Object.values||function(n){return Object.keys(n).map(function(r){return n[r]})},m4={component:"div",childFactory:function(r){return r}},Iw=function(n){XA(r,n);function r(u,m){var y;y=n.call(this,u,m)||this;var T=y.handleExited.bind(u4(y));return y.state={contextValue:{isMounting:!0},handleExited:T,firstRender:!0},y}var s=r.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(m,y){var T=y.children,i=y.handleExited,I=y.firstRender;return{children:I?h4(m,i):p4(m,T,i),firstRender:!1}},s.handleExited=function(m,y){var T=Mw(this.props.children);m.key in T||(m.props.onExited&&m.props.onExited(y),this.mounted&&this.setState(function(i){var I=$v({},i.children);return delete I[m.key],{children:I}}))},s.render=function(){var m=this.props,y=m.component,T=m.childFactory,i=ZA(m,["component","childFactory"]),I=this.state.contextValue,F=f4(this.state.children).map(T);return delete i.appear,delete i.enter,delete i.exit,y===null?Vi.createElement(Wv.Provider,{value:I},F):Vi.createElement(Wv.Provider,{value:I},Vi.createElement(y,i,F))},r}(Vi.Component);Iw.propTypes={};Iw.defaultProps=m4;const Aw=n=>n.scrollTop;function Qm(n,r){const{timeout:s,easing:u,style:m={}}=n;return{duration:m.transitionDuration??(typeof s=="number"?s:s[r.mode]||0),easing:m.transitionTimingFunction??(typeof u=="object"?u[r.mode]:u),delay:m.transitionDelay}}function g4(n){return sr("MuiPaper",n)}ar("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const _4=n=>{const{square:r,elevation:s,variant:u,classes:m}=n,y={root:["root",u,!r&&"rounded",u==="elevation"&&`elevation${s}`]};return lr(y,g4,m)},y4=Jt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.variant],!s.square&&r.rounded,s.variant==="elevation"&&r[`elevation${s.elevation}`]]}})(rr(({theme:n})=>({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow"),variants:[{props:({ownerState:r})=>!r.square,style:{borderRadius:n.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(n.vars||n).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),xu=fe.forwardRef(function(r,s){var te;const u=gr({props:r,name:"MuiPaper"}),m=Mp(),{className:y,component:T="div",elevation:i=1,square:I=!1,variant:F="elevation",...B}=u,G={...u,component:T,elevation:i,square:I,variant:F},J=_4(G);return _e.jsx(y4,{as:T,ownerState:G,className:Sn(J.root,y),ref:s,...B,style:{...F==="elevation"&&{"--Paper-shadow":(m.vars||m).shadows[i],...m.vars&&{"--Paper-overlay":(te=m.vars.overlays)==null?void 0:te[i]},...!m.vars&&m.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Oi("#fff",R1(i))}, ${Oi("#fff",R1(i))})`}},...B.style}})});function Gi(n,r){const{className:s,elementType:u,ownerState:m,externalForwardedProps:y,internalForwardedProps:T,shouldForwardComponentProp:i=!1,...I}=r,{component:F,slots:B={[n]:void 0},slotProps:G={[n]:void 0},...J}=y,te=B[n]||u,H=UA(G[n],m),{props:{component:j,...ne},internalRef:oe}=jA({className:s,...I,externalForwardedProps:n==="root"?J:void 0,externalSlotProps:H}),pe=ao(oe,H==null?void 0:H.ref,r.ref),se=n==="root"?j||F:j,ie=NA(te,{...n==="root"&&!F&&!B[n]&&T,...n!=="root"&&!B[n]&&T,...ne,...se&&!i&&{as:se},...se&&i&&{component:se},ref:pe},m);return[te,ie]}class Hv{constructor(){t_(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new Hv}static use(){const r=DA(Hv.create).current,[s,u]=fe.useState(!1);return r.shouldMount=s,r.setShouldMount=u,fe.useEffect(r.mountEffect,[s]),r}mount(){return this.mounted||(this.mounted=x4(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...r){this.mount().then(()=>{var s;return(s=this.ref.current)==null?void 0:s.start(...r)})}stop(...r){this.mount().then(()=>{var s;return(s=this.ref.current)==null?void 0:s.stop(...r)})}pulsate(...r){this.mount().then(()=>{var s;return(s=this.ref.current)==null?void 0:s.pulsate(...r)})}}function v4(){return Hv.use()}function x4(){let n,r;const s=new Promise((u,m)=>{n=u,r=m});return s.resolve=n,s.reject=r,s}function b4(n){const{className:r,classes:s,pulsate:u=!1,rippleX:m,rippleY:y,rippleSize:T,in:i,onExited:I,timeout:F}=n,[B,G]=fe.useState(!1),J=Sn(r,s.ripple,s.rippleVisible,u&&s.ripplePulsate),te={width:T,height:T,top:-(T/2)+y,left:-(T/2)+m},H=Sn(s.child,B&&s.childLeaving,u&&s.childPulsate);return!i&&!B&&G(!0),fe.useEffect(()=>{if(!i&&I!=null){const j=setTimeout(I,F);return()=>{clearTimeout(j)}}},[I,i,F]),_e.jsx("span",{className:J,style:te,children:_e.jsx("span",{className:H})})}const vc=ar("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),z1=550,w4=80,S4=ny`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,T4=ny`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,E4=ny`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,C4=Jt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),M4=Jt(b4,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${vc.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${S4};
    animation-duration: ${z1}ms;
    animation-timing-function: ${({theme:n})=>n.transitions.easing.easeInOut};
  }

  &.${vc.ripplePulsate} {
    animation-duration: ${({theme:n})=>n.transitions.duration.shorter}ms;
  }

  & .${vc.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${vc.childLeaving} {
    opacity: 0;
    animation-name: ${T4};
    animation-duration: ${z1}ms;
    animation-timing-function: ${({theme:n})=>n.transitions.easing.easeInOut};
  }

  & .${vc.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${E4};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:n})=>n.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,I4=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiTouchRipple"}),{center:m=!1,classes:y={},className:T,...i}=u,[I,F]=fe.useState([]),B=fe.useRef(0),G=fe.useRef(null);fe.useEffect(()=>{G.current&&(G.current(),G.current=null)},[I]);const J=fe.useRef(!1),te=Cf(),H=fe.useRef(null),j=fe.useRef(null),ne=fe.useCallback(ie=>{const{pulsate:ce,rippleX:we,rippleY:xe,rippleSize:$e,cb:Ze}=ie;F(ae=>[...ae,_e.jsx(M4,{classes:{ripple:Sn(y.ripple,vc.ripple),rippleVisible:Sn(y.rippleVisible,vc.rippleVisible),ripplePulsate:Sn(y.ripplePulsate,vc.ripplePulsate),child:Sn(y.child,vc.child),childLeaving:Sn(y.childLeaving,vc.childLeaving),childPulsate:Sn(y.childPulsate,vc.childPulsate)},timeout:z1,pulsate:ce,rippleX:we,rippleY:xe,rippleSize:$e},B.current)]),B.current+=1,G.current=Ze},[y]),oe=fe.useCallback((ie={},ce={},we=()=>{})=>{const{pulsate:xe=!1,center:$e=m||ce.pulsate,fakeElement:Ze=!1}=ce;if((ie==null?void 0:ie.type)==="mousedown"&&J.current){J.current=!1;return}(ie==null?void 0:ie.type)==="touchstart"&&(J.current=!0);const ae=Ze?null:j.current,ke=ae?ae.getBoundingClientRect():{width:0,height:0,left:0,top:0};let ct,Xe,st;if($e||ie===void 0||ie.clientX===0&&ie.clientY===0||!ie.clientX&&!ie.touches)ct=Math.round(ke.width/2),Xe=Math.round(ke.height/2);else{const{clientX:et,clientY:gt}=ie.touches&&ie.touches.length>0?ie.touches[0]:ie;ct=Math.round(et-ke.left),Xe=Math.round(gt-ke.top)}if($e)st=Math.sqrt((2*ke.width**2+ke.height**2)/3),st%2===0&&(st+=1);else{const et=Math.max(Math.abs((ae?ae.clientWidth:0)-ct),ct)*2+2,gt=Math.max(Math.abs((ae?ae.clientHeight:0)-Xe),Xe)*2+2;st=Math.sqrt(et**2+gt**2)}ie!=null&&ie.touches?H.current===null&&(H.current=()=>{ne({pulsate:xe,rippleX:ct,rippleY:Xe,rippleSize:st,cb:we})},te.start(w4,()=>{H.current&&(H.current(),H.current=null)})):ne({pulsate:xe,rippleX:ct,rippleY:Xe,rippleSize:st,cb:we})},[m,ne,te]),pe=fe.useCallback(()=>{oe({},{pulsate:!0})},[oe]),se=fe.useCallback((ie,ce)=>{if(te.clear(),(ie==null?void 0:ie.type)==="touchend"&&H.current){H.current(),H.current=null,te.start(0,()=>{se(ie,ce)});return}H.current=null,F(we=>we.length>0?we.slice(1):we),G.current=ce},[te]);return fe.useImperativeHandle(s,()=>({pulsate:pe,start:oe,stop:se}),[pe,oe,se]),_e.jsx(C4,{className:Sn(vc.root,y.root,T),ref:j,...i,children:_e.jsx(Iw,{component:null,exit:!0,children:I})})});function A4(n){return sr("MuiButtonBase",n)}const P4=ar("MuiButtonBase",["root","disabled","focusVisible"]),R4=n=>{const{disabled:r,focusVisible:s,focusVisibleClassName:u,classes:m}=n,T=lr({root:["root",r&&"disabled",s&&"focusVisible"]},A4,m);return s&&u&&(T.root+=` ${u}`),T},k4=Jt("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(n,r)=>r.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${P4.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Tp=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiButtonBase"}),{action:m,centerRipple:y=!1,children:T,className:i,component:I="button",disabled:F=!1,disableRipple:B=!1,disableTouchRipple:G=!1,focusRipple:J=!1,focusVisibleClassName:te,LinkComponent:H="a",onBlur:j,onClick:ne,onContextMenu:oe,onDragLeave:pe,onFocus:se,onFocusVisible:ie,onKeyDown:ce,onKeyUp:we,onMouseDown:xe,onMouseLeave:$e,onMouseUp:Ze,onTouchEnd:ae,onTouchMove:ke,onTouchStart:ct,tabIndex:Xe=0,TouchRippleProps:st,touchRippleRef:et,type:gt,...zt}=u,at=fe.useRef(null),Ye=v4(),Bt=ao(Ye.ref,et),[nt,Rt]=fe.useState(!1);F&&nt&&Rt(!1),fe.useImperativeHandle(m,()=>({focusVisible:()=>{Rt(!0),at.current.focus()}}),[]);const Nt=Ye.shouldMount&&!B&&!F;fe.useEffect(()=>{nt&&J&&!B&&Ye.pulsate()},[B,J,nt,Ye]);const gn=nh(Ye,"start",xe,G),Mt=nh(Ye,"stop",oe,G),$t=nh(Ye,"stop",pe,G),Ut=nh(Ye,"stop",Ze,G),hn=nh(Ye,"stop",On=>{nt&&On.preventDefault(),$e&&$e(On)},G),xn=nh(Ye,"start",ct,G),Le=nh(Ye,"stop",ae,G),Dn=nh(Ye,"stop",ke,G),pn=nh(Ye,"stop",On=>{Sp(On.target)||Rt(!1),j&&j(On)},!1),zn=il(On=>{at.current||(at.current=On.currentTarget),Sp(On.target)&&(Rt(!0),ie&&ie(On)),se&&se(On)}),_t=()=>{const On=at.current;return I&&I!=="button"&&!(On.tagName==="A"&&On.href)},er=il(On=>{J&&!On.repeat&&nt&&On.key===" "&&Ye.stop(On,()=>{Ye.start(On)}),On.target===On.currentTarget&&_t()&&On.key===" "&&On.preventDefault(),ce&&ce(On),On.target===On.currentTarget&&_t()&&On.key==="Enter"&&!F&&(On.preventDefault(),ne&&ne(On))}),pr=il(On=>{J&&On.key===" "&&nt&&!On.defaultPrevented&&Ye.stop(On,()=>{Ye.pulsate(On)}),we&&we(On),ne&&On.target===On.currentTarget&&_t()&&On.key===" "&&!On.defaultPrevented&&ne(On)});let qn=I;qn==="button"&&(zt.href||zt.to)&&(qn=H);const _n={};qn==="button"?(_n.type=gt===void 0?"button":gt,_n.disabled=F):(!zt.href&&!zt.to&&(_n.role="button"),F&&(_n["aria-disabled"]=F));const ir=ao(s,at),cr={...u,centerRipple:y,component:I,disabled:F,disableRipple:B,disableTouchRipple:G,focusRipple:J,tabIndex:Xe,focusVisible:nt},Er=R4(cr);return _e.jsxs(k4,{as:qn,className:Sn(Er.root,i),ownerState:cr,onBlur:pn,onClick:ne,onContextMenu:Mt,onFocus:zn,onKeyDown:er,onKeyUp:pr,onMouseDown:gn,onMouseLeave:hn,onMouseUp:Ut,onDragLeave:$t,onTouchEnd:Le,onTouchMove:Dn,onTouchStart:xn,ref:ir,tabIndex:F?-1:Xe,type:gt,..._n,...zt,children:[T,Nt?_e.jsx(I4,{ref:Bt,center:y,...st}):null]})});function nh(n,r,s,u=!1){return il(m=>(s&&s(m),u||n[r](m),!0))}function L4(n){return typeof n.main=="string"}function z4(n,r=[]){if(!L4(n))return!1;for(const s of r)if(!n.hasOwnProperty(s)||typeof n[s]!="string")return!1;return!0}function zo(n=[]){return([,r])=>r&&z4(r,n)}function D4(n){return sr("MuiAlert",n)}const sC=ar("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function O4(n){return sr("MuiCircularProgress",n)}ar("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const up=44,D1=ny`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,O1=ny`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,F4=typeof D1!="string"?yw`
        animation: ${D1} 1.4s linear infinite;
      `:null,B4=typeof O1!="string"?yw`
        animation: ${O1} 1.4s ease-in-out infinite;
      `:null,N4=n=>{const{classes:r,variant:s,color:u,disableShrink:m}=n,y={root:["root",s,`color${Yt(u)}`],svg:["svg"],circle:["circle",`circle${Yt(s)}`,m&&"circleDisableShrink"]};return lr(y,O4,r)},j4=Jt("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.variant],r[`color${Yt(s.color)}`]]}})(rr(({theme:n})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:n.transitions.create("transform")}},{props:{variant:"indeterminate"},style:F4||{animation:`${D1} 1.4s linear infinite`}},...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r},style:{color:(n.vars||n).palette[r].main}}))]}))),U4=Jt("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(n,r)=>r.svg})({display:"block"}),$4=Jt("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.circle,r[`circle${Yt(s.variant)}`],s.disableShrink&&r.circleDisableShrink]}})(rr(({theme:n})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:n.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:r})=>r.variant==="indeterminate"&&!r.disableShrink,style:B4||{animation:`${O1} 1.4s ease-in-out infinite`}}]}))),Tx=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiCircularProgress"}),{className:m,color:y="primary",disableShrink:T=!1,size:i=40,style:I,thickness:F=3.6,value:B=0,variant:G="indeterminate",...J}=u,te={...u,color:y,disableShrink:T,size:i,thickness:F,value:B,variant:G},H=N4(te),j={},ne={},oe={};if(G==="determinate"){const pe=2*Math.PI*((up-F)/2);j.strokeDasharray=pe.toFixed(3),oe["aria-valuenow"]=Math.round(B),j.strokeDashoffset=`${((100-B)/100*pe).toFixed(3)}px`,ne.transform="rotate(-90deg)"}return _e.jsx(j4,{className:Sn(H.root,m),style:{width:i,height:i,...ne,...I},ownerState:te,ref:s,role:"progressbar",...oe,...J,children:_e.jsx(U4,{className:H.svg,ownerState:te,viewBox:`${up/2} ${up/2} ${up} ${up}`,children:_e.jsx($4,{className:H.circle,style:j,ownerState:te,cx:up,cy:up,r:(up-F)/2,fill:"none",strokeWidth:F})})})});function V4(n){return sr("MuiIconButton",n)}const aC=ar("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),G4=n=>{const{classes:r,disabled:s,color:u,edge:m,size:y,loading:T}=n,i={root:["root",T&&"loading",s&&"disabled",u!=="default"&&`color${Yt(u)}`,m&&`edge${Yt(m)}`,`size${Yt(y)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return lr(i,V4,r)},q4=Jt(Tp,{name:"MuiIconButton",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.loading&&r.loading,s.color!=="default"&&r[`color${Yt(s.color)}`],s.edge&&r[`edge${Yt(s.edge)}`],r[`size${Yt(s.size)}`]]}})(rr(({theme:n})=>({textAlign:"center",flex:"0 0 auto",fontSize:n.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(n.vars||n).palette.action.active,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shortest}),variants:[{props:r=>!r.disableRipple,style:{"--IconButton-hoverBg":n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette.action.active,n.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),rr(({theme:n})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r},style:{color:(n.vars||n).palette[r].main}})),...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r},style:{"--IconButton-hoverBg":n.vars?`rgba(${(n.vars||n).palette[r].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi((n.vars||n).palette[r].main,n.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:n.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:n.typography.pxToRem(28)}}],[`&.${aC.disabled}`]:{backgroundColor:"transparent",color:(n.vars||n).palette.action.disabled},[`&.${aC.loading}`]:{color:"transparent"}}))),W4=Jt("span",{name:"MuiIconButton",slot:"LoadingIndicator",overridesResolver:(n,r)=>r.loadingIndicator})(({theme:n})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(n.vars||n).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),fu=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiIconButton"}),{edge:m=!1,children:y,className:T,color:i="default",disabled:I=!1,disableFocusRipple:F=!1,size:B="medium",id:G,loading:J=null,loadingIndicator:te,...H}=u,j=ah(G),ne=te??_e.jsx(Tx,{"aria-labelledby":j,color:"inherit",size:16}),oe={...u,edge:m,color:i,disabled:I,disableFocusRipple:F,loading:J,loadingIndicator:ne,size:B},pe=G4(oe);return _e.jsxs(q4,{id:j,className:Sn(pe.root,T),centerRipple:!0,focusRipple:!F,disabled:I||J,ref:s,...H,ownerState:oe,children:[typeof J=="boolean"&&_e.jsx("span",{className:pe.loadingWrapper,style:{display:"contents"},children:_e.jsx(W4,{className:pe.loadingIndicator,ownerState:oe,children:J&&ne})}),y]})}),H4=Ti(_e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Z4=Ti(_e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),X4=Ti(_e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Y4=Ti(_e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),K4=Ti(_e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),J4=n=>{const{variant:r,color:s,severity:u,classes:m}=n,y={root:["root",`color${Yt(s||u)}`,`${r}${Yt(s||u)}`,`${r}`],icon:["icon"],message:["message"],action:["action"]};return lr(y,D4,m)},Q4=Jt(xu,{name:"MuiAlert",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.variant],r[`${s.variant}${Yt(s.color||s.severity)}`]]}})(rr(({theme:n})=>{const r=n.palette.mode==="light"?Lf:zf,s=n.palette.mode==="light"?zf:Lf;return{...n.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(n.palette).filter(zo(["light"])).map(([u])=>({props:{colorSeverity:u,variant:"standard"},style:{color:n.vars?n.vars.palette.Alert[`${u}Color`]:r(n.palette[u].light,.6),backgroundColor:n.vars?n.vars.palette.Alert[`${u}StandardBg`]:s(n.palette[u].light,.9),[`& .${sC.icon}`]:n.vars?{color:n.vars.palette.Alert[`${u}IconColor`]}:{color:n.palette[u].main}}})),...Object.entries(n.palette).filter(zo(["light"])).map(([u])=>({props:{colorSeverity:u,variant:"outlined"},style:{color:n.vars?n.vars.palette.Alert[`${u}Color`]:r(n.palette[u].light,.6),border:`1px solid ${(n.vars||n).palette[u].light}`,[`& .${sC.icon}`]:n.vars?{color:n.vars.palette.Alert[`${u}IconColor`]}:{color:n.palette[u].main}}})),...Object.entries(n.palette).filter(zo(["dark"])).map(([u])=>({props:{colorSeverity:u,variant:"filled"},style:{fontWeight:n.typography.fontWeightMedium,...n.vars?{color:n.vars.palette.Alert[`${u}FilledColor`],backgroundColor:n.vars.palette.Alert[`${u}FilledBg`]}:{backgroundColor:n.palette.mode==="dark"?n.palette[u].dark:n.palette[u].main,color:n.palette.getContrastText(n.palette[u].main)}}}))]}})),eF=Jt("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(n,r)=>r.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),tF=Jt("div",{name:"MuiAlert",slot:"Message",overridesResolver:(n,r)=>r.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),nF=Jt("div",{name:"MuiAlert",slot:"Action",overridesResolver:(n,r)=>r.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),lC={success:_e.jsx(H4,{fontSize:"inherit"}),warning:_e.jsx(Z4,{fontSize:"inherit"}),error:_e.jsx(X4,{fontSize:"inherit"}),info:_e.jsx(Y4,{fontSize:"inherit"})},YA=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiAlert"}),{action:m,children:y,className:T,closeText:i="Close",color:I,components:F={},componentsProps:B={},icon:G,iconMapping:J=lC,onClose:te,role:H="alert",severity:j="success",slotProps:ne={},slots:oe={},variant:pe="standard",...se}=u,ie={...u,color:I,severity:j,variant:pe,colorSeverity:I||j},ce=J4(ie),we={slots:{closeButton:F.CloseButton,closeIcon:F.CloseIcon,...oe},slotProps:{...B,...ne}},[xe,$e]=Gi("root",{ref:s,shouldForwardComponentProp:!0,className:Sn(ce.root,T),elementType:Q4,externalForwardedProps:{...we,...se},ownerState:ie,additionalProps:{role:H,elevation:0}}),[Ze,ae]=Gi("icon",{className:ce.icon,elementType:eF,externalForwardedProps:we,ownerState:ie}),[ke,ct]=Gi("message",{className:ce.message,elementType:tF,externalForwardedProps:we,ownerState:ie}),[Xe,st]=Gi("action",{className:ce.action,elementType:nF,externalForwardedProps:we,ownerState:ie}),[et,gt]=Gi("closeButton",{elementType:fu,externalForwardedProps:we,ownerState:ie}),[zt,at]=Gi("closeIcon",{elementType:K4,externalForwardedProps:we,ownerState:ie});return _e.jsxs(xe,{...$e,children:[G!==!1?_e.jsx(Ze,{...ae,children:G||J[j]||lC[j]}):null,_e.jsx(ke,{...ct,children:y}),m!=null?_e.jsx(Xe,{...st,children:m}):null,m==null&&te?_e.jsx(Xe,{...st,children:_e.jsx(et,{size:"small","aria-label":i,title:i,color:"inherit",onClick:te,...gt,children:_e.jsx(zt,{fontSize:"small",...at})})}):null]})});function rF(n){return sr("MuiTypography",n)}ar("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const iF={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},oF=o4(),sF=n=>{const{align:r,gutterBottom:s,noWrap:u,paragraph:m,variant:y,classes:T}=n,i={root:["root",y,n.align!=="inherit"&&`align${Yt(r)}`,s&&"gutterBottom",u&&"noWrap",m&&"paragraph"]};return lr(i,rF,T)},aF=Jt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.variant&&r[s.variant],s.align!=="inherit"&&r[`align${Yt(s.align)}`],s.noWrap&&r.noWrap,s.gutterBottom&&r.gutterBottom,s.paragraph&&r.paragraph]}})(rr(({theme:n})=>{var r;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(n.typography).filter(([s,u])=>s!=="inherit"&&u&&typeof u=="object").map(([s,u])=>({props:{variant:s},style:u})),...Object.entries(n.palette).filter(zo()).map(([s])=>({props:{color:s},style:{color:(n.vars||n).palette[s].main}})),...Object.entries(((r=n.palette)==null?void 0:r.text)||{}).filter(([,s])=>typeof s=="string").map(([s])=>({props:{color:`text${Yt(s)}`},style:{color:(n.vars||n).palette.text[s]}})),{props:({ownerState:s})=>s.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:s})=>s.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:s})=>s.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:s})=>s.paragraph,style:{marginBottom:16}}]}})),cC={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},so=fe.forwardRef(function(r,s){const{color:u,...m}=gr({props:r,name:"MuiTypography"}),y=!iF[u],T=oF({...m,...y&&{color:u}}),{align:i="inherit",className:I,component:F,gutterBottom:B=!1,noWrap:G=!1,paragraph:J=!1,variant:te="body1",variantMapping:H=cC,...j}=T,ne={...T,align:i,color:u,className:I,component:F,gutterBottom:B,noWrap:G,paragraph:J,variant:te,variantMapping:H},oe=F||(J?"p":H[te]||cC[te])||"span",pe=sF(ne);return _e.jsx(aF,{as:oe,ref:s,className:Sn(pe.root,I),...j,ownerState:ne,style:{...i!=="inherit"&&{"--Typography-textAlign":i},...j.style}})});function lF(n){return sr("MuiAlertTitle",n)}ar("MuiAlertTitle",["root"]);const cF=n=>{const{classes:r}=n;return lr({root:["root"]},lF,r)},uF=Jt(so,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(n,r)=>r.root})(rr(({theme:n})=>({fontWeight:n.typography.fontWeightMedium,marginTop:-2}))),dF=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiAlertTitle"}),{className:m,...y}=u,T=u,i=cF(T);return _e.jsx(uF,{gutterBottom:!0,component:"div",ownerState:T,ref:s,className:Sn(i.root,m),...y})});function hF(n){return sr("MuiAppBar",n)}ar("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const pF=n=>{const{color:r,position:s,classes:u}=n,m={root:["root",`color${Yt(r)}`,`position${Yt(s)}`]};return lr(m,hF,u)},uC=(n,r)=>n?`${n==null?void 0:n.replace(")","")}, ${r})`:r,fF=Jt(xu,{name:"MuiAppBar",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`position${Yt(s.position)}`],r[`color${Yt(s.color)}`]]}})(rr(({theme:n})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(n.vars||n).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(n.vars||n).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(n.vars||n).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":n.vars?n.vars.palette.AppBar.defaultBg:n.palette.grey[100],"--AppBar-color":n.vars?n.vars.palette.text.primary:n.palette.getContrastText(n.palette.grey[100]),...n.applyStyles("dark",{"--AppBar-background":n.vars?n.vars.palette.AppBar.defaultBg:n.palette.grey[900],"--AppBar-color":n.vars?n.vars.palette.text.primary:n.palette.getContrastText(n.palette.grey[900])})}},...Object.entries(n.palette).filter(zo(["contrastText"])).map(([r])=>({props:{color:r},style:{"--AppBar-background":(n.vars??n).palette[r].main,"--AppBar-color":(n.vars??n).palette[r].contrastText}})),{props:r=>r.enableColorOnDark===!0&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:r=>r.enableColorOnDark===!1&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...n.applyStyles("dark",{backgroundColor:n.vars?uC(n.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:n.vars?uC(n.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...n.applyStyles("dark",{backgroundImage:"none"})}}]}))),KA=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiAppBar"}),{className:m,color:y="primary",enableColorOnDark:T=!1,position:i="fixed",...I}=u,F={...u,color:y,position:i,enableColorOnDark:T},B=pF(F);return _e.jsx(fF,{square:!0,component:"header",ownerState:F,elevation:4,className:Sn(B.root,m,i==="fixed"&&"mui-fixed"),ref:s,...I})});var ol="top",Tc="bottom",Ec="right",sl="left",Pw="auto",ay=[ol,Tc,Ec,sl],eg="start",H_="end",mF="clippingParents",JA="viewport",o_="popper",gF="reference",dC=ay.reduce(function(n,r){return n.concat([r+"-"+eg,r+"-"+H_])},[]),QA=[].concat(ay,[Pw]).reduce(function(n,r){return n.concat([r,r+"-"+eg,r+"-"+H_])},[]),_F="beforeRead",yF="read",vF="afterRead",xF="beforeMain",bF="main",wF="afterMain",SF="beforeWrite",TF="write",EF="afterWrite",CF=[_F,yF,vF,xF,bF,wF,SF,TF,EF];function ud(n){return n?(n.nodeName||"").toLowerCase():null}function jl(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var r=n.ownerDocument;return r&&r.defaultView||window}return n}function Of(n){var r=jl(n).Element;return n instanceof r||n instanceof Element}function Sc(n){var r=jl(n).HTMLElement;return n instanceof r||n instanceof HTMLElement}function Rw(n){if(typeof ShadowRoot>"u")return!1;var r=jl(n).ShadowRoot;return n instanceof r||n instanceof ShadowRoot}function MF(n){var r=n.state;Object.keys(r.elements).forEach(function(s){var u=r.styles[s]||{},m=r.attributes[s]||{},y=r.elements[s];!Sc(y)||!ud(y)||(Object.assign(y.style,u),Object.keys(m).forEach(function(T){var i=m[T];i===!1?y.removeAttribute(T):y.setAttribute(T,i===!0?"":i)}))})}function IF(n){var r=n.state,s={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,s.popper),r.styles=s,r.elements.arrow&&Object.assign(r.elements.arrow.style,s.arrow),function(){Object.keys(r.elements).forEach(function(u){var m=r.elements[u],y=r.attributes[u]||{},T=Object.keys(r.styles.hasOwnProperty(u)?r.styles[u]:s[u]),i=T.reduce(function(I,F){return I[F]="",I},{});!Sc(m)||!ud(m)||(Object.assign(m.style,i),Object.keys(y).forEach(function(I){m.removeAttribute(I)}))})}}const AF={name:"applyStyles",enabled:!0,phase:"write",fn:MF,effect:IF,requires:["computeStyles"]};function ld(n){return n.split("-")[0]}var Af=Math.max,Zv=Math.min,tg=Math.round;function F1(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function eP(){return!/^((?!chrome|android).)*safari/i.test(F1())}function ng(n,r,s){r===void 0&&(r=!1),s===void 0&&(s=!1);var u=n.getBoundingClientRect(),m=1,y=1;r&&Sc(n)&&(m=n.offsetWidth>0&&tg(u.width)/n.offsetWidth||1,y=n.offsetHeight>0&&tg(u.height)/n.offsetHeight||1);var T=Of(n)?jl(n):window,i=T.visualViewport,I=!eP()&&s,F=(u.left+(I&&i?i.offsetLeft:0))/m,B=(u.top+(I&&i?i.offsetTop:0))/y,G=u.width/m,J=u.height/y;return{width:G,height:J,top:B,right:F+G,bottom:B+J,left:F,x:F,y:B}}function kw(n){var r=ng(n),s=n.offsetWidth,u=n.offsetHeight;return Math.abs(r.width-s)<=1&&(s=r.width),Math.abs(r.height-u)<=1&&(u=r.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:u}}function tP(n,r){var s=r.getRootNode&&r.getRootNode();if(n.contains(r))return!0;if(s&&Rw(s)){var u=r;do{if(u&&n.isSameNode(u))return!0;u=u.parentNode||u.host}while(u)}return!1}function sh(n){return jl(n).getComputedStyle(n)}function PF(n){return["table","td","th"].indexOf(ud(n))>=0}function Ip(n){return((Of(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ex(n){return ud(n)==="html"?n:n.assignedSlot||n.parentNode||(Rw(n)?n.host:null)||Ip(n)}function hC(n){return!Sc(n)||sh(n).position==="fixed"?null:n.offsetParent}function RF(n){var r=/firefox/i.test(F1()),s=/Trident/i.test(F1());if(s&&Sc(n)){var u=sh(n);if(u.position==="fixed")return null}var m=Ex(n);for(Rw(m)&&(m=m.host);Sc(m)&&["html","body"].indexOf(ud(m))<0;){var y=sh(m);if(y.transform!=="none"||y.perspective!=="none"||y.contain==="paint"||["transform","perspective"].indexOf(y.willChange)!==-1||r&&y.willChange==="filter"||r&&y.filter&&y.filter!=="none")return m;m=m.parentNode}return null}function ly(n){for(var r=jl(n),s=hC(n);s&&PF(s)&&sh(s).position==="static";)s=hC(s);return s&&(ud(s)==="html"||ud(s)==="body"&&sh(s).position==="static")?r:s||RF(n)||r}function Lw(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function z_(n,r,s){return Af(n,Zv(r,s))}function kF(n,r,s){var u=z_(n,r,s);return u>s?s:u}function nP(){return{top:0,right:0,bottom:0,left:0}}function rP(n){return Object.assign({},nP(),n)}function iP(n,r){return r.reduce(function(s,u){return s[u]=n,s},{})}var LF=function(r,s){return r=typeof r=="function"?r(Object.assign({},s.rects,{placement:s.placement})):r,rP(typeof r!="number"?r:iP(r,ay))};function zF(n){var r,s=n.state,u=n.name,m=n.options,y=s.elements.arrow,T=s.modifiersData.popperOffsets,i=ld(s.placement),I=Lw(i),F=[sl,Ec].indexOf(i)>=0,B=F?"height":"width";if(!(!y||!T)){var G=LF(m.padding,s),J=kw(y),te=I==="y"?ol:sl,H=I==="y"?Tc:Ec,j=s.rects.reference[B]+s.rects.reference[I]-T[I]-s.rects.popper[B],ne=T[I]-s.rects.reference[I],oe=ly(y),pe=oe?I==="y"?oe.clientHeight||0:oe.clientWidth||0:0,se=j/2-ne/2,ie=G[te],ce=pe-J[B]-G[H],we=pe/2-J[B]/2+se,xe=z_(ie,we,ce),$e=I;s.modifiersData[u]=(r={},r[$e]=xe,r.centerOffset=xe-we,r)}}function DF(n){var r=n.state,s=n.options,u=s.element,m=u===void 0?"[data-popper-arrow]":u;m!=null&&(typeof m=="string"&&(m=r.elements.popper.querySelector(m),!m)||tP(r.elements.popper,m)&&(r.elements.arrow=m))}const OF={name:"arrow",enabled:!0,phase:"main",fn:zF,effect:DF,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function rg(n){return n.split("-")[1]}var FF={top:"auto",right:"auto",bottom:"auto",left:"auto"};function BF(n,r){var s=n.x,u=n.y,m=r.devicePixelRatio||1;return{x:tg(s*m)/m||0,y:tg(u*m)/m||0}}function pC(n){var r,s=n.popper,u=n.popperRect,m=n.placement,y=n.variation,T=n.offsets,i=n.position,I=n.gpuAcceleration,F=n.adaptive,B=n.roundOffsets,G=n.isFixed,J=T.x,te=J===void 0?0:J,H=T.y,j=H===void 0?0:H,ne=typeof B=="function"?B({x:te,y:j}):{x:te,y:j};te=ne.x,j=ne.y;var oe=T.hasOwnProperty("x"),pe=T.hasOwnProperty("y"),se=sl,ie=ol,ce=window;if(F){var we=ly(s),xe="clientHeight",$e="clientWidth";if(we===jl(s)&&(we=Ip(s),sh(we).position!=="static"&&i==="absolute"&&(xe="scrollHeight",$e="scrollWidth")),we=we,m===ol||(m===sl||m===Ec)&&y===H_){ie=Tc;var Ze=G&&we===ce&&ce.visualViewport?ce.visualViewport.height:we[xe];j-=Ze-u.height,j*=I?1:-1}if(m===sl||(m===ol||m===Tc)&&y===H_){se=Ec;var ae=G&&we===ce&&ce.visualViewport?ce.visualViewport.width:we[$e];te-=ae-u.width,te*=I?1:-1}}var ke=Object.assign({position:i},F&&FF),ct=B===!0?BF({x:te,y:j},jl(s)):{x:te,y:j};if(te=ct.x,j=ct.y,I){var Xe;return Object.assign({},ke,(Xe={},Xe[ie]=pe?"0":"",Xe[se]=oe?"0":"",Xe.transform=(ce.devicePixelRatio||1)<=1?"translate("+te+"px, "+j+"px)":"translate3d("+te+"px, "+j+"px, 0)",Xe))}return Object.assign({},ke,(r={},r[ie]=pe?j+"px":"",r[se]=oe?te+"px":"",r.transform="",r))}function NF(n){var r=n.state,s=n.options,u=s.gpuAcceleration,m=u===void 0?!0:u,y=s.adaptive,T=y===void 0?!0:y,i=s.roundOffsets,I=i===void 0?!0:i,F={placement:ld(r.placement),variation:rg(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:m,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,pC(Object.assign({},F,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:T,roundOffsets:I})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,pC(Object.assign({},F,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:I})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const jF={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:NF,data:{}};var lv={passive:!0};function UF(n){var r=n.state,s=n.instance,u=n.options,m=u.scroll,y=m===void 0?!0:m,T=u.resize,i=T===void 0?!0:T,I=jl(r.elements.popper),F=[].concat(r.scrollParents.reference,r.scrollParents.popper);return y&&F.forEach(function(B){B.addEventListener("scroll",s.update,lv)}),i&&I.addEventListener("resize",s.update,lv),function(){y&&F.forEach(function(B){B.removeEventListener("scroll",s.update,lv)}),i&&I.removeEventListener("resize",s.update,lv)}}const $F={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:UF,data:{}};var VF={left:"right",right:"left",bottom:"top",top:"bottom"};function Ov(n){return n.replace(/left|right|bottom|top/g,function(r){return VF[r]})}var GF={start:"end",end:"start"};function fC(n){return n.replace(/start|end/g,function(r){return GF[r]})}function zw(n){var r=jl(n),s=r.pageXOffset,u=r.pageYOffset;return{scrollLeft:s,scrollTop:u}}function Dw(n){return ng(Ip(n)).left+zw(n).scrollLeft}function qF(n,r){var s=jl(n),u=Ip(n),m=s.visualViewport,y=u.clientWidth,T=u.clientHeight,i=0,I=0;if(m){y=m.width,T=m.height;var F=eP();(F||!F&&r==="fixed")&&(i=m.offsetLeft,I=m.offsetTop)}return{width:y,height:T,x:i+Dw(n),y:I}}function WF(n){var r,s=Ip(n),u=zw(n),m=(r=n.ownerDocument)==null?void 0:r.body,y=Af(s.scrollWidth,s.clientWidth,m?m.scrollWidth:0,m?m.clientWidth:0),T=Af(s.scrollHeight,s.clientHeight,m?m.scrollHeight:0,m?m.clientHeight:0),i=-u.scrollLeft+Dw(n),I=-u.scrollTop;return sh(m||s).direction==="rtl"&&(i+=Af(s.clientWidth,m?m.clientWidth:0)-y),{width:y,height:T,x:i,y:I}}function Ow(n){var r=sh(n),s=r.overflow,u=r.overflowX,m=r.overflowY;return/auto|scroll|overlay|hidden/.test(s+m+u)}function oP(n){return["html","body","#document"].indexOf(ud(n))>=0?n.ownerDocument.body:Sc(n)&&Ow(n)?n:oP(Ex(n))}function D_(n,r){var s;r===void 0&&(r=[]);var u=oP(n),m=u===((s=n.ownerDocument)==null?void 0:s.body),y=jl(u),T=m?[y].concat(y.visualViewport||[],Ow(u)?u:[]):u,i=r.concat(T);return m?i:i.concat(D_(Ex(T)))}function B1(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function HF(n,r){var s=ng(n,!1,r==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function mC(n,r,s){return r===JA?B1(qF(n,s)):Of(r)?HF(r,s):B1(WF(Ip(n)))}function ZF(n){var r=D_(Ex(n)),s=["absolute","fixed"].indexOf(sh(n).position)>=0,u=s&&Sc(n)?ly(n):n;return Of(u)?r.filter(function(m){return Of(m)&&tP(m,u)&&ud(m)!=="body"}):[]}function XF(n,r,s,u){var m=r==="clippingParents"?ZF(n):[].concat(r),y=[].concat(m,[s]),T=y[0],i=y.reduce(function(I,F){var B=mC(n,F,u);return I.top=Af(B.top,I.top),I.right=Zv(B.right,I.right),I.bottom=Zv(B.bottom,I.bottom),I.left=Af(B.left,I.left),I},mC(n,T,u));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function sP(n){var r=n.reference,s=n.element,u=n.placement,m=u?ld(u):null,y=u?rg(u):null,T=r.x+r.width/2-s.width/2,i=r.y+r.height/2-s.height/2,I;switch(m){case ol:I={x:T,y:r.y-s.height};break;case Tc:I={x:T,y:r.y+r.height};break;case Ec:I={x:r.x+r.width,y:i};break;case sl:I={x:r.x-s.width,y:i};break;default:I={x:r.x,y:r.y}}var F=m?Lw(m):null;if(F!=null){var B=F==="y"?"height":"width";switch(y){case eg:I[F]=I[F]-(r[B]/2-s[B]/2);break;case H_:I[F]=I[F]+(r[B]/2-s[B]/2);break}}return I}function Z_(n,r){r===void 0&&(r={});var s=r,u=s.placement,m=u===void 0?n.placement:u,y=s.strategy,T=y===void 0?n.strategy:y,i=s.boundary,I=i===void 0?mF:i,F=s.rootBoundary,B=F===void 0?JA:F,G=s.elementContext,J=G===void 0?o_:G,te=s.altBoundary,H=te===void 0?!1:te,j=s.padding,ne=j===void 0?0:j,oe=rP(typeof ne!="number"?ne:iP(ne,ay)),pe=J===o_?gF:o_,se=n.rects.popper,ie=n.elements[H?pe:J],ce=XF(Of(ie)?ie:ie.contextElement||Ip(n.elements.popper),I,B,T),we=ng(n.elements.reference),xe=sP({reference:we,element:se,strategy:"absolute",placement:m}),$e=B1(Object.assign({},se,xe)),Ze=J===o_?$e:we,ae={top:ce.top-Ze.top+oe.top,bottom:Ze.bottom-ce.bottom+oe.bottom,left:ce.left-Ze.left+oe.left,right:Ze.right-ce.right+oe.right},ke=n.modifiersData.offset;if(J===o_&&ke){var ct=ke[m];Object.keys(ae).forEach(function(Xe){var st=[Ec,Tc].indexOf(Xe)>=0?1:-1,et=[ol,Tc].indexOf(Xe)>=0?"y":"x";ae[Xe]+=ct[et]*st})}return ae}function YF(n,r){r===void 0&&(r={});var s=r,u=s.placement,m=s.boundary,y=s.rootBoundary,T=s.padding,i=s.flipVariations,I=s.allowedAutoPlacements,F=I===void 0?QA:I,B=rg(u),G=B?i?dC:dC.filter(function(H){return rg(H)===B}):ay,J=G.filter(function(H){return F.indexOf(H)>=0});J.length===0&&(J=G);var te=J.reduce(function(H,j){return H[j]=Z_(n,{placement:j,boundary:m,rootBoundary:y,padding:T})[ld(j)],H},{});return Object.keys(te).sort(function(H,j){return te[H]-te[j]})}function KF(n){if(ld(n)===Pw)return[];var r=Ov(n);return[fC(n),r,fC(r)]}function JF(n){var r=n.state,s=n.options,u=n.name;if(!r.modifiersData[u]._skip){for(var m=s.mainAxis,y=m===void 0?!0:m,T=s.altAxis,i=T===void 0?!0:T,I=s.fallbackPlacements,F=s.padding,B=s.boundary,G=s.rootBoundary,J=s.altBoundary,te=s.flipVariations,H=te===void 0?!0:te,j=s.allowedAutoPlacements,ne=r.options.placement,oe=ld(ne),pe=oe===ne,se=I||(pe||!H?[Ov(ne)]:KF(ne)),ie=[ne].concat(se).reduce(function(gn,Mt){return gn.concat(ld(Mt)===Pw?YF(r,{placement:Mt,boundary:B,rootBoundary:G,padding:F,flipVariations:H,allowedAutoPlacements:j}):Mt)},[]),ce=r.rects.reference,we=r.rects.popper,xe=new Map,$e=!0,Ze=ie[0],ae=0;ae<ie.length;ae++){var ke=ie[ae],ct=ld(ke),Xe=rg(ke)===eg,st=[ol,Tc].indexOf(ct)>=0,et=st?"width":"height",gt=Z_(r,{placement:ke,boundary:B,rootBoundary:G,altBoundary:J,padding:F}),zt=st?Xe?Ec:sl:Xe?Tc:ol;ce[et]>we[et]&&(zt=Ov(zt));var at=Ov(zt),Ye=[];if(y&&Ye.push(gt[ct]<=0),i&&Ye.push(gt[zt]<=0,gt[at]<=0),Ye.every(function(gn){return gn})){Ze=ke,$e=!1;break}xe.set(ke,Ye)}if($e)for(var Bt=H?3:1,nt=function(Mt){var $t=ie.find(function(Ut){var hn=xe.get(Ut);if(hn)return hn.slice(0,Mt).every(function(xn){return xn})});if($t)return Ze=$t,"break"},Rt=Bt;Rt>0;Rt--){var Nt=nt(Rt);if(Nt==="break")break}r.placement!==Ze&&(r.modifiersData[u]._skip=!0,r.placement=Ze,r.reset=!0)}}const QF={name:"flip",enabled:!0,phase:"main",fn:JF,requiresIfExists:["offset"],data:{_skip:!1}};function gC(n,r,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-r.height-s.y,right:n.right-r.width+s.x,bottom:n.bottom-r.height+s.y,left:n.left-r.width-s.x}}function _C(n){return[ol,Ec,Tc,sl].some(function(r){return n[r]>=0})}function e5(n){var r=n.state,s=n.name,u=r.rects.reference,m=r.rects.popper,y=r.modifiersData.preventOverflow,T=Z_(r,{elementContext:"reference"}),i=Z_(r,{altBoundary:!0}),I=gC(T,u),F=gC(i,m,y),B=_C(I),G=_C(F);r.modifiersData[s]={referenceClippingOffsets:I,popperEscapeOffsets:F,isReferenceHidden:B,hasPopperEscaped:G},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":B,"data-popper-escaped":G})}const t5={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:e5};function n5(n,r,s){var u=ld(n),m=[sl,ol].indexOf(u)>=0?-1:1,y=typeof s=="function"?s(Object.assign({},r,{placement:n})):s,T=y[0],i=y[1];return T=T||0,i=(i||0)*m,[sl,Ec].indexOf(u)>=0?{x:i,y:T}:{x:T,y:i}}function r5(n){var r=n.state,s=n.options,u=n.name,m=s.offset,y=m===void 0?[0,0]:m,T=QA.reduce(function(B,G){return B[G]=n5(G,r.rects,y),B},{}),i=T[r.placement],I=i.x,F=i.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=I,r.modifiersData.popperOffsets.y+=F),r.modifiersData[u]=T}const i5={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:r5};function o5(n){var r=n.state,s=n.name;r.modifiersData[s]=sP({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})}const s5={name:"popperOffsets",enabled:!0,phase:"read",fn:o5,data:{}};function a5(n){return n==="x"?"y":"x"}function l5(n){var r=n.state,s=n.options,u=n.name,m=s.mainAxis,y=m===void 0?!0:m,T=s.altAxis,i=T===void 0?!1:T,I=s.boundary,F=s.rootBoundary,B=s.altBoundary,G=s.padding,J=s.tether,te=J===void 0?!0:J,H=s.tetherOffset,j=H===void 0?0:H,ne=Z_(r,{boundary:I,rootBoundary:F,padding:G,altBoundary:B}),oe=ld(r.placement),pe=rg(r.placement),se=!pe,ie=Lw(oe),ce=a5(ie),we=r.modifiersData.popperOffsets,xe=r.rects.reference,$e=r.rects.popper,Ze=typeof j=="function"?j(Object.assign({},r.rects,{placement:r.placement})):j,ae=typeof Ze=="number"?{mainAxis:Ze,altAxis:Ze}:Object.assign({mainAxis:0,altAxis:0},Ze),ke=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,ct={x:0,y:0};if(we){if(y){var Xe,st=ie==="y"?ol:sl,et=ie==="y"?Tc:Ec,gt=ie==="y"?"height":"width",zt=we[ie],at=zt+ne[st],Ye=zt-ne[et],Bt=te?-$e[gt]/2:0,nt=pe===eg?xe[gt]:$e[gt],Rt=pe===eg?-$e[gt]:-xe[gt],Nt=r.elements.arrow,gn=te&&Nt?kw(Nt):{width:0,height:0},Mt=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:nP(),$t=Mt[st],Ut=Mt[et],hn=z_(0,xe[gt],gn[gt]),xn=se?xe[gt]/2-Bt-hn-$t-ae.mainAxis:nt-hn-$t-ae.mainAxis,Le=se?-xe[gt]/2+Bt+hn+Ut+ae.mainAxis:Rt+hn+Ut+ae.mainAxis,Dn=r.elements.arrow&&ly(r.elements.arrow),pn=Dn?ie==="y"?Dn.clientTop||0:Dn.clientLeft||0:0,zn=(Xe=ke==null?void 0:ke[ie])!=null?Xe:0,_t=zt+xn-zn-pn,er=zt+Le-zn,pr=z_(te?Zv(at,_t):at,zt,te?Af(Ye,er):Ye);we[ie]=pr,ct[ie]=pr-zt}if(i){var qn,_n=ie==="x"?ol:sl,ir=ie==="x"?Tc:Ec,cr=we[ce],Er=ce==="y"?"height":"width",On=cr+ne[_n],fi=cr-ne[ir],Dt=[ol,sl].indexOf(oe)!==-1,Ft=(qn=ke==null?void 0:ke[ce])!=null?qn:0,sn=Dt?On:cr-xe[Er]-$e[Er]-Ft+ae.altAxis,Tn=Dt?cr+xe[Er]+$e[Er]-Ft-ae.altAxis:fi,Pn=te&&Dt?kF(sn,cr,Tn):z_(te?sn:On,cr,te?Tn:fi);we[ce]=Pn,ct[ce]=Pn-cr}r.modifiersData[u]=ct}}const c5={name:"preventOverflow",enabled:!0,phase:"main",fn:l5,requiresIfExists:["offset"]};function u5(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function d5(n){return n===jl(n)||!Sc(n)?zw(n):u5(n)}function h5(n){var r=n.getBoundingClientRect(),s=tg(r.width)/n.offsetWidth||1,u=tg(r.height)/n.offsetHeight||1;return s!==1||u!==1}function p5(n,r,s){s===void 0&&(s=!1);var u=Sc(r),m=Sc(r)&&h5(r),y=Ip(r),T=ng(n,m,s),i={scrollLeft:0,scrollTop:0},I={x:0,y:0};return(u||!u&&!s)&&((ud(r)!=="body"||Ow(y))&&(i=d5(r)),Sc(r)?(I=ng(r,!0),I.x+=r.clientLeft,I.y+=r.clientTop):y&&(I.x=Dw(y))),{x:T.left+i.scrollLeft-I.x,y:T.top+i.scrollTop-I.y,width:T.width,height:T.height}}function f5(n){var r=new Map,s=new Set,u=[];n.forEach(function(y){r.set(y.name,y)});function m(y){s.add(y.name);var T=[].concat(y.requires||[],y.requiresIfExists||[]);T.forEach(function(i){if(!s.has(i)){var I=r.get(i);I&&m(I)}}),u.push(y)}return n.forEach(function(y){s.has(y.name)||m(y)}),u}function m5(n){var r=f5(n);return CF.reduce(function(s,u){return s.concat(r.filter(function(m){return m.phase===u}))},[])}function g5(n){var r;return function(){return r||(r=new Promise(function(s){Promise.resolve().then(function(){r=void 0,s(n())})})),r}}function _5(n){var r=n.reduce(function(s,u){var m=s[u.name];return s[u.name]=m?Object.assign({},m,u,{options:Object.assign({},m.options,u.options),data:Object.assign({},m.data,u.data)}):u,s},{});return Object.keys(r).map(function(s){return r[s]})}var yC={placement:"bottom",modifiers:[],strategy:"absolute"};function vC(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return!r.some(function(u){return!(u&&typeof u.getBoundingClientRect=="function")})}function y5(n){n===void 0&&(n={});var r=n,s=r.defaultModifiers,u=s===void 0?[]:s,m=r.defaultOptions,y=m===void 0?yC:m;return function(i,I,F){F===void 0&&(F=y);var B={placement:"bottom",orderedModifiers:[],options:Object.assign({},yC,y),modifiersData:{},elements:{reference:i,popper:I},attributes:{},styles:{}},G=[],J=!1,te={state:B,setOptions:function(oe){var pe=typeof oe=="function"?oe(B.options):oe;j(),B.options=Object.assign({},y,B.options,pe),B.scrollParents={reference:Of(i)?D_(i):i.contextElement?D_(i.contextElement):[],popper:D_(I)};var se=m5(_5([].concat(u,B.options.modifiers)));return B.orderedModifiers=se.filter(function(ie){return ie.enabled}),H(),te.update()},forceUpdate:function(){if(!J){var oe=B.elements,pe=oe.reference,se=oe.popper;if(vC(pe,se)){B.rects={reference:p5(pe,ly(se),B.options.strategy==="fixed"),popper:kw(se)},B.reset=!1,B.placement=B.options.placement,B.orderedModifiers.forEach(function(ae){return B.modifiersData[ae.name]=Object.assign({},ae.data)});for(var ie=0;ie<B.orderedModifiers.length;ie++){if(B.reset===!0){B.reset=!1,ie=-1;continue}var ce=B.orderedModifiers[ie],we=ce.fn,xe=ce.options,$e=xe===void 0?{}:xe,Ze=ce.name;typeof we=="function"&&(B=we({state:B,options:$e,name:Ze,instance:te})||B)}}}},update:g5(function(){return new Promise(function(ne){te.forceUpdate(),ne(B)})}),destroy:function(){j(),J=!0}};if(!vC(i,I))return te;te.setOptions(F).then(function(ne){!J&&F.onFirstUpdate&&F.onFirstUpdate(ne)});function H(){B.orderedModifiers.forEach(function(ne){var oe=ne.name,pe=ne.options,se=pe===void 0?{}:pe,ie=ne.effect;if(typeof ie=="function"){var ce=ie({state:B,name:oe,instance:te,options:se}),we=function(){};G.push(ce||we)}})}function j(){G.forEach(function(ne){return ne()}),G=[]}return te}}var v5=[$F,s5,jF,AF,i5,QF,c5,OF,t5],x5=y5({defaultModifiers:v5});function b5(n){return typeof n=="function"?n():n}const aP=fe.forwardRef(function(r,s){const{children:u,container:m,disablePortal:y=!1}=r,[T,i]=fe.useState(null),I=ao(fe.isValidElement(u)?Cp(u):null,s);if(_u(()=>{y||i(b5(m)||document.body)},[m,y]),_u(()=>{if(T&&!y)return A1(s,T),()=>{A1(s,null)}},[s,T,y]),y){if(fe.isValidElement(u)){const F={ref:I};return fe.cloneElement(u,F)}return u}return T&&Sx.createPortal(u,T)});function w5(n){return sr("MuiPopper",n)}ar("MuiPopper",["root"]);function S5(n,r){if(r==="ltr")return n;switch(n){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return n}}function N1(n){return typeof n=="function"?n():n}function T5(n){return n.nodeType!==void 0}const E5=n=>{const{classes:r}=n;return lr({root:["root"]},w5,r)},C5={},M5=fe.forwardRef(function(r,s){const{anchorEl:u,children:m,direction:y,disablePortal:T,modifiers:i,open:I,placement:F,popperOptions:B,popperRef:G,slotProps:J={},slots:te={},TransitionProps:H,ownerState:j,...ne}=r,oe=fe.useRef(null),pe=ao(oe,s),se=fe.useRef(null),ie=ao(se,G),ce=fe.useRef(ie);_u(()=>{ce.current=ie},[ie]),fe.useImperativeHandle(G,()=>se.current,[]);const we=S5(F,y),[xe,$e]=fe.useState(we),[Ze,ae]=fe.useState(N1(u));fe.useEffect(()=>{se.current&&se.current.forceUpdate()}),fe.useEffect(()=>{u&&ae(N1(u))},[u]),_u(()=>{if(!Ze||!I)return;const et=at=>{$e(at.placement)};let gt=[{name:"preventOverflow",options:{altBoundary:T}},{name:"flip",options:{altBoundary:T}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:at})=>{et(at)}}];i!=null&&(gt=gt.concat(i)),B&&B.modifiers!=null&&(gt=gt.concat(B.modifiers));const zt=x5(Ze,oe.current,{placement:we,...B,modifiers:gt});return ce.current(zt),()=>{zt.destroy(),ce.current(null)}},[Ze,T,i,I,B,we]);const ke={placement:xe};H!==null&&(ke.TransitionProps=H);const ct=E5(r),Xe=te.root??"div",st=rl({elementType:Xe,externalSlotProps:J.root,externalForwardedProps:ne,additionalProps:{role:"tooltip",ref:pe},ownerState:r,className:ct.root});return _e.jsx(Xe,{...st,children:typeof m=="function"?m(ke):m})}),I5=fe.forwardRef(function(r,s){const{anchorEl:u,children:m,container:y,direction:T="ltr",disablePortal:i=!1,keepMounted:I=!1,modifiers:F,open:B,placement:G="bottom",popperOptions:J=C5,popperRef:te,style:H,transition:j=!1,slotProps:ne={},slots:oe={},...pe}=r,[se,ie]=fe.useState(!0),ce=()=>{ie(!1)},we=()=>{ie(!0)};if(!I&&!B&&(!j||se))return null;let xe;if(y)xe=y;else if(u){const ae=N1(u);xe=ae&&T5(ae)?cs(ae).body:cs(null).body}const $e=!B&&I&&(!j||se)?"none":void 0,Ze=j?{in:B,onEnter:ce,onExited:we}:void 0;return _e.jsx(aP,{disablePortal:i,container:xe,children:_e.jsx(M5,{anchorEl:u,direction:T,disablePortal:i,modifiers:F,ref:s,open:j?!se:B,placement:G,popperOptions:J,popperRef:te,slotProps:ne,slots:oe,...pe,style:{position:"fixed",top:0,left:0,display:$e,...H},TransitionProps:Ze,children:m})})}),A5=Jt(I5,{name:"MuiPopper",slot:"Root",overridesResolver:(n,r)=>r.root})({}),lP=fe.forwardRef(function(r,s){const u=cg(),m=gr({props:r,name:"MuiPopper"}),{anchorEl:y,component:T,components:i,componentsProps:I,container:F,disablePortal:B,keepMounted:G,modifiers:J,open:te,placement:H,popperOptions:j,popperRef:ne,transition:oe,slots:pe,slotProps:se,...ie}=m,ce=(pe==null?void 0:pe.root)??(i==null?void 0:i.Root),we={anchorEl:y,container:F,disablePortal:B,keepMounted:G,modifiers:J,open:te,placement:H,popperOptions:j,popperRef:ne,transition:oe,...ie};return _e.jsx(A5,{as:T,direction:u?"rtl":"ltr",slots:{root:ce},slotProps:se??I,...we,ref:s})}),P5=Ti(_e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function R5(n){return sr("MuiChip",n)}const mi=ar("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),k5=n=>{const{classes:r,disabled:s,size:u,color:m,iconColor:y,onDelete:T,clickable:i,variant:I}=n,F={root:["root",I,s&&"disabled",`size${Yt(u)}`,`color${Yt(m)}`,i&&"clickable",i&&`clickableColor${Yt(m)}`,T&&"deletable",T&&`deletableColor${Yt(m)}`,`${I}${Yt(m)}`],label:["label",`label${Yt(u)}`],avatar:["avatar",`avatar${Yt(u)}`,`avatarColor${Yt(m)}`],icon:["icon",`icon${Yt(u)}`,`iconColor${Yt(y)}`],deleteIcon:["deleteIcon",`deleteIcon${Yt(u)}`,`deleteIconColor${Yt(m)}`,`deleteIcon${Yt(I)}Color${Yt(m)}`]};return lr(F,R5,r)},L5=Jt("div",{name:"MuiChip",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n,{color:u,iconColor:m,clickable:y,onDelete:T,size:i,variant:I}=s;return[{[`& .${mi.avatar}`]:r.avatar},{[`& .${mi.avatar}`]:r[`avatar${Yt(i)}`]},{[`& .${mi.avatar}`]:r[`avatarColor${Yt(u)}`]},{[`& .${mi.icon}`]:r.icon},{[`& .${mi.icon}`]:r[`icon${Yt(i)}`]},{[`& .${mi.icon}`]:r[`iconColor${Yt(m)}`]},{[`& .${mi.deleteIcon}`]:r.deleteIcon},{[`& .${mi.deleteIcon}`]:r[`deleteIcon${Yt(i)}`]},{[`& .${mi.deleteIcon}`]:r[`deleteIconColor${Yt(u)}`]},{[`& .${mi.deleteIcon}`]:r[`deleteIcon${Yt(I)}Color${Yt(u)}`]},r.root,r[`size${Yt(i)}`],r[`color${Yt(u)}`],y&&r.clickable,y&&u!=="default"&&r[`clickableColor${Yt(u)})`],T&&r.deletable,T&&u!=="default"&&r[`deletableColor${Yt(u)}`],r[I],r[`${I}${Yt(u)}`]]}})(rr(({theme:n})=>{const r=n.palette.mode==="light"?n.palette.grey[700]:n.palette.grey[300];return{maxWidth:"100%",fontFamily:n.typography.fontFamily,fontSize:n.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(n.vars||n).palette.text.primary,backgroundColor:(n.vars||n).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:n.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${mi.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${mi.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:n.vars?n.vars.palette.Chip.defaultAvatarColor:r,fontSize:n.typography.pxToRem(12)},[`& .${mi.avatarColorPrimary}`]:{color:(n.vars||n).palette.primary.contrastText,backgroundColor:(n.vars||n).palette.primary.dark},[`& .${mi.avatarColorSecondary}`]:{color:(n.vars||n).palette.secondary.contrastText,backgroundColor:(n.vars||n).palette.secondary.dark},[`& .${mi.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:n.typography.pxToRem(10)},[`& .${mi.icon}`]:{marginLeft:5,marginRight:-6},[`& .${mi.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / 0.26)`:Oi(n.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / 0.4)`:Oi(n.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${mi.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${mi.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(n.palette).filter(zo(["contrastText"])).map(([s])=>({props:{color:s},style:{backgroundColor:(n.vars||n).palette[s].main,color:(n.vars||n).palette[s].contrastText,[`& .${mi.deleteIcon}`]:{color:n.vars?`rgba(${n.vars.palette[s].contrastTextChannel} / 0.7)`:Oi(n.palette[s].contrastText,.7),"&:hover, &:active":{color:(n.vars||n).palette[s].contrastText}}}})),{props:s=>s.iconColor===s.color,style:{[`& .${mi.icon}`]:{color:n.vars?n.vars.palette.Chip.defaultIconColor:r}}},{props:s=>s.iconColor===s.color&&s.color!=="default",style:{[`& .${mi.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${mi.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.action.selectedChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:Oi(n.palette.action.selected,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}}},...Object.entries(n.palette).filter(zo(["dark"])).map(([s])=>({props:{color:s,onDelete:!0},style:{[`&.${mi.focusVisible}`]:{background:(n.vars||n).palette[s].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.selectedChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Oi(n.palette.action.selected,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity)},[`&.${mi.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.action.selectedChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:Oi(n.palette.action.selected,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)},"&:active":{boxShadow:(n.vars||n).shadows[1]}}},...Object.entries(n.palette).filter(zo(["dark"])).map(([s])=>({props:{color:s,clickable:!0},style:{[`&:hover, &.${mi.focusVisible}`]:{backgroundColor:(n.vars||n).palette[s].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:n.vars?`1px solid ${n.vars.palette.Chip.defaultBorder}`:`1px solid ${n.palette.mode==="light"?n.palette.grey[400]:n.palette.grey[700]}`,[`&.${mi.clickable}:hover`]:{backgroundColor:(n.vars||n).palette.action.hover},[`&.${mi.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`& .${mi.avatar}`]:{marginLeft:4},[`& .${mi.avatarSmall}`]:{marginLeft:2},[`& .${mi.icon}`]:{marginLeft:4},[`& .${mi.iconSmall}`]:{marginLeft:2},[`& .${mi.deleteIcon}`]:{marginRight:5},[`& .${mi.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(n.palette).filter(zo()).map(([s])=>({props:{variant:"outlined",color:s},style:{color:(n.vars||n).palette[s].main,border:`1px solid ${n.vars?`rgba(${n.vars.palette[s].mainChannel} / 0.7)`:Oi(n.palette[s].main,.7)}`,[`&.${mi.clickable}:hover`]:{backgroundColor:n.vars?`rgba(${n.vars.palette[s].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette[s].main,n.palette.action.hoverOpacity)},[`&.${mi.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette[s].mainChannel} / ${n.vars.palette.action.focusOpacity})`:Oi(n.palette[s].main,n.palette.action.focusOpacity)},[`& .${mi.deleteIcon}`]:{color:n.vars?`rgba(${n.vars.palette[s].mainChannel} / 0.7)`:Oi(n.palette[s].main,.7),"&:hover, &:active":{color:(n.vars||n).palette[s].main}}}}))]}})),z5=Jt("span",{name:"MuiChip",slot:"Label",overridesResolver:(n,r)=>{const{ownerState:s}=n,{size:u}=s;return[r.label,r[`label${Yt(u)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function xC(n){return n.key==="Backspace"||n.key==="Delete"}const D5=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiChip"}),{avatar:m,className:y,clickable:T,color:i="default",component:I,deleteIcon:F,disabled:B=!1,icon:G,label:J,onClick:te,onDelete:H,onKeyDown:j,onKeyUp:ne,size:oe="medium",variant:pe="filled",tabIndex:se,skipFocusWhenDisabled:ie=!1,...ce}=u,we=fe.useRef(null),xe=ao(we,s),$e=Ye=>{Ye.stopPropagation(),H&&H(Ye)},Ze=Ye=>{Ye.currentTarget===Ye.target&&xC(Ye)&&Ye.preventDefault(),j&&j(Ye)},ae=Ye=>{Ye.currentTarget===Ye.target&&H&&xC(Ye)&&H(Ye),ne&&ne(Ye)},ke=T!==!1&&te?!0:T,ct=ke||H?Tp:I||"div",Xe={...u,component:ct,disabled:B,size:oe,color:i,iconColor:fe.isValidElement(G)&&G.props.color||i,onDelete:!!H,clickable:ke,variant:pe},st=k5(Xe),et=ct===Tp?{component:I||"div",focusVisibleClassName:st.focusVisible,...H&&{disableRipple:!0}}:{};let gt=null;H&&(gt=F&&fe.isValidElement(F)?fe.cloneElement(F,{className:Sn(F.props.className,st.deleteIcon),onClick:$e}):_e.jsx(P5,{className:Sn(st.deleteIcon),onClick:$e}));let zt=null;m&&fe.isValidElement(m)&&(zt=fe.cloneElement(m,{className:Sn(st.avatar,m.props.className)}));let at=null;return G&&fe.isValidElement(G)&&(at=fe.cloneElement(G,{className:Sn(st.icon,G.props.className)})),_e.jsxs(L5,{as:ct,className:Sn(st.root,y),disabled:ke&&B?!0:void 0,onClick:te,onKeyDown:Ze,onKeyUp:ae,ref:xe,tabIndex:ie&&B?-1:se,ownerState:Xe,...et,...ce,children:[zt||at,_e.jsx(z5,{className:Sn(st.label),ownerState:Xe,children:J}),gt]})});function cv(n){return parseInt(n,10)||0}const O5={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function F5(n){return n==null||Object.keys(n).length===0||n.outerHeightStyle===0&&!n.overflowing}const B5=fe.forwardRef(function(r,s){const{onChange:u,maxRows:m,minRows:y=1,style:T,value:i,...I}=r,{current:F}=fe.useRef(i!=null),B=fe.useRef(null),G=ao(s,B),J=fe.useRef(null),te=fe.useRef(null),H=fe.useCallback(()=>{const oe=B.current,se=yu(oe).getComputedStyle(oe);if(se.width==="0px")return{outerHeightStyle:0,overflowing:!1};const ie=te.current;ie.style.width=se.width,ie.value=oe.value||r.placeholder||"x",ie.value.slice(-1)===`
`&&(ie.value+=" ");const ce=se.boxSizing,we=cv(se.paddingBottom)+cv(se.paddingTop),xe=cv(se.borderBottomWidth)+cv(se.borderTopWidth),$e=ie.scrollHeight;ie.value="x";const Ze=ie.scrollHeight;let ae=$e;y&&(ae=Math.max(Number(y)*Ze,ae)),m&&(ae=Math.min(Number(m)*Ze,ae)),ae=Math.max(ae,Ze);const ke=ae+(ce==="border-box"?we+xe:0),ct=Math.abs(ae-$e)<=1;return{outerHeightStyle:ke,overflowing:ct}},[m,y,r.placeholder]),j=fe.useCallback(()=>{const oe=H();if(F5(oe))return;const pe=oe.outerHeightStyle,se=B.current;J.current!==pe&&(J.current=pe,se.style.height=`${pe}px`),se.style.overflow=oe.overflowing?"hidden":""},[H]);_u(()=>{const oe=()=>{j()};let pe;const se=Tw(oe),ie=B.current,ce=yu(ie);ce.addEventListener("resize",se);let we;return typeof ResizeObserver<"u"&&(we=new ResizeObserver(oe),we.observe(ie)),()=>{se.clear(),cancelAnimationFrame(pe),ce.removeEventListener("resize",se),we&&we.disconnect()}},[H,j]),_u(()=>{j()});const ne=oe=>{F||j(),u&&u(oe)};return _e.jsxs(fe.Fragment,{children:[_e.jsx("textarea",{value:i,onChange:ne,ref:G,rows:y,style:T,...I}),_e.jsx("textarea",{"aria-hidden":!0,className:r.className,readOnly:!0,ref:te,tabIndex:-1,style:{...O5.shadow,...T,paddingTop:0,paddingBottom:0}})]})});function Pf(n){return typeof n=="string"}function Ap({props:n,states:r,muiFormControl:s}){return r.reduce((u,m)=>(u[m]=n[m],s&&typeof n[m]>"u"&&(u[m]=s[m]),u),{})}const Cx=fe.createContext(void 0);function bu(){return fe.useContext(Cx)}function bC(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function Xv(n,r=!1){return n&&(bC(n.value)&&n.value!==""||r&&bC(n.defaultValue)&&n.defaultValue!=="")}function N5(n){return n.startAdornment}function j5(n){return sr("MuiInputBase",n)}const ig=ar("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var wC;const Mx=(n,r)=>{const{ownerState:s}=n;return[r.root,s.formControl&&r.formControl,s.startAdornment&&r.adornedStart,s.endAdornment&&r.adornedEnd,s.error&&r.error,s.size==="small"&&r.sizeSmall,s.multiline&&r.multiline,s.color&&r[`color${Yt(s.color)}`],s.fullWidth&&r.fullWidth,s.hiddenLabel&&r.hiddenLabel]},Ix=(n,r)=>{const{ownerState:s}=n;return[r.input,s.size==="small"&&r.inputSizeSmall,s.multiline&&r.inputMultiline,s.type==="search"&&r.inputTypeSearch,s.startAdornment&&r.inputAdornedStart,s.endAdornment&&r.inputAdornedEnd,s.hiddenLabel&&r.inputHiddenLabel]},U5=n=>{const{classes:r,color:s,disabled:u,error:m,endAdornment:y,focused:T,formControl:i,fullWidth:I,hiddenLabel:F,multiline:B,readOnly:G,size:J,startAdornment:te,type:H}=n,j={root:["root",`color${Yt(s)}`,u&&"disabled",m&&"error",I&&"fullWidth",T&&"focused",i&&"formControl",J&&J!=="medium"&&`size${Yt(J)}`,B&&"multiline",te&&"adornedStart",y&&"adornedEnd",F&&"hiddenLabel",G&&"readOnly"],input:["input",u&&"disabled",H==="search"&&"inputTypeSearch",B&&"inputMultiline",J==="small"&&"inputSizeSmall",F&&"inputHiddenLabel",te&&"inputAdornedStart",y&&"inputAdornedEnd",G&&"readOnly"]};return lr(j,j5,r)},Ax=Jt("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Mx})(rr(({theme:n})=>({...n.typography.body1,color:(n.vars||n).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${ig.disabled}`]:{color:(n.vars||n).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:r})=>r.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:r,size:s})=>r.multiline&&s==="small",style:{paddingTop:1}},{props:({ownerState:r})=>r.fullWidth,style:{width:"100%"}}]}))),Px=Jt("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Ix})(rr(({theme:n})=>{const r=n.palette.mode==="light",s={color:"currentColor",...n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})},u={opacity:"0 !important"},m=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&::-ms-input-placeholder":s,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${ig.formControl} &`]:{"&::-webkit-input-placeholder":u,"&::-moz-placeholder":u,"&::-ms-input-placeholder":u,"&:focus::-webkit-input-placeholder":m,"&:focus::-moz-placeholder":m,"&:focus::-ms-input-placeholder":m},[`&.${ig.disabled}`]:{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled},variants:[{props:({ownerState:y})=>!y.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:y})=>y.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),SC=i4({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),Fw=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiInputBase"}),{"aria-describedby":m,autoComplete:y,autoFocus:T,className:i,color:I,components:F={},componentsProps:B={},defaultValue:G,disabled:J,disableInjectingGlobalStyles:te,endAdornment:H,error:j,fullWidth:ne=!1,id:oe,inputComponent:pe="input",inputProps:se={},inputRef:ie,margin:ce,maxRows:we,minRows:xe,multiline:$e=!1,name:Ze,onBlur:ae,onChange:ke,onClick:ct,onFocus:Xe,onKeyDown:st,onKeyUp:et,placeholder:gt,readOnly:zt,renderSuffix:at,rows:Ye,size:Bt,slotProps:nt={},slots:Rt={},startAdornment:Nt,type:gn="text",value:Mt,...$t}=u,Ut=se.value!=null?se.value:Mt,{current:hn}=fe.useRef(Ut!=null),xn=fe.useRef(),Le=fe.useCallback(Hn=>{},[]),Dn=ao(xn,ie,se.ref,Le),[pn,zn]=fe.useState(!1),_t=bu(),er=Ap({props:u,muiFormControl:_t,states:["color","disabled","error","hiddenLabel","size","required","filled"]});er.focused=_t?_t.focused:pn,fe.useEffect(()=>{!_t&&J&&pn&&(zn(!1),ae&&ae())},[_t,J,pn,ae]);const pr=_t&&_t.onFilled,qn=_t&&_t.onEmpty,_n=fe.useCallback(Hn=>{Xv(Hn)?pr&&pr():qn&&qn()},[pr,qn]);_u(()=>{hn&&_n({value:Ut})},[Ut,_n,hn]);const ir=Hn=>{Xe&&Xe(Hn),se.onFocus&&se.onFocus(Hn),_t&&_t.onFocus?_t.onFocus(Hn):zn(!0)},cr=Hn=>{ae&&ae(Hn),se.onBlur&&se.onBlur(Hn),_t&&_t.onBlur?_t.onBlur(Hn):zn(!1)},Er=(Hn,...Zr)=>{if(!hn){const Lr=Hn.target||xn.current;if(Lr==null)throw new Error(oh(1));_n({value:Lr.value})}se.onChange&&se.onChange(Hn,...Zr),ke&&ke(Hn,...Zr)};fe.useEffect(()=>{_n(xn.current)},[]);const On=Hn=>{xn.current&&Hn.currentTarget===Hn.target&&xn.current.focus(),ct&&ct(Hn)};let fi=pe,Dt=se;$e&&fi==="input"&&(Ye?Dt={type:void 0,minRows:Ye,maxRows:Ye,...Dt}:Dt={type:void 0,maxRows:we,minRows:xe,...Dt},fi=B5);const Ft=Hn=>{_n(Hn.animationName==="mui-auto-fill-cancel"?xn.current:{value:"x"})};fe.useEffect(()=>{_t&&_t.setAdornedStart(!!Nt)},[_t,Nt]);const sn={...u,color:er.color||"primary",disabled:er.disabled,endAdornment:H,error:er.error,focused:er.focused,formControl:_t,fullWidth:ne,hiddenLabel:er.hiddenLabel,multiline:$e,size:er.size,startAdornment:Nt,type:gn},Tn=U5(sn),Pn=Rt.root||F.Root||Ax,ur=nt.root||B.root||{},Bn=Rt.input||F.Input||Px;return Dt={...Dt,...nt.input??B.input},_e.jsxs(fe.Fragment,{children:[!te&&typeof SC=="function"&&(wC||(wC=_e.jsx(SC,{}))),_e.jsxs(Pn,{...ur,ref:s,onClick:On,...$t,...!Pf(Pn)&&{ownerState:{...sn,...ur.ownerState}},className:Sn(Tn.root,ur.className,i,zt&&"MuiInputBase-readOnly"),children:[Nt,_e.jsx(Cx.Provider,{value:null,children:_e.jsx(Bn,{"aria-invalid":er.error,"aria-describedby":m,autoComplete:y,autoFocus:T,defaultValue:G,disabled:er.disabled,id:oe,onAnimationStart:Ft,name:Ze,placeholder:gt,readOnly:zt,required:er.required,rows:Ye,value:Ut,onKeyDown:st,onKeyUp:et,type:gn,...Dt,...!Pf(Bn)&&{as:fi,ownerState:{...sn,...Dt.ownerState}},ref:Dn,className:Sn(Tn.input,Dt.className,zt&&"MuiInputBase-readOnly"),onBlur:cr,onChange:Er,onFocus:ir})}),H,at?at({...er,startAdornment:Nt}):null]})]})});function $5(n){return sr("MuiInput",n)}const s_={...ig,...ar("MuiInput",["root","underline","input"])};function V5(n){return sr("MuiOutlinedInput",n)}const td={...ig,...ar("MuiOutlinedInput",["root","notchedOutline","input"])};function G5(n){return sr("MuiFilledInput",n)}const gf={...ig,...ar("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},q5=Ti(_e.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),W5=Ti(_e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function H5(n){return sr("MuiAvatar",n)}ar("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Z5=n=>{const{classes:r,variant:s,colorDefault:u}=n;return lr({root:["root",s,u&&"colorDefault"],img:["img"],fallback:["fallback"]},H5,r)},X5=Jt("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.variant],s.colorDefault&&r.colorDefault]}})(rr(({theme:n})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:n.typography.fontFamily,fontSize:n.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(n.vars||n).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(n.vars||n).palette.background.default,...n.vars?{backgroundColor:n.vars.palette.Avatar.defaultBg}:{backgroundColor:n.palette.grey[400],...n.applyStyles("dark",{backgroundColor:n.palette.grey[600]})}}}]}))),Y5=Jt("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(n,r)=>r.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),K5=Jt(W5,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(n,r)=>r.fallback})({width:"75%",height:"75%"});function J5({crossOrigin:n,referrerPolicy:r,src:s,srcSet:u}){const[m,y]=fe.useState(!1);return fe.useEffect(()=>{if(!s&&!u)return;y(!1);let T=!0;const i=new Image;return i.onload=()=>{T&&y("loaded")},i.onerror=()=>{T&&y("error")},i.crossOrigin=n,i.referrerPolicy=r,i.src=s,u&&(i.srcset=u),()=>{T=!1}},[n,r,s,u]),m}const ug=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiAvatar"}),{alt:m,children:y,className:T,component:i="div",slots:I={},slotProps:F={},imgProps:B,sizes:G,src:J,srcSet:te,variant:H="circular",...j}=u;let ne=null;const oe={...u,component:i,variant:H},pe=J5({...B,...typeof F.img=="function"?F.img(oe):F.img,src:J,srcSet:te}),se=J||te,ie=se&&pe!=="error";oe.colorDefault=!ie,delete oe.ownerState;const ce=Z5(oe),[we,xe]=Gi("img",{className:ce.img,elementType:Y5,externalForwardedProps:{slots:I,slotProps:{img:{...B,...F.img}}},additionalProps:{alt:m,src:J,srcSet:te,sizes:G},ownerState:oe});return ie?ne=_e.jsx(we,{...xe}):y||y===0?ne=y:se&&m?ne=m[0]:ne=_e.jsx(K5,{ownerState:oe,className:ce.fallback}),_e.jsx(X5,{as:i,className:Sn(ce.root,T),ref:s,...j,ownerState:oe,children:ne})}),Q5={entering:{opacity:1},entered:{opacity:1}},j1=fe.forwardRef(function(r,s){const u=Mp(),m={enter:u.transitions.duration.enteringScreen,exit:u.transitions.duration.leavingScreen},{addEndListener:y,appear:T=!0,children:i,easing:I,in:F,onEnter:B,onEntered:G,onEntering:J,onExit:te,onExited:H,onExiting:j,style:ne,timeout:oe=m,TransitionComponent:pe=vu,...se}=r,ie=fe.useRef(null),ce=ao(ie,Cp(i),s),we=st=>et=>{if(st){const gt=ie.current;et===void 0?st(gt):st(gt,et)}},xe=we(J),$e=we((st,et)=>{Aw(st);const gt=Qm({style:ne,timeout:oe,easing:I},{mode:"enter"});st.style.webkitTransition=u.transitions.create("opacity",gt),st.style.transition=u.transitions.create("opacity",gt),B&&B(st,et)}),Ze=we(G),ae=we(j),ke=we(st=>{const et=Qm({style:ne,timeout:oe,easing:I},{mode:"exit"});st.style.webkitTransition=u.transitions.create("opacity",et),st.style.transition=u.transitions.create("opacity",et),te&&te(st)}),ct=we(H),Xe=st=>{y&&y(ie.current,st)};return _e.jsx(pe,{appear:T,in:F,nodeRef:ie,onEnter:$e,onEntered:Ze,onEntering:xe,onExit:ke,onExited:ct,onExiting:ae,addEndListener:Xe,timeout:oe,...se,children:(st,{ownerState:et,...gt})=>fe.cloneElement(i,{style:{opacity:0,visibility:st==="exited"&&!F?"hidden":void 0,...Q5[st],...ne,...i.props.style},ref:ce,...gt})})});function eB(n){return sr("MuiBackdrop",n)}ar("MuiBackdrop",["root","invisible"]);const tB=n=>{const{classes:r,invisible:s}=n;return lr({root:["root",s&&"invisible"]},eB,r)},nB=Jt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.invisible&&r.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Bw=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiBackdrop"}),{children:m,className:y,component:T="div",invisible:i=!1,open:I,components:F={},componentsProps:B={},slotProps:G={},slots:J={},TransitionComponent:te,transitionDuration:H,...j}=u,ne={...u,component:T,invisible:i},oe=tB(ne),pe={transition:te,root:F.Root,...J},se={...B,...G},ie={slots:pe,slotProps:se},[ce,we]=Gi("root",{elementType:nB,externalForwardedProps:ie,className:Sn(oe.root,y),ownerState:ne}),[xe,$e]=Gi("transition",{elementType:j1,externalForwardedProps:ie,ownerState:ne});return _e.jsx(xe,{in:I,timeout:H,...j,...$e,children:_e.jsx(ce,{"aria-hidden":!0,...we,classes:oe,ref:s,children:m})})});function rB(n){const{badgeContent:r,invisible:s=!1,max:u=99,showZero:m=!1}=n,y=FA({badgeContent:r,max:u});let T=s;s===!1&&r===0&&!m&&(T=!0);const{badgeContent:i,max:I=u}=T?y:n,F=i&&Number(i)>I?`${I}+`:i;return{badgeContent:i,invisible:T,max:I,displayValue:F}}function iB(n){return sr("MuiBadge",n)}const dp=ar("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),db=10,hb=4,oB=n=>{const{color:r,anchorOrigin:s,invisible:u,overlap:m,variant:y,classes:T={}}=n,i={root:["root"],badge:["badge",y,u&&"invisible",`anchorOrigin${Yt(s.vertical)}${Yt(s.horizontal)}`,`anchorOrigin${Yt(s.vertical)}${Yt(s.horizontal)}${Yt(m)}`,`overlap${Yt(m)}`,r!=="default"&&`color${Yt(r)}`]};return lr(i,iB,T)},sB=Jt("span",{name:"MuiBadge",slot:"Root",overridesResolver:(n,r)=>r.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),aB=Jt("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.badge,r[s.variant],r[`anchorOrigin${Yt(s.anchorOrigin.vertical)}${Yt(s.anchorOrigin.horizontal)}${Yt(s.overlap)}`],s.color!=="default"&&r[`color${Yt(s.color)}`],s.invisible&&r.invisible]}})(rr(({theme:n})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:n.typography.fontFamily,fontWeight:n.typography.fontWeightMedium,fontSize:n.typography.pxToRem(12),minWidth:db*2,lineHeight:1,padding:"0 6px",height:db*2,borderRadius:db,zIndex:1,transition:n.transitions.create("transform",{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.enteringScreen}),variants:[...Object.entries(n.palette).filter(zo(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(n.vars||n).palette[r].main,color:(n.vars||n).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:hb,height:hb*2,minWidth:hb*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${dp.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:n.transitions.create("transform",{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.leavingScreen})}}]})));function TC(n){return{vertical:(n==null?void 0:n.vertical)??"top",horizontal:(n==null?void 0:n.horizontal)??"right"}}const EC=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiBadge"}),{anchorOrigin:m,className:y,classes:T,component:i,components:I={},componentsProps:F={},children:B,overlap:G="rectangular",color:J="default",invisible:te=!1,max:H=99,badgeContent:j,slots:ne,slotProps:oe,showZero:pe=!1,variant:se="standard",...ie}=u,{badgeContent:ce,invisible:we,max:xe,displayValue:$e}=rB({max:H,invisible:te,badgeContent:j,showZero:pe}),Ze=FA({anchorOrigin:TC(m),color:J,overlap:G,variant:se,badgeContent:j}),ae=we||ce==null&&se!=="dot",{color:ke=J,overlap:ct=G,anchorOrigin:Xe,variant:st=se}=ae?Ze:u,et=TC(Xe),gt=st!=="dot"?$e:void 0,zt={...u,badgeContent:ce,invisible:ae,max:xe,displayValue:gt,showZero:pe,anchorOrigin:et,color:ke,overlap:ct,variant:st},at=oB(zt),Ye=(ne==null?void 0:ne.root)??I.Root??sB,Bt=(ne==null?void 0:ne.badge)??I.Badge??aB,nt=(oe==null?void 0:oe.root)??F.root,Rt=(oe==null?void 0:oe.badge)??F.badge,Nt=rl({elementType:Ye,externalSlotProps:nt,externalForwardedProps:ie,additionalProps:{ref:s,as:i},ownerState:zt,className:Sn(nt==null?void 0:nt.className,at.root,y)}),gn=rl({elementType:Bt,externalSlotProps:Rt,ownerState:zt,className:Sn(at.badge,Rt==null?void 0:Rt.className)});return _e.jsxs(Ye,{...Nt,children:[B,_e.jsx(Bt,{...gn,children:gt})]})});function lB(n){return sr("MuiBottomNavigation",n)}ar("MuiBottomNavigation",["root"]);const cB=n=>{const{classes:r}=n;return lr({root:["root"]},lB,r)},uB=Jt("div",{name:"MuiBottomNavigation",slot:"Root",overridesResolver:(n,r)=>r.root})(rr(({theme:n})=>({display:"flex",justifyContent:"center",height:56,backgroundColor:(n.vars||n).palette.background.paper}))),dB=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiBottomNavigation"}),{children:m,className:y,component:T="div",onChange:i,showLabels:I=!1,value:F,...B}=u,G={...u,component:T,showLabels:I},J=cB(G);return _e.jsx(uB,{as:T,className:Sn(J.root,y),ref:s,ownerState:G,...B,children:fe.Children.map(m,(te,H)=>{if(!fe.isValidElement(te))return null;const j=te.props.value===void 0?H:te.props.value;return fe.cloneElement(te,{selected:j===F,showLabel:te.props.showLabel!==void 0?te.props.showLabel:I,value:j,onChange:i})})})});function hB(n){return sr("MuiBottomNavigationAction",n)}const cP=ar("MuiBottomNavigationAction",["root","iconOnly","selected","label"]),pB=n=>{const{classes:r,showLabel:s,selected:u}=n;return lr({root:["root",!s&&!u&&"iconOnly",u&&"selected"],label:["label",!s&&!u&&"iconOnly",u&&"selected"]},hB,r)},fB=Jt(Tp,{name:"MuiBottomNavigationAction",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,!s.showLabel&&!s.selected&&r.iconOnly]}})(rr(({theme:n})=>({transition:n.transitions.create(["color","padding-top"],{duration:n.transitions.duration.short}),padding:"0px 12px",minWidth:80,maxWidth:168,color:(n.vars||n).palette.text.secondary,flexDirection:"column",flex:"1",[`&.${cP.selected}`]:{color:(n.vars||n).palette.primary.main},variants:[{props:({showLabel:r,selected:s})=>!r&&!s,style:{paddingTop:14}},{props:({showLabel:r,selected:s,label:u})=>!r&&!s&&!u,style:{paddingTop:0}}]}))),mB=Jt("span",{name:"MuiBottomNavigationAction",slot:"Label",overridesResolver:(n,r)=>r.label})(rr(({theme:n})=>({fontFamily:n.typography.fontFamily,fontSize:n.typography.pxToRem(12),opacity:1,transition:"font-size 0.2s, opacity 0.2s",transitionDelay:"0.1s",[`&.${cP.selected}`]:{fontSize:n.typography.pxToRem(14)},variants:[{props:({showLabel:r,selected:s})=>!r&&!s,style:{opacity:0,transitionDelay:"0s"}}]}))),pb=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiBottomNavigationAction"}),{className:m,icon:y,label:T,onChange:i,onClick:I,selected:F,showLabel:B,value:G,...J}=u,te=u,H=pB(te),j=ne=>{i&&i(ne,G),I&&I(ne)};return _e.jsxs(fB,{ref:s,className:Sn(H.root,m),focusRipple:!0,onClick:j,ownerState:te,...J,children:[y,_e.jsx(mB,{className:H.label,ownerState:te,children:T})]})}),gB=ar("MuiBox",["root"]),_B=HA(),Zo=UD({themeId:ax,defaultTheme:_B,defaultClassName:gB.root,generateClassName:CA.generate});function yB(n){return sr("MuiButton",n)}const _f=ar("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),vB=fe.createContext({}),xB=fe.createContext(void 0),bB=n=>{const{color:r,disableElevation:s,fullWidth:u,size:m,variant:y,loading:T,loadingPosition:i,classes:I}=n,F={root:["root",T&&"loading",y,`${y}${Yt(r)}`,`size${Yt(m)}`,`${y}Size${Yt(m)}`,`color${Yt(r)}`,s&&"disableElevation",u&&"fullWidth",T&&`loadingPosition${Yt(i)}`],startIcon:["icon","startIcon",`iconSize${Yt(m)}`],endIcon:["icon","endIcon",`iconSize${Yt(m)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},B=lr(F,yB,I);return{...I,...B}},uP=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],wB=Jt(Tp,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiButton",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.variant],r[`${s.variant}${Yt(s.color)}`],r[`size${Yt(s.size)}`],r[`${s.variant}Size${Yt(s.size)}`],s.color==="inherit"&&r.colorInherit,s.disableElevation&&r.disableElevation,s.fullWidth&&r.fullWidth,s.loading&&r.loading]}})(rr(({theme:n})=>{const r=n.palette.mode==="light"?n.palette.grey[300]:n.palette.grey[800],s=n.palette.mode==="light"?n.palette.grey.A100:n.palette.grey[700];return{...n.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${_f.disabled}`]:{color:(n.vars||n).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(n.vars||n).shadows[2],"&:hover":{boxShadow:(n.vars||n).shadows[4],"@media (hover: none)":{boxShadow:(n.vars||n).shadows[2]}},"&:active":{boxShadow:(n.vars||n).shadows[8]},[`&.${_f.focusVisible}`]:{boxShadow:(n.vars||n).shadows[6]},[`&.${_f.disabled}`]:{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${_f.disabled}`]:{border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(n.palette).filter(zo()).map(([u])=>({props:{color:u},style:{"--variant-textColor":(n.vars||n).palette[u].main,"--variant-outlinedColor":(n.vars||n).palette[u].main,"--variant-outlinedBorder":n.vars?`rgba(${n.vars.palette[u].mainChannel} / 0.5)`:Oi(n.palette[u].main,.5),"--variant-containedColor":(n.vars||n).palette[u].contrastText,"--variant-containedBg":(n.vars||n).palette[u].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(n.vars||n).palette[u].dark,"--variant-textBg":n.vars?`rgba(${n.vars.palette[u].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette[u].main,n.palette.action.hoverOpacity),"--variant-outlinedBorder":(n.vars||n).palette[u].main,"--variant-outlinedBg":n.vars?`rgba(${n.vars.palette[u].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette[u].main,n.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":n.vars?n.vars.palette.Button.inheritContainedBg:r,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":n.vars?n.vars.palette.Button.inheritContainedHoverBg:s,"--variant-textBg":n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette.text.primary,n.palette.action.hoverOpacity),"--variant-outlinedBg":n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette.text.primary,n.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:n.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:n.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:n.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:n.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:n.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:n.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${_f.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${_f.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:n.transitions.create(["background-color","box-shadow","border-color"],{duration:n.transitions.duration.short}),[`&.${_f.loading}`]:{color:"transparent"}}}]}})),SB=Jt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.startIcon,s.loading&&r.startIconLoadingStart,r[`iconSize${Yt(s.size)}`]]}})(({theme:n})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...uP]})),TB=Jt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.endIcon,s.loading&&r.endIconLoadingEnd,r[`iconSize${Yt(s.size)}`]]}})(({theme:n})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:n.transitions.create(["opacity"],{duration:n.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...uP]})),EB=Jt("span",{name:"MuiButton",slot:"LoadingIndicator",overridesResolver:(n,r)=>r.loadingIndicator})(({theme:n})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(n.vars||n).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),CC=Jt("span",{name:"MuiButton",slot:"LoadingIconPlaceholder",overridesResolver:(n,r)=>r.loadingIconPlaceholder})({display:"inline-block",width:"1em",height:"1em"}),cd=fe.forwardRef(function(r,s){const u=fe.useContext(vB),m=fe.useContext(xB),y=W_(u,r),T=gr({props:y,name:"MuiButton"}),{children:i,color:I="primary",component:F="button",className:B,disabled:G=!1,disableElevation:J=!1,disableFocusRipple:te=!1,endIcon:H,focusVisibleClassName:j,fullWidth:ne=!1,id:oe,loading:pe=null,loadingIndicator:se,loadingPosition:ie="center",size:ce="medium",startIcon:we,type:xe,variant:$e="text",...Ze}=T,ae=ah(oe),ke=se??_e.jsx(Tx,{"aria-labelledby":ae,color:"inherit",size:16}),ct={...T,color:I,component:F,disabled:G,disableElevation:J,disableFocusRipple:te,fullWidth:ne,loading:pe,loadingIndicator:ke,loadingPosition:ie,size:ce,type:xe,variant:$e},Xe=bB(ct),st=(we||pe&&ie==="start")&&_e.jsx(SB,{className:Xe.startIcon,ownerState:ct,children:we||_e.jsx(CC,{className:Xe.loadingIconPlaceholder,ownerState:ct})}),et=(H||pe&&ie==="end")&&_e.jsx(TB,{className:Xe.endIcon,ownerState:ct,children:H||_e.jsx(CC,{className:Xe.loadingIconPlaceholder,ownerState:ct})}),gt=m||"",zt=typeof pe=="boolean"?_e.jsx("span",{className:Xe.loadingWrapper,style:{display:"contents"},children:pe&&_e.jsx(EB,{className:Xe.loadingIndicator,ownerState:ct,children:ke})}):null;return _e.jsxs(wB,{ownerState:ct,className:Sn(u.className,Xe.root,B,gt),component:F,disabled:G||pe,focusRipple:!te,focusVisibleClassName:Sn(Xe.focusVisible,j),ref:s,type:xe,id:ae,...Ze,classes:Xe,children:[st,ie!=="end"&&zt,i,ie==="end"&&zt,et]})});function CB(n){return sr("MuiCard",n)}ar("MuiCard",["root"]);const MB=n=>{const{classes:r}=n;return lr({root:["root"]},CB,r)},IB=Jt(xu,{name:"MuiCard",slot:"Root",overridesResolver:(n,r)=>r.root})({overflow:"hidden"}),dP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiCard"}),{className:m,raised:y=!1,...T}=u,i={...u,raised:y},I=MB(i);return _e.jsx(IB,{className:Sn(I.root,m),elevation:y?8:void 0,ref:s,ownerState:i,...T})});function AB(n){return sr("PrivateSwitchBase",n)}ar("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const PB=n=>{const{classes:r,checked:s,disabled:u,edge:m}=n,y={root:["root",s&&"checked",u&&"disabled",m&&`edge${Yt(m)}`],input:["input"]};return lr(y,AB,r)},RB=Jt(Tp)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:n,ownerState:r})=>n==="start"&&r.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:n,ownerState:r})=>n==="end"&&r.size!=="small",style:{marginRight:-12}}]}),kB=Jt("input",{shouldForwardProp:ta})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),LB=fe.forwardRef(function(r,s){const{autoFocus:u,checked:m,checkedIcon:y,className:T,defaultChecked:i,disabled:I,disableFocusRipple:F=!1,edge:B=!1,icon:G,id:J,inputProps:te,inputRef:H,name:j,onBlur:ne,onChange:oe,onFocus:pe,readOnly:se,required:ie=!1,tabIndex:ce,type:we,value:xe,...$e}=r,[Ze,ae]=Df({controlled:m,default:!!i,name:"SwitchBase",state:"checked"}),ke=bu(),ct=Ye=>{pe&&pe(Ye),ke&&ke.onFocus&&ke.onFocus(Ye)},Xe=Ye=>{ne&&ne(Ye),ke&&ke.onBlur&&ke.onBlur(Ye)},st=Ye=>{if(Ye.nativeEvent.defaultPrevented)return;const Bt=Ye.target.checked;ae(Bt),oe&&oe(Ye,Bt)};let et=I;ke&&typeof et>"u"&&(et=ke.disabled);const gt=we==="checkbox"||we==="radio",zt={...r,checked:Ze,disabled:et,disableFocusRipple:F,edge:B},at=PB(zt);return _e.jsxs(RB,{component:"span",className:Sn(at.root,T),centerRipple:!0,focusRipple:!F,disabled:et,tabIndex:null,role:void 0,onFocus:ct,onBlur:Xe,ownerState:zt,ref:s,...$e,children:[_e.jsx(kB,{autoFocus:u,checked:m,defaultChecked:i,className:at.input,disabled:et,id:gt?J:void 0,name:j,onChange:st,readOnly:se,ref:H,required:ie,ownerState:zt,tabIndex:ce,type:we,...we==="checkbox"&&xe===void 0?{}:{value:xe},...te}),Ze?y:G]})});function MC(n){return n.substring(2).toLowerCase()}function zB(n,r){return r.documentElement.clientWidth<n.clientX||r.documentElement.clientHeight<n.clientY}function DB(n){const{children:r,disableReactTree:s=!1,mouseEvent:u="onClick",onClickAway:m,touchEvent:y="onTouchEnd"}=n,T=fe.useRef(!1),i=fe.useRef(null),I=fe.useRef(!1),F=fe.useRef(!1);fe.useEffect(()=>(setTimeout(()=>{I.current=!0},0),()=>{I.current=!1}),[]);const B=ao(Cp(r),i),G=il(H=>{const j=F.current;F.current=!1;const ne=cs(i.current);if(!I.current||!i.current||"clientX"in H&&zB(H,ne))return;if(T.current){T.current=!1;return}let oe;H.composedPath?oe=H.composedPath().includes(i.current):oe=!ne.documentElement.contains(H.target)||i.current.contains(H.target),!oe&&(s||!j)&&m(H)}),J=H=>j=>{F.current=!0;const ne=r.props[H];ne&&ne(j)},te={ref:B};return y!==!1&&(te[y]=J(y)),fe.useEffect(()=>{if(y!==!1){const H=MC(y),j=cs(i.current),ne=()=>{T.current=!0};return j.addEventListener(H,G),j.addEventListener("touchmove",ne),()=>{j.removeEventListener(H,G),j.removeEventListener("touchmove",ne)}}},[G,y]),u!==!1&&(te[u]=J(u)),fe.useEffect(()=>{if(u!==!1){const H=MC(u),j=cs(i.current);return j.addEventListener(H,G),()=>{j.removeEventListener(H,G)}}},[G,u]),fe.cloneElement(r,te)}const cy=vO({createStyledComponent:Jt("div",{name:"MuiContainer",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`maxWidth${Yt(String(s.maxWidth))}`],s.fixed&&r.fixed,s.disableGutters&&r.disableGutters]}}),useThemeProps:n=>gr({props:n,name:"MuiContainer"})});function OB(n){const r=cs(n);return r.body===n?yu(n).innerWidth>r.documentElement.clientWidth:n.scrollHeight>n.clientHeight}function O_(n,r){r?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden")}function IC(n){return parseInt(yu(n).getComputedStyle(n).paddingRight,10)||0}function FB(n){const s=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(n.tagName),u=n.tagName==="INPUT"&&n.getAttribute("type")==="hidden";return s||u}function AC(n,r,s,u,m){const y=[r,s,...u];[].forEach.call(n.children,T=>{const i=!y.includes(T),I=!FB(T);i&&I&&O_(T,m)})}function fb(n,r){let s=-1;return n.some((u,m)=>r(u)?(s=m,!0):!1),s}function BB(n,r){const s=[],u=n.container;if(!r.disableScrollLock){if(OB(u)){const T=OA(yu(u));s.push({value:u.style.paddingRight,property:"padding-right",el:u}),u.style.paddingRight=`${IC(u)+T}px`;const i=cs(u).querySelectorAll(".mui-fixed");[].forEach.call(i,I=>{s.push({value:I.style.paddingRight,property:"padding-right",el:I}),I.style.paddingRight=`${IC(I)+T}px`})}let y;if(u.parentNode instanceof DocumentFragment)y=cs(u).body;else{const T=u.parentElement,i=yu(u);y=(T==null?void 0:T.nodeName)==="HTML"&&i.getComputedStyle(T).overflowY==="scroll"?T:u}s.push({value:y.style.overflow,property:"overflow",el:y},{value:y.style.overflowX,property:"overflow-x",el:y},{value:y.style.overflowY,property:"overflow-y",el:y}),y.style.overflow="hidden"}return()=>{s.forEach(({value:y,el:T,property:i})=>{y?T.style.setProperty(i,y):T.style.removeProperty(i)})}}function NB(n){const r=[];return[].forEach.call(n.children,s=>{s.getAttribute("aria-hidden")==="true"&&r.push(s)}),r}class jB{constructor(){this.modals=[],this.containers=[]}add(r,s){let u=this.modals.indexOf(r);if(u!==-1)return u;u=this.modals.length,this.modals.push(r),r.modalRef&&O_(r.modalRef,!1);const m=NB(s);AC(s,r.mount,r.modalRef,m,!0);const y=fb(this.containers,T=>T.container===s);return y!==-1?(this.containers[y].modals.push(r),u):(this.containers.push({modals:[r],container:s,restore:null,hiddenSiblings:m}),u)}mount(r,s){const u=fb(this.containers,y=>y.modals.includes(r)),m=this.containers[u];m.restore||(m.restore=BB(m,s))}remove(r,s=!0){const u=this.modals.indexOf(r);if(u===-1)return u;const m=fb(this.containers,T=>T.modals.includes(r)),y=this.containers[m];if(y.modals.splice(y.modals.indexOf(r),1),this.modals.splice(u,1),y.modals.length===0)y.restore&&y.restore(),r.modalRef&&O_(r.modalRef,s),AC(y.container,r.mount,r.modalRef,y.hiddenSiblings,!1),this.containers.splice(m,1);else{const T=y.modals[y.modals.length-1];T.modalRef&&O_(T.modalRef,!1)}return u}isTopModal(r){return this.modals.length>0&&this.modals[this.modals.length-1]===r}}const UB=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function $B(n){const r=parseInt(n.getAttribute("tabindex")||"",10);return Number.isNaN(r)?n.contentEditable==="true"||(n.nodeName==="AUDIO"||n.nodeName==="VIDEO"||n.nodeName==="DETAILS")&&n.getAttribute("tabindex")===null?0:n.tabIndex:r}function VB(n){if(n.tagName!=="INPUT"||n.type!=="radio"||!n.name)return!1;const r=u=>n.ownerDocument.querySelector(`input[type="radio"]${u}`);let s=r(`[name="${n.name}"]:checked`);return s||(s=r(`[name="${n.name}"]`)),s!==n}function GB(n){return!(n.disabled||n.tagName==="INPUT"&&n.type==="hidden"||VB(n))}function qB(n){const r=[],s=[];return Array.from(n.querySelectorAll(UB)).forEach((u,m)=>{const y=$B(u);y===-1||!GB(u)||(y===0?r.push(u):s.push({documentOrder:m,tabIndex:y,node:u}))}),s.sort((u,m)=>u.tabIndex===m.tabIndex?u.documentOrder-m.documentOrder:u.tabIndex-m.tabIndex).map(u=>u.node).concat(r)}function WB(){return!0}function HB(n){const{children:r,disableAutoFocus:s=!1,disableEnforceFocus:u=!1,disableRestoreFocus:m=!1,getTabbable:y=qB,isEnabled:T=WB,open:i}=n,I=fe.useRef(!1),F=fe.useRef(null),B=fe.useRef(null),G=fe.useRef(null),J=fe.useRef(null),te=fe.useRef(!1),H=fe.useRef(null),j=ao(Cp(r),H),ne=fe.useRef(null);fe.useEffect(()=>{!i||!H.current||(te.current=!s)},[s,i]),fe.useEffect(()=>{if(!i||!H.current)return;const se=cs(H.current);return H.current.contains(se.activeElement)||(H.current.hasAttribute("tabIndex")||H.current.setAttribute("tabIndex","-1"),te.current&&H.current.focus()),()=>{m||(G.current&&G.current.focus&&(I.current=!0,G.current.focus()),G.current=null)}},[i]),fe.useEffect(()=>{if(!i||!H.current)return;const se=cs(H.current),ie=xe=>{ne.current=xe,!(u||!T()||xe.key!=="Tab")&&se.activeElement===H.current&&xe.shiftKey&&(I.current=!0,B.current&&B.current.focus())},ce=()=>{var Ze,ae;const xe=H.current;if(xe===null)return;if(!se.hasFocus()||!T()||I.current){I.current=!1;return}if(xe.contains(se.activeElement)||u&&se.activeElement!==F.current&&se.activeElement!==B.current)return;if(se.activeElement!==J.current)J.current=null;else if(J.current!==null)return;if(!te.current)return;let $e=[];if((se.activeElement===F.current||se.activeElement===B.current)&&($e=y(H.current)),$e.length>0){const ke=!!((Ze=ne.current)!=null&&Ze.shiftKey&&((ae=ne.current)==null?void 0:ae.key)==="Tab"),ct=$e[0],Xe=$e[$e.length-1];typeof ct!="string"&&typeof Xe!="string"&&(ke?Xe.focus():ct.focus())}else xe.focus()};se.addEventListener("focusin",ce),se.addEventListener("keydown",ie,!0);const we=setInterval(()=>{se.activeElement&&se.activeElement.tagName==="BODY"&&ce()},50);return()=>{clearInterval(we),se.removeEventListener("focusin",ce),se.removeEventListener("keydown",ie,!0)}},[s,u,m,T,i,y]);const oe=se=>{G.current===null&&(G.current=se.relatedTarget),te.current=!0,J.current=se.target;const ie=r.props.onFocus;ie&&ie(se)},pe=se=>{G.current===null&&(G.current=se.relatedTarget),te.current=!0};return _e.jsxs(fe.Fragment,{children:[_e.jsx("div",{tabIndex:i?0:-1,onFocus:pe,ref:F,"data-testid":"sentinelStart"}),fe.cloneElement(r,{ref:j,onFocus:oe}),_e.jsx("div",{tabIndex:i?0:-1,onFocus:pe,ref:B,"data-testid":"sentinelEnd"})]})}function ZB(n){return typeof n=="function"?n():n}function XB(n){return n?n.props.hasOwnProperty("in"):!1}const PC=()=>{},uv=new jB;function YB(n){const{container:r,disableEscapeKeyDown:s=!1,disableScrollLock:u=!1,closeAfterTransition:m=!1,onTransitionEnter:y,onTransitionExited:T,children:i,onClose:I,open:F,rootRef:B}=n,G=fe.useRef({}),J=fe.useRef(null),te=fe.useRef(null),H=ao(te,B),[j,ne]=fe.useState(!F),oe=XB(i);let pe=!0;(n["aria-hidden"]==="false"||n["aria-hidden"]===!1)&&(pe=!1);const se=()=>cs(J.current),ie=()=>(G.current.modalRef=te.current,G.current.mount=J.current,G.current),ce=()=>{uv.mount(ie(),{disableScrollLock:u}),te.current&&(te.current.scrollTop=0)},we=il(()=>{const et=ZB(r)||se().body;uv.add(ie(),et),te.current&&ce()}),xe=()=>uv.isTopModal(ie()),$e=il(et=>{J.current=et,et&&(F&&xe()?ce():te.current&&O_(te.current,pe))}),Ze=fe.useCallback(()=>{uv.remove(ie(),pe)},[pe]);fe.useEffect(()=>()=>{Ze()},[Ze]),fe.useEffect(()=>{F?we():(!oe||!m)&&Ze()},[F,Ze,oe,m,we]);const ae=et=>gt=>{var zt;(zt=et.onKeyDown)==null||zt.call(et,gt),!(gt.key!=="Escape"||gt.which===229||!xe())&&(s||(gt.stopPropagation(),I&&I(gt,"escapeKeyDown")))},ke=et=>gt=>{var zt;(zt=et.onClick)==null||zt.call(et,gt),gt.target===gt.currentTarget&&I&&I(gt,"backdropClick")};return{getRootProps:(et={})=>{const gt=If(n);delete gt.onTransitionEnter,delete gt.onTransitionExited;const zt={...gt,...et};return{role:"presentation",...zt,onKeyDown:ae(zt),ref:H}},getBackdropProps:(et={})=>{const gt=et;return{"aria-hidden":!0,...gt,onClick:ke(gt),open:F}},getTransitionProps:()=>{const et=()=>{ne(!1),y&&y()},gt=()=>{ne(!0),T&&T(),m&&Ze()};return{onEnter:I1(et,(i==null?void 0:i.props.onEnter)??PC),onExited:I1(gt,(i==null?void 0:i.props.onExited)??PC)}},rootRef:H,portalRef:$e,isTopModal:xe,exited:j,hasTransition:oe}}function KB(n){return sr("MuiModal",n)}ar("MuiModal",["root","hidden","backdrop"]);const JB=n=>{const{open:r,exited:s,classes:u}=n;return lr({root:["root",!r&&s&&"hidden"],backdrop:["backdrop"]},KB,u)},QB=Jt("div",{name:"MuiModal",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,!s.open&&s.exited&&r.hidden]}})(rr(({theme:n})=>({position:"fixed",zIndex:(n.vars||n).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:r})=>!r.open&&r.exited,style:{visibility:"hidden"}}]}))),eN=Jt(Bw,{name:"MuiModal",slot:"Backdrop",overridesResolver:(n,r)=>r.backdrop})({zIndex:-1}),Nw=fe.forwardRef(function(r,s){const u=gr({name:"MuiModal",props:r}),{BackdropComponent:m=eN,BackdropProps:y,classes:T,className:i,closeAfterTransition:I=!1,children:F,container:B,component:G,components:J={},componentsProps:te={},disableAutoFocus:H=!1,disableEnforceFocus:j=!1,disableEscapeKeyDown:ne=!1,disablePortal:oe=!1,disableRestoreFocus:pe=!1,disableScrollLock:se=!1,hideBackdrop:ie=!1,keepMounted:ce=!1,onBackdropClick:we,onClose:xe,onTransitionEnter:$e,onTransitionExited:Ze,open:ae,slotProps:ke={},slots:ct={},theme:Xe,...st}=u,et={...u,closeAfterTransition:I,disableAutoFocus:H,disableEnforceFocus:j,disableEscapeKeyDown:ne,disablePortal:oe,disableRestoreFocus:pe,disableScrollLock:se,hideBackdrop:ie,keepMounted:ce},{getRootProps:gt,getBackdropProps:zt,getTransitionProps:at,portalRef:Ye,isTopModal:Bt,exited:nt,hasTransition:Rt}=YB({...et,rootRef:s}),Nt={...et,exited:nt},gn=JB(Nt),Mt={};if(F.props.tabIndex===void 0&&(Mt.tabIndex="-1"),Rt){const{onEnter:pn,onExited:zn}=at();Mt.onEnter=pn,Mt.onExited=zn}const $t={...st,slots:{root:J.Root,backdrop:J.Backdrop,...ct},slotProps:{...te,...ke}},[Ut,hn]=Gi("root",{elementType:QB,externalForwardedProps:$t,getSlotProps:gt,additionalProps:{ref:s,as:G},ownerState:Nt,className:Sn(i,gn==null?void 0:gn.root,!Nt.open&&Nt.exited&&(gn==null?void 0:gn.hidden))}),[xn,Le]=Gi("backdrop",{elementType:m,externalForwardedProps:$t,additionalProps:y,getSlotProps:pn=>zt({...pn,onClick:zn=>{we&&we(zn),pn!=null&&pn.onClick&&pn.onClick(zn)}}),className:Sn(y==null?void 0:y.className,gn==null?void 0:gn.backdrop),ownerState:Nt}),Dn=ao(y==null?void 0:y.ref,Le.ref);return!ce&&!ae&&(!Rt||nt)?null:_e.jsx(aP,{ref:Ye,container:B,disablePortal:oe,children:_e.jsxs(Ut,{...hn,children:[!ie&&m?_e.jsx(xn,{...Le,ref:Dn}):null,_e.jsx(HB,{disableEnforceFocus:j,disableAutoFocus:H,disableRestoreFocus:pe,isEnabled:Bt,open:ae,children:fe.cloneElement(F,Mt)})]})})});function tN(n){return sr("MuiDialog",n)}const mb=ar("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),hP=fe.createContext({}),nN=Jt(Bw,{name:"MuiDialog",slot:"Backdrop",overrides:(n,r)=>r.backdrop})({zIndex:-1}),rN=n=>{const{classes:r,scroll:s,maxWidth:u,fullWidth:m,fullScreen:y}=n,T={root:["root"],container:["container",`scroll${Yt(s)}`],paper:["paper",`paperScroll${Yt(s)}`,`paperWidth${Yt(String(u))}`,m&&"paperFullWidth",y&&"paperFullScreen"]};return lr(T,tN,r)},iN=Jt(Nw,{name:"MuiDialog",slot:"Root",overridesResolver:(n,r)=>r.root})({"@media print":{position:"absolute !important"}}),oN=Jt("div",{name:"MuiDialog",slot:"Container",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.container,r[`scroll${Yt(s.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),sN=Jt(xu,{name:"MuiDialog",slot:"Paper",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.paper,r[`scrollPaper${Yt(s.scroll)}`],r[`paperWidth${Yt(String(s.maxWidth))}`],s.fullWidth&&r.paperFullWidth,s.fullScreen&&r.paperFullScreen]}})(rr(({theme:n})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:r})=>!r.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:n.breakpoints.unit==="px"?Math.max(n.breakpoints.values.xs,444):`max(${n.breakpoints.values.xs}${n.breakpoints.unit}, 444px)`,[`&.${mb.paperScrollBody}`]:{[n.breakpoints.down(Math.max(n.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(n.breakpoints.values).filter(r=>r!=="xs").map(r=>({props:{maxWidth:r},style:{maxWidth:`${n.breakpoints.values[r]}${n.breakpoints.unit}`,[`&.${mb.paperScrollBody}`]:{[n.breakpoints.down(n.breakpoints.values[r]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:r})=>r.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:r})=>r.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${mb.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),jw=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDialog"}),m=Mp(),y={enter:m.transitions.duration.enteringScreen,exit:m.transitions.duration.leavingScreen},{"aria-describedby":T,"aria-labelledby":i,"aria-modal":I=!0,BackdropComponent:F,BackdropProps:B,children:G,className:J,disableEscapeKeyDown:te=!1,fullScreen:H=!1,fullWidth:j=!1,maxWidth:ne="sm",onBackdropClick:oe,onClick:pe,onClose:se,open:ie,PaperComponent:ce=xu,PaperProps:we={},scroll:xe="paper",slots:$e={},slotProps:Ze={},TransitionComponent:ae=j1,transitionDuration:ke=y,TransitionProps:ct,...Xe}=u,st={...u,disableEscapeKeyDown:te,fullScreen:H,fullWidth:j,maxWidth:ne,scroll:xe},et=rN(st),gt=fe.useRef(),zt=_t=>{gt.current=_t.target===_t.currentTarget},at=_t=>{pe&&pe(_t),gt.current&&(gt.current=null,oe&&oe(_t),se&&se(_t,"backdropClick"))},Ye=ah(i),Bt=fe.useMemo(()=>({titleId:Ye}),[Ye]),nt={transition:ae,...$e},Rt={transition:ct,paper:we,backdrop:B,...Ze},Nt={slots:nt,slotProps:Rt},[gn,Mt]=Gi("root",{elementType:iN,shouldForwardComponentProp:!0,externalForwardedProps:Nt,ownerState:st,className:Sn(et.root,J),ref:s}),[$t,Ut]=Gi("backdrop",{elementType:nN,shouldForwardComponentProp:!0,externalForwardedProps:Nt,ownerState:st}),[hn,xn]=Gi("paper",{elementType:sN,shouldForwardComponentProp:!0,externalForwardedProps:Nt,ownerState:st,className:Sn(et.paper,we.className)}),[Le,Dn]=Gi("container",{elementType:oN,externalForwardedProps:Nt,ownerState:st,className:Sn(et.container)}),[pn,zn]=Gi("transition",{elementType:j1,externalForwardedProps:Nt,ownerState:st,additionalProps:{appear:!0,in:ie,timeout:ke,role:"presentation"}});return _e.jsx(gn,{closeAfterTransition:!0,slots:{backdrop:$t},slotProps:{backdrop:{transitionDuration:ke,as:F,...Ut}},disableEscapeKeyDown:te,onClose:se,open:ie,onClick:at,...Mt,...Xe,children:_e.jsx(pn,{...zn,children:_e.jsx(Le,{onMouseDown:zt,...Dn,children:_e.jsx(hn,{as:ce,elevation:24,role:"dialog","aria-describedby":T,"aria-labelledby":Ye,"aria-modal":I,...xn,children:_e.jsx(hP.Provider,{value:Bt,children:G})})})})})});function aN(n){return sr("MuiDialogActions",n)}ar("MuiDialogActions",["root","spacing"]);const lN=n=>{const{classes:r,disableSpacing:s}=n;return lr({root:["root",!s&&"spacing"]},aN,r)},cN=Jt("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,!s.disableSpacing&&r.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:n})=>!n.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Fv=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDialogActions"}),{className:m,disableSpacing:y=!1,...T}=u,i={...u,disableSpacing:y},I=lN(i);return _e.jsx(cN,{className:Sn(I.root,m),ownerState:i,ref:s,...T})});function uN(n){return sr("MuiDialogContent",n)}ar("MuiDialogContent",["root","dividers"]);function dN(n){return sr("MuiDialogTitle",n)}const hN=ar("MuiDialogTitle",["root"]),pN=n=>{const{classes:r,dividers:s}=n;return lr({root:["root",s&&"dividers"]},uN,r)},fN=Jt("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.dividers&&r.dividers]}})(rr(({theme:n})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:r})=>r.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(n.vars||n).palette.divider}`,borderBottom:`1px solid ${(n.vars||n).palette.divider}`}},{props:({ownerState:r})=>!r.dividers,style:{[`.${hN.root} + &`]:{paddingTop:0}}}]}))),pP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDialogContent"}),{className:m,dividers:y=!1,...T}=u,i={...u,dividers:y},I=pN(i);return _e.jsx(fN,{className:Sn(I.root,m),ownerState:i,ref:s,...T})});function mN(n){return sr("MuiDialogContentText",n)}ar("MuiDialogContentText",["root"]);const gN=n=>{const{classes:r}=n,u=lr({root:["root"]},mN,r);return{...r,...u}},_N=Jt(so,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(n,r)=>r.root})({}),fP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDialogContentText"}),{children:m,className:y,...T}=u,i=gN(T);return _e.jsx(_N,{component:"p",variant:"body1",color:"textSecondary",ref:s,ownerState:T,className:Sn(i.root,y),...u,classes:i})}),yN=n=>{const{classes:r}=n;return lr({root:["root"]},dN,r)},vN=Jt(so,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(n,r)=>r.root})({padding:"16px 24px",flex:"0 0 auto"}),mP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDialogTitle"}),{className:m,id:y,...T}=u,i=u,I=yN(i),{titleId:F=y}=fe.useContext(hP);return _e.jsx(vN,{component:"h2",className:Sn(I.root,m),ownerState:i,ref:s,variant:"h6",id:y??F,...T})});function xN(n){return sr("MuiDivider",n)}const RC=ar("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),bN=n=>{const{absolute:r,children:s,classes:u,flexItem:m,light:y,orientation:T,textAlign:i,variant:I}=n;return lr({root:["root",r&&"absolute",I,y&&"light",T==="vertical"&&"vertical",m&&"flexItem",s&&"withChildren",s&&T==="vertical"&&"withChildrenVertical",i==="right"&&T!=="vertical"&&"textAlignRight",i==="left"&&T!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",T==="vertical"&&"wrapperVertical"]},xN,u)},wN=Jt("div",{name:"MuiDivider",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.absolute&&r.absolute,r[s.variant],s.light&&r.light,s.orientation==="vertical"&&r.vertical,s.flexItem&&r.flexItem,s.children&&r.withChildren,s.children&&s.orientation==="vertical"&&r.withChildrenVertical,s.textAlign==="right"&&s.orientation!=="vertical"&&r.textAlignRight,s.textAlign==="left"&&s.orientation!=="vertical"&&r.textAlignLeft]}})(rr(({theme:n})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(n.vars||n).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:n.vars?`rgba(${n.vars.palette.dividerChannel} / 0.08)`:Oi(n.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:n.spacing(2),marginRight:n.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:n.spacing(1),marginBottom:n.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:r})=>!!r.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:r})=>r.children&&r.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(n.vars||n).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:r})=>r.orientation==="vertical"&&r.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(n.vars||n).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:r})=>r.textAlign==="right"&&r.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:r})=>r.textAlign==="left"&&r.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),SN=Jt("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.wrapper,s.orientation==="vertical"&&r.wrapperVertical]}})(rr(({theme:n})=>({display:"inline-block",paddingLeft:`calc(${n.spacing(1)} * 1.2)`,paddingRight:`calc(${n.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${n.spacing(1)} * 1.2)`,paddingBottom:`calc(${n.spacing(1)} * 1.2)`}}]}))),U1=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDivider"}),{absolute:m=!1,children:y,className:T,orientation:i="horizontal",component:I=y||i==="vertical"?"div":"hr",flexItem:F=!1,light:B=!1,role:G=I!=="hr"?"separator":void 0,textAlign:J="center",variant:te="fullWidth",...H}=u,j={...u,absolute:m,component:I,flexItem:F,light:B,orientation:i,role:G,textAlign:J,variant:te},ne=bN(j);return _e.jsx(wN,{as:I,className:Sn(ne.root,T),role:G,ref:s,ownerState:j,"aria-orientation":G==="separator"&&(I!=="hr"||i==="vertical")?i:void 0,...H,children:y?_e.jsx(SN,{className:ne.wrapper,ownerState:j,children:y}):null})});U1&&(U1.muiSkipListHighlight=!0);function TN(n,r,s){const u=r.getBoundingClientRect(),m=s&&s.getBoundingClientRect(),y=yu(r);let T;if(r.fakeTransform)T=r.fakeTransform;else{const F=y.getComputedStyle(r);T=F.getPropertyValue("-webkit-transform")||F.getPropertyValue("transform")}let i=0,I=0;if(T&&T!=="none"&&typeof T=="string"){const F=T.split("(")[1].split(")")[0].split(",");i=parseInt(F[4],10),I=parseInt(F[5],10)}return n==="left"?m?`translateX(${m.right+i-u.left}px)`:`translateX(${y.innerWidth+i-u.left}px)`:n==="right"?m?`translateX(-${u.right-m.left-i}px)`:`translateX(-${u.left+u.width-i}px)`:n==="up"?m?`translateY(${m.bottom+I-u.top}px)`:`translateY(${y.innerHeight+I-u.top}px)`:m?`translateY(-${u.top-m.top+u.height-I}px)`:`translateY(-${u.top+u.height-I}px)`}function EN(n){return typeof n=="function"?n():n}function dv(n,r,s){const u=EN(s),m=TN(n,r,u);m&&(r.style.webkitTransform=m,r.style.transform=m)}const gP=fe.forwardRef(function(r,s){const u=Mp(),m={enter:u.transitions.easing.easeOut,exit:u.transitions.easing.sharp},y={enter:u.transitions.duration.enteringScreen,exit:u.transitions.duration.leavingScreen},{addEndListener:T,appear:i=!0,children:I,container:F,direction:B="down",easing:G=m,in:J,onEnter:te,onEntered:H,onEntering:j,onExit:ne,onExited:oe,onExiting:pe,style:se,timeout:ie=y,TransitionComponent:ce=vu,...we}=r,xe=fe.useRef(null),$e=ao(Cp(I),xe,s),Ze=at=>Ye=>{at&&(Ye===void 0?at(xe.current):at(xe.current,Ye))},ae=Ze((at,Ye)=>{dv(B,at,F),Aw(at),te&&te(at,Ye)}),ke=Ze((at,Ye)=>{const Bt=Qm({timeout:ie,style:se,easing:G},{mode:"enter"});at.style.webkitTransition=u.transitions.create("-webkit-transform",{...Bt}),at.style.transition=u.transitions.create("transform",{...Bt}),at.style.webkitTransform="none",at.style.transform="none",j&&j(at,Ye)}),ct=Ze(H),Xe=Ze(pe),st=Ze(at=>{const Ye=Qm({timeout:ie,style:se,easing:G},{mode:"exit"});at.style.webkitTransition=u.transitions.create("-webkit-transform",Ye),at.style.transition=u.transitions.create("transform",Ye),dv(B,at,F),ne&&ne(at)}),et=Ze(at=>{at.style.webkitTransition="",at.style.transition="",oe&&oe(at)}),gt=at=>{T&&T(xe.current,at)},zt=fe.useCallback(()=>{xe.current&&dv(B,xe.current,F)},[B,F]);return fe.useEffect(()=>{if(J||B==="down"||B==="right")return;const at=Tw(()=>{xe.current&&dv(B,xe.current,F)}),Ye=yu(xe.current);return Ye.addEventListener("resize",at),()=>{at.clear(),Ye.removeEventListener("resize",at)}},[B,J,F]),fe.useEffect(()=>{J||zt()},[J,zt]),_e.jsx(ce,{nodeRef:xe,onEnter:ae,onEntered:ct,onEntering:ke,onExit:st,onExited:et,onExiting:Xe,addEndListener:gt,appear:i,in:J,timeout:ie,...we,children:(at,{ownerState:Ye,...Bt})=>fe.cloneElement(I,{ref:$e,style:{visibility:at==="exited"&&!J?"hidden":void 0,...se,...I.props.style},...Bt})})});function CN(n){return sr("MuiDrawer",n)}ar("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const _P=(n,r)=>{const{ownerState:s}=n;return[r.root,(s.variant==="permanent"||s.variant==="persistent")&&r.docked,r.modal]},MN=n=>{const{classes:r,anchor:s,variant:u}=n,m={root:["root",`anchor${Yt(s)}`],docked:[(u==="permanent"||u==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Yt(s)}`,u!=="temporary"&&`paperAnchorDocked${Yt(s)}`]};return lr(m,CN,r)},IN=Jt(Nw,{name:"MuiDrawer",slot:"Root",overridesResolver:_P})(rr(({theme:n})=>({zIndex:(n.vars||n).zIndex.drawer}))),kC=Jt("div",{shouldForwardProp:ta,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:_P})({flex:"0 0 auto"}),AN=Jt(xu,{name:"MuiDrawer",slot:"Paper",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.paper,r[`paperAnchor${Yt(s.anchor)}`],s.variant!=="temporary"&&r[`paperAnchorDocked${Yt(s.anchor)}`]]}})(rr(({theme:n})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(n.vars||n).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:r})=>r.anchor==="left"&&r.variant!=="temporary",style:{borderRight:`1px solid ${(n.vars||n).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="top"&&r.variant!=="temporary",style:{borderBottom:`1px solid ${(n.vars||n).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="right"&&r.variant!=="temporary",style:{borderLeft:`1px solid ${(n.vars||n).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="bottom"&&r.variant!=="temporary",style:{borderTop:`1px solid ${(n.vars||n).palette.divider}`}}]}))),yP={left:"right",right:"left",top:"down",bottom:"up"};function PN(n){return["left","right"].includes(n)}function RN({direction:n},r){return n==="rtl"&&PN(r)?yP[r]:r}const kN=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiDrawer"}),m=Mp(),y=cg(),T={enter:m.transitions.duration.enteringScreen,exit:m.transitions.duration.leavingScreen},{anchor:i="left",BackdropProps:I,children:F,className:B,elevation:G=16,hideBackdrop:J=!1,ModalProps:{BackdropProps:te,...H}={},onClose:j,open:ne=!1,PaperProps:oe={},SlideProps:pe,TransitionComponent:se=gP,transitionDuration:ie=T,variant:ce="temporary",...we}=u,xe=fe.useRef(!1);fe.useEffect(()=>{xe.current=!0},[]);const $e=RN({direction:y?"rtl":"ltr"},i),ae={...u,anchor:i,elevation:G,open:ne,variant:ce,...we},ke=MN(ae),ct=_e.jsx(AN,{elevation:ce==="temporary"?G:0,square:!0,...oe,className:Sn(ke.paper,oe.className),ownerState:ae,children:F});if(ce==="permanent")return _e.jsx(kC,{className:Sn(ke.root,ke.docked,B),ownerState:ae,ref:s,...we,children:ct});const Xe=_e.jsx(se,{in:ne,direction:yP[$e],timeout:ie,appear:xe.current,...pe,children:ct});return ce==="persistent"?_e.jsx(kC,{className:Sn(ke.root,ke.docked,B),ownerState:ae,ref:s,...we,children:Xe}):_e.jsx(IN,{BackdropProps:{...I,...te,transitionDuration:ie},className:Sn(ke.root,ke.modal,B),open:ne,ownerState:ae,onClose:j,hideBackdrop:J,ref:s,...we,...H,children:Xe})}),LN=n=>{const{classes:r,disableUnderline:s,startAdornment:u,endAdornment:m,size:y,hiddenLabel:T,multiline:i}=n,I={root:["root",!s&&"underline",u&&"adornedStart",m&&"adornedEnd",y==="small"&&`size${Yt(y)}`,T&&"hiddenLabel",i&&"multiline"],input:["input"]},F=lr(I,G5,r);return{...r,...F}},zN=Jt(Ax,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[...Mx(n,r),!s.disableUnderline&&r.underline]}})(rr(({theme:n})=>{const r=n.palette.mode==="light",s=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",u=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",m=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",y=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:n.vars?n.vars.palette.FilledInput.bg:u,borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),"&:hover":{backgroundColor:n.vars?n.vars.palette.FilledInput.hoverBg:m,"@media (hover: none)":{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:u}},[`&.${gf.focused}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:u},[`&.${gf.disabled}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.disabledBg:y},variants:[{props:({ownerState:T})=>!T.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${gf.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${gf.error}`]:{"&::before, &::after":{borderBottomColor:(n.vars||n).palette.error.main}},"&::before":{borderBottom:`1px solid ${n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${gf.disabled}, .${gf.error}):before`]:{borderBottom:`1px solid ${(n.vars||n).palette.text.primary}`},[`&.${gf.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(n.palette).filter(zo()).map(([T])=>{var i;return{props:{disableUnderline:!1,color:T},style:{"&::after":{borderBottom:`2px solid ${(i=(n.vars||n).palette[T])==null?void 0:i.main}`}}}}),{props:({ownerState:T})=>T.startAdornment,style:{paddingLeft:12}},{props:({ownerState:T})=>T.endAdornment,style:{paddingRight:12}},{props:({ownerState:T})=>T.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:T,size:i})=>T.multiline&&i==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:T})=>T.multiline&&T.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:T})=>T.multiline&&T.hiddenLabel&&T.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),DN=Jt(Px,{name:"MuiFilledInput",slot:"Input",overridesResolver:Ix})(rr(({theme:n})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...n.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:r})=>r.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}},{props:({ownerState:r})=>r.hiddenLabel&&r.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:r})=>r.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),Uw=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiFilledInput"}),{disableUnderline:m=!1,components:y={},componentsProps:T,fullWidth:i=!1,hiddenLabel:I,inputComponent:F="input",multiline:B=!1,slotProps:G,slots:J={},type:te="text",...H}=u,j={...u,disableUnderline:m,fullWidth:i,inputComponent:F,multiline:B,type:te},ne=LN(u),oe={root:{ownerState:j},input:{ownerState:j}},pe=G??T?ks(oe,G??T):oe,se=J.root??y.Root??zN,ie=J.input??y.Input??DN;return _e.jsx(Fw,{slots:{root:se,input:ie},slotProps:pe,fullWidth:i,inputComponent:F,multiline:B,ref:s,type:te,...H,classes:ne})});Uw.muiName="Input";function ON(n){return sr("MuiFormControl",n)}ar("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const FN=n=>{const{classes:r,margin:s,fullWidth:u}=n,m={root:["root",s!=="none"&&`margin${Yt(s)}`,u&&"fullWidth"]};return lr(m,ON,r)},BN=Jt("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`margin${Yt(s.margin)}`],s.fullWidth&&r.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),vP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiFormControl"}),{children:m,className:y,color:T="primary",component:i="div",disabled:I=!1,error:F=!1,focused:B,fullWidth:G=!1,hiddenLabel:J=!1,margin:te="none",required:H=!1,size:j="medium",variant:ne="outlined",...oe}=u,pe={...u,color:T,component:i,disabled:I,error:F,fullWidth:G,hiddenLabel:J,margin:te,required:H,size:j,variant:ne},se=FN(pe),[ie,ce]=fe.useState(()=>{let et=!1;return m&&fe.Children.forEach(m,gt=>{if(!L_(gt,["Input","Select"]))return;const zt=L_(gt,["Select"])?gt.props.input:gt;zt&&N5(zt.props)&&(et=!0)}),et}),[we,xe]=fe.useState(()=>{let et=!1;return m&&fe.Children.forEach(m,gt=>{L_(gt,["Input","Select"])&&(Xv(gt.props,!0)||Xv(gt.props.inputProps,!0))&&(et=!0)}),et}),[$e,Ze]=fe.useState(!1);I&&$e&&Ze(!1);const ae=B!==void 0&&!I?B:$e;let ke;fe.useRef(!1);const ct=fe.useCallback(()=>{xe(!0)},[]),Xe=fe.useCallback(()=>{xe(!1)},[]),st=fe.useMemo(()=>({adornedStart:ie,setAdornedStart:ce,color:T,disabled:I,error:F,filled:we,focused:ae,fullWidth:G,hiddenLabel:J,size:j,onBlur:()=>{Ze(!1)},onFocus:()=>{Ze(!0)},onEmpty:Xe,onFilled:ct,registerEffect:ke,required:H,variant:ne}),[ie,T,I,F,we,ae,G,J,ke,Xe,ct,H,j,ne]);return _e.jsx(Cx.Provider,{value:st,children:_e.jsx(BN,{as:i,ownerState:pe,className:Sn(se.root,y),ref:s,...oe,children:m})})});function NN(n){return sr("MuiFormControlLabel",n)}const I_=ar("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),jN=n=>{const{classes:r,disabled:s,labelPlacement:u,error:m,required:y}=n,T={root:["root",s&&"disabled",`labelPlacement${Yt(u)}`,m&&"error",y&&"required"],label:["label",s&&"disabled"],asterisk:["asterisk",m&&"error"]};return lr(T,NN,r)},UN=Jt("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[{[`& .${I_.label}`]:r.label},r.root,r[`labelPlacement${Yt(s.labelPlacement)}`]]}})(rr(({theme:n})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${I_.disabled}`]:{cursor:"default"},[`& .${I_.label}`]:{[`&.${I_.disabled}`]:{color:(n.vars||n).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:r})=>r==="start"||r==="top"||r==="bottom",style:{marginLeft:16}}]}))),$N=Jt("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(n,r)=>r.asterisk})(rr(({theme:n})=>({[`&.${I_.error}`]:{color:(n.vars||n).palette.error.main}}))),LC=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiFormControlLabel"}),{checked:m,className:y,componentsProps:T={},control:i,disabled:I,disableTypography:F,inputRef:B,label:G,labelPlacement:J="end",name:te,onChange:H,required:j,slots:ne={},slotProps:oe={},value:pe,...se}=u,ie=bu(),ce=I??i.props.disabled??(ie==null?void 0:ie.disabled),we=j??i.props.required,xe={disabled:ce,required:we};["checked","name","onChange","value","inputRef"].forEach(et=>{typeof i.props[et]>"u"&&typeof u[et]<"u"&&(xe[et]=u[et])});const $e=Ap({props:u,muiFormControl:ie,states:["error"]}),Ze={...u,disabled:ce,labelPlacement:J,required:we,error:$e.error},ae=jN(Ze),ke={slots:ne,slotProps:{...T,...oe}},[ct,Xe]=Gi("typography",{elementType:so,externalForwardedProps:ke,ownerState:Ze});let st=G;return st!=null&&st.type!==so&&!F&&(st=_e.jsx(ct,{component:"span",...Xe,className:Sn(ae.label,Xe==null?void 0:Xe.className),children:st})),_e.jsxs(UN,{className:Sn(ae.root,y),ownerState:Ze,ref:s,...se,children:[fe.cloneElement(i,xe),we?_e.jsxs("div",{children:[st,_e.jsxs($N,{ownerState:Ze,"aria-hidden":!0,className:ae.asterisk,children:["","*"]})]}):st]})});function VN(n){return sr("MuiFormGroup",n)}ar("MuiFormGroup",["root","row","error"]);const GN=n=>{const{classes:r,row:s,error:u}=n;return lr({root:["root",s&&"row",u&&"error"]},VN,r)},qN=Jt("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.row&&r.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),WN=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiFormGroup"}),{className:m,row:y=!1,...T}=u,i=bu(),I=Ap({props:u,muiFormControl:i,states:["error"]}),F={...u,row:y,error:I.error},B=GN(F);return _e.jsx(qN,{className:Sn(B.root,m),ownerState:F,ref:s,...T})});function HN(n){return sr("MuiFormHelperText",n)}const zC=ar("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var DC;const ZN=n=>{const{classes:r,contained:s,size:u,disabled:m,error:y,filled:T,focused:i,required:I}=n,F={root:["root",m&&"disabled",y&&"error",u&&`size${Yt(u)}`,s&&"contained",i&&"focused",T&&"filled",I&&"required"]};return lr(F,HN,r)},XN=Jt("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.size&&r[`size${Yt(s.size)}`],s.contained&&r.contained,s.filled&&r.filled]}})(rr(({theme:n})=>({color:(n.vars||n).palette.text.secondary,...n.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${zC.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${zC.error}`]:{color:(n.vars||n).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:r})=>r.contained,style:{marginLeft:14,marginRight:14}}]}))),YN=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiFormHelperText"}),{children:m,className:y,component:T="p",disabled:i,error:I,filled:F,focused:B,margin:G,required:J,variant:te,...H}=u,j=bu(),ne=Ap({props:u,muiFormControl:j,states:["variant","size","disabled","error","filled","focused","required"]}),oe={...u,component:T,contained:ne.variant==="filled"||ne.variant==="outlined",variant:ne.variant,size:ne.size,disabled:ne.disabled,error:ne.error,filled:ne.filled,focused:ne.focused,required:ne.required};delete oe.ownerState;const pe=ZN(oe);return _e.jsx(XN,{as:T,className:Sn(pe.root,y),ref:s,...H,ownerState:oe,children:m===" "?DC||(DC=_e.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):m})});function KN(n){return sr("MuiFormLabel",n)}const F_=ar("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),JN=n=>{const{classes:r,color:s,focused:u,disabled:m,error:y,filled:T,required:i}=n,I={root:["root",`color${Yt(s)}`,m&&"disabled",y&&"error",T&&"filled",u&&"focused",i&&"required"],asterisk:["asterisk",y&&"error"]};return lr(I,KN,r)},QN=Jt("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.color==="secondary"&&r.colorSecondary,s.filled&&r.filled]}})(rr(({theme:n})=>({color:(n.vars||n).palette.text.secondary,...n.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r},style:{[`&.${F_.focused}`]:{color:(n.vars||n).palette[r].main}}})),{props:{},style:{[`&.${F_.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${F_.error}`]:{color:(n.vars||n).palette.error.main}}}]}))),ej=Jt("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(n,r)=>r.asterisk})(rr(({theme:n})=>({[`&.${F_.error}`]:{color:(n.vars||n).palette.error.main}}))),tj=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiFormLabel"}),{children:m,className:y,color:T,component:i="label",disabled:I,error:F,filled:B,focused:G,required:J,...te}=u,H=bu(),j=Ap({props:u,muiFormControl:H,states:["color","required","focused","disabled","error","filled"]}),ne={...u,color:j.color||"primary",component:i,disabled:j.disabled,error:j.error,filled:j.filled,focused:j.focused,required:j.required},oe=JN(ne);return _e.jsxs(QN,{as:i,ownerState:ne,className:Sn(oe.root,y),ref:s,...te,children:[m,j.required&&_e.jsxs(ej,{ownerState:ne,"aria-hidden":!0,className:oe.asterisk,children:["","*"]})]})});function $1(n){return`scale(${n}, ${n**2})`}const nj={entering:{opacity:1,transform:$1(1)},entered:{opacity:1,transform:"none"}},gb=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),X_=fe.forwardRef(function(r,s){const{addEndListener:u,appear:m=!0,children:y,easing:T,in:i,onEnter:I,onEntered:F,onEntering:B,onExit:G,onExited:J,onExiting:te,style:H,timeout:j="auto",TransitionComponent:ne=vu,...oe}=r,pe=Cf(),se=fe.useRef(),ie=Mp(),ce=fe.useRef(null),we=ao(ce,Cp(y),s),xe=et=>gt=>{if(et){const zt=ce.current;gt===void 0?et(zt):et(zt,gt)}},$e=xe(B),Ze=xe((et,gt)=>{Aw(et);const{duration:zt,delay:at,easing:Ye}=Qm({style:H,timeout:j,easing:T},{mode:"enter"});let Bt;j==="auto"?(Bt=ie.transitions.getAutoHeightDuration(et.clientHeight),se.current=Bt):Bt=zt,et.style.transition=[ie.transitions.create("opacity",{duration:Bt,delay:at}),ie.transitions.create("transform",{duration:gb?Bt:Bt*.666,delay:at,easing:Ye})].join(","),I&&I(et,gt)}),ae=xe(F),ke=xe(te),ct=xe(et=>{const{duration:gt,delay:zt,easing:at}=Qm({style:H,timeout:j,easing:T},{mode:"exit"});let Ye;j==="auto"?(Ye=ie.transitions.getAutoHeightDuration(et.clientHeight),se.current=Ye):Ye=gt,et.style.transition=[ie.transitions.create("opacity",{duration:Ye,delay:zt}),ie.transitions.create("transform",{duration:gb?Ye:Ye*.666,delay:gb?zt:zt||Ye*.333,easing:at})].join(","),et.style.opacity=0,et.style.transform=$1(.75),G&&G(et)}),Xe=xe(J),st=et=>{j==="auto"&&pe.start(se.current||0,et),u&&u(ce.current,et)};return _e.jsx(ne,{appear:m,in:i,nodeRef:ce,onEnter:Ze,onEntered:ae,onEntering:$e,onExit:ct,onExited:Xe,onExiting:ke,addEndListener:st,timeout:j==="auto"?null:j,...oe,children:(et,{ownerState:gt,...zt})=>fe.cloneElement(y,{style:{opacity:0,transform:$1(.75),visibility:et==="exited"&&!i?"hidden":void 0,...nj[et],...H,...y.props.style},ref:we,...zt})})});X_&&(X_.muiSupportAuto=!0);function rj(n){return sr("MuiImageList",n)}ar("MuiImageList",["root","masonry","quilted","standard","woven"]);const xP=fe.createContext({}),ij=n=>{const{classes:r,variant:s}=n;return lr({root:["root",s]},rj,r)},oj=Jt("ul",{name:"MuiImageList",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.variant]]}})({display:"grid",overflowY:"auto",listStyle:"none",padding:0,WebkitOverflowScrolling:"touch",variants:[{props:{variant:"masonry"},style:{display:"block"}}]}),$w=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiImageList"}),{children:m,className:y,cols:T=2,component:i="ul",rowHeight:I="auto",gap:F=4,style:B,variant:G="standard",...J}=u,te=fe.useMemo(()=>({rowHeight:I,gap:F,variant:G}),[I,F,G]),H=G==="masonry"?{columnCount:T,columnGap:F,...B}:{gridTemplateColumns:`repeat(${T}, 1fr)`,gap:F,...B},j={...u,component:i,gap:F,rowHeight:I,variant:G},ne=ij(j);return _e.jsx(oj,{as:i,className:Sn(ne.root,ne[G],y),ref:s,style:H,ownerState:j,...J,children:_e.jsx(xP.Provider,{value:te,children:m})})});function sj(n){return sr("MuiImageListItem",n)}const _b=ar("MuiImageListItem",["root","img","standard","woven","masonry","quilted"]),aj=n=>{const{classes:r,variant:s}=n;return lr({root:["root",s],img:["img"]},sj,r)},lj=Jt("li",{name:"MuiImageListItem",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[{[`& .${_b.img}`]:r.img},r.root,r[s.variant]]}})({display:"block",position:"relative",[`& .${_b.img}`]:{objectFit:"cover",width:"100%",height:"100%",display:"block"},variants:[{props:{variant:"standard"},style:{display:"flex",flexDirection:"column"}},{props:{variant:"woven"},style:{height:"100%",alignSelf:"center","&:nth-of-type(even)":{height:"70%"}}},{props:{variant:"standard"},style:{[`& .${_b.img}`]:{height:"auto",flexGrow:1}}}]}),Rx=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiImageListItem"}),{children:m,className:y,cols:T=1,component:i="li",rows:I=1,style:F,...B}=u,{rowHeight:G="auto",gap:J,variant:te}=fe.useContext(xP);let H="auto";te==="woven"?H=void 0:G!=="auto"&&(H=G*I+J*(I-1));const j={...u,cols:T,component:i,gap:J,rowHeight:G,rows:I,variant:te},ne=aj(j);return _e.jsx(lj,{as:i,className:Sn(ne.root,ne[te],y),ref:s,style:{height:H,gridColumnEnd:te!=="masonry"?`span ${T}`:void 0,gridRowEnd:te!=="masonry"?`span ${I}`:void 0,marginBottom:te==="masonry"?J:void 0,breakInside:te==="masonry"?"avoid":void 0,...F},ownerState:j,...B,children:fe.Children.map(m,oe=>fe.isValidElement(oe)?oe.type==="img"||L_(oe,["Image"])?fe.cloneElement(oe,{className:Sn(ne.img,oe.props.className)}):oe:null)})});function cj(n){return sr("MuiImageListItemBar",n)}ar("MuiImageListItemBar",["root","positionBottom","positionTop","positionBelow","actionPositionLeft","actionPositionRight","titleWrap","titleWrapBottom","titleWrapTop","titleWrapBelow","titleWrapActionPosLeft","titleWrapActionPosRight","title","subtitle","actionIcon","actionIconActionPosLeft","actionIconActionPosRight"]);const uj=n=>{const{classes:r,position:s,actionIcon:u,actionPosition:m}=n,y={root:["root",`position${Yt(s)}`,`actionPosition${Yt(m)}`],titleWrap:["titleWrap",`titleWrap${Yt(s)}`,u&&`titleWrapActionPos${Yt(m)}`],title:["title"],subtitle:["subtitle"],actionIcon:["actionIcon",`actionIconActionPos${Yt(m)}`]};return lr(y,cj,r)},dj=Jt("div",{name:"MuiImageListItemBar",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`position${Yt(s.position)}`]]}})(rr(({theme:n})=>({position:"absolute",left:0,right:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",fontFamily:n.typography.fontFamily,variants:[{props:{position:"bottom"},style:{bottom:0}},{props:{position:"top"},style:{top:0}},{props:{position:"below"},style:{position:"relative",background:"transparent",alignItems:"normal"}}]}))),hj=Jt("div",{name:"MuiImageListItemBar",slot:"TitleWrap",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.titleWrap,r[`titleWrap${Yt(s.position)}`],s.actionIcon&&r[`titleWrapActionPos${Yt(s.actionPosition)}`]]}})(rr(({theme:n})=>({flexGrow:1,padding:"12px 16px",color:(n.vars||n).palette.common.white,overflow:"hidden",variants:[{props:{position:"below"},style:{padding:"6px 0 12px",color:"inherit"}},{props:({ownerState:r})=>r.actionIcon&&r.actionPosition==="left",style:{paddingLeft:0}},{props:({ownerState:r})=>r.actionIcon&&r.actionPosition==="right",style:{paddingRight:0}}]}))),pj=Jt("div",{name:"MuiImageListItemBar",slot:"Title",overridesResolver:(n,r)=>r.title})(rr(({theme:n})=>({fontSize:n.typography.pxToRem(16),lineHeight:"24px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}))),fj=Jt("div",{name:"MuiImageListItemBar",slot:"Subtitle",overridesResolver:(n,r)=>r.subtitle})(rr(({theme:n})=>({fontSize:n.typography.pxToRem(12),lineHeight:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}))),mj=Jt("div",{name:"MuiImageListItemBar",slot:"ActionIcon",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.actionIcon,r[`actionIconActionPos${Yt(s.actionPosition)}`]]}})({variants:[{props:{actionPosition:"left"},style:{order:-1}}]}),Y_=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiImageListItemBar"}),{actionIcon:m,actionPosition:y="right",className:T,subtitle:i,title:I,position:F="bottom",...B}=u,G={...u,position:F,actionPosition:y},J=uj(G);return _e.jsxs(dj,{ownerState:G,className:Sn(J.root,T),ref:s,...B,children:[_e.jsxs(hj,{ownerState:G,className:J.titleWrap,children:[_e.jsx(pj,{className:J.title,children:I}),i?_e.jsx(fj,{className:J.subtitle,children:i}):null]}),m?_e.jsx(mj,{ownerState:G,className:J.actionIcon,children:m}):null]})}),gj=n=>{const{classes:r,disableUnderline:s}=n,m=lr({root:["root",!s&&"underline"],input:["input"]},$5,r);return{...r,...m}},_j=Jt(Ax,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiInput",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[...Mx(n,r),!s.disableUnderline&&r.underline]}})(rr(({theme:n})=>{let s=n.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(s=`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`),{position:"relative",variants:[{props:({ownerState:u})=>u.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:u})=>!u.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${s_.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${s_.error}`]:{"&::before, &::after":{borderBottomColor:(n.vars||n).palette.error.main}},"&::before":{borderBottom:`1px solid ${s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${s_.disabled}, .${s_.error}):before`]:{borderBottom:`2px solid ${(n.vars||n).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${s}`}},[`&.${s_.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(n.palette).filter(zo()).map(([u])=>({props:{color:u,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(n.vars||n).palette[u].main}`}}}))]}})),yj=Jt(Px,{name:"MuiInput",slot:"Input",overridesResolver:Ix})({}),Vw=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiInput"}),{disableUnderline:m=!1,components:y={},componentsProps:T,fullWidth:i=!1,inputComponent:I="input",multiline:F=!1,slotProps:B,slots:G={},type:J="text",...te}=u,H=gj(u),ne={root:{ownerState:{disableUnderline:m}}},oe=B??T?ks(B??T,ne):ne,pe=G.root??y.Root??_j,se=G.input??y.Input??yj;return _e.jsx(Fw,{slots:{root:pe,input:se},slotProps:oe,fullWidth:i,inputComponent:I,multiline:F,ref:s,type:J,...te,classes:H})});Vw.muiName="Input";function vj(n){return sr("MuiInputAdornment",n)}const OC=ar("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var FC;const xj=(n,r)=>{const{ownerState:s}=n;return[r.root,r[`position${Yt(s.position)}`],s.disablePointerEvents===!0&&r.disablePointerEvents,r[s.variant]]},bj=n=>{const{classes:r,disablePointerEvents:s,hiddenLabel:u,position:m,size:y,variant:T}=n,i={root:["root",s&&"disablePointerEvents",m&&`position${Yt(m)}`,T,u&&"hiddenLabel",y&&`size${Yt(y)}`]};return lr(i,vj,r)},wj=Jt("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:xj})(rr(({theme:n})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(n.vars||n).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${OC.positionStart}&:not(.${OC.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),Gw=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiInputAdornment"}),{children:m,className:y,component:T="div",disablePointerEvents:i=!1,disableTypography:I=!1,position:F,variant:B,...G}=u,J=bu()||{};let te=B;B&&J.variant,te||(te=J.variant);const H={...u,hiddenLabel:J.hiddenLabel,size:J.size,disablePointerEvents:i,position:F,variant:te},j=bj(H);return _e.jsx(Cx.Provider,{value:null,children:_e.jsx(wj,{as:T,ownerState:H,className:Sn(j.root,y),ref:s,...G,children:typeof m=="string"&&!I?_e.jsx(so,{color:"textSecondary",children:m}):_e.jsxs(fe.Fragment,{children:[F==="start"?FC||(FC=_e.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):null,m]})})})});function Sj(n){return sr("MuiInputLabel",n)}ar("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Tj=n=>{const{classes:r,formControl:s,size:u,shrink:m,disableAnimation:y,variant:T,required:i}=n,I={root:["root",s&&"formControl",!y&&"animated",m&&"shrink",u&&u!=="normal"&&`size${Yt(u)}`,T],asterisk:[i&&"asterisk"]},F=lr(I,Sj,r);return{...r,...F}},Ej=Jt(tj,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[{[`& .${F_.asterisk}`]:r.asterisk},r.root,s.formControl&&r.formControl,s.size==="small"&&r.sizeSmall,s.shrink&&r.shrink,!s.disableAnimation&&r.animated,s.focused&&r.focused,r[s.variant]]}})(rr(({theme:n})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:r})=>r.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:r})=>r.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:r})=>!r.disableAnimation,style:{transition:n.transitions.create(["color","transform","max-width"],{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:r,ownerState:s})=>r==="filled"&&s.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:r,ownerState:s,size:u})=>r==="filled"&&s.shrink&&u==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:r,ownerState:s})=>r==="outlined"&&s.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),Cj=fe.forwardRef(function(r,s){const u=gr({name:"MuiInputLabel",props:r}),{disableAnimation:m=!1,margin:y,shrink:T,variant:i,className:I,...F}=u,B=bu();let G=T;typeof G>"u"&&B&&(G=B.filled||B.focused||B.adornedStart);const J=Ap({props:u,muiFormControl:B,states:["size","variant","required","focused"]}),te={...u,disableAnimation:m,formControl:B,shrink:G,size:J.size,variant:J.variant,required:J.required,focused:J.focused},H=Tj(te);return _e.jsx(Ej,{"data-shrink":G,ref:s,className:Sn(H.root,I),...F,ownerState:te,classes:H})}),Yv=fe.createContext({});function Mj(n){return sr("MuiList",n)}ar("MuiList",["root","padding","dense","subheader"]);const Ij=n=>{const{classes:r,disablePadding:s,dense:u,subheader:m}=n;return lr({root:["root",!s&&"padding",u&&"dense",m&&"subheader"]},Mj,r)},Aj=Jt("ul",{name:"MuiList",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,!s.disablePadding&&r.padding,s.dense&&r.dense,s.subheader&&r.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:n})=>!n.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:n})=>n.subheader,style:{paddingTop:0}}]}),Pj=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiList"}),{children:m,className:y,component:T="ul",dense:i=!1,disablePadding:I=!1,subheader:F,...B}=u,G=fe.useMemo(()=>({dense:i}),[i]),J={...u,component:T,dense:i,disablePadding:I},te=Ij(J);return _e.jsx(Yv.Provider,{value:G,children:_e.jsxs(Aj,{as:T,className:Sn(te.root,y),ref:s,ownerState:J,...B,children:[F,m]})})});function Rj(n){return sr("MuiListItemIcon",n)}const BC=ar("MuiListItemIcon",["root","alignItemsFlexStart"]),kj=n=>{const{alignItems:r,classes:s}=n;return lr({root:["root",r==="flex-start"&&"alignItemsFlexStart"]},Rj,s)},Lj=Jt("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.alignItems==="flex-start"&&r.alignItemsFlexStart]}})(rr(({theme:n})=>({minWidth:56,color:(n.vars||n).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),NC=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiListItemIcon"}),{className:m,...y}=u,T=fe.useContext(Yv),i={...u,alignItems:T.alignItems},I=kj(i);return _e.jsx(Lj,{className:Sn(I.root,m),ownerState:i,ref:s,...y})}),jC=ar("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function yb(n,r,s){return n===r?n.firstChild:r&&r.nextElementSibling?r.nextElementSibling:s?null:n.firstChild}function UC(n,r,s){return n===r?s?n.firstChild:n.lastChild:r&&r.previousElementSibling?r.previousElementSibling:s?null:n.lastChild}function bP(n,r){if(r===void 0)return!0;let s=n.innerText;return s===void 0&&(s=n.textContent),s=s.trim().toLowerCase(),s.length===0?!1:r.repeating?s[0]===r.keys[0]:s.startsWith(r.keys.join(""))}function a_(n,r,s,u,m,y){let T=!1,i=m(n,r,r?s:!1);for(;i;){if(i===n.firstChild){if(T)return!1;T=!0}const I=u?!1:i.disabled||i.getAttribute("aria-disabled")==="true";if(!i.hasAttribute("tabindex")||!bP(i,y)||I)i=m(n,i,s);else return i.focus(),!0}return!1}const zj=fe.forwardRef(function(r,s){const{actions:u,autoFocus:m=!1,autoFocusItem:y=!1,children:T,className:i,disabledItemsFocusable:I=!1,disableListWrap:F=!1,onKeyDown:B,variant:G="selectedMenu",...J}=r,te=fe.useRef(null),H=fe.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});_u(()=>{m&&te.current.focus()},[m]),fe.useImperativeHandle(u,()=>({adjustStyleForScrollbar:(se,{direction:ie})=>{const ce=!te.current.style.width;if(se.clientHeight<te.current.clientHeight&&ce){const we=`${OA(yu(se))}px`;te.current.style[ie==="rtl"?"paddingLeft":"paddingRight"]=we,te.current.style.width=`calc(100% + ${we})`}return te.current}}),[]);const j=se=>{const ie=te.current,ce=se.key;if(se.ctrlKey||se.metaKey||se.altKey){B&&B(se);return}const xe=cs(ie).activeElement;if(ce==="ArrowDown")se.preventDefault(),a_(ie,xe,F,I,yb);else if(ce==="ArrowUp")se.preventDefault(),a_(ie,xe,F,I,UC);else if(ce==="Home")se.preventDefault(),a_(ie,null,F,I,yb);else if(ce==="End")se.preventDefault(),a_(ie,null,F,I,UC);else if(ce.length===1){const $e=H.current,Ze=ce.toLowerCase(),ae=performance.now();$e.keys.length>0&&(ae-$e.lastTime>500?($e.keys=[],$e.repeating=!0,$e.previousKeyMatched=!0):$e.repeating&&Ze!==$e.keys[0]&&($e.repeating=!1)),$e.lastTime=ae,$e.keys.push(Ze);const ke=xe&&!$e.repeating&&bP(xe,$e);$e.previousKeyMatched&&(ke||a_(ie,xe,!1,I,yb,$e))?se.preventDefault():$e.previousKeyMatched=!1}B&&B(se)},ne=ao(te,s);let oe=-1;fe.Children.forEach(T,(se,ie)=>{if(!fe.isValidElement(se)){oe===ie&&(oe+=1,oe>=T.length&&(oe=-1));return}se.props.disabled||(G==="selectedMenu"&&se.props.selected||oe===-1)&&(oe=ie),oe===ie&&(se.props.disabled||se.props.muiSkipListHighlight||se.type.muiSkipListHighlight)&&(oe+=1,oe>=T.length&&(oe=-1))});const pe=fe.Children.map(T,(se,ie)=>{if(ie===oe){const ce={};return y&&(ce.autoFocus=!0),se.props.tabIndex===void 0&&G==="selectedMenu"&&(ce.tabIndex=0),fe.cloneElement(se,ce)}return se});return _e.jsx(Pj,{role:"menu",ref:ne,className:i,onKeyDown:j,tabIndex:m?0:-1,...J,children:pe})});function Dj(n){return sr("MuiPopover",n)}ar("MuiPopover",["root","paper"]);function $C(n,r){let s=0;return typeof r=="number"?s=r:r==="center"?s=n.height/2:r==="bottom"&&(s=n.height),s}function VC(n,r){let s=0;return typeof r=="number"?s=r:r==="center"?s=n.width/2:r==="right"&&(s=n.width),s}function GC(n){return[n.horizontal,n.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function vb(n){return typeof n=="function"?n():n}const Oj=n=>{const{classes:r}=n;return lr({root:["root"],paper:["paper"]},Dj,r)},Fj=Jt(Nw,{name:"MuiPopover",slot:"Root",overridesResolver:(n,r)=>r.root})({}),wP=Jt(xu,{name:"MuiPopover",slot:"Paper",overridesResolver:(n,r)=>r.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Bj=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiPopover"}),{action:m,anchorEl:y,anchorOrigin:T={vertical:"top",horizontal:"left"},anchorPosition:i,anchorReference:I="anchorEl",children:F,className:B,container:G,elevation:J=8,marginThreshold:te=16,open:H,PaperProps:j={},slots:ne={},slotProps:oe={},transformOrigin:pe={vertical:"top",horizontal:"left"},TransitionComponent:se=X_,transitionDuration:ie="auto",TransitionProps:{onEntering:ce,...we}={},disableScrollLock:xe=!1,...$e}=u,Ze=(oe==null?void 0:oe.paper)??j,ae=fe.useRef(),ke={...u,anchorOrigin:T,anchorReference:I,elevation:J,marginThreshold:te,externalPaperSlotProps:Ze,transformOrigin:pe,TransitionComponent:se,transitionDuration:ie,TransitionProps:we},ct=Oj(ke),Xe=fe.useCallback(()=>{if(I==="anchorPosition")return i;const Le=vb(y),pn=(Le&&Le.nodeType===1?Le:cs(ae.current).body).getBoundingClientRect();return{top:pn.top+$C(pn,T.vertical),left:pn.left+VC(pn,T.horizontal)}},[y,T.horizontal,T.vertical,i,I]),st=fe.useCallback(Le=>({vertical:$C(Le,pe.vertical),horizontal:VC(Le,pe.horizontal)}),[pe.horizontal,pe.vertical]),et=fe.useCallback(Le=>{const Dn={width:Le.offsetWidth,height:Le.offsetHeight},pn=st(Dn);if(I==="none")return{top:null,left:null,transformOrigin:GC(pn)};const zn=Xe();let _t=zn.top-pn.vertical,er=zn.left-pn.horizontal;const pr=_t+Dn.height,qn=er+Dn.width,_n=yu(vb(y)),ir=_n.innerHeight-te,cr=_n.innerWidth-te;if(te!==null&&_t<te){const Er=_t-te;_t-=Er,pn.vertical+=Er}else if(te!==null&&pr>ir){const Er=pr-ir;_t-=Er,pn.vertical+=Er}if(te!==null&&er<te){const Er=er-te;er-=Er,pn.horizontal+=Er}else if(qn>cr){const Er=qn-cr;er-=Er,pn.horizontal+=Er}return{top:`${Math.round(_t)}px`,left:`${Math.round(er)}px`,transformOrigin:GC(pn)}},[y,I,Xe,st,te]),[gt,zt]=fe.useState(H),at=fe.useCallback(()=>{const Le=ae.current;if(!Le)return;const Dn=et(Le);Dn.top!==null&&Le.style.setProperty("top",Dn.top),Dn.left!==null&&(Le.style.left=Dn.left),Le.style.transformOrigin=Dn.transformOrigin,zt(!0)},[et]);fe.useEffect(()=>(xe&&window.addEventListener("scroll",at),()=>window.removeEventListener("scroll",at)),[y,xe,at]);const Ye=(Le,Dn)=>{ce&&ce(Le,Dn),at()},Bt=()=>{zt(!1)};fe.useEffect(()=>{H&&at()}),fe.useImperativeHandle(m,()=>H?{updatePosition:()=>{at()}}:null,[H,at]),fe.useEffect(()=>{if(!H)return;const Le=Tw(()=>{at()}),Dn=yu(y);return Dn.addEventListener("resize",Le),()=>{Le.clear(),Dn.removeEventListener("resize",Le)}},[y,H,at]);let nt=ie;ie==="auto"&&!se.muiSupportAuto&&(nt=void 0);const Rt=G||(y?cs(vb(y)).body:void 0),Nt={slots:ne,slotProps:{...oe,paper:Ze}},[gn,Mt]=Gi("paper",{elementType:wP,externalForwardedProps:Nt,additionalProps:{elevation:J,className:Sn(ct.paper,Ze==null?void 0:Ze.className),style:gt?Ze.style:{...Ze.style,opacity:0}},ownerState:ke}),[$t,{slotProps:Ut,...hn}]=Gi("root",{elementType:Fj,externalForwardedProps:Nt,additionalProps:{slotProps:{backdrop:{invisible:!0}},container:Rt,open:H},ownerState:ke,className:Sn(ct.root,B)}),xn=ao(ae,Mt.ref);return _e.jsx($t,{...hn,...!Pf($t)&&{slotProps:Ut,disableScrollLock:xe},...$e,ref:s,children:_e.jsx(se,{appear:!0,in:H,onEntering:Ye,onExited:Bt,timeout:nt,...we,children:_e.jsx(gn,{...Mt,ref:xn,children:F})})})});function Nj(n){return sr("MuiMenu",n)}ar("MuiMenu",["root","paper","list"]);const jj={vertical:"top",horizontal:"right"},Uj={vertical:"top",horizontal:"left"},$j=n=>{const{classes:r}=n;return lr({root:["root"],paper:["paper"],list:["list"]},Nj,r)},Vj=Jt(Bj,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(n,r)=>r.root})({}),Gj=Jt(wP,{name:"MuiMenu",slot:"Paper",overridesResolver:(n,r)=>r.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),qj=Jt(zj,{name:"MuiMenu",slot:"List",overridesResolver:(n,r)=>r.list})({outline:0}),SP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiMenu"}),{autoFocus:m=!0,children:y,className:T,disableAutoFocusItem:i=!1,MenuListProps:I={},onClose:F,open:B,PaperProps:G={},PopoverClasses:J,transitionDuration:te="auto",TransitionProps:{onEntering:H,...j}={},variant:ne="selectedMenu",slots:oe={},slotProps:pe={},...se}=u,ie=cg(),ce={...u,autoFocus:m,disableAutoFocusItem:i,MenuListProps:I,onEntering:H,PaperProps:G,transitionDuration:te,TransitionProps:j,variant:ne},we=$j(ce),xe=m&&!i&&B,$e=fe.useRef(null),Ze=(gt,zt)=>{$e.current&&$e.current.adjustStyleForScrollbar(gt,{direction:ie?"rtl":"ltr"}),H&&H(gt,zt)},ae=gt=>{gt.key==="Tab"&&(gt.preventDefault(),F&&F(gt,"tabKeyDown"))};let ke=-1;fe.Children.map(y,(gt,zt)=>{fe.isValidElement(gt)&&(gt.props.disabled||(ne==="selectedMenu"&&gt.props.selected||ke===-1)&&(ke=zt))});const ct=oe.paper??Gj,Xe=pe.paper??G,st=rl({elementType:oe.root,externalSlotProps:pe.root,ownerState:ce,className:[we.root,T]}),et=rl({elementType:ct,externalSlotProps:Xe,ownerState:ce,className:we.paper});return _e.jsx(Vj,{onClose:F,anchorOrigin:{vertical:"bottom",horizontal:ie?"right":"left"},transformOrigin:ie?jj:Uj,slots:{paper:ct,root:oe.root},slotProps:{root:st,paper:et},open:B,ref:s,transitionDuration:te,TransitionProps:{onEntering:Ze,...j},ownerState:ce,...se,classes:J,children:_e.jsx(qj,{onKeyDown:ae,actions:$e,autoFocus:m&&(ke===-1||i),autoFocusItem:xe,variant:ne,...I,className:Sn(we.list,I.className),children:y})})});function Wj(n){return sr("MuiMenuItem",n)}const l_=ar("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Hj=(n,r)=>{const{ownerState:s}=n;return[r.root,s.dense&&r.dense,s.divider&&r.divider,!s.disableGutters&&r.gutters]},Zj=n=>{const{disabled:r,dense:s,divider:u,disableGutters:m,selected:y,classes:T}=n,I=lr({root:["root",s&&"dense",r&&"disabled",!m&&"gutters",u&&"divider",y&&"selected"]},Wj,T);return{...T,...I}},Xj=Jt(Tp,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Hj})(rr(({theme:n})=>({...n.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${l_.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Oi(n.palette.primary.main,n.palette.action.selectedOpacity),[`&.${l_.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:Oi(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}},[`&.${l_.selected}:hover`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Oi(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Oi(n.palette.primary.main,n.palette.action.selectedOpacity)}},[`&.${l_.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`&.${l_.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity},[`& + .${RC.root}`]:{marginTop:n.spacing(1),marginBottom:n.spacing(1)},[`& + .${RC.inset}`]:{marginLeft:52},[`& .${jC.root}`]:{marginTop:0,marginBottom:0},[`& .${jC.inset}`]:{paddingLeft:36},[`& .${BC.root}`]:{minWidth:36},variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(n.vars||n).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>!r.dense,style:{[n.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:r})=>r.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...n.typography.body2,[`& .${BC.root} svg`]:{fontSize:"1.25rem"}}}]}))),qC=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiMenuItem"}),{autoFocus:m=!1,component:y="li",dense:T=!1,divider:i=!1,disableGutters:I=!1,focusVisibleClassName:F,role:B="menuitem",tabIndex:G,className:J,...te}=u,H=fe.useContext(Yv),j=fe.useMemo(()=>({dense:T||H.dense||!1,disableGutters:I}),[H.dense,T,I]),ne=fe.useRef(null);_u(()=>{m&&ne.current&&ne.current.focus()},[m]);const oe={...u,dense:j.dense,divider:i,disableGutters:I},pe=Zj(u),se=ao(ne,s);let ie;return u.disabled||(ie=G!==void 0?G:-1),_e.jsx(Yv.Provider,{value:j,children:_e.jsx(Xj,{ref:se,role:B,tabIndex:ie,component:y,focusVisibleClassName:Sn(pe.focusVisible,F),className:Sn(pe.root,J),...te,ownerState:oe,classes:pe})})});function Yj(n){return sr("MuiNativeSelect",n)}const qw=ar("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Kj=n=>{const{classes:r,variant:s,disabled:u,multiple:m,open:y,error:T}=n,i={select:["select",s,u&&"disabled",m&&"multiple",T&&"error"],icon:["icon",`icon${Yt(s)}`,y&&"iconOpen",u&&"disabled"]};return lr(i,Yj,r)},TP=Jt("select")(({theme:n})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${qw.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(n.vars||n).palette.background.paper},variants:[{props:({ownerState:r})=>r.variant!=="filled"&&r.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(n.vars||n).shape.borderRadius,"&:focus":{borderRadius:(n.vars||n).shape.borderRadius},"&&&":{paddingRight:32}}}]})),Jj=Jt(TP,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:ta,overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.select,r[s.variant],s.error&&r.error,{[`&.${qw.multiple}`]:r.multiple}]}})({}),EP=Jt("svg")(({theme:n})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active,[`&.${qw.disabled}`]:{color:(n.vars||n).palette.action.disabled},variants:[{props:({ownerState:r})=>r.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),Qj=Jt(EP,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.icon,s.variant&&r[`icon${Yt(s.variant)}`],s.open&&r.iconOpen]}})({}),e6=fe.forwardRef(function(r,s){const{className:u,disabled:m,error:y,IconComponent:T,inputRef:i,variant:I="standard",...F}=r,B={...r,disabled:m,variant:I,error:y},G=Kj(B);return _e.jsxs(fe.Fragment,{children:[_e.jsx(Jj,{ownerState:B,className:Sn(G.select,u),disabled:m,ref:i||s,...F}),r.multiple?null:_e.jsx(Qj,{as:T,ownerState:B,className:G.icon})]})});var WC;const t6=Jt("fieldset",{shouldForwardProp:ta})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),n6=Jt("legend",{shouldForwardProp:ta})(rr(({theme:n})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:r})=>!r.withLabel,style:{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})}},{props:({ownerState:r})=>r.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:r})=>r.withLabel&&r.notched,style:{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}}]})));function r6(n){const{children:r,classes:s,className:u,label:m,notched:y,...T}=n,i=m!=null&&m!=="",I={...n,notched:y,withLabel:i};return _e.jsx(t6,{"aria-hidden":!0,className:u,ownerState:I,...T,children:_e.jsx(n6,{ownerState:I,children:i?_e.jsx("span",{children:m}):WC||(WC=_e.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const i6=n=>{const{classes:r}=n,u=lr({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},V5,r);return{...r,...u}},o6=Jt(Ax,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Mx})(rr(({theme:n})=>{const r=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(n.vars||n).shape.borderRadius,[`&:hover .${td.notchedOutline}`]:{borderColor:(n.vars||n).palette.text.primary},"@media (hover: none)":{[`&:hover .${td.notchedOutline}`]:{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${td.focused} .${td.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(n.palette).filter(zo()).map(([s])=>({props:{color:s},style:{[`&.${td.focused} .${td.notchedOutline}`]:{borderColor:(n.vars||n).palette[s].main}}})),{props:{},style:{[`&.${td.error} .${td.notchedOutline}`]:{borderColor:(n.vars||n).palette.error.main},[`&.${td.disabled} .${td.notchedOutline}`]:{borderColor:(n.vars||n).palette.action.disabled}}},{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:14}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:14}},{props:({ownerState:s})=>s.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:s,size:u})=>s.multiline&&u==="small",style:{padding:"8.5px 14px"}}]}})),s6=Jt(r6,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(n,r)=>r.notchedOutline})(rr(({theme:n})=>{const r=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:r}})),a6=Jt(Px,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Ix})(rr(({theme:n})=>({padding:"16.5px 14px",...!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...n.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:r})=>r.multiline,style:{padding:0}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}}]}))),Ww=fe.forwardRef(function(r,s){var u;const m=gr({props:r,name:"MuiOutlinedInput"}),{components:y={},fullWidth:T=!1,inputComponent:i="input",label:I,multiline:F=!1,notched:B,slots:G={},type:J="text",...te}=m,H=i6(m),j=bu(),ne=Ap({props:m,muiFormControl:j,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),oe={...m,color:ne.color||"primary",disabled:ne.disabled,error:ne.error,focused:ne.focused,formControl:j,fullWidth:T,hiddenLabel:ne.hiddenLabel,multiline:F,size:ne.size,type:J},pe=G.root??y.Root??o6,se=G.input??y.Input??a6;return _e.jsx(Fw,{slots:{root:pe,input:se},renderSuffix:ie=>_e.jsx(s6,{ownerState:oe,className:H.notchedOutline,label:I!=null&&I!==""&&ne.required?u||(u=_e.jsxs(fe.Fragment,{children:[I,"","*"]})):I,notched:typeof B<"u"?B:!!(ie.startAdornment||ie.filled||ie.focused)}),fullWidth:T,inputComponent:i,multiline:F,ref:s,type:J,...te,classes:{...H,notchedOutline:null}})});Ww.muiName="Input";const l6=Ti(_e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),c6=Ti(_e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),u6=Jt("span",{shouldForwardProp:ta})({position:"relative",display:"flex"}),d6=Jt(l6)({transform:"scale(1)"}),h6=Jt(c6)(rr(({theme:n})=>({left:0,position:"absolute",transform:"scale(0)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeIn,duration:n.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeOut,duration:n.transitions.duration.shortest})}}]})));function CP(n){const{checked:r=!1,classes:s={},fontSize:u}=n,m={...n,checked:r};return _e.jsxs(u6,{className:s.root,ownerState:m,children:[_e.jsx(d6,{fontSize:u,className:s.background,ownerState:m}),_e.jsx(h6,{fontSize:u,className:s.dot,ownerState:m})]})}const MP=fe.createContext(void 0);function p6(){return fe.useContext(MP)}function f6(n){return sr("MuiRadio",n)}const HC=ar("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),m6=n=>{const{classes:r,color:s,size:u}=n,m={root:["root",`color${Yt(s)}`,u!=="medium"&&`size${Yt(u)}`]};return{...r,...lr(m,f6,r)}},g6=Jt(LB,{shouldForwardProp:n=>ta(n)||n==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,s.size!=="medium"&&r[`size${Yt(s.size)}`],r[`color${Yt(s.color)}`]]}})(rr(({theme:n})=>({color:(n.vars||n).palette.text.secondary,[`&.${HC.disabled}`]:{color:(n.vars||n).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette.action.active,n.palette.action.hoverOpacity)}}},...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette[r].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Oi(n.palette[r].main,n.palette.action.hoverOpacity)}}})),...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r,disabled:!1},style:{[`&.${HC.checked}`]:{color:(n.vars||n).palette[r].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function _6(n,r){return typeof r=="object"&&r!==null?n===r:String(n)===String(r)}const ZC=_e.jsx(CP,{checked:!0}),XC=_e.jsx(CP,{}),YC=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiRadio"}),{checked:m,checkedIcon:y=ZC,color:T="primary",icon:i=XC,name:I,onChange:F,size:B="medium",className:G,disabled:J,disableRipple:te=!1,...H}=u,j=bu();let ne=J;j&&typeof ne>"u"&&(ne=j.disabled),ne??(ne=!1);const oe={...u,disabled:ne,disableRipple:te,color:T,size:B},pe=m6(oe),se=p6();let ie=m;const ce=I1(F,se&&se.onChange);let we=I;return se&&(typeof ie>"u"&&(ie=_6(se.value,u.value)),typeof we>"u"&&(we=se.name)),_e.jsx(g6,{type:"radio",icon:fe.cloneElement(i,{fontSize:XC.props.fontSize??B}),checkedIcon:fe.cloneElement(y,{fontSize:ZC.props.fontSize??B}),disabled:ne,ownerState:oe,classes:pe,name:we,checked:ie,onChange:ce,ref:s,className:Sn(pe.root,G),...H})});function y6(n){return sr("MuiRadioGroup",n)}ar("MuiRadioGroup",["root","row","error"]);const v6=n=>{const{classes:r,row:s,error:u}=n;return lr({root:["root",s&&"row",u&&"error"]},y6,r)},x6=fe.forwardRef(function(r,s){const{actions:u,children:m,className:y,defaultValue:T,name:i,onChange:I,value:F,...B}=r,G=fe.useRef(null),J=v6(r),[te,H]=Df({controlled:F,default:T,name:"RadioGroup"});fe.useImperativeHandle(u,()=>({focus:()=>{let pe=G.current.querySelector("input:not(:disabled):checked");pe||(pe=G.current.querySelector("input:not(:disabled)")),pe&&pe.focus()}}),[]);const j=ao(s,G),ne=ah(i),oe=fe.useMemo(()=>({name:ne,onChange(pe){H(pe.target.value),I&&I(pe,pe.target.value)},value:te}),[ne,I,H,te]);return _e.jsx(MP.Provider,{value:oe,children:_e.jsx(WN,{role:"radiogroup",ref:j,className:Sn(J.root,y),...B,children:m})})}),b6=Ti(_e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star"),w6=Ti(_e.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}),"StarBorder");function S6(n){return sr("MuiRating",n)}const c_=ar("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function T6(n){const r=n.toString().split(".")[1];return r?r.length:0}function xb(n,r){if(n==null)return n;const s=Math.round(n/r)*r;return Number(s.toFixed(T6(r)))}const E6=n=>{const{classes:r,size:s,readOnly:u,disabled:m,emptyValueFocused:y,focusVisible:T}=n,i={root:["root",`size${Yt(s)}`,m&&"disabled",T&&"focusVisible",u&&"readOnly"],label:["label","pristine"],labelEmptyValue:[y&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return lr(i,S6,r)},C6=Jt("span",{name:"MuiRating",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[{[`& .${c_.visuallyHidden}`]:r.visuallyHidden},r.root,r[`size${Yt(s.size)}`],s.readOnly&&r.readOnly]}})(rr(({theme:n})=>({display:"inline-flex",position:"relative",fontSize:n.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${c_.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${c_.focusVisible} .${c_.iconActive}`]:{outline:"1px solid #999"},[`& .${c_.visuallyHidden}`]:BA,variants:[{props:{size:"small"},style:{fontSize:n.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:n.typography.pxToRem(30)}},{props:({ownerState:r})=>r.readOnly,style:{pointerEvents:"none"}}]}))),IP=Jt("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:n},r)=>[r.label,n.emptyValueFocused&&r.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:n})=>n.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),M6=Jt("span",{name:"MuiRating",slot:"Icon",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.icon,s.iconEmpty&&r.iconEmpty,s.iconFilled&&r.iconFilled,s.iconHover&&r.iconHover,s.iconFocus&&r.iconFocus,s.iconActive&&r.iconActive]}})(rr(({theme:n})=>({display:"flex",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:r})=>r.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:r})=>r.iconEmpty,style:{color:(n.vars||n).palette.action.disabled}}]}))),I6=Jt("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:n=>sy(n)&&n!=="iconActive",overridesResolver:(n,r)=>{const{iconActive:s}=n;return[r.decimal,s&&r.iconActive]}})({position:"relative",variants:[{props:({iconActive:n})=>n,style:{transform:"scale(1.2)"}}]});function A6(n){const{value:r,...s}=n;return _e.jsx("span",{...s})}function KC(n){const{classes:r,disabled:s,emptyIcon:u,focus:m,getLabelText:y,highlightSelectedOnly:T,hover:i,icon:I,IconContainerComponent:F,isActive:B,itemValue:G,labelProps:J,name:te,onBlur:H,onChange:j,onClick:ne,onFocus:oe,readOnly:pe,ownerState:se,ratingValue:ie,ratingValueRounded:ce}=n,we=T?G===ie:G<=ie,xe=G<=i,$e=G<=m,Ze=G===ce,ae=`${te}-${ah()}`,ke=_e.jsx(M6,{as:F,value:G,className:Sn(r.icon,we?r.iconFilled:r.iconEmpty,xe&&r.iconHover,$e&&r.iconFocus,B&&r.iconActive),ownerState:{...se,iconEmpty:!we,iconFilled:we,iconHover:xe,iconFocus:$e,iconActive:B},children:u&&!we?u:I});return pe?_e.jsx("span",{...J,children:ke}):_e.jsxs(fe.Fragment,{children:[_e.jsxs(IP,{ownerState:{...se,emptyValueFocused:void 0},htmlFor:ae,...J,children:[ke,_e.jsx("span",{className:r.visuallyHidden,children:y(G)})]}),_e.jsx("input",{className:r.visuallyHidden,onFocus:oe,onBlur:H,onChange:j,onClick:ne,disabled:s,value:G,id:ae,type:"radio",name:te,checked:Ze})]})}const P6=_e.jsx(b6,{fontSize:"inherit"}),R6=_e.jsx(w6,{fontSize:"inherit"});function k6(n){return`${n||"0"} Star${n!==1?"s":""}`}const kx=fe.forwardRef(function(r,s){const u=gr({name:"MuiRating",props:r}),{component:m="span",className:y,defaultValue:T=null,disabled:i=!1,emptyIcon:I=R6,emptyLabelText:F="Empty",getLabelText:B=k6,highlightSelectedOnly:G=!1,icon:J=P6,IconContainerComponent:te=A6,max:H=5,name:j,onChange:ne,onChangeActive:oe,onMouseLeave:pe,onMouseMove:se,precision:ie=1,readOnly:ce=!1,size:we="medium",value:xe,...$e}=u,Ze=ah(j),[ae,ke]=Df({controlled:xe,default:T,name:"Rating"}),ct=xb(ae,ie),Xe=cg(),[{hover:st,focus:et},gt]=fe.useState({hover:-1,focus:-1});let zt=ct;st!==-1&&(zt=st),et!==-1&&(zt=et);const[at,Ye]=fe.useState(!1),Bt=fe.useRef(),nt=ao(Bt,s),Rt=pn=>{se&&se(pn);const zn=Bt.current,{right:_t,left:er,width:pr}=zn.getBoundingClientRect();let qn;Xe?qn=(_t-pn.clientX)/pr:qn=(pn.clientX-er)/pr;let _n=xb(H*qn+ie/2,ie);_n=Sf(_n,ie,H),gt(ir=>ir.hover===_n&&ir.focus===_n?ir:{hover:_n,focus:_n}),Ye(!1),oe&&st!==_n&&oe(pn,_n)},Nt=pn=>{pe&&pe(pn);const zn=-1;gt({hover:zn,focus:zn}),oe&&st!==zn&&oe(pn,zn)},gn=pn=>{let zn=pn.target.value===""?null:parseFloat(pn.target.value);st!==-1&&(zn=st),ke(zn),ne&&ne(pn,zn)},Mt=pn=>{pn.clientX===0&&pn.clientY===0||(gt({hover:-1,focus:-1}),ke(null),ne&&parseFloat(pn.target.value)===ct&&ne(pn,null))},$t=pn=>{Sp(pn.target)&&Ye(!0);const zn=parseFloat(pn.target.value);gt(_t=>({hover:_t.hover,focus:zn}))},Ut=pn=>{if(st!==-1)return;Sp(pn.target)||Ye(!1);const zn=-1;gt(_t=>({hover:_t.hover,focus:zn}))},[hn,xn]=fe.useState(!1),Le={...u,component:m,defaultValue:T,disabled:i,emptyIcon:I,emptyLabelText:F,emptyValueFocused:hn,focusVisible:at,getLabelText:B,icon:J,IconContainerComponent:te,max:H,precision:ie,readOnly:ce,size:we},Dn=E6(Le);return _e.jsxs(C6,{as:m,ref:nt,onMouseMove:Rt,onMouseLeave:Nt,className:Sn(Dn.root,y,ce&&"MuiRating-readOnly"),ownerState:Le,role:ce?"img":null,"aria-label":ce?B(zt):null,...$e,children:[Array.from(new Array(H)).map((pn,zn)=>{const _t=zn+1,er={classes:Dn,disabled:i,emptyIcon:I,focus:et,getLabelText:B,highlightSelectedOnly:G,hover:st,icon:J,IconContainerComponent:te,name:Ze,onBlur:Ut,onChange:gn,onClick:Mt,onFocus:$t,ratingValue:zt,ratingValueRounded:ct,readOnly:ce,ownerState:Le},pr=_t===Math.ceil(zt)&&(st!==-1||et!==-1);if(ie<1){const qn=Array.from(new Array(1/ie));return _e.jsx(I6,{className:Sn(Dn.decimal,pr&&Dn.iconActive),ownerState:Le,iconActive:pr,children:qn.map((_n,ir)=>{const cr=xb(_t-1+(ir+1)*ie,ie);return _e.jsx(KC,{...er,isActive:!1,itemValue:cr,labelProps:{style:qn.length-1===ir?{}:{width:cr===zt?`${(ir+1)*ie*100}%`:"0%",overflow:"hidden",position:"absolute"}}},cr)})},_t)}return _e.jsx(KC,{...er,isActive:pr,itemValue:_t},_t)}),!ce&&!i&&_e.jsxs(IP,{className:Sn(Dn.label,Dn.labelEmptyValue),ownerState:Le,children:[_e.jsx("input",{className:Dn.visuallyHidden,value:"",id:`${Ze}-empty`,type:"radio",name:Ze,checked:ct==null,onFocus:()=>xn(!0),onBlur:()=>xn(!1),onChange:gn}),_e.jsx("span",{className:Dn.visuallyHidden,children:F})]})]})});function AP(n){return sr("MuiSelect",n)}const u_=ar("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var JC;const L6=Jt(TP,{name:"MuiSelect",slot:"Select",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[{[`&.${u_.select}`]:r.select},{[`&.${u_.select}`]:r[s.variant]},{[`&.${u_.error}`]:r.error},{[`&.${u_.multiple}`]:r.multiple}]}})({[`&.${u_.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),z6=Jt(EP,{name:"MuiSelect",slot:"Icon",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.icon,s.variant&&r[`icon${Yt(s.variant)}`],s.open&&r.iconOpen]}})({}),D6=Jt("input",{shouldForwardProp:n=>sy(n)&&n!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(n,r)=>r.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function QC(n,r){return typeof r=="object"&&r!==null?n===r:String(n)===String(r)}function O6(n){return n==null||typeof n=="string"&&!n.trim()}const F6=n=>{const{classes:r,variant:s,disabled:u,multiple:m,open:y,error:T}=n,i={select:["select",s,u&&"disabled",m&&"multiple",T&&"error"],icon:["icon",`icon${Yt(s)}`,y&&"iconOpen",u&&"disabled"],nativeInput:["nativeInput"]};return lr(i,AP,r)},B6=fe.forwardRef(function(r,s){var qr;const{"aria-describedby":u,"aria-label":m,autoFocus:y,autoWidth:T,children:i,className:I,defaultOpen:F,defaultValue:B,disabled:G,displayEmpty:J,error:te=!1,IconComponent:H,inputRef:j,labelId:ne,MenuProps:oe={},multiple:pe,name:se,onBlur:ie,onChange:ce,onClose:we,onFocus:xe,onOpen:$e,open:Ze,readOnly:ae,renderValue:ke,required:ct,SelectDisplayProps:Xe={},tabIndex:st,type:et,value:gt,variant:zt="standard",...at}=r,[Ye,Bt]=Df({controlled:gt,default:B,name:"Select"}),[nt,Rt]=Df({controlled:Ze,default:F,name:"Select"}),Nt=fe.useRef(null),gn=fe.useRef(null),[Mt,$t]=fe.useState(null),{current:Ut}=fe.useRef(Ze!=null),[hn,xn]=fe.useState(),Le=ao(s,j),Dn=fe.useCallback(Yn=>{gn.current=Yn,Yn&&$t(Yn)},[]),pn=Mt==null?void 0:Mt.parentNode;fe.useImperativeHandle(Le,()=>({focus:()=>{gn.current.focus()},node:Nt.current,value:Ye}),[Ye]),fe.useEffect(()=>{F&&nt&&Mt&&!Ut&&(xn(T?null:pn.clientWidth),gn.current.focus())},[Mt,T]),fe.useEffect(()=>{y&&gn.current.focus()},[y]),fe.useEffect(()=>{if(!ne)return;const Yn=cs(gn.current).getElementById(ne);if(Yn){const Ar=()=>{getSelection().isCollapsed&&gn.current.focus()};return Yn.addEventListener("click",Ar),()=>{Yn.removeEventListener("click",Ar)}}},[ne]);const zn=(Yn,Ar)=>{Yn?$e&&$e(Ar):we&&we(Ar),Ut||(xn(T?null:pn.clientWidth),Rt(Yn))},_t=Yn=>{Yn.button===0&&(Yn.preventDefault(),gn.current.focus(),zn(!0,Yn))},er=Yn=>{zn(!1,Yn)},pr=fe.Children.toArray(i),qn=Yn=>{const Ar=pr.find(si=>si.props.value===Yn.target.value);Ar!==void 0&&(Bt(Ar.props.value),ce&&ce(Yn,Ar))},_n=Yn=>Ar=>{let si;if(Ar.currentTarget.hasAttribute("tabindex")){if(pe){si=Array.isArray(Ye)?Ye.slice():[];const $n=Ye.indexOf(Yn.props.value);$n===-1?si.push(Yn.props.value):si.splice($n,1)}else si=Yn.props.value;if(Yn.props.onClick&&Yn.props.onClick(Ar),Ye!==si&&(Bt(si),ce)){const $n=Ar.nativeEvent||Ar,Zi=new $n.constructor($n.type,$n);Object.defineProperty(Zi,"target",{writable:!0,value:{value:si,name:se}}),ce(Zi,Yn)}pe||zn(!1,Ar)}},ir=Yn=>{ae||[" ","ArrowUp","ArrowDown","Enter"].includes(Yn.key)&&(Yn.preventDefault(),zn(!0,Yn))},cr=Mt!==null&&nt,Er=Yn=>{!cr&&ie&&(Object.defineProperty(Yn,"target",{writable:!0,value:{value:Ye,name:se}}),ie(Yn))};delete at["aria-invalid"];let On,fi;const Dt=[];let Ft=!1;(Xv({value:Ye})||J)&&(ke?On=ke(Ye):Ft=!0);const sn=pr.map(Yn=>{if(!fe.isValidElement(Yn))return null;let Ar;if(pe){if(!Array.isArray(Ye))throw new Error(oh(2));Ar=Ye.some(si=>QC(si,Yn.props.value)),Ar&&Ft&&Dt.push(Yn.props.children)}else Ar=QC(Ye,Yn.props.value),Ar&&Ft&&(fi=Yn.props.children);return fe.cloneElement(Yn,{"aria-selected":Ar?"true":"false",onClick:_n(Yn),onKeyUp:si=>{si.key===" "&&si.preventDefault(),Yn.props.onKeyUp&&Yn.props.onKeyUp(si)},role:"option",selected:Ar,value:void 0,"data-value":Yn.props.value})});Ft&&(pe?Dt.length===0?On=null:On=Dt.reduce((Yn,Ar,si)=>(Yn.push(Ar),si<Dt.length-1&&Yn.push(", "),Yn),[]):On=fi);let Tn=hn;!T&&Ut&&Mt&&(Tn=pn.clientWidth);let Pn;typeof st<"u"?Pn=st:Pn=G?null:0;const ur=Xe.id||(se?`mui-component-select-${se}`:void 0),Bn={...r,variant:zt,value:Ye,open:cr,error:te},Hn=F6(Bn),Zr={...oe.PaperProps,...(qr=oe.slotProps)==null?void 0:qr.paper},Lr=ah();return _e.jsxs(fe.Fragment,{children:[_e.jsx(L6,{as:"div",ref:Dn,tabIndex:Pn,role:"combobox","aria-controls":cr?Lr:void 0,"aria-disabled":G?"true":void 0,"aria-expanded":cr?"true":"false","aria-haspopup":"listbox","aria-label":m,"aria-labelledby":[ne,ur].filter(Boolean).join(" ")||void 0,"aria-describedby":u,"aria-required":ct?"true":void 0,"aria-invalid":te?"true":void 0,onKeyDown:ir,onMouseDown:G||ae?null:_t,onBlur:Er,onFocus:xe,...Xe,ownerState:Bn,className:Sn(Xe.className,Hn.select,I),id:ur,children:O6(On)?JC||(JC=_e.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):On}),_e.jsx(D6,{"aria-invalid":te,value:Array.isArray(Ye)?Ye.join(","):Ye,name:se,ref:Nt,"aria-hidden":!0,onChange:qn,tabIndex:-1,disabled:G,className:Hn.nativeInput,autoFocus:y,required:ct,...at,ownerState:Bn}),_e.jsx(z6,{as:H,className:Hn.icon,ownerState:Bn}),_e.jsx(SP,{id:`menu-${se||""}`,anchorEl:pn,open:cr,onClose:er,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...oe,MenuListProps:{"aria-labelledby":ne,role:"listbox","aria-multiselectable":pe?"true":void 0,disableListWrap:!0,id:Lr,...oe.MenuListProps},slotProps:{...oe.slotProps,paper:{...Zr,style:{minWidth:Tn,...Zr!=null?Zr.style:null}}},children:sn})]})}),N6=n=>{const{classes:r}=n,u=lr({root:["root"]},AP,r);return{...r,...u}},Hw={name:"MuiSelect",overridesResolver:(n,r)=>r.root,shouldForwardProp:n=>ta(n)&&n!=="variant",slot:"Root"},j6=Jt(Vw,Hw)(""),U6=Jt(Ww,Hw)(""),$6=Jt(Uw,Hw)(""),PP=fe.forwardRef(function(r,s){const u=gr({name:"MuiSelect",props:r}),{autoWidth:m=!1,children:y,classes:T={},className:i,defaultOpen:I=!1,displayEmpty:F=!1,IconComponent:B=q5,id:G,input:J,inputProps:te,label:H,labelId:j,MenuProps:ne,multiple:oe=!1,native:pe=!1,onClose:se,onOpen:ie,open:ce,renderValue:we,SelectDisplayProps:xe,variant:$e="outlined",...Ze}=u,ae=pe?e6:B6,ke=bu(),ct=Ap({props:u,muiFormControl:ke,states:["variant","error"]}),Xe=ct.variant||$e,st={...u,variant:Xe,classes:T},et=N6(st),{root:gt,...zt}=et,at=J||{standard:_e.jsx(j6,{ownerState:st}),outlined:_e.jsx(U6,{label:H,ownerState:st}),filled:_e.jsx($6,{ownerState:st})}[Xe],Ye=ao(s,Cp(at));return _e.jsx(fe.Fragment,{children:fe.cloneElement(at,{inputComponent:ae,inputProps:{children:y,error:ct.error,IconComponent:B,variant:Xe,type:void 0,multiple:oe,...pe?{id:G}:{autoWidth:m,defaultOpen:I,displayEmpty:F,labelId:j,MenuProps:ne,onClose:se,onOpen:ie,open:ce,renderValue:we,SelectDisplayProps:{id:G,...xe}},...te,classes:te?ks(zt,te.classes):zt,...J?J.props.inputProps:{}},...(oe&&pe||F)&&Xe==="outlined"?{notched:!0}:{},ref:Ye,className:Sn(at.props.className,i,et.root),...!J&&{variant:Xe},...Ze})})});PP.muiName="Select";function V6(n,r,s=(u,m)=>u===m){return n.length===r.length&&n.every((u,m)=>s(u,r[m]))}const G6=2;function Vm(n,r,s,u,m){return s===1?Math.min(n+r,m):Math.max(n-r,u)}function RP(n,r){return n-r}function eM(n,r){const{index:s}=n.reduce((u,m,y)=>{const T=Math.abs(r-m);return u===null||T<u.distance||T===u.distance?{distance:T,index:y}:u},null)??{};return s}function hv(n,r){if(r.current!==void 0&&n.changedTouches){const s=n;for(let u=0;u<s.changedTouches.length;u+=1){const m=s.changedTouches[u];if(m.identifier===r.current)return{x:m.clientX,y:m.clientY}}return!1}return{x:n.clientX,y:n.clientY}}function Kv(n,r,s){return(n-r)*100/(s-r)}function q6(n,r,s){return(s-r)*n+r}function W6(n){if(Math.abs(n)<1){const s=n.toExponential().split("e-"),u=s[0].split(".")[1];return(u?u.length:0)+parseInt(s[1],10)}const r=n.toString().split(".")[1];return r?r.length:0}function H6(n,r,s){const u=Math.round((n-s)/r)*r+s;return Number(u.toFixed(W6(r)))}function tM({values:n,newValue:r,index:s}){const u=n.slice();return u[s]=r,u.sort(RP)}function pv({sliderRef:n,activeIndex:r,setActive:s}){var m,y,T;const u=cs(n.current);(!((m=n.current)!=null&&m.contains(u.activeElement))||Number((y=u==null?void 0:u.activeElement)==null?void 0:y.getAttribute("data-index"))!==r)&&((T=n.current)==null||T.querySelector(`[type="range"][data-index="${r}"]`).focus()),s&&s(r)}function fv(n,r){return typeof n=="number"&&typeof r=="number"?n===r:typeof n=="object"&&typeof r=="object"?V6(n,r):!1}const Z6={horizontal:{offset:n=>({left:`${n}%`}),leap:n=>({width:`${n}%`})},"horizontal-reverse":{offset:n=>({right:`${n}%`}),leap:n=>({width:`${n}%`})},vertical:{offset:n=>({bottom:`${n}%`}),leap:n=>({height:`${n}%`})}},X6=n=>n;let mv;function nM(){return mv===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?mv=CSS.supports("touch-action","none"):mv=!0),mv}function Y6(n){const{"aria-labelledby":r,defaultValue:s,disabled:u=!1,disableSwap:m=!1,isRtl:y=!1,marks:T=!1,max:i=100,min:I=0,name:F,onChange:B,onChangeCommitted:G,orientation:J="horizontal",rootRef:te,scale:H=X6,step:j=1,shiftStep:ne=10,tabIndex:oe,value:pe}=n,se=fe.useRef(void 0),[ie,ce]=fe.useState(-1),[we,xe]=fe.useState(-1),[$e,Ze]=fe.useState(!1),ae=fe.useRef(0),ke=fe.useRef(null),[ct,Xe]=Df({controlled:pe,default:s??I,name:"Slider"}),st=B&&((Ft,sn,Tn)=>{const Pn=Ft.nativeEvent||Ft,ur=new Pn.constructor(Pn.type,Pn);Object.defineProperty(ur,"target",{writable:!0,value:{value:sn,name:F}}),ke.current=sn,B(ur,sn,Tn)}),et=Array.isArray(ct);let gt=et?ct.slice().sort(RP):[ct];gt=gt.map(Ft=>Ft==null?I:Sf(Ft,I,i));const zt=T===!0&&j!==null?[...Array(Math.floor((i-I)/j)+1)].map((Ft,sn)=>({value:I+j*sn})):T||[],at=zt.map(Ft=>Ft.value),[Ye,Bt]=fe.useState(-1),nt=fe.useRef(null),Rt=ao(te,nt),Nt=Ft=>sn=>{var Pn;const Tn=Number(sn.currentTarget.getAttribute("data-index"));Sp(sn.target)&&Bt(Tn),xe(Tn),(Pn=Ft==null?void 0:Ft.onFocus)==null||Pn.call(Ft,sn)},gn=Ft=>sn=>{var Tn;Sp(sn.target)||Bt(-1),xe(-1),(Tn=Ft==null?void 0:Ft.onBlur)==null||Tn.call(Ft,sn)},Mt=(Ft,sn)=>{const Tn=Number(Ft.currentTarget.getAttribute("data-index")),Pn=gt[Tn],ur=at.indexOf(Pn);let Bn=sn;if(zt&&j==null){const Hn=at[at.length-1];Bn>Hn?Bn=Hn:Bn<at[0]?Bn=at[0]:Bn=Bn<Pn?at[ur-1]:at[ur+1]}if(Bn=Sf(Bn,I,i),et){m&&(Bn=Sf(Bn,gt[Tn-1]||-1/0,gt[Tn+1]||1/0));const Hn=Bn;Bn=tM({values:gt,newValue:Bn,index:Tn});let Zr=Tn;m||(Zr=Bn.indexOf(Hn)),pv({sliderRef:nt,activeIndex:Zr})}Xe(Bn),Bt(Tn),st&&!fv(Bn,ct)&&st(Ft,Bn,Tn),G&&G(Ft,ke.current??Bn)},$t=Ft=>sn=>{var Tn;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(sn.key)){sn.preventDefault();const Pn=Number(sn.currentTarget.getAttribute("data-index")),ur=gt[Pn];let Bn=null;if(j!=null){const Hn=sn.shiftKey?ne:j;switch(sn.key){case"ArrowUp":Bn=Vm(ur,Hn,1,I,i);break;case"ArrowRight":Bn=Vm(ur,Hn,y?-1:1,I,i);break;case"ArrowDown":Bn=Vm(ur,Hn,-1,I,i);break;case"ArrowLeft":Bn=Vm(ur,Hn,y?1:-1,I,i);break;case"PageUp":Bn=Vm(ur,ne,1,I,i);break;case"PageDown":Bn=Vm(ur,ne,-1,I,i);break;case"Home":Bn=I;break;case"End":Bn=i;break}}else if(zt){const Hn=at[at.length-1],Zr=at.indexOf(ur),Lr=[y?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],qr=[y?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];Lr.includes(sn.key)?Zr===0?Bn=at[0]:Bn=at[Zr-1]:qr.includes(sn.key)&&(Zr===at.length-1?Bn=Hn:Bn=at[Zr+1])}Bn!=null&&Mt(sn,Bn)}(Tn=Ft==null?void 0:Ft.onKeyDown)==null||Tn.call(Ft,sn)};_u(()=>{var Ft;u&&nt.current.contains(document.activeElement)&&((Ft=document.activeElement)==null||Ft.blur())},[u]),u&&ie!==-1&&ce(-1),u&&Ye!==-1&&Bt(-1);const Ut=Ft=>sn=>{var Tn;(Tn=Ft.onChange)==null||Tn.call(Ft,sn),Mt(sn,sn.target.valueAsNumber)},hn=fe.useRef(void 0);let xn=J;y&&J==="horizontal"&&(xn+="-reverse");const Le=({finger:Ft,move:sn=!1})=>{const{current:Tn}=nt,{width:Pn,height:ur,bottom:Bn,left:Hn}=Tn.getBoundingClientRect();let Zr;xn.startsWith("vertical")?Zr=(Bn-Ft.y)/ur:Zr=(Ft.x-Hn)/Pn,xn.includes("-reverse")&&(Zr=1-Zr);let Lr;if(Lr=q6(Zr,I,i),j)Lr=H6(Lr,j,I);else{const Yn=eM(at,Lr);Lr=at[Yn]}Lr=Sf(Lr,I,i);let qr=0;if(et){sn?qr=hn.current:qr=eM(gt,Lr),m&&(Lr=Sf(Lr,gt[qr-1]||-1/0,gt[qr+1]||1/0));const Yn=Lr;Lr=tM({values:gt,newValue:Lr,index:qr}),m&&sn||(qr=Lr.indexOf(Yn),hn.current=qr)}return{newValue:Lr,activeIndex:qr}},Dn=il(Ft=>{const sn=hv(Ft,se);if(!sn)return;if(ae.current+=1,Ft.type==="mousemove"&&Ft.buttons===0){pn(Ft);return}const{newValue:Tn,activeIndex:Pn}=Le({finger:sn,move:!0});pv({sliderRef:nt,activeIndex:Pn,setActive:ce}),Xe(Tn),!$e&&ae.current>G6&&Ze(!0),st&&!fv(Tn,ct)&&st(Ft,Tn,Pn)}),pn=il(Ft=>{const sn=hv(Ft,se);if(Ze(!1),!sn)return;const{newValue:Tn}=Le({finger:sn,move:!0});ce(-1),Ft.type==="touchend"&&xe(-1),G&&G(Ft,ke.current??Tn),se.current=void 0,_t()}),zn=il(Ft=>{if(u)return;nM()||Ft.preventDefault();const sn=Ft.changedTouches[0];sn!=null&&(se.current=sn.identifier);const Tn=hv(Ft,se);if(Tn!==!1){const{newValue:ur,activeIndex:Bn}=Le({finger:Tn});pv({sliderRef:nt,activeIndex:Bn,setActive:ce}),Xe(ur),st&&!fv(ur,ct)&&st(Ft,ur,Bn)}ae.current=0;const Pn=cs(nt.current);Pn.addEventListener("touchmove",Dn,{passive:!0}),Pn.addEventListener("touchend",pn,{passive:!0})}),_t=fe.useCallback(()=>{const Ft=cs(nt.current);Ft.removeEventListener("mousemove",Dn),Ft.removeEventListener("mouseup",pn),Ft.removeEventListener("touchmove",Dn),Ft.removeEventListener("touchend",pn)},[pn,Dn]);fe.useEffect(()=>{const{current:Ft}=nt;return Ft.addEventListener("touchstart",zn,{passive:nM()}),()=>{Ft.removeEventListener("touchstart",zn),_t()}},[_t,zn]),fe.useEffect(()=>{u&&_t()},[u,_t]);const er=Ft=>sn=>{var ur;if((ur=Ft.onMouseDown)==null||ur.call(Ft,sn),u||sn.defaultPrevented||sn.button!==0)return;sn.preventDefault();const Tn=hv(sn,se);if(Tn!==!1){const{newValue:Bn,activeIndex:Hn}=Le({finger:Tn});pv({sliderRef:nt,activeIndex:Hn,setActive:ce}),Xe(Bn),st&&!fv(Bn,ct)&&st(sn,Bn,Hn)}ae.current=0;const Pn=cs(nt.current);Pn.addEventListener("mousemove",Dn,{passive:!0}),Pn.addEventListener("mouseup",pn)},pr=Kv(et?gt[0]:I,I,i),qn=Kv(gt[gt.length-1],I,i)-pr,_n=(Ft={})=>{const sn=If(Ft),Tn={onMouseDown:er(sn||{})},Pn={...sn,...Tn};return{...Ft,ref:Rt,...Pn}},ir=Ft=>sn=>{var Pn;(Pn=Ft.onMouseOver)==null||Pn.call(Ft,sn);const Tn=Number(sn.currentTarget.getAttribute("data-index"));xe(Tn)},cr=Ft=>sn=>{var Tn;(Tn=Ft.onMouseLeave)==null||Tn.call(Ft,sn),xe(-1)},Er=(Ft={})=>{const sn=If(Ft),Tn={onMouseOver:ir(sn||{}),onMouseLeave:cr(sn||{})};return{...Ft,...sn,...Tn}},On=Ft=>({pointerEvents:ie!==-1&&ie!==Ft?"none":void 0});let fi;return J==="vertical"&&(fi=y?"vertical-rl":"vertical-lr"),{active:ie,axis:xn,axisProps:Z6,dragging:$e,focusedThumbIndex:Ye,getHiddenInputProps:(Ft={})=>{const sn=If(Ft),Tn={onChange:Ut(sn||{}),onFocus:Nt(sn||{}),onBlur:gn(sn||{}),onKeyDown:$t(sn||{})},Pn={...sn,...Tn};return{tabIndex:oe,"aria-labelledby":r,"aria-orientation":J,"aria-valuemax":H(i),"aria-valuemin":H(I),name:F,type:"range",min:n.min,max:n.max,step:n.step===null&&n.marks?"any":n.step??void 0,disabled:u,...Ft,...Pn,style:{...BA,direction:y?"rtl":"ltr",width:"100%",height:"100%",writingMode:fi}}},getRootProps:_n,getThumbProps:Er,marks:zt,open:we,range:et,rootRef:Rt,trackLeap:qn,trackOffset:pr,values:gt,getThumbStyle:On}}const K6=n=>!n||!Pf(n);function J6(n){return sr("MuiSlider",n)}const bc=ar("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Q6=n=>{const{open:r}=n;return{offset:Sn(r&&bc.valueLabelOpen),circle:bc.valueLabelCircle,label:bc.valueLabelLabel}};function eU(n){const{children:r,className:s,value:u}=n,m=Q6(n);return r?fe.cloneElement(r,{className:Sn(r.props.className)},_e.jsxs(fe.Fragment,{children:[r.props.children,_e.jsx("span",{className:Sn(m.offset,s),"aria-hidden":!0,children:_e.jsx("span",{className:m.circle,children:_e.jsx("span",{className:m.label,children:u})})})]})):null}function rM(n){return n}const tU=Jt("span",{name:"MuiSlider",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`color${Yt(s.color)}`],s.size!=="medium"&&r[`size${Yt(s.size)}`],s.marked&&r.marked,s.orientation==="vertical"&&r.vertical,s.track==="inverted"&&r.trackInverted,s.track===!1&&r.trackFalse]}})(rr(({theme:n})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${bc.disabled}`]:{pointerEvents:"none",cursor:"default",color:(n.vars||n).palette.grey[400]},[`&.${bc.dragging}`]:{[`& .${bc.thumb}, & .${bc.track}`]:{transition:"none"}},variants:[...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r},style:{color:(n.vars||n).palette[r].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),nU=Jt("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(n,r)=>r.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),rU=Jt("span",{name:"MuiSlider",slot:"Track",overridesResolver:(n,r)=>r.track})(rr(({theme:n})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:n.transitions.create(["left","width","bottom","height"],{duration:n.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r,track:"inverted"},style:{...n.vars?{backgroundColor:n.vars.palette.Slider[`${r}Track`],borderColor:n.vars.palette.Slider[`${r}Track`]}:{backgroundColor:zf(n.palette[r].main,.62),borderColor:zf(n.palette[r].main,.62),...n.applyStyles("dark",{backgroundColor:Lf(n.palette[r].main,.5)}),...n.applyStyles("dark",{borderColor:Lf(n.palette[r].main,.5)})}}}))]}))),iU=Jt("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.thumb,r[`thumbColor${Yt(s.color)}`],s.size!=="medium"&&r[`thumbSize${Yt(s.size)}`]]}})(rr(({theme:n})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:n.transitions.create(["box-shadow","left","bottom"],{duration:n.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(n.vars||n).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${bc.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(n.palette).filter(zo()).map(([r])=>({props:{color:r},style:{[`&:hover, &.${bc.focusVisible}`]:{...n.vars?{boxShadow:`0px 0px 0px 8px rgba(${n.vars.palette[r].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${Oi(n.palette[r].main,.16)}`},"@media (hover: none)":{boxShadow:"none"}},[`&.${bc.active}`]:{...n.vars?{boxShadow:`0px 0px 0px 14px rgba(${n.vars.palette[r].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${Oi(n.palette[r].main,.16)}`}}}}))]}))),oU=Jt(eU,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(n,r)=>r.valueLabel})(rr(({theme:n})=>({zIndex:1,whiteSpace:"nowrap",...n.typography.body2,fontWeight:500,transition:n.transitions.create(["transform"],{duration:n.transitions.duration.shortest}),position:"absolute",backgroundColor:(n.vars||n).palette.grey[600],borderRadius:2,color:(n.vars||n).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${bc.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${bc.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:n.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),sU=Jt("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:n=>sy(n)&&n!=="markActive",overridesResolver:(n,r)=>{const{markActive:s}=n;return[r.mark,s&&r.markActive]}})(rr(({theme:n})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(n.vars||n).palette.background.paper,opacity:.8}}]}))),aU=Jt("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:n=>sy(n)&&n!=="markLabelActive",overridesResolver:(n,r)=>r.markLabel})(rr(({theme:n})=>({...n.typography.body2,color:(n.vars||n).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(n.vars||n).palette.text.primary}}]}))),lU=n=>{const{disabled:r,dragging:s,marked:u,orientation:m,track:y,classes:T,color:i,size:I}=n,F={root:["root",r&&"disabled",s&&"dragging",u&&"marked",m==="vertical"&&"vertical",y==="inverted"&&"trackInverted",y===!1&&"trackFalse",i&&`color${Yt(i)}`,I&&`size${Yt(I)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",r&&"disabled",I&&`thumbSize${Yt(I)}`,i&&`thumbColor${Yt(i)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return lr(F,J6,T)},cU=({children:n})=>n,uU=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiSlider"}),m=cg(),{"aria-label":y,"aria-valuetext":T,"aria-labelledby":i,component:I="span",components:F={},componentsProps:B={},color:G="primary",classes:J,className:te,disableSwap:H=!1,disabled:j=!1,getAriaLabel:ne,getAriaValueText:oe,marks:pe=!1,max:se=100,min:ie=0,name:ce,onChange:we,onChangeCommitted:xe,orientation:$e="horizontal",shiftStep:Ze=10,size:ae="medium",step:ke=1,scale:ct=rM,slotProps:Xe,slots:st,tabIndex:et,track:gt="normal",value:zt,valueLabelDisplay:at="off",valueLabelFormat:Ye=rM,...Bt}=u,nt={...u,isRtl:m,max:se,min:ie,classes:J,disabled:j,disableSwap:H,orientation:$e,marks:pe,color:G,size:ae,step:ke,shiftStep:Ze,scale:ct,track:gt,valueLabelDisplay:at,valueLabelFormat:Ye},{axisProps:Rt,getRootProps:Nt,getHiddenInputProps:gn,getThumbProps:Mt,open:$t,active:Ut,axis:hn,focusedThumbIndex:xn,range:Le,dragging:Dn,marks:pn,values:zn,trackOffset:_t,trackLeap:er,getThumbStyle:pr}=Y6({...nt,rootRef:s});nt.marked=pn.length>0&&pn.some(ai=>ai.label),nt.dragging=Dn,nt.focusedThumbIndex=xn;const qn=lU(nt),_n=(st==null?void 0:st.root)??F.Root??tU,ir=(st==null?void 0:st.rail)??F.Rail??nU,cr=(st==null?void 0:st.track)??F.Track??rU,Er=(st==null?void 0:st.thumb)??F.Thumb??iU,On=(st==null?void 0:st.valueLabel)??F.ValueLabel??oU,fi=(st==null?void 0:st.mark)??F.Mark??sU,Dt=(st==null?void 0:st.markLabel)??F.MarkLabel??aU,Ft=(st==null?void 0:st.input)??F.Input??"input",sn=(Xe==null?void 0:Xe.root)??B.root,Tn=(Xe==null?void 0:Xe.rail)??B.rail,Pn=(Xe==null?void 0:Xe.track)??B.track,ur=(Xe==null?void 0:Xe.thumb)??B.thumb,Bn=(Xe==null?void 0:Xe.valueLabel)??B.valueLabel,Hn=(Xe==null?void 0:Xe.mark)??B.mark,Zr=(Xe==null?void 0:Xe.markLabel)??B.markLabel,Lr=(Xe==null?void 0:Xe.input)??B.input,qr=rl({elementType:_n,getSlotProps:Nt,externalSlotProps:sn,externalForwardedProps:Bt,additionalProps:{...K6(_n)&&{as:I}},ownerState:{...nt,...sn==null?void 0:sn.ownerState},className:[qn.root,te]}),Yn=rl({elementType:ir,externalSlotProps:Tn,ownerState:nt,className:qn.rail}),Ar=rl({elementType:cr,externalSlotProps:Pn,additionalProps:{style:{...Rt[hn].offset(_t),...Rt[hn].leap(er)}},ownerState:{...nt,...Pn==null?void 0:Pn.ownerState},className:qn.track}),si=rl({elementType:Er,getSlotProps:Mt,externalSlotProps:ur,ownerState:{...nt,...ur==null?void 0:ur.ownerState},className:qn.thumb}),$n=rl({elementType:On,externalSlotProps:Bn,ownerState:{...nt,...Bn==null?void 0:Bn.ownerState},className:qn.valueLabel}),Zi=rl({elementType:fi,externalSlotProps:Hn,ownerState:nt,className:qn.mark}),ra=rl({elementType:Dt,externalSlotProps:Zr,ownerState:nt,className:qn.markLabel}),Wi=rl({elementType:Ft,getSlotProps:gn,externalSlotProps:Lr,ownerState:nt});return _e.jsxs(_n,{...qr,children:[_e.jsx(ir,{...Yn}),_e.jsx(cr,{...Ar}),pn.filter(ai=>ai.value>=ie&&ai.value<=se).map((ai,Fi)=>{const ia=Kv(ai.value,ie,se),vs=Rt[hn].offset(ia);let Do;return gt===!1?Do=zn.includes(ai.value):Do=gt==="normal"&&(Le?ai.value>=zn[0]&&ai.value<=zn[zn.length-1]:ai.value<=zn[0])||gt==="inverted"&&(Le?ai.value<=zn[0]||ai.value>=zn[zn.length-1]:ai.value>=zn[0]),_e.jsxs(fe.Fragment,{children:[_e.jsx(fi,{"data-index":Fi,...Zi,...!Pf(fi)&&{markActive:Do},style:{...vs,...Zi.style},className:Sn(Zi.className,Do&&qn.markActive)}),ai.label!=null?_e.jsx(Dt,{"aria-hidden":!0,"data-index":Fi,...ra,...!Pf(Dt)&&{markLabelActive:Do},style:{...vs,...ra.style},className:Sn(qn.markLabel,ra.className,Do&&qn.markLabelActive),children:ai.label}):null]},Fi)}),zn.map((ai,Fi)=>{const ia=Kv(ai,ie,se),vs=Rt[hn].offset(ia),Do=at==="off"?cU:On;return _e.jsx(Do,{...!Pf(Do)&&{valueLabelFormat:Ye,valueLabelDisplay:at,value:typeof Ye=="function"?Ye(ct(ai),Fi):Ye,index:Fi,open:$t===Fi||Ut===Fi||at==="on",disabled:j},...$n,children:_e.jsx(Er,{"data-index":Fi,...si,className:Sn(qn.thumb,si.className,Ut===Fi&&qn.active,xn===Fi&&qn.focusVisible),style:{...vs,...pr(Fi),...si.style},children:_e.jsx(Ft,{"data-index":Fi,"aria-label":ne?ne(Fi):y,"aria-valuenow":ct(ai),"aria-labelledby":i,"aria-valuetext":oe?oe(ct(ai),Fi):T,value:zn[Fi],...Wi})})},Fi)})]})});function dU(n={}){const{autoHideDuration:r=null,disableWindowBlurListener:s=!1,onClose:u,open:m,resumeHideDuration:y}=n,T=Cf();fe.useEffect(()=>{if(!m)return;function oe(pe){pe.defaultPrevented||pe.key==="Escape"&&(u==null||u(pe,"escapeKeyDown"))}return document.addEventListener("keydown",oe),()=>{document.removeEventListener("keydown",oe)}},[m,u]);const i=il((oe,pe)=>{u==null||u(oe,pe)}),I=il(oe=>{!u||oe==null||T.start(oe,()=>{i(null,"timeout")})});fe.useEffect(()=>(m&&I(r),T.clear),[m,r,I,T]);const F=oe=>{u==null||u(oe,"clickaway")},B=T.clear,G=fe.useCallback(()=>{r!=null&&I(y??r*.5)},[r,y,I]),J=oe=>pe=>{const se=oe.onBlur;se==null||se(pe),G()},te=oe=>pe=>{const se=oe.onFocus;se==null||se(pe),B()},H=oe=>pe=>{const se=oe.onMouseEnter;se==null||se(pe),B()},j=oe=>pe=>{const se=oe.onMouseLeave;se==null||se(pe),G()};return fe.useEffect(()=>{if(!s&&m)return window.addEventListener("focus",G),window.addEventListener("blur",B),()=>{window.removeEventListener("focus",G),window.removeEventListener("blur",B)}},[s,m,G,B]),{getRootProps:(oe={})=>{const pe={...If(n),...If(oe)};return{role:"presentation",...oe,...pe,onBlur:J(pe),onFocus:te(pe),onMouseEnter:H(pe),onMouseLeave:j(pe)}},onClickAway:F}}function hU(n){return sr("MuiSnackbarContent",n)}ar("MuiSnackbarContent",["root","message","action"]);const pU=n=>{const{classes:r}=n;return lr({root:["root"],action:["action"],message:["message"]},hU,r)},fU=Jt(xu,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(n,r)=>r.root})(rr(({theme:n})=>{const r=n.palette.mode==="light"?.8:.98,s=zA(n.palette.background.default,r);return{...n.typography.body2,color:n.vars?n.vars.palette.SnackbarContent.color:n.palette.getContrastText(s),backgroundColor:n.vars?n.vars.palette.SnackbarContent.bg:s,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(n.vars||n).shape.borderRadius,flexGrow:1,[n.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),mU=Jt("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(n,r)=>r.message})({padding:"8px 0"}),gU=Jt("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(n,r)=>r.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),_U=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiSnackbarContent"}),{action:m,className:y,message:T,role:i="alert",...I}=u,F=u,B=pU(F);return _e.jsxs(fU,{role:i,square:!0,elevation:6,className:Sn(B.root,y),ownerState:F,ref:s,...I,children:[_e.jsx(mU,{className:B.message,ownerState:F,children:T}),m?_e.jsx(gU,{className:B.action,ownerState:F,children:m}):null]})});function yU(n){return sr("MuiSnackbar",n)}ar("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const vU=n=>{const{classes:r,anchorOrigin:s}=n,u={root:["root",`anchorOrigin${Yt(s.vertical)}${Yt(s.horizontal)}`]};return lr(u,yU,r)},iM=Jt("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[`anchorOrigin${Yt(s.anchorOrigin.vertical)}${Yt(s.anchorOrigin.horizontal)}`]]}})(rr(({theme:n})=>({zIndex:(n.vars||n).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:r})=>r.anchorOrigin.vertical==="top",style:{top:8,[n.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:r})=>r.anchorOrigin.vertical!=="top",style:{bottom:8,[n.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:r})=>r.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[n.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:r})=>r.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[n.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:r})=>r.anchorOrigin.horizontal==="center",style:{[n.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),xU=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiSnackbar"}),m=Mp(),y={enter:m.transitions.duration.enteringScreen,exit:m.transitions.duration.leavingScreen},{action:T,anchorOrigin:{vertical:i,horizontal:I}={vertical:"bottom",horizontal:"left"},autoHideDuration:F=null,children:B,className:G,ClickAwayListenerProps:J,ContentProps:te,disableWindowBlurListener:H=!1,message:j,onBlur:ne,onClose:oe,onFocus:pe,onMouseEnter:se,onMouseLeave:ie,open:ce,resumeHideDuration:we,TransitionComponent:xe=X_,transitionDuration:$e=y,TransitionProps:{onEnter:Ze,onExited:ae,...ke}={},...ct}=u,Xe={...u,anchorOrigin:{vertical:i,horizontal:I},autoHideDuration:F,disableWindowBlurListener:H,TransitionComponent:xe,transitionDuration:$e},st=vU(Xe),{getRootProps:et,onClickAway:gt}=dU({...Xe}),[zt,at]=fe.useState(!0),Ye=rl({elementType:iM,getSlotProps:et,externalForwardedProps:ct,ownerState:Xe,additionalProps:{ref:s},className:[st.root,G]}),Bt=Rt=>{at(!0),ae&&ae(Rt)},nt=(Rt,Nt)=>{at(!1),Ze&&Ze(Rt,Nt)};return!ce&&zt?null:_e.jsx(DB,{onClickAway:gt,...J,children:_e.jsx(iM,{...Ye,children:_e.jsx(xe,{appear:!0,in:ce,timeout:$e,direction:i==="top"?"down":"up",onEnter:nt,onExited:Bt,...ke,children:B||_e.jsx(_U,{message:j,action:T,...te})})})})});function bU(n){return sr("MuiTooltip",n)}const jo=ar("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function wU(n){return Math.round(n*1e5)/1e5}const SU=n=>{const{classes:r,disableInteractive:s,arrow:u,touch:m,placement:y}=n,T={popper:["popper",!s&&"popperInteractive",u&&"popperArrow"],tooltip:["tooltip",u&&"tooltipArrow",m&&"touch",`tooltipPlacement${Yt(y.split("-")[0])}`],arrow:["arrow"]};return lr(T,bU,r)},TU=Jt(lP,{name:"MuiTooltip",slot:"Popper",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.popper,!s.disableInteractive&&r.popperInteractive,s.arrow&&r.popperArrow,!s.open&&r.popperClose]}})(rr(({theme:n})=>({zIndex:(n.vars||n).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:r})=>!r.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:r})=>!r,style:{pointerEvents:"none"}},{props:({ownerState:r})=>r.arrow,style:{[`&[data-popper-placement*="bottom"] .${jo.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${jo.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${jo.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${jo.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:r})=>r.arrow&&!r.isRtl,style:{[`&[data-popper-placement*="right"] .${jo.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!!r.isRtl,style:{[`&[data-popper-placement*="right"] .${jo.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!r.isRtl,style:{[`&[data-popper-placement*="left"] .${jo.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:r})=>r.arrow&&!!r.isRtl,style:{[`&[data-popper-placement*="left"] .${jo.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),EU=Jt("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.tooltip,s.touch&&r.touch,s.arrow&&r.tooltipArrow,r[`tooltipPlacement${Yt(s.placement.split("-")[0])}`]]}})(rr(({theme:n})=>({backgroundColor:n.vars?n.vars.palette.Tooltip.bg:Oi(n.palette.grey[700],.92),borderRadius:(n.vars||n).shape.borderRadius,color:(n.vars||n).palette.common.white,fontFamily:n.typography.fontFamily,padding:"4px 8px",fontSize:n.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:n.typography.fontWeightMedium,[`.${jo.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${jo.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${jo.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${jo.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:r})=>r.arrow,style:{position:"relative",margin:0}},{props:({ownerState:r})=>r.touch,style:{padding:"8px 16px",fontSize:n.typography.pxToRem(14),lineHeight:`${wU(16/14)}em`,fontWeight:n.typography.fontWeightRegular}},{props:({ownerState:r})=>!r.isRtl,style:{[`.${jo.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${jo.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:r})=>!r.isRtl&&r.touch,style:{[`.${jo.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${jo.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:r})=>!!r.isRtl,style:{[`.${jo.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${jo.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:r})=>!!r.isRtl&&r.touch,style:{[`.${jo.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${jo.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:r})=>r.touch,style:{[`.${jo.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:r})=>r.touch,style:{[`.${jo.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),CU=Jt("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(n,r)=>r.arrow})(rr(({theme:n})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:n.vars?n.vars.palette.Tooltip.bg:Oi(n.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let gv=!1;const oM=new wx;let d_={x:0,y:0};function _v(n,r){return(s,...u)=>{r&&r(s,...u),n(s,...u)}}const Lx=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiTooltip"}),{arrow:m=!1,children:y,classes:T,components:i={},componentsProps:I={},describeChild:F=!1,disableFocusListener:B=!1,disableHoverListener:G=!1,disableInteractive:J=!1,disableTouchListener:te=!1,enterDelay:H=100,enterNextDelay:j=0,enterTouchDelay:ne=700,followCursor:oe=!1,id:pe,leaveDelay:se=0,leaveTouchDelay:ie=1500,onClose:ce,onOpen:we,open:xe,placement:$e="bottom",PopperComponent:Ze,PopperProps:ae={},slotProps:ke={},slots:ct={},title:Xe,TransitionComponent:st,TransitionProps:et,...gt}=u,zt=fe.isValidElement(y)?y:_e.jsx("span",{children:y}),at=Mp(),Ye=cg(),[Bt,nt]=fe.useState(),[Rt,Nt]=fe.useState(null),gn=fe.useRef(!1),Mt=J||oe,$t=Cf(),Ut=Cf(),hn=Cf(),xn=Cf(),[Le,Dn]=Df({controlled:xe,default:!1,name:"Tooltip",state:"open"});let pn=Le;const zn=ah(pe),_t=fe.useRef(),er=il(()=>{_t.current!==void 0&&(document.body.style.WebkitUserSelect=_t.current,_t.current=void 0),xn.clear()});fe.useEffect(()=>er,[er]);const pr=ht=>{oM.clear(),gv=!0,Dn(!0),we&&!pn&&we(ht)},qn=il(ht=>{oM.start(800+se,()=>{gv=!1}),Dn(!1),ce&&pn&&ce(ht),$t.start(at.transitions.duration.shortest,()=>{gn.current=!1})}),_n=ht=>{gn.current&&ht.type!=="touchstart"||(Bt&&Bt.removeAttribute("title"),Ut.clear(),hn.clear(),H||gv&&j?Ut.start(gv?j:H,()=>{pr(ht)}):pr(ht))},ir=ht=>{Ut.clear(),hn.start(se,()=>{qn(ht)})},[,cr]=fe.useState(!1),Er=ht=>{Sp(ht.target)||(cr(!1),ir(ht))},On=ht=>{Bt||nt(ht.currentTarget),Sp(ht.target)&&(cr(!0),_n(ht))},fi=ht=>{gn.current=!0;const ge=zt.props;ge.onTouchStart&&ge.onTouchStart(ht)},Dt=ht=>{fi(ht),hn.clear(),$t.clear(),er(),_t.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",xn.start(ne,()=>{document.body.style.WebkitUserSelect=_t.current,_n(ht)})},Ft=ht=>{zt.props.onTouchEnd&&zt.props.onTouchEnd(ht),er(),hn.start(ie,()=>{qn(ht)})};fe.useEffect(()=>{if(!pn)return;function ht(ge){ge.key==="Escape"&&qn(ge)}return document.addEventListener("keydown",ht),()=>{document.removeEventListener("keydown",ht)}},[qn,pn]);const sn=ao(Cp(zt),nt,s);!Xe&&Xe!==0&&(pn=!1);const Tn=fe.useRef(),Pn=ht=>{const ge=zt.props;ge.onMouseMove&&ge.onMouseMove(ht),d_={x:ht.clientX,y:ht.clientY},Tn.current&&Tn.current.update()},ur={},Bn=typeof Xe=="string";F?(ur.title=!pn&&Bn&&!G?Xe:null,ur["aria-describedby"]=pn?zn:null):(ur["aria-label"]=Bn?Xe:null,ur["aria-labelledby"]=pn&&!Bn?zn:null);const Hn={...ur,...gt,...zt.props,className:Sn(gt.className,zt.props.className),onTouchStart:fi,ref:sn,...oe?{onMouseMove:Pn}:{}},Zr={};te||(Hn.onTouchStart=Dt,Hn.onTouchEnd=Ft),G||(Hn.onMouseOver=_v(_n,Hn.onMouseOver),Hn.onMouseLeave=_v(ir,Hn.onMouseLeave),Mt||(Zr.onMouseOver=_n,Zr.onMouseLeave=ir)),B||(Hn.onFocus=_v(On,Hn.onFocus),Hn.onBlur=_v(Er,Hn.onBlur),Mt||(Zr.onFocus=On,Zr.onBlur=Er));const Lr={...u,isRtl:Ye,arrow:m,disableInteractive:Mt,placement:$e,PopperComponentProp:Ze,touch:gn.current},qr=typeof ke.popper=="function"?ke.popper(Lr):ke.popper,Yn=fe.useMemo(()=>{var ge,be;let ht=[{name:"arrow",enabled:!!Rt,options:{element:Rt,padding:4}}];return(ge=ae.popperOptions)!=null&&ge.modifiers&&(ht=ht.concat(ae.popperOptions.modifiers)),(be=qr==null?void 0:qr.popperOptions)!=null&&be.modifiers&&(ht=ht.concat(qr.popperOptions.modifiers)),{...ae.popperOptions,...qr==null?void 0:qr.popperOptions,modifiers:ht}},[Rt,ae.popperOptions,qr==null?void 0:qr.popperOptions]),Ar=SU(Lr),si=typeof ke.transition=="function"?ke.transition(Lr):ke.transition,$n={slots:{popper:i.Popper,transition:i.Transition??st,tooltip:i.Tooltip,arrow:i.Arrow,...ct},slotProps:{arrow:ke.arrow??I.arrow,popper:{...ae,...qr??I.popper},tooltip:ke.tooltip??I.tooltip,transition:{...et,...si??I.transition}}},[Zi,ra]=Gi("popper",{elementType:TU,externalForwardedProps:$n,ownerState:Lr,className:Sn(Ar.popper,ae==null?void 0:ae.className)}),[Wi,ai]=Gi("transition",{elementType:X_,externalForwardedProps:$n,ownerState:Lr}),[Fi,ia]=Gi("tooltip",{elementType:EU,className:Ar.tooltip,externalForwardedProps:$n,ownerState:Lr}),[vs,Do]=Gi("arrow",{elementType:CU,className:Ar.arrow,externalForwardedProps:$n,ownerState:Lr,ref:Nt});return _e.jsxs(fe.Fragment,{children:[fe.cloneElement(zt,Hn),_e.jsx(Zi,{as:Ze??lP,placement:$e,anchorEl:oe?{getBoundingClientRect:()=>({top:d_.y,left:d_.x,right:d_.x,bottom:d_.y,width:0,height:0})}:Bt,popperRef:Tn,open:Bt?pn:!1,id:zn,transition:!0,...Zr,...ra,popperOptions:Yn,children:({TransitionProps:ht})=>_e.jsx(Wi,{timeout:at.transitions.duration.shorter,...ht,...ai,children:_e.jsxs(Fi,{...ia,children:[Xe,m?_e.jsx(vs,{...Do}):null]})})})]})}),_p=CO({createStyledComponent:Jt("div",{name:"MuiStack",slot:"Root",overridesResolver:(n,r)=>r.root}),useThemeProps:n=>gr({props:n,name:"MuiStack"})}),uy=fe.createContext({}),zx=fe.createContext({});function MU(n){return sr("MuiStep",n)}ar("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const IU=n=>{const{classes:r,orientation:s,alternativeLabel:u,completed:m}=n;return lr({root:["root",s,u&&"alternativeLabel",m&&"completed"]},MU,r)},AU=Jt("div",{name:"MuiStep",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.orientation],s.alternativeLabel&&r.alternativeLabel,s.completed&&r.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),PU=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiStep"}),{active:m,children:y,className:T,component:i="div",completed:I,disabled:F,expanded:B=!1,index:G,last:J,...te}=u,{activeStep:H,connector:j,alternativeLabel:ne,orientation:oe,nonLinear:pe}=fe.useContext(uy);let[se=!1,ie=!1,ce=!1]=[m,I,F];H===G?se=m!==void 0?m:!0:!pe&&H>G?ie=I!==void 0?I:!0:!pe&&H<G&&(ce=F!==void 0?F:!0);const we=fe.useMemo(()=>({index:G,last:J,expanded:B,icon:G+1,active:se,completed:ie,disabled:ce}),[G,J,B,se,ie,ce]),xe={...u,active:se,orientation:oe,alternativeLabel:ne,completed:ie,disabled:ce,expanded:B,component:i},$e=IU(xe),Ze=_e.jsxs(AU,{as:i,className:Sn($e.root,T),ref:s,ownerState:xe,...te,children:[j&&ne&&G!==0?j:null,y]});return _e.jsx(zx.Provider,{value:we,children:j&&!ne&&G!==0?_e.jsxs(fe.Fragment,{children:[j,Ze]}):Ze})}),RU=Ti(_e.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),kU=Ti(_e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function LU(n){return sr("MuiStepIcon",n)}const bb=ar("MuiStepIcon",["root","active","completed","error","text"]);var sM;const zU=n=>{const{classes:r,active:s,completed:u,error:m}=n;return lr({root:["root",s&&"active",u&&"completed",m&&"error"],text:["text"]},LU,r)},wb=Jt(qv,{name:"MuiStepIcon",slot:"Root",overridesResolver:(n,r)=>r.root})(rr(({theme:n})=>({display:"block",transition:n.transitions.create("color",{duration:n.transitions.duration.shortest}),color:(n.vars||n).palette.text.disabled,[`&.${bb.completed}`]:{color:(n.vars||n).palette.primary.main},[`&.${bb.active}`]:{color:(n.vars||n).palette.primary.main},[`&.${bb.error}`]:{color:(n.vars||n).palette.error.main}}))),DU=Jt("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(n,r)=>r.text})(rr(({theme:n})=>({fill:(n.vars||n).palette.primary.contrastText,fontSize:n.typography.caption.fontSize,fontFamily:n.typography.fontFamily}))),OU=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiStepIcon"}),{active:m=!1,className:y,completed:T=!1,error:i=!1,icon:I,...F}=u,B={...u,active:m,completed:T,error:i},G=zU(B);if(typeof I=="number"||typeof I=="string"){const J=Sn(y,G.root);return i?_e.jsx(wb,{as:kU,className:J,ref:s,ownerState:B,...F}):T?_e.jsx(wb,{as:RU,className:J,ref:s,ownerState:B,...F}):_e.jsxs(wb,{className:J,ref:s,ownerState:B,...F,children:[sM||(sM=_e.jsx("circle",{cx:"12",cy:"12",r:"12"})),_e.jsx(DU,{className:G.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:B,children:I})]})}return I});function FU(n){return sr("MuiStepLabel",n)}const xp=ar("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),BU=n=>{const{classes:r,orientation:s,active:u,completed:m,error:y,disabled:T,alternativeLabel:i}=n;return lr({root:["root",s,y&&"error",T&&"disabled",i&&"alternativeLabel"],label:["label",u&&"active",m&&"completed",y&&"error",T&&"disabled",i&&"alternativeLabel"],iconContainer:["iconContainer",u&&"active",m&&"completed",y&&"error",T&&"disabled",i&&"alternativeLabel"],labelContainer:["labelContainer",i&&"alternativeLabel"]},FU,r)},NU=Jt("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.orientation]]}})({display:"flex",alignItems:"center",[`&.${xp.alternativeLabel}`]:{flexDirection:"column"},[`&.${xp.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),jU=Jt("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(n,r)=>r.label})(rr(({theme:n})=>({...n.typography.body2,display:"block",transition:n.transitions.create("color",{duration:n.transitions.duration.shortest}),[`&.${xp.active}`]:{color:(n.vars||n).palette.text.primary,fontWeight:500},[`&.${xp.completed}`]:{color:(n.vars||n).palette.text.primary,fontWeight:500},[`&.${xp.alternativeLabel}`]:{marginTop:16},[`&.${xp.error}`]:{color:(n.vars||n).palette.error.main}}))),UU=Jt("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(n,r)=>r.iconContainer})({flexShrink:0,display:"flex",paddingRight:8,[`&.${xp.alternativeLabel}`]:{paddingRight:0}}),$U=Jt("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(n,r)=>r.labelContainer})(rr(({theme:n})=>({width:"100%",color:(n.vars||n).palette.text.secondary,[`&.${xp.alternativeLabel}`]:{textAlign:"center"}}))),kP=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiStepLabel"}),{children:m,className:y,componentsProps:T={},error:i=!1,icon:I,optional:F,slots:B={},slotProps:G={},StepIconComponent:J,StepIconProps:te,...H}=u,{alternativeLabel:j,orientation:ne}=fe.useContext(uy),{active:oe,disabled:pe,completed:se,icon:ie}=fe.useContext(zx),ce=I||ie;let we=J;ce&&!we&&(we=OU);const xe={...u,active:oe,alternativeLabel:j,completed:se,disabled:pe,error:i,orientation:ne},$e=BU(xe),Ze={slots:B,slotProps:{stepIcon:te,...T,...G}},[ae,ke]=Gi("label",{elementType:jU,externalForwardedProps:Ze,ownerState:xe}),[ct,Xe]=Gi("stepIcon",{elementType:we,externalForwardedProps:Ze,ownerState:xe});return _e.jsxs(NU,{className:Sn($e.root,y),ref:s,ownerState:xe,...H,children:[ce||ct?_e.jsx(UU,{className:$e.iconContainer,ownerState:xe,children:_e.jsx(ct,{completed:se,active:oe,error:i,icon:ce,...Xe})}):null,_e.jsxs($U,{className:$e.labelContainer,ownerState:xe,children:[m?_e.jsx(ae,{...ke,className:Sn($e.label,ke==null?void 0:ke.className),children:m}):null,F]})]})});kP.muiName="StepLabel";function VU(n){return sr("MuiStepButton",n)}const aM=ar("MuiStepButton",["root","horizontal","vertical","touchRipple"]),GU=n=>{const{classes:r,orientation:s}=n;return lr({root:["root",s],touchRipple:["touchRipple"]},VU,r)},qU=Jt(Tp,{name:"MuiStepButton",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[{[`& .${aM.touchRipple}`]:r.touchRipple},r.root,r[s.orientation]]}})({width:"100%",padding:"24px 16px",margin:"-24px -16px",boxSizing:"content-box",[`& .${aM.touchRipple}`]:{color:"rgba(0, 0, 0, 0.3)"},variants:[{props:{orientation:"vertical"},style:{justifyContent:"flex-start",padding:"8px",margin:"-8px"}}]}),WU=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiStepButton"}),{children:m,className:y,icon:T,optional:i,...I}=u,{disabled:F,active:B}=fe.useContext(zx),{orientation:G}=fe.useContext(uy),J={...u,orientation:G},te=GU(J),H={icon:T,optional:i},j=L_(m,["StepLabel"])?fe.cloneElement(m,H):_e.jsx(kP,{...H,children:m});return _e.jsx(qU,{focusRipple:!0,disabled:F,TouchRippleProps:{className:te.touchRipple},className:Sn(te.root,y),ref:s,ownerState:J,"aria-current":B?"step":void 0,...I,children:j})});function HU(n){return sr("MuiStepConnector",n)}ar("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const ZU=n=>{const{classes:r,orientation:s,alternativeLabel:u,active:m,completed:y,disabled:T}=n,i={root:["root",s,u&&"alternativeLabel",m&&"active",y&&"completed",T&&"disabled"],line:["line",`line${Yt(s)}`]};return lr(i,HU,r)},XU=Jt("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.orientation],s.alternativeLabel&&r.alternativeLabel,s.completed&&r.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),YU=Jt("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.line,r[`line${Yt(s.orientation)}`]]}})(rr(({theme:n})=>{const r=n.palette.mode==="light"?n.palette.grey[400]:n.palette.grey[600];return{display:"block",borderColor:n.vars?n.vars.palette.StepConnector.border:r,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),KU=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiStepConnector"}),{className:m,...y}=u,{alternativeLabel:T,orientation:i="horizontal"}=fe.useContext(uy),{active:I,disabled:F,completed:B}=fe.useContext(zx),G={...u,alternativeLabel:T,orientation:i,active:I,completed:B,disabled:F},J=ZU(G);return _e.jsx(XU,{className:Sn(J.root,m),ref:s,ownerState:G,...y,children:_e.jsx(YU,{className:J.line,ownerState:G})})});function JU(n){return sr("MuiStepper",n)}ar("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const QU=n=>{const{orientation:r,nonLinear:s,alternativeLabel:u,classes:m}=n;return lr({root:["root",r,s&&"nonLinear",u&&"alternativeLabel"]},JU,m)},e$=Jt("div",{name:"MuiStepper",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,r[s.orientation],s.alternativeLabel&&r.alternativeLabel,s.nonLinear&&r.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),t$=_e.jsx(KU,{}),n$=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiStepper"}),{activeStep:m=0,alternativeLabel:y=!1,children:T,className:i,component:I="div",connector:F=t$,nonLinear:B=!1,orientation:G="horizontal",...J}=u,te={...u,nonLinear:B,alternativeLabel:y,orientation:G,component:I},H=QU(te),j=fe.Children.toArray(T).filter(Boolean),ne=j.map((pe,se)=>fe.cloneElement(pe,{index:se,last:se+1===j.length,...pe.props})),oe=fe.useMemo(()=>({activeStep:m,alternativeLabel:y,connector:F,nonLinear:B,orientation:G}),[m,y,F,B,G]);return _e.jsx(uy.Provider,{value:oe,children:_e.jsx(e$,{as:I,ownerState:te,className:Sn(H.root,i),ref:s,...J,children:ne})})});function r$(n){return sr("MuiToolbar",n)}ar("MuiToolbar",["root","gutters","regular","dense"]);const i$=n=>{const{classes:r,disableGutters:s,variant:u}=n;return lr({root:["root",!s&&"gutters",u]},r$,r)},o$=Jt("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(n,r)=>{const{ownerState:s}=n;return[r.root,!s.disableGutters&&r.gutters,r[s.variant]]}})(rr(({theme:n})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:n.spacing(2),paddingRight:n.spacing(2),[n.breakpoints.up("sm")]:{paddingLeft:n.spacing(3),paddingRight:n.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:n.mixins.toolbar}]}))),V1=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiToolbar"}),{className:m,component:y="div",disableGutters:T=!1,variant:i="regular",...I}=u,F={...u,component:y,disableGutters:T,variant:i},B=i$(F);return _e.jsx(o$,{as:y,className:Sn(B.root,m),ref:s,ownerState:F,...I})});function s$(n){return sr("MuiTextField",n)}ar("MuiTextField",["root"]);const a$={standard:Vw,filled:Uw,outlined:Ww},l$=n=>{const{classes:r}=n;return lr({root:["root"]},s$,r)},c$=Jt(vP,{name:"MuiTextField",slot:"Root",overridesResolver:(n,r)=>r.root})({}),Ff=fe.forwardRef(function(r,s){const u=gr({props:r,name:"MuiTextField"}),{autoComplete:m,autoFocus:y=!1,children:T,className:i,color:I="primary",defaultValue:F,disabled:B=!1,error:G=!1,FormHelperTextProps:J,fullWidth:te=!1,helperText:H,id:j,InputLabelProps:ne,inputProps:oe,InputProps:pe,inputRef:se,label:ie,maxRows:ce,minRows:we,multiline:xe=!1,name:$e,onBlur:Ze,onChange:ae,onFocus:ke,placeholder:ct,required:Xe=!1,rows:st,select:et=!1,SelectProps:gt,slots:zt={},slotProps:at={},type:Ye,value:Bt,variant:nt="outlined",...Rt}=u,Nt={...u,autoFocus:y,color:I,disabled:B,error:G,fullWidth:te,multiline:xe,required:Xe,select:et,variant:nt},gn=l$(Nt),Mt=ah(j),$t=H&&Mt?`${Mt}-helper-text`:void 0,Ut=ie&&Mt?`${Mt}-label`:void 0,hn=a$[nt],xn={slots:zt,slotProps:{input:pe,inputLabel:ne,htmlInput:oe,formHelperText:J,select:gt,...at}},Le={},Dn=xn.slotProps.inputLabel;nt==="outlined"&&(Dn&&typeof Dn.shrink<"u"&&(Le.notched=Dn.shrink),Le.label=ie),et&&((!gt||!gt.native)&&(Le.id=void 0),Le["aria-describedby"]=void 0);const[pn,zn]=Gi("input",{elementType:hn,externalForwardedProps:xn,additionalProps:Le,ownerState:Nt}),[_t,er]=Gi("inputLabel",{elementType:Cj,externalForwardedProps:xn,ownerState:Nt}),[pr,qn]=Gi("htmlInput",{elementType:"input",externalForwardedProps:xn,ownerState:Nt}),[_n,ir]=Gi("formHelperText",{elementType:YN,externalForwardedProps:xn,ownerState:Nt}),[cr,Er]=Gi("select",{elementType:PP,externalForwardedProps:xn,ownerState:Nt}),On=_e.jsx(pn,{"aria-describedby":$t,autoComplete:m,autoFocus:y,defaultValue:F,fullWidth:te,multiline:xe,name:$e,rows:st,maxRows:ce,minRows:we,type:Ye,value:Bt,id:Mt,inputRef:se,onBlur:Ze,onChange:ae,onFocus:ke,placeholder:ct,inputProps:qn,slots:{input:zt.htmlInput?pr:void 0},...zn});return _e.jsxs(c$,{className:Sn(gn.root,i),disabled:B,error:G,fullWidth:te,ref:s,required:Xe,color:I,variant:nt,ownerState:Nt,...Rt,children:[ie!=null&&ie!==""&&_e.jsx(_t,{htmlFor:Mt,id:Ut,...er,children:ie}),et?_e.jsx(cr,{"aria-describedby":$t,id:Mt,labelId:Ut,value:Bt,input:On,...Er,children:T}):On,H&&_e.jsx(_n,{id:$t,...ir,children:H})]})}),u$=Ti(_e.jsx("path",{d:"M20 1v3h3v2h-3v3h-2V6h-3V4h3V1zm-8 12c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m2-9.75V7h3v3h2.92c.05.39.08.79.08 1.2 0 3.32-2.67 7.25-8 11.8-5.33-4.55-8-8.48-8-11.8C4 6.22 7.8 3 12 3c.68 0 1.35.08 2 .25"}),"AddLocationAlt"),d$=Ti(_e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),h$=Ti(_e.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),p$=Ti(_e.jsx("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline"),f$=Ti(_e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft"),Zw=Ti(_e.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),m$=Ti(_e.jsx("path",{d:"M13.66 7c-.56-1.18-1.76-2-3.16-2H6V3h12v2h-3.26c.48.58.84 1.26 1.05 2H18v2h-2.02c-.25 2.8-2.61 5-5.48 5h-.73l6.73 7h-2.77L7 14v-2h3.5c1.76 0 3.22-1.3 3.46-3H6V7z"}),"CurrencyRupee"),g$=Ti(_e.jsx("path",{d:"m19.77 7.23.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77M18 10c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1M8 18v-4.5H6L10 6v5h2z"}),"EvStation"),_$=Ti(_e.jsx("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"}),"Google"),y$=Ti(_e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn"),LP=Ti(_e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock"),v$=Ti(_e.jsx("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout"),x$=Ti(_e.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Mail"),b$=Ti(_e.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),w$=Ti(_e.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),Xw=Ti(_e.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send"),S$=Ti(_e.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings"),zP=Ti(_e.jsx("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorder"),T$=Ti(_e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),E$=Ti(_e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),C$=(n,r)=>{switch(r.type){case"OPEN_LOGIN":return{...n,openLogin:!0};case"CLOSE_LOGIN":return{...n,openLogin:!1};case"START_LOADING":return{...n,loading:!0};case"STOP_LOADING":return{...n,loading:!1};case"UPDATE_ALERT":return{...n,alert:r.payload};case"UPDATE_PROFILE":return{...n,profile:r.payload};case"UPDATE_USER":return r.payload?(localStorage.setItem("currentUser",JSON.stringify(r.payload)),localStorage.setItem("token",r.payload.token)):(localStorage.removeItem("currentUser"),localStorage.removeItem("token")),{...n,currentUser:r.payload};case"UPDATE_IMAGES":return{...n,images:[...n.images||[],r.payload]};case"DELETE_IMAGE":return{...n,images:n.images.filter(s=>s!==r.payload)};case"UPDATE_LOCATION":return{...n,location:r.payload};case"UPDATE_DETAILS":return{...n,details:{...n.details,...r.payload}};case"RESET_STATION":return{...n,images:[],details:{title:"",description:"",price:10},location:{lng:0,lat:0}};case"UPDATE_STATIONS":return{...n,stations:r.payload,addressFilter:null,priceFilter:50,filteredStations:r.payload};case"FILTER_PRICE":return{...n,priceFilter:r.payload,filteredStations:lM(n.stations,n.addressFilter,r.payload)};case"FILTER_ADDRESS":return{...n,addressFilter:r.payload,filteredStations:lM(n.stations,r.payload,n.priceFilter)};case"CLEAR_ADDRESS":return{...n,addressFilter:null,priceFilter:50,filteredStations:n.stations};case"UPDATE_STATION":return{...n,station:r.payload};case"ADD_FEEDBACK":return{...n,stations:n.stations.map(s=>s._id===r.payload.stationId?{...s,feedback:[...s.feedback,r.payload.feedback]}:s)};case"UPDATE_STATION_RATING":return{...n,stations:n.stations.map(s=>s._id===r.payload.stationId?{...s,averageRating:r.payload.averageRating,totalRatings:r.payload.totalRatings}:s)};default:throw new Error("No matched action!")}},lM=(n,r,s)=>{let u=n;if(r){const{lng:m,lat:y}=r;u=u.filter(T=>{const i=m>T.lng?m-T.lng:T.lng-m,I=y>T.lat?y-T.lat:T.lat-y;return i<=1&&I<=1})}return s<50&&(u=u.filter(m=>m.price<=s)),u},DP={currentUser:null,openLogin:!1,alert:{open:!1,severity:"info",message:""},loading:!1,profile:{open:!1,file:null,photoURL:""},images:[],location:{lng:0,lat:0},details:{name:"",description:"",price:10},stations:[],priceFilter:50,addressFilter:null,filteredStations:[],station:null},OP=fe.createContext(DP),mo=()=>fe.useContext(OP),M$=({children:n})=>{const[r,s]=fe.useReducer(C$,DP),u=fe.useRef(),m=fe.useRef();return fe.useEffect(()=>{const y=JSON.parse(localStorage.getItem("currentUser"));y&&s({type:"UPDATE_USER",payload:y})},[]),_e.jsx(OP.Provider,{value:{state:r,dispatch:s,mapRef:u,containerRef:m},children:n})},cM=({passwordRef:n,id:r="password",label:s="Password"})=>{const[u,m]=fe.useState(!1),y=()=>m(!u),T=i=>i.preventDefault();return _e.jsx(Ff,{margin:"normal",label:s,type:u?"text":"password",fullWidth:!0,required:!0,variant:"standard",id:r,inputRef:n,slotProps:{htmlInput:{minLength:6},endAdorment:_e.jsx(Gw,{position:"end",children:_e.jsx(fu,{onClick:y,onMouseDown:T,children:u?_e.jsx(E$,{}):_e.jsx(T$,{})})})}})};class A_ extends Error{}A_.prototype.name="InvalidTokenError";function I$(n){return decodeURIComponent(atob(n).replace(/(.)/g,(r,s)=>{let u=s.charCodeAt(0).toString(16).toUpperCase();return u.length<2&&(u="0"+u),"%"+u}))}function A$(n){let r=n.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return I$(r)}catch{return atob(r)}}function FP(n,r){if(typeof n!="string")throw new A_("Invalid token specified: must be a string");r||(r={});const s=r.header===!0?0:1,u=n.split(".")[s];if(typeof u!="string")throw new A_(`Invalid token specified: missing part #${s+1}`);let m;try{m=A$(u)}catch(y){throw new A_(`Invalid token specified: invalid base64 for part #${s+1} (${y.message})`)}try{return JSON.parse(m)}catch(y){throw new A_(`Invalid token specified: invalid json for part #${s+1} (${y.message})`)}}const P$=()=>{const{dispatch:n}=mo(),[r,s]=fe.useState(!1);fe.useEffect(()=>{(()=>{try{window.google.accounts.id.initialize({client_id:"386589665303-irhd6aqotku0e51knhvude0ig8p1cahn.apps.googleusercontent.com",callback:u,prompt_parent_id:"google-one-tap"}),window.google.accounts.id.prompt()}catch(T){console.error("Error initializing Google One Tap:",T)}})()},[]);const u=y=>{const T=y.credential,i=FP(T),{sub:I,email:F,name:B,picture:G}=i;n({type:"UPDATE_USER",payload:{id:I,email:F,name:B,photoURL:G,token:T,google:!0}}),n({type:"CLOSE_LOGIN"})},m=()=>{s(!0);try{window.google.accounts.id.prompt()}catch(y){console.error("Error prompting Google One Tap:",y)}};return _e.jsx("div",{id:"google-one-tap",children:_e.jsx(cd,{variant:"contained",color:"primary",startIcon:_e.jsx(_$,{}),onClick:m,disabled:r,children:"Login with Google"})})},R$="modulepreload",k$=function(n){return"/"+n},uM={},Bf=function(r,s,u){let m=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const T=document.querySelector("meta[property=csp-nonce]"),i=(T==null?void 0:T.nonce)||(T==null?void 0:T.getAttribute("nonce"));m=Promise.allSettled(s.map(I=>{if(I=k$(I),I in uM)return;uM[I]=!0;const F=I.endsWith(".css"),B=F?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${I}"]${B}`))return;const G=document.createElement("link");if(G.rel=F?"stylesheet":R$,F||(G.as="script"),G.crossOrigin="",G.href=I,i&&G.setAttribute("nonce",i),document.head.appendChild(G),F)return new Promise((J,te)=>{G.addEventListener("load",J),G.addEventListener("error",()=>te(new Error(`Unable to preload CSS for ${I}`)))})}))}function y(T){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=T,window.dispatchEvent(i),!i.defaultPrevented)throw T}return m.then(T=>{for(const i of T||[])i.status==="rejected"&&y(i.reason);return r().catch(y)})},L$=n=>{let r;return n?r=n:typeof fetch>"u"?r=(...s)=>Bf(async()=>{const{default:u}=await Promise.resolve().then(()=>dg);return{default:u}},void 0).then(({default:u})=>u(...s)):r=fetch,(...s)=>r(...s)};class Yw extends Error{constructor(r,s="FunctionsError",u){super(r),this.name=s,this.context=u}}class z$ extends Yw{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class D$ extends Yw{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class O$ extends Yw{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var G1;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(G1||(G1={}));var F$=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};class B${constructor(r,{headers:s={},customFetch:u,region:m=G1.Any}={}){this.url=r,this.headers=s,this.region=m,this.fetch=L$(u)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,s={}){var u;return F$(this,void 0,void 0,function*(){try{const{headers:m,method:y,body:T}=s;let i={},{region:I}=s;I||(I=this.region),I&&I!=="any"&&(i["x-region"]=I);let F;T&&(m&&!Object.prototype.hasOwnProperty.call(m,"Content-Type")||!m)&&(typeof Blob<"u"&&T instanceof Blob||T instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",F=T):typeof T=="string"?(i["Content-Type"]="text/plain",F=T):typeof FormData<"u"&&T instanceof FormData?F=T:(i["Content-Type"]="application/json",F=JSON.stringify(T)));const B=yield this.fetch(`${this.url}/${r}`,{method:y||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),m),body:F}).catch(H=>{throw new z$(H)}),G=B.headers.get("x-relay-error");if(G&&G==="true")throw new D$(B);if(!B.ok)throw new O$(B);let J=((u=B.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),te;return J==="application/json"?te=yield B.json():J==="application/octet-stream"?te=yield B.blob():J==="text/event-stream"?te=B:J==="multipart/form-data"?te=yield B.formData():te=yield B.text(),{data:te,error:null}}catch(m){return{data:null,error:m}}})}}var Js={},h_={},p_={},f_={},m_={},g_={},N$=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},og=N$();const j$=og.fetch,BP=og.fetch.bind(og),NP=og.Headers,U$=og.Request,$$=og.Response,dg=Object.freeze(Object.defineProperty({__proto__:null,Headers:NP,Request:U$,Response:$$,default:BP,fetch:j$},Symbol.toStringTag,{value:"Module"})),V$=iA(dg);var yv={},dM;function jP(){if(dM)return yv;dM=1,Object.defineProperty(yv,"__esModule",{value:!0});class n extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return yv.default=n,yv}var hM;function UP(){if(hM)return g_;hM=1;var n=g_.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(g_,"__esModule",{value:!0});const r=n(V$),s=n(jP());class u{constructor(y){this.shouldThrowOnError=!1,this.method=y.method,this.url=y.url,this.headers=y.headers,this.schema=y.schema,this.body=y.body,this.shouldThrowOnError=y.shouldThrowOnError,this.signal=y.signal,this.isMaybeSingle=y.isMaybeSingle,y.fetch?this.fetch=y.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(y,T){return this.headers=Object.assign({},this.headers),this.headers[y]=T,this}then(y,T){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let I=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async F=>{var B,G,J;let te=null,H=null,j=null,ne=F.status,oe=F.statusText;if(F.ok){if(this.method!=="HEAD"){const ce=await F.text();ce===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?H=ce:H=JSON.parse(ce))}const se=(B=this.headers.Prefer)===null||B===void 0?void 0:B.match(/count=(exact|planned|estimated)/),ie=(G=F.headers.get("content-range"))===null||G===void 0?void 0:G.split("/");se&&ie&&ie.length>1&&(j=parseInt(ie[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(H)&&(H.length>1?(te={code:"PGRST116",details:`Results contain ${H.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},H=null,j=null,ne=406,oe="Not Acceptable"):H.length===1?H=H[0]:H=null)}else{const se=await F.text();try{te=JSON.parse(se),Array.isArray(te)&&F.status===404&&(H=[],te=null,ne=200,oe="OK")}catch{F.status===404&&se===""?(ne=204,oe="No Content"):te={message:se}}if(te&&this.isMaybeSingle&&(!((J=te==null?void 0:te.details)===null||J===void 0)&&J.includes("0 rows"))&&(te=null,ne=200,oe="OK"),te&&this.shouldThrowOnError)throw new s.default(te)}return{error:te,data:H,count:j,status:ne,statusText:oe}});return this.shouldThrowOnError||(I=I.catch(F=>{var B,G,J;return{error:{message:`${(B=F==null?void 0:F.name)!==null&&B!==void 0?B:"FetchError"}: ${F==null?void 0:F.message}`,details:`${(G=F==null?void 0:F.stack)!==null&&G!==void 0?G:""}`,hint:"",code:`${(J=F==null?void 0:F.code)!==null&&J!==void 0?J:""}`},data:null,count:null,status:0,statusText:""}})),I.then(y,T)}}return g_.default=u,g_}var pM;function $P(){if(pM)return m_;pM=1;var n=m_.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(m_,"__esModule",{value:!0});const r=n(UP());class s extends r.default{select(m){let y=!1;const T=(m??"*").split("").map(i=>/\s/.test(i)&&!y?"":(i==='"'&&(y=!y),i)).join("");return this.url.searchParams.set("select",T),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(m,{ascending:y=!0,nullsFirst:T,foreignTable:i,referencedTable:I=i}={}){const F=I?`${I}.order`:"order",B=this.url.searchParams.get(F);return this.url.searchParams.set(F,`${B?`${B},`:""}${m}.${y?"asc":"desc"}${T===void 0?"":T?".nullsfirst":".nullslast"}`),this}limit(m,{foreignTable:y,referencedTable:T=y}={}){const i=typeof T>"u"?"limit":`${T}.limit`;return this.url.searchParams.set(i,`${m}`),this}range(m,y,{foreignTable:T,referencedTable:i=T}={}){const I=typeof i>"u"?"offset":`${i}.offset`,F=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(I,`${m}`),this.url.searchParams.set(F,`${y-m+1}`),this}abortSignal(m){return this.signal=m,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:m=!1,verbose:y=!1,settings:T=!1,buffers:i=!1,wal:I=!1,format:F="text"}={}){var B;const G=[m?"analyze":null,y?"verbose":null,T?"settings":null,i?"buffers":null,I?"wal":null].filter(Boolean).join("|"),J=(B=this.headers.Accept)!==null&&B!==void 0?B:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${F}; for="${J}"; options=${G};`,F==="json"?this:this}rollback(){var m;return((m=this.headers.Prefer)!==null&&m!==void 0?m:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return m_.default=s,m_}var fM;function Kw(){if(fM)return f_;fM=1;var n=f_.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(f_,"__esModule",{value:!0});const r=n($P());class s extends r.default{eq(m,y){return this.url.searchParams.append(m,`eq.${y}`),this}neq(m,y){return this.url.searchParams.append(m,`neq.${y}`),this}gt(m,y){return this.url.searchParams.append(m,`gt.${y}`),this}gte(m,y){return this.url.searchParams.append(m,`gte.${y}`),this}lt(m,y){return this.url.searchParams.append(m,`lt.${y}`),this}lte(m,y){return this.url.searchParams.append(m,`lte.${y}`),this}like(m,y){return this.url.searchParams.append(m,`like.${y}`),this}likeAllOf(m,y){return this.url.searchParams.append(m,`like(all).{${y.join(",")}}`),this}likeAnyOf(m,y){return this.url.searchParams.append(m,`like(any).{${y.join(",")}}`),this}ilike(m,y){return this.url.searchParams.append(m,`ilike.${y}`),this}ilikeAllOf(m,y){return this.url.searchParams.append(m,`ilike(all).{${y.join(",")}}`),this}ilikeAnyOf(m,y){return this.url.searchParams.append(m,`ilike(any).{${y.join(",")}}`),this}is(m,y){return this.url.searchParams.append(m,`is.${y}`),this}in(m,y){const T=Array.from(new Set(y)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(m,`in.(${T})`),this}contains(m,y){return typeof y=="string"?this.url.searchParams.append(m,`cs.${y}`):Array.isArray(y)?this.url.searchParams.append(m,`cs.{${y.join(",")}}`):this.url.searchParams.append(m,`cs.${JSON.stringify(y)}`),this}containedBy(m,y){return typeof y=="string"?this.url.searchParams.append(m,`cd.${y}`):Array.isArray(y)?this.url.searchParams.append(m,`cd.{${y.join(",")}}`):this.url.searchParams.append(m,`cd.${JSON.stringify(y)}`),this}rangeGt(m,y){return this.url.searchParams.append(m,`sr.${y}`),this}rangeGte(m,y){return this.url.searchParams.append(m,`nxl.${y}`),this}rangeLt(m,y){return this.url.searchParams.append(m,`sl.${y}`),this}rangeLte(m,y){return this.url.searchParams.append(m,`nxr.${y}`),this}rangeAdjacent(m,y){return this.url.searchParams.append(m,`adj.${y}`),this}overlaps(m,y){return typeof y=="string"?this.url.searchParams.append(m,`ov.${y}`):this.url.searchParams.append(m,`ov.{${y.join(",")}}`),this}textSearch(m,y,{config:T,type:i}={}){let I="";i==="plain"?I="pl":i==="phrase"?I="ph":i==="websearch"&&(I="w");const F=T===void 0?"":`(${T})`;return this.url.searchParams.append(m,`${I}fts${F}.${y}`),this}match(m){return Object.entries(m).forEach(([y,T])=>{this.url.searchParams.append(y,`eq.${T}`)}),this}not(m,y,T){return this.url.searchParams.append(m,`not.${y}.${T}`),this}or(m,{foreignTable:y,referencedTable:T=y}={}){const i=T?`${T}.or`:"or";return this.url.searchParams.append(i,`(${m})`),this}filter(m,y,T){return this.url.searchParams.append(m,`${y}.${T}`),this}}return f_.default=s,f_}var mM;function VP(){if(mM)return p_;mM=1;var n=p_.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(p_,"__esModule",{value:!0});const r=n(Kw());class s{constructor(m,{headers:y={},schema:T,fetch:i}){this.url=m,this.headers=y,this.schema=T,this.fetch=i}select(m,{head:y=!1,count:T}={}){const i=y?"HEAD":"GET";let I=!1;const F=(m??"*").split("").map(B=>/\s/.test(B)&&!I?"":(B==='"'&&(I=!I),B)).join("");return this.url.searchParams.set("select",F),T&&(this.headers.Prefer=`count=${T}`),new r.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(m,{count:y,defaultToNull:T=!0}={}){const i="POST",I=[];if(this.headers.Prefer&&I.push(this.headers.Prefer),y&&I.push(`count=${y}`),T||I.push("missing=default"),this.headers.Prefer=I.join(","),Array.isArray(m)){const F=m.reduce((B,G)=>B.concat(Object.keys(G)),[]);if(F.length>0){const B=[...new Set(F)].map(G=>`"${G}"`);this.url.searchParams.set("columns",B.join(","))}}return new r.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:m,fetch:this.fetch,allowEmpty:!1})}upsert(m,{onConflict:y,ignoreDuplicates:T=!1,count:i,defaultToNull:I=!0}={}){const F="POST",B=[`resolution=${T?"ignore":"merge"}-duplicates`];if(y!==void 0&&this.url.searchParams.set("on_conflict",y),this.headers.Prefer&&B.push(this.headers.Prefer),i&&B.push(`count=${i}`),I||B.push("missing=default"),this.headers.Prefer=B.join(","),Array.isArray(m)){const G=m.reduce((J,te)=>J.concat(Object.keys(te)),[]);if(G.length>0){const J=[...new Set(G)].map(te=>`"${te}"`);this.url.searchParams.set("columns",J.join(","))}}return new r.default({method:F,url:this.url,headers:this.headers,schema:this.schema,body:m,fetch:this.fetch,allowEmpty:!1})}update(m,{count:y}={}){const T="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),y&&i.push(`count=${y}`),this.headers.Prefer=i.join(","),new r.default({method:T,url:this.url,headers:this.headers,schema:this.schema,body:m,fetch:this.fetch,allowEmpty:!1})}delete({count:m}={}){const y="DELETE",T=[];return m&&T.push(`count=${m}`),this.headers.Prefer&&T.unshift(this.headers.Prefer),this.headers.Prefer=T.join(","),new r.default({method:y,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return p_.default=s,p_}var __={},y_={},gM;function G$(){return gM||(gM=1,Object.defineProperty(y_,"__esModule",{value:!0}),y_.version=void 0,y_.version="0.0.0-automated"),y_}var _M;function q$(){if(_M)return __;_M=1,Object.defineProperty(__,"__esModule",{value:!0}),__.DEFAULT_HEADERS=void 0;const n=G$();return __.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},__}var yM;function W$(){if(yM)return h_;yM=1;var n=h_.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(h_,"__esModule",{value:!0});const r=n(VP()),s=n(Kw()),u=q$();class m{constructor(T,{headers:i={},schema:I,fetch:F}={}){this.url=T,this.headers=Object.assign(Object.assign({},u.DEFAULT_HEADERS),i),this.schemaName=I,this.fetch=F}from(T){const i=new URL(`${this.url}/${T}`);return new r.default(i,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(T){return new m(this.url,{headers:this.headers,schema:T,fetch:this.fetch})}rpc(T,i={},{head:I=!1,get:F=!1,count:B}={}){let G;const J=new URL(`${this.url}/rpc/${T}`);let te;I||F?(G=I?"HEAD":"GET",Object.entries(i).filter(([j,ne])=>ne!==void 0).map(([j,ne])=>[j,Array.isArray(ne)?`{${ne.join(",")}}`:`${ne}`]).forEach(([j,ne])=>{J.searchParams.append(j,ne)})):(G="POST",te=i);const H=Object.assign({},this.headers);return B&&(H.Prefer=`count=${B}`),new s.default({method:G,url:J,headers:H,schema:this.schemaName,body:te,fetch:this.fetch,allowEmpty:!1})}}return h_.default=m,h_}var vM;function H$(){if(vM)return Js;vM=1;var n=Js.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Js,"__esModule",{value:!0}),Js.PostgrestError=Js.PostgrestBuilder=Js.PostgrestTransformBuilder=Js.PostgrestFilterBuilder=Js.PostgrestQueryBuilder=Js.PostgrestClient=void 0;const r=n(W$());Js.PostgrestClient=r.default;const s=n(VP());Js.PostgrestQueryBuilder=s.default;const u=n(Kw());Js.PostgrestFilterBuilder=u.default;const m=n($P());Js.PostgrestTransformBuilder=m.default;const y=n(UP());Js.PostgrestBuilder=y.default;const T=n(jP());return Js.PostgrestError=T.default,Js.default={PostgrestClient:r.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:u.default,PostgrestTransformBuilder:m.default,PostgrestBuilder:y.default,PostgrestError:T.default},Js}var Z$=H$();const X$=Uf(Z$),{PostgrestClient:Y$,PostgrestQueryBuilder:b9,PostgrestFilterBuilder:w9,PostgrestTransformBuilder:S9,PostgrestBuilder:T9,PostgrestError:E9}=X$,K$="2.11.2",J$={"X-Client-Info":`realtime-js/${K$}`},Q$="1.0.0",GP=1e4,eV=1e3;var Ym;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ym||(Ym={}));var Dl;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Dl||(Dl={}));var pu;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(pu||(pu={}));var q1;(function(n){n.websocket="websocket"})(q1||(q1={}));var Tf;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Tf||(Tf={}));class tV{constructor(){this.HEADER_LENGTH=1}decode(r,s){return r.constructor===ArrayBuffer?s(this._binaryDecode(r)):s(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const s=new DataView(r),u=new TextDecoder;return this._decodeBroadcast(r,s,u)}_decodeBroadcast(r,s,u){const m=s.getUint8(1),y=s.getUint8(2);let T=this.HEADER_LENGTH+2;const i=u.decode(r.slice(T,T+m));T=T+m;const I=u.decode(r.slice(T,T+y));T=T+y;const F=JSON.parse(u.decode(r.slice(T,r.byteLength)));return{ref:null,topic:i,event:I,payload:F}}}class qP{constructor(r,s){this.callback=r,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var oo;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(oo||(oo={}));const xM=(n,r,s={})=>{var u;const m=(u=s.skipTypes)!==null&&u!==void 0?u:[];return Object.keys(r).reduce((y,T)=>(y[T]=nV(T,n,r,m),y),{})},nV=(n,r,s,u)=>{const m=r.find(i=>i.name===n),y=m==null?void 0:m.type,T=s[n];return y&&!u.includes(y)?WP(y,T):W1(T)},WP=(n,r)=>{if(n.charAt(0)==="_"){const s=n.slice(1,n.length);return sV(r,s)}switch(n){case oo.bool:return rV(r);case oo.float4:case oo.float8:case oo.int2:case oo.int4:case oo.int8:case oo.numeric:case oo.oid:return iV(r);case oo.json:case oo.jsonb:return oV(r);case oo.timestamp:return aV(r);case oo.abstime:case oo.date:case oo.daterange:case oo.int4range:case oo.int8range:case oo.money:case oo.reltime:case oo.text:case oo.time:case oo.timestamptz:case oo.timetz:case oo.tsrange:case oo.tstzrange:return W1(r);default:return W1(r)}},W1=n=>n,rV=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},iV=n=>{if(typeof n=="string"){const r=parseFloat(n);if(!Number.isNaN(r))return r}return n},oV=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(r){return console.log(`JSON parse error: ${r}`),n}return n},sV=(n,r)=>{if(typeof n!="string")return n;const s=n.length-1,u=n[s];if(n[0]==="{"&&u==="}"){let y;const T=n.slice(1,s);try{y=JSON.parse("["+T+"]")}catch{y=T?T.split(","):[]}return y.map(i=>WP(r,i))}return n},aV=n=>typeof n=="string"?n.replace(" ","T"):n,HP=n=>{let r=n;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class Sb{constructor(r,s,u={},m=GP){this.channel=r,this.event=s,this.payload=u,this.timeout=m,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,s){var u;return this._hasReceived(r)&&s((u=this.receivedResp)===null||u===void 0?void 0:u.response),this.recHooks.push({status:r,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:s}){this.recHooks.filter(u=>u.status===r).forEach(u=>u.callback(s))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var bM;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(bM||(bM={}));class B_{constructor(r,s){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const u=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(u.state,{},m=>{const{onJoin:y,onLeave:T,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=B_.syncState(this.state,m,y,T),this.pendingDiffs.forEach(I=>{this.state=B_.syncDiff(this.state,I,y,T)}),this.pendingDiffs=[],i()}),this.channel._on(u.diff,{},m=>{const{onJoin:y,onLeave:T,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(m):(this.state=B_.syncDiff(this.state,m,y,T),i())}),this.onJoin((m,y,T)=>{this.channel._trigger("presence",{event:"join",key:m,currentPresences:y,newPresences:T})}),this.onLeave((m,y,T)=>{this.channel._trigger("presence",{event:"leave",key:m,currentPresences:y,leftPresences:T})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,s,u,m){const y=this.cloneDeep(r),T=this.transformState(s),i={},I={};return this.map(y,(F,B)=>{T[F]||(I[F]=B)}),this.map(T,(F,B)=>{const G=y[F];if(G){const J=B.map(ne=>ne.presence_ref),te=G.map(ne=>ne.presence_ref),H=B.filter(ne=>te.indexOf(ne.presence_ref)<0),j=G.filter(ne=>J.indexOf(ne.presence_ref)<0);H.length>0&&(i[F]=H),j.length>0&&(I[F]=j)}else i[F]=B}),this.syncDiff(y,{joins:i,leaves:I},u,m)}static syncDiff(r,s,u,m){const{joins:y,leaves:T}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return u||(u=()=>{}),m||(m=()=>{}),this.map(y,(i,I)=>{var F;const B=(F=r[i])!==null&&F!==void 0?F:[];if(r[i]=this.cloneDeep(I),B.length>0){const G=r[i].map(te=>te.presence_ref),J=B.filter(te=>G.indexOf(te.presence_ref)<0);r[i].unshift(...J)}u(i,B,I)}),this.map(T,(i,I)=>{let F=r[i];if(!F)return;const B=I.map(G=>G.presence_ref);F=F.filter(G=>B.indexOf(G.presence_ref)<0),r[i]=F,m(i,F,I),F.length===0&&delete r[i]}),r}static map(r,s){return Object.getOwnPropertyNames(r).map(u=>s(u,r[u]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((s,u)=>{const m=r[u];return"metas"in m?s[u]=m.metas.map(y=>(y.presence_ref=y.phx_ref,delete y.phx_ref,delete y.phx_ref_prev,y)):s[u]=m,s},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var wM;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(wM||(wM={}));var SM;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(SM||(SM={}));var ih;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ih||(ih={}));class Jw{constructor(r,s={config:{}},u){this.topic=r,this.params=s,this.socket=u,this.bindings={},this.state=Dl.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Sb(this,pu.join,this.params,this.timeout),this.rejoinTimer=new qP(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Dl.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(m=>m.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Dl.closed,this.socket._remove(this)}),this._onError(m=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,m),this.state=Dl.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Dl.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pu.reply,{},(m,y)=>{this._trigger(this._replyEventName(y),m)}),this.presence=new B_(this),this.broadcastEndpointURL=HP(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,s=this.timeout){var u,m;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:y,presence:T,private:i}}=this.params;this._onError(B=>r==null?void 0:r(ih.CHANNEL_ERROR,B)),this._onClose(()=>r==null?void 0:r(ih.CLOSED));const I={},F={broadcast:y,presence:T,postgres_changes:(m=(u=this.bindings.postgres_changes)===null||u===void 0?void 0:u.map(B=>B.filter))!==null&&m!==void 0?m:[],private:i};this.socket.accessTokenValue&&(I.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:F},I)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:B})=>{var G;if(this.socket.setAuth(),B===void 0){r==null||r(ih.SUBSCRIBED);return}else{const J=this.bindings.postgres_changes,te=(G=J==null?void 0:J.length)!==null&&G!==void 0?G:0,H=[];for(let j=0;j<te;j++){const ne=J[j],{filter:{event:oe,schema:pe,table:se,filter:ie}}=ne,ce=B&&B[j];if(ce&&ce.event===oe&&ce.schema===pe&&ce.table===se&&ce.filter===ie)H.push(Object.assign(Object.assign({},ne),{id:ce.id}));else{this.unsubscribe(),r==null||r(ih.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=H,r&&r(ih.SUBSCRIBED);return}}).receive("error",B=>{r==null||r(ih.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(B).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(ih.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,s={}){return await this.send({type:"presence",event:"track",payload:r},s.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,s,u){return this._on(r,s,u)}async send(r,s={}){var u,m;if(!this._canPush()&&r.type==="broadcast"){const{event:y,payload:T}=r,I={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:y,payload:T,private:this.private}]})};try{const F=await this._fetchWithTimeout(this.broadcastEndpointURL,I,(u=s.timeout)!==null&&u!==void 0?u:this.timeout);return await((m=F.body)===null||m===void 0?void 0:m.cancel()),F.ok?"ok":"error"}catch(F){return F.name==="AbortError"?"timed out":"error"}}else return new Promise(y=>{var T,i,I;const F=this._push(r.type,r,s.timeout||this.timeout);r.type==="broadcast"&&!(!((I=(i=(T=this.params)===null||T===void 0?void 0:T.config)===null||i===void 0?void 0:i.broadcast)===null||I===void 0)&&I.ack)&&y("ok"),F.receive("ok",()=>y("ok")),F.receive("error",()=>y("error")),F.receive("timeout",()=>y("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Dl.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pu.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(u=>{const m=new Sb(this,pu.leave,{},r);m.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),m.send(),this._canPush()||m.trigger("ok",{})})}async _fetchWithTimeout(r,s,u){const m=new AbortController,y=setTimeout(()=>m.abort(),u),T=await this.socket.fetch(r,Object.assign(Object.assign({},s),{signal:m.signal}));return clearTimeout(y),T}_push(r,s,u=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let m=new Sb(this,r,s,u);return this._canPush()?m.send():(m.startTimeout(),this.pushBuffer.push(m)),m}_onMessage(r,s,u){return s}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,s,u){var m,y;const T=r.toLocaleLowerCase(),{close:i,error:I,leave:F,join:B}=pu;if(u&&[i,I,F,B].indexOf(T)>=0&&u!==this._joinRef())return;let J=this._onMessage(T,s,u);if(s&&!J)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(T)?(m=this.bindings.postgres_changes)===null||m===void 0||m.filter(te=>{var H,j,ne;return((H=te.filter)===null||H===void 0?void 0:H.event)==="*"||((ne=(j=te.filter)===null||j===void 0?void 0:j.event)===null||ne===void 0?void 0:ne.toLocaleLowerCase())===T}).map(te=>te.callback(J,u)):(y=this.bindings[T])===null||y===void 0||y.filter(te=>{var H,j,ne,oe,pe,se;if(["broadcast","presence","postgres_changes"].includes(T))if("id"in te){const ie=te.id,ce=(H=te.filter)===null||H===void 0?void 0:H.event;return ie&&((j=s.ids)===null||j===void 0?void 0:j.includes(ie))&&(ce==="*"||(ce==null?void 0:ce.toLocaleLowerCase())===((ne=s.data)===null||ne===void 0?void 0:ne.type.toLocaleLowerCase()))}else{const ie=(pe=(oe=te==null?void 0:te.filter)===null||oe===void 0?void 0:oe.event)===null||pe===void 0?void 0:pe.toLocaleLowerCase();return ie==="*"||ie===((se=s==null?void 0:s.event)===null||se===void 0?void 0:se.toLocaleLowerCase())}else return te.type.toLocaleLowerCase()===T}).map(te=>{if(typeof J=="object"&&"ids"in J){const H=J.data,{schema:j,table:ne,commit_timestamp:oe,type:pe,errors:se}=H;J=Object.assign(Object.assign({},{schema:j,table:ne,commit_timestamp:oe,eventType:pe,new:{},old:{},errors:se}),this._getPayloadRecords(H))}te.callback(J,u)})}_isClosed(){return this.state===Dl.closed}_isJoined(){return this.state===Dl.joined}_isJoining(){return this.state===Dl.joining}_isLeaving(){return this.state===Dl.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,s,u){const m=r.toLocaleLowerCase(),y={type:m,filter:s,callback:u};return this.bindings[m]?this.bindings[m].push(y):this.bindings[m]=[y],this}_off(r,s){const u=r.toLocaleLowerCase();return this.bindings[u]=this.bindings[u].filter(m=>{var y;return!(((y=m.type)===null||y===void 0?void 0:y.toLocaleLowerCase())===u&&Jw.isEqual(m.filter,s))}),this}static isEqual(r,s){if(Object.keys(r).length!==Object.keys(s).length)return!1;for(const u in r)if(r[u]!==s[u])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(pu.close,{},r)}_onError(r){this._on(pu.error,{},s=>r(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Dl.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const s={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(s.new=xM(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(s.old=xM(r.columns,r.old_record)),s}}const lV=()=>{},cV=typeof WebSocket<"u",uV=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class dV{constructor(r,s){var u;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=J$,this.params={},this.timeout=GP,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=lV,this.conn=null,this.sendBuffer=[],this.serializer=new tV,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=y=>{let T;return y?T=y:typeof fetch>"u"?T=(...i)=>Bf(async()=>{const{default:I}=await Promise.resolve().then(()=>dg);return{default:I}},void 0).then(({default:I})=>I(...i)):T=fetch,(...i)=>T(...i)},this.endPoint=`${r}/${q1.websocket}`,this.httpEndpoint=HP(r),s!=null&&s.transport?this.transport=s.transport:this.transport=null,s!=null&&s.params&&(this.params=s.params),s!=null&&s.headers&&(this.headers=Object.assign(Object.assign({},this.headers),s.headers)),s!=null&&s.timeout&&(this.timeout=s.timeout),s!=null&&s.logger&&(this.logger=s.logger),s!=null&&s.heartbeatIntervalMs&&(this.heartbeatIntervalMs=s.heartbeatIntervalMs);const m=(u=s==null?void 0:s.params)===null||u===void 0?void 0:u.apikey;if(m&&(this.accessTokenValue=m,this.apiKey=m),this.reconnectAfterMs=s!=null&&s.reconnectAfterMs?s.reconnectAfterMs:y=>[1e3,2e3,5e3,1e4][y-1]||1e4,this.encode=s!=null&&s.encode?s.encode:(y,T)=>T(JSON.stringify(y)),this.decode=s!=null&&s.decode?s.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new qP(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(s==null?void 0:s.fetch),s!=null&&s.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(s==null?void 0:s.worker)||!1,this.workerUrl=s==null?void 0:s.workerUrl}this.accessToken=(s==null?void 0:s.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(cV){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new hV(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Bf(async()=>{const{default:r}=await import("./browser-BCmvARlA.js").then(s=>s.b);return{default:r}},[]).then(({default:r})=>{this.conn=new r(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Q$}))}disconnect(r,s){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,s??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(r){const s=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const r=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.disconnect(),r}log(r,s,u){this.logger(r,s,u)}connectionState(){switch(this.conn&&this.conn.readyState){case Ym.connecting:return Tf.Connecting;case Ym.open:return Tf.Open;case Ym.closing:return Tf.Closing;default:return Tf.Closed}}isConnected(){return this.connectionState()===Tf.Open}channel(r,s={config:{}}){const u=new Jw(`realtime:${r}`,s,this);return this.channels.push(u),u}push(r){const{topic:s,event:u,payload:m,ref:y}=r,T=()=>{this.encode(r,i=>{var I;(I=this.conn)===null||I===void 0||I.send(i)})};this.log("push",`${s} ${u} (${y})`,m),this.isConnected()?T():this.sendBuffer.push(T)}async setAuth(r=null){let s=r||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(s){let u=null;try{u=JSON.parse(atob(s.split(".")[1]))}catch{}if(u&&u.exp&&!(Math.floor(Date.now()/1e3)-u.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${u.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${u.exp}`);this.accessTokenValue=s,this.channels.forEach(m=>{s&&m.updateJoinPayload({access_token:s}),m.joinedOnce&&m._isJoined()&&m._push(pu.access_token,{access_token:s})})}}async sendHeartbeat(){var r;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(r=this.conn)===null||r===void 0||r.close(eV,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let s=this.channels.find(u=>u.topic===r&&(u._isJoined()||u._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${r}"`),s.unsubscribe())}_remove(r){this.channels=this.channels.filter(s=>s._joinRef()!==r._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,s=>{let{topic:u,event:m,payload:y,ref:T}=s;T&&T===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${y.status||""} ${u} ${m} ${T&&"("+T+")"||""}`,y),this.channels.filter(i=>i._isMember(u)).forEach(i=>i._trigger(m,y,T)),this.stateChangeCallbacks.message.forEach(i=>i(s))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(r=>r())}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(s=>s(r))}_onConnError(r){this.log("transport",r.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(s=>s(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(pu.error))}_appendParams(r,s){if(Object.keys(s).length===0)return r;const u=r.match(/\?/)?"&":"?",m=new URLSearchParams(s);return`${r}${u}${m}`}_workerObjectUrl(r){let s;if(r)s=r;else{const u=new Blob([uV],{type:"application/javascript"});s=URL.createObjectURL(u)}return s}}class hV{constructor(r,s,u){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ym.connecting,this.send=()=>{},this.url=null,this.url=r,this.close=u.close}}class Qw extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Ps(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class pV extends Qw{constructor(r,s){super(r),this.name="StorageApiError",this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class H1 extends Qw{constructor(r,s){super(r),this.name="StorageUnknownError",this.originalError=s}}var fV=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};const ZP=n=>{let r;return n?r=n:typeof fetch>"u"?r=(...s)=>Bf(async()=>{const{default:u}=await Promise.resolve().then(()=>dg);return{default:u}},void 0).then(({default:u})=>u(...s)):r=fetch,(...s)=>r(...s)},mV=()=>fV(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Bf(()=>Promise.resolve().then(()=>dg),void 0)).Response:Response}),Z1=n=>{if(Array.isArray(n))return n.map(s=>Z1(s));if(typeof n=="function"||n!==Object(n))return n;const r={};return Object.entries(n).forEach(([s,u])=>{const m=s.replace(/([-_][a-z])/gi,y=>y.toUpperCase().replace(/[-_]/g,""));r[m]=Z1(u)}),r};var $f=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};const Tb=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),gV=(n,r,s)=>$f(void 0,void 0,void 0,function*(){const u=yield mV();n instanceof u&&!(s!=null&&s.noResolveJson)?n.json().then(m=>{r(new pV(Tb(m),n.status||500))}).catch(m=>{r(new H1(Tb(m),m))}):r(new H1(Tb(n),n))}),_V=(n,r,s,u)=>{const m={method:n,headers:(r==null?void 0:r.headers)||{}};return n==="GET"?m:(m.headers=Object.assign({"Content-Type":"application/json"},r==null?void 0:r.headers),u&&(m.body=JSON.stringify(u)),Object.assign(Object.assign({},m),s))};function dy(n,r,s,u,m,y){return $f(this,void 0,void 0,function*(){return new Promise((T,i)=>{n(s,_V(r,u,m,y)).then(I=>{if(!I.ok)throw I;return u!=null&&u.noResolveJson?I:I.json()}).then(I=>T(I)).catch(I=>gV(I,i,u))})})}function Jv(n,r,s,u){return $f(this,void 0,void 0,function*(){return dy(n,"GET",r,s,u)})}function mp(n,r,s,u,m){return $f(this,void 0,void 0,function*(){return dy(n,"POST",r,u,m,s)})}function yV(n,r,s,u,m){return $f(this,void 0,void 0,function*(){return dy(n,"PUT",r,u,m,s)})}function vV(n,r,s,u){return $f(this,void 0,void 0,function*(){return dy(n,"HEAD",r,Object.assign(Object.assign({},s),{noResolveJson:!0}),u)})}function XP(n,r,s,u,m){return $f(this,void 0,void 0,function*(){return dy(n,"DELETE",r,u,m,s)})}var nl=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};const xV={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},TM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class bV{constructor(r,s={},u,m){this.url=r,this.headers=s,this.bucketId=u,this.fetch=ZP(m)}uploadOrUpdate(r,s,u,m){return nl(this,void 0,void 0,function*(){try{let y;const T=Object.assign(Object.assign({},TM),m);let i=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(T.upsert)});const I=T.metadata;typeof Blob<"u"&&u instanceof Blob?(y=new FormData,y.append("cacheControl",T.cacheControl),I&&y.append("metadata",this.encodeMetadata(I)),y.append("",u)):typeof FormData<"u"&&u instanceof FormData?(y=u,y.append("cacheControl",T.cacheControl),I&&y.append("metadata",this.encodeMetadata(I))):(y=u,i["cache-control"]=`max-age=${T.cacheControl}`,i["content-type"]=T.contentType,I&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(I)))),m!=null&&m.headers&&(i=Object.assign(Object.assign({},i),m.headers));const F=this._removeEmptyFolders(s),B=this._getFinalPath(F),G=yield this.fetch(`${this.url}/object/${B}`,Object.assign({method:r,body:y,headers:i},T!=null&&T.duplex?{duplex:T.duplex}:{})),J=yield G.json();return G.ok?{data:{path:F,id:J.Id,fullPath:J.Key},error:null}:{data:null,error:J}}catch(y){if(Ps(y))return{data:null,error:y};throw y}})}upload(r,s,u){return nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,s,u)})}uploadToSignedUrl(r,s,u,m){return nl(this,void 0,void 0,function*(){const y=this._removeEmptyFolders(r),T=this._getFinalPath(y),i=new URL(this.url+`/object/upload/sign/${T}`);i.searchParams.set("token",s);try{let I;const F=Object.assign({upsert:TM.upsert},m),B=Object.assign(Object.assign({},this.headers),{"x-upsert":String(F.upsert)});typeof Blob<"u"&&u instanceof Blob?(I=new FormData,I.append("cacheControl",F.cacheControl),I.append("",u)):typeof FormData<"u"&&u instanceof FormData?(I=u,I.append("cacheControl",F.cacheControl)):(I=u,B["cache-control"]=`max-age=${F.cacheControl}`,B["content-type"]=F.contentType);const G=yield this.fetch(i.toString(),{method:"PUT",body:I,headers:B}),J=yield G.json();return G.ok?{data:{path:y,fullPath:J.Key},error:null}:{data:null,error:J}}catch(I){if(Ps(I))return{data:null,error:I};throw I}})}createSignedUploadUrl(r,s){return nl(this,void 0,void 0,function*(){try{let u=this._getFinalPath(r);const m=Object.assign({},this.headers);s!=null&&s.upsert&&(m["x-upsert"]="true");const y=yield mp(this.fetch,`${this.url}/object/upload/sign/${u}`,{},{headers:m}),T=new URL(this.url+y.url),i=T.searchParams.get("token");if(!i)throw new Qw("No token returned by API");return{data:{signedUrl:T.toString(),path:r,token:i},error:null}}catch(u){if(Ps(u))return{data:null,error:u};throw u}})}update(r,s,u){return nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,s,u)})}move(r,s,u){return nl(this,void 0,void 0,function*(){try{return{data:yield mp(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:s,destinationBucket:u==null?void 0:u.destinationBucket},{headers:this.headers}),error:null}}catch(m){if(Ps(m))return{data:null,error:m};throw m}})}copy(r,s,u){return nl(this,void 0,void 0,function*(){try{return{data:{path:(yield mp(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:s,destinationBucket:u==null?void 0:u.destinationBucket},{headers:this.headers})).Key},error:null}}catch(m){if(Ps(m))return{data:null,error:m};throw m}})}createSignedUrl(r,s,u){return nl(this,void 0,void 0,function*(){try{let m=this._getFinalPath(r),y=yield mp(this.fetch,`${this.url}/object/sign/${m}`,Object.assign({expiresIn:s},u!=null&&u.transform?{transform:u.transform}:{}),{headers:this.headers});const T=u!=null&&u.download?`&download=${u.download===!0?"":u.download}`:"";return y={signedUrl:encodeURI(`${this.url}${y.signedURL}${T}`)},{data:y,error:null}}catch(m){if(Ps(m))return{data:null,error:m};throw m}})}createSignedUrls(r,s,u){return nl(this,void 0,void 0,function*(){try{const m=yield mp(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:r},{headers:this.headers}),y=u!=null&&u.download?`&download=${u.download===!0?"":u.download}`:"";return{data:m.map(T=>Object.assign(Object.assign({},T),{signedUrl:T.signedURL?encodeURI(`${this.url}${T.signedURL}${y}`):null})),error:null}}catch(m){if(Ps(m))return{data:null,error:m};throw m}})}download(r,s){return nl(this,void 0,void 0,function*(){const m=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",y=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),T=y?`?${y}`:"";try{const i=this._getFinalPath(r);return{data:yield(yield Jv(this.fetch,`${this.url}/${m}/${i}${T}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(Ps(i))return{data:null,error:i};throw i}})}info(r){return nl(this,void 0,void 0,function*(){const s=this._getFinalPath(r);try{const u=yield Jv(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Z1(u),error:null}}catch(u){if(Ps(u))return{data:null,error:u};throw u}})}exists(r){return nl(this,void 0,void 0,function*(){const s=this._getFinalPath(r);try{return yield vV(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(u){if(Ps(u)&&u instanceof H1){const m=u.originalError;if([400,404].includes(m==null?void 0:m.status))return{data:!1,error:u}}throw u}})}getPublicUrl(r,s){const u=this._getFinalPath(r),m=[],y=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";y!==""&&m.push(y);const i=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",I=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});I!==""&&m.push(I);let F=m.join("&");return F!==""&&(F=`?${F}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${u}${F}`)}}}remove(r){return nl(this,void 0,void 0,function*(){try{return{data:yield XP(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(s){if(Ps(s))return{data:null,error:s};throw s}})}list(r,s,u){return nl(this,void 0,void 0,function*(){try{const m=Object.assign(Object.assign(Object.assign({},xV),s),{prefix:r||""});return{data:yield mp(this.fetch,`${this.url}/object/list/${this.bucketId}`,m,{headers:this.headers},u),error:null}}catch(m){if(Ps(m))return{data:null,error:m};throw m}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const s=[];return r.width&&s.push(`width=${r.width}`),r.height&&s.push(`height=${r.height}`),r.resize&&s.push(`resize=${r.resize}`),r.format&&s.push(`format=${r.format}`),r.quality&&s.push(`quality=${r.quality}`),s.join("&")}}const wV="2.7.1",SV={"X-Client-Info":`storage-js/${wV}`};var Gm=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};class TV{constructor(r,s={},u){this.url=r,this.headers=Object.assign(Object.assign({},SV),s),this.fetch=ZP(u)}listBuckets(){return Gm(this,void 0,void 0,function*(){try{return{data:yield Jv(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(Ps(r))return{data:null,error:r};throw r}})}getBucket(r){return Gm(this,void 0,void 0,function*(){try{return{data:yield Jv(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(s){if(Ps(s))return{data:null,error:s};throw s}})}createBucket(r,s={public:!1}){return Gm(this,void 0,void 0,function*(){try{return{data:yield mp(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(Ps(u))return{data:null,error:u};throw u}})}updateBucket(r,s){return Gm(this,void 0,void 0,function*(){try{return{data:yield yV(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(Ps(u))return{data:null,error:u};throw u}})}emptyBucket(r){return Gm(this,void 0,void 0,function*(){try{return{data:yield mp(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(Ps(s))return{data:null,error:s};throw s}})}deleteBucket(r){return Gm(this,void 0,void 0,function*(){try{return{data:yield XP(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(s){if(Ps(s))return{data:null,error:s};throw s}})}}class EV extends TV{constructor(r,s={},u){super(r,s,u)}from(r){return new bV(this.url,this.headers,r,this.fetch)}}const CV="2.48.1";let P_="";typeof Deno<"u"?P_="deno":typeof document<"u"?P_="web":typeof navigator<"u"&&navigator.product==="ReactNative"?P_="react-native":P_="node";const MV={"X-Client-Info":`supabase-js-${P_}/${CV}`},IV={headers:MV},AV={schema:"public"},PV={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},RV={};var kV=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};const LV=n=>{let r;return n?r=n:typeof fetch>"u"?r=BP:r=fetch,(...s)=>r(...s)},zV=()=>typeof Headers>"u"?NP:Headers,DV=(n,r,s)=>{const u=LV(s),m=zV();return(y,T)=>kV(void 0,void 0,void 0,function*(){var i;const I=(i=yield r())!==null&&i!==void 0?i:n;let F=new m(T==null?void 0:T.headers);return F.has("apikey")||F.set("apikey",n),F.has("Authorization")||F.set("Authorization",`Bearer ${I}`),u(y,Object.assign(Object.assign({},T),{headers:F}))})};var OV=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};function FV(n){return n.replace(/\/$/,"")}function BV(n,r){const{db:s,auth:u,realtime:m,global:y}=n,{db:T,auth:i,realtime:I,global:F}=r,B={db:Object.assign(Object.assign({},T),s),auth:Object.assign(Object.assign({},i),u),realtime:Object.assign(Object.assign({},I),m),global:Object.assign(Object.assign({},F),y),accessToken:()=>OV(this,void 0,void 0,function*(){return""})};return n.accessToken?B.accessToken=n.accessToken:delete B.accessToken,B}const YP="2.67.3",NV="http://localhost:9999",jV="supabase.auth.token",UV={"X-Client-Info":`gotrue-js/${YP}`},EM=10,X1="X-Supabase-Api-Version",KP={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function $V(n){return Math.round(Date.now()/1e3)+n}function VV(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const r=Math.random()*16|0;return(n=="x"?r:r&3|8).toString(16)})}const rd=()=>typeof window<"u"&&typeof document<"u",yf={tested:!1,writable:!1},N_=()=>{if(!rd())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(yf.tested)return yf.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),yf.tested=!0,yf.writable=!0}catch{yf.tested=!0,yf.writable=!1}return yf.writable};function GV(n){const r={},s=new URL(n);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((m,y)=>{r[y]=m})}catch{}return s.searchParams.forEach((u,m)=>{r[m]=u}),r}const JP=n=>{let r;return n?r=n:typeof fetch>"u"?r=(...s)=>Bf(async()=>{const{default:u}=await Promise.resolve().then(()=>dg);return{default:u}},void 0).then(({default:u})=>u(...s)):r=fetch,(...s)=>r(...s)},qV=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",QP=async(n,r,s)=>{await n.setItem(r,JSON.stringify(s))},vv=async(n,r)=>{const s=await n.getItem(r);if(!s)return null;try{return JSON.parse(s)}catch{return s}},xv=async(n,r)=>{await n.removeItem(r)};function WV(n){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s="",u,m,y,T,i,I,F,B=0;for(n=n.replace("-","+").replace("_","/");B<n.length;)T=r.indexOf(n.charAt(B++)),i=r.indexOf(n.charAt(B++)),I=r.indexOf(n.charAt(B++)),F=r.indexOf(n.charAt(B++)),u=T<<2|i>>4,m=(i&15)<<4|I>>2,y=(I&3)<<6|F,s=s+String.fromCharCode(u),I!=64&&m!=0&&(s=s+String.fromCharCode(m)),F!=64&&y!=0&&(s=s+String.fromCharCode(y));return s}class Dx{constructor(){this.promise=new Dx.promiseConstructor((r,s)=>{this.resolve=r,this.reject=s})}}Dx.promiseConstructor=Promise;function CM(n){const r=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,s=n.split(".");if(s.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!r.test(s[1]))throw new Error("JWT is not valid: payload is not in base64url format");const u=s[1];return JSON.parse(WV(u))}async function HV(n){return await new Promise(r=>{setTimeout(()=>r(null),n)})}function ZV(n,r){return new Promise((u,m)=>{(async()=>{for(let y=0;y<1/0;y++)try{const T=await n(y);if(!r(y,null,T)){u(T);return}}catch(T){if(!r(y,T)){m(T);return}}})()})}function XV(n){return("0"+n.toString(16)).substr(-2)}function YV(){const r=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",u=s.length;let m="";for(let y=0;y<56;y++)m+=s.charAt(Math.floor(Math.random()*u));return m}return crypto.getRandomValues(r),Array.from(r,XV).join("")}async function KV(n){const s=new TextEncoder().encode(n),u=await crypto.subtle.digest("SHA-256",s),m=new Uint8Array(u);return Array.from(m).map(y=>String.fromCharCode(y)).join("")}function JV(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function QV(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const s=await KV(n);return JV(s)}async function qm(n,r,s=!1){const u=YV();let m=u;s&&(m+="/PASSWORD_RECOVERY"),await QP(n,`${r}-code-verifier`,m);const y=await QV(u);return[y,u===y?"plain":"s256"]}const e8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function t8(n){const r=n.headers.get(X1);if(!r||!r.match(e8))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}class eS extends Error{constructor(r,s,u){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=u}}function oi(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class n8 extends eS{constructor(r,s,u){super(r,s,u),this.name="AuthApiError",this.status=s,this.code=u}}function r8(n){return oi(n)&&n.name==="AuthApiError"}class eR extends eS{constructor(r,s){super(r),this.name="AuthUnknownError",this.originalError=s}}class Vf extends eS{constructor(r,s,u,m){super(r,u,m),this.name=s,this.status=u}}class hp extends Vf{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function i8(n){return oi(n)&&n.name==="AuthSessionMissingError"}class Eb extends Vf{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bv extends Vf{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class wv extends Vf{constructor(r,s=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function o8(n){return oi(n)&&n.name==="AuthImplicitGrantRedirectError"}class MM extends Vf{constructor(r,s=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Y1 extends Vf{constructor(r,s){super(r,"AuthRetryableFetchError",s,void 0)}}function Cb(n){return oi(n)&&n.name==="AuthRetryableFetchError"}class IM extends Vf{constructor(r,s,u){super(r,"AuthWeakPasswordError",s,"weak_password"),this.reasons=u}}var s8=function(n,r){var s={};for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&r.indexOf(u)<0&&(s[u]=n[u]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var m=0,u=Object.getOwnPropertySymbols(n);m<u.length;m++)r.indexOf(u[m])<0&&Object.prototype.propertyIsEnumerable.call(n,u[m])&&(s[u[m]]=n[u[m]]);return s};const wf=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),a8=[502,503,504];async function AM(n){var r;if(!qV(n))throw new Y1(wf(n),0);if(a8.includes(n.status))throw new Y1(wf(n),n.status);let s;try{s=await n.json()}catch(y){throw new eR(wf(y),y)}let u;const m=t8(n);if(m&&m.getTime()>=KP["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?u=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(u=s.error_code),u){if(u==="weak_password")throw new IM(wf(s),n.status,((r=s.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(u==="session_not_found")throw new hp}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((y,T)=>y&&typeof T=="string",!0))throw new IM(wf(s),n.status,s.weak_password.reasons);throw new n8(wf(s),n.status||500,u)}const l8=(n,r,s,u)=>{const m={method:n,headers:(r==null?void 0:r.headers)||{}};return n==="GET"?m:(m.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),m.body=JSON.stringify(u),Object.assign(Object.assign({},m),s))};async function xi(n,r,s,u){var m;const y=Object.assign({},u==null?void 0:u.headers);y[X1]||(y[X1]=KP["2024-01-01"].name),u!=null&&u.jwt&&(y.Authorization=`Bearer ${u.jwt}`);const T=(m=u==null?void 0:u.query)!==null&&m!==void 0?m:{};u!=null&&u.redirectTo&&(T.redirect_to=u.redirectTo);const i=Object.keys(T).length?"?"+new URLSearchParams(T).toString():"",I=await c8(n,r,s+i,{headers:y,noResolveJson:u==null?void 0:u.noResolveJson},{},u==null?void 0:u.body);return u!=null&&u.xform?u==null?void 0:u.xform(I):{data:Object.assign({},I),error:null}}async function c8(n,r,s,u,m,y){const T=l8(r,u,m,y);let i;try{i=await n(s,Object.assign({},T))}catch(I){throw console.error(I),new Y1(wf(I),0)}if(i.ok||await AM(i),u!=null&&u.noResolveJson)return i;try{return await i.json()}catch(I){await AM(I)}}function pp(n){var r;let s=null;p8(n)&&(s=Object.assign({},n),n.expires_at||(s.expires_at=$V(n.expires_in)));const u=(r=n.user)!==null&&r!==void 0?r:n;return{data:{session:s,user:u},error:null}}function PM(n){const r=pp(n);return!r.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((s,u)=>s&&typeof u=="string",!0)&&(r.data.weak_password=n.weak_password),r}function yp(n){var r;return{data:{user:(r=n.user)!==null&&r!==void 0?r:n},error:null}}function u8(n){return{data:n,error:null}}function d8(n){const{action_link:r,email_otp:s,hashed_token:u,redirect_to:m,verification_type:y}=n,T=s8(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:r,email_otp:s,hashed_token:u,redirect_to:m,verification_type:y},I=Object.assign({},T);return{data:{properties:i,user:I},error:null}}function h8(n){return n}function p8(n){return n.access_token&&n.refresh_token&&n.expires_in}var f8=function(n,r){var s={};for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&r.indexOf(u)<0&&(s[u]=n[u]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var m=0,u=Object.getOwnPropertySymbols(n);m<u.length;m++)r.indexOf(u[m])<0&&Object.prototype.propertyIsEnumerable.call(n,u[m])&&(s[u[m]]=n[u[m]]);return s};class m8{constructor({url:r="",headers:s={},fetch:u}){this.url=r,this.headers=s,this.fetch=JP(u),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,s="global"){try{return await xi(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(u){if(oi(u))return{data:null,error:u};throw u}}async inviteUserByEmail(r,s={}){try{return await xi(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:yp})}catch(u){if(oi(u))return{data:{user:null},error:u};throw u}}async generateLink(r){try{const{options:s}=r,u=f8(r,["options"]),m=Object.assign(Object.assign({},u),s);return"newEmail"in u&&(m.new_email=u==null?void 0:u.newEmail,delete m.newEmail),await xi(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:m,headers:this.headers,xform:d8,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(oi(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(r){try{return await xi(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:yp})}catch(s){if(oi(s))return{data:{user:null},error:s};throw s}}async listUsers(r){var s,u,m,y,T,i,I;try{const F={nextPage:null,lastPage:0,total:0},B=await xi(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(u=(s=r==null?void 0:r.page)===null||s===void 0?void 0:s.toString())!==null&&u!==void 0?u:"",per_page:(y=(m=r==null?void 0:r.perPage)===null||m===void 0?void 0:m.toString())!==null&&y!==void 0?y:""},xform:h8});if(B.error)throw B.error;const G=await B.json(),J=(T=B.headers.get("x-total-count"))!==null&&T!==void 0?T:0,te=(I=(i=B.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&I!==void 0?I:[];return te.length>0&&(te.forEach(H=>{const j=parseInt(H.split(";")[0].split("=")[1].substring(0,1)),ne=JSON.parse(H.split(";")[1].split("=")[1]);F[`${ne}Page`]=j}),F.total=parseInt(J)),{data:Object.assign(Object.assign({},G),F),error:null}}catch(F){if(oi(F))return{data:{users:[]},error:F};throw F}}async getUserById(r){try{return await xi(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:yp})}catch(s){if(oi(s))return{data:{user:null},error:s};throw s}}async updateUserById(r,s){try{return await xi(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:s,headers:this.headers,xform:yp})}catch(u){if(oi(u))return{data:{user:null},error:u};throw u}}async deleteUser(r,s=!1){try{return await xi(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:s},xform:yp})}catch(u){if(oi(u))return{data:{user:null},error:u};throw u}}async _listFactors(r){try{const{data:s,error:u}=await xi(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:m=>({data:{factors:m},error:null})});return{data:s,error:u}}catch(s){if(oi(s))return{data:null,error:s};throw s}}async _deleteFactor(r){try{return{data:await xi(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(s){if(oi(s))return{data:null,error:s};throw s}}}const g8={getItem:n=>N_()?globalThis.localStorage.getItem(n):null,setItem:(n,r)=>{N_()&&globalThis.localStorage.setItem(n,r)},removeItem:n=>{N_()&&globalThis.localStorage.removeItem(n)}};function RM(n={}){return{getItem:r=>n[r]||null,setItem:(r,s)=>{n[r]=s},removeItem:r=>{delete n[r]}}}function _8(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Wm={debug:!!(globalThis&&N_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class tR extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class y8 extends tR{}async function v8(n,r,s){Wm.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,r);const u=new globalThis.AbortController;return r>0&&setTimeout(()=>{u.abort(),Wm.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:u.signal},async m=>{if(m){Wm.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,m.name);try{return await s()}finally{Wm.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,m.name)}}else{if(r===0)throw Wm.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new y8(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Wm.debug)try{const y=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(y,null,"  "))}catch(y){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",y)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}_8();const x8={url:NV,storageKey:jV,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UV,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},v_=30*1e3,kM=3;async function LM(n,r,s){return await s()}class K_{constructor(r){var s,u;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=K_.nextInstanceID,K_.nextInstanceID+=1,this.instanceID>0&&rd()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const m=Object.assign(Object.assign({},x8),r);if(this.logDebugMessages=!!m.debug,typeof m.debug=="function"&&(this.logger=m.debug),this.persistSession=m.persistSession,this.storageKey=m.storageKey,this.autoRefreshToken=m.autoRefreshToken,this.admin=new m8({url:m.url,headers:m.headers,fetch:m.fetch}),this.url=m.url,this.headers=m.headers,this.fetch=JP(m.fetch),this.lock=m.lock||LM,this.detectSessionInUrl=m.detectSessionInUrl,this.flowType=m.flowType,this.hasCustomAuthorizationHeader=m.hasCustomAuthorizationHeader,m.lock?this.lock=m.lock:rd()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=v8:this.lock=LM,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?m.storage?this.storage=m.storage:N_()?this.storage=g8:(this.memoryStorage={},this.storage=RM(this.memoryStorage)):(this.memoryStorage={},this.storage=RM(this.memoryStorage)),rd()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(y){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",y)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async y=>{this._debug("received broadcast notification from other tab or client",y),await this._notifyAllSubscribers(y.data.event,y.data.session,!1)})}this.initialize()}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${YP}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const s=GV(window.location.href);let u="none";if(this._isImplicitGrantCallback(s)?u="implicit":await this._isPKCECallback(s)&&(u="pkce"),rd()&&this.detectSessionInUrl&&u!=="none"){const{data:m,error:y}=await this._getSessionFromURL(s,u);if(y){if(this._debug("#_initialize()","error detecting session from URL",y),o8(y)){const I=(r=y.details)===null||r===void 0?void 0:r.code;if(I==="identity_already_exists"||I==="identity_not_found"||I==="single_identity_not_deletable")return{error:y}}return await this._removeSession(),{error:y}}const{session:T,redirectType:i}=m;return this._debug("#_initialize()","detected session in URL",T,"redirect type",i),await this._saveSession(T),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",T):await this._notifyAllSubscribers("SIGNED_IN",T)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return oi(s)?{error:s}:{error:new eR("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var s,u,m;try{const y=await xi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(u=(s=r==null?void 0:r.options)===null||s===void 0?void 0:s.data)!==null&&u!==void 0?u:{},gotrue_meta_security:{captcha_token:(m=r==null?void 0:r.options)===null||m===void 0?void 0:m.captchaToken}},xform:pp}),{data:T,error:i}=y;if(i||!T)return{data:{user:null,session:null},error:i};const I=T.session,F=T.user;return T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",I)),{data:{user:F,session:I},error:null}}catch(y){if(oi(y))return{data:{user:null,session:null},error:y};throw y}}async signUp(r){var s,u,m;try{let y;if("email"in r){const{email:B,password:G,options:J}=r;let te=null,H=null;this.flowType==="pkce"&&([te,H]=await qm(this.storage,this.storageKey)),y=await xi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:J==null?void 0:J.emailRedirectTo,body:{email:B,password:G,data:(s=J==null?void 0:J.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:J==null?void 0:J.captchaToken},code_challenge:te,code_challenge_method:H},xform:pp})}else if("phone"in r){const{phone:B,password:G,options:J}=r;y=await xi(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:B,password:G,data:(u=J==null?void 0:J.data)!==null&&u!==void 0?u:{},channel:(m=J==null?void 0:J.channel)!==null&&m!==void 0?m:"sms",gotrue_meta_security:{captcha_token:J==null?void 0:J.captchaToken}},xform:pp})}else throw new bv("You must provide either an email or phone number and a password");const{data:T,error:i}=y;if(i||!T)return{data:{user:null,session:null},error:i};const I=T.session,F=T.user;return T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",I)),{data:{user:F,session:I},error:null}}catch(y){if(oi(y))return{data:{user:null,session:null},error:y};throw y}}async signInWithPassword(r){try{let s;if("email"in r){const{email:y,password:T,options:i}=r;s=await xi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:y,password:T,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:PM})}else if("phone"in r){const{phone:y,password:T,options:i}=r;s=await xi(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:y,password:T,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:PM})}else throw new bv("You must provide either an email or phone number and a password");const{data:u,error:m}=s;return m?{data:{user:null,session:null},error:m}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Eb}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:Object.assign({user:u.user,session:u.session},u.weak_password?{weakPassword:u.weak_password}:null),error:m})}catch(s){if(oi(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(r){var s,u,m,y;return await this._handleProviderSignIn(r.provider,{redirectTo:(s=r.options)===null||s===void 0?void 0:s.redirectTo,scopes:(u=r.options)===null||u===void 0?void 0:u.scopes,queryParams:(m=r.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:(y=r.options)===null||y===void 0?void 0:y.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async _exchangeCodeForSession(r){const s=await vv(this.storage,`${this.storageKey}-code-verifier`),[u,m]=(s??"").split("/");try{const{data:y,error:T}=await xi(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:u},xform:pp});if(await xv(this.storage,`${this.storageKey}-code-verifier`),T)throw T;return!y||!y.session||!y.user?{data:{user:null,session:null,redirectType:null},error:new Eb}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign(Object.assign({},y),{redirectType:m??null}),error:T})}catch(y){if(oi(y))return{data:{user:null,session:null,redirectType:null},error:y};throw y}}async signInWithIdToken(r){try{const{options:s,provider:u,token:m,access_token:y,nonce:T}=r,i=await xi(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:u,id_token:m,access_token:y,nonce:T,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:pp}),{data:I,error:F}=i;return F?{data:{user:null,session:null},error:F}:!I||!I.session||!I.user?{data:{user:null,session:null},error:new Eb}:(I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),{data:I,error:F})}catch(s){if(oi(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(r){var s,u,m,y,T;try{if("email"in r){const{email:i,options:I}=r;let F=null,B=null;this.flowType==="pkce"&&([F,B]=await qm(this.storage,this.storageKey));const{error:G}=await xi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(s=I==null?void 0:I.data)!==null&&s!==void 0?s:{},create_user:(u=I==null?void 0:I.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken},code_challenge:F,code_challenge_method:B},redirectTo:I==null?void 0:I.emailRedirectTo});return{data:{user:null,session:null},error:G}}if("phone"in r){const{phone:i,options:I}=r,{data:F,error:B}=await xi(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(m=I==null?void 0:I.data)!==null&&m!==void 0?m:{},create_user:(y=I==null?void 0:I.shouldCreateUser)!==null&&y!==void 0?y:!0,gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken},channel:(T=I==null?void 0:I.channel)!==null&&T!==void 0?T:"sms"}});return{data:{user:null,session:null,messageId:F==null?void 0:F.message_id},error:B}}throw new bv("You must provide either an email or phone number.")}catch(i){if(oi(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(r){var s,u;try{let m,y;"options"in r&&(m=(s=r.options)===null||s===void 0?void 0:s.redirectTo,y=(u=r.options)===null||u===void 0?void 0:u.captchaToken);const{data:T,error:i}=await xi(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:y}}),redirectTo:m,xform:pp});if(i)throw i;if(!T)throw new Error("An error occurred on token verification.");const I=T.session,F=T.user;return I!=null&&I.access_token&&(await this._saveSession(I),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",I)),{data:{user:F,session:I},error:null}}catch(m){if(oi(m))return{data:{user:null,session:null},error:m};throw m}}async signInWithSSO(r){var s,u,m;try{let y=null,T=null;return this.flowType==="pkce"&&([y,T]=await qm(this.storage,this.storageKey)),await xi(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(u=(s=r.options)===null||s===void 0?void 0:s.redirectTo)!==null&&u!==void 0?u:void 0}),!((m=r==null?void 0:r.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:y,code_challenge_method:T}),headers:this.headers,xform:u8})}catch(y){if(oi(y))return{data:null,error:y};throw y}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:s},error:u}=r;if(u)throw u;if(!s)throw new hp;const{error:m}=await xi(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:m}})}catch(r){if(oi(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const s=`${this.url}/resend`;if("email"in r){const{email:u,type:m,options:y}=r,{error:T}=await xi(this.fetch,"POST",s,{headers:this.headers,body:{email:u,type:m,gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken}},redirectTo:y==null?void 0:y.emailRedirectTo});return{data:{user:null,session:null},error:T}}else if("phone"in r){const{phone:u,type:m,options:y}=r,{data:T,error:i}=await xi(this.fetch,"POST",s,{headers:this.headers,body:{phone:u,type:m,gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken}}});return{data:{user:null,session:null,messageId:T==null?void 0:T.message_id},error:i}}throw new bv("You must provide either an email or phone number and a type")}catch(s){if(oi(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(r,s){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const u=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),m=(async()=>(await u,await s()))();return this.pendingInLock.push((async()=>{try{await m}catch{}})()),m}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const u=s();for(this.pendingInLock.push((async()=>{try{await u}catch{}})()),await u;this.pendingInLock.length;){const m=[...this.pendingInLock];await Promise.all(m),this.pendingInLock.splice(0,m.length)}return await u}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await r(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const s=await vv(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?r=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const u=r.expires_at?r.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${u?"":" not"} expired`,"expires_at",r.expires_at),!u){if(this.storage.isServer){let T=this.suppressGetSessionWarning;r=new Proxy(r,{get:(I,F,B)=>(!T&&F==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),T=!0,this.suppressGetSessionWarning=!0),Reflect.get(I,F,B))})}return{data:{session:r},error:null}}const{session:m,error:y}=await this._callRefreshToken(r.refresh_token);return y?{data:{session:null},error:y}:{data:{session:m},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await xi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:yp}):await this._useSession(async s=>{var u,m,y;const{data:T,error:i}=s;if(i)throw i;return!(!((u=T.session)===null||u===void 0)&&u.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new hp}:await xi(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(y=(m=T.session)===null||m===void 0?void 0:m.access_token)!==null&&y!==void 0?y:void 0,xform:yp})})}catch(s){if(oi(s))return i8(s)&&(await this._removeSession(),await xv(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(r,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,s))}async _updateUser(r,s={}){try{return await this._useSession(async u=>{const{data:m,error:y}=u;if(y)throw y;if(!m.session)throw new hp;const T=m.session;let i=null,I=null;this.flowType==="pkce"&&r.email!=null&&([i,I]=await qm(this.storage,this.storageKey));const{data:F,error:B}=await xi(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:i,code_challenge_method:I}),jwt:T.access_token,xform:yp});if(B)throw B;return T.user=F.user,await this._saveSession(T),await this._notifyAllSubscribers("USER_UPDATED",T),{data:{user:T.user},error:null}})}catch(u){if(oi(u))return{data:{user:null},error:u};throw u}}_decodeJWT(r){return CM(r)}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new hp;const s=Date.now()/1e3;let u=s,m=!0,y=null;const T=CM(r.access_token);if(T.exp&&(u=T.exp,m=u<=s),m){const{session:i,error:I}=await this._callRefreshToken(r.refresh_token);if(I)return{data:{user:null,session:null},error:I};if(!i)return{data:{user:null,session:null},error:null};y=i}else{const{data:i,error:I}=await this._getUser(r.access_token);if(I)throw I;y={access_token:r.access_token,refresh_token:r.refresh_token,user:i.user,token_type:"bearer",expires_in:u-s,expires_at:u},await this._saveSession(y),await this._notifyAllSubscribers("SIGNED_IN",y)}return{data:{user:y.user,session:y},error:null}}catch(s){if(oi(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async s=>{var u;if(!r){const{data:T,error:i}=s;if(i)throw i;r=(u=T.session)!==null&&u!==void 0?u:void 0}if(!(r!=null&&r.refresh_token))throw new hp;const{session:m,error:y}=await this._callRefreshToken(r.refresh_token);return y?{data:{user:null,session:null},error:y}:m?{data:{user:m.user,session:m},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(oi(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(r,s){try{if(!rd())throw new wv("No browser detected.");if(r.error||r.error_description||r.error_code)throw new wv(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new MM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wv("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new MM("No code detected.");const{data:pe,error:se}=await this._exchangeCodeForSession(r.code);if(se)throw se;const ie=new URL(window.location.href);return ie.searchParams.delete("code"),window.history.replaceState(window.history.state,"",ie.toString()),{data:{session:pe.session,redirectType:null},error:null}}const{provider_token:u,provider_refresh_token:m,access_token:y,refresh_token:T,expires_in:i,expires_at:I,token_type:F}=r;if(!y||!i||!T||!F)throw new wv("No session defined in URL");const B=Math.round(Date.now()/1e3),G=parseInt(i);let J=B+G;I&&(J=parseInt(I));const te=J-B;te*1e3<=v_&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${te}s, should have been closer to ${G}s`);const H=J-G;B-H>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",H,J,B):B-H<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",H,J,B);const{data:j,error:ne}=await this._getUser(y);if(ne)throw ne;const oe={provider_token:u,provider_refresh_token:m,access_token:y,expires_in:G,expires_at:J,refresh_token:T,token_type:F,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:oe,redirectType:r.type},error:null}}catch(u){if(oi(u))return{data:{session:null,redirectType:null},error:u};throw u}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const s=await vv(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&s)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async s=>{var u;const{data:m,error:y}=s;if(y)return{error:y};const T=(u=m.session)===null||u===void 0?void 0:u.access_token;if(T){const{error:i}=await this.admin.signOut(T,r);if(i&&!(r8(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return r!=="others"&&(await this._removeSession(),await xv(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const s=VV(),u={id:s,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,u),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:u}}}async _emitInitialSession(r){return await this._useSession(async s=>{var u,m;try{const{data:{session:y},error:T}=s;if(T)throw T;await((u=this.stateChangeEmitters.get(r))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",y)),this._debug("INITIAL_SESSION","callback id",r,"session",y)}catch(y){await((m=this.stateChangeEmitters.get(r))===null||m===void 0?void 0:m.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",y),console.error(y)}})}async resetPasswordForEmail(r,s={}){let u=null,m=null;this.flowType==="pkce"&&([u,m]=await qm(this.storage,this.storageKey,!0));try{return await xi(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:u,code_challenge_method:m,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(y){if(oi(y))return{data:null,error:y};throw y}}async getUserIdentities(){var r;try{const{data:s,error:u}=await this.getUser();if(u)throw u;return{data:{identities:(r=s.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(s){if(oi(s))return{data:null,error:s};throw s}}async linkIdentity(r){var s;try{const{data:u,error:m}=await this._useSession(async y=>{var T,i,I,F,B;const{data:G,error:J}=y;if(J)throw J;const te=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(T=r.options)===null||T===void 0?void 0:T.redirectTo,scopes:(i=r.options)===null||i===void 0?void 0:i.scopes,queryParams:(I=r.options)===null||I===void 0?void 0:I.queryParams,skipBrowserRedirect:!0});return await xi(this.fetch,"GET",te,{headers:this.headers,jwt:(B=(F=G.session)===null||F===void 0?void 0:F.access_token)!==null&&B!==void 0?B:void 0})});if(m)throw m;return rd()&&!(!((s=r.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(u==null?void 0:u.url),{data:{provider:r.provider,url:u==null?void 0:u.url},error:null}}catch(u){if(oi(u))return{data:{provider:r.provider,url:null},error:u};throw u}}async unlinkIdentity(r){try{return await this._useSession(async s=>{var u,m;const{data:y,error:T}=s;if(T)throw T;return await xi(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(m=(u=y.session)===null||u===void 0?void 0:u.access_token)!==null&&m!==void 0?m:void 0})})}catch(s){if(oi(s))return{data:null,error:s};throw s}}async _refreshAccessToken(r){const s=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(s,"begin");try{const u=Date.now();return await ZV(async m=>(m>0&&await HV(200*Math.pow(2,m-1)),this._debug(s,"refreshing attempt",m),await xi(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:pp})),(m,y)=>{const T=200*Math.pow(2,m);return y&&Cb(y)&&Date.now()+T-u<v_})}catch(u){if(this._debug(s,"error",u),oi(u))return{data:{session:null,user:null},error:u};throw u}finally{this._debug(s,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,s){const u=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",s,"url",u),rd()&&!s.skipBrowserRedirect&&window.location.assign(u),{data:{provider:r,url:u},error:null}}async _recoverAndRefresh(){var r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const u=await vv(this.storage,this.storageKey);if(this._debug(s,"session from storage",u),!this._isValidSession(u)){this._debug(s,"session is not valid"),u!==null&&await this._removeSession();return}const m=Math.round(Date.now()/1e3),y=((r=u.expires_at)!==null&&r!==void 0?r:1/0)<m+EM;if(this._debug(s,`session has${y?"":" not"} expired with margin of ${EM}s`),y){if(this.autoRefreshToken&&u.refresh_token){const{error:T}=await this._callRefreshToken(u.refresh_token);T&&(console.error(T),Cb(T)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",T),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(s,"error",u),console.error(u);return}finally{this._debug(s,"end")}}async _callRefreshToken(r){var s,u;if(!r)throw new hp;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const m=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(m,"begin");try{this.refreshingDeferred=new Dx;const{data:y,error:T}=await this._refreshAccessToken(r);if(T)throw T;if(!y.session)throw new hp;await this._saveSession(y.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",y.session);const i={session:y.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(y){if(this._debug(m,"error",y),oi(y)){const T={session:null,error:y};return Cb(y)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(T),T}throw(u=this.refreshingDeferred)===null||u===void 0||u.reject(y),y}finally{this.refreshingDeferred=null,this._debug(m,"end")}}async _notifyAllSubscribers(r,s,u=!0){const m=`#_notifyAllSubscribers(${r})`;this._debug(m,"begin",s,`broadcast = ${u}`);try{this.broadcastChannel&&u&&this.broadcastChannel.postMessage({event:r,session:s});const y=[],T=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(r,s)}catch(I){y.push(I)}});if(await Promise.all(T),y.length>0){for(let i=0;i<y.length;i+=1)console.error(y[i]);throw y[0]}}finally{this._debug(m,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await QP(this.storage,this.storageKey,r)}async _removeSession(){this._debug("#_removeSession()"),await xv(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&rd()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),v_);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async s=>{const{data:{session:u}}=s;if(!u||!u.refresh_token||!u.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const m=Math.floor((u.expires_at*1e3-r)/v_);this._debug("#_autoRefreshTokenTick()",`access token expires in ${m} ticks, a tick lasts ${v_}ms, refresh threshold is ${kM} ticks`),m<=kM&&await this._callRefreshToken(u.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof tR)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rd()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const s=`#_onVisibilityChanged(${r})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,s,u){const m=[`provider=${encodeURIComponent(s)}`];if(u!=null&&u.redirectTo&&m.push(`redirect_to=${encodeURIComponent(u.redirectTo)}`),u!=null&&u.scopes&&m.push(`scopes=${encodeURIComponent(u.scopes)}`),this.flowType==="pkce"){const[y,T]=await qm(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(y)}`,code_challenge_method:`${encodeURIComponent(T)}`});m.push(i.toString())}if(u!=null&&u.queryParams){const y=new URLSearchParams(u.queryParams);m.push(y.toString())}return u!=null&&u.skipBrowserRedirect&&m.push(`skip_http_redirect=${u.skipBrowserRedirect}`),`${r}?${m.join("&")}`}async _unenroll(r){try{return await this._useSession(async s=>{var u;const{data:m,error:y}=s;return y?{data:null,error:y}:await xi(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(u=m==null?void 0:m.session)===null||u===void 0?void 0:u.access_token})})}catch(s){if(oi(s))return{data:null,error:s};throw s}}async _enroll(r){try{return await this._useSession(async s=>{var u,m;const{data:y,error:T}=s;if(T)return{data:null,error:T};const i=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:I,error:F}=await xi(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(u=y==null?void 0:y.session)===null||u===void 0?void 0:u.access_token});return F?{data:null,error:F}:(r.factorType==="totp"&&(!((m=I==null?void 0:I.totp)===null||m===void 0)&&m.qr_code)&&(I.totp.qr_code=`data:image/svg+xml;utf-8,${I.totp.qr_code}`),{data:I,error:null})})}catch(s){if(oi(s))return{data:null,error:s};throw s}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var u;const{data:m,error:y}=s;if(y)return{data:null,error:y};const{data:T,error:i}=await xi(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(u=m==null?void 0:m.session)===null||u===void 0?void 0:u.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+T.expires_in},T)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",T),{data:T,error:i})})}catch(s){if(oi(s))return{data:null,error:s};throw s}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var u;const{data:m,error:y}=s;return y?{data:null,error:y}:await xi(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(u=m==null?void 0:m.session)===null||u===void 0?void 0:u.access_token})})}catch(s){if(oi(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(r){const{data:s,error:u}=await this._challenge({factorId:r.factorId});return u?{data:null,error:u}:await this._verify({factorId:r.factorId,challengeId:s.id,code:r.code})}async _listFactors(){const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const u=(r==null?void 0:r.factors)||[],m=u.filter(T=>T.factor_type==="totp"&&T.status==="verified"),y=u.filter(T=>T.factor_type==="phone"&&T.status==="verified");return{data:{all:u,totp:m,phone:y},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var s,u;const{data:{session:m},error:y}=r;if(y)return{data:null,error:y};if(!m)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const T=this._decodeJWT(m.access_token);let i=null;T.aal&&(i=T.aal);let I=i;((u=(s=m.user.factors)===null||s===void 0?void 0:s.filter(G=>G.status==="verified"))!==null&&u!==void 0?u:[]).length>0&&(I="aal2");const B=T.amr||[];return{data:{currentLevel:i,nextLevel:I,currentAuthenticationMethods:B},error:null}}))}}K_.nextInstanceID=0;const b8=K_;class w8 extends b8{constructor(r){super(r)}}var S8=function(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})};class T8{constructor(r,s,u){var m,y,T;if(this.supabaseUrl=r,this.supabaseKey=s,!r)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const i=FV(r);this.realtimeUrl=`${i}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.functionsUrl=`${i}/functions/v1`;const I=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,F={db:AV,realtime:RV,auth:Object.assign(Object.assign({},PV),{storageKey:I}),global:IV},B=BV(u??{},F);this.storageKey=(m=B.auth.storageKey)!==null&&m!==void 0?m:"",this.headers=(y=B.global.headers)!==null&&y!==void 0?y:{},B.accessToken?(this.accessToken=B.accessToken,this.auth=new Proxy({},{get:(G,J)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(J)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((T=B.auth)!==null&&T!==void 0?T:{},this.headers,B.global.fetch),this.fetch=DV(s,this._getAccessToken.bind(this),B.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},B.realtime)),this.rest=new Y$(`${i}/rest/v1`,{headers:this.headers,schema:B.db.schema,fetch:this.fetch}),B.accessToken||this._listenForAuthEvents()}get functions(){return new B$(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new EV(this.storageUrl,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,s={},u={}){return this.rest.rpc(r,s,u)}channel(r,s={config:{}}){return this.realtime.channel(r,s)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,s;return S8(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:u}=yield this.auth.getSession();return(s=(r=u.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:s,detectSessionInUrl:u,storage:m,storageKey:y,flowType:T,lock:i,debug:I},F,B){const G={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new w8({url:this.authUrl,headers:Object.assign(Object.assign({},G),F),storageKey:y,autoRefreshToken:r,persistSession:s,detectSessionInUrl:u,storage:m,flowType:T,lock:i,debug:I,fetch:B,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new dV(this.realtimeUrl,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,u)=>{this._handleTokenChanged(s,"CLIENT",u==null?void 0:u.access_token)})}_handleTokenChanged(r,s,u){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==u?this.changedAccessToken=u:r==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const E8=(n,r,s)=>new T8(n,r,s),C8="https://yflxjdtokwykrtnmxhdm.supabase.co",M8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbHhqZHRva3d5a3J0bm14aGRtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5NTAzMjQsImV4cCI6MjA1MzUyNjMyNH0.oAZsvt3ZIZjipbQ2atAGOLvOx0GrfQNYCH8OJZhCP3c",Nf=E8(C8,M8),I8=async(n,r)=>{try{const{error:s}=await Nf.storage.from("parkitnchargeapp").upload(r,n);if(s)throw s;const{data:u}=Nf.storage.from("parkitnchargeapp").getPublicUrl(r);if(!u)throw new Error("Failed to get public URL.");return console.log(u),u.publicUrl}catch(s){throw console.error("Error uploading file:",s),s}},hg=async({url:n,method:r="POST",token:s="",body:u=null},m)=>{const y=s?{"Content-Type":"application/json",authorization:`Bearer ${s}`}:{"Content-Type":"application/json"};u=u?{body:JSON.stringify(u)}:{};try{const T=await fetch(n,{method:r,headers:y,...u}),i=await T.json();if(!i.success)throw T.status===401&&m({type:"UPDATE_USER",payload:null}),new Error(i.message);return i.result}catch(T){return m({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:T.message}}),console.log(T),null}},Qs=[];for(let n=0;n<256;++n)Qs.push((n+256).toString(16).slice(1));function A8(n,r=0){return(Qs[n[r+0]]+Qs[n[r+1]]+Qs[n[r+2]]+Qs[n[r+3]]+"-"+Qs[n[r+4]]+Qs[n[r+5]]+"-"+Qs[n[r+6]]+Qs[n[r+7]]+"-"+Qs[n[r+8]]+Qs[n[r+9]]+"-"+Qs[n[r+10]]+Qs[n[r+11]]+Qs[n[r+12]]+Qs[n[r+13]]+Qs[n[r+14]]+Qs[n[r+15]]).toLowerCase()}let Mb;const P8=new Uint8Array(16);function R8(){if(!Mb){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Mb=crypto.getRandomValues.bind(crypto)}return Mb(P8)}const k8=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),zM={randomUUID:k8};function nR(n,r,s){var m;if(zM.randomUUID&&!n)return zM.randomUUID();n=n||{};const u=n.random??((m=n.rng)==null?void 0:m.call(n))??R8();if(u.length<16)throw new Error("Random bytes length must be >= 16");return u[6]=u[6]&15|64,u[8]=u[8]&63|128,A8(u)}const tS="http://localhost:3001/api/users",L8=async(n,r)=>{r({type:"START_LOADING"});const s=await hg({url:tS+"/register",body:n},r);s&&(r({type:"UPDATE_USER",payload:s}),r({type:"CLOSE_LOGIN"}),r({type:"UPDATE_ALERT",payload:{open:!0,severity:"success",message:"Your account has been created successfully"}})),r({type:"STOP_LOADING"})},z8=async(n,r)=>{r({type:"START_LOADING"});const s=await hg({url:tS+"/login",body:n},r);s&&(r({type:"UPDATE_USER",payload:s}),r({type:"CLOSE_LOGIN"})),r({type:"STOP_LOADING"})},D8=async(n,r,s)=>{var T,i;s({type:"START_LOADING"});const{name:u,file:m}=r;let y={name:u};try{if(m){const F=nR()+"."+((i=(T=m==null?void 0:m.name)==null?void 0:T.split("."))==null?void 0:i.pop());let B;try{const G=await I8(m,`profile/${n==null?void 0:n.id}/${F}`);if(!G)throw new Error("Failed to get public URL after uploading the file.");B=G}catch(G){console.error("Error uploading file:",G)}y={...y,photoURL:B}}const I=await hg({url:tS+"/updateProfile",method:"PATCH",body:y,token:n.token},s);I&&(s({type:"UPDATE_USER",payload:{...n,...I}}),s({type:"UPDATE_ALERT",payload:{open:!0,severity:"success",message:"Your profile has been updated successfully"}}),s({type:"UPDATE_PROFILE",payload:{open:!1,file:null,photoURL:I.photoURL}}))}catch(I){s({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:I.message}}),console.log(I)}s({type:"STOP_LOADING"})},K1={register:L8,login:z8,updateProfile:D8},O8=()=>{const{state:{openLogin:n},dispatch:r}=mo(),[s,u]=fe.useState("Login"),[m,y]=fe.useState(!1),T=fe.useRef(),i=fe.useRef(),I=fe.useRef(),F=fe.useRef();fe.useEffect(()=>{u(m?"Register":"Login")},[m]);const B=()=>{r({type:"CLOSE_LOGIN"})},G=J=>{J.preventDefault();const te=i.current.value,H=I.current.value;if(!m)return K1.login({email:te,password:H},r);const j=T.current.value,ne=F.current.value;if(H!==ne)return r({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Passwords do not match"}});K1.register({name:j,email:te,password:H},r)};return _e.jsxs(jw,{open:n,onClose:B,children:[_e.jsxs(mP,{children:[s,_e.jsx(fu,{sx:{position:"absolute",right:8,top:8,color:J=>J.palette.grey[500]},onClick:B,children:_e.jsx(Zw,{})})]}),_e.jsxs("form",{onSubmit:G,children:[_e.jsxs(pP,{children:[_e.jsx(fP,{children:"Please fill your information in the fields below:"}),m&&_e.jsx(Ff,{margin:"normal",label:"Username",type:"text",fullWidth:!0,required:!0,autoFocus:!0,variant:"standard",id:"username",inputRef:T,slotProps:{htmlInput:{minLength:2}}}),_e.jsx(Ff,{autoFocus:!m,margin:"normal",label:"Email",type:"email",fullWidth:!0,required:!0,variant:"standard",id:"email",inputRef:i}),_e.jsx(cM,{passwordRef:I}),m&&_e.jsx(cM,{passwordRef:F,id:"confirmPassword",label:"Confirm Password"})]}),_e.jsx(Fv,{sx:{px:"19px"},children:_e.jsx(cd,{type:"submit",varient:"contained",endIcon:_e.jsx(Xw,{}),children:"Submit"})})]}),_e.jsxs(Fv,{sx:{justifyContent:"left",p:"5px 24px"},children:[m?"Do you have an account? Sign in now":"Don't you have an account? Create one now",_e.jsx(cd,{onClick:()=>y(!m),children:m?"Login":"Register"})]}),_e.jsx(Fv,{sx:{justifyContent:"center",py:"24px"},children:_e.jsx(P$,{})})]})},rR=()=>{const{state:{currentUser:n},dispatch:r}=mo();fe.useEffect(()=>{n&&FP(n.token).exp*1e3<new Date().getTime()&&r({type:"UPDATE_USER",payload:null})},[])},{updateProfile:F8}=K1,B8=()=>{const{state:{profile:n,currentUser:r},dispatch:s}=mo(),u=fe.useRef(),m=()=>{s({type:"UPDATE_PROFILE",payload:{...n,open:!1}})},y=i=>{i.preventDefault();const I=u.current.value;F8(r,{name:I,file:n.file},s)},T=i=>{const I=i.target.files[0];if(I){const F=URL.createObjectURL(I);s({type:"UPDATE_PROFILE",payload:{...n,file:I,photoURL:F}})}};return _e.jsxs(jw,{open:n.open,onClose:m,children:[_e.jsxs(mP,{children:["Profile",_e.jsx(fu,{sx:{position:"absolute",right:8,top:8,color:i=>i.palette.grey[500]},onClick:m,children:_e.jsx(Zw,{})})]}),_e.jsxs("form",{onSubmit:y,children:[_e.jsxs(pP,{children:[_e.jsx(fP,{children:"You can update your profile by updating these fields:"}),_e.jsx(Ff,{margin:"normal",label:"Username",type:"text",fullWidth:!0,required:!0,autoFocus:!0,variant:"standard",id:"username",inputRef:u,slotProps:{htmlInput:{minLength:2}},defaultValue:r==null?void 0:r.name}),_e.jsxs("label",{htmlFor:"profilePhoto",children:[_e.jsx("input",{accept:"image/*",id:"profilePhoto",type:"file",style:{display:"none"},onChange:T}),_e.jsx(ug,{src:n.photoURL,sx:{width:75,cursor:"pointer"}})]})]}),_e.jsx(Fv,{sx:{px:"19px"},children:_e.jsx(cd,{type:"submit",varient:"contained",endIcon:_e.jsx(Xw,{}),children:"Update"})})]})]})},N8=({anchorUserMenu:n,setAnchorUserMenu:r})=>{rR();const{dispatch:s,state:{currentUser:u}}=mo(),m=()=>{r(null)};return _e.jsxs(_e.Fragment,{children:[_e.jsxs(SP,{anchorEl:n,open:!!n,onClose:m,onClick:m,children:[!u.google&&_e.jsxs(qC,{onClick:()=>s({type:"UPDATE_PROFILE",payload:{open:!0,file:null,photoURL:u==null?void 0:u.photoURL}}),children:[_e.jsx(NC,{children:_e.jsx(S$,{fontSize:"small"})}),"Profile"]}),_e.jsxs(qC,{onClick:()=>s({type:"UPDATE_USER",payload:null}),children:[_e.jsx(NC,{children:_e.jsx(v$,{fontSize:"small"})}),"Logout"]})]}),_e.jsx(B8,{})]})},j8=()=>{var u;rR();const{state:{currentUser:n}}=mo(),[r,s]=fe.useState(null);return _e.jsxs(Zo,{children:[_e.jsx(fu,{size:"large",color:"inherit",children:_e.jsx(EC,{color:"error",badgeContent:5,children:_e.jsx(x$,{})})}),_e.jsx(fu,{size:"large",color:"inherit",children:_e.jsx(EC,{color:"error",badgeContent:20,children:_e.jsx(w$,{})})}),_e.jsx(Lx,{title:"Open User Settings",children:_e.jsx(fu,{onClick:m=>s(m.currentTarget),children:_e.jsx(ug,{src:n==null?void 0:n.photoURL,alt:n==null?void 0:n.name,children:(u=n==null?void 0:n.name)==null?void 0:u.charAt(0).toUpperCase()})})}),_e.jsx(N8,{anchorUserMenu:r,setAnchorUserMenu:s})]})},U8=[{value:0,label:"$0"},{value:25,label:"$25"},{value:50,label:"$50"}],$8=()=>{const{state:{priceFilter:n},dispatch:r}=mo();return _e.jsxs(Zo,{sx:{mt:5},children:[_e.jsxs(so,{children:["Max Price: ",_e.jsx(m$,{})," ",n]}),_e.jsx(uU,{min:0,max:50,defaultValue:50,valueLabelDisplay:"auto",marks:U8,value:n,onChange:(s,u)=>r({type:"FILTER_PRICE",payload:u})})]})},V8=Jt("div")(({theme:n})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:n.spacing(0,1),...n.mixins.toolbar})),G8=({isOpen:n,setIsOpen:r})=>{const{containerRef:s}=mo();return _e.jsxs(kN,{variant:"persistent",hideBackdrop:!0,open:n,children:[_e.jsxs(V8,{children:[_e.jsx(so,{children:"Apply Search or Filter:"}),_e.jsx(fu,{onClick:()=>r(!1),children:_e.jsx(f$,{fontSize:"large"})})]}),_e.jsxs(Zo,{sx:{width:240,p:3},children:[_e.jsx(Zo,{ref:s}),_e.jsx($8,{})]})]})},q8=()=>{const{state:{currentUser:n},dispatch:r}=mo(),[s,u]=fe.useState(!1);return _e.jsxs(_e.Fragment,{children:[_e.jsx(KA,{children:_e.jsx(cy,{maxWidth:"lg",children:_e.jsxs(V1,{disableGutters:!0,children:[_e.jsx(Zo,{sx:{mr:1},children:_e.jsx(fu,{size:"large",color:"inherit",onClick:()=>u(!0),children:_e.jsx(b$,{})})}),_e.jsx(so,{variant:"h6",component:"h1",noWrap:!0,sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:"You Are Welcome"}),_e.jsx(so,{variant:"h6",component:"h1",noWrap:!0,sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:"YRW"}),n?_e.jsx(j8,{}):_e.jsx(cd,{color:"inherit",startIcon:_e.jsx(LP,{}),onClick:()=>r({type:"OPEN_LOGIN"}),children:"Login"})]})})}),_e.jsx(V1,{}),_e.jsx(G8,{isOpen:s,setIsOpen:u})]})},W8=()=>{const{state:{alert:n},dispatch:r}=mo(),s=(u,m)=>{m!=="clickaway"&&r({type:"UPDATE_ALERT",payload:{...n,open:!1}})};return _e.jsx(xU,{open:n.open,autoHideDuration:6e3,onClose:s,anchorOrigin:{vertical:"top",horizontal:"center"},children:_e.jsx(YA,{severity:n.severity,onClose:s,sx:{width:"100%"},variant:"filled",elevation:6,children:n.message})})},H8=()=>{const{state:{loading:n}}=mo();return _e.jsx(Bw,{open:n,sx:{zIndex:r=>r.zIndex.modal+1},children:_e.jsx(Tx,{sx:{color:"white"}})})},nS="http://localhost:3001/api/stations",Z8=async(n,r,s,u)=>{s({type:"START_LOADING"});const m=await hg({url:nS,body:n,token:r==null?void 0:r.token},s);m&&(s({type:"UPDATE_ALERT",payload:{open:!0,severity:"success",message:"The station has been added successfully"}}),s({type:"RESET_STATION"}),u(0),s({type:"UPDATE_STATION",payload:m})),s({type:"STOP_LOADING"})},X8=async n=>{const r=await hg({url:nS,method:"GET"},n);r&&n({type:"UPDATE_STATIONS",payload:r})},Y8=async(n,r,s,u)=>{if(!s)return u({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Please login to submit feedback"}}),null;u({type:"START_LOADING"});const m=await hg({url:`${nS}/${n}/feedback`,method:"POST",body:r,token:s},u);return m&&u({type:"UPDATE_STATION",payload:m}),u({type:"STOP_LOADING"}),m},rS={createStation:Z8,getStations:X8,submitFeedback:Y8},K8=fe.createContext(null);function J8(n,r){const s=Array.isArray(n)?n[0]:n?n.x:0,u=Array.isArray(n)?n[1]:n?n.y:0,m=Array.isArray(r)?r[0]:r?r.x:0,y=Array.isArray(r)?r[1]:r?r.y:0;return s===m&&u===y}function Bl(n,r){if(n===r)return!0;if(!n||!r)return!1;if(Array.isArray(n)){if(!Array.isArray(r)||n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(!Bl(n[s],r[s]))return!1;return!0}else if(Array.isArray(r))return!1;if(typeof n=="object"&&typeof r=="object"){const s=Object.keys(n),u=Object.keys(r);if(s.length!==u.length)return!1;for(const m of s)if(!r.hasOwnProperty(m)||!Bl(n[m],r[m]))return!1;return!0}return!1}function Q8(n){const r=n.clone();return r.pixelsToGLUnits=n.pixelsToGLUnits,r}function DM(n,r){if(!n.getProjection)return;const s=n.getProjection(),u=r.getProjection();Bl(s,u)||r.setProjection(s)}function OM(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function FM(n,r){const s=r.viewState||r;let u=!1;if("zoom"in s){const m=n.zoom;n.zoom=s.zoom,u=u||m!==n.zoom}if("bearing"in s){const m=n.bearing;n.bearing=s.bearing,u=u||m!==n.bearing}if("pitch"in s){const m=n.pitch;n.pitch=s.pitch,u=u||m!==n.pitch}if(s.padding&&!n.isPaddingEqual(s.padding)&&(u=!0,n.padding=s.padding),"longitude"in s&&"latitude"in s){const m=n.center;n.center=new m.constructor(s.longitude,s.latitude),u=u||m!==n.center}return u}const eG=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function BM(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const r={};for(const u of n.layers)r[u.id]=u;const s=n.layers.map(u=>{let m=null;"interactive"in u&&(m=Object.assign({},u),delete m.interactive);const y=r[u.ref];if(y){m=m||Object.assign({},u),delete m.ref;for(const T of eG)T in y&&(m[T]=y[T])}return m||u});return{...n,layers:s}}var NM={};const jM={version:8,sources:{},layers:[]},UM={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Ib={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},$M={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},tG=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],nG=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class sg{constructor(r,s,u){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=m=>{const y=this.props[$M[m.type]];y?y(m):m.type==="error"&&console.error(m.error)},this._onPointerEvent=m=>{(m.type==="mousemove"||m.type==="mouseout")&&this._updateHover(m);const y=this.props[UM[m.type]];y&&(this.props.interactiveLayerIds&&m.type!=="mouseover"&&m.type!=="mouseout"&&(m.features=this._hoveredFeatures||this._queryRenderedFeatures(m.point)),y(m),delete m.features)},this._onCameraEvent=m=>{if(!this._internalUpdate){const y=this.props[Ib[m.type]];y&&y(m)}m.type in this._deferredEvents&&(this._deferredEvents[m.type]=!1)},this._MapClass=r,this.props=s,this._initialize(u)}get map(){return this._map}get transform(){return this._renderTransform}setProps(r){const s=this.props;this.props=r;const u=this._updateSettings(r,s);u&&this._createShadowTransform(this._map);const m=this._updateSize(r),y=this._updateViewState(r,!0);this._updateStyle(r,s),this._updateStyleComponents(r,s),this._updateHandlers(r,s),(u||m||y&&!this._map.isMoving())&&this.redraw()}static reuse(r,s){const u=sg.savedMaps.pop();if(!u)return null;const m=u.map,y=m.getContainer();for(s.className=y.className;y.childNodes.length>0;)s.appendChild(y.childNodes[0]);m._container=s;const T=m._resizeObserver;T&&(T.disconnect(),T.observe(s)),u.setProps({...r,styleDiffing:!1}),m.resize();const{initialViewState:i}=r;return i&&(i.bounds?m.fitBounds(i.bounds,{...i.fitBoundsOptions,duration:0}):u._updateViewState(i,!1)),m.isStyleLoaded()?m.fire("load"):m.once("styledata",()=>m.fire("load")),m._update(),u}_initialize(r){const{props:s}=this,{mapStyle:u=jM}=s,m={...s,...s.initialViewState,accessToken:s.mapboxAccessToken||rG()||null,container:r,style:BM(u)},y=m.initialViewState||m.viewState||m;if(Object.assign(m,{center:[y.longitude||0,y.latitude||0],zoom:y.zoom||0,pitch:y.pitch||0,bearing:y.bearing||0}),s.gl){const B=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=B,s.gl)}const T=new this._MapClass(m);y.padding&&T.setPadding(y.padding),s.cursor&&(T.getCanvas().style.cursor=s.cursor),this._createShadowTransform(T);const i=T._render;T._render=B=>{this._inRender=!0,i.call(T,B),this._inRender=!1};const I=T._renderTaskQueue.run;T._renderTaskQueue.run=B=>{I.call(T._renderTaskQueue,B),this._onBeforeRepaint()},T.on("render",()=>this._onAfterRepaint());const F=T.fire;T.fire=this._fireEvent.bind(this,F),T.on("resize",()=>{this._renderTransform.resize(T.transform.width,T.transform.height)}),T.on("styledata",()=>{this._updateStyleComponents(this.props,{}),DM(T.transform,this._renderTransform)}),T.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const B in UM)T.on(B,this._onPointerEvent);for(const B in Ib)T.on(B,this._onCameraEvent);for(const B in $M)T.on(B,this._onEvent);this._map=T}recycle(){const s=this.map.getContainer().querySelector("[mapboxgl-children]");s==null||s.remove(),sg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const r=this._map;!this._inRender&&r.style&&(r._frame&&(r._frame.cancel(),r._frame=null),r._render())}_createShadowTransform(r){const s=Q8(r.transform);r.painter.transform=s,this._renderTransform=s}_updateSize(r){const{viewState:s}=r;if(s){const u=this._map;if(s.width!==u.transform.width||s.height!==u.transform.height)return u.resize(),!0}return!1}_updateViewState(r,s){if(this._internalUpdate)return!1;const u=this._map,m=this._renderTransform,{zoom:y,pitch:T,bearing:i}=m,I=u.isMoving();I&&(m.cameraElevationReference="sea");const F=FM(m,{...OM(u.transform),...r});if(I&&(m.cameraElevationReference="ground"),F&&s){const B=this._deferredEvents;B.move=!0,B.zoom||(B.zoom=y!==m.zoom),B.rotate||(B.rotate=i!==m.bearing),B.pitch||(B.pitch=T!==m.pitch)}return I||FM(u.transform,r),F}_updateSettings(r,s){const u=this._map;let m=!1;for(const y of tG)if(y in r&&!Bl(r[y],s[y])){m=!0;const T=u[`set${y[0].toUpperCase()}${y.slice(1)}`];T==null||T.call(u,r[y])}return m}_updateStyle(r,s){if(r.cursor!==s.cursor&&(this._map.getCanvas().style.cursor=r.cursor||""),r.mapStyle!==s.mapStyle){const{mapStyle:u=jM,styleDiffing:m=!0}=r,y={diff:m};return"localIdeographFontFamily"in r&&(y.localIdeographFontFamily=r.localIdeographFontFamily),this._map.setStyle(BM(u),y),!0}return!1}_updateStyleComponents(r,s){const u=this._map;let m=!1;return u.isStyleLoaded()&&("light"in r&&u.setLight&&!Bl(r.light,s.light)&&(m=!0,u.setLight(r.light)),"fog"in r&&u.setFog&&!Bl(r.fog,s.fog)&&(m=!0,u.setFog(r.fog)),"terrain"in r&&u.setTerrain&&!Bl(r.terrain,s.terrain)&&(!r.terrain||u.getSource(r.terrain.source))&&(m=!0,u.setTerrain(r.terrain))),m}_updateHandlers(r,s){var u,m;const y=this._map;let T=!1;for(const i of nG){const I=(u=r[i])!==null&&u!==void 0?u:!0,F=(m=s[i])!==null&&m!==void 0?m:!0;Bl(I,F)||(T=!0,I?y[i].enable(I):y[i].disable())}return T}_queryRenderedFeatures(r){const s=this._map,u=s.transform,{interactiveLayerIds:m=[]}=this.props;try{return s.transform=this._renderTransform,s.queryRenderedFeatures(r,{layers:m.filter(s.getLayer.bind(s))})}catch{return[]}finally{s.transform=u}}_updateHover(r){var s;const{props:u}=this;if(u.interactiveLayerIds&&(u.onMouseMove||u.onMouseEnter||u.onMouseLeave)){const y=r.type,T=((s=this._hoveredFeatures)===null||s===void 0?void 0:s.length)>0,i=this._queryRenderedFeatures(r.point),I=i.length>0;!I&&T&&(r.type="mouseleave",this._onPointerEvent(r)),this._hoveredFeatures=i,I&&!T&&(r.type="mouseenter",this._onPointerEvent(r)),r.type=y}else this._hoveredFeatures=null}_fireEvent(r,s,u){const m=this._map,y=m.transform,T=typeof s=="string"?s:s.type;return T==="move"&&this._updateViewState(this.props,!1),T in Ib&&(typeof s=="object"&&(s.viewState=OM(y)),this._map.isMoving())?(m.transform=this._renderTransform,r.call(m,s,u),m.transform=y,m):(r.call(m,s,u),m)}_onBeforeRepaint(){const r=this._map;this._internalUpdate=!0;for(const u in this._deferredEvents)this._deferredEvents[u]&&r.fire(u);this._internalUpdate=!1;const s=this._map.transform;r.transform=this._renderTransform,this._onAfterRepaint=()=>{DM(this._renderTransform,s),r.transform=s}}}sg.savedMaps=[];function rG(){let n=null;if(typeof location<"u"){const r=/access_token=([^&\/]*)/.exec(location.search);n=r&&r[1]}try{n=n||NM.MapboxAccessToken}catch{}try{n=n||NM.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const iG=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function oG(n){if(!n)return null;const r=n.map,s={getMap:()=>r,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:u=>{const m=r.transform;r.transform=n.transform;const y=r.project(u);return r.transform=m,y},unproject:u=>{const m=r.transform;r.transform=n.transform;const y=r.unproject(u);return r.transform=m,y},queryTerrainElevation:(u,m)=>{const y=r.transform;r.transform=n.transform;const T=r.queryTerrainElevation(u,m);return r.transform=y,T},queryRenderedFeatures:(u,m)=>{const y=r.transform;r.transform=n.transform;const T=r.queryRenderedFeatures(u,m);return r.transform=y,T}};for(const u of sG(r))!(u in s)&&!iG.includes(u)&&(s[u]=r[u].bind(r));return s}function sG(n){const r=new Set;let s=n;for(;s;){for(const u of Object.getOwnPropertyNames(s))u[0]!=="_"&&typeof n[u]=="function"&&u!=="fire"&&u!=="setEventedParent"&&r.add(u);s=Object.getPrototypeOf(s)}return Array.from(r)}const aG=typeof document<"u"?fe.useLayoutEffect:fe.useEffect,lG=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function cG(n,r){for(const u of lG)u in r&&(n[u]=r[u]);const{RTLTextPlugin:s="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=r;s&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(s,u=>{u&&console.error(u)},!0)}const pg=fe.createContext(null);function uG(n,r,s){const u=fe.useContext(K8),[m,y]=fe.useState(null),T=fe.useRef(),{current:i}=fe.useRef({mapLib:null,map:null});fe.useEffect(()=>{const B=n.mapLib;let G=!0,J;return Promise.resolve(B||s).then(te=>{if(!G)return;if(!te)throw new Error("Invalid mapLib");const H="Map"in te?te:te.default;if(!H.Map)throw new Error("Invalid mapLib");if(cG(H,n),!H.supported||H.supported(n))n.reuseMaps&&(J=sg.reuse(n,T.current)),J||(J=new sg(H.Map,n,T.current)),i.map=oG(J),i.mapLib=H,y(J),u==null||u.onMapMount(i.map,n.id);else throw new Error("Map is not supported by this browser")}).catch(te=>{const{onError:H}=n;H?H({type:"error",target:null,originalEvent:null,error:te}):console.error(te)}),()=>{G=!1,J&&(u==null||u.onMapUnmount(n.id),n.reuseMaps?J.recycle():J.destroy())}},[]),aG(()=>{m&&m.setProps(n)}),fe.useImperativeHandle(r,()=>i.map,[m]);const I=fe.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),F={height:"100%"};return fe.createElement("div",{id:n.id,ref:T,style:I},m&&fe.createElement(pg.Provider,{value:i},fe.createElement("div",{"mapboxgl-children":"",style:F},n.children)))}const dG=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Gf(n,r){if(!n||!r)return;const s=n.style;for(const u in r){const m=r[u];Number.isFinite(m)&&!dG.test(u)?s[u]=`${m}px`:s[u]=m}}function hG(n,r){const{map:s,mapLib:u}=fe.useContext(pg),m=fe.useRef({props:n});m.current.props=n;const y=fe.useMemo(()=>{let j=!1;fe.Children.forEach(n.children,pe=>{pe&&(j=!0)});const ne={...n,element:j?document.createElement("div"):null},oe=new u.Marker(ne);return oe.setLngLat([n.longitude,n.latitude]),oe.getElement().addEventListener("click",pe=>{var se,ie;(ie=(se=m.current.props).onClick)===null||ie===void 0||ie.call(se,{type:"click",target:oe,originalEvent:pe})}),oe.on("dragstart",pe=>{var se,ie;const ce=pe;ce.lngLat=y.getLngLat(),(ie=(se=m.current.props).onDragStart)===null||ie===void 0||ie.call(se,ce)}),oe.on("drag",pe=>{var se,ie;const ce=pe;ce.lngLat=y.getLngLat(),(ie=(se=m.current.props).onDrag)===null||ie===void 0||ie.call(se,ce)}),oe.on("dragend",pe=>{var se,ie;const ce=pe;ce.lngLat=y.getLngLat(),(ie=(se=m.current.props).onDragEnd)===null||ie===void 0||ie.call(se,ce)}),oe},[]);fe.useEffect(()=>(y.addTo(s.getMap()),()=>{y.remove()}),[]);const{longitude:T,latitude:i,offset:I,style:F,draggable:B=!1,popup:G=null,rotation:J=0,rotationAlignment:te="auto",pitchAlignment:H="auto"}=n;return fe.useEffect(()=>{Gf(y.getElement(),F)},[F]),fe.useImperativeHandle(r,()=>y,[]),(y.getLngLat().lng!==T||y.getLngLat().lat!==i)&&y.setLngLat([T,i]),I&&!J8(y.getOffset(),I)&&y.setOffset(I),y.isDraggable()!==B&&y.setDraggable(B),y.getRotation()!==J&&y.setRotation(J),y.getRotationAlignment()!==te&&y.setRotationAlignment(te),y.getPitchAlignment()!==H&&y.setPitchAlignment(H),y.getPopup()!==G&&y.setPopup(G),Sx.createPortal(n.children,y.getElement())}const pG=fe.memo(fe.forwardRef(hG));function VM(n){return new Set(n?n.trim().split(/\s+/):[])}function fG(n,r){const{map:s,mapLib:u}=fe.useContext(pg),m=fe.useMemo(()=>document.createElement("div"),[]),y=fe.useRef({props:n});y.current.props=n;const T=fe.useMemo(()=>{const i={...n},I=new u.Popup(i);return I.setLngLat([n.longitude,n.latitude]),I.once("open",F=>{var B,G;(G=(B=y.current.props).onOpen)===null||G===void 0||G.call(B,F)}),I},[]);if(fe.useEffect(()=>{const i=I=>{var F,B;(B=(F=y.current.props).onClose)===null||B===void 0||B.call(F,I)};return T.on("close",i),T.setDOMContent(m).addTo(s.getMap()),()=>{T.off("close",i),T.isOpen()&&T.remove()}},[]),fe.useEffect(()=>{Gf(T.getElement(),n.style)},[n.style]),fe.useImperativeHandle(r,()=>T,[]),T.isOpen()&&((T.getLngLat().lng!==n.longitude||T.getLngLat().lat!==n.latitude)&&T.setLngLat([n.longitude,n.latitude]),n.offset&&!Bl(T.options.offset,n.offset)&&T.setOffset(n.offset),(T.options.anchor!==n.anchor||T.options.maxWidth!==n.maxWidth)&&(T.options.anchor=n.anchor,T.setMaxWidth(n.maxWidth)),T.options.className!==n.className)){const i=VM(T.options.className),I=VM(n.className);for(const F of i)I.has(F)||T.removeClassName(F);for(const F of I)i.has(F)||T.addClassName(F);T.options.className=n.className}return Sx.createPortal(n.children,m)}const mG=fe.memo(fe.forwardRef(fG));function fg(n,r,s,u){const m=fe.useContext(pg),y=fe.useMemo(()=>n(m),[]);return fe.useEffect(()=>{const T=r,i=typeof r=="function"?r:null,{map:I}=m;return I.hasControl(y)||I.addControl(y,T==null?void 0:T.position),()=>{i&&i(m),I.hasControl(y)&&I.removeControl(y)}},[]),y}function gG(n){const r=fg(({mapLib:s})=>new s.AttributionControl(n),{position:n.position});return fe.useEffect(()=>{Gf(r._container,n.style)},[n.style]),null}fe.memo(gG);function _G(n){const r=fg(({mapLib:s})=>new s.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return fe.useEffect(()=>{Gf(r._controlContainer,n.style)},[n.style]),null}fe.memo(_G);function yG(n,r){const s=fe.useRef({props:n}),u=fg(({mapLib:m})=>{const y=new m.GeolocateControl(n),T=y._setupUI;return y._setupUI=i=>{y._container.hasChildNodes()||T(i)},y.on("geolocate",i=>{var I,F;(F=(I=s.current.props).onGeolocate)===null||F===void 0||F.call(I,i)}),y.on("error",i=>{var I,F;(F=(I=s.current.props).onError)===null||F===void 0||F.call(I,i)}),y.on("outofmaxbounds",i=>{var I,F;(F=(I=s.current.props).onOutOfMaxBounds)===null||F===void 0||F.call(I,i)}),y.on("trackuserlocationstart",i=>{var I,F;(F=(I=s.current.props).onTrackUserLocationStart)===null||F===void 0||F.call(I,i)}),y.on("trackuserlocationend",i=>{var I,F;(F=(I=s.current.props).onTrackUserLocationEnd)===null||F===void 0||F.call(I,i)}),y},{position:n.position});return s.current.props=n,fe.useImperativeHandle(r,()=>u,[]),fe.useEffect(()=>{Gf(u._container,n.style)},[n.style]),null}const vG=fe.memo(fe.forwardRef(yG));function xG(n){const r=fg(({mapLib:s})=>new s.NavigationControl(n),{position:n.position});return fe.useEffect(()=>{Gf(r._container,n.style)},[n.style]),null}const bG=fe.memo(xG);function wG(n){const r=fg(({mapLib:y})=>new y.ScaleControl(n),{position:n.position}),s=fe.useRef(n),u=s.current;s.current=n;const{style:m}=n;return n.maxWidth!==void 0&&n.maxWidth!==u.maxWidth&&(r.options.maxWidth=n.maxWidth),n.unit!==void 0&&n.unit!==u.unit&&r.setUnit(n.unit),fe.useEffect(()=>{Gf(r._container,m)},[m]),null}fe.memo(wG);function Qv(n,r){if(!n)throw new Error(r)}function SG(n,r,s,u){if(Qv(s.id===u.id,"layer id changed"),Qv(s.type===u.type,"layer type changed"),s.type==="custom"||u.type==="custom")return;const{layout:m={},paint:y={},filter:T,minzoom:i,maxzoom:I,beforeId:F}=s;if(F!==u.beforeId&&n.moveLayer(r,F),m!==u.layout){const B=u.layout||{};for(const G in m)Bl(m[G],B[G])||n.setLayoutProperty(r,G,m[G]);for(const G in B)m.hasOwnProperty(G)||n.setLayoutProperty(r,G,void 0)}if(y!==u.paint){const B=u.paint||{};for(const G in y)Bl(y[G],B[G])||n.setPaintProperty(r,G,y[G]);for(const G in B)y.hasOwnProperty(G)||n.setPaintProperty(r,G,void 0)}Bl(T,u.filter)||n.setFilter(r,T),(i!==u.minzoom||I!==u.maxzoom)&&n.setLayerZoomRange(r,i,I)}function TG(n,r,s){if(n.style&&n.style._loaded&&(!("source"in s)||n.getSource(s.source))){const u={...s,id:r};delete u.beforeId,n.addLayer(u,s.beforeId)}}let EG=0;function CG(n){const r=fe.useContext(pg).map.getMap(),s=fe.useRef(n),[,u]=fe.useState(0),m=fe.useMemo(()=>n.id||`jsx-layer-${EG++}`,[]);if(fe.useEffect(()=>{if(r){const T=()=>u(i=>i+1);return r.on("styledata",T),T(),()=>{r.off("styledata",T),r.style&&r.style._loaded&&r.getLayer(m)&&r.removeLayer(m)}}},[r]),r&&r.style&&r.getLayer(m))try{SG(r,m,n,s.current)}catch(T){console.warn(T)}else TG(r,m,n);return s.current=n,null}let MG=0;function IG(n,r,s){if(n.style&&n.style._loaded){const u={...s};return delete u.id,delete u.children,n.addSource(r,u),n.getSource(r)}return null}function AG(n,r,s){Qv(r.id===s.id,"source id changed"),Qv(r.type===s.type,"source type changed");let u="",m=0;for(const T in r)T!=="children"&&T!=="id"&&!Bl(s[T],r[T])&&(u=T,m++);if(!m)return;const y=r.type;y==="geojson"?n.setData(r.data):y==="image"?n.updateImage({url:r.url,coordinates:r.coordinates}):"setCoordinates"in n&&m===1&&u==="coordinates"?n.setCoordinates(r.coordinates):"setUrl"in n&&u==="url"?n.setUrl(r.url):"setTiles"in n&&u==="tiles"?n.setTiles(r.tiles):console.warn(`Unable to update <Source> prop: ${u}`)}function PG(n){const r=fe.useContext(pg).map.getMap(),s=fe.useRef(n),[,u]=fe.useState(0),m=fe.useMemo(()=>n.id||`jsx-source-${MG++}`,[]);fe.useEffect(()=>{if(r){const T=()=>setTimeout(()=>u(i=>i+1),0);return r.on("styledata",T),T(),()=>{var i;if(r.off("styledata",T),r.style&&r.style._loaded&&r.getSource(m)){const I=(i=r.getStyle())===null||i===void 0?void 0:i.layers;if(I)for(const F of I)F.source===m&&r.removeLayer(F.id);r.removeSource(m)}}}},[r]);let y=r&&r.style&&r.getSource(m);return y?AG(y,n,s.current):y=IG(r,m,n),s.current=n,y&&fe.Children.map(n.children,T=>T&&fe.cloneElement(T,{source:m}))||null}const RG=Bf(()=>Promise.resolve().then(()=>dW),void 0),iR=fe.forwardRef(function(r,s){return uG(r,s,RG)}),J1=pG,kG=mG,oR=bG,sR=vG,LG=CG,zG=PG;var zl=63710088e-1,DG={centimeters:zl*100,centimetres:zl*100,degrees:360/(2*Math.PI),feet:zl*3.28084,inches:zl*39.37,kilometers:zl/1e3,kilometres:zl/1e3,meters:zl,metres:zl,miles:zl/1609.344,millimeters:zl*1e3,millimetres:zl*1e3,nauticalmiles:zl/1852,radians:1,yards:zl*1.0936};function OG(n,r="kilometers"){const s=DG[r];if(!s)throw new Error(r+" units is invalid");return n*s}function Sv(n){return n%360*Math.PI/180}function GM(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function FG(n,r,s={}){var u=GM(n),m=GM(r),y=Sv(m[1]-u[1]),T=Sv(m[0]-u[0]),i=Sv(u[1]),I=Sv(m[1]),F=Math.pow(Math.sin(y/2),2)+Math.pow(Math.sin(T/2),2)*Math.cos(i)*Math.cos(I);return OG(2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F)),s.units)}const BG=(n,r,s=10)=>!n||!r.length?[]:r.map(u=>{const m=FG([n.lng,n.lat],[parseFloat(u.lng),parseFloat(u.lat)],{units:"kilometers"});return{...u,distance:m}}).filter(u=>u.distance<=s).sort((u,m)=>u.distance-m.distance),qM=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Ab=1,x_=8;class iS{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==Ab)throw new Error(`Got v${m} data when expected v${Ab}.`);const y=qM[u&15];if(!y)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(r,2,1),[i]=new Uint32Array(r,4,1);return new iS(i,T,y,r)}constructor(r,s=64,u=Float64Array,m){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const y=qM.indexOf(this.ArrayType),T=r*2*this.ArrayType.BYTES_PER_ELEMENT,i=r*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-i%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,x_,r),this.coords=new this.ArrayType(this.data,x_+i+I,r*2),this._pos=r*2,this._finished=!0):(this.data=new ArrayBuffer(x_+T+i+I),this.ids=new this.IndexArrayType(this.data,x_,r),this.coords=new this.ArrayType(this.data,x_+i+I,r*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Ab<<4)+y]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=r,this.coords[this._pos++]=s,u}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Q1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:T,nodeSize:i}=this,I=[0,y.length-1,0],F=[];for(;I.length;){const B=I.pop()||0,G=I.pop()||0,J=I.pop()||0;if(G-J<=i){for(let ne=J;ne<=G;ne++){const oe=T[2*ne],pe=T[2*ne+1];oe>=r&&oe<=u&&pe>=s&&pe<=m&&F.push(y[ne])}continue}const te=J+G>>1,H=T[2*te],j=T[2*te+1];H>=r&&H<=u&&j>=s&&j<=m&&F.push(y[te]),(B===0?r<=H:s<=j)&&(I.push(J),I.push(te-1),I.push(1-B)),(B===0?u>=H:m>=j)&&(I.push(te+1),I.push(G),I.push(1-B))}return F}within(r,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:T}=this,i=[0,m.length-1,0],I=[],F=u*u;for(;i.length;){const B=i.pop()||0,G=i.pop()||0,J=i.pop()||0;if(G-J<=T){for(let ne=J;ne<=G;ne++)WM(y[2*ne],y[2*ne+1],r,s)<=F&&I.push(m[ne]);continue}const te=J+G>>1,H=y[2*te],j=y[2*te+1];WM(H,j,r,s)<=F&&I.push(m[te]),(B===0?r-u<=H:s-u<=j)&&(i.push(J),i.push(te-1),i.push(1-B)),(B===0?r+u>=H:s+u>=j)&&(i.push(te+1),i.push(G),i.push(1-B))}return I}}function Q1(n,r,s,u,m,y){if(m-u<=s)return;const T=u+m>>1;aR(n,r,T,u,m,y),Q1(n,r,s,u,T-1,1-y),Q1(n,r,s,T+1,m,1-y)}function aR(n,r,s,u,m,y){for(;m>u;){if(m-u>600){const F=m-u+1,B=s-u+1,G=Math.log(F),J=.5*Math.exp(2*G/3),te=.5*Math.sqrt(G*J*(F-J)/F)*(B-F/2<0?-1:1),H=Math.max(u,Math.floor(s-B*J/F+te)),j=Math.min(m,Math.floor(s+(F-B)*J/F+te));aR(n,r,s,H,j,y)}const T=r[2*s+y];let i=u,I=m;for(b_(n,r,u,s),r[2*m+y]>T&&b_(n,r,u,m);i<I;){for(b_(n,r,i,I),i++,I--;r[2*i+y]<T;)i++;for(;r[2*I+y]>T;)I--}r[2*u+y]===T?b_(n,r,u,I):(I++,b_(n,r,I,m)),I<=s&&(u=I+1),s<=I&&(m=I-1)}}function b_(n,r,s,u){Pb(n,s,u),Pb(r,2*s,2*u),Pb(r,2*s+1,2*u+1)}function Pb(n,r,s){const u=n[r];n[r]=n[s],n[s]=u}function WM(n,r,s,u){const m=n-s,y=r-u;return m*m+y*y}const NG={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},HM=Math.fround||(n=>r=>(n[0]=+r,n[0]))(new Float32Array(1)),vf=2,gp=3,Rb=4,fp=5,lR=6;class jG{constructor(r){this.options=Object.assign(Object.create(NG),r),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(r){const{log:s,minZoom:u,maxZoom:m}=this.options;s&&console.time("total time");const y=`prepare ${r.length} points`;s&&console.time(y),this.points=r;const T=[];for(let I=0;I<r.length;I++){const F=r[I];if(!F.geometry)continue;const[B,G]=F.geometry.coordinates,J=HM(Tv(B)),te=HM(Ev(G));T.push(J,te,1/0,I,-1,1),this.options.reduce&&T.push(0)}let i=this.trees[m+1]=this._createTree(T);s&&console.timeEnd(y);for(let I=m;I>=u;I--){const F=+Date.now();i=this.trees[I]=this._createTree(this._cluster(i,I)),s&&console.log("z%d: %d clusters in %dms",I,i.numItems,+Date.now()-F)}return s&&console.timeEnd("total time"),this}getClusters(r,s){let u=((r[0]+180)%360+360)%360-180;const m=Math.max(-90,Math.min(90,r[1]));let y=r[2]===180?180:((r[2]+180)%360+360)%360-180;const T=Math.max(-90,Math.min(90,r[3]));if(r[2]-r[0]>=360)u=-180,y=180;else if(u>y){const G=this.getClusters([u,m,180,T],s),J=this.getClusters([-180,m,y,T],s);return G.concat(J)}const i=this.trees[this._limitZoom(s)],I=i.range(Tv(u),Ev(T),Tv(y),Ev(m)),F=i.data,B=[];for(const G of I){const J=this.stride*G;B.push(F[J+fp]>1?ZM(F,J,this.clusterProps):this.points[F[J+gp]])}return B}getChildren(r){const s=this._getOriginId(r),u=this._getOriginZoom(r),m="No cluster with the specified id.",y=this.trees[u];if(!y)throw new Error(m);const T=y.data;if(s*this.stride>=T.length)throw new Error(m);const i=this.options.radius/(this.options.extent*Math.pow(2,u-1)),I=T[s*this.stride],F=T[s*this.stride+1],B=y.within(I,F,i),G=[];for(const J of B){const te=J*this.stride;T[te+Rb]===r&&G.push(T[te+fp]>1?ZM(T,te,this.clusterProps):this.points[T[te+gp]])}if(G.length===0)throw new Error(m);return G}getLeaves(r,s,u){s=s||10,u=u||0;const m=[];return this._appendLeaves(m,r,s,u,0),m}getTile(r,s,u){const m=this.trees[this._limitZoom(r)],y=Math.pow(2,r),{extent:T,radius:i}=this.options,I=i/T,F=(u-I)/y,B=(u+1+I)/y,G={features:[]};return this._addTileFeatures(m.range((s-I)/y,F,(s+1+I)/y,B),m.data,s,u,y,G),s===0&&this._addTileFeatures(m.range(1-I/y,F,1,B),m.data,y,u,y,G),s===y-1&&this._addTileFeatures(m.range(0,F,I/y,B),m.data,-1,u,y,G),G.features.length?G:null}getClusterExpansionZoom(r){let s=this._getOriginZoom(r)-1;for(;s<=this.options.maxZoom;){const u=this.getChildren(r);if(s++,u.length!==1)break;r=u[0].properties.cluster_id}return s}_appendLeaves(r,s,u,m,y){const T=this.getChildren(s);for(const i of T){const I=i.properties;if(I&&I.cluster?y+I.point_count<=m?y+=I.point_count:y=this._appendLeaves(r,I.cluster_id,u,m,y):y<m?y++:r.push(i),r.length===u)break}return y}_createTree(r){const s=new iS(r.length/this.stride|0,this.options.nodeSize,Float32Array);for(let u=0;u<r.length;u+=this.stride)s.add(r[u],r[u+1]);return s.finish(),s.data=r,s}_addTileFeatures(r,s,u,m,y,T){for(const i of r){const I=i*this.stride,F=s[I+fp]>1;let B,G,J;if(F)B=cR(s,I,this.clusterProps),G=s[I],J=s[I+1];else{const j=this.points[s[I+gp]];B=j.properties;const[ne,oe]=j.geometry.coordinates;G=Tv(ne),J=Ev(oe)}const te={type:1,geometry:[[Math.round(this.options.extent*(G*y-u)),Math.round(this.options.extent*(J*y-m))]],tags:B};let H;F||this.options.generateId?H=s[I+gp]:H=this.points[s[I+gp]].id,H!==void 0&&(te.id=H),T.features.push(te)}}_limitZoom(r){return Math.max(this.options.minZoom,Math.min(Math.floor(+r),this.options.maxZoom+1))}_cluster(r,s){const{radius:u,extent:m,reduce:y,minPoints:T}=this.options,i=u/(m*Math.pow(2,s)),I=r.data,F=[],B=this.stride;for(let G=0;G<I.length;G+=B){if(I[G+vf]<=s)continue;I[G+vf]=s;const J=I[G],te=I[G+1],H=r.within(I[G],I[G+1],i),j=I[G+fp];let ne=j;for(const oe of H){const pe=oe*B;I[pe+vf]>s&&(ne+=I[pe+fp])}if(ne>j&&ne>=T){let oe=J*j,pe=te*j,se,ie=-1;const ce=((G/B|0)<<5)+(s+1)+this.points.length;for(const we of H){const xe=we*B;if(I[xe+vf]<=s)continue;I[xe+vf]=s;const $e=I[xe+fp];oe+=I[xe]*$e,pe+=I[xe+1]*$e,I[xe+Rb]=ce,y&&(se||(se=this._map(I,G,!0),ie=this.clusterProps.length,this.clusterProps.push(se)),y(se,this._map(I,xe)))}I[G+Rb]=ce,F.push(oe/ne,pe/ne,1/0,ce,-1,ne),y&&F.push(ie)}else{for(let oe=0;oe<B;oe++)F.push(I[G+oe]);if(ne>1)for(const oe of H){const pe=oe*B;if(!(I[pe+vf]<=s)){I[pe+vf]=s;for(let se=0;se<B;se++)F.push(I[pe+se])}}}}return F}_getOriginId(r){return r-this.points.length>>5}_getOriginZoom(r){return(r-this.points.length)%32}_map(r,s,u){if(r[s+fp]>1){const T=this.clusterProps[r[s+lR]];return u?Object.assign({},T):T}const m=this.points[r[s+gp]].properties,y=this.options.map(m);return u&&y===m?Object.assign({},y):y}}function ZM(n,r,s){return{type:"Feature",id:n[r+gp],properties:cR(n,r,s),geometry:{type:"Point",coordinates:[UG(n[r]),$G(n[r+1])]}}}function cR(n,r,s){const u=n[r+fp],m=u>=1e4?`${Math.round(u/1e3)}k`:u>=1e3?`${Math.round(u/100)/10}k`:u,y=n[r+lR],T=y===-1?{}:Object.assign({},s[y]);return Object.assign(T,{cluster:!0,cluster_id:n[r+gp],point_count:u,point_count_abbreviated:m})}function Tv(n){return n/360+.5}function Ev(n){const r=Math.sin(n*Math.PI/180),s=.5-.25*Math.log((1+r)/(1-r))/Math.PI;return s<0?0:s>1?1:s}function UG(n){return(n-.5)*360}function $G(n){const r=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(r))/Math.PI-90}var kb,XM;function mg(){if(XM)return kb;XM=1,kb=r;var n=Object.prototype.hasOwnProperty;function r(){for(var s={},u=0;u<arguments.length;u++){var m=arguments[u];for(var y in m)n.call(m,y)&&(s[y]=m[y])}return s}return kb}var Lb={exports:{}},YM;function VG(){return YM||(YM=1,function(n,r){(function(){var s={};n.exports=s,s.simpleFilter=function(u,m){return m.filter(function(y){return s.test(u,y)})},s.test=function(u,m){return s.match(u,m)!==null},s.match=function(u,m,y){y=y||{};var T=0,i=[],I=m.length,F=0,B=0,G=y.pre||"",J=y.post||"",te=y.caseSensitive&&m||m.toLowerCase(),H;u=y.caseSensitive&&u||u.toLowerCase();for(var j=0;j<I;j++)H=m[j],te[j]===u[T]?(H=G+H+J,T+=1,B+=1+B):B=0,F+=B,i[i.length]=H;return T===u.length?(F=te===u?1/0:F,{rendered:i.join(""),score:F}):null},s.filter=function(u,m,y){return!m||m.length===0?[]:typeof u!="string"?m:(y=y||{},m.reduce(function(T,i,I,F){var B=i;y.extract&&(B=y.extract(i));var G=s.match(u,B,y);return G!=null&&(T[T.length]={string:G.rendered,score:G.score,index:I,original:i}),T},[]).sort(function(T,i){var I=i.score-T.score;return I||T.index-i.index}))}})()}(Lb)),Lb.exports}var zb,KM;function GG(){if(KM)return zb;KM=1;var n=function(r){return this.component=r,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,r.el.parentNode.insertBefore(this.wrapper,r.el.nextSibling),this};return n.prototype.show=function(){this.element.style.display="block"},n.prototype.hide=function(){this.element.style.display="none"},n.prototype.add=function(r){this.items.push(r)},n.prototype.clear=function(){this.items=[],this.active=0},n.prototype.isEmpty=function(){return!this.items.length},n.prototype.isVisible=function(){return this.element.style.display==="block"},n.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()},n.prototype.drawItem=function(r,s){var u=document.createElement("li"),m=document.createElement("a");s&&(u.className+=" active"),m.innerHTML=r.string,u.appendChild(m),this.element.appendChild(u),u.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),u.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,r)}).bind(this))},n.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()},n.prototype.move=function(r){this.active=r,this.draw()},n.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)},n.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},n.prototype.drawError=function(r){var s=document.createElement("li");s.innerHTML=r,this.element.appendChild(s),this.show()},zb=n,zb}var Db,JM;function qG(){if(JM)return Db;JM=1;var n=mg(),r=VG(),s=GG(),u=function(m,y,T){return T=T||{},this.options=n({minLength:2,limit:5,filter:!0,hideOnBlur:!0},T),this.el=m,this.data=y||[],this.list=new s(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(i){this.handleKeyUp(i.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(i){this.handleKeyDown(i)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(i){this.handlePaste(i)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return u.prototype.handleKeyUp=function(m){m===40||m===38||m===27||m===13||m===9||this.handleInputChange(this.el.value)},u.prototype.handleKeyDown=function(m){switch(m.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&m.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},u.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},u.prototype.handlePaste=function(m){if(m.clipboardData)this.handleInputChange(m.clipboardData.getData("Text"));else{var y=this;setTimeout(function(){y.handleInputChange(m.target.value)},100)}},u.prototype.handleInputChange=function(m){if(this.query=this.normalize(m),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(y){for(var T=0;T<y.length&&(this.list.add(y[T]),T!==this.options.limit-1);T++);this.list.draw()}).bind(this))},u.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},u.prototype.update=function(m){this.data=m,this.handleKeyUp()},u.prototype.clear=function(){this.data=[],this.list.clear()},u.prototype.normalize=function(m){return m=m.toLowerCase(),m},u.prototype.match=function(m,y){return m.indexOf(y)>-1},u.prototype.value=function(m){if(this.selected=m,this.el.value=this.getItemValue(m),document.createEvent){var y=document.createEvent("HTMLEvents");y.initEvent("change",!0,!1),this.el.dispatchEvent(y)}else this.el.fireEvent("onchange")},u.prototype.getCandidates=function(m){var y={pre:"<strong>",post:"</strong>",extract:(function(i){return this.getItemValue(i)}).bind(this)},T;this.options.filter?(T=r.filter(this.query,this.data,y),T=T.map((function(i){return{original:i.original,string:this.render(i.original,i.string)}}).bind(this))):T=this.data.map((function(i){var I=this.render(i);return{original:i,string:I}}).bind(this)),m(T)},u.prototype.getItemValue=function(m){return m},u.prototype.render=function(m,y){if(y)return y;for(var T=m.original?this.getItemValue(m.original):this.getItemValue(m),i=this.normalize(T),I=i.lastIndexOf(this.query);I>-1;){var F=I+this.query.length;T=T.slice(0,I)+"<strong>"+T.slice(I,F)+"</strong>"+T.slice(F),I=i.slice(0,I).lastIndexOf(this.query)}return T},u.prototype.renderError=function(m){this.list.drawError(m)},Db=u,Db}var Ob,QM;function WG(){if(QM)return Ob;QM=1;var n=qG();return Ob=n,typeof window<"u"&&(window.Suggestions=n),Ob}var Fb,eI;function HG(){if(eI)return Fb;eI=1;var n="Expected a function",r=NaN,s="[object Symbol]",u=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,T=/^0o[0-7]+$/i,i=parseInt,I=typeof vp=="object"&&vp&&vp.Object===Object&&vp,F=typeof self=="object"&&self&&self.Object===Object&&self,B=I||F||Function("return this")(),G=Object.prototype,J=G.toString,te=Math.max,H=Math.min,j=function(){return B.Date.now()};function ne(ce,we,xe){var $e,Ze,ae,ke,ct,Xe,st=0,et=!1,gt=!1,zt=!0;if(typeof ce!="function")throw new TypeError(n);we=ie(we)||0,oe(xe)&&(et=!!xe.leading,gt="maxWait"in xe,ae=gt?te(ie(xe.maxWait)||0,we):ae,zt="trailing"in xe?!!xe.trailing:zt);function at(Ut){var hn=$e,xn=Ze;return $e=Ze=void 0,st=Ut,ke=ce.apply(xn,hn),ke}function Ye(Ut){return st=Ut,ct=setTimeout(Rt,we),et?at(Ut):ke}function Bt(Ut){var hn=Ut-Xe,xn=Ut-st,Le=we-hn;return gt?H(Le,ae-xn):Le}function nt(Ut){var hn=Ut-Xe,xn=Ut-st;return Xe===void 0||hn>=we||hn<0||gt&&xn>=ae}function Rt(){var Ut=j();if(nt(Ut))return Nt(Ut);ct=setTimeout(Rt,Bt(Ut))}function Nt(Ut){return ct=void 0,zt&&$e?at(Ut):($e=Ze=void 0,ke)}function gn(){ct!==void 0&&clearTimeout(ct),st=0,$e=Xe=Ze=ct=void 0}function Mt(){return ct===void 0?ke:Nt(j())}function $t(){var Ut=j(),hn=nt(Ut);if($e=arguments,Ze=this,Xe=Ut,hn){if(ct===void 0)return Ye(Xe);if(gt)return ct=setTimeout(Rt,we),at(Xe)}return ct===void 0&&(ct=setTimeout(Rt,we)),ke}return $t.cancel=gn,$t.flush=Mt,$t}function oe(ce){var we=typeof ce;return!!ce&&(we=="object"||we=="function")}function pe(ce){return!!ce&&typeof ce=="object"}function se(ce){return typeof ce=="symbol"||pe(ce)&&J.call(ce)==s}function ie(ce){if(typeof ce=="number")return ce;if(se(ce))return r;if(oe(ce)){var we=typeof ce.valueOf=="function"?ce.valueOf():ce;ce=oe(we)?we+"":we}if(typeof ce!="string")return ce===0?ce:+ce;ce=ce.replace(u,"");var xe=y.test(ce);return xe||T.test(ce)?i(ce.slice(2),xe?2:8):m.test(ce)?r:+ce}return Fb=ne,Fb}var Cv={exports:{}},tI;function ZG(){if(tI)return Cv.exports;tI=1;var n=typeof Reflect=="object"?Reflect:null,r=n&&typeof n.apply=="function"?n.apply:function(ce,we,xe){return Function.prototype.apply.call(ce,we,xe)},s;n&&typeof n.ownKeys=="function"?s=n.ownKeys:Object.getOwnPropertySymbols?s=function(ce){return Object.getOwnPropertyNames(ce).concat(Object.getOwnPropertySymbols(ce))}:s=function(ce){return Object.getOwnPropertyNames(ce)};function u(ie){console&&console.warn&&console.warn(ie)}var m=Number.isNaN||function(ce){return ce!==ce};function y(){y.init.call(this)}Cv.exports=y,Cv.exports.once=oe,y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var T=10;function i(ie){if(typeof ie!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ie)}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return T},set:function(ie){if(typeof ie!="number"||ie<0||m(ie))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ie+".");T=ie}}),y.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(ce){if(typeof ce!="number"||ce<0||m(ce))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ce+".");return this._maxListeners=ce,this};function I(ie){return ie._maxListeners===void 0?y.defaultMaxListeners:ie._maxListeners}y.prototype.getMaxListeners=function(){return I(this)},y.prototype.emit=function(ce){for(var we=[],xe=1;xe<arguments.length;xe++)we.push(arguments[xe]);var $e=ce==="error",Ze=this._events;if(Ze!==void 0)$e=$e&&Ze.error===void 0;else if(!$e)return!1;if($e){var ae;if(we.length>0&&(ae=we[0]),ae instanceof Error)throw ae;var ke=new Error("Unhandled error."+(ae?" ("+ae.message+")":""));throw ke.context=ae,ke}var ct=Ze[ce];if(ct===void 0)return!1;if(typeof ct=="function")r(ct,this,we);else for(var Xe=ct.length,st=H(ct,Xe),xe=0;xe<Xe;++xe)r(st[xe],this,we);return!0};function F(ie,ce,we,xe){var $e,Ze,ae;if(i(we),Ze=ie._events,Ze===void 0?(Ze=ie._events=Object.create(null),ie._eventsCount=0):(Ze.newListener!==void 0&&(ie.emit("newListener",ce,we.listener?we.listener:we),Ze=ie._events),ae=Ze[ce]),ae===void 0)ae=Ze[ce]=we,++ie._eventsCount;else if(typeof ae=="function"?ae=Ze[ce]=xe?[we,ae]:[ae,we]:xe?ae.unshift(we):ae.push(we),$e=I(ie),$e>0&&ae.length>$e&&!ae.warned){ae.warned=!0;var ke=new Error("Possible EventEmitter memory leak detected. "+ae.length+" "+String(ce)+" listeners added. Use emitter.setMaxListeners() to increase limit");ke.name="MaxListenersExceededWarning",ke.emitter=ie,ke.type=ce,ke.count=ae.length,u(ke)}return ie}y.prototype.addListener=function(ce,we){return F(this,ce,we,!1)},y.prototype.on=y.prototype.addListener,y.prototype.prependListener=function(ce,we){return F(this,ce,we,!0)};function B(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(ie,ce,we){var xe={fired:!1,wrapFn:void 0,target:ie,type:ce,listener:we},$e=B.bind(xe);return $e.listener=we,xe.wrapFn=$e,$e}y.prototype.once=function(ce,we){return i(we),this.on(ce,G(this,ce,we)),this},y.prototype.prependOnceListener=function(ce,we){return i(we),this.prependListener(ce,G(this,ce,we)),this},y.prototype.removeListener=function(ce,we){var xe,$e,Ze,ae,ke;if(i(we),$e=this._events,$e===void 0)return this;if(xe=$e[ce],xe===void 0)return this;if(xe===we||xe.listener===we)--this._eventsCount===0?this._events=Object.create(null):(delete $e[ce],$e.removeListener&&this.emit("removeListener",ce,xe.listener||we));else if(typeof xe!="function"){for(Ze=-1,ae=xe.length-1;ae>=0;ae--)if(xe[ae]===we||xe[ae].listener===we){ke=xe[ae].listener,Ze=ae;break}if(Ze<0)return this;Ze===0?xe.shift():j(xe,Ze),xe.length===1&&($e[ce]=xe[0]),$e.removeListener!==void 0&&this.emit("removeListener",ce,ke||we)}return this},y.prototype.off=y.prototype.removeListener,y.prototype.removeAllListeners=function(ce){var we,xe,$e;if(xe=this._events,xe===void 0)return this;if(xe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xe[ce]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete xe[ce]),this;if(arguments.length===0){var Ze=Object.keys(xe),ae;for($e=0;$e<Ze.length;++$e)ae=Ze[$e],ae!=="removeListener"&&this.removeAllListeners(ae);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(we=xe[ce],typeof we=="function")this.removeListener(ce,we);else if(we!==void 0)for($e=we.length-1;$e>=0;$e--)this.removeListener(ce,we[$e]);return this};function J(ie,ce,we){var xe=ie._events;if(xe===void 0)return[];var $e=xe[ce];return $e===void 0?[]:typeof $e=="function"?we?[$e.listener||$e]:[$e]:we?ne($e):H($e,$e.length)}y.prototype.listeners=function(ce){return J(this,ce,!0)},y.prototype.rawListeners=function(ce){return J(this,ce,!1)},y.listenerCount=function(ie,ce){return typeof ie.listenerCount=="function"?ie.listenerCount(ce):te.call(ie,ce)},y.prototype.listenerCount=te;function te(ie){var ce=this._events;if(ce!==void 0){var we=ce[ie];if(typeof we=="function")return 1;if(we!==void 0)return we.length}return 0}y.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]};function H(ie,ce){for(var we=new Array(ce),xe=0;xe<ce;++xe)we[xe]=ie[xe];return we}function j(ie,ce){for(;ce+1<ie.length;ce++)ie[ce]=ie[ce+1];ie.pop()}function ne(ie){for(var ce=new Array(ie.length),we=0;we<ce.length;++we)ce[we]=ie[we].listener||ie[we];return ce}function oe(ie,ce){return new Promise(function(we,xe){function $e(ae){ie.removeListener(ce,Ze),xe(ae)}function Ze(){typeof ie.removeListener=="function"&&ie.removeListener("error",$e),we([].slice.call(arguments))}se(ie,ce,Ze,{once:!0}),ce!=="error"&&pe(ie,$e,{once:!0})})}function pe(ie,ce,we){typeof ie.on=="function"&&se(ie,"error",ce,we)}function se(ie,ce,we,xe){if(typeof ie.on=="function")xe.once?ie.once(ce,we):ie.on(ce,we);else if(typeof ie.addEventListener=="function")ie.addEventListener(ce,function $e(Ze){xe.once&&ie.removeEventListener(ce,$e),we(Ze)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ie)}return Cv.exports}var Bb,nI;function XG(){return nI||(nI=1,Bb={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}),Bb}var Nb,rI;function YG(){if(rI)return Nb;rI=1;function n(u){var m=u.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return m?{key:m[1],value:m[2]}:null}function r(u){var m=u.match(/<?([^>]*)>(.*)/);if(!m)return null;var y=m[1],T=m[2].split(";"),i=null,I=T.reduce(function(F,B){var G=n(B);return G?G.key==="rel"?(i||(i=G.value),F):(F[G.key]=G.value,F):F},{});return i?{url:y,rel:i,params:I}:null}function s(u){return u?u.split(/,\s*</).reduce(function(m,y){var T=r(y);if(!T)return m;var i=T.rel.split(/\s+/);return i.forEach(function(I){m[I]||(m[I]={url:T.url,params:T.params})}),m},{}):{}}return Nb=s,Nb}var jb,iI;function KG(){if(iI)return jb;iI=1;var n=YG();function r(s,u){this.request=s,this.headers=u.headers,this.rawBody=u.body,this.statusCode=u.statusCode;try{this.body=JSON.parse(u.body||"{}")}catch{this.body=u.body}this.links=n(this.headers.link)}return r.prototype.hasNextPage=function(){return!!this.links.next},r.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null},jb=r,jb}var Ub,oI;function Ox(){return oI||(oI=1,Ub={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"}),Ub}var $b,sI;function JG(){if(sI)return $b;sI=1;var n=Ox();function r(s){var u=s.type||n.ERROR_HTTP,m;if(s.body)try{m=JSON.parse(s.body)}catch{m=s.body}else m=null;var y=s.message||null;y||(typeof m=="string"?y=m:m&&typeof m.message=="string"?y=m.message:u===n.ERROR_REQUEST_ABORTED&&(y="Request aborted")),this.message=y,this.type=u,this.statusCode=s.statusCode||null,this.request=s.request,this.body=m}return $b=r,$b}var Vb,aI;function QG(){if(aI)return Vb;aI=1;function n(s){var u=s.indexOf(":"),m=s.substring(0,u).trim().toLowerCase(),y=s.substring(u+1).trim();return{name:m,value:y}}function r(s){var u={};return s&&s.trim().split(/[\r|\n]+/).forEach(function(m){var y=n(m);u[y.name]=y.value}),u}return Vb=r,Vb}var Gb,lI;function eq(){if(lI)return Gb;lI=1;var n=KG(),r=JG(),s=Ox(),u=QG(),m={};function y(G){var J=m[G.id];J&&(J.abort(),delete m[G.id])}function T(G,J){return new n(G,{body:J.response,headers:u(J.getAllResponseHeaders()),statusCode:J.status})}function i(G){var J=G.total,te=G.loaded,H=100*te/J;return{total:J,transferred:te,percent:H}}function I(G,J){return new Promise(function(te,H){J.onprogress=function(oe){G.emitter.emit(s.EVENT_PROGRESS_DOWNLOAD,i(oe))};var j=G.file;j&&(J.upload.onprogress=function(oe){G.emitter.emit(s.EVENT_PROGRESS_UPLOAD,i(oe))}),J.onerror=function(oe){H(oe)},J.onabort=function(){var oe=new r({request:G,type:s.ERROR_REQUEST_ABORTED});H(oe)},J.onload=function(){if(delete m[G.id],J.status<200||J.status>=400){var oe=new r({request:G,body:J.response,statusCode:J.status});H(oe);return}te(J)};var ne=G.body;typeof ne=="string"?J.send(ne):ne?J.send(JSON.stringify(ne)):j?J.send(j):J.send(),m[G.id]=J}).then(function(te){return T(G,te)})}function F(G,J){var te=G.url(J),H=new window.XMLHttpRequest;return H.open(G.method,te),Object.keys(G.headers).forEach(function(j){H.setRequestHeader(j,G.headers[j])}),H}function B(G){return Promise.resolve().then(function(){var J=F(G,G.client.accessToken);return I(G,J)})}return Gb={browserAbort:y,sendRequestXhr:I,browserSend:B,createRequestXhr:F},Gb}var R_={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */var tq=R_.exports,cI;function nq(){return cI||(cI=1,function(n,r){(function(s){var u=r,m=n.exports==u&&n,y=typeof vp=="object"&&vp;(y.global===y||y.window===y)&&(s=y);var T=function(H){this.message=H};T.prototype=new Error,T.prototype.name="InvalidCharacterError";var i=function(H){throw new T(H)},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",F=/[\t\n\f\r ]/g,B=function(H){H=String(H).replace(F,"");var j=H.length;j%4==0&&(H=H.replace(/==?$/,""),j=H.length),(j%4==1||/[^+a-zA-Z0-9/]/.test(H))&&i("Invalid character: the string to be decoded is not correctly encoded.");for(var ne=0,oe,pe,se="",ie=-1;++ie<j;)pe=I.indexOf(H.charAt(ie)),oe=ne%4?oe*64+pe:pe,ne++%4&&(se+=String.fromCharCode(255&oe>>(-2*ne&6)));return se},G=function(H){H=String(H),/[^\0-\xFF]/.test(H)&&i("The string to be encoded contains characters outside of the Latin1 range.");for(var j=H.length%3,ne="",oe=-1,pe,se,ie,ce,we=H.length-j;++oe<we;)pe=H.charCodeAt(oe)<<16,se=H.charCodeAt(++oe)<<8,ie=H.charCodeAt(++oe),ce=pe+se+ie,ne+=I.charAt(ce>>18&63)+I.charAt(ce>>12&63)+I.charAt(ce>>6&63)+I.charAt(ce&63);return j==2?(pe=H.charCodeAt(oe)<<8,se=H.charCodeAt(++oe),ce=pe+se,ne+=I.charAt(ce>>10)+I.charAt(ce>>4&63)+I.charAt(ce<<2&63)+"="):j==1&&(ce=H.charCodeAt(oe),ne+=I.charAt(ce>>2)+I.charAt(ce<<4&63)+"=="),ne},J={encode:G,decode:B,version:"0.1.0"};if(u&&!u.nodeType)if(m)m.exports=J;else for(var te in J)J.hasOwnProperty(te)&&(u[te]=J[te]);else s.base64=J})(tq)}(R_,R_.exports)),R_.exports}var qb,uI;function uR(){if(uI)return qb;uI=1;var n=nq(),r={};function s(y){if(r[y])return r[y];var T=y.split("."),i=T[0],I=T[1];if(!I)throw new Error("Invalid token");var F=u(I),B={usage:i,user:F.u};return m(F,"a")&&(B.authorization=F.a),m(F,"exp")&&(B.expires=F.exp*1e3),m(F,"iat")&&(B.created=F.iat*1e3),m(F,"scopes")&&(B.scopes=F.scopes),m(F,"client")&&(B.client=F.client),m(F,"ll")&&(B.lastLogin=F.ll),m(F,"iu")&&(B.impersonator=F.iu),r[y]=B,B}function u(y){try{return JSON.parse(n.decode(y))}catch{throw new Error("Invalid token")}}function m(y,T){return Object.prototype.hasOwnProperty.call(y,T)}return qb=s,qb}var Wb={exports:{}},dI;function rq(){return dI||(dI=1,function(n){var r=Object.prototype.hasOwnProperty,s="~";function u(){}Object.create&&(u.prototype=Object.create(null),new u().__proto__||(s=!1));function m(I,F,B){this.fn=I,this.context=F,this.once=B||!1}function y(I,F,B,G,J){if(typeof B!="function")throw new TypeError("The listener must be a function");var te=new m(B,G||I,J),H=s?s+F:F;return I._events[H]?I._events[H].fn?I._events[H]=[I._events[H],te]:I._events[H].push(te):(I._events[H]=te,I._eventsCount++),I}function T(I,F){--I._eventsCount===0?I._events=new u:delete I._events[F]}function i(){this._events=new u,this._eventsCount=0}i.prototype.eventNames=function(){var F=[],B,G;if(this._eventsCount===0)return F;for(G in B=this._events)r.call(B,G)&&F.push(s?G.slice(1):G);return Object.getOwnPropertySymbols?F.concat(Object.getOwnPropertySymbols(B)):F},i.prototype.listeners=function(F){var B=s?s+F:F,G=this._events[B];if(!G)return[];if(G.fn)return[G.fn];for(var J=0,te=G.length,H=new Array(te);J<te;J++)H[J]=G[J].fn;return H},i.prototype.listenerCount=function(F){var B=s?s+F:F,G=this._events[B];return G?G.fn?1:G.length:0},i.prototype.emit=function(F,B,G,J,te,H){var j=s?s+F:F;if(!this._events[j])return!1;var ne=this._events[j],oe=arguments.length,pe,se;if(ne.fn){switch(ne.once&&this.removeListener(F,ne.fn,void 0,!0),oe){case 1:return ne.fn.call(ne.context),!0;case 2:return ne.fn.call(ne.context,B),!0;case 3:return ne.fn.call(ne.context,B,G),!0;case 4:return ne.fn.call(ne.context,B,G,J),!0;case 5:return ne.fn.call(ne.context,B,G,J,te),!0;case 6:return ne.fn.call(ne.context,B,G,J,te,H),!0}for(se=1,pe=new Array(oe-1);se<oe;se++)pe[se-1]=arguments[se];ne.fn.apply(ne.context,pe)}else{var ie=ne.length,ce;for(se=0;se<ie;se++)switch(ne[se].once&&this.removeListener(F,ne[se].fn,void 0,!0),oe){case 1:ne[se].fn.call(ne[se].context);break;case 2:ne[se].fn.call(ne[se].context,B);break;case 3:ne[se].fn.call(ne[se].context,B,G);break;case 4:ne[se].fn.call(ne[se].context,B,G,J);break;default:if(!pe)for(ce=1,pe=new Array(oe-1);ce<oe;ce++)pe[ce-1]=arguments[ce];ne[se].fn.apply(ne[se].context,pe)}}return!0},i.prototype.on=function(F,B,G){return y(this,F,B,G,!1)},i.prototype.once=function(F,B,G){return y(this,F,B,G,!0)},i.prototype.removeListener=function(F,B,G,J){var te=s?s+F:F;if(!this._events[te])return this;if(!B)return T(this,te),this;var H=this._events[te];if(H.fn)H.fn===B&&(!J||H.once)&&(!G||H.context===G)&&T(this,te);else{for(var j=0,ne=[],oe=H.length;j<oe;j++)(H[j].fn!==B||J&&!H[j].once||G&&H[j].context!==G)&&ne.push(H[j]);ne.length?this._events[te]=ne.length===1?ne[0]:ne:T(this,te)}return this},i.prototype.removeAllListeners=function(F){var B;return F?(B=s?s+F:F,this._events[B]&&T(this,B)):(this._events=new u,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=s,i.EventEmitter=i,n.exports=i}(Wb)),Wb.exports}var Hb,hI;function iq(){if(hI)return Hb;hI=1;function n(T){return T.map(encodeURIComponent).join(",")}function r(T){return Array.isArray(T)?n(T):encodeURIComponent(String(T))}function s(T,i,I){if(I===!1||I===null)return T;var F=/\?/.test(T)?"&":"?",B=encodeURIComponent(i);return I!==void 0&&I!==""&&I!==!0&&(B+="="+r(I)),""+T+F+B}function u(T,i){if(!i)return T;var I=T;return Object.keys(i).forEach(function(F){var B=i[F];B!==void 0&&(Array.isArray(B)&&(B=B.filter(function(G){return G!=null}).join(",")),I=s(I,F,B))}),I}function m(T,i){if(!i||T.slice(0,4)==="http")return T;var I=T[0]==="/"?"":"/";return""+i.replace(/\/$/,"")+I+T}function y(T,i){return i?T.replace(/\/:([a-zA-Z0-9]+)/g,function(I,F){var B=i[F];if(B===void 0)throw new Error("Unspecified route parameter "+F);var G=r(B);return"/"+G}):T}return Hb={appendQueryObject:u,appendQueryParam:s,prependOrigin:m,interpolateRouteParams:y},Hb}var Zb,pI;function oq(){if(pI)return Zb;pI=1;var n=uR(),r=mg(),s=rq(),u=iq(),m=Ox(),y=1;function T(i,I){if(!i)throw new Error("MapiRequest requires a client");if(!I||!I.path||!I.method)throw new Error("MapiRequest requires an options object with path and method properties");var F={};I.body&&(F["content-type"]="application/json");var B=r(F,I.headers),G=Object.keys(B).reduce(function(J,te){return J[te.toLowerCase()]=B[te],J},{});this.id=y++,this._options=I,this.emitter=new s,this.client=i,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=I.path,this.method=I.method,this.origin=I.origin||i.origin,this.query=I.query||{},this.params=I.params||{},this.body=I.body||null,this.file=I.file||null,this.encoding=I.encoding||"utf8",this.sendFileAs=I.sendFileAs||null,this.headers=G}return T.prototype.url=function(I){var F=u.prependOrigin(this.path,this.origin);F=u.appendQueryObject(F,this.query);var B=this.params,G=I??this.client.accessToken;if(G){F=u.appendQueryParam(F,"access_token",G);var J=n(G).user;B=r({ownerId:J},B)}return F=u.interpolateRouteParams(F,B),F},T.prototype.send=function(){var I=this;if(I.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return I.sent=!0,I.client.sendRequest(I).then(function(F){return I.response=F,I.emitter.emit(m.EVENT_RESPONSE,F),F},function(F){throw I.error=F,I.emitter.emit(m.EVENT_ERROR,F),F})},T.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))},T.prototype.eachPage=function(I){var F=this;function B(te){function H(){delete F._nextPageRequest;var j=te.nextPage();j&&(F._nextPageRequest=j,J(j))}I(null,te,H)}function G(te){I(te,null,function(){})}function J(te){te.send().then(B,G)}J(this)},T.prototype.clone=function(){return this._extend()},T.prototype._extend=function(I){var F=r(this._options,I);return new T(this.client,F)},Zb=T,Zb}var Xb,fI;function dR(){if(fI)return Xb;fI=1;var n=uR(),r=oq(),s=Ox();function u(m){if(!m||!m.accessToken)throw new Error("Cannot create a client without an access token");n(m.accessToken),this.accessToken=m.accessToken,this.origin=m.origin||s.API_ORIGIN}return u.prototype.createRequest=function(y){return new r(this,y)},Xb=u,Xb}var Yb,mI;function hR(){if(mI)return Yb;mI=1;var n=eq(),r=dR();function s(m){r.call(this,m)}s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.sendRequest=n.browserSend,s.prototype.abortRequest=n.browserAbort;function u(m){return new s(m)}return Yb=u,Yb}var Kb,gI;function sq(){if(gI)return Kb;gI=1;var n=hR();return Kb=n,Kb}var Jb,_I;function aq(){if(_I)return Jb;_I=1;var n=Object.prototype.toString;return Jb=function(r){var s;return n.call(r)==="[object Object]"&&(s=Object.getPrototypeOf(r),s===null||s===Object.getPrototypeOf({}))},Jb}var Qb,yI;function lq(){if(yI)return Qb;yI=1;var n=aq(),r=mg(),s="value",u=`
  `,m={};m.assert=function(H,j){return j=j||{},function(ne){var oe=T(H,ne);if(oe){var pe=i(oe,j);throw j.apiName&&(pe=j.apiName+": "+pe),new Error(pe)}}},m.shape=function(j){var ne=te(j);return function(pe){var se=T(m.plainObject,pe);if(se)return se;for(var ie,ce,we=[],xe=0;xe<ne.length;xe++)ie=ne[xe].key,ce=ne[xe].value,se=T(ce,pe[ie]),se&&we.push([ie].concat(se));return we.length<2?we[0]:function($e){we=we.map(function(ke){var ct=ke[0],Xe=i(ke,$e).split(`
`).join(u);return"- "+ct+": "+Xe});var Ze=$e.path.join("."),ae=Ze===s?"":" of "+Ze;return"The following properties"+ae+" have invalid values:"+u+we.join(u)}}},m.strictShape=function(j){var ne=m.shape(j);return function(pe){var se=ne(pe);if(se)return se;var ie=Object.keys(pe).reduce(function(ce,we){return j[we]===void 0&&ce.push(we),ce},[]);if(ie.length!==0)return function(){return"The following keys are invalid: "+ie.join(", ")}}},m.arrayOf=function(j){return y(j)},m.tuple=function(){var j=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return y(j)};function y(H){var j=Array.isArray(H),ne=function(oe){return j?H[oe]:H};return function(pe){var se=T(m.plainArray,pe);if(se)return se;if(j&&pe.length!==H.length)return"an array with "+H.length+" items";for(var ie=0;ie<pe.length;ie++)if(se=T(ne(ie),pe[ie]),se)return[ie].concat(se)}}m.required=function(j){function ne(oe){return oe==null?function(pe){return G(pe,J(pe.path)?"cannot be undefined/null.":"is required.")}:j.apply(this,arguments)}return ne.__required=!0,ne},m.oneOfType=function(){var j=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(oe){var pe=j.map(function(se){return T(se,oe)}).filter(Boolean);if(pe.length===j.length)return pe.every(function(se){return se.length===1&&typeof se[0]=="string"})?I(pe.map(function(se){return se[0]})):pe.reduce(function(se,ie){return ie.length>se.length?ie:se})}},m.equal=function(j){return function(oe){if(oe!==j)return JSON.stringify(j)}},m.oneOf=function(){var j=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),ne=j.map(function(oe){return m.equal(oe)});return m.oneOfType.apply(this,ne)},m.range=function(j){var ne=j[0],oe=j[1];return function(se){var ie=T(m.number,se);if(ie||se<ne||se>oe)return"number between "+ne+" & "+oe+" (inclusive)"}},m.any=function(){},m.boolean=function(j){if(typeof j!="boolean")return"boolean"},m.number=function(j){if(typeof j!="number")return"number"},m.plainArray=function(j){if(!Array.isArray(j))return"array"},m.plainObject=function(j){if(!n(j))return"object"},m.string=function(j){if(typeof j!="string")return"string"},m.func=function(j){if(typeof j!="function")return"function"};function T(H,j){if(!(j==null&&!H.hasOwnProperty("__required"))){var ne=H(j);if(ne)return Array.isArray(ne)?ne:[ne]}}function i(H,j){var ne=H.length,oe=H[ne-1],pe=H.slice(0,ne-1);return pe.length===0&&(pe=[s]),j=r(j,{path:pe}),typeof oe=="function"?oe(j):G(j,F(oe))}function I(H){return H.length<2?H[0]:H.length===2?H.join(" or "):H.slice(0,-1).join(", ")+", or "+H.slice(-1)}function F(H){return"must be "+B(H)+"."}function B(H){return/^an? /.test(H)?H:/^[aeiou]/i.test(H)?"an "+H:/^[a-z]/i.test(H)?"a "+H:H}function G(H,j){var ne=J(H.path),oe=H.path.join(".")+" "+j,pe=ne?"Item at position ":"";return pe+oe}function J(H){return typeof H[H.length-1]=="number"||typeof H[0]=="number"}function te(H){return Object.keys(H||{}).map(function(j){return{key:j,value:H[j]}})}return m.validate=T,m.processMessage=i,Qb=m,Qb}var e1,vI;function cq(){if(vI)return e1;vI=1;var n=mg(),r=lq();function s(T){if(typeof window<"u")return T instanceof vp.Blob||T instanceof vp.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof T=="string"||T.pipe!==void 0))return"Filename or Readable stream"}function u(T,i){return r.assert(r.strictShape(T),i)}function m(T){var i="date";if(typeof T=="boolean")return i;try{var I=new Date(T);if(I.getTime&&isNaN(I.getTime()))return i}catch{return i}}function y(T){return r.tuple(r.number,r.number)(T)}return e1=n(r,{file:s,date:m,coordinates:y,assertShape:u}),e1}var t1,xI;function uq(){if(xI)return t1;xI=1;function n(r,s){var u=function(m,y){return s.indexOf(m)!==-1&&y!==void 0};return typeof s=="function"&&(u=s),Object.keys(r).filter(function(m){return u(m,r[m])}).reduce(function(m,y){return m[y]=r[y],m},{})}return t1=n,t1}var n1,bI;function dq(){if(bI)return n1;bI=1;function n(r,s){return Object.keys(r).reduce(function(u,m){return u[m]=s(m,r[m]),u},{})}return n1=n,n1}var r1,wI;function hq(){if(wI)return r1;wI=1;var n=dq();function r(s){return n(s,function(u,m){return typeof m=="boolean"?JSON.stringify(m):m})}return r1=r,r1}var i1,SI;function pq(){if(SI)return i1;SI=1;var n=dR(),r=hR();function s(u){return function(m){var y;n.prototype.isPrototypeOf(m)?y=m:y=r(m);var T=Object.create(u);return T.client=y,T}}return i1=s,i1}var o1,TI;function fq(){if(TI)return o1;TI=1;var n=mg(),r=cq(),s=uq(),u=hq(),m=pq(),y={},T=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];return y.forwardGeocode=function(i){r.assertShape({query:r.required(r.string),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),proximity:r.oneOf(r.coordinates,"ip"),types:r.arrayOf(r.oneOf(T)),autocomplete:r.boolean,bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),routing:r.boolean,fuzzyMatch:r.boolean,worldview:r.string,session_token:r.string})(i),i.mode=i.mode||"mapbox.places";var I=u(n({country:i.countries},s(i,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:s(i,["mode","query"]),query:I})},y.reverseGeocode=function(i){r.assertShape({query:r.required(r.coordinates),mode:r.oneOf("mapbox.places","mapbox.places-permanent"),countries:r.arrayOf(r.string),types:r.arrayOf(r.oneOf(T)),bbox:r.arrayOf(r.number),limit:r.number,language:r.arrayOf(r.string),reverseMode:r.oneOf("distance","score"),routing:r.boolean,worldview:r.string,session_token:r.string})(i),i.mode=i.mode||"mapbox.places";var I=u(n({country:i.countries},s(i,["country","types","bbox","limit","language","reverseMode","routing","worldview","session_token"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:s(i,["mode","query"]),query:I})},o1=m(y),o1}let mq="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",pR=n=>crypto.getRandomValues(new Uint8Array(n)),fR=(n,r,s)=>{let u=(2<<Math.log(n.length-1)/Math.LN2)-1,m=-~(1.6*u*r/n.length);return(y=r)=>{let T="";for(;;){let i=s(m),I=m|0;for(;I--;)if(T+=n[i[I]&u]||"",T.length===y)return T}}},gq=(n,r=21)=>fR(n,r,pR),_q=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((r,s)=>(s&=63,s<36?r+=s.toString(36):s<62?r+=(s-26).toString(36).toUpperCase():s>62?r+="-":r+="_",r),"");const yq=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:gq,customRandom:fR,nanoid:_q,random:pR,urlAlphabet:mq},Symbol.toStringTag,{value:"Module"})),vq=iA(yq);var s1,EI;function xq(){if(EI)return s1;EI=1;var n=vq.nanoid;function r(s){this.origin=s.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=s.accessToken,this.version="0.3.0",this.pluginSessionID=this.generateSessionID(),this.sessionIncrementer=0,this.userAgent=this.getUserAgent(),this.options=s,this.send=this.send.bind(this),this.countries=s.countries?s.countries.split(","):null,this.types=s.types?s.types.split(","):null,this.bbox=s.bbox?s.bbox:null,this.language=s.language?s.language.split(","):null,this.limit=s.limit?+s.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(s),this.eventQueue=new Array,this.flushInterval=s.flushInterval||1e3,this.maxQueueSize=s.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}return r.prototype={select:function(s,u){var m=this.getEventPayload("search.select",u,{selectedFeature:s});if(m&&!(m.resultIndex===this.lastSentIndex&&m.queryString===this.lastSentInput||m.resultIndex==-1))return this.lastSentIndex=m.resultIndex,this.lastSentInput=m.queryString,this.push(m)},start:function(s){var u=this.getEventPayload("search.start",s);if(u)return this.push(u)},keyevent:function(s,u){if(s.key&&!(s.metaKey||[9,27,37,39,13,38,40].indexOf(s.keyCode)!==-1)){var m=this.getEventPayload("search.keystroke",u,{key:s.key});if(m)return this.push(m)}},send:function(s,u){if(!this.enableEventLogging)return u?u():void 0;var m=this.getRequestOptions(s);this.request(m,(function(y){if(y)return this.handleError(y,u);if(u)return u()}).bind(this))},getRequestOptions:function(s){Array.isArray(s)||(s=[s]);var u={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};return u},getEventPayload:function(s,u,m={}){if(s==="search.select"&&!m.selectedFeature||s==="search.keystroke"&&!m.key)return null;var y;if(!u.options.proximity)y=null;else if(typeof u.options.proximity=="object")y=[u.options.proximity.longitude,u.options.proximity.latitude];else if(u.options.proximity==="ip"){var T=u._headers?u._headers["ip-proximity"]:null;T&&typeof T=="string"?y=T.split(",").map(parseFloat):y=[999,999]}else y=u.options.proximity;var i=u._map?u._map.getZoom():void 0,I={event:s,version:this.getEventSchemaVersion(s),created:+new Date,sessionIdentifier:this.getSessionId(),country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:u.options.autocomplete,fuzzyMatch:u.options.fuzzyMatch,proximity:y,limit:u.options.limit,routing:u.options.routing,worldview:u.options.worldview,mapZoom:i,keyboardLocale:this.locale};if(s==="search.select"?I.queryString=u.inputString:s!="search.select"&&u._inputEl?I.queryString=u._inputEl.value:I.queryString=u.inputString,["search.keystroke","search.select"].includes(s)&&(I.path="geocoding/v5/mapbox.places"),s==="search.keystroke"&&m.key)I.lastAction=m.key;else if(s==="search.select"&&m.selectedFeature){var F=m.selectedFeature,B=this.getSelectedIndex(F,u);if(I.resultIndex=B,I.resultPlaceName=F.place_name,I.resultId=F.id,F.properties&&(I.resultMapboxId=F.properties.mapbox_id),u._typeahead){var G=u._typeahead.data;G&&G.length>0&&(I.suggestionIds=this.getSuggestionIds(G),I.suggestionNames=this.getSuggestionNames(G),I.suggestionTypes=this.getSuggestionTypes(G),I.suggestionSources=this.getSuggestionSources(G))}}return this.validatePayload(I)?I:null},request:function(s,u){var m=new XMLHttpRequest;m.onreadystatechange=function(){if(this.readyState==4)return this.status==204?u(null):u(this.statusText)},m.open(s.method,s.host+"/"+s.path,!0);for(var y in s.headers){var T=s.headers[y];m.setRequestHeader(y,T)}m.send(s.body)},handleError:function(s,u){if(u)return u(s)},generateSessionID:function(){return n()},getSessionId:function(){return this.pluginSessionID+"."+this.sessionIncrementer},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(s,u){if(u._typeahead){var m=u._typeahead.data,y=s.id,T=m.map(function(I){return I.id}),i=T.indexOf(y);return i}},getSuggestionIds:function(s){return s.map(function(u){return u.properties?u.properties.mapbox_id||"":u.id||""})},getSuggestionNames:function(s){return s.map(function(u){return u.place_name||""})},getSuggestionTypes:function(s){return s.map(function(u){return u.place_type&&Array.isArray(u.place_type)&&u.place_type[0]||""})},getSuggestionSources:function(s){return s.map(function(u){return u._source||""})},getEventSchemaVersion:function(s){return["search.keystroke","search.select"].includes(s)?"2.2":"2.0"},validatePayload:function(s){if(!s||!s.event)return!1;var u=["event","created","sessionIdentifier","queryString"],m=["event","created","sessionIdentifier","queryString","lastAction"],y=["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"],T=s.event;return T==="search.start"?this.objectHasRequiredProps(s,u):T==="search.keystroke"?this.objectHasRequiredProps(s,m):T==="search.select"?this.objectHasRequiredProps(s,y):!0},objectHasRequiredProps:function(s,u){return u.every(function(m){return m==="queryString"?typeof s[m]=="string"&&s[m].length>0:s[m]!==void 0})},shouldEnableLogging:function(s){return!(s.enableEventLogging===!1||s.origin&&s.origin!=="https://api.mapbox.com")},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(s,u){this.eventQueue.push(s),(this.eventQueue.length>=this.maxQueueSize||u)&&this.flush()},remove:function(){this.flush()}},s1=r,s1}var a1,CI;function bq(){if(CI)return a1;CI=1;var n={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""};return a1={placeholder:n},a1}var Bv={exports:{}},wq=Bv.exports,MI;function Sq(){return MI||(MI=1,function(n){(function(r,s,u){n.exports?n.exports=u():r[s]=u()})(wq,"subtag",function(){var r="",s=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function u(I){return I.match(s)||[]}function m(I){return u(I).filter(function(F,B){return F&&B})}function y(I){return I=u(I),{language:I[1]||r,extlang:I[2]||r,script:I[3]||r,region:I[4]||r}}function T(I,F,B){Object.defineProperty(I,F,{value:B,enumerable:!0})}function i(I,F,B){function G(J){return u(J)[I]||r}T(G,"pattern",F),T(y,B,G)}return i(1,/^[a-zA-Z]{2,3}$/,"language"),i(2,/^[a-zA-Z]{3}$/,"extlang"),i(3,/^[a-zA-Z]{4}$/,"script"),i(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),T(y,"split",m),y})}(Bv)),Bv.exports}var l1,II;function Tq(){if(II)return l1;II=1;function n(){}return n.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const r={enableHighAccuracy:!0};return new Promise(function(s,u){window.navigator.geolocation.getCurrentPosition(s,u,r)})}},l1=n,l1}var c1,AI;function Eq(){if(AI)return c1;AI=1;function n(u,m){const y=r(u),T=["address","street","place","country"];var i;if(typeof m=="function")return m(y);const I=T.indexOf(m);return I===-1?i=T:i=T.slice(I),i.reduce(function(F,B){return y[B]?(F!==""&&(F=F+", "),F+y[B]):F},"")}function r(u){const m=u.address||"",y=u.text||"",T=u.place_name||"",I={address:T.split(",")[0],houseNumber:m,street:y,placeName:T};return u.context.forEach(function(F){const B=F.id.split(".")[0];I[B]=F.text}),I}return c1={transformFeatureToGeolocationText:n,getAddressInfo:r,REVERSE_GEOCODE_COORD_RGX:/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/},c1}var u1,PI;function Cq(){if(PI)return u1;PI=1;var n=WG(),r=HG(),s=mg(),u=ZG().EventEmitter,m=XG(),y=sq(),T=fq(),i=xq(),I=bq(),F=Sq(),B=Tq(),G=Eq();const J={FORWARD:0,LOCAL:1,REVERSE:2};function te(){var j=document.createElement("div");return j.className="mapboxgl-ctrl-geocoder--powered-by",j.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',j}function H(j){this._eventEmitter=new u,this.options=s({},this.options,j),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new B}return H.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(j){return j.place_name},render:function(j){var ne=j.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+ne[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+ne.splice(1,ne.length).join(",")+"</div></div>"}},_headers:{},addTo:function(j){function ne(oe,pe){if(!document.body.contains(pe))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const se=oe.onAdd();pe.appendChild(se)}if(j._controlContainer)j.addControl(this);else if(j instanceof HTMLElement)ne(this,j);else if(typeof j=="string"){const oe=document.querySelectorAll(j);if(oe.length===0)throw new Error("Element ",j,"not found.");if(oe.length>1)throw new Error("Geocoder can only be added to a single html element");ne(this,oe[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(j){if(j&&typeof j!="string"&&(this._map=j),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=T(y({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new i(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var ne=this.container=document.createElement("div");ne.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var oe=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",r(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function($e){this.eventManager.keyevent($e,this)}).bind(this));var pe=document.createElement("div");pe.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var se=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(se),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),pe.appendChild(this._clearEl),pe.appendChild(this._loadingEl),ne.appendChild(oe),ne.appendChild(this._inputEl),ne.appendChild(pe),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var ie=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(ie),pe.appendChild(this._geolocateEl),this._showGeolocateButton()}var ce=this._typeahead=new n(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),ce.getItemValue=this.options.getItemValue;var we=ce.list.draw,xe=this._footerNode=te();return ce.list.draw=function(){we.call(this),xe.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),xe.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(xe)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),ne},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(j){this._hideLoadingIcon();const ne={geometry:{type:"Point",coordinates:[j.coords.longitude,j.coords.latitude]}};this._handleMarker(ne),this._fly(ne),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(ne),this._showClearButton(),this.fresh=!1;const oe={limit:1,language:[this.options.language],query:ne.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const pe=ne.geometry.coordinates[0]+","+ne.geometry.coordinates[1];this._setInputValue(pe),this._eventEmitter.emit("result",{result:ne})}else this.geocoderService.reverseGeocode(oe).send().then((function(pe){const se=pe.body.features[0];if(se){const ie=G.transformFeatureToGeolocationText(se,this.options.addressAccuracy);this._setInputValue(ie),se.user_coordinates=ne.geometry.coordinates,this._eventEmitter.emit("result",{result:se})}else this._eventEmitter.emit("result",{result:{user_coordinates:ne.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(j){j.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(j,ne){var oe=document.createElementNS("http://www.w3.org/2000/svg","svg");return oe.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+j),oe.setAttribute("viewBox","0 0 18 18"),oe.setAttribute("xml:space","preserve"),oe.setAttribute("width",18),oe.setAttribute("height",18),oe.innerHTML=ne,oe},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(j){this._inputEl.value=j,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(j){var ne=(j.clipboardData||window.clipboardData).getData("text");ne.length>=this.options.minLength&&this._geocode(ne)},_onKeyDown:function(j){var ne=27,oe=9;if(j.keyCode===ne&&this.options.clearAndBlurOnEsc)return this._clear(j),this._inputEl.blur();var pe=j.target&&j.target.shadowRoot?j.target.shadowRoot.activeElement:j.target,se=pe?pe.value:"";if(!se)return this.fresh=!0,j.keyCode!==oe&&this.clear(j),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(j.metaKey||[oe,ne,37,39,13,38,40].indexOf(j.keyCode)!==-1)&&pe.value.length>=this.options.minLength&&this._geocode(pe.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(j){this.options.clearOnBlur&&this._clearOnBlur(j),this.options.collapsed&&this._collapse()},_onChange:function(){var j=this._typeahead.selected;j&&JSON.stringify(j)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(j),this.options.marker&&this._mapboxgl&&this._handleMarker(j),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(j),this._eventEmitter.emit("result",{result:j}),this.eventManager.select(j,this))},_fly:function(j){var ne;if(j.properties&&m[j.properties.short_code])ne=s({},this.options.flyTo),this._map&&this._map.fitBounds(m[j.properties.short_code].bbox,ne);else if(j.bbox){var oe=j.bbox;ne=s({},this.options.flyTo),this._map&&this._map.fitBounds([[oe[0],oe[1]],[oe[2],oe[3]]],ne)}else{var pe={zoom:this.options.zoom};ne=s({},pe,this.options.flyTo),j.center?ne.center=j.center:j.geometry&&j.geometry.type&&j.geometry.type==="Point"&&j.geometry.coordinates&&(ne.center=j.geometry.coordinates),this._map&&this._map.flyTo(ne)}},_requestType:function(j,ne){var oe;return j.localGeocoderOnly?oe=J.LOCAL:j.reverseGeocode&&G.REVERSE_GEOCODE_COORD_RGX.test(ne)?oe=J.REVERSE:oe=J.FORWARD,oe},_setupConfig:function(j,ne){const oe=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],pe=/[\s,]+/;var se=this,ie=oe.reduce(function(we,xe){if(se.options[xe]===void 0||se.options[xe]===null)return we;["countries","types","language"].indexOf(xe)>-1?we[xe]=se.options[xe].split(pe):we[xe]=se.options[xe];const $e=typeof se.options[xe].longitude=="number"&&typeof se.options[xe].latitude=="number";if(xe==="proximity"&&$e){const Ze=se.options[xe].longitude,ae=se.options[xe].latitude;we[xe]=[Ze,ae]}return we},{});switch(j){case J.REVERSE:{var ce=ne.split(pe).map(function(we){return parseFloat(we,10)});se.options.flipCoordinates||ce.reverse(),ie.types&&ie.types[0],ie=s(ie,{query:ce,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(we){we in ie&&delete ie[we]})}break;case J.FORWARD:{const we=ne.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(we)&&(ne=ne.replace(/,/g," ")),ie=s(ie,{query:ne})}break}return ie.session_token=this.eventManager.getSessionId(),ie},_geocode:function(j){this.inputString=j,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:j});const ne=this._requestType(this.options,j),oe=this._setupConfig(ne,j);var pe;switch(ne){case J.LOCAL:pe=Promise.resolve();break;case J.FORWARD:pe=this.geocoderService.forwardGeocode(oe).send();break;case J.REVERSE:pe=this.geocoderService.reverseGeocode(oe).send();break}var se=this.options.localGeocoder?this.options.localGeocoder(j)||[]:[],ie=[],ce=null;return pe.catch((function(we){ce=we}).bind(this)).then((function(we){this._hideLoadingIcon();var xe={};return we?we.statusCode=="200"&&(xe=we.body,xe.request=we.request,xe.headers=we.headers,this._headers=we.headers):xe={type:"FeatureCollection",features:[]},xe.config=oe,this.fresh&&(this.eventManager.start(this),this.fresh=!1),xe.features&&xe.features.length&&xe.features.map(function($e){$e._source="mapbox"}),xe.features=xe.features?se.concat(xe.features):se,this.options.externalGeocoder?(ie=this.options.externalGeocoder(j,xe.features)||Promise.resolve([]),ie.then(function($e){return xe.features=xe.features?$e.concat(xe.features):$e,xe},function(){return xe})):xe}).bind(this)).then((function(we){if(ce)throw ce;this.options.filter&&we.features.length&&(we.features=we.features.filter(this.options.filter)),we.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",we),this._typeahead.update(we.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",we))}).bind(this)).catch((function(we){this._hideLoadingIcon(),this._hideAttribution(),se.length&&this.options.localGeocoder||ie.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(se)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:se}),this._eventEmitter.emit("error",{error:we})}).bind(this)),pe},_clear:function(j){j&&j.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this.eventManager.sessionIncrementer++,this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(j){this._clear(j),this._inputEl.focus()},_clearOnBlur:function(j){var ne=this;j.relatedTarget&&ne._clear(j)},_onQueryResult:function(j){var ne=j.body;if(ne.features.length){var oe=ne.features[0];this._typeahead.selected=oe,this._inputEl.value=oe.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var j=this._map.getCenter().wrap();this.setProximity({longitude:j.lng,latitude:j.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(j){return this._geocode(j).then(this._onQueryResult),this},_renderError:function(){var j="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(j)},_renderLocationError:function(){var j="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(j)},_renderNoResults:function(){var j="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(j)},_renderUserDeniedGeolocationError:function(){var j="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(j)},_renderMessage:function(j){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(j)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var j=this.options.language.split(",")[0],ne=F.language(j),oe=I.placeholder[ne];if(oe)return oe}return"Search"},setInput:function(j,ne){return ne===void 0&&(ne=!1),this._inputEl.value=j,this._typeahead.selected=null,this._typeahead.clear(),j.length>=this.options.minLength&&(ne?this._geocode(j):this._onChange()),this},setProximity:function(j,ne=!0){return this.options.proximity=j,ne&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(j){return j&&typeof j=="function"&&(this._typeahead.render=j),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(j){var ne=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=j||this.options.language||ne,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(j){return this.options.zoom=j,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(j){return this.options.flyTo=j,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(j){return this.options.placeholder=j||this._getPlaceholderText(),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(j){return this.options.bbox=j,this},getCountries:function(){return this.options.countries},setCountries:function(j){return this.options.countries=j,this},getTypes:function(){return this.options.types},setTypes:function(j){return this.options.types=j,this},getMinLength:function(){return this.options.minLength},setMinLength:function(j){return this.options.minLength=j,this._typeahead&&(this._typeahead.options.minLength=j),this},getLimit:function(){return this.options.limit},setLimit:function(j){return this.options.limit=j,this._typeahead&&(this._typeahead.options.limit=j),this},getFilter:function(){return this.options.filter},setFilter:function(j){return this.options.filter=j,this},setOrigin:function(j){return this.options.origin=j,this.geocoderService=T(y({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(j){return this.options.accessToken=j,this.geocoderService=T(y({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(j){return this.options.autocomplete=j,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(j){return this.options.fuzzyMatch=j,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(j){return this.options.routing=j,this},getRouting:function(){return this.options.routing},setWorldview:function(j){return this.options.worldview=j,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(j){if(this._map){this._removeMarker();var ne={color:"#4668F2"},oe=s({},ne,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(oe),j.center?this.mapMarker.setLngLat(j.center).addTo(this._map):j.geometry&&j.geometry.type&&j.geometry.type==="Point"&&j.geometry.coordinates&&this.mapMarker.setLngLat(j.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(j,ne){return this._eventEmitter.on(j,ne),this},off:function(j,ne){return this._eventEmitter.removeListener(j,ne),this.eventManager.remove(),this}},u1=H,u1}var Mq=Cq();const mR=Uf(Mq);new mR({marker:!1,accessToken:"pk.eyJ1IjoiemFja292ZXJsb2FkIiwiYSI6ImNtNmdqdDBqajAxcXcya3NhcHR1emg3cWkifQ.8XjrjoDMu-4xhqCXir6-_Q"});function RI(n){return n!==null&&typeof n=="object"&&"constructor"in n&&n.constructor===Object}function oS(n,r){n===void 0&&(n={}),r===void 0&&(r={});const s=["__proto__","constructor","prototype"];Object.keys(r).filter(u=>s.indexOf(u)<0).forEach(u=>{typeof n[u]>"u"?n[u]=r[u]:RI(r[u])&&RI(n[u])&&Object.keys(r[u]).length>0&&oS(n[u],r[u])})}const gR={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function mu(){const n=typeof document<"u"?document:{};return oS(n,gR),n}const Iq={document:gR,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(n){return typeof setTimeout>"u"?(n(),null):setTimeout(n,0)},cancelAnimationFrame(n){typeof setTimeout>"u"||clearTimeout(n)}};function na(){const n=typeof window<"u"?window:{};return oS(n,Iq),n}function Aq(n){return n===void 0&&(n=""),n.trim().split(" ").filter(r=>!!r.trim())}function Pq(n){const r=n;Object.keys(r).forEach(s=>{try{r[s]=null}catch{}try{delete r[s]}catch{}})}function ew(n,r){return r===void 0&&(r=0),setTimeout(n,r)}function ex(){return Date.now()}function Rq(n){const r=na();let s;return r.getComputedStyle&&(s=r.getComputedStyle(n,null)),!s&&n.currentStyle&&(s=n.currentStyle),s||(s=n.style),s}function tw(n,r){r===void 0&&(r="x");const s=na();let u,m,y;const T=Rq(n);return s.WebKitCSSMatrix?(m=T.transform||T.webkitTransform,m.split(",").length>6&&(m=m.split(", ").map(i=>i.replace(",",".")).join(", ")),y=new s.WebKitCSSMatrix(m==="none"?"":m)):(y=T.MozTransform||T.OTransform||T.MsTransform||T.msTransform||T.transform||T.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),u=y.toString().split(",")),r==="x"&&(s.WebKitCSSMatrix?m=y.m41:u.length===16?m=parseFloat(u[12]):m=parseFloat(u[4])),r==="y"&&(s.WebKitCSSMatrix?m=y.m42:u.length===16?m=parseFloat(u[13]):m=parseFloat(u[5])),m||0}function Mv(n){return typeof n=="object"&&n!==null&&n.constructor&&Object.prototype.toString.call(n).slice(8,-1)==="Object"}function kq(n){return typeof window<"u"&&typeof window.HTMLElement<"u"?n instanceof HTMLElement:n&&(n.nodeType===1||n.nodeType===11)}function Ol(){const n=Object(arguments.length<=0?void 0:arguments[0]),r=["__proto__","constructor","prototype"];for(let s=1;s<arguments.length;s+=1){const u=s<0||arguments.length<=s?void 0:arguments[s];if(u!=null&&!kq(u)){const m=Object.keys(Object(u)).filter(y=>r.indexOf(y)<0);for(let y=0,T=m.length;y<T;y+=1){const i=m[y],I=Object.getOwnPropertyDescriptor(u,i);I!==void 0&&I.enumerable&&(Mv(n[i])&&Mv(u[i])?u[i].__swiper__?n[i]=u[i]:Ol(n[i],u[i]):!Mv(n[i])&&Mv(u[i])?(n[i]={},u[i].__swiper__?n[i]=u[i]:Ol(n[i],u[i])):n[i]=u[i])}}}return n}function Iv(n,r,s){n.style.setProperty(r,s)}function _R(n){let{swiper:r,targetPosition:s,side:u}=n;const m=na(),y=-r.translate;let T=null,i;const I=r.params.speed;r.wrapperEl.style.scrollSnapType="none",m.cancelAnimationFrame(r.cssModeFrameID);const F=s>y?"next":"prev",B=(J,te)=>F==="next"&&J>=te||F==="prev"&&J<=te,G=()=>{i=new Date().getTime(),T===null&&(T=i);const J=Math.max(Math.min((i-T)/I,1),0),te=.5-Math.cos(J*Math.PI)/2;let H=y+te*(s-y);if(B(H,s)&&(H=s),r.wrapperEl.scrollTo({[u]:H}),B(H,s)){r.wrapperEl.style.overflow="hidden",r.wrapperEl.style.scrollSnapType="",setTimeout(()=>{r.wrapperEl.style.overflow="",r.wrapperEl.scrollTo({[u]:H})}),m.cancelAnimationFrame(r.cssModeFrameID);return}r.cssModeFrameID=m.requestAnimationFrame(G)};G()}function sS(n){return n.querySelector(".swiper-slide-transform")||n.shadowRoot&&n.shadowRoot.querySelector(".swiper-slide-transform")||n}function wc(n,r){r===void 0&&(r="");const s=na(),u=[...n.children];return s.HTMLSlotElement&&n instanceof HTMLSlotElement&&u.push(...n.assignedElements()),r?u.filter(m=>m.matches(r)):u}function Lq(n,r){const s=[r];for(;s.length>0;){const u=s.shift();if(n===u)return!0;s.push(...u.children,...u.shadowRoot?u.shadowRoot.children:[],...u.assignedElements?u.assignedElements():[])}}function zq(n,r){const s=na();let u=r.contains(n);return!u&&s.HTMLSlotElement&&r instanceof HTMLSlotElement&&(u=[...r.assignedElements()].includes(n),u||(u=Lq(n,r))),u}function tx(n){try{console.warn(n);return}catch{}}function J_(n,r){r===void 0&&(r=[]);const s=document.createElement(n);return s.classList.add(...Array.isArray(r)?r:Aq(r)),s}function kI(n){const r=na(),s=mu(),u=n.getBoundingClientRect(),m=s.body,y=n.clientTop||m.clientTop||0,T=n.clientLeft||m.clientLeft||0,i=n===r?r.scrollY:n.scrollTop,I=n===r?r.scrollX:n.scrollLeft;return{top:u.top+i-y,left:u.left+I-T}}function Dq(n,r){const s=[];for(;n.previousElementSibling;){const u=n.previousElementSibling;r?u.matches(r)&&s.push(u):s.push(u),n=u}return s}function Oq(n,r){const s=[];for(;n.nextElementSibling;){const u=n.nextElementSibling;r?u.matches(r)&&s.push(u):s.push(u),n=u}return s}function bp(n,r){return na().getComputedStyle(n,null).getPropertyValue(r)}function nx(n){let r=n,s;if(r){for(s=0;(r=r.previousSibling)!==null;)r.nodeType===1&&(s+=1);return s}}function j_(n,r){const s=[];let u=n.parentElement;for(;u;)r?u.matches(r)&&s.push(u):s.push(u),u=u.parentElement;return s}function nw(n,r,s){const u=na();return n[r==="width"?"offsetWidth":"offsetHeight"]+parseFloat(u.getComputedStyle(n,null).getPropertyValue(r==="width"?"margin-right":"margin-top"))+parseFloat(u.getComputedStyle(n,null).getPropertyValue(r==="width"?"margin-left":"margin-bottom"))}function Rs(n){return(Array.isArray(n)?n:[n]).filter(r=>!!r)}function Fq(n){return r=>Math.abs(r)>0&&n.browser&&n.browser.need3dFix&&Math.abs(r)%90===0?r+.001:r}let d1;function Bq(){const n=na(),r=mu();return{smoothScroll:r.documentElement&&r.documentElement.style&&"scrollBehavior"in r.documentElement.style,touch:!!("ontouchstart"in n||n.DocumentTouch&&r instanceof n.DocumentTouch)}}function yR(){return d1||(d1=Bq()),d1}let h1;function Nq(n){let{userAgent:r}=n===void 0?{}:n;const s=yR(),u=na(),m=u.navigator.platform,y=r||u.navigator.userAgent,T={ios:!1,android:!1},i=u.screen.width,I=u.screen.height,F=y.match(/(Android);?[\s\/]+([\d.]+)?/);let B=y.match(/(iPad).*OS\s([\d_]+)/);const G=y.match(/(iPod)(.*OS\s([\d_]+))?/),J=!B&&y.match(/(iPhone\sOS|iOS)\s([\d_]+)/),te=m==="Win32";let H=m==="MacIntel";const j=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!B&&H&&s.touch&&j.indexOf(`${i}x${I}`)>=0&&(B=y.match(/(Version)\/([\d.]+)/),B||(B=[0,1,"13_0_0"]),H=!1),F&&!te&&(T.os="android",T.android=!0),(B||J||G)&&(T.os="ios",T.ios=!0),T}function vR(n){return n===void 0&&(n={}),h1||(h1=Nq(n)),h1}let p1;function jq(){const n=na(),r=vR();let s=!1;function u(){const i=n.navigator.userAgent.toLowerCase();return i.indexOf("safari")>=0&&i.indexOf("chrome")<0&&i.indexOf("android")<0}if(u()){const i=String(n.navigator.userAgent);if(i.includes("Version/")){const[I,F]=i.split("Version/")[1].split(" ")[0].split(".").map(B=>Number(B));s=I<16||I===16&&F<2}}const m=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(n.navigator.userAgent),y=u(),T=y||m&&r.ios;return{isSafari:s||y,needPerspectiveFix:s,need3dFix:T,isWebView:m}}function xR(){return p1||(p1=jq()),p1}function Uq(n){let{swiper:r,on:s,emit:u}=n;const m=na();let y=null,T=null;const i=()=>{!r||r.destroyed||!r.initialized||(u("beforeResize"),u("resize"))},I=()=>{!r||r.destroyed||!r.initialized||(y=new ResizeObserver(G=>{T=m.requestAnimationFrame(()=>{const{width:J,height:te}=r;let H=J,j=te;G.forEach(ne=>{let{contentBoxSize:oe,contentRect:pe,target:se}=ne;se&&se!==r.el||(H=pe?pe.width:(oe[0]||oe).inlineSize,j=pe?pe.height:(oe[0]||oe).blockSize)}),(H!==J||j!==te)&&i()})}),y.observe(r.el))},F=()=>{T&&m.cancelAnimationFrame(T),y&&y.unobserve&&r.el&&(y.unobserve(r.el),y=null)},B=()=>{!r||r.destroyed||!r.initialized||u("orientationchange")};s("init",()=>{if(r.params.resizeObserver&&typeof m.ResizeObserver<"u"){I();return}m.addEventListener("resize",i),m.addEventListener("orientationchange",B)}),s("destroy",()=>{F(),m.removeEventListener("resize",i),m.removeEventListener("orientationchange",B)})}function $q(n){let{swiper:r,extendParams:s,on:u,emit:m}=n;const y=[],T=na(),i=function(B,G){G===void 0&&(G={});const J=T.MutationObserver||T.WebkitMutationObserver,te=new J(H=>{if(r.__preventObserver__)return;if(H.length===1){m("observerUpdate",H[0]);return}const j=function(){m("observerUpdate",H[0])};T.requestAnimationFrame?T.requestAnimationFrame(j):T.setTimeout(j,0)});te.observe(B,{attributes:typeof G.attributes>"u"?!0:G.attributes,childList:r.isElement||(typeof G.childList>"u"?!0:G).childList,characterData:typeof G.characterData>"u"?!0:G.characterData}),y.push(te)},I=()=>{if(r.params.observer){if(r.params.observeParents){const B=j_(r.hostEl);for(let G=0;G<B.length;G+=1)i(B[G])}i(r.hostEl,{childList:r.params.observeSlideChildren}),i(r.wrapperEl,{attributes:!1})}},F=()=>{y.forEach(B=>{B.disconnect()}),y.splice(0,y.length)};s({observer:!1,observeParents:!1,observeSlideChildren:!1}),u("init",I),u("destroy",F)}var Vq={on(n,r,s){const u=this;if(!u.eventsListeners||u.destroyed||typeof r!="function")return u;const m=s?"unshift":"push";return n.split(" ").forEach(y=>{u.eventsListeners[y]||(u.eventsListeners[y]=[]),u.eventsListeners[y][m](r)}),u},once(n,r,s){const u=this;if(!u.eventsListeners||u.destroyed||typeof r!="function")return u;function m(){u.off(n,m),m.__emitterProxy&&delete m.__emitterProxy;for(var y=arguments.length,T=new Array(y),i=0;i<y;i++)T[i]=arguments[i];r.apply(u,T)}return m.__emitterProxy=r,u.on(n,m,s)},onAny(n,r){const s=this;if(!s.eventsListeners||s.destroyed||typeof n!="function")return s;const u=r?"unshift":"push";return s.eventsAnyListeners.indexOf(n)<0&&s.eventsAnyListeners[u](n),s},offAny(n){const r=this;if(!r.eventsListeners||r.destroyed||!r.eventsAnyListeners)return r;const s=r.eventsAnyListeners.indexOf(n);return s>=0&&r.eventsAnyListeners.splice(s,1),r},off(n,r){const s=this;return!s.eventsListeners||s.destroyed||!s.eventsListeners||n.split(" ").forEach(u=>{typeof r>"u"?s.eventsListeners[u]=[]:s.eventsListeners[u]&&s.eventsListeners[u].forEach((m,y)=>{(m===r||m.__emitterProxy&&m.__emitterProxy===r)&&s.eventsListeners[u].splice(y,1)})}),s},emit(){const n=this;if(!n.eventsListeners||n.destroyed||!n.eventsListeners)return n;let r,s,u;for(var m=arguments.length,y=new Array(m),T=0;T<m;T++)y[T]=arguments[T];return typeof y[0]=="string"||Array.isArray(y[0])?(r=y[0],s=y.slice(1,y.length),u=n):(r=y[0].events,s=y[0].data,u=y[0].context||n),s.unshift(u),(Array.isArray(r)?r:r.split(" ")).forEach(I=>{n.eventsAnyListeners&&n.eventsAnyListeners.length&&n.eventsAnyListeners.forEach(F=>{F.apply(u,[I,...s])}),n.eventsListeners&&n.eventsListeners[I]&&n.eventsListeners[I].forEach(F=>{F.apply(u,s)})}),n}};function Gq(){const n=this;let r,s;const u=n.el;typeof n.params.width<"u"&&n.params.width!==null?r=n.params.width:r=u.clientWidth,typeof n.params.height<"u"&&n.params.height!==null?s=n.params.height:s=u.clientHeight,!(r===0&&n.isHorizontal()||s===0&&n.isVertical())&&(r=r-parseInt(bp(u,"padding-left")||0,10)-parseInt(bp(u,"padding-right")||0,10),s=s-parseInt(bp(u,"padding-top")||0,10)-parseInt(bp(u,"padding-bottom")||0,10),Number.isNaN(r)&&(r=0),Number.isNaN(s)&&(s=0),Object.assign(n,{width:r,height:s,size:n.isHorizontal()?r:s}))}function qq(){const n=this;function r(ae,ke){return parseFloat(ae.getPropertyValue(n.getDirectionLabel(ke))||0)}const s=n.params,{wrapperEl:u,slidesEl:m,size:y,rtlTranslate:T,wrongRTL:i}=n,I=n.virtual&&s.virtual.enabled,F=I?n.virtual.slides.length:n.slides.length,B=wc(m,`.${n.params.slideClass}, swiper-slide`),G=I?n.virtual.slides.length:B.length;let J=[];const te=[],H=[];let j=s.slidesOffsetBefore;typeof j=="function"&&(j=s.slidesOffsetBefore.call(n));let ne=s.slidesOffsetAfter;typeof ne=="function"&&(ne=s.slidesOffsetAfter.call(n));const oe=n.snapGrid.length,pe=n.slidesGrid.length;let se=s.spaceBetween,ie=-j,ce=0,we=0;if(typeof y>"u")return;typeof se=="string"&&se.indexOf("%")>=0?se=parseFloat(se.replace("%",""))/100*y:typeof se=="string"&&(se=parseFloat(se)),n.virtualSize=-se,B.forEach(ae=>{T?ae.style.marginLeft="":ae.style.marginRight="",ae.style.marginBottom="",ae.style.marginTop=""}),s.centeredSlides&&s.cssMode&&(Iv(u,"--swiper-centered-offset-before",""),Iv(u,"--swiper-centered-offset-after",""));const xe=s.grid&&s.grid.rows>1&&n.grid;xe?n.grid.initSlides(B):n.grid&&n.grid.unsetSlides();let $e;const Ze=s.slidesPerView==="auto"&&s.breakpoints&&Object.keys(s.breakpoints).filter(ae=>typeof s.breakpoints[ae].slidesPerView<"u").length>0;for(let ae=0;ae<G;ae+=1){$e=0;let ke;if(B[ae]&&(ke=B[ae]),xe&&n.grid.updateSlide(ae,ke,B),!(B[ae]&&bp(ke,"display")==="none")){if(s.slidesPerView==="auto"){Ze&&(B[ae].style[n.getDirectionLabel("width")]="");const ct=getComputedStyle(ke),Xe=ke.style.transform,st=ke.style.webkitTransform;if(Xe&&(ke.style.transform="none"),st&&(ke.style.webkitTransform="none"),s.roundLengths)$e=n.isHorizontal()?nw(ke,"width"):nw(ke,"height");else{const et=r(ct,"width"),gt=r(ct,"padding-left"),zt=r(ct,"padding-right"),at=r(ct,"margin-left"),Ye=r(ct,"margin-right"),Bt=ct.getPropertyValue("box-sizing");if(Bt&&Bt==="border-box")$e=et+at+Ye;else{const{clientWidth:nt,offsetWidth:Rt}=ke;$e=et+gt+zt+at+Ye+(Rt-nt)}}Xe&&(ke.style.transform=Xe),st&&(ke.style.webkitTransform=st),s.roundLengths&&($e=Math.floor($e))}else $e=(y-(s.slidesPerView-1)*se)/s.slidesPerView,s.roundLengths&&($e=Math.floor($e)),B[ae]&&(B[ae].style[n.getDirectionLabel("width")]=`${$e}px`);B[ae]&&(B[ae].swiperSlideSize=$e),H.push($e),s.centeredSlides?(ie=ie+$e/2+ce/2+se,ce===0&&ae!==0&&(ie=ie-y/2-se),ae===0&&(ie=ie-y/2-se),Math.abs(ie)<1/1e3&&(ie=0),s.roundLengths&&(ie=Math.floor(ie)),we%s.slidesPerGroup===0&&J.push(ie),te.push(ie)):(s.roundLengths&&(ie=Math.floor(ie)),(we-Math.min(n.params.slidesPerGroupSkip,we))%n.params.slidesPerGroup===0&&J.push(ie),te.push(ie),ie=ie+$e+se),n.virtualSize+=$e+se,ce=$e,we+=1}}if(n.virtualSize=Math.max(n.virtualSize,y)+ne,T&&i&&(s.effect==="slide"||s.effect==="coverflow")&&(u.style.width=`${n.virtualSize+se}px`),s.setWrapperSize&&(u.style[n.getDirectionLabel("width")]=`${n.virtualSize+se}px`),xe&&n.grid.updateWrapperSize($e,J),!s.centeredSlides){const ae=[];for(let ke=0;ke<J.length;ke+=1){let ct=J[ke];s.roundLengths&&(ct=Math.floor(ct)),J[ke]<=n.virtualSize-y&&ae.push(ct)}J=ae,Math.floor(n.virtualSize-y)-Math.floor(J[J.length-1])>1&&J.push(n.virtualSize-y)}if(I&&s.loop){const ae=H[0]+se;if(s.slidesPerGroup>1){const ke=Math.ceil((n.virtual.slidesBefore+n.virtual.slidesAfter)/s.slidesPerGroup),ct=ae*s.slidesPerGroup;for(let Xe=0;Xe<ke;Xe+=1)J.push(J[J.length-1]+ct)}for(let ke=0;ke<n.virtual.slidesBefore+n.virtual.slidesAfter;ke+=1)s.slidesPerGroup===1&&J.push(J[J.length-1]+ae),te.push(te[te.length-1]+ae),n.virtualSize+=ae}if(J.length===0&&(J=[0]),se!==0){const ae=n.isHorizontal()&&T?"marginLeft":n.getDirectionLabel("marginRight");B.filter((ke,ct)=>!s.cssMode||s.loop?!0:ct!==B.length-1).forEach(ke=>{ke.style[ae]=`${se}px`})}if(s.centeredSlides&&s.centeredSlidesBounds){let ae=0;H.forEach(ct=>{ae+=ct+(se||0)}),ae-=se;const ke=ae>y?ae-y:0;J=J.map(ct=>ct<=0?-j:ct>ke?ke+ne:ct)}if(s.centerInsufficientSlides){let ae=0;H.forEach(ct=>{ae+=ct+(se||0)}),ae-=se;const ke=(s.slidesOffsetBefore||0)+(s.slidesOffsetAfter||0);if(ae+ke<y){const ct=(y-ae-ke)/2;J.forEach((Xe,st)=>{J[st]=Xe-ct}),te.forEach((Xe,st)=>{te[st]=Xe+ct})}}if(Object.assign(n,{slides:B,snapGrid:J,slidesGrid:te,slidesSizesGrid:H}),s.centeredSlides&&s.cssMode&&!s.centeredSlidesBounds){Iv(u,"--swiper-centered-offset-before",`${-J[0]}px`),Iv(u,"--swiper-centered-offset-after",`${n.size/2-H[H.length-1]/2}px`);const ae=-n.snapGrid[0],ke=-n.slidesGrid[0];n.snapGrid=n.snapGrid.map(ct=>ct+ae),n.slidesGrid=n.slidesGrid.map(ct=>ct+ke)}if(G!==F&&n.emit("slidesLengthChange"),J.length!==oe&&(n.params.watchOverflow&&n.checkOverflow(),n.emit("snapGridLengthChange")),te.length!==pe&&n.emit("slidesGridLengthChange"),s.watchSlidesProgress&&n.updateSlidesOffset(),n.emit("slidesUpdated"),!I&&!s.cssMode&&(s.effect==="slide"||s.effect==="fade")){const ae=`${s.containerModifierClass}backface-hidden`,ke=n.el.classList.contains(ae);G<=s.maxBackfaceHiddenSlides?ke||n.el.classList.add(ae):ke&&n.el.classList.remove(ae)}}function Wq(n){const r=this,s=[],u=r.virtual&&r.params.virtual.enabled;let m=0,y;typeof n=="number"?r.setTransition(n):n===!0&&r.setTransition(r.params.speed);const T=i=>u?r.slides[r.getSlideIndexByData(i)]:r.slides[i];if(r.params.slidesPerView!=="auto"&&r.params.slidesPerView>1)if(r.params.centeredSlides)(r.visibleSlides||[]).forEach(i=>{s.push(i)});else for(y=0;y<Math.ceil(r.params.slidesPerView);y+=1){const i=r.activeIndex+y;if(i>r.slides.length&&!u)break;s.push(T(i))}else s.push(T(r.activeIndex));for(y=0;y<s.length;y+=1)if(typeof s[y]<"u"){const i=s[y].offsetHeight;m=i>m?i:m}(m||m===0)&&(r.wrapperEl.style.height=`${m}px`)}function Hq(){const n=this,r=n.slides,s=n.isElement?n.isHorizontal()?n.wrapperEl.offsetLeft:n.wrapperEl.offsetTop:0;for(let u=0;u<r.length;u+=1)r[u].swiperSlideOffset=(n.isHorizontal()?r[u].offsetLeft:r[u].offsetTop)-s-n.cssOverflowAdjustment()}const LI=(n,r,s)=>{r&&!n.classList.contains(s)?n.classList.add(s):!r&&n.classList.contains(s)&&n.classList.remove(s)};function Zq(n){n===void 0&&(n=this&&this.translate||0);const r=this,s=r.params,{slides:u,rtlTranslate:m,snapGrid:y}=r;if(u.length===0)return;typeof u[0].swiperSlideOffset>"u"&&r.updateSlidesOffset();let T=-n;m&&(T=n),r.visibleSlidesIndexes=[],r.visibleSlides=[];let i=s.spaceBetween;typeof i=="string"&&i.indexOf("%")>=0?i=parseFloat(i.replace("%",""))/100*r.size:typeof i=="string"&&(i=parseFloat(i));for(let I=0;I<u.length;I+=1){const F=u[I];let B=F.swiperSlideOffset;s.cssMode&&s.centeredSlides&&(B-=u[0].swiperSlideOffset);const G=(T+(s.centeredSlides?r.minTranslate():0)-B)/(F.swiperSlideSize+i),J=(T-y[0]+(s.centeredSlides?r.minTranslate():0)-B)/(F.swiperSlideSize+i),te=-(T-B),H=te+r.slidesSizesGrid[I],j=te>=0&&te<=r.size-r.slidesSizesGrid[I],ne=te>=0&&te<r.size-1||H>1&&H<=r.size||te<=0&&H>=r.size;ne&&(r.visibleSlides.push(F),r.visibleSlidesIndexes.push(I)),LI(F,ne,s.slideVisibleClass),LI(F,j,s.slideFullyVisibleClass),F.progress=m?-G:G,F.originalProgress=m?-J:J}}function Xq(n){const r=this;if(typeof n>"u"){const B=r.rtlTranslate?-1:1;n=r&&r.translate&&r.translate*B||0}const s=r.params,u=r.maxTranslate()-r.minTranslate();let{progress:m,isBeginning:y,isEnd:T,progressLoop:i}=r;const I=y,F=T;if(u===0)m=0,y=!0,T=!0;else{m=(n-r.minTranslate())/u;const B=Math.abs(n-r.minTranslate())<1,G=Math.abs(n-r.maxTranslate())<1;y=B||m<=0,T=G||m>=1,B&&(m=0),G&&(m=1)}if(s.loop){const B=r.getSlideIndexByData(0),G=r.getSlideIndexByData(r.slides.length-1),J=r.slidesGrid[B],te=r.slidesGrid[G],H=r.slidesGrid[r.slidesGrid.length-1],j=Math.abs(n);j>=J?i=(j-J)/H:i=(j+H-te)/H,i>1&&(i-=1)}Object.assign(r,{progress:m,progressLoop:i,isBeginning:y,isEnd:T}),(s.watchSlidesProgress||s.centeredSlides&&s.autoHeight)&&r.updateSlidesProgress(n),y&&!I&&r.emit("reachBeginning toEdge"),T&&!F&&r.emit("reachEnd toEdge"),(I&&!y||F&&!T)&&r.emit("fromEdge"),r.emit("progress",m)}const f1=(n,r,s)=>{r&&!n.classList.contains(s)?n.classList.add(s):!r&&n.classList.contains(s)&&n.classList.remove(s)};function Yq(){const n=this,{slides:r,params:s,slidesEl:u,activeIndex:m}=n,y=n.virtual&&s.virtual.enabled,T=n.grid&&s.grid&&s.grid.rows>1,i=G=>wc(u,`.${s.slideClass}${G}, swiper-slide${G}`)[0];let I,F,B;if(y)if(s.loop){let G=m-n.virtual.slidesBefore;G<0&&(G=n.virtual.slides.length+G),G>=n.virtual.slides.length&&(G-=n.virtual.slides.length),I=i(`[data-swiper-slide-index="${G}"]`)}else I=i(`[data-swiper-slide-index="${m}"]`);else T?(I=r.find(G=>G.column===m),B=r.find(G=>G.column===m+1),F=r.find(G=>G.column===m-1)):I=r[m];I&&(T||(B=Oq(I,`.${s.slideClass}, swiper-slide`)[0],s.loop&&!B&&(B=r[0]),F=Dq(I,`.${s.slideClass}, swiper-slide`)[0],s.loop&&!F===0&&(F=r[r.length-1]))),r.forEach(G=>{f1(G,G===I,s.slideActiveClass),f1(G,G===B,s.slideNextClass),f1(G,G===F,s.slidePrevClass)}),n.emitSlidesClasses()}const Nv=(n,r)=>{if(!n||n.destroyed||!n.params)return;const s=()=>n.isElement?"swiper-slide":`.${n.params.slideClass}`,u=r.closest(s());if(u){let m=u.querySelector(`.${n.params.lazyPreloaderClass}`);!m&&n.isElement&&(u.shadowRoot?m=u.shadowRoot.querySelector(`.${n.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{u.shadowRoot&&(m=u.shadowRoot.querySelector(`.${n.params.lazyPreloaderClass}`),m&&m.remove())})),m&&m.remove()}},m1=(n,r)=>{if(!n.slides[r])return;const s=n.slides[r].querySelector('[loading="lazy"]');s&&s.removeAttribute("loading")},rw=n=>{if(!n||n.destroyed||!n.params)return;let r=n.params.lazyPreloadPrevNext;const s=n.slides.length;if(!s||!r||r<0)return;r=Math.min(r,s);const u=n.params.slidesPerView==="auto"?n.slidesPerViewDynamic():Math.ceil(n.params.slidesPerView),m=n.activeIndex;if(n.params.grid&&n.params.grid.rows>1){const T=m,i=[T-r];i.push(...Array.from({length:r}).map((I,F)=>T+u+F)),n.slides.forEach((I,F)=>{i.includes(I.column)&&m1(n,F)});return}const y=m+u-1;if(n.params.rewind||n.params.loop)for(let T=m-r;T<=y+r;T+=1){const i=(T%s+s)%s;(i<m||i>y)&&m1(n,i)}else for(let T=Math.max(m-r,0);T<=Math.min(y+r,s-1);T+=1)T!==m&&(T>y||T<m)&&m1(n,T)};function Kq(n){const{slidesGrid:r,params:s}=n,u=n.rtlTranslate?n.translate:-n.translate;let m;for(let y=0;y<r.length;y+=1)typeof r[y+1]<"u"?u>=r[y]&&u<r[y+1]-(r[y+1]-r[y])/2?m=y:u>=r[y]&&u<r[y+1]&&(m=y+1):u>=r[y]&&(m=y);return s.normalizeSlideIndex&&(m<0||typeof m>"u")&&(m=0),m}function Jq(n){const r=this,s=r.rtlTranslate?r.translate:-r.translate,{snapGrid:u,params:m,activeIndex:y,realIndex:T,snapIndex:i}=r;let I=n,F;const B=te=>{let H=te-r.virtual.slidesBefore;return H<0&&(H=r.virtual.slides.length+H),H>=r.virtual.slides.length&&(H-=r.virtual.slides.length),H};if(typeof I>"u"&&(I=Kq(r)),u.indexOf(s)>=0)F=u.indexOf(s);else{const te=Math.min(m.slidesPerGroupSkip,I);F=te+Math.floor((I-te)/m.slidesPerGroup)}if(F>=u.length&&(F=u.length-1),I===y&&!r.params.loop){F!==i&&(r.snapIndex=F,r.emit("snapIndexChange"));return}if(I===y&&r.params.loop&&r.virtual&&r.params.virtual.enabled){r.realIndex=B(I);return}const G=r.grid&&m.grid&&m.grid.rows>1;let J;if(r.virtual&&m.virtual.enabled&&m.loop)J=B(I);else if(G){const te=r.slides.find(j=>j.column===I);let H=parseInt(te.getAttribute("data-swiper-slide-index"),10);Number.isNaN(H)&&(H=Math.max(r.slides.indexOf(te),0)),J=Math.floor(H/m.grid.rows)}else if(r.slides[I]){const te=r.slides[I].getAttribute("data-swiper-slide-index");te?J=parseInt(te,10):J=I}else J=I;Object.assign(r,{previousSnapIndex:i,snapIndex:F,previousRealIndex:T,realIndex:J,previousIndex:y,activeIndex:I}),r.initialized&&rw(r),r.emit("activeIndexChange"),r.emit("snapIndexChange"),(r.initialized||r.params.runCallbacksOnInit)&&(T!==J&&r.emit("realIndexChange"),r.emit("slideChange"))}function Qq(n,r){const s=this,u=s.params;let m=n.closest(`.${u.slideClass}, swiper-slide`);!m&&s.isElement&&r&&r.length>1&&r.includes(n)&&[...r.slice(r.indexOf(n)+1,r.length)].forEach(i=>{!m&&i.matches&&i.matches(`.${u.slideClass}, swiper-slide`)&&(m=i)});let y=!1,T;if(m){for(let i=0;i<s.slides.length;i+=1)if(s.slides[i]===m){y=!0,T=i;break}}if(m&&y)s.clickedSlide=m,s.virtual&&s.params.virtual.enabled?s.clickedIndex=parseInt(m.getAttribute("data-swiper-slide-index"),10):s.clickedIndex=T;else{s.clickedSlide=void 0,s.clickedIndex=void 0;return}u.slideToClickedSlide&&s.clickedIndex!==void 0&&s.clickedIndex!==s.activeIndex&&s.slideToClickedSlide()}var e7={updateSize:Gq,updateSlides:qq,updateAutoHeight:Wq,updateSlidesOffset:Hq,updateSlidesProgress:Zq,updateProgress:Xq,updateSlidesClasses:Yq,updateActiveIndex:Jq,updateClickedSlide:Qq};function t7(n){n===void 0&&(n=this.isHorizontal()?"x":"y");const r=this,{params:s,rtlTranslate:u,translate:m,wrapperEl:y}=r;if(s.virtualTranslate)return u?-m:m;if(s.cssMode)return m;let T=tw(y,n);return T+=r.cssOverflowAdjustment(),u&&(T=-T),T||0}function n7(n,r){const s=this,{rtlTranslate:u,params:m,wrapperEl:y,progress:T}=s;let i=0,I=0;const F=0;s.isHorizontal()?i=u?-n:n:I=n,m.roundLengths&&(i=Math.floor(i),I=Math.floor(I)),s.previousTranslate=s.translate,s.translate=s.isHorizontal()?i:I,m.cssMode?y[s.isHorizontal()?"scrollLeft":"scrollTop"]=s.isHorizontal()?-i:-I:m.virtualTranslate||(s.isHorizontal()?i-=s.cssOverflowAdjustment():I-=s.cssOverflowAdjustment(),y.style.transform=`translate3d(${i}px, ${I}px, ${F}px)`);let B;const G=s.maxTranslate()-s.minTranslate();G===0?B=0:B=(n-s.minTranslate())/G,B!==T&&s.updateProgress(n),s.emit("setTranslate",s.translate,r)}function r7(){return-this.snapGrid[0]}function i7(){return-this.snapGrid[this.snapGrid.length-1]}function o7(n,r,s,u,m){n===void 0&&(n=0),r===void 0&&(r=this.params.speed),s===void 0&&(s=!0),u===void 0&&(u=!0);const y=this,{params:T,wrapperEl:i}=y;if(y.animating&&T.preventInteractionOnTransition)return!1;const I=y.minTranslate(),F=y.maxTranslate();let B;if(u&&n>I?B=I:u&&n<F?B=F:B=n,y.updateProgress(B),T.cssMode){const G=y.isHorizontal();if(r===0)i[G?"scrollLeft":"scrollTop"]=-B;else{if(!y.support.smoothScroll)return _R({swiper:y,targetPosition:-B,side:G?"left":"top"}),!0;i.scrollTo({[G?"left":"top"]:-B,behavior:"smooth"})}return!0}return r===0?(y.setTransition(0),y.setTranslate(B),s&&(y.emit("beforeTransitionStart",r,m),y.emit("transitionEnd"))):(y.setTransition(r),y.setTranslate(B),s&&(y.emit("beforeTransitionStart",r,m),y.emit("transitionStart")),y.animating||(y.animating=!0,y.onTranslateToWrapperTransitionEnd||(y.onTranslateToWrapperTransitionEnd=function(J){!y||y.destroyed||J.target===this&&(y.wrapperEl.removeEventListener("transitionend",y.onTranslateToWrapperTransitionEnd),y.onTranslateToWrapperTransitionEnd=null,delete y.onTranslateToWrapperTransitionEnd,y.animating=!1,s&&y.emit("transitionEnd"))}),y.wrapperEl.addEventListener("transitionend",y.onTranslateToWrapperTransitionEnd))),!0}var s7={getTranslate:t7,setTranslate:n7,minTranslate:r7,maxTranslate:i7,translateTo:o7};function a7(n,r){const s=this;s.params.cssMode||(s.wrapperEl.style.transitionDuration=`${n}ms`,s.wrapperEl.style.transitionDelay=n===0?"0ms":""),s.emit("setTransition",n,r)}function bR(n){let{swiper:r,runCallbacks:s,direction:u,step:m}=n;const{activeIndex:y,previousIndex:T}=r;let i=u;if(i||(y>T?i="next":y<T?i="prev":i="reset"),r.emit(`transition${m}`),s&&y!==T){if(i==="reset"){r.emit(`slideResetTransition${m}`);return}r.emit(`slideChangeTransition${m}`),i==="next"?r.emit(`slideNextTransition${m}`):r.emit(`slidePrevTransition${m}`)}}function l7(n,r){n===void 0&&(n=!0);const s=this,{params:u}=s;u.cssMode||(u.autoHeight&&s.updateAutoHeight(),bR({swiper:s,runCallbacks:n,direction:r,step:"Start"}))}function c7(n,r){n===void 0&&(n=!0);const s=this,{params:u}=s;s.animating=!1,!u.cssMode&&(s.setTransition(0),bR({swiper:s,runCallbacks:n,direction:r,step:"End"}))}var u7={setTransition:a7,transitionStart:l7,transitionEnd:c7};function d7(n,r,s,u,m){n===void 0&&(n=0),s===void 0&&(s=!0),typeof n=="string"&&(n=parseInt(n,10));const y=this;let T=n;T<0&&(T=0);const{params:i,snapGrid:I,slidesGrid:F,previousIndex:B,activeIndex:G,rtlTranslate:J,wrapperEl:te,enabled:H}=y;if(!H&&!u&&!m||y.destroyed||y.animating&&i.preventInteractionOnTransition)return!1;typeof r>"u"&&(r=y.params.speed);const j=Math.min(y.params.slidesPerGroupSkip,T);let ne=j+Math.floor((T-j)/y.params.slidesPerGroup);ne>=I.length&&(ne=I.length-1);const oe=-I[ne];if(i.normalizeSlideIndex)for(let xe=0;xe<F.length;xe+=1){const $e=-Math.floor(oe*100),Ze=Math.floor(F[xe]*100),ae=Math.floor(F[xe+1]*100);typeof F[xe+1]<"u"?$e>=Ze&&$e<ae-(ae-Ze)/2?T=xe:$e>=Ze&&$e<ae&&(T=xe+1):$e>=Ze&&(T=xe)}if(y.initialized&&T!==G&&(!y.allowSlideNext&&(J?oe>y.translate&&oe>y.minTranslate():oe<y.translate&&oe<y.minTranslate())||!y.allowSlidePrev&&oe>y.translate&&oe>y.maxTranslate()&&(G||0)!==T))return!1;T!==(B||0)&&s&&y.emit("beforeSlideChangeStart"),y.updateProgress(oe);let pe;T>G?pe="next":T<G?pe="prev":pe="reset";const se=y.virtual&&y.params.virtual.enabled;if(!(se&&m)&&(J&&-oe===y.translate||!J&&oe===y.translate))return y.updateActiveIndex(T),i.autoHeight&&y.updateAutoHeight(),y.updateSlidesClasses(),i.effect!=="slide"&&y.setTranslate(oe),pe!=="reset"&&(y.transitionStart(s,pe),y.transitionEnd(s,pe)),!1;if(i.cssMode){const xe=y.isHorizontal(),$e=J?oe:-oe;if(r===0)se&&(y.wrapperEl.style.scrollSnapType="none",y._immediateVirtual=!0),se&&!y._cssModeVirtualInitialSet&&y.params.initialSlide>0?(y._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{te[xe?"scrollLeft":"scrollTop"]=$e})):te[xe?"scrollLeft":"scrollTop"]=$e,se&&requestAnimationFrame(()=>{y.wrapperEl.style.scrollSnapType="",y._immediateVirtual=!1});else{if(!y.support.smoothScroll)return _R({swiper:y,targetPosition:$e,side:xe?"left":"top"}),!0;te.scrollTo({[xe?"left":"top"]:$e,behavior:"smooth"})}return!0}const we=xR().isSafari;return se&&!m&&we&&y.isElement&&y.virtual.update(!1,!1,T),y.setTransition(r),y.setTranslate(oe),y.updateActiveIndex(T),y.updateSlidesClasses(),y.emit("beforeTransitionStart",r,u),y.transitionStart(s,pe),r===0?y.transitionEnd(s,pe):y.animating||(y.animating=!0,y.onSlideToWrapperTransitionEnd||(y.onSlideToWrapperTransitionEnd=function($e){!y||y.destroyed||$e.target===this&&(y.wrapperEl.removeEventListener("transitionend",y.onSlideToWrapperTransitionEnd),y.onSlideToWrapperTransitionEnd=null,delete y.onSlideToWrapperTransitionEnd,y.transitionEnd(s,pe))}),y.wrapperEl.addEventListener("transitionend",y.onSlideToWrapperTransitionEnd)),!0}function h7(n,r,s,u){n===void 0&&(n=0),s===void 0&&(s=!0),typeof n=="string"&&(n=parseInt(n,10));const m=this;if(m.destroyed)return;typeof r>"u"&&(r=m.params.speed);const y=m.grid&&m.params.grid&&m.params.grid.rows>1;let T=n;if(m.params.loop)if(m.virtual&&m.params.virtual.enabled)T=T+m.virtual.slidesBefore;else{let i;if(y){const J=T*m.params.grid.rows;i=m.slides.find(te=>te.getAttribute("data-swiper-slide-index")*1===J).column}else i=m.getSlideIndexByData(T);const I=y?Math.ceil(m.slides.length/m.params.grid.rows):m.slides.length,{centeredSlides:F}=m.params;let B=m.params.slidesPerView;B==="auto"?B=m.slidesPerViewDynamic():(B=Math.ceil(parseFloat(m.params.slidesPerView,10)),F&&B%2===0&&(B=B+1));let G=I-i<B;if(F&&(G=G||i<Math.ceil(B/2)),u&&F&&m.params.slidesPerView!=="auto"&&!y&&(G=!1),G){const J=F?i<m.activeIndex?"prev":"next":i-m.activeIndex-1<m.params.slidesPerView?"next":"prev";m.loopFix({direction:J,slideTo:!0,activeSlideIndex:J==="next"?i+1:i-I+1,slideRealIndex:J==="next"?m.realIndex:void 0})}if(y){const J=T*m.params.grid.rows;T=m.slides.find(te=>te.getAttribute("data-swiper-slide-index")*1===J).column}else T=m.getSlideIndexByData(T)}return requestAnimationFrame(()=>{m.slideTo(T,r,s,u)}),m}function p7(n,r,s){r===void 0&&(r=!0);const u=this,{enabled:m,params:y,animating:T}=u;if(!m||u.destroyed)return u;typeof n>"u"&&(n=u.params.speed);let i=y.slidesPerGroup;y.slidesPerView==="auto"&&y.slidesPerGroup===1&&y.slidesPerGroupAuto&&(i=Math.max(u.slidesPerViewDynamic("current",!0),1));const I=u.activeIndex<y.slidesPerGroupSkip?1:i,F=u.virtual&&y.virtual.enabled;if(y.loop){if(T&&!F&&y.loopPreventsSliding)return!1;if(u.loopFix({direction:"next"}),u._clientLeft=u.wrapperEl.clientLeft,u.activeIndex===u.slides.length-1&&y.cssMode)return requestAnimationFrame(()=>{u.slideTo(u.activeIndex+I,n,r,s)}),!0}return y.rewind&&u.isEnd?u.slideTo(0,n,r,s):u.slideTo(u.activeIndex+I,n,r,s)}function f7(n,r,s){r===void 0&&(r=!0);const u=this,{params:m,snapGrid:y,slidesGrid:T,rtlTranslate:i,enabled:I,animating:F}=u;if(!I||u.destroyed)return u;typeof n>"u"&&(n=u.params.speed);const B=u.virtual&&m.virtual.enabled;if(m.loop){if(F&&!B&&m.loopPreventsSliding)return!1;u.loopFix({direction:"prev"}),u._clientLeft=u.wrapperEl.clientLeft}const G=i?u.translate:-u.translate;function J(pe){return pe<0?-Math.floor(Math.abs(pe)):Math.floor(pe)}const te=J(G),H=y.map(pe=>J(pe)),j=m.freeMode&&m.freeMode.enabled;let ne=y[H.indexOf(te)-1];if(typeof ne>"u"&&(m.cssMode||j)){let pe;y.forEach((se,ie)=>{te>=se&&(pe=ie)}),typeof pe<"u"&&(ne=j?y[pe]:y[pe>0?pe-1:pe])}let oe=0;if(typeof ne<"u"&&(oe=T.indexOf(ne),oe<0&&(oe=u.activeIndex-1),m.slidesPerView==="auto"&&m.slidesPerGroup===1&&m.slidesPerGroupAuto&&(oe=oe-u.slidesPerViewDynamic("previous",!0)+1,oe=Math.max(oe,0))),m.rewind&&u.isBeginning){const pe=u.params.virtual&&u.params.virtual.enabled&&u.virtual?u.virtual.slides.length-1:u.slides.length-1;return u.slideTo(pe,n,r,s)}else if(m.loop&&u.activeIndex===0&&m.cssMode)return requestAnimationFrame(()=>{u.slideTo(oe,n,r,s)}),!0;return u.slideTo(oe,n,r,s)}function m7(n,r,s){r===void 0&&(r=!0);const u=this;if(!u.destroyed)return typeof n>"u"&&(n=u.params.speed),u.slideTo(u.activeIndex,n,r,s)}function g7(n,r,s,u){r===void 0&&(r=!0),u===void 0&&(u=.5);const m=this;if(m.destroyed)return;typeof n>"u"&&(n=m.params.speed);let y=m.activeIndex;const T=Math.min(m.params.slidesPerGroupSkip,y),i=T+Math.floor((y-T)/m.params.slidesPerGroup),I=m.rtlTranslate?m.translate:-m.translate;if(I>=m.snapGrid[i]){const F=m.snapGrid[i],B=m.snapGrid[i+1];I-F>(B-F)*u&&(y+=m.params.slidesPerGroup)}else{const F=m.snapGrid[i-1],B=m.snapGrid[i];I-F<=(B-F)*u&&(y-=m.params.slidesPerGroup)}return y=Math.max(y,0),y=Math.min(y,m.slidesGrid.length-1),m.slideTo(y,n,r,s)}function _7(){const n=this;if(n.destroyed)return;const{params:r,slidesEl:s}=n,u=r.slidesPerView==="auto"?n.slidesPerViewDynamic():r.slidesPerView;let m=n.clickedIndex,y;const T=n.isElement?"swiper-slide":`.${r.slideClass}`;if(r.loop){if(n.animating)return;y=parseInt(n.clickedSlide.getAttribute("data-swiper-slide-index"),10),r.centeredSlides?m<n.loopedSlides-u/2||m>n.slides.length-n.loopedSlides+u/2?(n.loopFix(),m=n.getSlideIndex(wc(s,`${T}[data-swiper-slide-index="${y}"]`)[0]),ew(()=>{n.slideTo(m)})):n.slideTo(m):m>n.slides.length-u?(n.loopFix(),m=n.getSlideIndex(wc(s,`${T}[data-swiper-slide-index="${y}"]`)[0]),ew(()=>{n.slideTo(m)})):n.slideTo(m)}else n.slideTo(m)}var y7={slideTo:d7,slideToLoop:h7,slideNext:p7,slidePrev:f7,slideReset:m7,slideToClosest:g7,slideToClickedSlide:_7};function v7(n){const r=this,{params:s,slidesEl:u}=r;if(!s.loop||r.virtual&&r.params.virtual.enabled)return;const m=()=>{wc(u,`.${s.slideClass}, swiper-slide`).forEach((G,J)=>{G.setAttribute("data-swiper-slide-index",J)})},y=r.grid&&s.grid&&s.grid.rows>1,T=s.slidesPerGroup*(y?s.grid.rows:1),i=r.slides.length%T!==0,I=y&&r.slides.length%s.grid.rows!==0,F=B=>{for(let G=0;G<B;G+=1){const J=r.isElement?J_("swiper-slide",[s.slideBlankClass]):J_("div",[s.slideClass,s.slideBlankClass]);r.slidesEl.append(J)}};if(i){if(s.loopAddBlankSlides){const B=T-r.slides.length%T;F(B),r.recalcSlides(),r.updateSlides()}else tx("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");m()}else if(I){if(s.loopAddBlankSlides){const B=s.grid.rows-r.slides.length%s.grid.rows;F(B),r.recalcSlides(),r.updateSlides()}else tx("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");m()}else m();r.loopFix({slideRealIndex:n,direction:s.centeredSlides?void 0:"next"})}function x7(n){let{slideRealIndex:r,slideTo:s=!0,direction:u,setTranslate:m,activeSlideIndex:y,byController:T,byMousewheel:i}=n===void 0?{}:n;const I=this;if(!I.params.loop)return;I.emit("beforeLoopFix");const{slides:F,allowSlidePrev:B,allowSlideNext:G,slidesEl:J,params:te}=I,{centeredSlides:H}=te;if(I.allowSlidePrev=!0,I.allowSlideNext=!0,I.virtual&&te.virtual.enabled){s&&(!te.centeredSlides&&I.snapIndex===0?I.slideTo(I.virtual.slides.length,0,!1,!0):te.centeredSlides&&I.snapIndex<te.slidesPerView?I.slideTo(I.virtual.slides.length+I.snapIndex,0,!1,!0):I.snapIndex===I.snapGrid.length-1&&I.slideTo(I.virtual.slidesBefore,0,!1,!0)),I.allowSlidePrev=B,I.allowSlideNext=G,I.emit("loopFix");return}let j=te.slidesPerView;j==="auto"?j=I.slidesPerViewDynamic():(j=Math.ceil(parseFloat(te.slidesPerView,10)),H&&j%2===0&&(j=j+1));const ne=te.slidesPerGroupAuto?j:te.slidesPerGroup;let oe=ne;oe%ne!==0&&(oe+=ne-oe%ne),oe+=te.loopAdditionalSlides,I.loopedSlides=oe;const pe=I.grid&&te.grid&&te.grid.rows>1;F.length<j+oe?tx("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):pe&&te.grid.fill==="row"&&tx("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const se=[],ie=[];let ce=I.activeIndex;typeof y>"u"?y=I.getSlideIndex(F.find(Xe=>Xe.classList.contains(te.slideActiveClass))):ce=y;const we=u==="next"||!u,xe=u==="prev"||!u;let $e=0,Ze=0;const ae=pe?Math.ceil(F.length/te.grid.rows):F.length,ct=(pe?F[y].column:y)+(H&&typeof m>"u"?-j/2+.5:0);if(ct<oe){$e=Math.max(oe-ct,ne);for(let Xe=0;Xe<oe-ct;Xe+=1){const st=Xe-Math.floor(Xe/ae)*ae;if(pe){const et=ae-st-1;for(let gt=F.length-1;gt>=0;gt-=1)F[gt].column===et&&se.push(gt)}else se.push(ae-st-1)}}else if(ct+j>ae-oe){Ze=Math.max(ct-(ae-oe*2),ne);for(let Xe=0;Xe<Ze;Xe+=1){const st=Xe-Math.floor(Xe/ae)*ae;pe?F.forEach((et,gt)=>{et.column===st&&ie.push(gt)}):ie.push(st)}}if(I.__preventObserver__=!0,requestAnimationFrame(()=>{I.__preventObserver__=!1}),xe&&se.forEach(Xe=>{F[Xe].swiperLoopMoveDOM=!0,J.prepend(F[Xe]),F[Xe].swiperLoopMoveDOM=!1}),we&&ie.forEach(Xe=>{F[Xe].swiperLoopMoveDOM=!0,J.append(F[Xe]),F[Xe].swiperLoopMoveDOM=!1}),I.recalcSlides(),te.slidesPerView==="auto"?I.updateSlides():pe&&(se.length>0&&xe||ie.length>0&&we)&&I.slides.forEach((Xe,st)=>{I.grid.updateSlide(st,Xe,I.slides)}),te.watchSlidesProgress&&I.updateSlidesOffset(),s){if(se.length>0&&xe){if(typeof r>"u"){const Xe=I.slidesGrid[ce],et=I.slidesGrid[ce+$e]-Xe;i?I.setTranslate(I.translate-et):(I.slideTo(ce+Math.ceil($e),0,!1,!0),m&&(I.touchEventsData.startTranslate=I.touchEventsData.startTranslate-et,I.touchEventsData.currentTranslate=I.touchEventsData.currentTranslate-et))}else if(m){const Xe=pe?se.length/te.grid.rows:se.length;I.slideTo(I.activeIndex+Xe,0,!1,!0),I.touchEventsData.currentTranslate=I.translate}}else if(ie.length>0&&we)if(typeof r>"u"){const Xe=I.slidesGrid[ce],et=I.slidesGrid[ce-Ze]-Xe;i?I.setTranslate(I.translate-et):(I.slideTo(ce-Ze,0,!1,!0),m&&(I.touchEventsData.startTranslate=I.touchEventsData.startTranslate-et,I.touchEventsData.currentTranslate=I.touchEventsData.currentTranslate-et))}else{const Xe=pe?ie.length/te.grid.rows:ie.length;I.slideTo(I.activeIndex-Xe,0,!1,!0)}}if(I.allowSlidePrev=B,I.allowSlideNext=G,I.controller&&I.controller.control&&!T){const Xe={slideRealIndex:r,direction:u,setTranslate:m,activeSlideIndex:y,byController:!0};Array.isArray(I.controller.control)?I.controller.control.forEach(st=>{!st.destroyed&&st.params.loop&&st.loopFix({...Xe,slideTo:st.params.slidesPerView===te.slidesPerView?s:!1})}):I.controller.control instanceof I.constructor&&I.controller.control.params.loop&&I.controller.control.loopFix({...Xe,slideTo:I.controller.control.params.slidesPerView===te.slidesPerView?s:!1})}I.emit("loopFix")}function b7(){const n=this,{params:r,slidesEl:s}=n;if(!r.loop||n.virtual&&n.params.virtual.enabled)return;n.recalcSlides();const u=[];n.slides.forEach(m=>{const y=typeof m.swiperSlideIndex>"u"?m.getAttribute("data-swiper-slide-index")*1:m.swiperSlideIndex;u[y]=m}),n.slides.forEach(m=>{m.removeAttribute("data-swiper-slide-index")}),u.forEach(m=>{s.append(m)}),n.recalcSlides(),n.slideTo(n.realIndex,0)}var w7={loopCreate:v7,loopFix:x7,loopDestroy:b7};function S7(n){const r=this;if(!r.params.simulateTouch||r.params.watchOverflow&&r.isLocked||r.params.cssMode)return;const s=r.params.touchEventsTarget==="container"?r.el:r.wrapperEl;r.isElement&&(r.__preventObserver__=!0),s.style.cursor="move",s.style.cursor=n?"grabbing":"grab",r.isElement&&requestAnimationFrame(()=>{r.__preventObserver__=!1})}function T7(){const n=this;n.params.watchOverflow&&n.isLocked||n.params.cssMode||(n.isElement&&(n.__preventObserver__=!0),n[n.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",n.isElement&&requestAnimationFrame(()=>{n.__preventObserver__=!1}))}var E7={setGrabCursor:S7,unsetGrabCursor:T7};function C7(n,r){r===void 0&&(r=this);function s(u){if(!u||u===mu()||u===na())return null;u.assignedSlot&&(u=u.assignedSlot);const m=u.closest(n);return!m&&!u.getRootNode?null:m||s(u.getRootNode().host)}return s(r)}function zI(n,r,s){const u=na(),{params:m}=n,y=m.edgeSwipeDetection,T=m.edgeSwipeThreshold;return y&&(s<=T||s>=u.innerWidth-T)?y==="prevent"?(r.preventDefault(),!0):!1:!0}function M7(n){const r=this,s=mu();let u=n;u.originalEvent&&(u=u.originalEvent);const m=r.touchEventsData;if(u.type==="pointerdown"){if(m.pointerId!==null&&m.pointerId!==u.pointerId)return;m.pointerId=u.pointerId}else u.type==="touchstart"&&u.targetTouches.length===1&&(m.touchId=u.targetTouches[0].identifier);if(u.type==="touchstart"){zI(r,u,u.targetTouches[0].pageX);return}const{params:y,touches:T,enabled:i}=r;if(!i||!y.simulateTouch&&u.pointerType==="mouse"||r.animating&&y.preventInteractionOnTransition)return;!r.animating&&y.cssMode&&y.loop&&r.loopFix();let I=u.target;if(y.touchEventsTarget==="wrapper"&&!zq(I,r.wrapperEl)||"which"in u&&u.which===3||"button"in u&&u.button>0||m.isTouched&&m.isMoved)return;const F=!!y.noSwipingClass&&y.noSwipingClass!=="",B=u.composedPath?u.composedPath():u.path;F&&u.target&&u.target.shadowRoot&&B&&(I=B[0]);const G=y.noSwipingSelector?y.noSwipingSelector:`.${y.noSwipingClass}`,J=!!(u.target&&u.target.shadowRoot);if(y.noSwiping&&(J?C7(G,I):I.closest(G))){r.allowClick=!0;return}if(y.swipeHandler&&!I.closest(y.swipeHandler))return;T.currentX=u.pageX,T.currentY=u.pageY;const te=T.currentX,H=T.currentY;if(!zI(r,u,te))return;Object.assign(m,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),T.startX=te,T.startY=H,m.touchStartTime=ex(),r.allowClick=!0,r.updateSize(),r.swipeDirection=void 0,y.threshold>0&&(m.allowThresholdMove=!1);let j=!0;I.matches(m.focusableElements)&&(j=!1,I.nodeName==="SELECT"&&(m.isTouched=!1)),s.activeElement&&s.activeElement.matches(m.focusableElements)&&s.activeElement!==I&&(u.pointerType==="mouse"||u.pointerType!=="mouse"&&!I.matches(m.focusableElements))&&s.activeElement.blur();const ne=j&&r.allowTouchMove&&y.touchStartPreventDefault;(y.touchStartForcePreventDefault||ne)&&!I.isContentEditable&&u.preventDefault(),y.freeMode&&y.freeMode.enabled&&r.freeMode&&r.animating&&!y.cssMode&&r.freeMode.onTouchStart(),r.emit("touchStart",u)}function I7(n){const r=mu(),s=this,u=s.touchEventsData,{params:m,touches:y,rtlTranslate:T,enabled:i}=s;if(!i||!m.simulateTouch&&n.pointerType==="mouse")return;let I=n;if(I.originalEvent&&(I=I.originalEvent),I.type==="pointermove"&&(u.touchId!==null||I.pointerId!==u.pointerId))return;let F;if(I.type==="touchmove"){if(F=[...I.changedTouches].find(ce=>ce.identifier===u.touchId),!F||F.identifier!==u.touchId)return}else F=I;if(!u.isTouched){u.startMoving&&u.isScrolling&&s.emit("touchMoveOpposite",I);return}const B=F.pageX,G=F.pageY;if(I.preventedByNestedSwiper){y.startX=B,y.startY=G;return}if(!s.allowTouchMove){I.target.matches(u.focusableElements)||(s.allowClick=!1),u.isTouched&&(Object.assign(y,{startX:B,startY:G,currentX:B,currentY:G}),u.touchStartTime=ex());return}if(m.touchReleaseOnEdges&&!m.loop){if(s.isVertical()){if(G<y.startY&&s.translate<=s.maxTranslate()||G>y.startY&&s.translate>=s.minTranslate()){u.isTouched=!1,u.isMoved=!1;return}}else if(B<y.startX&&s.translate<=s.maxTranslate()||B>y.startX&&s.translate>=s.minTranslate())return}if(r.activeElement&&r.activeElement.matches(u.focusableElements)&&r.activeElement!==I.target&&I.pointerType!=="mouse"&&r.activeElement.blur(),r.activeElement&&I.target===r.activeElement&&I.target.matches(u.focusableElements)){u.isMoved=!0,s.allowClick=!1;return}u.allowTouchCallbacks&&s.emit("touchMove",I),y.previousX=y.currentX,y.previousY=y.currentY,y.currentX=B,y.currentY=G;const J=y.currentX-y.startX,te=y.currentY-y.startY;if(s.params.threshold&&Math.sqrt(J**2+te**2)<s.params.threshold)return;if(typeof u.isScrolling>"u"){let ce;s.isHorizontal()&&y.currentY===y.startY||s.isVertical()&&y.currentX===y.startX?u.isScrolling=!1:J*J+te*te>=25&&(ce=Math.atan2(Math.abs(te),Math.abs(J))*180/Math.PI,u.isScrolling=s.isHorizontal()?ce>m.touchAngle:90-ce>m.touchAngle)}if(u.isScrolling&&s.emit("touchMoveOpposite",I),typeof u.startMoving>"u"&&(y.currentX!==y.startX||y.currentY!==y.startY)&&(u.startMoving=!0),u.isScrolling||I.type==="touchmove"&&u.preventTouchMoveFromPointerMove){u.isTouched=!1;return}if(!u.startMoving)return;s.allowClick=!1,!m.cssMode&&I.cancelable&&I.preventDefault(),m.touchMoveStopPropagation&&!m.nested&&I.stopPropagation();let H=s.isHorizontal()?J:te,j=s.isHorizontal()?y.currentX-y.previousX:y.currentY-y.previousY;m.oneWayMovement&&(H=Math.abs(H)*(T?1:-1),j=Math.abs(j)*(T?1:-1)),y.diff=H,H*=m.touchRatio,T&&(H=-H,j=-j);const ne=s.touchesDirection;s.swipeDirection=H>0?"prev":"next",s.touchesDirection=j>0?"prev":"next";const oe=s.params.loop&&!m.cssMode,pe=s.touchesDirection==="next"&&s.allowSlideNext||s.touchesDirection==="prev"&&s.allowSlidePrev;if(!u.isMoved){if(oe&&pe&&s.loopFix({direction:s.swipeDirection}),u.startTranslate=s.getTranslate(),s.setTransition(0),s.animating){const ce=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});s.wrapperEl.dispatchEvent(ce)}u.allowMomentumBounce=!1,m.grabCursor&&(s.allowSlideNext===!0||s.allowSlidePrev===!0)&&s.setGrabCursor(!0),s.emit("sliderFirstMove",I)}if(new Date().getTime(),m._loopSwapReset!==!1&&u.isMoved&&u.allowThresholdMove&&ne!==s.touchesDirection&&oe&&pe&&Math.abs(H)>=1){Object.assign(y,{startX:B,startY:G,currentX:B,currentY:G,startTranslate:u.currentTranslate}),u.loopSwapReset=!0,u.startTranslate=u.currentTranslate;return}s.emit("sliderMove",I),u.isMoved=!0,u.currentTranslate=H+u.startTranslate;let se=!0,ie=m.resistanceRatio;if(m.touchReleaseOnEdges&&(ie=0),H>0?(oe&&pe&&u.allowThresholdMove&&u.currentTranslate>(m.centeredSlides?s.minTranslate()-s.slidesSizesGrid[s.activeIndex+1]-(m.slidesPerView!=="auto"&&s.slides.length-m.slidesPerView>=2?s.slidesSizesGrid[s.activeIndex+1]+s.params.spaceBetween:0)-s.params.spaceBetween:s.minTranslate())&&s.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),u.currentTranslate>s.minTranslate()&&(se=!1,m.resistance&&(u.currentTranslate=s.minTranslate()-1+(-s.minTranslate()+u.startTranslate+H)**ie))):H<0&&(oe&&pe&&u.allowThresholdMove&&u.currentTranslate<(m.centeredSlides?s.maxTranslate()+s.slidesSizesGrid[s.slidesSizesGrid.length-1]+s.params.spaceBetween+(m.slidesPerView!=="auto"&&s.slides.length-m.slidesPerView>=2?s.slidesSizesGrid[s.slidesSizesGrid.length-1]+s.params.spaceBetween:0):s.maxTranslate())&&s.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:s.slides.length-(m.slidesPerView==="auto"?s.slidesPerViewDynamic():Math.ceil(parseFloat(m.slidesPerView,10)))}),u.currentTranslate<s.maxTranslate()&&(se=!1,m.resistance&&(u.currentTranslate=s.maxTranslate()+1-(s.maxTranslate()-u.startTranslate-H)**ie))),se&&(I.preventedByNestedSwiper=!0),!s.allowSlideNext&&s.swipeDirection==="next"&&u.currentTranslate<u.startTranslate&&(u.currentTranslate=u.startTranslate),!s.allowSlidePrev&&s.swipeDirection==="prev"&&u.currentTranslate>u.startTranslate&&(u.currentTranslate=u.startTranslate),!s.allowSlidePrev&&!s.allowSlideNext&&(u.currentTranslate=u.startTranslate),m.threshold>0)if(Math.abs(H)>m.threshold||u.allowThresholdMove){if(!u.allowThresholdMove){u.allowThresholdMove=!0,y.startX=y.currentX,y.startY=y.currentY,u.currentTranslate=u.startTranslate,y.diff=s.isHorizontal()?y.currentX-y.startX:y.currentY-y.startY;return}}else{u.currentTranslate=u.startTranslate;return}!m.followFinger||m.cssMode||((m.freeMode&&m.freeMode.enabled&&s.freeMode||m.watchSlidesProgress)&&(s.updateActiveIndex(),s.updateSlidesClasses()),m.freeMode&&m.freeMode.enabled&&s.freeMode&&s.freeMode.onTouchMove(),s.updateProgress(u.currentTranslate),s.setTranslate(u.currentTranslate))}function A7(n){const r=this,s=r.touchEventsData;let u=n;u.originalEvent&&(u=u.originalEvent);let m;if(u.type==="touchend"||u.type==="touchcancel"){if(m=[...u.changedTouches].find(ce=>ce.identifier===s.touchId),!m||m.identifier!==s.touchId)return}else{if(s.touchId!==null||u.pointerId!==s.pointerId)return;m=u}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(u.type)&&!(["pointercancel","contextmenu"].includes(u.type)&&(r.browser.isSafari||r.browser.isWebView)))return;s.pointerId=null,s.touchId=null;const{params:T,touches:i,rtlTranslate:I,slidesGrid:F,enabled:B}=r;if(!B||!T.simulateTouch&&u.pointerType==="mouse")return;if(s.allowTouchCallbacks&&r.emit("touchEnd",u),s.allowTouchCallbacks=!1,!s.isTouched){s.isMoved&&T.grabCursor&&r.setGrabCursor(!1),s.isMoved=!1,s.startMoving=!1;return}T.grabCursor&&s.isMoved&&s.isTouched&&(r.allowSlideNext===!0||r.allowSlidePrev===!0)&&r.setGrabCursor(!1);const G=ex(),J=G-s.touchStartTime;if(r.allowClick){const ce=u.path||u.composedPath&&u.composedPath();r.updateClickedSlide(ce&&ce[0]||u.target,ce),r.emit("tap click",u),J<300&&G-s.lastClickTime<300&&r.emit("doubleTap doubleClick",u)}if(s.lastClickTime=ex(),ew(()=>{r.destroyed||(r.allowClick=!0)}),!s.isTouched||!s.isMoved||!r.swipeDirection||i.diff===0&&!s.loopSwapReset||s.currentTranslate===s.startTranslate&&!s.loopSwapReset){s.isTouched=!1,s.isMoved=!1,s.startMoving=!1;return}s.isTouched=!1,s.isMoved=!1,s.startMoving=!1;let te;if(T.followFinger?te=I?r.translate:-r.translate:te=-s.currentTranslate,T.cssMode)return;if(T.freeMode&&T.freeMode.enabled){r.freeMode.onTouchEnd({currentPos:te});return}const H=te>=-r.maxTranslate()&&!r.params.loop;let j=0,ne=r.slidesSizesGrid[0];for(let ce=0;ce<F.length;ce+=ce<T.slidesPerGroupSkip?1:T.slidesPerGroup){const we=ce<T.slidesPerGroupSkip-1?1:T.slidesPerGroup;typeof F[ce+we]<"u"?(H||te>=F[ce]&&te<F[ce+we])&&(j=ce,ne=F[ce+we]-F[ce]):(H||te>=F[ce])&&(j=ce,ne=F[F.length-1]-F[F.length-2])}let oe=null,pe=null;T.rewind&&(r.isBeginning?pe=T.virtual&&T.virtual.enabled&&r.virtual?r.virtual.slides.length-1:r.slides.length-1:r.isEnd&&(oe=0));const se=(te-F[j])/ne,ie=j<T.slidesPerGroupSkip-1?1:T.slidesPerGroup;if(J>T.longSwipesMs){if(!T.longSwipes){r.slideTo(r.activeIndex);return}r.swipeDirection==="next"&&(se>=T.longSwipesRatio?r.slideTo(T.rewind&&r.isEnd?oe:j+ie):r.slideTo(j)),r.swipeDirection==="prev"&&(se>1-T.longSwipesRatio?r.slideTo(j+ie):pe!==null&&se<0&&Math.abs(se)>T.longSwipesRatio?r.slideTo(pe):r.slideTo(j))}else{if(!T.shortSwipes){r.slideTo(r.activeIndex);return}r.navigation&&(u.target===r.navigation.nextEl||u.target===r.navigation.prevEl)?u.target===r.navigation.nextEl?r.slideTo(j+ie):r.slideTo(j):(r.swipeDirection==="next"&&r.slideTo(oe!==null?oe:j+ie),r.swipeDirection==="prev"&&r.slideTo(pe!==null?pe:j))}}function DI(){const n=this,{params:r,el:s}=n;if(s&&s.offsetWidth===0)return;r.breakpoints&&n.setBreakpoint();const{allowSlideNext:u,allowSlidePrev:m,snapGrid:y}=n,T=n.virtual&&n.params.virtual.enabled;n.allowSlideNext=!0,n.allowSlidePrev=!0,n.updateSize(),n.updateSlides(),n.updateSlidesClasses();const i=T&&r.loop;(r.slidesPerView==="auto"||r.slidesPerView>1)&&n.isEnd&&!n.isBeginning&&!n.params.centeredSlides&&!i?n.slideTo(n.slides.length-1,0,!1,!0):n.params.loop&&!T?n.slideToLoop(n.realIndex,0,!1,!0):n.slideTo(n.activeIndex,0,!1,!0),n.autoplay&&n.autoplay.running&&n.autoplay.paused&&(clearTimeout(n.autoplay.resizeTimeout),n.autoplay.resizeTimeout=setTimeout(()=>{n.autoplay&&n.autoplay.running&&n.autoplay.paused&&n.autoplay.resume()},500)),n.allowSlidePrev=m,n.allowSlideNext=u,n.params.watchOverflow&&y!==n.snapGrid&&n.checkOverflow()}function P7(n){const r=this;r.enabled&&(r.allowClick||(r.params.preventClicks&&n.preventDefault(),r.params.preventClicksPropagation&&r.animating&&(n.stopPropagation(),n.stopImmediatePropagation())))}function R7(){const n=this,{wrapperEl:r,rtlTranslate:s,enabled:u}=n;if(!u)return;n.previousTranslate=n.translate,n.isHorizontal()?n.translate=-r.scrollLeft:n.translate=-r.scrollTop,n.translate===0&&(n.translate=0),n.updateActiveIndex(),n.updateSlidesClasses();let m;const y=n.maxTranslate()-n.minTranslate();y===0?m=0:m=(n.translate-n.minTranslate())/y,m!==n.progress&&n.updateProgress(s?-n.translate:n.translate),n.emit("setTranslate",n.translate,!1)}function k7(n){const r=this;Nv(r,n.target),!(r.params.cssMode||r.params.slidesPerView!=="auto"&&!r.params.autoHeight)&&r.update()}function L7(){const n=this;n.documentTouchHandlerProceeded||(n.documentTouchHandlerProceeded=!0,n.params.touchReleaseOnEdges&&(n.el.style.touchAction="auto"))}const wR=(n,r)=>{const s=mu(),{params:u,el:m,wrapperEl:y,device:T}=n,i=!!u.nested,I=r==="on"?"addEventListener":"removeEventListener",F=r;!m||typeof m=="string"||(s[I]("touchstart",n.onDocumentTouchStart,{passive:!1,capture:i}),m[I]("touchstart",n.onTouchStart,{passive:!1}),m[I]("pointerdown",n.onTouchStart,{passive:!1}),s[I]("touchmove",n.onTouchMove,{passive:!1,capture:i}),s[I]("pointermove",n.onTouchMove,{passive:!1,capture:i}),s[I]("touchend",n.onTouchEnd,{passive:!0}),s[I]("pointerup",n.onTouchEnd,{passive:!0}),s[I]("pointercancel",n.onTouchEnd,{passive:!0}),s[I]("touchcancel",n.onTouchEnd,{passive:!0}),s[I]("pointerout",n.onTouchEnd,{passive:!0}),s[I]("pointerleave",n.onTouchEnd,{passive:!0}),s[I]("contextmenu",n.onTouchEnd,{passive:!0}),(u.preventClicks||u.preventClicksPropagation)&&m[I]("click",n.onClick,!0),u.cssMode&&y[I]("scroll",n.onScroll),u.updateOnWindowResize?n[F](T.ios||T.android?"resize orientationchange observerUpdate":"resize observerUpdate",DI,!0):n[F]("observerUpdate",DI,!0),m[I]("load",n.onLoad,{capture:!0}))};function z7(){const n=this,{params:r}=n;n.onTouchStart=M7.bind(n),n.onTouchMove=I7.bind(n),n.onTouchEnd=A7.bind(n),n.onDocumentTouchStart=L7.bind(n),r.cssMode&&(n.onScroll=R7.bind(n)),n.onClick=P7.bind(n),n.onLoad=k7.bind(n),wR(n,"on")}function D7(){wR(this,"off")}var O7={attachEvents:z7,detachEvents:D7};const OI=(n,r)=>n.grid&&r.grid&&r.grid.rows>1;function F7(){const n=this,{realIndex:r,initialized:s,params:u,el:m}=n,y=u.breakpoints;if(!y||y&&Object.keys(y).length===0)return;const T=mu(),i=u.breakpointsBase==="window"||!u.breakpointsBase?u.breakpointsBase:"container",I=["window","container"].includes(u.breakpointsBase)||!u.breakpointsBase?n.el:T.querySelector(u.breakpointsBase),F=n.getBreakpoint(y,i,I);if(!F||n.currentBreakpoint===F)return;const G=(F in y?y[F]:void 0)||n.originalParams,J=OI(n,u),te=OI(n,G),H=n.params.grabCursor,j=G.grabCursor,ne=u.enabled;J&&!te?(m.classList.remove(`${u.containerModifierClass}grid`,`${u.containerModifierClass}grid-column`),n.emitContainerClasses()):!J&&te&&(m.classList.add(`${u.containerModifierClass}grid`),(G.grid.fill&&G.grid.fill==="column"||!G.grid.fill&&u.grid.fill==="column")&&m.classList.add(`${u.containerModifierClass}grid-column`),n.emitContainerClasses()),H&&!j?n.unsetGrabCursor():!H&&j&&n.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(we=>{if(typeof G[we]>"u")return;const xe=u[we]&&u[we].enabled,$e=G[we]&&G[we].enabled;xe&&!$e&&n[we].disable(),!xe&&$e&&n[we].enable()});const oe=G.direction&&G.direction!==u.direction,pe=u.loop&&(G.slidesPerView!==u.slidesPerView||oe),se=u.loop;oe&&s&&n.changeDirection(),Ol(n.params,G);const ie=n.params.enabled,ce=n.params.loop;Object.assign(n,{allowTouchMove:n.params.allowTouchMove,allowSlideNext:n.params.allowSlideNext,allowSlidePrev:n.params.allowSlidePrev}),ne&&!ie?n.disable():!ne&&ie&&n.enable(),n.currentBreakpoint=F,n.emit("_beforeBreakpoint",G),s&&(pe?(n.loopDestroy(),n.loopCreate(r),n.updateSlides()):!se&&ce?(n.loopCreate(r),n.updateSlides()):se&&!ce&&n.loopDestroy()),n.emit("breakpoint",G)}function B7(n,r,s){if(r===void 0&&(r="window"),!n||r==="container"&&!s)return;let u=!1;const m=na(),y=r==="window"?m.innerHeight:s.clientHeight,T=Object.keys(n).map(i=>{if(typeof i=="string"&&i.indexOf("@")===0){const I=parseFloat(i.substr(1));return{value:y*I,point:i}}return{value:i,point:i}});T.sort((i,I)=>parseInt(i.value,10)-parseInt(I.value,10));for(let i=0;i<T.length;i+=1){const{point:I,value:F}=T[i];r==="window"?m.matchMedia(`(min-width: ${F}px)`).matches&&(u=I):F<=s.clientWidth&&(u=I)}return u||"max"}var N7={setBreakpoint:F7,getBreakpoint:B7};function j7(n,r){const s=[];return n.forEach(u=>{typeof u=="object"?Object.keys(u).forEach(m=>{u[m]&&s.push(r+m)}):typeof u=="string"&&s.push(r+u)}),s}function U7(){const n=this,{classNames:r,params:s,rtl:u,el:m,device:y}=n,T=j7(["initialized",s.direction,{"free-mode":n.params.freeMode&&s.freeMode.enabled},{autoheight:s.autoHeight},{rtl:u},{grid:s.grid&&s.grid.rows>1},{"grid-column":s.grid&&s.grid.rows>1&&s.grid.fill==="column"},{android:y.android},{ios:y.ios},{"css-mode":s.cssMode},{centered:s.cssMode&&s.centeredSlides},{"watch-progress":s.watchSlidesProgress}],s.containerModifierClass);r.push(...T),m.classList.add(...r),n.emitContainerClasses()}function $7(){const n=this,{el:r,classNames:s}=n;!r||typeof r=="string"||(r.classList.remove(...s),n.emitContainerClasses())}var V7={addClasses:U7,removeClasses:$7};function G7(){const n=this,{isLocked:r,params:s}=n,{slidesOffsetBefore:u}=s;if(u){const m=n.slides.length-1,y=n.slidesGrid[m]+n.slidesSizesGrid[m]+u*2;n.isLocked=n.size>y}else n.isLocked=n.snapGrid.length===1;s.allowSlideNext===!0&&(n.allowSlideNext=!n.isLocked),s.allowSlidePrev===!0&&(n.allowSlidePrev=!n.isLocked),r&&r!==n.isLocked&&(n.isEnd=!1),r!==n.isLocked&&n.emit(n.isLocked?"lock":"unlock")}var q7={checkOverflow:G7},iw={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function W7(n,r){return function(u){u===void 0&&(u={});const m=Object.keys(u)[0],y=u[m];if(typeof y!="object"||y===null){Ol(r,u);return}if(n[m]===!0&&(n[m]={enabled:!0}),m==="navigation"&&n[m]&&n[m].enabled&&!n[m].prevEl&&!n[m].nextEl&&(n[m].auto=!0),["pagination","scrollbar"].indexOf(m)>=0&&n[m]&&n[m].enabled&&!n[m].el&&(n[m].auto=!0),!(m in n&&"enabled"in y)){Ol(r,u);return}typeof n[m]=="object"&&!("enabled"in n[m])&&(n[m].enabled=!0),n[m]||(n[m]={enabled:!1}),Ol(r,u)}}const g1={eventsEmitter:Vq,update:e7,translate:s7,transition:u7,slide:y7,loop:w7,grabCursor:E7,events:O7,breakpoints:N7,checkOverflow:q7,classes:V7},_1={};let aS=class rh{constructor(){let r,s;for(var u=arguments.length,m=new Array(u),y=0;y<u;y++)m[y]=arguments[y];m.length===1&&m[0].constructor&&Object.prototype.toString.call(m[0]).slice(8,-1)==="Object"?s=m[0]:[r,s]=m,s||(s={}),s=Ol({},s),r&&!s.el&&(s.el=r);const T=mu();if(s.el&&typeof s.el=="string"&&T.querySelectorAll(s.el).length>1){const B=[];return T.querySelectorAll(s.el).forEach(G=>{const J=Ol({},s,{el:G});B.push(new rh(J))}),B}const i=this;i.__swiper__=!0,i.support=yR(),i.device=vR({userAgent:s.userAgent}),i.browser=xR(),i.eventsListeners={},i.eventsAnyListeners=[],i.modules=[...i.__modules__],s.modules&&Array.isArray(s.modules)&&i.modules.push(...s.modules);const I={};i.modules.forEach(B=>{B({params:s,swiper:i,extendParams:W7(s,I),on:i.on.bind(i),once:i.once.bind(i),off:i.off.bind(i),emit:i.emit.bind(i)})});const F=Ol({},iw,I);return i.params=Ol({},F,_1,s),i.originalParams=Ol({},i.params),i.passedParams=Ol({},s),i.params&&i.params.on&&Object.keys(i.params.on).forEach(B=>{i.on(B,i.params.on[B])}),i.params&&i.params.onAny&&i.onAny(i.params.onAny),Object.assign(i,{enabled:i.params.enabled,el:r,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return i.params.direction==="horizontal"},isVertical(){return i.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:i.params.allowSlideNext,allowSlidePrev:i.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:i.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:i.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),i.emit("_swiper"),i.params.init&&i.init(),i}getDirectionLabel(r){return this.isHorizontal()?r:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[r]}getSlideIndex(r){const{slidesEl:s,params:u}=this,m=wc(s,`.${u.slideClass}, swiper-slide`),y=nx(m[0]);return nx(r)-y}getSlideIndexByData(r){return this.getSlideIndex(this.slides.find(s=>s.getAttribute("data-swiper-slide-index")*1===r))}recalcSlides(){const r=this,{slidesEl:s,params:u}=r;r.slides=wc(s,`.${u.slideClass}, swiper-slide`)}enable(){const r=this;r.enabled||(r.enabled=!0,r.params.grabCursor&&r.setGrabCursor(),r.emit("enable"))}disable(){const r=this;r.enabled&&(r.enabled=!1,r.params.grabCursor&&r.unsetGrabCursor(),r.emit("disable"))}setProgress(r,s){const u=this;r=Math.min(Math.max(r,0),1);const m=u.minTranslate(),T=(u.maxTranslate()-m)*r+m;u.translateTo(T,typeof s>"u"?0:s),u.updateActiveIndex(),u.updateSlidesClasses()}emitContainerClasses(){const r=this;if(!r.params._emitClasses||!r.el)return;const s=r.el.className.split(" ").filter(u=>u.indexOf("swiper")===0||u.indexOf(r.params.containerModifierClass)===0);r.emit("_containerClasses",s.join(" "))}getSlideClasses(r){const s=this;return s.destroyed?"":r.className.split(" ").filter(u=>u.indexOf("swiper-slide")===0||u.indexOf(s.params.slideClass)===0).join(" ")}emitSlidesClasses(){const r=this;if(!r.params._emitClasses||!r.el)return;const s=[];r.slides.forEach(u=>{const m=r.getSlideClasses(u);s.push({slideEl:u,classNames:m}),r.emit("_slideClass",u,m)}),r.emit("_slideClasses",s)}slidesPerViewDynamic(r,s){r===void 0&&(r="current"),s===void 0&&(s=!1);const u=this,{params:m,slides:y,slidesGrid:T,slidesSizesGrid:i,size:I,activeIndex:F}=u;let B=1;if(typeof m.slidesPerView=="number")return m.slidesPerView;if(m.centeredSlides){let G=y[F]?Math.ceil(y[F].swiperSlideSize):0,J;for(let te=F+1;te<y.length;te+=1)y[te]&&!J&&(G+=Math.ceil(y[te].swiperSlideSize),B+=1,G>I&&(J=!0));for(let te=F-1;te>=0;te-=1)y[te]&&!J&&(G+=y[te].swiperSlideSize,B+=1,G>I&&(J=!0))}else if(r==="current")for(let G=F+1;G<y.length;G+=1)(s?T[G]+i[G]-T[F]<I:T[G]-T[F]<I)&&(B+=1);else for(let G=F-1;G>=0;G-=1)T[F]-T[G]<I&&(B+=1);return B}update(){const r=this;if(!r||r.destroyed)return;const{snapGrid:s,params:u}=r;u.breakpoints&&r.setBreakpoint(),[...r.el.querySelectorAll('[loading="lazy"]')].forEach(T=>{T.complete&&Nv(r,T)}),r.updateSize(),r.updateSlides(),r.updateProgress(),r.updateSlidesClasses();function m(){const T=r.rtlTranslate?r.translate*-1:r.translate,i=Math.min(Math.max(T,r.maxTranslate()),r.minTranslate());r.setTranslate(i),r.updateActiveIndex(),r.updateSlidesClasses()}let y;if(u.freeMode&&u.freeMode.enabled&&!u.cssMode)m(),u.autoHeight&&r.updateAutoHeight();else{if((u.slidesPerView==="auto"||u.slidesPerView>1)&&r.isEnd&&!u.centeredSlides){const T=r.virtual&&u.virtual.enabled?r.virtual.slides:r.slides;y=r.slideTo(T.length-1,0,!1,!0)}else y=r.slideTo(r.activeIndex,0,!1,!0);y||m()}u.watchOverflow&&s!==r.snapGrid&&r.checkOverflow(),r.emit("update")}changeDirection(r,s){s===void 0&&(s=!0);const u=this,m=u.params.direction;return r||(r=m==="horizontal"?"vertical":"horizontal"),r===m||r!=="horizontal"&&r!=="vertical"||(u.el.classList.remove(`${u.params.containerModifierClass}${m}`),u.el.classList.add(`${u.params.containerModifierClass}${r}`),u.emitContainerClasses(),u.params.direction=r,u.slides.forEach(y=>{r==="vertical"?y.style.width="":y.style.height=""}),u.emit("changeDirection"),s&&u.update()),u}changeLanguageDirection(r){const s=this;s.rtl&&r==="rtl"||!s.rtl&&r==="ltr"||(s.rtl=r==="rtl",s.rtlTranslate=s.params.direction==="horizontal"&&s.rtl,s.rtl?(s.el.classList.add(`${s.params.containerModifierClass}rtl`),s.el.dir="rtl"):(s.el.classList.remove(`${s.params.containerModifierClass}rtl`),s.el.dir="ltr"),s.update())}mount(r){const s=this;if(s.mounted)return!0;let u=r||s.params.el;if(typeof u=="string"&&(u=document.querySelector(u)),!u)return!1;u.swiper=s,u.parentNode&&u.parentNode.host&&u.parentNode.host.nodeName===s.params.swiperElementNodeName.toUpperCase()&&(s.isElement=!0);const m=()=>`.${(s.params.wrapperClass||"").trim().split(" ").join(".")}`;let T=u&&u.shadowRoot&&u.shadowRoot.querySelector?u.shadowRoot.querySelector(m()):wc(u,m())[0];return!T&&s.params.createElements&&(T=J_("div",s.params.wrapperClass),u.append(T),wc(u,`.${s.params.slideClass}`).forEach(i=>{T.append(i)})),Object.assign(s,{el:u,wrapperEl:T,slidesEl:s.isElement&&!u.parentNode.host.slideSlots?u.parentNode.host:T,hostEl:s.isElement?u.parentNode.host:u,mounted:!0,rtl:u.dir.toLowerCase()==="rtl"||bp(u,"direction")==="rtl",rtlTranslate:s.params.direction==="horizontal"&&(u.dir.toLowerCase()==="rtl"||bp(u,"direction")==="rtl"),wrongRTL:bp(T,"display")==="-webkit-box"}),!0}init(r){const s=this;if(s.initialized||s.mount(r)===!1)return s;s.emit("beforeInit"),s.params.breakpoints&&s.setBreakpoint(),s.addClasses(),s.updateSize(),s.updateSlides(),s.params.watchOverflow&&s.checkOverflow(),s.params.grabCursor&&s.enabled&&s.setGrabCursor(),s.params.loop&&s.virtual&&s.params.virtual.enabled?s.slideTo(s.params.initialSlide+s.virtual.slidesBefore,0,s.params.runCallbacksOnInit,!1,!0):s.slideTo(s.params.initialSlide,0,s.params.runCallbacksOnInit,!1,!0),s.params.loop&&s.loopCreate(),s.attachEvents();const m=[...s.el.querySelectorAll('[loading="lazy"]')];return s.isElement&&m.push(...s.hostEl.querySelectorAll('[loading="lazy"]')),m.forEach(y=>{y.complete?Nv(s,y):y.addEventListener("load",T=>{Nv(s,T.target)})}),rw(s),s.initialized=!0,rw(s),s.emit("init"),s.emit("afterInit"),s}destroy(r,s){r===void 0&&(r=!0),s===void 0&&(s=!0);const u=this,{params:m,el:y,wrapperEl:T,slides:i}=u;return typeof u.params>"u"||u.destroyed||(u.emit("beforeDestroy"),u.initialized=!1,u.detachEvents(),m.loop&&u.loopDestroy(),s&&(u.removeClasses(),y&&typeof y!="string"&&y.removeAttribute("style"),T&&T.removeAttribute("style"),i&&i.length&&i.forEach(I=>{I.classList.remove(m.slideVisibleClass,m.slideFullyVisibleClass,m.slideActiveClass,m.slideNextClass,m.slidePrevClass),I.removeAttribute("style"),I.removeAttribute("data-swiper-slide-index")})),u.emit("destroy"),Object.keys(u.eventsListeners).forEach(I=>{u.off(I)}),r!==!1&&(u.el&&typeof u.el!="string"&&(u.el.swiper=null),Pq(u)),u.destroyed=!0),null}static extendDefaults(r){Ol(_1,r)}static get extendedDefaults(){return _1}static get defaults(){return iw}static installModule(r){rh.prototype.__modules__||(rh.prototype.__modules__=[]);const s=rh.prototype.__modules__;typeof r=="function"&&s.indexOf(r)<0&&s.push(r)}static use(r){return Array.isArray(r)?(r.forEach(s=>rh.installModule(s)),rh):(rh.installModule(r),rh)}};Object.keys(g1).forEach(n=>{Object.keys(g1[n]).forEach(r=>{aS.prototype[r]=g1[n][r]})});aS.use([Uq,$q]);const SR=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function jf(n){return typeof n=="object"&&n!==null&&n.constructor&&Object.prototype.toString.call(n).slice(8,-1)==="Object"&&!n.__swiper__}function Km(n,r){const s=["__proto__","constructor","prototype"];Object.keys(r).filter(u=>s.indexOf(u)<0).forEach(u=>{typeof n[u]>"u"?n[u]=r[u]:jf(r[u])&&jf(n[u])&&Object.keys(r[u]).length>0?r[u].__swiper__?n[u]=r[u]:Km(n[u],r[u]):n[u]=r[u]})}function TR(n){return n===void 0&&(n={}),n.navigation&&typeof n.navigation.nextEl>"u"&&typeof n.navigation.prevEl>"u"}function ER(n){return n===void 0&&(n={}),n.pagination&&typeof n.pagination.el>"u"}function CR(n){return n===void 0&&(n={}),n.scrollbar&&typeof n.scrollbar.el>"u"}function MR(n){n===void 0&&(n="");const r=n.split(" ").map(u=>u.trim()).filter(u=>!!u),s=[];return r.forEach(u=>{s.indexOf(u)<0&&s.push(u)}),s.join(" ")}function H7(n){return n===void 0&&(n=""),n?n.includes("swiper-wrapper")?n:`swiper-wrapper ${n}`:"swiper-wrapper"}function Z7(n){let{swiper:r,slides:s,passedParams:u,changedParams:m,nextEl:y,prevEl:T,scrollbarEl:i,paginationEl:I}=n;const F=m.filter(Ze=>Ze!=="children"&&Ze!=="direction"&&Ze!=="wrapperClass"),{params:B,pagination:G,navigation:J,scrollbar:te,virtual:H,thumbs:j}=r;let ne,oe,pe,se,ie,ce,we,xe;m.includes("thumbs")&&u.thumbs&&u.thumbs.swiper&&!u.thumbs.swiper.destroyed&&B.thumbs&&(!B.thumbs.swiper||B.thumbs.swiper.destroyed)&&(ne=!0),m.includes("controller")&&u.controller&&u.controller.control&&B.controller&&!B.controller.control&&(oe=!0),m.includes("pagination")&&u.pagination&&(u.pagination.el||I)&&(B.pagination||B.pagination===!1)&&G&&!G.el&&(pe=!0),m.includes("scrollbar")&&u.scrollbar&&(u.scrollbar.el||i)&&(B.scrollbar||B.scrollbar===!1)&&te&&!te.el&&(se=!0),m.includes("navigation")&&u.navigation&&(u.navigation.prevEl||T)&&(u.navigation.nextEl||y)&&(B.navigation||B.navigation===!1)&&J&&!J.prevEl&&!J.nextEl&&(ie=!0);const $e=Ze=>{r[Ze]&&(r[Ze].destroy(),Ze==="navigation"?(r.isElement&&(r[Ze].prevEl.remove(),r[Ze].nextEl.remove()),B[Ze].prevEl=void 0,B[Ze].nextEl=void 0,r[Ze].prevEl=void 0,r[Ze].nextEl=void 0):(r.isElement&&r[Ze].el.remove(),B[Ze].el=void 0,r[Ze].el=void 0))};m.includes("loop")&&r.isElement&&(B.loop&&!u.loop?ce=!0:!B.loop&&u.loop?we=!0:xe=!0),F.forEach(Ze=>{if(jf(B[Ze])&&jf(u[Ze]))Object.assign(B[Ze],u[Ze]),(Ze==="navigation"||Ze==="pagination"||Ze==="scrollbar")&&"enabled"in u[Ze]&&!u[Ze].enabled&&$e(Ze);else{const ae=u[Ze];(ae===!0||ae===!1)&&(Ze==="navigation"||Ze==="pagination"||Ze==="scrollbar")?ae===!1&&$e(Ze):B[Ze]=u[Ze]}}),F.includes("controller")&&!oe&&r.controller&&r.controller.control&&B.controller&&B.controller.control&&(r.controller.control=B.controller.control),m.includes("children")&&s&&H&&B.virtual.enabled?(H.slides=s,H.update(!0)):m.includes("virtual")&&H&&B.virtual.enabled&&(s&&(H.slides=s),H.update(!0)),m.includes("children")&&s&&B.loop&&(xe=!0),ne&&j.init()&&j.update(!0),oe&&(r.controller.control=B.controller.control),pe&&(r.isElement&&(!I||typeof I=="string")&&(I=document.createElement("div"),I.classList.add("swiper-pagination"),I.part.add("pagination"),r.el.appendChild(I)),I&&(B.pagination.el=I),G.init(),G.render(),G.update()),se&&(r.isElement&&(!i||typeof i=="string")&&(i=document.createElement("div"),i.classList.add("swiper-scrollbar"),i.part.add("scrollbar"),r.el.appendChild(i)),i&&(B.scrollbar.el=i),te.init(),te.updateSize(),te.setTranslate()),ie&&(r.isElement&&((!y||typeof y=="string")&&(y=document.createElement("div"),y.classList.add("swiper-button-next"),y.innerHTML=r.hostEl.constructor.nextButtonSvg,y.part.add("button-next"),r.el.appendChild(y)),(!T||typeof T=="string")&&(T=document.createElement("div"),T.classList.add("swiper-button-prev"),T.innerHTML=r.hostEl.constructor.prevButtonSvg,T.part.add("button-prev"),r.el.appendChild(T))),y&&(B.navigation.nextEl=y),T&&(B.navigation.prevEl=T),J.init(),J.update()),m.includes("allowSlideNext")&&(r.allowSlideNext=u.allowSlideNext),m.includes("allowSlidePrev")&&(r.allowSlidePrev=u.allowSlidePrev),m.includes("direction")&&r.changeDirection(u.direction,!1),(ce||xe)&&r.loopDestroy(),(we||xe)&&r.loopCreate(),r.update()}function X7(n,r){n===void 0&&(n={}),r===void 0&&(r=!0);const s={on:{}},u={},m={};Km(s,iw),s._emitClasses=!0,s.init=!1;const y={},T=SR.map(I=>I.replace(/_/,"")),i=Object.assign({},n);return Object.keys(i).forEach(I=>{typeof n[I]>"u"||(T.indexOf(I)>=0?jf(n[I])?(s[I]={},m[I]={},Km(s[I],n[I]),Km(m[I],n[I])):(s[I]=n[I],m[I]=n[I]):I.search(/on[A-Z]/)===0&&typeof n[I]=="function"?r?u[`${I[2].toLowerCase()}${I.substr(3)}`]=n[I]:s.on[`${I[2].toLowerCase()}${I.substr(3)}`]=n[I]:y[I]=n[I])}),["navigation","pagination","scrollbar"].forEach(I=>{s[I]===!0&&(s[I]={}),s[I]===!1&&delete s[I]}),{params:s,passedParams:m,rest:y,events:u}}function Y7(n,r){let{el:s,nextEl:u,prevEl:m,paginationEl:y,scrollbarEl:T,swiper:i}=n;TR(r)&&u&&m&&(i.params.navigation.nextEl=u,i.originalParams.navigation.nextEl=u,i.params.navigation.prevEl=m,i.originalParams.navigation.prevEl=m),ER(r)&&y&&(i.params.pagination.el=y,i.originalParams.pagination.el=y),CR(r)&&T&&(i.params.scrollbar.el=T,i.originalParams.scrollbar.el=T),i.init(s)}function K7(n,r,s,u,m){const y=[];if(!r)return y;const T=I=>{y.indexOf(I)<0&&y.push(I)};if(s&&u){const I=u.map(m),F=s.map(m);I.join("")!==F.join("")&&T("children"),u.length!==s.length&&T("children")}return SR.filter(I=>I[0]==="_").map(I=>I.replace(/_/,"")).forEach(I=>{if(I in n&&I in r)if(jf(n[I])&&jf(r[I])){const F=Object.keys(n[I]),B=Object.keys(r[I]);F.length!==B.length?T(I):(F.forEach(G=>{n[I][G]!==r[I][G]&&T(I)}),B.forEach(G=>{n[I][G]!==r[I][G]&&T(I)}))}else n[I]!==r[I]&&T(I)}),y}const J7=n=>{!n||n.destroyed||!n.params.virtual||n.params.virtual&&!n.params.virtual.enabled||(n.updateSlides(),n.updateProgress(),n.updateSlidesClasses(),n.parallax&&n.params.parallax&&n.params.parallax.enabled&&n.parallax.setTranslate())};function rx(){return rx=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(n[u]=s[u])}return n},rx.apply(this,arguments)}function IR(n){return n.type&&n.type.displayName&&n.type.displayName.includes("SwiperSlide")}function AR(n){const r=[];return Vi.Children.toArray(n).forEach(s=>{IR(s)?r.push(s):s.props&&s.props.children&&AR(s.props.children).forEach(u=>r.push(u))}),r}function Q7(n){const r=[],s={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return Vi.Children.toArray(n).forEach(u=>{if(IR(u))r.push(u);else if(u.props&&u.props.slot&&s[u.props.slot])s[u.props.slot].push(u);else if(u.props&&u.props.children){const m=AR(u.props.children);m.length>0?m.forEach(y=>r.push(y)):s["container-end"].push(u)}else s["container-end"].push(u)}),{slides:r,slots:s}}function eW(n,r,s){if(!s)return null;const u=B=>{let G=B;return B<0?G=r.length+B:G>=r.length&&(G=G-r.length),G},m=n.isHorizontal()?{[n.rtlTranslate?"right":"left"]:`${s.offset}px`}:{top:`${s.offset}px`},{from:y,to:T}=s,i=n.params.loop?-r.length:0,I=n.params.loop?r.length*2:r.length,F=[];for(let B=i;B<I;B+=1)B>=y&&B<=T&&F.push(r[u(B)]);return F.map((B,G)=>Vi.cloneElement(B,{swiper:n,style:m,key:B.props.virtualIndex||B.key||`slide-${G}`}))}function U_(n,r){return typeof window>"u"?fe.useEffect(n,r):fe.useLayoutEffect(n,r)}const FI=fe.createContext(null),tW=fe.createContext(null),lS=fe.forwardRef(function(n,r){let{className:s,tag:u="div",wrapperTag:m="div",children:y,onSwiper:T,...i}=n===void 0?{}:n,I=!1;const[F,B]=fe.useState("swiper"),[G,J]=fe.useState(null),[te,H]=fe.useState(!1),j=fe.useRef(!1),ne=fe.useRef(null),oe=fe.useRef(null),pe=fe.useRef(null),se=fe.useRef(null),ie=fe.useRef(null),ce=fe.useRef(null),we=fe.useRef(null),xe=fe.useRef(null),{params:$e,passedParams:Ze,rest:ae,events:ke}=X7(i),{slides:ct,slots:Xe}=Q7(y),st=()=>{H(!te)};Object.assign($e.on,{_containerClasses(Ye,Bt){B(Bt)}});const et=()=>{Object.assign($e.on,ke),I=!0;const Ye={...$e};if(delete Ye.wrapperClass,oe.current=new aS(Ye),oe.current.virtual&&oe.current.params.virtual.enabled){oe.current.virtual.slides=ct;const Bt={cache:!1,slides:ct,renderExternal:J,renderExternalUpdate:!1};Km(oe.current.params.virtual,Bt),Km(oe.current.originalParams.virtual,Bt)}};ne.current||et(),oe.current&&oe.current.on("_beforeBreakpoint",st);const gt=()=>{I||!ke||!oe.current||Object.keys(ke).forEach(Ye=>{oe.current.on(Ye,ke[Ye])})},zt=()=>{!ke||!oe.current||Object.keys(ke).forEach(Ye=>{oe.current.off(Ye,ke[Ye])})};fe.useEffect(()=>()=>{oe.current&&oe.current.off("_beforeBreakpoint",st)}),fe.useEffect(()=>{!j.current&&oe.current&&(oe.current.emitSlidesClasses(),j.current=!0)}),U_(()=>{if(r&&(r.current=ne.current),!!ne.current)return oe.current.destroyed&&et(),Y7({el:ne.current,nextEl:ie.current,prevEl:ce.current,paginationEl:we.current,scrollbarEl:xe.current,swiper:oe.current},$e),T&&!oe.current.destroyed&&T(oe.current),()=>{oe.current&&!oe.current.destroyed&&oe.current.destroy(!0,!1)}},[]),U_(()=>{gt();const Ye=K7(Ze,pe.current,ct,se.current,Bt=>Bt.key);return pe.current=Ze,se.current=ct,Ye.length&&oe.current&&!oe.current.destroyed&&Z7({swiper:oe.current,slides:ct,passedParams:Ze,changedParams:Ye,nextEl:ie.current,prevEl:ce.current,scrollbarEl:xe.current,paginationEl:we.current}),()=>{zt()}}),U_(()=>{J7(oe.current)},[G]);function at(){return $e.virtual?eW(oe.current,ct,G):ct.map((Ye,Bt)=>Vi.cloneElement(Ye,{swiper:oe.current,swiperSlideIndex:Bt}))}return Vi.createElement(u,rx({ref:ne,className:MR(`${F}${s?` ${s}`:""}`)},ae),Vi.createElement(tW.Provider,{value:oe.current},Xe["container-start"],Vi.createElement(m,{className:H7($e.wrapperClass)},Xe["wrapper-start"],at(),Xe["wrapper-end"]),TR($e)&&Vi.createElement(Vi.Fragment,null,Vi.createElement("div",{ref:ce,className:"swiper-button-prev"}),Vi.createElement("div",{ref:ie,className:"swiper-button-next"})),CR($e)&&Vi.createElement("div",{ref:xe,className:"swiper-scrollbar"}),ER($e)&&Vi.createElement("div",{ref:we,className:"swiper-pagination"}),Xe["container-end"]))});lS.displayName="Swiper";const cS=fe.forwardRef(function(n,r){let{tag:s="div",children:u,className:m="",swiper:y,zoom:T,lazy:i,virtualIndex:I,swiperSlideIndex:F,...B}=n===void 0?{}:n;const G=fe.useRef(null),[J,te]=fe.useState("swiper-slide"),[H,j]=fe.useState(!1);function ne(ie,ce,we){ce===G.current&&te(we)}U_(()=>{if(typeof F<"u"&&(G.current.swiperSlideIndex=F),r&&(r.current=G.current),!(!G.current||!y)){if(y.destroyed){J!=="swiper-slide"&&te("swiper-slide");return}return y.on("_slideClass",ne),()=>{y&&y.off("_slideClass",ne)}}}),U_(()=>{y&&G.current&&!y.destroyed&&te(y.getSlideClasses(G.current))},[y]);const oe={isActive:J.indexOf("swiper-slide-active")>=0,isVisible:J.indexOf("swiper-slide-visible")>=0,isPrev:J.indexOf("swiper-slide-prev")>=0,isNext:J.indexOf("swiper-slide-next")>=0},pe=()=>typeof u=="function"?u(oe):u,se=()=>{j(!0)};return Vi.createElement(s,rx({ref:G,className:MR(`${J}${m?` ${m}`:""}`),"data-swiper-slide-index":I,onLoad:se},B),T&&Vi.createElement(FI.Provider,{value:oe},Vi.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof T=="number"?T:void 0},pe(),i&&!H&&Vi.createElement("div",{className:"swiper-lazy-preloader"}))),!T&&Vi.createElement(FI.Provider,{value:oe},pe(),i&&!H&&Vi.createElement("div",{className:"swiper-lazy-preloader"})))});cS.displayName="SwiperSlide";function PR(n,r,s,u){return n.params.createElements&&Object.keys(u).forEach(m=>{if(!s[m]&&s.auto===!0){let y=wc(n.el,`.${u[m]}`)[0];y||(y=J_("div",u[m]),y.className=u[m],n.el.append(y)),s[m]=y,r[m]=y}}),s}function nW(n){let{swiper:r,extendParams:s,on:u,emit:m}=n;s({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),r.navigation={nextEl:null,prevEl:null};function y(H){let j;return H&&typeof H=="string"&&r.isElement&&(j=r.el.querySelector(H)||r.hostEl.querySelector(H),j)?j:(H&&(typeof H=="string"&&(j=[...document.querySelectorAll(H)]),r.params.uniqueNavElements&&typeof H=="string"&&j&&j.length>1&&r.el.querySelectorAll(H).length===1?j=r.el.querySelector(H):j&&j.length===1&&(j=j[0])),H&&!j?H:j)}function T(H,j){const ne=r.params.navigation;H=Rs(H),H.forEach(oe=>{oe&&(oe.classList[j?"add":"remove"](...ne.disabledClass.split(" ")),oe.tagName==="BUTTON"&&(oe.disabled=j),r.params.watchOverflow&&r.enabled&&oe.classList[r.isLocked?"add":"remove"](ne.lockClass))})}function i(){const{nextEl:H,prevEl:j}=r.navigation;if(r.params.loop){T(j,!1),T(H,!1);return}T(j,r.isBeginning&&!r.params.rewind),T(H,r.isEnd&&!r.params.rewind)}function I(H){H.preventDefault(),!(r.isBeginning&&!r.params.loop&&!r.params.rewind)&&(r.slidePrev(),m("navigationPrev"))}function F(H){H.preventDefault(),!(r.isEnd&&!r.params.loop&&!r.params.rewind)&&(r.slideNext(),m("navigationNext"))}function B(){const H=r.params.navigation;if(r.params.navigation=PR(r,r.originalParams.navigation,r.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(H.nextEl||H.prevEl))return;let j=y(H.nextEl),ne=y(H.prevEl);Object.assign(r.navigation,{nextEl:j,prevEl:ne}),j=Rs(j),ne=Rs(ne);const oe=(pe,se)=>{pe&&pe.addEventListener("click",se==="next"?F:I),!r.enabled&&pe&&pe.classList.add(...H.lockClass.split(" "))};j.forEach(pe=>oe(pe,"next")),ne.forEach(pe=>oe(pe,"prev"))}function G(){let{nextEl:H,prevEl:j}=r.navigation;H=Rs(H),j=Rs(j);const ne=(oe,pe)=>{oe.removeEventListener("click",pe==="next"?F:I),oe.classList.remove(...r.params.navigation.disabledClass.split(" "))};H.forEach(oe=>ne(oe,"next")),j.forEach(oe=>ne(oe,"prev"))}u("init",()=>{r.params.navigation.enabled===!1?te():(B(),i())}),u("toEdge fromEdge lock unlock",()=>{i()}),u("destroy",()=>{G()}),u("enable disable",()=>{let{nextEl:H,prevEl:j}=r.navigation;if(H=Rs(H),j=Rs(j),r.enabled){i();return}[...H,...j].filter(ne=>!!ne).forEach(ne=>ne.classList.add(r.params.navigation.lockClass))}),u("click",(H,j)=>{let{nextEl:ne,prevEl:oe}=r.navigation;ne=Rs(ne),oe=Rs(oe);const pe=j.target;let se=oe.includes(pe)||ne.includes(pe);if(r.isElement&&!se){const ie=j.path||j.composedPath&&j.composedPath();ie&&(se=ie.find(ce=>ne.includes(ce)||oe.includes(ce)))}if(r.params.navigation.hideOnClick&&!se){if(r.pagination&&r.params.pagination&&r.params.pagination.clickable&&(r.pagination.el===pe||r.pagination.el.contains(pe)))return;let ie;ne.length?ie=ne[0].classList.contains(r.params.navigation.hiddenClass):oe.length&&(ie=oe[0].classList.contains(r.params.navigation.hiddenClass)),m(ie===!0?"navigationShow":"navigationHide"),[...ne,...oe].filter(ce=>!!ce).forEach(ce=>ce.classList.toggle(r.params.navigation.hiddenClass))}});const J=()=>{r.el.classList.remove(...r.params.navigation.navigationDisabledClass.split(" ")),B(),i()},te=()=>{r.el.classList.add(...r.params.navigation.navigationDisabledClass.split(" ")),G()};Object.assign(r.navigation,{enable:J,disable:te,update:i,init:B,destroy:G})}function w_(n){return n===void 0&&(n=""),`.${n.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function rW(n){let{swiper:r,extendParams:s,on:u,emit:m}=n;const y="swiper-pagination";s({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:pe=>pe,formatFractionTotal:pe=>pe,bulletClass:`${y}-bullet`,bulletActiveClass:`${y}-bullet-active`,modifierClass:`${y}-`,currentClass:`${y}-current`,totalClass:`${y}-total`,hiddenClass:`${y}-hidden`,progressbarFillClass:`${y}-progressbar-fill`,progressbarOppositeClass:`${y}-progressbar-opposite`,clickableClass:`${y}-clickable`,lockClass:`${y}-lock`,horizontalClass:`${y}-horizontal`,verticalClass:`${y}-vertical`,paginationDisabledClass:`${y}-disabled`}}),r.pagination={el:null,bullets:[]};let T,i=0;function I(){return!r.params.pagination.el||!r.pagination.el||Array.isArray(r.pagination.el)&&r.pagination.el.length===0}function F(pe,se){const{bulletActiveClass:ie}=r.params.pagination;pe&&(pe=pe[`${se==="prev"?"previous":"next"}ElementSibling`],pe&&(pe.classList.add(`${ie}-${se}`),pe=pe[`${se==="prev"?"previous":"next"}ElementSibling`],pe&&pe.classList.add(`${ie}-${se}-${se}`)))}function B(pe,se,ie){if(pe=pe%ie,se=se%ie,se===pe+1)return"next";if(se===pe-1)return"previous"}function G(pe){const se=pe.target.closest(w_(r.params.pagination.bulletClass));if(!se)return;pe.preventDefault();const ie=nx(se)*r.params.slidesPerGroup;if(r.params.loop){if(r.realIndex===ie)return;const ce=B(r.realIndex,ie,r.slides.length);ce==="next"?r.slideNext():ce==="previous"?r.slidePrev():r.slideToLoop(ie)}else r.slideTo(ie)}function J(){const pe=r.rtl,se=r.params.pagination;if(I())return;let ie=r.pagination.el;ie=Rs(ie);let ce,we;const xe=r.virtual&&r.params.virtual.enabled?r.virtual.slides.length:r.slides.length,$e=r.params.loop?Math.ceil(xe/r.params.slidesPerGroup):r.snapGrid.length;if(r.params.loop?(we=r.previousRealIndex||0,ce=r.params.slidesPerGroup>1?Math.floor(r.realIndex/r.params.slidesPerGroup):r.realIndex):typeof r.snapIndex<"u"?(ce=r.snapIndex,we=r.previousSnapIndex):(we=r.previousIndex||0,ce=r.activeIndex||0),se.type==="bullets"&&r.pagination.bullets&&r.pagination.bullets.length>0){const Ze=r.pagination.bullets;let ae,ke,ct;if(se.dynamicBullets&&(T=nw(Ze[0],r.isHorizontal()?"width":"height"),ie.forEach(Xe=>{Xe.style[r.isHorizontal()?"width":"height"]=`${T*(se.dynamicMainBullets+4)}px`}),se.dynamicMainBullets>1&&we!==void 0&&(i+=ce-(we||0),i>se.dynamicMainBullets-1?i=se.dynamicMainBullets-1:i<0&&(i=0)),ae=Math.max(ce-i,0),ke=ae+(Math.min(Ze.length,se.dynamicMainBullets)-1),ct=(ke+ae)/2),Ze.forEach(Xe=>{const st=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(et=>`${se.bulletActiveClass}${et}`)].map(et=>typeof et=="string"&&et.includes(" ")?et.split(" "):et).flat();Xe.classList.remove(...st)}),ie.length>1)Ze.forEach(Xe=>{const st=nx(Xe);st===ce?Xe.classList.add(...se.bulletActiveClass.split(" ")):r.isElement&&Xe.setAttribute("part","bullet"),se.dynamicBullets&&(st>=ae&&st<=ke&&Xe.classList.add(...`${se.bulletActiveClass}-main`.split(" ")),st===ae&&F(Xe,"prev"),st===ke&&F(Xe,"next"))});else{const Xe=Ze[ce];if(Xe&&Xe.classList.add(...se.bulletActiveClass.split(" ")),r.isElement&&Ze.forEach((st,et)=>{st.setAttribute("part",et===ce?"bullet-active":"bullet")}),se.dynamicBullets){const st=Ze[ae],et=Ze[ke];for(let gt=ae;gt<=ke;gt+=1)Ze[gt]&&Ze[gt].classList.add(...`${se.bulletActiveClass}-main`.split(" "));F(st,"prev"),F(et,"next")}}if(se.dynamicBullets){const Xe=Math.min(Ze.length,se.dynamicMainBullets+4),st=(T*Xe-T)/2-ct*T,et=pe?"right":"left";Ze.forEach(gt=>{gt.style[r.isHorizontal()?et:"top"]=`${st}px`})}}ie.forEach((Ze,ae)=>{if(se.type==="fraction"&&(Ze.querySelectorAll(w_(se.currentClass)).forEach(ke=>{ke.textContent=se.formatFractionCurrent(ce+1)}),Ze.querySelectorAll(w_(se.totalClass)).forEach(ke=>{ke.textContent=se.formatFractionTotal($e)})),se.type==="progressbar"){let ke;se.progressbarOpposite?ke=r.isHorizontal()?"vertical":"horizontal":ke=r.isHorizontal()?"horizontal":"vertical";const ct=(ce+1)/$e;let Xe=1,st=1;ke==="horizontal"?Xe=ct:st=ct,Ze.querySelectorAll(w_(se.progressbarFillClass)).forEach(et=>{et.style.transform=`translate3d(0,0,0) scaleX(${Xe}) scaleY(${st})`,et.style.transitionDuration=`${r.params.speed}ms`})}se.type==="custom"&&se.renderCustom?(Ze.innerHTML=se.renderCustom(r,ce+1,$e),ae===0&&m("paginationRender",Ze)):(ae===0&&m("paginationRender",Ze),m("paginationUpdate",Ze)),r.params.watchOverflow&&r.enabled&&Ze.classList[r.isLocked?"add":"remove"](se.lockClass)})}function te(){const pe=r.params.pagination;if(I())return;const se=r.virtual&&r.params.virtual.enabled?r.virtual.slides.length:r.grid&&r.params.grid.rows>1?r.slides.length/Math.ceil(r.params.grid.rows):r.slides.length;let ie=r.pagination.el;ie=Rs(ie);let ce="";if(pe.type==="bullets"){let we=r.params.loop?Math.ceil(se/r.params.slidesPerGroup):r.snapGrid.length;r.params.freeMode&&r.params.freeMode.enabled&&we>se&&(we=se);for(let xe=0;xe<we;xe+=1)pe.renderBullet?ce+=pe.renderBullet.call(r,xe,pe.bulletClass):ce+=`<${pe.bulletElement} ${r.isElement?'part="bullet"':""} class="${pe.bulletClass}"></${pe.bulletElement}>`}pe.type==="fraction"&&(pe.renderFraction?ce=pe.renderFraction.call(r,pe.currentClass,pe.totalClass):ce=`<span class="${pe.currentClass}"></span> / <span class="${pe.totalClass}"></span>`),pe.type==="progressbar"&&(pe.renderProgressbar?ce=pe.renderProgressbar.call(r,pe.progressbarFillClass):ce=`<span class="${pe.progressbarFillClass}"></span>`),r.pagination.bullets=[],ie.forEach(we=>{pe.type!=="custom"&&(we.innerHTML=ce||""),pe.type==="bullets"&&r.pagination.bullets.push(...we.querySelectorAll(w_(pe.bulletClass)))}),pe.type!=="custom"&&m("paginationRender",ie[0])}function H(){r.params.pagination=PR(r,r.originalParams.pagination,r.params.pagination,{el:"swiper-pagination"});const pe=r.params.pagination;if(!pe.el)return;let se;typeof pe.el=="string"&&r.isElement&&(se=r.el.querySelector(pe.el)),!se&&typeof pe.el=="string"&&(se=[...document.querySelectorAll(pe.el)]),se||(se=pe.el),!(!se||se.length===0)&&(r.params.uniqueNavElements&&typeof pe.el=="string"&&Array.isArray(se)&&se.length>1&&(se=[...r.el.querySelectorAll(pe.el)],se.length>1&&(se=se.find(ie=>j_(ie,".swiper")[0]===r.el))),Array.isArray(se)&&se.length===1&&(se=se[0]),Object.assign(r.pagination,{el:se}),se=Rs(se),se.forEach(ie=>{pe.type==="bullets"&&pe.clickable&&ie.classList.add(...(pe.clickableClass||"").split(" ")),ie.classList.add(pe.modifierClass+pe.type),ie.classList.add(r.isHorizontal()?pe.horizontalClass:pe.verticalClass),pe.type==="bullets"&&pe.dynamicBullets&&(ie.classList.add(`${pe.modifierClass}${pe.type}-dynamic`),i=0,pe.dynamicMainBullets<1&&(pe.dynamicMainBullets=1)),pe.type==="progressbar"&&pe.progressbarOpposite&&ie.classList.add(pe.progressbarOppositeClass),pe.clickable&&ie.addEventListener("click",G),r.enabled||ie.classList.add(pe.lockClass)}))}function j(){const pe=r.params.pagination;if(I())return;let se=r.pagination.el;se&&(se=Rs(se),se.forEach(ie=>{ie.classList.remove(pe.hiddenClass),ie.classList.remove(pe.modifierClass+pe.type),ie.classList.remove(r.isHorizontal()?pe.horizontalClass:pe.verticalClass),pe.clickable&&(ie.classList.remove(...(pe.clickableClass||"").split(" ")),ie.removeEventListener("click",G))})),r.pagination.bullets&&r.pagination.bullets.forEach(ie=>ie.classList.remove(...pe.bulletActiveClass.split(" ")))}u("changeDirection",()=>{if(!r.pagination||!r.pagination.el)return;const pe=r.params.pagination;let{el:se}=r.pagination;se=Rs(se),se.forEach(ie=>{ie.classList.remove(pe.horizontalClass,pe.verticalClass),ie.classList.add(r.isHorizontal()?pe.horizontalClass:pe.verticalClass)})}),u("init",()=>{r.params.pagination.enabled===!1?oe():(H(),te(),J())}),u("activeIndexChange",()=>{typeof r.snapIndex>"u"&&J()}),u("snapIndexChange",()=>{J()}),u("snapGridLengthChange",()=>{te(),J()}),u("destroy",()=>{j()}),u("enable disable",()=>{let{el:pe}=r.pagination;pe&&(pe=Rs(pe),pe.forEach(se=>se.classList[r.enabled?"remove":"add"](r.params.pagination.lockClass)))}),u("lock unlock",()=>{J()}),u("click",(pe,se)=>{const ie=se.target,ce=Rs(r.pagination.el);if(r.params.pagination.el&&r.params.pagination.hideOnClick&&ce&&ce.length>0&&!ie.classList.contains(r.params.pagination.bulletClass)){if(r.navigation&&(r.navigation.nextEl&&ie===r.navigation.nextEl||r.navigation.prevEl&&ie===r.navigation.prevEl))return;const we=ce[0].classList.contains(r.params.pagination.hiddenClass);m(we===!0?"paginationShow":"paginationHide"),ce.forEach(xe=>xe.classList.toggle(r.params.pagination.hiddenClass))}});const ne=()=>{r.el.classList.remove(r.params.pagination.paginationDisabledClass);let{el:pe}=r.pagination;pe&&(pe=Rs(pe),pe.forEach(se=>se.classList.remove(r.params.pagination.paginationDisabledClass))),H(),te(),J()},oe=()=>{r.el.classList.add(r.params.pagination.paginationDisabledClass);let{el:pe}=r.pagination;pe&&(pe=Rs(pe),pe.forEach(se=>se.classList.add(r.params.pagination.paginationDisabledClass))),j()};Object.assign(r.pagination,{enable:ne,disable:oe,render:te,update:J,init:H,destroy:j})}function iW(n){let{swiper:r,extendParams:s,on:u,emit:m}=n;const y=na();s({zoom:{enabled:!1,limitToOriginalSize:!1,maxRatio:3,minRatio:1,panOnMouseMove:!1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}}),r.zoom={enabled:!1};let T=1,i=!1,I=!1,F={x:0,y:0};const B=-3;let G,J;const te=[],H={originX:0,originY:0,slideEl:void 0,slideWidth:void 0,slideHeight:void 0,imageEl:void 0,imageWrapEl:void 0,maxRatio:3},j={isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},ne={x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0};let oe=1;Object.defineProperty(r.zoom,"scale",{get(){return oe},set(Mt){if(oe!==Mt){const $t=H.imageEl,Ut=H.slideEl;m("zoomChange",Mt,$t,Ut)}oe=Mt}});function pe(){if(te.length<2)return 1;const Mt=te[0].pageX,$t=te[0].pageY,Ut=te[1].pageX,hn=te[1].pageY;return Math.sqrt((Ut-Mt)**2+(hn-$t)**2)}function se(){const Mt=r.params.zoom,$t=H.imageWrapEl.getAttribute("data-swiper-zoom")||Mt.maxRatio;if(Mt.limitToOriginalSize&&H.imageEl&&H.imageEl.naturalWidth){const Ut=H.imageEl.naturalWidth/H.imageEl.offsetWidth;return Math.min(Ut,$t)}return $t}function ie(){if(te.length<2)return{x:null,y:null};const Mt=H.imageEl.getBoundingClientRect();return[(te[0].pageX+(te[1].pageX-te[0].pageX)/2-Mt.x-y.scrollX)/T,(te[0].pageY+(te[1].pageY-te[0].pageY)/2-Mt.y-y.scrollY)/T]}function ce(){return r.isElement?"swiper-slide":`.${r.params.slideClass}`}function we(Mt){const $t=ce();return!!(Mt.target.matches($t)||r.slides.filter(Ut=>Ut.contains(Mt.target)).length>0)}function xe(Mt){const $t=`.${r.params.zoom.containerClass}`;return!!(Mt.target.matches($t)||[...r.hostEl.querySelectorAll($t)].filter(Ut=>Ut.contains(Mt.target)).length>0)}function $e(Mt){if(Mt.pointerType==="mouse"&&te.splice(0,te.length),!we(Mt))return;const $t=r.params.zoom;if(G=!1,J=!1,te.push(Mt),!(te.length<2)){if(G=!0,H.scaleStart=pe(),!H.slideEl){H.slideEl=Mt.target.closest(`.${r.params.slideClass}, swiper-slide`),H.slideEl||(H.slideEl=r.slides[r.activeIndex]);let Ut=H.slideEl.querySelector(`.${$t.containerClass}`);if(Ut&&(Ut=Ut.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),H.imageEl=Ut,Ut?H.imageWrapEl=j_(H.imageEl,`.${$t.containerClass}`)[0]:H.imageWrapEl=void 0,!H.imageWrapEl){H.imageEl=void 0;return}H.maxRatio=se()}if(H.imageEl){const[Ut,hn]=ie();H.originX=Ut,H.originY=hn,H.imageEl.style.transitionDuration="0ms"}i=!0}}function Ze(Mt){if(!we(Mt))return;const $t=r.params.zoom,Ut=r.zoom,hn=te.findIndex(xn=>xn.pointerId===Mt.pointerId);hn>=0&&(te[hn]=Mt),!(te.length<2)&&(J=!0,H.scaleMove=pe(),H.imageEl&&(Ut.scale=H.scaleMove/H.scaleStart*T,Ut.scale>H.maxRatio&&(Ut.scale=H.maxRatio-1+(Ut.scale-H.maxRatio+1)**.5),Ut.scale<$t.minRatio&&(Ut.scale=$t.minRatio+1-($t.minRatio-Ut.scale+1)**.5),H.imageEl.style.transform=`translate3d(0,0,0) scale(${Ut.scale})`))}function ae(Mt){if(!we(Mt)||Mt.pointerType==="mouse"&&Mt.type==="pointerout")return;const $t=r.params.zoom,Ut=r.zoom,hn=te.findIndex(xn=>xn.pointerId===Mt.pointerId);hn>=0&&te.splice(hn,1),!(!G||!J)&&(G=!1,J=!1,H.imageEl&&(Ut.scale=Math.max(Math.min(Ut.scale,H.maxRatio),$t.minRatio),H.imageEl.style.transitionDuration=`${r.params.speed}ms`,H.imageEl.style.transform=`translate3d(0,0,0) scale(${Ut.scale})`,T=Ut.scale,i=!1,Ut.scale>1&&H.slideEl?H.slideEl.classList.add(`${$t.zoomedSlideClass}`):Ut.scale<=1&&H.slideEl&&H.slideEl.classList.remove(`${$t.zoomedSlideClass}`),Ut.scale===1&&(H.originX=0,H.originY=0,H.slideEl=void 0)))}let ke;function ct(){r.touchEventsData.preventTouchMoveFromPointerMove=!1}function Xe(){clearTimeout(ke),r.touchEventsData.preventTouchMoveFromPointerMove=!0,ke=setTimeout(()=>{r.destroyed||ct()})}function st(Mt){const $t=r.device;if(!H.imageEl||j.isTouched)return;$t.android&&Mt.cancelable&&Mt.preventDefault(),j.isTouched=!0;const Ut=te.length>0?te[0]:Mt;j.touchesStart.x=Ut.pageX,j.touchesStart.y=Ut.pageY}function et(Mt){const Ut=Mt.pointerType==="mouse"&&r.params.zoom.panOnMouseMove;if(!we(Mt)||!xe(Mt))return;const hn=r.zoom;if(!H.imageEl)return;if(!j.isTouched||!H.slideEl){Ut&&at(Mt);return}if(Ut){at(Mt);return}j.isMoved||(j.width=H.imageEl.offsetWidth||H.imageEl.clientWidth,j.height=H.imageEl.offsetHeight||H.imageEl.clientHeight,j.startX=tw(H.imageWrapEl,"x")||0,j.startY=tw(H.imageWrapEl,"y")||0,H.slideWidth=H.slideEl.offsetWidth,H.slideHeight=H.slideEl.offsetHeight,H.imageWrapEl.style.transitionDuration="0ms");const xn=j.width*hn.scale,Le=j.height*hn.scale;if(j.minX=Math.min(H.slideWidth/2-xn/2,0),j.maxX=-j.minX,j.minY=Math.min(H.slideHeight/2-Le/2,0),j.maxY=-j.minY,j.touchesCurrent.x=te.length>0?te[0].pageX:Mt.pageX,j.touchesCurrent.y=te.length>0?te[0].pageY:Mt.pageY,Math.max(Math.abs(j.touchesCurrent.x-j.touchesStart.x),Math.abs(j.touchesCurrent.y-j.touchesStart.y))>5&&(r.allowClick=!1),!j.isMoved&&!i){if(r.isHorizontal()&&(Math.floor(j.minX)===Math.floor(j.startX)&&j.touchesCurrent.x<j.touchesStart.x||Math.floor(j.maxX)===Math.floor(j.startX)&&j.touchesCurrent.x>j.touchesStart.x)){j.isTouched=!1,ct();return}if(!r.isHorizontal()&&(Math.floor(j.minY)===Math.floor(j.startY)&&j.touchesCurrent.y<j.touchesStart.y||Math.floor(j.maxY)===Math.floor(j.startY)&&j.touchesCurrent.y>j.touchesStart.y)){j.isTouched=!1,ct();return}}Mt.cancelable&&Mt.preventDefault(),Mt.stopPropagation(),Xe(),j.isMoved=!0;const pn=(hn.scale-T)/(H.maxRatio-r.params.zoom.minRatio),{originX:zn,originY:_t}=H;j.currentX=j.touchesCurrent.x-j.touchesStart.x+j.startX+pn*(j.width-zn*2),j.currentY=j.touchesCurrent.y-j.touchesStart.y+j.startY+pn*(j.height-_t*2),j.currentX<j.minX&&(j.currentX=j.minX+1-(j.minX-j.currentX+1)**.8),j.currentX>j.maxX&&(j.currentX=j.maxX-1+(j.currentX-j.maxX+1)**.8),j.currentY<j.minY&&(j.currentY=j.minY+1-(j.minY-j.currentY+1)**.8),j.currentY>j.maxY&&(j.currentY=j.maxY-1+(j.currentY-j.maxY+1)**.8),ne.prevPositionX||(ne.prevPositionX=j.touchesCurrent.x),ne.prevPositionY||(ne.prevPositionY=j.touchesCurrent.y),ne.prevTime||(ne.prevTime=Date.now()),ne.x=(j.touchesCurrent.x-ne.prevPositionX)/(Date.now()-ne.prevTime)/2,ne.y=(j.touchesCurrent.y-ne.prevPositionY)/(Date.now()-ne.prevTime)/2,Math.abs(j.touchesCurrent.x-ne.prevPositionX)<2&&(ne.x=0),Math.abs(j.touchesCurrent.y-ne.prevPositionY)<2&&(ne.y=0),ne.prevPositionX=j.touchesCurrent.x,ne.prevPositionY=j.touchesCurrent.y,ne.prevTime=Date.now(),H.imageWrapEl.style.transform=`translate3d(${j.currentX}px, ${j.currentY}px,0)`}function gt(){const Mt=r.zoom;if(te.length=0,!H.imageEl)return;if(!j.isTouched||!j.isMoved){j.isTouched=!1,j.isMoved=!1;return}j.isTouched=!1,j.isMoved=!1;let $t=300,Ut=300;const hn=ne.x*$t,xn=j.currentX+hn,Le=ne.y*Ut,Dn=j.currentY+Le;ne.x!==0&&($t=Math.abs((xn-j.currentX)/ne.x)),ne.y!==0&&(Ut=Math.abs((Dn-j.currentY)/ne.y));const pn=Math.max($t,Ut);j.currentX=xn,j.currentY=Dn;const zn=j.width*Mt.scale,_t=j.height*Mt.scale;j.minX=Math.min(H.slideWidth/2-zn/2,0),j.maxX=-j.minX,j.minY=Math.min(H.slideHeight/2-_t/2,0),j.maxY=-j.minY,j.currentX=Math.max(Math.min(j.currentX,j.maxX),j.minX),j.currentY=Math.max(Math.min(j.currentY,j.maxY),j.minY),H.imageWrapEl.style.transitionDuration=`${pn}ms`,H.imageWrapEl.style.transform=`translate3d(${j.currentX}px, ${j.currentY}px,0)`}function zt(){const Mt=r.zoom;H.slideEl&&r.activeIndex!==r.slides.indexOf(H.slideEl)&&(H.imageEl&&(H.imageEl.style.transform="translate3d(0,0,0) scale(1)"),H.imageWrapEl&&(H.imageWrapEl.style.transform="translate3d(0,0,0)"),H.slideEl.classList.remove(`${r.params.zoom.zoomedSlideClass}`),Mt.scale=1,T=1,H.slideEl=void 0,H.imageEl=void 0,H.imageWrapEl=void 0,H.originX=0,H.originY=0)}function at(Mt){if(T<=1||!H.imageWrapEl||!we(Mt)||!xe(Mt))return;const $t=y.getComputedStyle(H.imageWrapEl).transform,Ut=new y.DOMMatrix($t);if(!I){I=!0,F.x=Mt.clientX,F.y=Mt.clientY,j.startX=Ut.e,j.startY=Ut.f,j.width=H.imageEl.offsetWidth||H.imageEl.clientWidth,j.height=H.imageEl.offsetHeight||H.imageEl.clientHeight,H.slideWidth=H.slideEl.offsetWidth,H.slideHeight=H.slideEl.offsetHeight;return}const hn=(Mt.clientX-F.x)*B,xn=(Mt.clientY-F.y)*B,Le=j.width*T,Dn=j.height*T,pn=H.slideWidth,zn=H.slideHeight,_t=Math.min(pn/2-Le/2,0),er=-_t,pr=Math.min(zn/2-Dn/2,0),qn=-pr,_n=Math.max(Math.min(j.startX+hn,er),_t),ir=Math.max(Math.min(j.startY+xn,qn),pr);H.imageWrapEl.style.transitionDuration="0ms",H.imageWrapEl.style.transform=`translate3d(${_n}px, ${ir}px, 0)`,F.x=Mt.clientX,F.y=Mt.clientY,j.startX=_n,j.startY=ir}function Ye(Mt){const $t=r.zoom,Ut=r.params.zoom;if(!H.slideEl){Mt&&Mt.target&&(H.slideEl=Mt.target.closest(`.${r.params.slideClass}, swiper-slide`)),H.slideEl||(r.params.virtual&&r.params.virtual.enabled&&r.virtual?H.slideEl=wc(r.slidesEl,`.${r.params.slideActiveClass}`)[0]:H.slideEl=r.slides[r.activeIndex]);let Pn=H.slideEl.querySelector(`.${Ut.containerClass}`);Pn&&(Pn=Pn.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),H.imageEl=Pn,Pn?H.imageWrapEl=j_(H.imageEl,`.${Ut.containerClass}`)[0]:H.imageWrapEl=void 0}if(!H.imageEl||!H.imageWrapEl)return;r.params.cssMode&&(r.wrapperEl.style.overflow="hidden",r.wrapperEl.style.touchAction="none"),H.slideEl.classList.add(`${Ut.zoomedSlideClass}`);let hn,xn,Le,Dn,pn,zn,_t,er,pr,qn,_n,ir,cr,Er,On,fi,Dt,Ft;typeof j.touchesStart.x>"u"&&Mt?(hn=Mt.pageX,xn=Mt.pageY):(hn=j.touchesStart.x,xn=j.touchesStart.y);const sn=typeof Mt=="number"?Mt:null;T===1&&sn&&(hn=void 0,xn=void 0,j.touchesStart.x=void 0,j.touchesStart.y=void 0);const Tn=se();$t.scale=sn||Tn,T=sn||Tn,Mt&&!(T===1&&sn)?(Dt=H.slideEl.offsetWidth,Ft=H.slideEl.offsetHeight,Le=kI(H.slideEl).left+y.scrollX,Dn=kI(H.slideEl).top+y.scrollY,pn=Le+Dt/2-hn,zn=Dn+Ft/2-xn,pr=H.imageEl.offsetWidth||H.imageEl.clientWidth,qn=H.imageEl.offsetHeight||H.imageEl.clientHeight,_n=pr*$t.scale,ir=qn*$t.scale,cr=Math.min(Dt/2-_n/2,0),Er=Math.min(Ft/2-ir/2,0),On=-cr,fi=-Er,_t=pn*$t.scale,er=zn*$t.scale,_t<cr&&(_t=cr),_t>On&&(_t=On),er<Er&&(er=Er),er>fi&&(er=fi)):(_t=0,er=0),sn&&$t.scale===1&&(H.originX=0,H.originY=0),H.imageWrapEl.style.transitionDuration="300ms",H.imageWrapEl.style.transform=`translate3d(${_t}px, ${er}px,0)`,H.imageEl.style.transitionDuration="300ms",H.imageEl.style.transform=`translate3d(0,0,0) scale(${$t.scale})`}function Bt(){const Mt=r.zoom,$t=r.params.zoom;if(!H.slideEl){r.params.virtual&&r.params.virtual.enabled&&r.virtual?H.slideEl=wc(r.slidesEl,`.${r.params.slideActiveClass}`)[0]:H.slideEl=r.slides[r.activeIndex];let Ut=H.slideEl.querySelector(`.${$t.containerClass}`);Ut&&(Ut=Ut.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),H.imageEl=Ut,Ut?H.imageWrapEl=j_(H.imageEl,`.${$t.containerClass}`)[0]:H.imageWrapEl=void 0}!H.imageEl||!H.imageWrapEl||(r.params.cssMode&&(r.wrapperEl.style.overflow="",r.wrapperEl.style.touchAction=""),Mt.scale=1,T=1,j.touchesStart.x=void 0,j.touchesStart.y=void 0,H.imageWrapEl.style.transitionDuration="300ms",H.imageWrapEl.style.transform="translate3d(0,0,0)",H.imageEl.style.transitionDuration="300ms",H.imageEl.style.transform="translate3d(0,0,0) scale(1)",H.slideEl.classList.remove(`${$t.zoomedSlideClass}`),H.slideEl=void 0,H.originX=0,H.originY=0,r.params.zoom.panOnMouseMove&&(F={x:0,y:0},I&&(I=!1,j.startX=0,j.startY=0)))}function nt(Mt){const $t=r.zoom;$t.scale&&$t.scale!==1?Bt():Ye(Mt)}function Rt(){const Mt=r.params.passiveListeners?{passive:!0,capture:!1}:!1,$t=r.params.passiveListeners?{passive:!1,capture:!0}:!0;return{passiveListener:Mt,activeListenerWithCapture:$t}}function Nt(){const Mt=r.zoom;if(Mt.enabled)return;Mt.enabled=!0;const{passiveListener:$t,activeListenerWithCapture:Ut}=Rt();r.wrapperEl.addEventListener("pointerdown",$e,$t),r.wrapperEl.addEventListener("pointermove",Ze,Ut),["pointerup","pointercancel","pointerout"].forEach(hn=>{r.wrapperEl.addEventListener(hn,ae,$t)}),r.wrapperEl.addEventListener("pointermove",et,Ut)}function gn(){const Mt=r.zoom;if(!Mt.enabled)return;Mt.enabled=!1;const{passiveListener:$t,activeListenerWithCapture:Ut}=Rt();r.wrapperEl.removeEventListener("pointerdown",$e,$t),r.wrapperEl.removeEventListener("pointermove",Ze,Ut),["pointerup","pointercancel","pointerout"].forEach(hn=>{r.wrapperEl.removeEventListener(hn,ae,$t)}),r.wrapperEl.removeEventListener("pointermove",et,Ut)}u("init",()=>{r.params.zoom.enabled&&Nt()}),u("destroy",()=>{gn()}),u("touchStart",(Mt,$t)=>{r.zoom.enabled&&st($t)}),u("touchEnd",(Mt,$t)=>{r.zoom.enabled&&gt()}),u("doubleTap",(Mt,$t)=>{!r.animating&&r.params.zoom.enabled&&r.zoom.enabled&&r.params.zoom.toggle&&nt($t)}),u("transitionEnd",()=>{r.zoom.enabled&&r.params.zoom.enabled&&zt()}),u("slideChange",()=>{r.zoom.enabled&&r.params.zoom.enabled&&r.params.cssMode&&zt()}),Object.assign(r.zoom,{enable:Nt,disable:gn,in:Ye,out:Bt,toggle:nt})}function RR(n){let{swiper:r,extendParams:s,on:u,emit:m,params:y}=n;r.autoplay={running:!1,paused:!1,timeLeft:0},s({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let T,i,I=y&&y.autoplay?y.autoplay.delay:3e3,F=y&&y.autoplay?y.autoplay.delay:3e3,B,G=new Date().getTime(),J,te,H,j,ne,oe,pe;function se(at){!r||r.destroyed||!r.wrapperEl||at.target===r.wrapperEl&&(r.wrapperEl.removeEventListener("transitionend",se),!(pe||at.detail&&at.detail.bySwiperTouchMove)&&ae())}const ie=()=>{if(r.destroyed||!r.autoplay.running)return;r.autoplay.paused?J=!0:J&&(F=B,J=!1);const at=r.autoplay.paused?B:G+F-new Date().getTime();r.autoplay.timeLeft=at,m("autoplayTimeLeft",at,at/I),i=requestAnimationFrame(()=>{ie()})},ce=()=>{let at;return r.virtual&&r.params.virtual.enabled?at=r.slides.find(Bt=>Bt.classList.contains("swiper-slide-active")):at=r.slides[r.activeIndex],at?parseInt(at.getAttribute("data-swiper-autoplay"),10):void 0},we=at=>{if(r.destroyed||!r.autoplay.running)return;cancelAnimationFrame(i),ie();let Ye=typeof at>"u"?r.params.autoplay.delay:at;I=r.params.autoplay.delay,F=r.params.autoplay.delay;const Bt=ce();!Number.isNaN(Bt)&&Bt>0&&typeof at>"u"&&(Ye=Bt,I=Bt,F=Bt),B=Ye;const nt=r.params.speed,Rt=()=>{!r||r.destroyed||(r.params.autoplay.reverseDirection?!r.isBeginning||r.params.loop||r.params.rewind?(r.slidePrev(nt,!0,!0),m("autoplay")):r.params.autoplay.stopOnLastSlide||(r.slideTo(r.slides.length-1,nt,!0,!0),m("autoplay")):!r.isEnd||r.params.loop||r.params.rewind?(r.slideNext(nt,!0,!0),m("autoplay")):r.params.autoplay.stopOnLastSlide||(r.slideTo(0,nt,!0,!0),m("autoplay")),r.params.cssMode&&(G=new Date().getTime(),requestAnimationFrame(()=>{we()})))};return Ye>0?(clearTimeout(T),T=setTimeout(()=>{Rt()},Ye)):requestAnimationFrame(()=>{Rt()}),Ye},xe=()=>{G=new Date().getTime(),r.autoplay.running=!0,we(),m("autoplayStart")},$e=()=>{r.autoplay.running=!1,clearTimeout(T),cancelAnimationFrame(i),m("autoplayStop")},Ze=(at,Ye)=>{if(r.destroyed||!r.autoplay.running)return;clearTimeout(T),at||(oe=!0);const Bt=()=>{m("autoplayPause"),r.params.autoplay.waitForTransition?r.wrapperEl.addEventListener("transitionend",se):ae()};if(r.autoplay.paused=!0,Ye){ne&&(B=r.params.autoplay.delay),ne=!1,Bt();return}B=(B||r.params.autoplay.delay)-(new Date().getTime()-G),!(r.isEnd&&B<0&&!r.params.loop)&&(B<0&&(B=0),Bt())},ae=()=>{r.isEnd&&B<0&&!r.params.loop||r.destroyed||!r.autoplay.running||(G=new Date().getTime(),oe?(oe=!1,we(B)):we(),r.autoplay.paused=!1,m("autoplayResume"))},ke=()=>{if(r.destroyed||!r.autoplay.running)return;const at=mu();at.visibilityState==="hidden"&&(oe=!0,Ze(!0)),at.visibilityState==="visible"&&ae()},ct=at=>{at.pointerType==="mouse"&&(oe=!0,pe=!0,!(r.animating||r.autoplay.paused)&&Ze(!0))},Xe=at=>{at.pointerType==="mouse"&&(pe=!1,r.autoplay.paused&&ae())},st=()=>{r.params.autoplay.pauseOnMouseEnter&&(r.el.addEventListener("pointerenter",ct),r.el.addEventListener("pointerleave",Xe))},et=()=>{r.el&&typeof r.el!="string"&&(r.el.removeEventListener("pointerenter",ct),r.el.removeEventListener("pointerleave",Xe))},gt=()=>{mu().addEventListener("visibilitychange",ke)},zt=()=>{mu().removeEventListener("visibilitychange",ke)};u("init",()=>{r.params.autoplay.enabled&&(st(),gt(),xe())}),u("destroy",()=>{et(),zt(),r.autoplay.running&&$e()}),u("_freeModeStaticRelease",()=>{(H||oe)&&ae()}),u("_freeModeNoMomentumRelease",()=>{r.params.autoplay.disableOnInteraction?$e():Ze(!0,!0)}),u("beforeTransitionStart",(at,Ye,Bt)=>{r.destroyed||!r.autoplay.running||(Bt||!r.params.autoplay.disableOnInteraction?Ze(!0,!0):$e())}),u("sliderFirstMove",()=>{if(!(r.destroyed||!r.autoplay.running)){if(r.params.autoplay.disableOnInteraction){$e();return}te=!0,H=!1,oe=!1,j=setTimeout(()=>{oe=!0,H=!0,Ze(!0)},200)}}),u("touchEnd",()=>{if(!(r.destroyed||!r.autoplay.running||!te)){if(clearTimeout(j),clearTimeout(T),r.params.autoplay.disableOnInteraction){H=!1,te=!1;return}H&&r.params.cssMode&&ae(),H=!1,te=!1}}),u("slideChange",()=>{r.destroyed||!r.autoplay.running||(ne=!0)}),Object.assign(r.autoplay,{start:xe,stop:$e,pause:Ze,resume:ae})}function oW(n){const{effect:r,swiper:s,on:u,setTranslate:m,setTransition:y,overwriteParams:T,perspective:i,recreateShadows:I,getEffectParams:F}=n;u("beforeInit",()=>{if(s.params.effect!==r)return;s.classNames.push(`${s.params.containerModifierClass}${r}`),i&&i()&&s.classNames.push(`${s.params.containerModifierClass}3d`);const G=T?T():{};Object.assign(s.params,G),Object.assign(s.originalParams,G)}),u("setTranslate",()=>{s.params.effect===r&&m()}),u("setTransition",(G,J)=>{s.params.effect===r&&y(J)}),u("transitionEnd",()=>{if(s.params.effect===r&&I){if(!F||!F().slideShadows)return;s.slides.forEach(G=>{G.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(J=>J.remove())}),I()}});let B;u("virtualUpdate",()=>{s.params.effect===r&&(s.slides.length||(B=!0),requestAnimationFrame(()=>{B&&s.slides&&s.slides.length&&(m(),B=!1)}))})}function sW(n,r){const s=sS(r);return s!==r&&(s.style.backfaceVisibility="hidden",s.style["-webkit-backface-visibility"]="hidden"),s}function BI(n,r,s){const u=`swiper-slide-shadow${s?`-${s}`:""}${` swiper-slide-shadow-${n}`}`,m=sS(r);let y=m.querySelector(`.${u.split(" ").join(".")}`);return y||(y=J_("div",u.split(" ")),m.append(y)),y}function aW(n){let{swiper:r,extendParams:s,on:u}=n;s({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),oW({effect:"coverflow",swiper:r,on:u,setTranslate:()=>{const{width:T,height:i,slides:I,slidesSizesGrid:F}=r,B=r.params.coverflowEffect,G=r.isHorizontal(),J=r.translate,te=G?-J+T/2:-J+i/2,H=G?B.rotate:-B.rotate,j=B.depth,ne=Fq(r);for(let oe=0,pe=I.length;oe<pe;oe+=1){const se=I[oe],ie=F[oe],ce=se.swiperSlideOffset,we=(te-ce-ie/2)/ie,xe=typeof B.modifier=="function"?B.modifier(we):we*B.modifier;let $e=G?H*xe:0,Ze=G?0:H*xe,ae=-j*Math.abs(xe),ke=B.stretch;typeof ke=="string"&&ke.indexOf("%")!==-1&&(ke=parseFloat(B.stretch)/100*ie);let ct=G?0:ke*xe,Xe=G?ke*xe:0,st=1-(1-B.scale)*Math.abs(xe);Math.abs(Xe)<.001&&(Xe=0),Math.abs(ct)<.001&&(ct=0),Math.abs(ae)<.001&&(ae=0),Math.abs($e)<.001&&($e=0),Math.abs(Ze)<.001&&(Ze=0),Math.abs(st)<.001&&(st=0);const et=`translate3d(${Xe}px,${ct}px,${ae}px)  rotateX(${ne(Ze)}deg) rotateY(${ne($e)}deg) scale(${st})`,gt=sW(B,se);if(gt.style.transform=et,se.style.zIndex=-Math.abs(Math.round(xe))+1,B.slideShadows){let zt=G?se.querySelector(".swiper-slide-shadow-left"):se.querySelector(".swiper-slide-shadow-top"),at=G?se.querySelector(".swiper-slide-shadow-right"):se.querySelector(".swiper-slide-shadow-bottom");zt||(zt=BI("coverflow",se,G?"left":"top")),at||(at=BI("coverflow",se,G?"right":"bottom")),zt&&(zt.style.opacity=xe>0?xe:0),at&&(at.style.opacity=-xe>0?-xe:0)}}},setTransition:T=>{r.slides.map(I=>sS(I)).forEach(I=>{I.style.transitionDuration=`${T}ms`,I.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(F=>{F.style.transitionDuration=`${T}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}const lW=({popupInfo:n})=>{const{name:r,description:s,price:u,images:m}=n,{dispatch:y}=mo();return _e.jsx(dP,{sx:{maxWidth:400},children:_e.jsxs(Rx,{sx:{display:"block"},children:[_e.jsx(Y_,{sx:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7)0%, rgba(0,0,0,0.3)70%, rgba(0,0,0,0)100%)",zIndex:2},title:u===10?"Normal Charger":"$"+u,position:"top"}),_e.jsx(Y_,{title:r,subtitle:s.substr(0,30)+"...",sx:{zIndex:2}}),_e.jsx(lS,{modules:[RR,rW],autoplay:!0,lazy:"true",pagination:{clickable:!0},style:{"--swiper-pagination-color":"rgba(255, 255, 255, 0.8)","--swiper-pagination-bullet-inactive-color":"#fff","--swiper-pagination-bullet-inactive-opacity":.5},children:m.map(T=>_e.jsx(cS,{children:_e.jsx(Zo,{component:"img",src:T,alt:"station",sx:{height:255,display:"block",overflow:"hidden",width:"100%",cursor:"pointer",objectFit:"cover"},onClick:()=>y({type:"UPDATE_STATION",payload:n})})},T))})]})})};var jv={exports:{}},cW=jv.exports,NI;function uW(){return NI||(NI=1,function(n,r){(function(s,u){n.exports=u()})(cW,function(){var s,u,m;function y(i,I){if(!s)s=I;else if(!u)u=I;else{var F="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+s+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",B={};s(B),m=I(B),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([F],{type:"text/javascript"})))}}y(["exports"],function(i){function I(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var F,B={},G={};function J(){if(F)return G;F=1,Object.defineProperty(G,"__esModule",{value:!0}),G.setMatrixArrayType=function(f){G.ARRAY_TYPE=e=f},G.toRadian=function(f){return f*c},G.equals=function(f,d){return Math.abs(f-d)<=l*Math.max(1,Math.abs(f),Math.abs(d))},G.RANDOM=G.ARRAY_TYPE=G.EPSILON=void 0;var l=1e-6;G.EPSILON=l;var e=typeof Float32Array<"u"?Float32Array:Array;G.ARRAY_TYPE=e;var o=Math.random;G.RANDOM=o;var c=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var f=0,d=arguments.length;d--;)f+=arguments[d]*arguments[d];return Math.sqrt(f)}),G}var te,H={};function j(){if(te)return H;function l(d){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(d)}te=1,Object.defineProperty(H,"__esModule",{value:!0}),H.create=function(){var d=new e.ARRAY_TYPE(4);return e.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},H.clone=function(d){var g=new e.ARRAY_TYPE(4);return g[0]=d[0],g[1]=d[1],g[2]=d[2],g[3]=d[3],g},H.copy=function(d,g){return d[0]=g[0],d[1]=g[1],d[2]=g[2],d[3]=g[3],d},H.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},H.fromValues=function(d,g,S,M){var L=new e.ARRAY_TYPE(4);return L[0]=d,L[1]=g,L[2]=S,L[3]=M,L},H.set=function(d,g,S,M,L){return d[0]=g,d[1]=S,d[2]=M,d[3]=L,d},H.transpose=function(d,g){if(d===g){var S=g[1];d[1]=g[2],d[2]=S}else d[0]=g[0],d[1]=g[2],d[2]=g[1],d[3]=g[3];return d},H.invert=function(d,g){var S=g[0],M=g[1],L=g[2],w=g[3],A=S*w-L*M;return A?(d[0]=w*(A=1/A),d[1]=-M*A,d[2]=-L*A,d[3]=S*A,d):null},H.adjoint=function(d,g){var S=g[0];return d[0]=g[3],d[1]=-g[1],d[2]=-g[2],d[3]=S,d},H.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},H.multiply=c,H.rotate=function(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=Math.sin(S),C=Math.cos(S);return d[0]=M*C+w*R,d[1]=L*C+A*R,d[2]=M*-R+w*C,d[3]=L*-R+A*C,d},H.scale=function(d,g,S){var M=g[1],L=g[2],w=g[3],A=S[0],R=S[1];return d[0]=g[0]*A,d[1]=M*A,d[2]=L*R,d[3]=w*R,d},H.fromRotation=function(d,g){var S=Math.sin(g),M=Math.cos(g);return d[0]=M,d[1]=S,d[2]=-S,d[3]=M,d},H.fromScaling=function(d,g){return d[0]=g[0],d[1]=0,d[2]=0,d[3]=g[1],d},H.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},H.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3])},H.LDU=function(d,g,S,M){return d[2]=M[2]/M[0],S[0]=M[0],S[1]=M[1],S[3]=M[3]-d[2]*S[1],[d,g,S]},H.add=function(d,g,S){return d[0]=g[0]+S[0],d[1]=g[1]+S[1],d[2]=g[2]+S[2],d[3]=g[3]+S[3],d},H.subtract=f,H.exactEquals=function(d,g){return d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2]&&d[3]===g[3]},H.equals=function(d,g){var S=d[0],M=d[1],L=d[2],w=d[3],A=g[0],R=g[1],C=g[2],P=g[3];return Math.abs(S-A)<=e.EPSILON*Math.max(1,Math.abs(S),Math.abs(A))&&Math.abs(M-R)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(L-C)<=e.EPSILON*Math.max(1,Math.abs(L),Math.abs(C))&&Math.abs(w-P)<=e.EPSILON*Math.max(1,Math.abs(w),Math.abs(P))},H.multiplyScalar=function(d,g,S){return d[0]=g[0]*S,d[1]=g[1]*S,d[2]=g[2]*S,d[3]=g[3]*S,d},H.multiplyScalarAndAdd=function(d,g,S,M){return d[0]=g[0]+S[0]*M,d[1]=g[1]+S[1]*M,d[2]=g[2]+S[2]*M,d[3]=g[3]+S[3]*M,d},H.sub=H.mul=void 0;var e=function(d,g){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var S=o(void 0);if(S&&S.has(d))return S.get(d);var M={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in d)if(w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)){var A=L?Object.getOwnPropertyDescriptor(d,w):null;A&&(A.get||A.set)?Object.defineProperty(M,w,A):M[w]=d[w]}return M.default=d,S&&S.set(d,M),M}(J());function o(d){if(typeof WeakMap!="function")return null;var g=new WeakMap,S=new WeakMap;return(o=function(M){return M?S:g})(d)}function c(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=S[0],C=S[1],P=S[2],D=S[3];return d[0]=M*R+w*C,d[1]=L*R+A*C,d[2]=M*P+w*D,d[3]=L*P+A*D,d}function f(d,g,S){return d[0]=g[0]-S[0],d[1]=g[1]-S[1],d[2]=g[2]-S[2],d[3]=g[3]-S[3],d}return H.mul=c,H.sub=f,H}var ne,oe={};function pe(){if(ne)return oe;function l(d){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(d)}ne=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.create=function(){var d=new e.ARRAY_TYPE(6);return e.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},oe.clone=function(d){var g=new e.ARRAY_TYPE(6);return g[0]=d[0],g[1]=d[1],g[2]=d[2],g[3]=d[3],g[4]=d[4],g[5]=d[5],g},oe.copy=function(d,g){return d[0]=g[0],d[1]=g[1],d[2]=g[2],d[3]=g[3],d[4]=g[4],d[5]=g[5],d},oe.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},oe.fromValues=function(d,g,S,M,L,w){var A=new e.ARRAY_TYPE(6);return A[0]=d,A[1]=g,A[2]=S,A[3]=M,A[4]=L,A[5]=w,A},oe.set=function(d,g,S,M,L,w,A){return d[0]=g,d[1]=S,d[2]=M,d[3]=L,d[4]=w,d[5]=A,d},oe.invert=function(d,g){var S=g[0],M=g[1],L=g[2],w=g[3],A=g[4],R=g[5],C=S*w-M*L;return C?(d[0]=w*(C=1/C),d[1]=-M*C,d[2]=-L*C,d[3]=S*C,d[4]=(L*R-w*A)*C,d[5]=(M*A-S*R)*C,d):null},oe.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},oe.multiply=c,oe.rotate=function(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=g[4],C=g[5],P=Math.sin(S),D=Math.cos(S);return d[0]=M*D+w*P,d[1]=L*D+A*P,d[2]=M*-P+w*D,d[3]=L*-P+A*D,d[4]=R,d[5]=C,d},oe.scale=function(d,g,S){var M=g[1],L=g[2],w=g[3],A=g[4],R=g[5],C=S[0],P=S[1];return d[0]=g[0]*C,d[1]=M*C,d[2]=L*P,d[3]=w*P,d[4]=A,d[5]=R,d},oe.translate=function(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=g[4],C=g[5],P=S[0],D=S[1];return d[0]=M,d[1]=L,d[2]=w,d[3]=A,d[4]=M*P+w*D+R,d[5]=L*P+A*D+C,d},oe.fromRotation=function(d,g){var S=Math.sin(g),M=Math.cos(g);return d[0]=M,d[1]=S,d[2]=-S,d[3]=M,d[4]=0,d[5]=0,d},oe.fromScaling=function(d,g){return d[0]=g[0],d[1]=0,d[2]=0,d[3]=g[1],d[4]=0,d[5]=0,d},oe.fromTranslation=function(d,g){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=g[0],d[5]=g[1],d},oe.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},oe.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],1)},oe.add=function(d,g,S){return d[0]=g[0]+S[0],d[1]=g[1]+S[1],d[2]=g[2]+S[2],d[3]=g[3]+S[3],d[4]=g[4]+S[4],d[5]=g[5]+S[5],d},oe.subtract=f,oe.multiplyScalar=function(d,g,S){return d[0]=g[0]*S,d[1]=g[1]*S,d[2]=g[2]*S,d[3]=g[3]*S,d[4]=g[4]*S,d[5]=g[5]*S,d},oe.multiplyScalarAndAdd=function(d,g,S,M){return d[0]=g[0]+S[0]*M,d[1]=g[1]+S[1]*M,d[2]=g[2]+S[2]*M,d[3]=g[3]+S[3]*M,d[4]=g[4]+S[4]*M,d[5]=g[5]+S[5]*M,d},oe.exactEquals=function(d,g){return d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2]&&d[3]===g[3]&&d[4]===g[4]&&d[5]===g[5]},oe.equals=function(d,g){var S=d[0],M=d[1],L=d[2],w=d[3],A=d[4],R=d[5],C=g[0],P=g[1],D=g[2],V=g[3],q=g[4],K=g[5];return Math.abs(S-C)<=e.EPSILON*Math.max(1,Math.abs(S),Math.abs(C))&&Math.abs(M-P)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(L-D)<=e.EPSILON*Math.max(1,Math.abs(L),Math.abs(D))&&Math.abs(w-V)<=e.EPSILON*Math.max(1,Math.abs(w),Math.abs(V))&&Math.abs(A-q)<=e.EPSILON*Math.max(1,Math.abs(A),Math.abs(q))&&Math.abs(R-K)<=e.EPSILON*Math.max(1,Math.abs(R),Math.abs(K))},oe.sub=oe.mul=void 0;var e=function(d,g){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var S=o(void 0);if(S&&S.has(d))return S.get(d);var M={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in d)if(w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)){var A=L?Object.getOwnPropertyDescriptor(d,w):null;A&&(A.get||A.set)?Object.defineProperty(M,w,A):M[w]=d[w]}return M.default=d,S&&S.set(d,M),M}(J());function o(d){if(typeof WeakMap!="function")return null;var g=new WeakMap,S=new WeakMap;return(o=function(M){return M?S:g})(d)}function c(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=g[4],C=g[5],P=S[0],D=S[1],V=S[2],q=S[3],K=S[4],Q=S[5];return d[0]=M*P+w*D,d[1]=L*P+A*D,d[2]=M*V+w*q,d[3]=L*V+A*q,d[4]=M*K+w*Q+R,d[5]=L*K+A*Q+C,d}function f(d,g,S){return d[0]=g[0]-S[0],d[1]=g[1]-S[1],d[2]=g[2]-S[2],d[3]=g[3]-S[3],d[4]=g[4]-S[4],d[5]=g[5]-S[5],d}return oe.mul=c,oe.sub=f,oe}var se,ie={};function ce(){if(se)return ie;function l(d){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(d)}se=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.create=function(){var d=new e.ARRAY_TYPE(9);return e.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},ie.fromMat4=function(d,g){return d[0]=g[0],d[1]=g[1],d[2]=g[2],d[3]=g[4],d[4]=g[5],d[5]=g[6],d[6]=g[8],d[7]=g[9],d[8]=g[10],d},ie.clone=function(d){var g=new e.ARRAY_TYPE(9);return g[0]=d[0],g[1]=d[1],g[2]=d[2],g[3]=d[3],g[4]=d[4],g[5]=d[5],g[6]=d[6],g[7]=d[7],g[8]=d[8],g},ie.copy=function(d,g){return d[0]=g[0],d[1]=g[1],d[2]=g[2],d[3]=g[3],d[4]=g[4],d[5]=g[5],d[6]=g[6],d[7]=g[7],d[8]=g[8],d},ie.fromValues=function(d,g,S,M,L,w,A,R,C){var P=new e.ARRAY_TYPE(9);return P[0]=d,P[1]=g,P[2]=S,P[3]=M,P[4]=L,P[5]=w,P[6]=A,P[7]=R,P[8]=C,P},ie.set=function(d,g,S,M,L,w,A,R,C,P){return d[0]=g,d[1]=S,d[2]=M,d[3]=L,d[4]=w,d[5]=A,d[6]=R,d[7]=C,d[8]=P,d},ie.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},ie.transpose=function(d,g){if(d===g){var S=g[1],M=g[2],L=g[5];d[1]=g[3],d[2]=g[6],d[3]=S,d[5]=g[7],d[6]=M,d[7]=L}else d[0]=g[0],d[1]=g[3],d[2]=g[6],d[3]=g[1],d[4]=g[4],d[5]=g[7],d[6]=g[2],d[7]=g[5],d[8]=g[8];return d},ie.invert=function(d,g){var S=g[0],M=g[1],L=g[2],w=g[3],A=g[4],R=g[5],C=g[6],P=g[7],D=g[8],V=D*A-R*P,q=-D*w+R*C,K=P*w-A*C,Q=S*V+M*q+L*K;return Q?(d[0]=V*(Q=1/Q),d[1]=(-D*M+L*P)*Q,d[2]=(R*M-L*A)*Q,d[3]=q*Q,d[4]=(D*S-L*C)*Q,d[5]=(-R*S+L*w)*Q,d[6]=K*Q,d[7]=(-P*S+M*C)*Q,d[8]=(A*S-M*w)*Q,d):null},ie.adjoint=function(d,g){var S=g[0],M=g[1],L=g[2],w=g[3],A=g[4],R=g[5],C=g[6],P=g[7],D=g[8];return d[0]=A*D-R*P,d[1]=L*P-M*D,d[2]=M*R-L*A,d[3]=R*C-w*D,d[4]=S*D-L*C,d[5]=L*w-S*R,d[6]=w*P-A*C,d[7]=M*C-S*P,d[8]=S*A-M*w,d},ie.determinant=function(d){var g=d[3],S=d[4],M=d[5],L=d[6],w=d[7],A=d[8];return d[0]*(A*S-M*w)+d[1]*(-A*g+M*L)+d[2]*(w*g-S*L)},ie.multiply=c,ie.translate=function(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=g[4],C=g[5],P=g[6],D=g[7],V=g[8],q=S[0],K=S[1];return d[0]=M,d[1]=L,d[2]=w,d[3]=A,d[4]=R,d[5]=C,d[6]=q*M+K*A+P,d[7]=q*L+K*R+D,d[8]=q*w+K*C+V,d},ie.rotate=function(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=g[4],C=g[5],P=g[6],D=g[7],V=g[8],q=Math.sin(S),K=Math.cos(S);return d[0]=K*M+q*A,d[1]=K*L+q*R,d[2]=K*w+q*C,d[3]=K*A-q*M,d[4]=K*R-q*L,d[5]=K*C-q*w,d[6]=P,d[7]=D,d[8]=V,d},ie.scale=function(d,g,S){var M=S[0],L=S[1];return d[0]=M*g[0],d[1]=M*g[1],d[2]=M*g[2],d[3]=L*g[3],d[4]=L*g[4],d[5]=L*g[5],d[6]=g[6],d[7]=g[7],d[8]=g[8],d},ie.fromTranslation=function(d,g){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=g[0],d[7]=g[1],d[8]=1,d},ie.fromRotation=function(d,g){var S=Math.sin(g),M=Math.cos(g);return d[0]=M,d[1]=S,d[2]=0,d[3]=-S,d[4]=M,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},ie.fromScaling=function(d,g){return d[0]=g[0],d[1]=0,d[2]=0,d[3]=0,d[4]=g[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},ie.fromMat2d=function(d,g){return d[0]=g[0],d[1]=g[1],d[2]=0,d[3]=g[2],d[4]=g[3],d[5]=0,d[6]=g[4],d[7]=g[5],d[8]=1,d},ie.fromQuat=function(d,g){var S=g[0],M=g[1],L=g[2],w=g[3],A=S+S,R=M+M,C=L+L,P=S*A,D=M*A,V=M*R,q=L*A,K=L*R,Q=L*C,X=w*A,re=w*R,de=w*C;return d[0]=1-V-Q,d[3]=D-de,d[6]=q+re,d[1]=D+de,d[4]=1-P-Q,d[7]=K-X,d[2]=q-re,d[5]=K+X,d[8]=1-P-V,d},ie.normalFromMat4=function(d,g){var S=g[0],M=g[1],L=g[2],w=g[3],A=g[4],R=g[5],C=g[6],P=g[7],D=g[8],V=g[9],q=g[10],K=g[11],Q=g[12],X=g[13],re=g[14],de=g[15],ye=S*R-M*A,Ce=S*C-L*A,Ee=S*P-w*A,Te=M*C-L*R,Be=M*P-w*R,Ae=L*P-w*C,Ue=D*X-V*Q,He=D*re-q*Q,Ge=D*de-K*Q,Ke=V*re-q*X,rt=V*de-K*X,dt=q*de-K*re,Qe=ye*dt-Ce*rt+Ee*Ke+Te*Ge-Be*He+Ae*Ue;return Qe?(d[0]=(R*dt-C*rt+P*Ke)*(Qe=1/Qe),d[1]=(C*Ge-A*dt-P*He)*Qe,d[2]=(A*rt-R*Ge+P*Ue)*Qe,d[3]=(L*rt-M*dt-w*Ke)*Qe,d[4]=(S*dt-L*Ge+w*He)*Qe,d[5]=(M*Ge-S*rt-w*Ue)*Qe,d[6]=(X*Ae-re*Be+de*Te)*Qe,d[7]=(re*Ee-Q*Ae-de*Ce)*Qe,d[8]=(Q*Be-X*Ee+de*ye)*Qe,d):null},ie.projection=function(d,g,S){return d[0]=2/g,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/S,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},ie.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},ie.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},ie.add=function(d,g,S){return d[0]=g[0]+S[0],d[1]=g[1]+S[1],d[2]=g[2]+S[2],d[3]=g[3]+S[3],d[4]=g[4]+S[4],d[5]=g[5]+S[5],d[6]=g[6]+S[6],d[7]=g[7]+S[7],d[8]=g[8]+S[8],d},ie.subtract=f,ie.multiplyScalar=function(d,g,S){return d[0]=g[0]*S,d[1]=g[1]*S,d[2]=g[2]*S,d[3]=g[3]*S,d[4]=g[4]*S,d[5]=g[5]*S,d[6]=g[6]*S,d[7]=g[7]*S,d[8]=g[8]*S,d},ie.multiplyScalarAndAdd=function(d,g,S,M){return d[0]=g[0]+S[0]*M,d[1]=g[1]+S[1]*M,d[2]=g[2]+S[2]*M,d[3]=g[3]+S[3]*M,d[4]=g[4]+S[4]*M,d[5]=g[5]+S[5]*M,d[6]=g[6]+S[6]*M,d[7]=g[7]+S[7]*M,d[8]=g[8]+S[8]*M,d},ie.exactEquals=function(d,g){return d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2]&&d[3]===g[3]&&d[4]===g[4]&&d[5]===g[5]&&d[6]===g[6]&&d[7]===g[7]&&d[8]===g[8]},ie.equals=function(d,g){var S=d[0],M=d[1],L=d[2],w=d[3],A=d[4],R=d[5],C=d[6],P=d[7],D=d[8],V=g[0],q=g[1],K=g[2],Q=g[3],X=g[4],re=g[5],de=g[6],ye=g[7],Ce=g[8];return Math.abs(S-V)<=e.EPSILON*Math.max(1,Math.abs(S),Math.abs(V))&&Math.abs(M-q)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(q))&&Math.abs(L-K)<=e.EPSILON*Math.max(1,Math.abs(L),Math.abs(K))&&Math.abs(w-Q)<=e.EPSILON*Math.max(1,Math.abs(w),Math.abs(Q))&&Math.abs(A-X)<=e.EPSILON*Math.max(1,Math.abs(A),Math.abs(X))&&Math.abs(R-re)<=e.EPSILON*Math.max(1,Math.abs(R),Math.abs(re))&&Math.abs(C-de)<=e.EPSILON*Math.max(1,Math.abs(C),Math.abs(de))&&Math.abs(P-ye)<=e.EPSILON*Math.max(1,Math.abs(P),Math.abs(ye))&&Math.abs(D-Ce)<=e.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ce))},ie.sub=ie.mul=void 0;var e=function(d,g){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var S=o(void 0);if(S&&S.has(d))return S.get(d);var M={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in d)if(w!=="default"&&Object.prototype.hasOwnProperty.call(d,w)){var A=L?Object.getOwnPropertyDescriptor(d,w):null;A&&(A.get||A.set)?Object.defineProperty(M,w,A):M[w]=d[w]}return M.default=d,S&&S.set(d,M),M}(J());function o(d){if(typeof WeakMap!="function")return null;var g=new WeakMap,S=new WeakMap;return(o=function(M){return M?S:g})(d)}function c(d,g,S){var M=g[0],L=g[1],w=g[2],A=g[3],R=g[4],C=g[5],P=g[6],D=g[7],V=g[8],q=S[0],K=S[1],Q=S[2],X=S[3],re=S[4],de=S[5],ye=S[6],Ce=S[7],Ee=S[8];return d[0]=q*M+K*A+Q*P,d[1]=q*L+K*R+Q*D,d[2]=q*w+K*C+Q*V,d[3]=X*M+re*A+de*P,d[4]=X*L+re*R+de*D,d[5]=X*w+re*C+de*V,d[6]=ye*M+Ce*A+Ee*P,d[7]=ye*L+Ce*R+Ee*D,d[8]=ye*w+Ce*C+Ee*V,d}function f(d,g,S){return d[0]=g[0]-S[0],d[1]=g[1]-S[1],d[2]=g[2]-S[2],d[3]=g[3]-S[3],d[4]=g[4]-S[4],d[5]=g[5]-S[5],d[6]=g[6]-S[6],d[7]=g[7]-S[7],d[8]=g[8]-S[8],d}return ie.mul=c,ie.sub=f,ie}var we,xe={};function $e(){if(we)return xe;function l(w){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},l(w)}we=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.create=function(){var w=new e.ARRAY_TYPE(16);return e.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},xe.clone=function(w){var A=new e.ARRAY_TYPE(16);return A[0]=w[0],A[1]=w[1],A[2]=w[2],A[3]=w[3],A[4]=w[4],A[5]=w[5],A[6]=w[6],A[7]=w[7],A[8]=w[8],A[9]=w[9],A[10]=w[10],A[11]=w[11],A[12]=w[12],A[13]=w[13],A[14]=w[14],A[15]=w[15],A},xe.copy=function(w,A){return w[0]=A[0],w[1]=A[1],w[2]=A[2],w[3]=A[3],w[4]=A[4],w[5]=A[5],w[6]=A[6],w[7]=A[7],w[8]=A[8],w[9]=A[9],w[10]=A[10],w[11]=A[11],w[12]=A[12],w[13]=A[13],w[14]=A[14],w[15]=A[15],w},xe.fromValues=function(w,A,R,C,P,D,V,q,K,Q,X,re,de,ye,Ce,Ee){var Te=new e.ARRAY_TYPE(16);return Te[0]=w,Te[1]=A,Te[2]=R,Te[3]=C,Te[4]=P,Te[5]=D,Te[6]=V,Te[7]=q,Te[8]=K,Te[9]=Q,Te[10]=X,Te[11]=re,Te[12]=de,Te[13]=ye,Te[14]=Ce,Te[15]=Ee,Te},xe.set=function(w,A,R,C,P,D,V,q,K,Q,X,re,de,ye,Ce,Ee,Te){return w[0]=A,w[1]=R,w[2]=C,w[3]=P,w[4]=D,w[5]=V,w[6]=q,w[7]=K,w[8]=Q,w[9]=X,w[10]=re,w[11]=de,w[12]=ye,w[13]=Ce,w[14]=Ee,w[15]=Te,w},xe.identity=c,xe.transpose=function(w,A){if(w===A){var R=A[1],C=A[2],P=A[3],D=A[6],V=A[7],q=A[11];w[1]=A[4],w[2]=A[8],w[3]=A[12],w[4]=R,w[6]=A[9],w[7]=A[13],w[8]=C,w[9]=D,w[11]=A[14],w[12]=P,w[13]=V,w[14]=q}else w[0]=A[0],w[1]=A[4],w[2]=A[8],w[3]=A[12],w[4]=A[1],w[5]=A[5],w[6]=A[9],w[7]=A[13],w[8]=A[2],w[9]=A[6],w[10]=A[10],w[11]=A[14],w[12]=A[3],w[13]=A[7],w[14]=A[11],w[15]=A[15];return w},xe.invert=function(w,A){var R=A[0],C=A[1],P=A[2],D=A[3],V=A[4],q=A[5],K=A[6],Q=A[7],X=A[8],re=A[9],de=A[10],ye=A[11],Ce=A[12],Ee=A[13],Te=A[14],Be=A[15],Ae=R*q-C*V,Ue=R*K-P*V,He=R*Q-D*V,Ge=C*K-P*q,Ke=C*Q-D*q,rt=P*Q-D*K,dt=X*Ee-re*Ce,Qe=X*Te-de*Ce,wt=X*Be-ye*Ce,qt=re*Te-de*Ee,Tt=re*Be-ye*Ee,Qt=de*Be-ye*Te,Kt=Ae*Qt-Ue*Tt+He*qt+Ge*wt-Ke*Qe+rt*dt;return Kt?(w[0]=(q*Qt-K*Tt+Q*qt)*(Kt=1/Kt),w[1]=(P*Tt-C*Qt-D*qt)*Kt,w[2]=(Ee*rt-Te*Ke+Be*Ge)*Kt,w[3]=(de*Ke-re*rt-ye*Ge)*Kt,w[4]=(K*wt-V*Qt-Q*Qe)*Kt,w[5]=(R*Qt-P*wt+D*Qe)*Kt,w[6]=(Te*He-Ce*rt-Be*Ue)*Kt,w[7]=(X*rt-de*He+ye*Ue)*Kt,w[8]=(V*Tt-q*wt+Q*dt)*Kt,w[9]=(C*wt-R*Tt-D*dt)*Kt,w[10]=(Ce*Ke-Ee*He+Be*Ae)*Kt,w[11]=(re*He-X*Ke-ye*Ae)*Kt,w[12]=(q*Qe-V*qt-K*dt)*Kt,w[13]=(R*qt-C*Qe+P*dt)*Kt,w[14]=(Ee*Ue-Ce*Ge-Te*Ae)*Kt,w[15]=(X*Ge-re*Ue+de*Ae)*Kt,w):null},xe.adjoint=function(w,A){var R=A[0],C=A[1],P=A[2],D=A[3],V=A[4],q=A[5],K=A[6],Q=A[7],X=A[8],re=A[9],de=A[10],ye=A[11],Ce=A[12],Ee=A[13],Te=A[14],Be=A[15];return w[0]=q*(de*Be-ye*Te)-re*(K*Be-Q*Te)+Ee*(K*ye-Q*de),w[1]=-(C*(de*Be-ye*Te)-re*(P*Be-D*Te)+Ee*(P*ye-D*de)),w[2]=C*(K*Be-Q*Te)-q*(P*Be-D*Te)+Ee*(P*Q-D*K),w[3]=-(C*(K*ye-Q*de)-q*(P*ye-D*de)+re*(P*Q-D*K)),w[4]=-(V*(de*Be-ye*Te)-X*(K*Be-Q*Te)+Ce*(K*ye-Q*de)),w[5]=R*(de*Be-ye*Te)-X*(P*Be-D*Te)+Ce*(P*ye-D*de),w[6]=-(R*(K*Be-Q*Te)-V*(P*Be-D*Te)+Ce*(P*Q-D*K)),w[7]=R*(K*ye-Q*de)-V*(P*ye-D*de)+X*(P*Q-D*K),w[8]=V*(re*Be-ye*Ee)-X*(q*Be-Q*Ee)+Ce*(q*ye-Q*re),w[9]=-(R*(re*Be-ye*Ee)-X*(C*Be-D*Ee)+Ce*(C*ye-D*re)),w[10]=R*(q*Be-Q*Ee)-V*(C*Be-D*Ee)+Ce*(C*Q-D*q),w[11]=-(R*(q*ye-Q*re)-V*(C*ye-D*re)+X*(C*Q-D*q)),w[12]=-(V*(re*Te-de*Ee)-X*(q*Te-K*Ee)+Ce*(q*de-K*re)),w[13]=R*(re*Te-de*Ee)-X*(C*Te-P*Ee)+Ce*(C*de-P*re),w[14]=-(R*(q*Te-K*Ee)-V*(C*Te-P*Ee)+Ce*(C*K-P*q)),w[15]=R*(q*de-K*re)-V*(C*de-P*re)+X*(C*K-P*q),w},xe.determinant=function(w){var A=w[0],R=w[1],C=w[2],P=w[3],D=w[4],V=w[5],q=w[6],K=w[7],Q=w[8],X=w[9],re=w[10],de=w[11],ye=w[12],Ce=w[13],Ee=w[14],Te=w[15];return(A*V-R*D)*(re*Te-de*Ee)-(A*q-C*D)*(X*Te-de*Ce)+(A*K-P*D)*(X*Ee-re*Ce)+(R*q-C*V)*(Q*Te-de*ye)-(R*K-P*V)*(Q*Ee-re*ye)+(C*K-P*q)*(Q*Ce-X*ye)},xe.multiply=f,xe.translate=function(w,A,R){var C,P,D,V,q,K,Q,X,re,de,ye,Ce,Ee=R[0],Te=R[1],Be=R[2];return A===w?(w[12]=A[0]*Ee+A[4]*Te+A[8]*Be+A[12],w[13]=A[1]*Ee+A[5]*Te+A[9]*Be+A[13],w[14]=A[2]*Ee+A[6]*Te+A[10]*Be+A[14],w[15]=A[3]*Ee+A[7]*Te+A[11]*Be+A[15]):(P=A[1],D=A[2],V=A[3],q=A[4],K=A[5],Q=A[6],X=A[7],re=A[8],de=A[9],ye=A[10],Ce=A[11],w[0]=C=A[0],w[1]=P,w[2]=D,w[3]=V,w[4]=q,w[5]=K,w[6]=Q,w[7]=X,w[8]=re,w[9]=de,w[10]=ye,w[11]=Ce,w[12]=C*Ee+q*Te+re*Be+A[12],w[13]=P*Ee+K*Te+de*Be+A[13],w[14]=D*Ee+Q*Te+ye*Be+A[14],w[15]=V*Ee+X*Te+Ce*Be+A[15]),w},xe.scale=function(w,A,R){var C=R[0],P=R[1],D=R[2];return w[0]=A[0]*C,w[1]=A[1]*C,w[2]=A[2]*C,w[3]=A[3]*C,w[4]=A[4]*P,w[5]=A[5]*P,w[6]=A[6]*P,w[7]=A[7]*P,w[8]=A[8]*D,w[9]=A[9]*D,w[10]=A[10]*D,w[11]=A[11]*D,w[12]=A[12],w[13]=A[13],w[14]=A[14],w[15]=A[15],w},xe.rotate=function(w,A,R,C){var P,D,V,q,K,Q,X,re,de,ye,Ce,Ee,Te,Be,Ae,Ue,He,Ge,Ke,rt,dt,Qe,wt,qt,Tt=C[0],Qt=C[1],Kt=C[2],ln=Math.hypot(Tt,Qt,Kt);return ln<e.EPSILON?null:(Tt*=ln=1/ln,Qt*=ln,Kt*=ln,P=Math.sin(R),D=Math.cos(R),K=A[1],Q=A[2],X=A[3],de=A[5],ye=A[6],Ce=A[7],Te=A[9],Be=A[10],Ae=A[11],Ue=Tt*Tt*(V=1-D)+D,Ke=Tt*Qt*V-Kt*P,rt=Qt*Qt*V+D,dt=Kt*Qt*V+Tt*P,Qe=Tt*Kt*V+Qt*P,wt=Qt*Kt*V-Tt*P,qt=Kt*Kt*V+D,w[0]=(q=A[0])*Ue+(re=A[4])*(He=Qt*Tt*V+Kt*P)+(Ee=A[8])*(Ge=Kt*Tt*V-Qt*P),w[1]=K*Ue+de*He+Te*Ge,w[2]=Q*Ue+ye*He+Be*Ge,w[3]=X*Ue+Ce*He+Ae*Ge,w[4]=q*Ke+re*rt+Ee*dt,w[5]=K*Ke+de*rt+Te*dt,w[6]=Q*Ke+ye*rt+Be*dt,w[7]=X*Ke+Ce*rt+Ae*dt,w[8]=q*Qe+re*wt+Ee*qt,w[9]=K*Qe+de*wt+Te*qt,w[10]=Q*Qe+ye*wt+Be*qt,w[11]=X*Qe+Ce*wt+Ae*qt,A!==w&&(w[12]=A[12],w[13]=A[13],w[14]=A[14],w[15]=A[15]),w)},xe.rotateX=function(w,A,R){var C=Math.sin(R),P=Math.cos(R),D=A[4],V=A[5],q=A[6],K=A[7],Q=A[8],X=A[9],re=A[10],de=A[11];return A!==w&&(w[0]=A[0],w[1]=A[1],w[2]=A[2],w[3]=A[3],w[12]=A[12],w[13]=A[13],w[14]=A[14],w[15]=A[15]),w[4]=D*P+Q*C,w[5]=V*P+X*C,w[6]=q*P+re*C,w[7]=K*P+de*C,w[8]=Q*P-D*C,w[9]=X*P-V*C,w[10]=re*P-q*C,w[11]=de*P-K*C,w},xe.rotateY=function(w,A,R){var C=Math.sin(R),P=Math.cos(R),D=A[0],V=A[1],q=A[2],K=A[3],Q=A[8],X=A[9],re=A[10],de=A[11];return A!==w&&(w[4]=A[4],w[5]=A[5],w[6]=A[6],w[7]=A[7],w[12]=A[12],w[13]=A[13],w[14]=A[14],w[15]=A[15]),w[0]=D*P-Q*C,w[1]=V*P-X*C,w[2]=q*P-re*C,w[3]=K*P-de*C,w[8]=D*C+Q*P,w[9]=V*C+X*P,w[10]=q*C+re*P,w[11]=K*C+de*P,w},xe.rotateZ=function(w,A,R){var C=Math.sin(R),P=Math.cos(R),D=A[0],V=A[1],q=A[2],K=A[3],Q=A[4],X=A[5],re=A[6],de=A[7];return A!==w&&(w[8]=A[8],w[9]=A[9],w[10]=A[10],w[11]=A[11],w[12]=A[12],w[13]=A[13],w[14]=A[14],w[15]=A[15]),w[0]=D*P+Q*C,w[1]=V*P+X*C,w[2]=q*P+re*C,w[3]=K*P+de*C,w[4]=Q*P-D*C,w[5]=X*P-V*C,w[6]=re*P-q*C,w[7]=de*P-K*C,w},xe.fromTranslation=function(w,A){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=A[0],w[13]=A[1],w[14]=A[2],w[15]=1,w},xe.fromScaling=function(w,A){return w[0]=A[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=A[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=A[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},xe.fromRotation=function(w,A,R){var C,P,D,V=R[0],q=R[1],K=R[2],Q=Math.hypot(V,q,K);return Q<e.EPSILON?null:(V*=Q=1/Q,q*=Q,K*=Q,C=Math.sin(A),P=Math.cos(A),w[0]=V*V*(D=1-P)+P,w[1]=q*V*D+K*C,w[2]=K*V*D-q*C,w[3]=0,w[4]=V*q*D-K*C,w[5]=q*q*D+P,w[6]=K*q*D+V*C,w[7]=0,w[8]=V*K*D+q*C,w[9]=q*K*D-V*C,w[10]=K*K*D+P,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},xe.fromXRotation=function(w,A){var R=Math.sin(A),C=Math.cos(A);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=C,w[6]=R,w[7]=0,w[8]=0,w[9]=-R,w[10]=C,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},xe.fromYRotation=function(w,A){var R=Math.sin(A),C=Math.cos(A);return w[0]=C,w[1]=0,w[2]=-R,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=R,w[9]=0,w[10]=C,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},xe.fromZRotation=function(w,A){var R=Math.sin(A),C=Math.cos(A);return w[0]=C,w[1]=R,w[2]=0,w[3]=0,w[4]=-R,w[5]=C,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},xe.fromRotationTranslation=d,xe.fromQuat2=function(w,A){var R=new e.ARRAY_TYPE(3),C=-A[0],P=-A[1],D=-A[2],V=A[3],q=A[4],K=A[5],Q=A[6],X=A[7],re=C*C+P*P+D*D+V*V;return re>0?(R[0]=2*(q*V+X*C+K*D-Q*P)/re,R[1]=2*(K*V+X*P+Q*C-q*D)/re,R[2]=2*(Q*V+X*D+q*P-K*C)/re):(R[0]=2*(q*V+X*C+K*D-Q*P),R[1]=2*(K*V+X*P+Q*C-q*D),R[2]=2*(Q*V+X*D+q*P-K*C)),d(w,A,R),w},xe.getTranslation=function(w,A){return w[0]=A[12],w[1]=A[13],w[2]=A[14],w},xe.getScaling=g,xe.getRotation=function(w,A){var R=new e.ARRAY_TYPE(3);g(R,A);var C=1/R[0],P=1/R[1],D=1/R[2],V=A[0]*C,q=A[1]*P,K=A[2]*D,Q=A[4]*C,X=A[5]*P,re=A[6]*D,de=A[8]*C,ye=A[9]*P,Ce=A[10]*D,Ee=V+X+Ce,Te=0;return Ee>0?(Te=2*Math.sqrt(Ee+1),w[3]=.25*Te,w[0]=(re-ye)/Te,w[1]=(de-K)/Te,w[2]=(q-Q)/Te):V>X&&V>Ce?(Te=2*Math.sqrt(1+V-X-Ce),w[3]=(re-ye)/Te,w[0]=.25*Te,w[1]=(q+Q)/Te,w[2]=(de+K)/Te):X>Ce?(Te=2*Math.sqrt(1+X-V-Ce),w[3]=(de-K)/Te,w[0]=(q+Q)/Te,w[1]=.25*Te,w[2]=(re+ye)/Te):(Te=2*Math.sqrt(1+Ce-V-X),w[3]=(q-Q)/Te,w[0]=(de+K)/Te,w[1]=(re+ye)/Te,w[2]=.25*Te),w},xe.fromRotationTranslationScale=function(w,A,R,C){var P=A[0],D=A[1],V=A[2],q=A[3],K=P+P,Q=D+D,X=V+V,re=P*K,de=P*Q,ye=P*X,Ce=D*Q,Ee=D*X,Te=V*X,Be=q*K,Ae=q*Q,Ue=q*X,He=C[0],Ge=C[1],Ke=C[2];return w[0]=(1-(Ce+Te))*He,w[1]=(de+Ue)*He,w[2]=(ye-Ae)*He,w[3]=0,w[4]=(de-Ue)*Ge,w[5]=(1-(re+Te))*Ge,w[6]=(Ee+Be)*Ge,w[7]=0,w[8]=(ye+Ae)*Ke,w[9]=(Ee-Be)*Ke,w[10]=(1-(re+Ce))*Ke,w[11]=0,w[12]=R[0],w[13]=R[1],w[14]=R[2],w[15]=1,w},xe.fromRotationTranslationScaleOrigin=function(w,A,R,C,P){var D=A[0],V=A[1],q=A[2],K=A[3],Q=D+D,X=V+V,re=q+q,de=D*Q,ye=D*X,Ce=D*re,Ee=V*X,Te=V*re,Be=q*re,Ae=K*Q,Ue=K*X,He=K*re,Ge=C[0],Ke=C[1],rt=C[2],dt=P[0],Qe=P[1],wt=P[2],qt=(1-(Ee+Be))*Ge,Tt=(ye+He)*Ge,Qt=(Ce-Ue)*Ge,Kt=(ye-He)*Ke,ln=(1-(de+Be))*Ke,Pt=(Te+Ae)*Ke,En=(Ce+Ue)*rt,en=(Te-Ae)*rt,bn=(1-(de+Ee))*rt;return w[0]=qt,w[1]=Tt,w[2]=Qt,w[3]=0,w[4]=Kt,w[5]=ln,w[6]=Pt,w[7]=0,w[8]=En,w[9]=en,w[10]=bn,w[11]=0,w[12]=R[0]+dt-(qt*dt+Kt*Qe+En*wt),w[13]=R[1]+Qe-(Tt*dt+ln*Qe+en*wt),w[14]=R[2]+wt-(Qt*dt+Pt*Qe+bn*wt),w[15]=1,w},xe.fromQuat=function(w,A){var R=A[0],C=A[1],P=A[2],D=A[3],V=R+R,q=C+C,K=P+P,Q=R*V,X=C*V,re=C*q,de=P*V,ye=P*q,Ce=P*K,Ee=D*V,Te=D*q,Be=D*K;return w[0]=1-re-Ce,w[1]=X+Be,w[2]=de-Te,w[3]=0,w[4]=X-Be,w[5]=1-Q-Ce,w[6]=ye+Ee,w[7]=0,w[8]=de+Te,w[9]=ye-Ee,w[10]=1-Q-re,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},xe.frustum=function(w,A,R,C,P,D,V){var q=1/(R-A),K=1/(P-C),Q=1/(D-V);return w[0]=2*D*q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*D*K,w[6]=0,w[7]=0,w[8]=(R+A)*q,w[9]=(P+C)*K,w[10]=(V+D)*Q,w[11]=-1,w[12]=0,w[13]=0,w[14]=V*D*2*Q,w[15]=0,w},xe.perspectiveNO=S,xe.perspectiveZO=function(w,A,R,C,P){var D,V=1/Math.tan(A/2);return w[0]=V/R,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=V,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,P!=null&&P!==1/0?(w[10]=P*(D=1/(C-P)),w[14]=P*C*D):(w[10]=-1,w[14]=-C),w},xe.perspectiveFromFieldOfView=function(w,A,R,C){var P=Math.tan(A.upDegrees*Math.PI/180),D=Math.tan(A.downDegrees*Math.PI/180),V=Math.tan(A.leftDegrees*Math.PI/180),q=Math.tan(A.rightDegrees*Math.PI/180),K=2/(V+q),Q=2/(P+D);return w[0]=K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Q,w[6]=0,w[7]=0,w[8]=-(V-q)*K*.5,w[9]=(P-D)*Q*.5,w[10]=C/(R-C),w[11]=-1,w[12]=0,w[13]=0,w[14]=C*R/(R-C),w[15]=0,w},xe.orthoNO=M,xe.orthoZO=function(w,A,R,C,P,D,V){var q=1/(A-R),K=1/(C-P),Q=1/(D-V);return w[0]=-2*q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*K,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=Q,w[11]=0,w[12]=(A+R)*q,w[13]=(P+C)*K,w[14]=D*Q,w[15]=1,w},xe.lookAt=function(w,A,R,C){var P,D,V,q,K,Q,X,re,de,ye,Ce=A[0],Ee=A[1],Te=A[2],Be=C[0],Ae=C[1],Ue=C[2],He=R[0],Ge=R[1],Ke=R[2];return Math.abs(Ce-He)<e.EPSILON&&Math.abs(Ee-Ge)<e.EPSILON&&Math.abs(Te-Ke)<e.EPSILON?c(w):(X=Ce-He,re=Ee-Ge,de=Te-Ke,P=Ae*(de*=ye=1/Math.hypot(X,re,de))-Ue*(re*=ye),D=Ue*(X*=ye)-Be*de,V=Be*re-Ae*X,(ye=Math.hypot(P,D,V))?(P*=ye=1/ye,D*=ye,V*=ye):(P=0,D=0,V=0),q=re*V-de*D,K=de*P-X*V,Q=X*D-re*P,(ye=Math.hypot(q,K,Q))?(q*=ye=1/ye,K*=ye,Q*=ye):(q=0,K=0,Q=0),w[0]=P,w[1]=q,w[2]=X,w[3]=0,w[4]=D,w[5]=K,w[6]=re,w[7]=0,w[8]=V,w[9]=Q,w[10]=de,w[11]=0,w[12]=-(P*Ce+D*Ee+V*Te),w[13]=-(q*Ce+K*Ee+Q*Te),w[14]=-(X*Ce+re*Ee+de*Te),w[15]=1,w)},xe.targetTo=function(w,A,R,C){var P=A[0],D=A[1],V=A[2],q=C[0],K=C[1],Q=C[2],X=P-R[0],re=D-R[1],de=V-R[2],ye=X*X+re*re+de*de;ye>0&&(X*=ye=1/Math.sqrt(ye),re*=ye,de*=ye);var Ce=K*de-Q*re,Ee=Q*X-q*de,Te=q*re-K*X;return(ye=Ce*Ce+Ee*Ee+Te*Te)>0&&(Ce*=ye=1/Math.sqrt(ye),Ee*=ye,Te*=ye),w[0]=Ce,w[1]=Ee,w[2]=Te,w[3]=0,w[4]=re*Te-de*Ee,w[5]=de*Ce-X*Te,w[6]=X*Ee-re*Ce,w[7]=0,w[8]=X,w[9]=re,w[10]=de,w[11]=0,w[12]=P,w[13]=D,w[14]=V,w[15]=1,w},xe.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},xe.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},xe.add=function(w,A,R){return w[0]=A[0]+R[0],w[1]=A[1]+R[1],w[2]=A[2]+R[2],w[3]=A[3]+R[3],w[4]=A[4]+R[4],w[5]=A[5]+R[5],w[6]=A[6]+R[6],w[7]=A[7]+R[7],w[8]=A[8]+R[8],w[9]=A[9]+R[9],w[10]=A[10]+R[10],w[11]=A[11]+R[11],w[12]=A[12]+R[12],w[13]=A[13]+R[13],w[14]=A[14]+R[14],w[15]=A[15]+R[15],w},xe.subtract=L,xe.multiplyScalar=function(w,A,R){return w[0]=A[0]*R,w[1]=A[1]*R,w[2]=A[2]*R,w[3]=A[3]*R,w[4]=A[4]*R,w[5]=A[5]*R,w[6]=A[6]*R,w[7]=A[7]*R,w[8]=A[8]*R,w[9]=A[9]*R,w[10]=A[10]*R,w[11]=A[11]*R,w[12]=A[12]*R,w[13]=A[13]*R,w[14]=A[14]*R,w[15]=A[15]*R,w},xe.multiplyScalarAndAdd=function(w,A,R,C){return w[0]=A[0]+R[0]*C,w[1]=A[1]+R[1]*C,w[2]=A[2]+R[2]*C,w[3]=A[3]+R[3]*C,w[4]=A[4]+R[4]*C,w[5]=A[5]+R[5]*C,w[6]=A[6]+R[6]*C,w[7]=A[7]+R[7]*C,w[8]=A[8]+R[8]*C,w[9]=A[9]+R[9]*C,w[10]=A[10]+R[10]*C,w[11]=A[11]+R[11]*C,w[12]=A[12]+R[12]*C,w[13]=A[13]+R[13]*C,w[14]=A[14]+R[14]*C,w[15]=A[15]+R[15]*C,w},xe.exactEquals=function(w,A){return w[0]===A[0]&&w[1]===A[1]&&w[2]===A[2]&&w[3]===A[3]&&w[4]===A[4]&&w[5]===A[5]&&w[6]===A[6]&&w[7]===A[7]&&w[8]===A[8]&&w[9]===A[9]&&w[10]===A[10]&&w[11]===A[11]&&w[12]===A[12]&&w[13]===A[13]&&w[14]===A[14]&&w[15]===A[15]},xe.equals=function(w,A){var R=w[0],C=w[1],P=w[2],D=w[3],V=w[4],q=w[5],K=w[6],Q=w[7],X=w[8],re=w[9],de=w[10],ye=w[11],Ce=w[12],Ee=w[13],Te=w[14],Be=w[15],Ae=A[0],Ue=A[1],He=A[2],Ge=A[3],Ke=A[4],rt=A[5],dt=A[6],Qe=A[7],wt=A[8],qt=A[9],Tt=A[10],Qt=A[11],Kt=A[12],ln=A[13],Pt=A[14],En=A[15];return Math.abs(R-Ae)<=e.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ae))&&Math.abs(C-Ue)<=e.EPSILON*Math.max(1,Math.abs(C),Math.abs(Ue))&&Math.abs(P-He)<=e.EPSILON*Math.max(1,Math.abs(P),Math.abs(He))&&Math.abs(D-Ge)<=e.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ge))&&Math.abs(V-Ke)<=e.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ke))&&Math.abs(q-rt)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(rt))&&Math.abs(K-dt)<=e.EPSILON*Math.max(1,Math.abs(K),Math.abs(dt))&&Math.abs(Q-Qe)<=e.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Qe))&&Math.abs(X-wt)<=e.EPSILON*Math.max(1,Math.abs(X),Math.abs(wt))&&Math.abs(re-qt)<=e.EPSILON*Math.max(1,Math.abs(re),Math.abs(qt))&&Math.abs(de-Tt)<=e.EPSILON*Math.max(1,Math.abs(de),Math.abs(Tt))&&Math.abs(ye-Qt)<=e.EPSILON*Math.max(1,Math.abs(ye),Math.abs(Qt))&&Math.abs(Ce-Kt)<=e.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(Kt))&&Math.abs(Ee-ln)<=e.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(ln))&&Math.abs(Te-Pt)<=e.EPSILON*Math.max(1,Math.abs(Te),Math.abs(Pt))&&Math.abs(Be-En)<=e.EPSILON*Math.max(1,Math.abs(Be),Math.abs(En))},xe.sub=xe.mul=xe.ortho=xe.perspective=void 0;var e=function(w,A){if(w&&w.__esModule)return w;if(w===null||l(w)!=="object"&&typeof w!="function")return{default:w};var R=o(void 0);if(R&&R.has(w))return R.get(w);var C={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in w)if(D!=="default"&&Object.prototype.hasOwnProperty.call(w,D)){var V=P?Object.getOwnPropertyDescriptor(w,D):null;V&&(V.get||V.set)?Object.defineProperty(C,D,V):C[D]=w[D]}return C.default=w,R&&R.set(w,C),C}(J());function o(w){if(typeof WeakMap!="function")return null;var A=new WeakMap,R=new WeakMap;return(o=function(C){return C?R:A})(w)}function c(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function f(w,A,R){var C=A[0],P=A[1],D=A[2],V=A[3],q=A[4],K=A[5],Q=A[6],X=A[7],re=A[8],de=A[9],ye=A[10],Ce=A[11],Ee=A[12],Te=A[13],Be=A[14],Ae=A[15],Ue=R[0],He=R[1],Ge=R[2],Ke=R[3];return w[0]=Ue*C+He*q+Ge*re+Ke*Ee,w[1]=Ue*P+He*K+Ge*de+Ke*Te,w[2]=Ue*D+He*Q+Ge*ye+Ke*Be,w[3]=Ue*V+He*X+Ge*Ce+Ke*Ae,w[4]=(Ue=R[4])*C+(He=R[5])*q+(Ge=R[6])*re+(Ke=R[7])*Ee,w[5]=Ue*P+He*K+Ge*de+Ke*Te,w[6]=Ue*D+He*Q+Ge*ye+Ke*Be,w[7]=Ue*V+He*X+Ge*Ce+Ke*Ae,w[8]=(Ue=R[8])*C+(He=R[9])*q+(Ge=R[10])*re+(Ke=R[11])*Ee,w[9]=Ue*P+He*K+Ge*de+Ke*Te,w[10]=Ue*D+He*Q+Ge*ye+Ke*Be,w[11]=Ue*V+He*X+Ge*Ce+Ke*Ae,w[12]=(Ue=R[12])*C+(He=R[13])*q+(Ge=R[14])*re+(Ke=R[15])*Ee,w[13]=Ue*P+He*K+Ge*de+Ke*Te,w[14]=Ue*D+He*Q+Ge*ye+Ke*Be,w[15]=Ue*V+He*X+Ge*Ce+Ke*Ae,w}function d(w,A,R){var C=A[0],P=A[1],D=A[2],V=A[3],q=C+C,K=P+P,Q=D+D,X=C*q,re=C*K,de=C*Q,ye=P*K,Ce=P*Q,Ee=D*Q,Te=V*q,Be=V*K,Ae=V*Q;return w[0]=1-(ye+Ee),w[1]=re+Ae,w[2]=de-Be,w[3]=0,w[4]=re-Ae,w[5]=1-(X+Ee),w[6]=Ce+Te,w[7]=0,w[8]=de+Be,w[9]=Ce-Te,w[10]=1-(X+ye),w[11]=0,w[12]=R[0],w[13]=R[1],w[14]=R[2],w[15]=1,w}function g(w,A){var R=A[4],C=A[5],P=A[6],D=A[8],V=A[9],q=A[10];return w[0]=Math.hypot(A[0],A[1],A[2]),w[1]=Math.hypot(R,C,P),w[2]=Math.hypot(D,V,q),w}function S(w,A,R,C,P){var D,V=1/Math.tan(A/2);return w[0]=V/R,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=V,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,P!=null&&P!==1/0?(w[10]=(P+C)*(D=1/(C-P)),w[14]=2*P*C*D):(w[10]=-1,w[14]=-2*C),w}function M(w,A,R,C,P,D,V){var q=1/(A-R),K=1/(C-P),Q=1/(D-V);return w[0]=-2*q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*K,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*Q,w[11]=0,w[12]=(A+R)*q,w[13]=(P+C)*K,w[14]=(V+D)*Q,w[15]=1,w}function L(w,A,R){return w[0]=A[0]-R[0],w[1]=A[1]-R[1],w[2]=A[2]-R[2],w[3]=A[3]-R[3],w[4]=A[4]-R[4],w[5]=A[5]-R[5],w[6]=A[6]-R[6],w[7]=A[7]-R[7],w[8]=A[8]-R[8],w[9]=A[9]-R[9],w[10]=A[10]-R[10],w[11]=A[11]-R[11],w[12]=A[12]-R[12],w[13]=A[13]-R[13],w[14]=A[14]-R[14],w[15]=A[15]-R[15],w}return xe.perspective=S,xe.ortho=M,xe.mul=f,xe.sub=L,xe}var Ze,ae={},ke={};function ct(){if(Ze)return ke;function l(P){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},l(P)}Ze=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.create=c,ke.clone=function(P){var D=new e.ARRAY_TYPE(3);return D[0]=P[0],D[1]=P[1],D[2]=P[2],D},ke.length=f,ke.fromValues=function(P,D,V){var q=new e.ARRAY_TYPE(3);return q[0]=P,q[1]=D,q[2]=V,q},ke.copy=function(P,D){return P[0]=D[0],P[1]=D[1],P[2]=D[2],P},ke.set=function(P,D,V,q){return P[0]=D,P[1]=V,P[2]=q,P},ke.add=function(P,D,V){return P[0]=D[0]+V[0],P[1]=D[1]+V[1],P[2]=D[2]+V[2],P},ke.subtract=d,ke.multiply=g,ke.divide=S,ke.ceil=function(P,D){return P[0]=Math.ceil(D[0]),P[1]=Math.ceil(D[1]),P[2]=Math.ceil(D[2]),P},ke.floor=function(P,D){return P[0]=Math.floor(D[0]),P[1]=Math.floor(D[1]),P[2]=Math.floor(D[2]),P},ke.min=function(P,D,V){return P[0]=Math.min(D[0],V[0]),P[1]=Math.min(D[1],V[1]),P[2]=Math.min(D[2],V[2]),P},ke.max=function(P,D,V){return P[0]=Math.max(D[0],V[0]),P[1]=Math.max(D[1],V[1]),P[2]=Math.max(D[2],V[2]),P},ke.round=function(P,D){return P[0]=Math.round(D[0]),P[1]=Math.round(D[1]),P[2]=Math.round(D[2]),P},ke.scale=function(P,D,V){return P[0]=D[0]*V,P[1]=D[1]*V,P[2]=D[2]*V,P},ke.scaleAndAdd=function(P,D,V,q){return P[0]=D[0]+V[0]*q,P[1]=D[1]+V[1]*q,P[2]=D[2]+V[2]*q,P},ke.distance=M,ke.squaredDistance=L,ke.squaredLength=w,ke.negate=function(P,D){return P[0]=-D[0],P[1]=-D[1],P[2]=-D[2],P},ke.inverse=function(P,D){return P[0]=1/D[0],P[1]=1/D[1],P[2]=1/D[2],P},ke.normalize=function(P,D){var V=D[0],q=D[1],K=D[2],Q=V*V+q*q+K*K;return Q>0&&(Q=1/Math.sqrt(Q)),P[0]=D[0]*Q,P[1]=D[1]*Q,P[2]=D[2]*Q,P},ke.dot=A,ke.cross=function(P,D,V){var q=D[0],K=D[1],Q=D[2],X=V[0],re=V[1],de=V[2];return P[0]=K*de-Q*re,P[1]=Q*X-q*de,P[2]=q*re-K*X,P},ke.lerp=function(P,D,V,q){var K=D[0],Q=D[1],X=D[2];return P[0]=K+q*(V[0]-K),P[1]=Q+q*(V[1]-Q),P[2]=X+q*(V[2]-X),P},ke.hermite=function(P,D,V,q,K,Q){var X=Q*Q,re=X*(2*Q-3)+1,de=X*(Q-2)+Q,ye=X*(Q-1),Ce=X*(3-2*Q);return P[0]=D[0]*re+V[0]*de+q[0]*ye+K[0]*Ce,P[1]=D[1]*re+V[1]*de+q[1]*ye+K[1]*Ce,P[2]=D[2]*re+V[2]*de+q[2]*ye+K[2]*Ce,P},ke.bezier=function(P,D,V,q,K,Q){var X=1-Q,re=X*X,de=Q*Q,ye=re*X,Ce=3*Q*re,Ee=3*de*X,Te=de*Q;return P[0]=D[0]*ye+V[0]*Ce+q[0]*Ee+K[0]*Te,P[1]=D[1]*ye+V[1]*Ce+q[1]*Ee+K[1]*Te,P[2]=D[2]*ye+V[2]*Ce+q[2]*Ee+K[2]*Te,P},ke.random=function(P,D){D=D||1;var V=2*e.RANDOM()*Math.PI,q=2*e.RANDOM()-1,K=Math.sqrt(1-q*q)*D;return P[0]=Math.cos(V)*K,P[1]=Math.sin(V)*K,P[2]=q*D,P},ke.transformMat4=function(P,D,V){var q=D[0],K=D[1],Q=D[2],X=V[3]*q+V[7]*K+V[11]*Q+V[15];return P[0]=(V[0]*q+V[4]*K+V[8]*Q+V[12])/(X=X||1),P[1]=(V[1]*q+V[5]*K+V[9]*Q+V[13])/X,P[2]=(V[2]*q+V[6]*K+V[10]*Q+V[14])/X,P},ke.transformMat3=function(P,D,V){var q=D[0],K=D[1],Q=D[2];return P[0]=q*V[0]+K*V[3]+Q*V[6],P[1]=q*V[1]+K*V[4]+Q*V[7],P[2]=q*V[2]+K*V[5]+Q*V[8],P},ke.transformQuat=function(P,D,V){var q=V[0],K=V[1],Q=V[2],X=D[0],re=D[1],de=D[2],ye=K*de-Q*re,Ce=Q*X-q*de,Ee=q*re-K*X,Te=K*Ee-Q*Ce,Be=Q*ye-q*Ee,Ae=q*Ce-K*ye,Ue=2*V[3];return Ce*=Ue,Ee*=Ue,Be*=2,Ae*=2,P[0]=X+(ye*=Ue)+(Te*=2),P[1]=re+Ce+Be,P[2]=de+Ee+Ae,P},ke.rotateX=function(P,D,V,q){var K=[],Q=[];return K[0]=D[0]-V[0],K[1]=D[1]-V[1],K[2]=D[2]-V[2],Q[0]=K[0],Q[1]=K[1]*Math.cos(q)-K[2]*Math.sin(q),Q[2]=K[1]*Math.sin(q)+K[2]*Math.cos(q),P[0]=Q[0]+V[0],P[1]=Q[1]+V[1],P[2]=Q[2]+V[2],P},ke.rotateY=function(P,D,V,q){var K=[],Q=[];return K[0]=D[0]-V[0],K[1]=D[1]-V[1],K[2]=D[2]-V[2],Q[0]=K[2]*Math.sin(q)+K[0]*Math.cos(q),Q[1]=K[1],Q[2]=K[2]*Math.cos(q)-K[0]*Math.sin(q),P[0]=Q[0]+V[0],P[1]=Q[1]+V[1],P[2]=Q[2]+V[2],P},ke.rotateZ=function(P,D,V,q){var K=[],Q=[];return K[0]=D[0]-V[0],K[1]=D[1]-V[1],K[2]=D[2]-V[2],Q[0]=K[0]*Math.cos(q)-K[1]*Math.sin(q),Q[1]=K[0]*Math.sin(q)+K[1]*Math.cos(q),Q[2]=K[2],P[0]=Q[0]+V[0],P[1]=Q[1]+V[1],P[2]=Q[2]+V[2],P},ke.angle=function(P,D){var V=P[0],q=P[1],K=P[2],Q=D[0],X=D[1],re=D[2],de=Math.sqrt(V*V+q*q+K*K)*Math.sqrt(Q*Q+X*X+re*re),ye=de&&A(P,D)/de;return Math.acos(Math.min(Math.max(ye,-1),1))},ke.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P},ke.str=function(P){return"vec3("+P[0]+", "+P[1]+", "+P[2]+")"},ke.exactEquals=function(P,D){return P[0]===D[0]&&P[1]===D[1]&&P[2]===D[2]},ke.equals=function(P,D){var V=P[0],q=P[1],K=P[2],Q=D[0],X=D[1],re=D[2];return Math.abs(V-Q)<=e.EPSILON*Math.max(1,Math.abs(V),Math.abs(Q))&&Math.abs(q-X)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(X))&&Math.abs(K-re)<=e.EPSILON*Math.max(1,Math.abs(K),Math.abs(re))},ke.forEach=ke.sqrLen=ke.len=ke.sqrDist=ke.dist=ke.div=ke.mul=ke.sub=void 0;var e=function(P,D){if(P&&P.__esModule)return P;if(P===null||l(P)!=="object"&&typeof P!="function")return{default:P};var V=o(void 0);if(V&&V.has(P))return V.get(P);var q={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in P)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(P,Q)){var X=K?Object.getOwnPropertyDescriptor(P,Q):null;X&&(X.get||X.set)?Object.defineProperty(q,Q,X):q[Q]=P[Q]}return q.default=P,V&&V.set(P,q),q}(J());function o(P){if(typeof WeakMap!="function")return null;var D=new WeakMap,V=new WeakMap;return(o=function(q){return q?V:D})(P)}function c(){var P=new e.ARRAY_TYPE(3);return e.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0),P}function f(P){return Math.hypot(P[0],P[1],P[2])}function d(P,D,V){return P[0]=D[0]-V[0],P[1]=D[1]-V[1],P[2]=D[2]-V[2],P}function g(P,D,V){return P[0]=D[0]*V[0],P[1]=D[1]*V[1],P[2]=D[2]*V[2],P}function S(P,D,V){return P[0]=D[0]/V[0],P[1]=D[1]/V[1],P[2]=D[2]/V[2],P}function M(P,D){return Math.hypot(D[0]-P[0],D[1]-P[1],D[2]-P[2])}function L(P,D){var V=D[0]-P[0],q=D[1]-P[1],K=D[2]-P[2];return V*V+q*q+K*K}function w(P){var D=P[0],V=P[1],q=P[2];return D*D+V*V+q*q}function A(P,D){return P[0]*D[0]+P[1]*D[1]+P[2]*D[2]}ke.sub=d,ke.mul=g,ke.div=S,ke.dist=M,ke.sqrDist=L,ke.len=f,ke.sqrLen=w;var R,C=(R=c(),function(P,D,V,q,K,Q){var X,re;for(D||(D=3),V||(V=0),re=q?Math.min(q*D+V,P.length):P.length,X=V;X<re;X+=D)R[0]=P[X],R[1]=P[X+1],R[2]=P[X+2],K(R,R,Q),P[X]=R[0],P[X+1]=R[1],P[X+2]=R[2];return P});return ke.forEach=C,ke}var Xe,st,et={};function gt(){if(Xe)return et;function l(C){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},l(C)}Xe=1,Object.defineProperty(et,"__esModule",{value:!0}),et.create=c,et.clone=function(C){var P=new e.ARRAY_TYPE(4);return P[0]=C[0],P[1]=C[1],P[2]=C[2],P[3]=C[3],P},et.fromValues=function(C,P,D,V){var q=new e.ARRAY_TYPE(4);return q[0]=C,q[1]=P,q[2]=D,q[3]=V,q},et.copy=function(C,P){return C[0]=P[0],C[1]=P[1],C[2]=P[2],C[3]=P[3],C},et.set=function(C,P,D,V,q){return C[0]=P,C[1]=D,C[2]=V,C[3]=q,C},et.add=function(C,P,D){return C[0]=P[0]+D[0],C[1]=P[1]+D[1],C[2]=P[2]+D[2],C[3]=P[3]+D[3],C},et.subtract=f,et.multiply=d,et.divide=g,et.ceil=function(C,P){return C[0]=Math.ceil(P[0]),C[1]=Math.ceil(P[1]),C[2]=Math.ceil(P[2]),C[3]=Math.ceil(P[3]),C},et.floor=function(C,P){return C[0]=Math.floor(P[0]),C[1]=Math.floor(P[1]),C[2]=Math.floor(P[2]),C[3]=Math.floor(P[3]),C},et.min=function(C,P,D){return C[0]=Math.min(P[0],D[0]),C[1]=Math.min(P[1],D[1]),C[2]=Math.min(P[2],D[2]),C[3]=Math.min(P[3],D[3]),C},et.max=function(C,P,D){return C[0]=Math.max(P[0],D[0]),C[1]=Math.max(P[1],D[1]),C[2]=Math.max(P[2],D[2]),C[3]=Math.max(P[3],D[3]),C},et.round=function(C,P){return C[0]=Math.round(P[0]),C[1]=Math.round(P[1]),C[2]=Math.round(P[2]),C[3]=Math.round(P[3]),C},et.scale=function(C,P,D){return C[0]=P[0]*D,C[1]=P[1]*D,C[2]=P[2]*D,C[3]=P[3]*D,C},et.scaleAndAdd=function(C,P,D,V){return C[0]=P[0]+D[0]*V,C[1]=P[1]+D[1]*V,C[2]=P[2]+D[2]*V,C[3]=P[3]+D[3]*V,C},et.distance=S,et.squaredDistance=M,et.length=L,et.squaredLength=w,et.negate=function(C,P){return C[0]=-P[0],C[1]=-P[1],C[2]=-P[2],C[3]=-P[3],C},et.inverse=function(C,P){return C[0]=1/P[0],C[1]=1/P[1],C[2]=1/P[2],C[3]=1/P[3],C},et.normalize=function(C,P){var D=P[0],V=P[1],q=P[2],K=P[3],Q=D*D+V*V+q*q+K*K;return Q>0&&(Q=1/Math.sqrt(Q)),C[0]=D*Q,C[1]=V*Q,C[2]=q*Q,C[3]=K*Q,C},et.dot=function(C,P){return C[0]*P[0]+C[1]*P[1]+C[2]*P[2]+C[3]*P[3]},et.cross=function(C,P,D,V){var q=D[0]*V[1]-D[1]*V[0],K=D[0]*V[2]-D[2]*V[0],Q=D[0]*V[3]-D[3]*V[0],X=D[1]*V[2]-D[2]*V[1],re=D[1]*V[3]-D[3]*V[1],de=D[2]*V[3]-D[3]*V[2],ye=P[0],Ce=P[1],Ee=P[2],Te=P[3];return C[0]=Ce*de-Ee*re+Te*X,C[1]=-ye*de+Ee*Q-Te*K,C[2]=ye*re-Ce*Q+Te*q,C[3]=-ye*X+Ce*K-Ee*q,C},et.lerp=function(C,P,D,V){var q=P[0],K=P[1],Q=P[2],X=P[3];return C[0]=q+V*(D[0]-q),C[1]=K+V*(D[1]-K),C[2]=Q+V*(D[2]-Q),C[3]=X+V*(D[3]-X),C},et.random=function(C,P){var D,V,q,K,Q,X;P=P||1;do Q=(D=2*e.RANDOM()-1)*D+(V=2*e.RANDOM()-1)*V;while(Q>=1);do X=(q=2*e.RANDOM()-1)*q+(K=2*e.RANDOM()-1)*K;while(X>=1);var re=Math.sqrt((1-Q)/X);return C[0]=P*D,C[1]=P*V,C[2]=P*q*re,C[3]=P*K*re,C},et.transformMat4=function(C,P,D){var V=P[0],q=P[1],K=P[2],Q=P[3];return C[0]=D[0]*V+D[4]*q+D[8]*K+D[12]*Q,C[1]=D[1]*V+D[5]*q+D[9]*K+D[13]*Q,C[2]=D[2]*V+D[6]*q+D[10]*K+D[14]*Q,C[3]=D[3]*V+D[7]*q+D[11]*K+D[15]*Q,C},et.transformQuat=function(C,P,D){var V=P[0],q=P[1],K=P[2],Q=D[0],X=D[1],re=D[2],de=D[3],ye=de*V+X*K-re*q,Ce=de*q+re*V-Q*K,Ee=de*K+Q*q-X*V,Te=-Q*V-X*q-re*K;return C[0]=ye*de+Te*-Q+Ce*-re-Ee*-X,C[1]=Ce*de+Te*-X+Ee*-Q-ye*-re,C[2]=Ee*de+Te*-re+ye*-X-Ce*-Q,C[3]=P[3],C},et.zero=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=0,C},et.str=function(C){return"vec4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+")"},et.exactEquals=function(C,P){return C[0]===P[0]&&C[1]===P[1]&&C[2]===P[2]&&C[3]===P[3]},et.equals=function(C,P){var D=C[0],V=C[1],q=C[2],K=C[3],Q=P[0],X=P[1],re=P[2],de=P[3];return Math.abs(D-Q)<=e.EPSILON*Math.max(1,Math.abs(D),Math.abs(Q))&&Math.abs(V-X)<=e.EPSILON*Math.max(1,Math.abs(V),Math.abs(X))&&Math.abs(q-re)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(re))&&Math.abs(K-de)<=e.EPSILON*Math.max(1,Math.abs(K),Math.abs(de))},et.forEach=et.sqrLen=et.len=et.sqrDist=et.dist=et.div=et.mul=et.sub=void 0;var e=function(C,P){if(C&&C.__esModule)return C;if(C===null||l(C)!=="object"&&typeof C!="function")return{default:C};var D=o(void 0);if(D&&D.has(C))return D.get(C);var V={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in C)if(K!=="default"&&Object.prototype.hasOwnProperty.call(C,K)){var Q=q?Object.getOwnPropertyDescriptor(C,K):null;Q&&(Q.get||Q.set)?Object.defineProperty(V,K,Q):V[K]=C[K]}return V.default=C,D&&D.set(C,V),V}(J());function o(C){if(typeof WeakMap!="function")return null;var P=new WeakMap,D=new WeakMap;return(o=function(V){return V?D:P})(C)}function c(){var C=new e.ARRAY_TYPE(4);return e.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function f(C,P,D){return C[0]=P[0]-D[0],C[1]=P[1]-D[1],C[2]=P[2]-D[2],C[3]=P[3]-D[3],C}function d(C,P,D){return C[0]=P[0]*D[0],C[1]=P[1]*D[1],C[2]=P[2]*D[2],C[3]=P[3]*D[3],C}function g(C,P,D){return C[0]=P[0]/D[0],C[1]=P[1]/D[1],C[2]=P[2]/D[2],C[3]=P[3]/D[3],C}function S(C,P){return Math.hypot(P[0]-C[0],P[1]-C[1],P[2]-C[2],P[3]-C[3])}function M(C,P){var D=P[0]-C[0],V=P[1]-C[1],q=P[2]-C[2],K=P[3]-C[3];return D*D+V*V+q*q+K*K}function L(C){return Math.hypot(C[0],C[1],C[2],C[3])}function w(C){var P=C[0],D=C[1],V=C[2],q=C[3];return P*P+D*D+V*V+q*q}et.sub=f,et.mul=d,et.div=g,et.dist=S,et.sqrDist=M,et.len=L,et.sqrLen=w;var A,R=(A=c(),function(C,P,D,V,q,K){var Q,X;for(P||(P=4),D||(D=0),X=V?Math.min(V*P+D,C.length):C.length,Q=D;Q<X;Q+=P)A[0]=C[Q],A[1]=C[Q+1],A[2]=C[Q+2],A[3]=C[Q+3],q(A,A,K),C[Q]=A[0],C[Q+1]=A[1],C[Q+2]=A[2],C[Q+3]=A[3];return C});return et.forEach=R,et}function zt(){if(st)return ae;function l(Ae){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ue){return typeof Ue}:function(Ue){return Ue&&typeof Symbol=="function"&&Ue.constructor===Symbol&&Ue!==Symbol.prototype?"symbol":typeof Ue},l(Ae)}st=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=S,ae.identity=function(Ae){return Ae[0]=0,Ae[1]=0,Ae[2]=0,Ae[3]=1,Ae},ae.setAxisAngle=M,ae.getAxisAngle=function(Ae,Ue){var He=2*Math.acos(Ue[3]),Ge=Math.sin(He/2);return Ge>e.EPSILON?(Ae[0]=Ue[0]/Ge,Ae[1]=Ue[1]/Ge,Ae[2]=Ue[2]/Ge):(Ae[0]=1,Ae[1]=0,Ae[2]=0),He},ae.getAngle=function(Ae,Ue){var He=D(Ae,Ue);return Math.acos(2*He*He-1)},ae.multiply=L,ae.rotateX=function(Ae,Ue,He){He*=.5;var Ge=Ue[0],Ke=Ue[1],rt=Ue[2],dt=Ue[3],Qe=Math.sin(He),wt=Math.cos(He);return Ae[0]=Ge*wt+dt*Qe,Ae[1]=Ke*wt+rt*Qe,Ae[2]=rt*wt-Ke*Qe,Ae[3]=dt*wt-Ge*Qe,Ae},ae.rotateY=function(Ae,Ue,He){He*=.5;var Ge=Ue[0],Ke=Ue[1],rt=Ue[2],dt=Ue[3],Qe=Math.sin(He),wt=Math.cos(He);return Ae[0]=Ge*wt-rt*Qe,Ae[1]=Ke*wt+dt*Qe,Ae[2]=rt*wt+Ge*Qe,Ae[3]=dt*wt-Ke*Qe,Ae},ae.rotateZ=function(Ae,Ue,He){He*=.5;var Ge=Ue[0],Ke=Ue[1],rt=Ue[2],dt=Ue[3],Qe=Math.sin(He),wt=Math.cos(He);return Ae[0]=Ge*wt+Ke*Qe,Ae[1]=Ke*wt-Ge*Qe,Ae[2]=rt*wt+dt*Qe,Ae[3]=dt*wt-rt*Qe,Ae},ae.calculateW=function(Ae,Ue){var He=Ue[0],Ge=Ue[1],Ke=Ue[2];return Ae[0]=He,Ae[1]=Ge,Ae[2]=Ke,Ae[3]=Math.sqrt(Math.abs(1-He*He-Ge*Ge-Ke*Ke)),Ae},ae.exp=w,ae.ln=A,ae.pow=function(Ae,Ue,He){return A(Ae,Ue),P(Ae,Ae,He),w(Ae,Ae),Ae},ae.slerp=R,ae.random=function(Ae){var Ue=e.RANDOM(),He=e.RANDOM(),Ge=e.RANDOM(),Ke=Math.sqrt(1-Ue),rt=Math.sqrt(Ue);return Ae[0]=Ke*Math.sin(2*Math.PI*He),Ae[1]=Ke*Math.cos(2*Math.PI*He),Ae[2]=rt*Math.sin(2*Math.PI*Ge),Ae[3]=rt*Math.cos(2*Math.PI*Ge),Ae},ae.invert=function(Ae,Ue){var He=Ue[0],Ge=Ue[1],Ke=Ue[2],rt=Ue[3],dt=He*He+Ge*Ge+Ke*Ke+rt*rt,Qe=dt?1/dt:0;return Ae[0]=-He*Qe,Ae[1]=-Ge*Qe,Ae[2]=-Ke*Qe,Ae[3]=rt*Qe,Ae},ae.conjugate=function(Ae,Ue){return Ae[0]=-Ue[0],Ae[1]=-Ue[1],Ae[2]=-Ue[2],Ae[3]=Ue[3],Ae},ae.fromMat3=C,ae.fromEuler=function(Ae,Ue,He,Ge){var Ke=.5*Math.PI/180;Ue*=Ke,He*=Ke,Ge*=Ke;var rt=Math.sin(Ue),dt=Math.cos(Ue),Qe=Math.sin(He),wt=Math.cos(He),qt=Math.sin(Ge),Tt=Math.cos(Ge);return Ae[0]=rt*wt*Tt-dt*Qe*qt,Ae[1]=dt*Qe*Tt+rt*wt*qt,Ae[2]=dt*wt*qt-rt*Qe*Tt,Ae[3]=dt*wt*Tt+rt*Qe*qt,Ae},ae.str=function(Ae){return"quat("+Ae[0]+", "+Ae[1]+", "+Ae[2]+", "+Ae[3]+")"},ae.setAxes=ae.sqlerp=ae.rotationTo=ae.equals=ae.exactEquals=ae.normalize=ae.sqrLen=ae.squaredLength=ae.len=ae.length=ae.lerp=ae.dot=ae.scale=ae.mul=ae.add=ae.set=ae.copy=ae.fromValues=ae.clone=void 0;var e=g(J()),o=g(ce()),c=g(ct()),f=g(gt());function d(Ae){if(typeof WeakMap!="function")return null;var Ue=new WeakMap,He=new WeakMap;return(d=function(Ge){return Ge?He:Ue})(Ae)}function g(Ae,Ue){if(Ae&&Ae.__esModule)return Ae;if(Ae===null||l(Ae)!=="object"&&typeof Ae!="function")return{default:Ae};var He=d(Ue);if(He&&He.has(Ae))return He.get(Ae);var Ge={},Ke=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var rt in Ae)if(rt!=="default"&&Object.prototype.hasOwnProperty.call(Ae,rt)){var dt=Ke?Object.getOwnPropertyDescriptor(Ae,rt):null;dt&&(dt.get||dt.set)?Object.defineProperty(Ge,rt,dt):Ge[rt]=Ae[rt]}return Ge.default=Ae,He&&He.set(Ae,Ge),Ge}function S(){var Ae=new e.ARRAY_TYPE(4);return e.ARRAY_TYPE!=Float32Array&&(Ae[0]=0,Ae[1]=0,Ae[2]=0),Ae[3]=1,Ae}function M(Ae,Ue,He){He*=.5;var Ge=Math.sin(He);return Ae[0]=Ge*Ue[0],Ae[1]=Ge*Ue[1],Ae[2]=Ge*Ue[2],Ae[3]=Math.cos(He),Ae}function L(Ae,Ue,He){var Ge=Ue[0],Ke=Ue[1],rt=Ue[2],dt=Ue[3],Qe=He[0],wt=He[1],qt=He[2],Tt=He[3];return Ae[0]=Ge*Tt+dt*Qe+Ke*qt-rt*wt,Ae[1]=Ke*Tt+dt*wt+rt*Qe-Ge*qt,Ae[2]=rt*Tt+dt*qt+Ge*wt-Ke*Qe,Ae[3]=dt*Tt-Ge*Qe-Ke*wt-rt*qt,Ae}function w(Ae,Ue){var He=Ue[0],Ge=Ue[1],Ke=Ue[2],rt=Ue[3],dt=Math.sqrt(He*He+Ge*Ge+Ke*Ke),Qe=Math.exp(rt),wt=dt>0?Qe*Math.sin(dt)/dt:0;return Ae[0]=He*wt,Ae[1]=Ge*wt,Ae[2]=Ke*wt,Ae[3]=Qe*Math.cos(dt),Ae}function A(Ae,Ue){var He=Ue[0],Ge=Ue[1],Ke=Ue[2],rt=Ue[3],dt=Math.sqrt(He*He+Ge*Ge+Ke*Ke),Qe=dt>0?Math.atan2(dt,rt)/dt:0;return Ae[0]=He*Qe,Ae[1]=Ge*Qe,Ae[2]=Ke*Qe,Ae[3]=.5*Math.log(He*He+Ge*Ge+Ke*Ke+rt*rt),Ae}function R(Ae,Ue,He,Ge){var Ke,rt,dt,Qe,wt,qt=Ue[0],Tt=Ue[1],Qt=Ue[2],Kt=Ue[3],ln=He[0],Pt=He[1],En=He[2],en=He[3];return(rt=qt*ln+Tt*Pt+Qt*En+Kt*en)<0&&(rt=-rt,ln=-ln,Pt=-Pt,En=-En,en=-en),1-rt>e.EPSILON?(Ke=Math.acos(rt),dt=Math.sin(Ke),Qe=Math.sin((1-Ge)*Ke)/dt,wt=Math.sin(Ge*Ke)/dt):(Qe=1-Ge,wt=Ge),Ae[0]=Qe*qt+wt*ln,Ae[1]=Qe*Tt+wt*Pt,Ae[2]=Qe*Qt+wt*En,Ae[3]=Qe*Kt+wt*en,Ae}function C(Ae,Ue){var He,Ge=Ue[0]+Ue[4]+Ue[8];if(Ge>0)He=Math.sqrt(Ge+1),Ae[3]=.5*He,Ae[0]=(Ue[5]-Ue[7])*(He=.5/He),Ae[1]=(Ue[6]-Ue[2])*He,Ae[2]=(Ue[1]-Ue[3])*He;else{var Ke=0;Ue[4]>Ue[0]&&(Ke=1),Ue[8]>Ue[3*Ke+Ke]&&(Ke=2);var rt=(Ke+1)%3,dt=(Ke+2)%3;He=Math.sqrt(Ue[3*Ke+Ke]-Ue[3*rt+rt]-Ue[3*dt+dt]+1),Ae[Ke]=.5*He,Ae[3]=(Ue[3*rt+dt]-Ue[3*dt+rt])*(He=.5/He),Ae[rt]=(Ue[3*rt+Ke]+Ue[3*Ke+rt])*He,Ae[dt]=(Ue[3*dt+Ke]+Ue[3*Ke+dt])*He}return Ae}ae.clone=f.clone,ae.fromValues=f.fromValues,ae.copy=f.copy,ae.set=f.set,ae.add=f.add,ae.mul=L;var P=f.scale;ae.scale=P;var D=f.dot;ae.dot=D,ae.lerp=f.lerp;var V=f.length;ae.length=V,ae.len=V;var q=f.squaredLength;ae.squaredLength=q,ae.sqrLen=q;var K=f.normalize;ae.normalize=K,ae.exactEquals=f.exactEquals,ae.equals=f.equals;var Q,X,re,de=(Q=c.create(),X=c.fromValues(1,0,0),re=c.fromValues(0,1,0),function(Ae,Ue,He){var Ge=c.dot(Ue,He);return Ge<-.999999?(c.cross(Q,X,Ue),c.len(Q)<1e-6&&c.cross(Q,re,Ue),c.normalize(Q,Q),M(Ae,Q,Math.PI),Ae):Ge>.999999?(Ae[0]=0,Ae[1]=0,Ae[2]=0,Ae[3]=1,Ae):(c.cross(Q,Ue,He),Ae[0]=Q[0],Ae[1]=Q[1],Ae[2]=Q[2],Ae[3]=1+Ge,K(Ae,Ae))});ae.rotationTo=de;var ye,Ce,Ee=(ye=S(),Ce=S(),function(Ae,Ue,He,Ge,Ke,rt){return R(ye,Ue,Ke,rt),R(Ce,He,Ge,rt),R(Ae,ye,Ce,2*rt*(1-rt)),Ae});ae.sqlerp=Ee;var Te,Be=(Te=o.create(),function(Ae,Ue,He,Ge){return Te[0]=He[0],Te[3]=He[1],Te[6]=He[2],Te[1]=Ge[0],Te[4]=Ge[1],Te[7]=Ge[2],Te[2]=-Ue[0],Te[5]=-Ue[1],Te[8]=-Ue[2],K(Ae,C(Ae,Te))});return ae.setAxes=Be,ae}var at,Ye={};function Bt(){if(at)return Ye;function l(R){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},l(R)}at=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.create=function(){var R=new e.ARRAY_TYPE(8);return e.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0,R[4]=0,R[5]=0,R[6]=0,R[7]=0),R[3]=1,R},Ye.clone=function(R){var C=new e.ARRAY_TYPE(8);return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C},Ye.fromValues=function(R,C,P,D,V,q,K,Q){var X=new e.ARRAY_TYPE(8);return X[0]=R,X[1]=C,X[2]=P,X[3]=D,X[4]=V,X[5]=q,X[6]=K,X[7]=Q,X},Ye.fromRotationTranslationValues=function(R,C,P,D,V,q,K){var Q=new e.ARRAY_TYPE(8);Q[0]=R,Q[1]=C,Q[2]=P,Q[3]=D;var X=.5*V,re=.5*q,de=.5*K;return Q[4]=X*D+re*P-de*C,Q[5]=re*D+de*R-X*P,Q[6]=de*D+X*C-re*R,Q[7]=-X*R-re*C-de*P,Q},Ye.fromRotationTranslation=g,Ye.fromTranslation=function(R,C){return R[0]=0,R[1]=0,R[2]=0,R[3]=1,R[4]=.5*C[0],R[5]=.5*C[1],R[6]=.5*C[2],R[7]=0,R},Ye.fromRotation=function(R,C){return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=0,R[5]=0,R[6]=0,R[7]=0,R},Ye.fromMat4=function(R,C){var P=o.create();c.getRotation(P,C);var D=new e.ARRAY_TYPE(3);return c.getTranslation(D,C),g(R,P,D),R},Ye.copy=S,Ye.identity=function(R){return R[0]=0,R[1]=0,R[2]=0,R[3]=1,R[4]=0,R[5]=0,R[6]=0,R[7]=0,R},Ye.set=function(R,C,P,D,V,q,K,Q,X){return R[0]=C,R[1]=P,R[2]=D,R[3]=V,R[4]=q,R[5]=K,R[6]=Q,R[7]=X,R},Ye.getDual=function(R,C){return R[0]=C[4],R[1]=C[5],R[2]=C[6],R[3]=C[7],R},Ye.setDual=function(R,C){return R[4]=C[0],R[5]=C[1],R[6]=C[2],R[7]=C[3],R},Ye.getTranslation=function(R,C){var P=C[4],D=C[5],V=C[6],q=C[7],K=-C[0],Q=-C[1],X=-C[2],re=C[3];return R[0]=2*(P*re+q*K+D*X-V*Q),R[1]=2*(D*re+q*Q+V*K-P*X),R[2]=2*(V*re+q*X+P*Q-D*K),R},Ye.translate=function(R,C,P){var D=C[0],V=C[1],q=C[2],K=C[3],Q=.5*P[0],X=.5*P[1],re=.5*P[2],de=C[4],ye=C[5],Ce=C[6],Ee=C[7];return R[0]=D,R[1]=V,R[2]=q,R[3]=K,R[4]=K*Q+V*re-q*X+de,R[5]=K*X+q*Q-D*re+ye,R[6]=K*re+D*X-V*Q+Ce,R[7]=-D*Q-V*X-q*re+Ee,R},Ye.rotateX=function(R,C,P){var D=-C[0],V=-C[1],q=-C[2],K=C[3],Q=C[4],X=C[5],re=C[6],de=C[7],ye=Q*K+de*D+X*q-re*V,Ce=X*K+de*V+re*D-Q*q,Ee=re*K+de*q+Q*V-X*D,Te=de*K-Q*D-X*V-re*q;return o.rotateX(R,C,P),R[4]=ye*(K=R[3])+Te*(D=R[0])+Ce*(q=R[2])-Ee*(V=R[1]),R[5]=Ce*K+Te*V+Ee*D-ye*q,R[6]=Ee*K+Te*q+ye*V-Ce*D,R[7]=Te*K-ye*D-Ce*V-Ee*q,R},Ye.rotateY=function(R,C,P){var D=-C[0],V=-C[1],q=-C[2],K=C[3],Q=C[4],X=C[5],re=C[6],de=C[7],ye=Q*K+de*D+X*q-re*V,Ce=X*K+de*V+re*D-Q*q,Ee=re*K+de*q+Q*V-X*D,Te=de*K-Q*D-X*V-re*q;return o.rotateY(R,C,P),R[4]=ye*(K=R[3])+Te*(D=R[0])+Ce*(q=R[2])-Ee*(V=R[1]),R[5]=Ce*K+Te*V+Ee*D-ye*q,R[6]=Ee*K+Te*q+ye*V-Ce*D,R[7]=Te*K-ye*D-Ce*V-Ee*q,R},Ye.rotateZ=function(R,C,P){var D=-C[0],V=-C[1],q=-C[2],K=C[3],Q=C[4],X=C[5],re=C[6],de=C[7],ye=Q*K+de*D+X*q-re*V,Ce=X*K+de*V+re*D-Q*q,Ee=re*K+de*q+Q*V-X*D,Te=de*K-Q*D-X*V-re*q;return o.rotateZ(R,C,P),R[4]=ye*(K=R[3])+Te*(D=R[0])+Ce*(q=R[2])-Ee*(V=R[1]),R[5]=Ce*K+Te*V+Ee*D-ye*q,R[6]=Ee*K+Te*q+ye*V-Ce*D,R[7]=Te*K-ye*D-Ce*V-Ee*q,R},Ye.rotateByQuatAppend=function(R,C,P){var D=P[0],V=P[1],q=P[2],K=P[3],Q=C[0],X=C[1],re=C[2],de=C[3];return R[0]=Q*K+de*D+X*q-re*V,R[1]=X*K+de*V+re*D-Q*q,R[2]=re*K+de*q+Q*V-X*D,R[3]=de*K-Q*D-X*V-re*q,R[4]=(Q=C[4])*K+(de=C[7])*D+(X=C[5])*q-(re=C[6])*V,R[5]=X*K+de*V+re*D-Q*q,R[6]=re*K+de*q+Q*V-X*D,R[7]=de*K-Q*D-X*V-re*q,R},Ye.rotateByQuatPrepend=function(R,C,P){var D=C[0],V=C[1],q=C[2],K=C[3],Q=P[0],X=P[1],re=P[2],de=P[3];return R[0]=D*de+K*Q+V*re-q*X,R[1]=V*de+K*X+q*Q-D*re,R[2]=q*de+K*re+D*X-V*Q,R[3]=K*de-D*Q-V*X-q*re,R[4]=D*(de=P[7])+K*(Q=P[4])+V*(re=P[6])-q*(X=P[5]),R[5]=V*de+K*X+q*Q-D*re,R[6]=q*de+K*re+D*X-V*Q,R[7]=K*de-D*Q-V*X-q*re,R},Ye.rotateAroundAxis=function(R,C,P,D){if(Math.abs(D)<e.EPSILON)return S(R,C);var V=Math.hypot(P[0],P[1],P[2]);D*=.5;var q=Math.sin(D),K=q*P[0]/V,Q=q*P[1]/V,X=q*P[2]/V,re=Math.cos(D),de=C[0],ye=C[1],Ce=C[2],Ee=C[3];R[0]=de*re+Ee*K+ye*X-Ce*Q,R[1]=ye*re+Ee*Q+Ce*K-de*X,R[2]=Ce*re+Ee*X+de*Q-ye*K,R[3]=Ee*re-de*K-ye*Q-Ce*X;var Te=C[4],Be=C[5],Ae=C[6],Ue=C[7];return R[4]=Te*re+Ue*K+Be*X-Ae*Q,R[5]=Be*re+Ue*Q+Ae*K-Te*X,R[6]=Ae*re+Ue*X+Te*Q-Be*K,R[7]=Ue*re-Te*K-Be*Q-Ae*X,R},Ye.add=function(R,C,P){return R[0]=C[0]+P[0],R[1]=C[1]+P[1],R[2]=C[2]+P[2],R[3]=C[3]+P[3],R[4]=C[4]+P[4],R[5]=C[5]+P[5],R[6]=C[6]+P[6],R[7]=C[7]+P[7],R},Ye.multiply=M,Ye.scale=function(R,C,P){return R[0]=C[0]*P,R[1]=C[1]*P,R[2]=C[2]*P,R[3]=C[3]*P,R[4]=C[4]*P,R[5]=C[5]*P,R[6]=C[6]*P,R[7]=C[7]*P,R},Ye.lerp=function(R,C,P,D){var V=1-D;return L(C,P)<0&&(D=-D),R[0]=C[0]*V+P[0]*D,R[1]=C[1]*V+P[1]*D,R[2]=C[2]*V+P[2]*D,R[3]=C[3]*V+P[3]*D,R[4]=C[4]*V+P[4]*D,R[5]=C[5]*V+P[5]*D,R[6]=C[6]*V+P[6]*D,R[7]=C[7]*V+P[7]*D,R},Ye.invert=function(R,C){var P=A(C);return R[0]=-C[0]/P,R[1]=-C[1]/P,R[2]=-C[2]/P,R[3]=C[3]/P,R[4]=-C[4]/P,R[5]=-C[5]/P,R[6]=-C[6]/P,R[7]=C[7]/P,R},Ye.conjugate=function(R,C){return R[0]=-C[0],R[1]=-C[1],R[2]=-C[2],R[3]=C[3],R[4]=-C[4],R[5]=-C[5],R[6]=-C[6],R[7]=C[7],R},Ye.normalize=function(R,C){var P=A(C);if(P>0){P=Math.sqrt(P);var D=C[0]/P,V=C[1]/P,q=C[2]/P,K=C[3]/P,Q=C[4],X=C[5],re=C[6],de=C[7],ye=D*Q+V*X+q*re+K*de;R[0]=D,R[1]=V,R[2]=q,R[3]=K,R[4]=(Q-D*ye)/P,R[5]=(X-V*ye)/P,R[6]=(re-q*ye)/P,R[7]=(de-K*ye)/P}return R},Ye.str=function(R){return"quat2("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+", "+R[4]+", "+R[5]+", "+R[6]+", "+R[7]+")"},Ye.exactEquals=function(R,C){return R[0]===C[0]&&R[1]===C[1]&&R[2]===C[2]&&R[3]===C[3]&&R[4]===C[4]&&R[5]===C[5]&&R[6]===C[6]&&R[7]===C[7]},Ye.equals=function(R,C){var P=R[0],D=R[1],V=R[2],q=R[3],K=R[4],Q=R[5],X=R[6],re=R[7],de=C[0],ye=C[1],Ce=C[2],Ee=C[3],Te=C[4],Be=C[5],Ae=C[6],Ue=C[7];return Math.abs(P-de)<=e.EPSILON*Math.max(1,Math.abs(P),Math.abs(de))&&Math.abs(D-ye)<=e.EPSILON*Math.max(1,Math.abs(D),Math.abs(ye))&&Math.abs(V-Ce)<=e.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ce))&&Math.abs(q-Ee)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(Ee))&&Math.abs(K-Te)<=e.EPSILON*Math.max(1,Math.abs(K),Math.abs(Te))&&Math.abs(Q-Be)<=e.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Be))&&Math.abs(X-Ae)<=e.EPSILON*Math.max(1,Math.abs(X),Math.abs(Ae))&&Math.abs(re-Ue)<=e.EPSILON*Math.max(1,Math.abs(re),Math.abs(Ue))},Ye.sqrLen=Ye.squaredLength=Ye.len=Ye.length=Ye.dot=Ye.mul=Ye.setReal=Ye.getReal=void 0;var e=d(J()),o=d(zt()),c=d($e());function f(R){if(typeof WeakMap!="function")return null;var C=new WeakMap,P=new WeakMap;return(f=function(D){return D?P:C})(R)}function d(R,C){if(R&&R.__esModule)return R;if(R===null||l(R)!=="object"&&typeof R!="function")return{default:R};var P=f(C);if(P&&P.has(R))return P.get(R);var D={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in R)if(q!=="default"&&Object.prototype.hasOwnProperty.call(R,q)){var K=V?Object.getOwnPropertyDescriptor(R,q):null;K&&(K.get||K.set)?Object.defineProperty(D,q,K):D[q]=R[q]}return D.default=R,P&&P.set(R,D),D}function g(R,C,P){var D=.5*P[0],V=.5*P[1],q=.5*P[2],K=C[0],Q=C[1],X=C[2],re=C[3];return R[0]=K,R[1]=Q,R[2]=X,R[3]=re,R[4]=D*re+V*X-q*Q,R[5]=V*re+q*K-D*X,R[6]=q*re+D*Q-V*K,R[7]=-D*K-V*Q-q*X,R}function S(R,C){return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R}function M(R,C,P){var D=C[0],V=C[1],q=C[2],K=C[3],Q=P[4],X=P[5],re=P[6],de=P[7],ye=C[4],Ce=C[5],Ee=C[6],Te=C[7],Be=P[0],Ae=P[1],Ue=P[2],He=P[3];return R[0]=D*He+K*Be+V*Ue-q*Ae,R[1]=V*He+K*Ae+q*Be-D*Ue,R[2]=q*He+K*Ue+D*Ae-V*Be,R[3]=K*He-D*Be-V*Ae-q*Ue,R[4]=D*de+K*Q+V*re-q*X+ye*He+Te*Be+Ce*Ue-Ee*Ae,R[5]=V*de+K*X+q*Q-D*re+Ce*He+Te*Ae+Ee*Be-ye*Ue,R[6]=q*de+K*re+D*X-V*Q+Ee*He+Te*Ue+ye*Ae-Ce*Be,R[7]=K*de-D*Q-V*X-q*re+Te*He-ye*Be-Ce*Ae-Ee*Ue,R}Ye.getReal=o.copy,Ye.setReal=o.copy,Ye.mul=M;var L=o.dot;Ye.dot=L;var w=o.length;Ye.length=w,Ye.len=w;var A=o.squaredLength;return Ye.squaredLength=A,Ye.sqrLen=A,Ye}var nt,Rt,Nt={};function gn(){if(nt)return Nt;function l(C){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},l(C)}nt=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.create=c,Nt.clone=function(C){var P=new e.ARRAY_TYPE(2);return P[0]=C[0],P[1]=C[1],P},Nt.fromValues=function(C,P){var D=new e.ARRAY_TYPE(2);return D[0]=C,D[1]=P,D},Nt.copy=function(C,P){return C[0]=P[0],C[1]=P[1],C},Nt.set=function(C,P,D){return C[0]=P,C[1]=D,C},Nt.add=function(C,P,D){return C[0]=P[0]+D[0],C[1]=P[1]+D[1],C},Nt.subtract=f,Nt.multiply=d,Nt.divide=g,Nt.ceil=function(C,P){return C[0]=Math.ceil(P[0]),C[1]=Math.ceil(P[1]),C},Nt.floor=function(C,P){return C[0]=Math.floor(P[0]),C[1]=Math.floor(P[1]),C},Nt.min=function(C,P,D){return C[0]=Math.min(P[0],D[0]),C[1]=Math.min(P[1],D[1]),C},Nt.max=function(C,P,D){return C[0]=Math.max(P[0],D[0]),C[1]=Math.max(P[1],D[1]),C},Nt.round=function(C,P){return C[0]=Math.round(P[0]),C[1]=Math.round(P[1]),C},Nt.scale=function(C,P,D){return C[0]=P[0]*D,C[1]=P[1]*D,C},Nt.scaleAndAdd=function(C,P,D,V){return C[0]=P[0]+D[0]*V,C[1]=P[1]+D[1]*V,C},Nt.distance=S,Nt.squaredDistance=M,Nt.length=L,Nt.squaredLength=w,Nt.negate=function(C,P){return C[0]=-P[0],C[1]=-P[1],C},Nt.inverse=function(C,P){return C[0]=1/P[0],C[1]=1/P[1],C},Nt.normalize=function(C,P){var D=P[0],V=P[1],q=D*D+V*V;return q>0&&(q=1/Math.sqrt(q)),C[0]=P[0]*q,C[1]=P[1]*q,C},Nt.dot=function(C,P){return C[0]*P[0]+C[1]*P[1]},Nt.cross=function(C,P,D){var V=P[0]*D[1]-P[1]*D[0];return C[0]=C[1]=0,C[2]=V,C},Nt.lerp=function(C,P,D,V){var q=P[0],K=P[1];return C[0]=q+V*(D[0]-q),C[1]=K+V*(D[1]-K),C},Nt.random=function(C,P){P=P||1;var D=2*e.RANDOM()*Math.PI;return C[0]=Math.cos(D)*P,C[1]=Math.sin(D)*P,C},Nt.transformMat2=function(C,P,D){var V=P[0],q=P[1];return C[0]=D[0]*V+D[2]*q,C[1]=D[1]*V+D[3]*q,C},Nt.transformMat2d=function(C,P,D){var V=P[0],q=P[1];return C[0]=D[0]*V+D[2]*q+D[4],C[1]=D[1]*V+D[3]*q+D[5],C},Nt.transformMat3=function(C,P,D){var V=P[0],q=P[1];return C[0]=D[0]*V+D[3]*q+D[6],C[1]=D[1]*V+D[4]*q+D[7],C},Nt.transformMat4=function(C,P,D){var V=P[0],q=P[1];return C[0]=D[0]*V+D[4]*q+D[12],C[1]=D[1]*V+D[5]*q+D[13],C},Nt.rotate=function(C,P,D,V){var q=P[0]-D[0],K=P[1]-D[1],Q=Math.sin(V),X=Math.cos(V);return C[0]=q*X-K*Q+D[0],C[1]=q*Q+K*X+D[1],C},Nt.angle=function(C,P){var D=C[0],V=C[1],q=P[0],K=P[1],Q=Math.sqrt(D*D+V*V)*Math.sqrt(q*q+K*K);return Math.acos(Math.min(Math.max(Q&&(D*q+V*K)/Q,-1),1))},Nt.zero=function(C){return C[0]=0,C[1]=0,C},Nt.str=function(C){return"vec2("+C[0]+", "+C[1]+")"},Nt.exactEquals=function(C,P){return C[0]===P[0]&&C[1]===P[1]},Nt.equals=function(C,P){var D=C[0],V=C[1],q=P[0],K=P[1];return Math.abs(D-q)<=e.EPSILON*Math.max(1,Math.abs(D),Math.abs(q))&&Math.abs(V-K)<=e.EPSILON*Math.max(1,Math.abs(V),Math.abs(K))},Nt.forEach=Nt.sqrLen=Nt.sqrDist=Nt.dist=Nt.div=Nt.mul=Nt.sub=Nt.len=void 0;var e=function(C,P){if(C&&C.__esModule)return C;if(C===null||l(C)!=="object"&&typeof C!="function")return{default:C};var D=o(void 0);if(D&&D.has(C))return D.get(C);var V={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in C)if(K!=="default"&&Object.prototype.hasOwnProperty.call(C,K)){var Q=q?Object.getOwnPropertyDescriptor(C,K):null;Q&&(Q.get||Q.set)?Object.defineProperty(V,K,Q):V[K]=C[K]}return V.default=C,D&&D.set(C,V),V}(J());function o(C){if(typeof WeakMap!="function")return null;var P=new WeakMap,D=new WeakMap;return(o=function(V){return V?D:P})(C)}function c(){var C=new e.ARRAY_TYPE(2);return e.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0),C}function f(C,P,D){return C[0]=P[0]-D[0],C[1]=P[1]-D[1],C}function d(C,P,D){return C[0]=P[0]*D[0],C[1]=P[1]*D[1],C}function g(C,P,D){return C[0]=P[0]/D[0],C[1]=P[1]/D[1],C}function S(C,P){return Math.hypot(P[0]-C[0],P[1]-C[1])}function M(C,P){var D=P[0]-C[0],V=P[1]-C[1];return D*D+V*V}function L(C){return Math.hypot(C[0],C[1])}function w(C){var P=C[0],D=C[1];return P*P+D*D}Nt.len=L,Nt.sub=f,Nt.mul=d,Nt.div=g,Nt.dist=S,Nt.sqrDist=M,Nt.sqrLen=w;var A,R=(A=c(),function(C,P,D,V,q,K){var Q,X;for(P||(P=2),D||(D=0),X=V?Math.min(V*P+D,C.length):C.length,Q=D;Q<X;Q+=P)A[0]=C[Q],A[1]=C[Q+1],q(A,A,K),C[Q]=A[0],C[Q+1]=A[1];return C});return Nt.forEach=R,Nt}function Mt(){if(Rt)return B;function l(C){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},l(C)}Rt=1,Object.defineProperty(B,"__esModule",{value:!0}),B.vec4=B.vec3=B.vec2=B.quat2=B.quat=B.mat4=B.mat3=B.mat2d=B.mat2=B.glMatrix=void 0;var e=R(J());B.glMatrix=e;var o=R(j());B.mat2=o;var c=R(pe());B.mat2d=c;var f=R(ce());B.mat3=f;var d=R($e());B.mat4=d;var g=R(zt());B.quat=g;var S=R(Bt());B.quat2=S;var M=R(gn());B.vec2=M;var L=R(ct());B.vec3=L;var w=R(gt());function A(C){if(typeof WeakMap!="function")return null;var P=new WeakMap,D=new WeakMap;return(A=function(V){return V?D:P})(C)}function R(C,P){if(C&&C.__esModule)return C;if(C===null||l(C)!=="object"&&typeof C!="function")return{default:C};var D=A(P);if(D&&D.has(C))return D.get(C);var V={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in C)if(K!=="default"&&Object.prototype.hasOwnProperty.call(C,K)){var Q=q?Object.getOwnPropertyDescriptor(C,K):null;Q&&(Q.get||Q.set)?Object.defineProperty(V,K,Q):V[K]=C[K]}return V.default=C,D&&D.set(C,V),V}return B.vec4=w,B}var $t,Ut,hn,xn,Le=Mt(),Dn=function(){if(Ut)return $t;function l(e,o,c,f){this.cx=3*e,this.bx=3*(c-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=o,this.p2x=c,this.p2y=f}return Ut=1,$t=l,l.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,o){if(o===void 0&&(o=1e-6),e<0)return 0;if(e>1)return 1;for(var c=e,f=0;f<8;f++){var d=this.sampleCurveX(c)-e;if(Math.abs(d)<o)return c;var g=this.sampleCurveDerivativeX(c);if(Math.abs(g)<1e-6)break;c-=d/g}var S=0,M=1;for(c=e,f=0;f<20&&(d=this.sampleCurveX(c),!(Math.abs(d-e)<o));f++)e>d?S=c:M=c,c=.5*(M-S)+S;return c},solve:function(e,o){return this.sampleCurveY(this.solveCurveX(e,o))}},$t}(),pn=I(Dn);function zn(){if(xn)return hn;function l(e,o){this.x=e,this.y=o}return xn=1,hn=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,o){return this.clone()._rotateAround(e,o)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var o=e.x-this.x,c=e.y-this.y;return o*o+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,o){return Math.atan2(this.x*o-this.y*e,this.x*e+this.y*o)},_matMult:function(e){var o=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=o,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var o=Math.cos(e),c=Math.sin(e),f=c*this.x+o*this.y;return this.x=o*this.x-c*this.y,this.y=f,this},_rotateAround:function(e,o){var c=Math.cos(e),f=Math.sin(e),d=o.y+f*(this.x-o.x)+c*(this.y-o.y);return this.x=o.x+c*(this.x-o.x)-f*(this.y-o.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(e){return e instanceof l?e:Array.isArray(e)?new l(e[0],e[1]):e},hn}var _t=I(zn());function er(l,e){if(Array.isArray(l)){if(!Array.isArray(e)||l.length!==e.length)return!1;for(let o=0;o<l.length;o++)if(!er(l[o],e[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&e!==null){if(typeof e!="object"||Object.keys(l).length!==Object.keys(e).length)return!1;for(const o in l)if(!er(l[o],e[o]))return!1;return!0}return l===e}const pr=Math.PI/180,qn=180/Math.PI;function _n(l){return l*pr}function ir(l){return l*qn}const cr=[[0,0],[1,0],[1,1],[0,1]];function Er(l){if(l<=0)return 0;if(l>=1)return 1;const e=l*l,o=e*l;return 4*(l<.5?o:3*(l-e)+o-.75)}function On(l,e,o,c){const f=new pn(l,e,o,c);return function(d){return f.solve(d)}}const fi=On(.25,.1,.25,1);function Dt(l,e,o){return Math.min(o,Math.max(e,l))}function Ft(l,e,o){return(o=Dt((o-l)/(e-l),0,1))*o*(3-2*o)}function sn(l,e,o){const c=o-e,f=((l-e)%c+c)%c+e;return f===e?o:f}function Tn(l,e,o){if(!l.length)return o(null,[]);let c=l.length;const f=new Array(l.length);let d=null;l.forEach((g,S)=>{e(g,(M,L)=>{M&&(d=M),f[S]=L,--c==0&&o(d,f)})})}function Pn(l,...e){for(const o of e)for(const c in o)l[c]=o[c];return l}let ur=1;function Bn(){return ur++}function Hn(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Zr(l,e){l.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function Lr(l,e){return l.indexOf(e,l.length-e.length)!==-1}function qr(l,e,o){const c={};for(const f in l)c[f]=e.call(this,l[f],f,l);return c}function Yn(l,e,o){const c={};for(const f in l)e.call(this,l[f],f,l)&&(c[f]=l[f]);return c}function Ar(l){return Array.isArray(l)?l.map(Ar):typeof l=="object"&&l?qr(l,Ar):l}const si={};function $n(l){si[l]||(typeof console<"u"&&console.warn(l),si[l]=!0)}function Zi(l,e,o){return(o.y-l.y)*(e.x-l.x)>(e.y-l.y)*(o.x-l.x)}function ra(l){let e=0;for(let o,c,f=0,d=l.length,g=d-1;f<d;g=f++)o=l[f],c=l[g],e+=(c.x-o.x)*(o.y+c.y);return e}function Wi([l,e,o]){const c=_n(e+90),f=_n(o);return{x:l*Math.cos(c)*Math.sin(f),y:l*Math.sin(c)*Math.sin(f),z:l*Math.cos(f),azimuthal:e,polar:o}}function ai(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Fi(l){const e={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,f,d)=>{const g=f||d;return e[c]=!g||g.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let ia=null;function vs(l,e){return[l[4*e],l[4*e+1],l[4*e+2],l[4*e+3]]}function Do(l,e,o,c){for(;e<o;){const f=e+o>>1;l[f]<c?e=f+1:o=f}return e}function ht(l,e,o,c){for(;e<o;){const f=e+o>>1;l[f]<=c?e=f+1:o=f}return e}function ge(l){return l>0?1/(1.001-l):1+l}function be(l){return l>0?1-1/(1.001-l):-l}const Re={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Re.API_URL)return null;try{const l=new URL(Re.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function qe(l){return Re.API_URL_REGEX.test(l)}function We(l){return Re.API_SPRITE_REGEX.test(l)}let tt,mt,it,yt,bt,Et;function Xt(){return tt==null&&(tt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),tt}const un={now:()=>yt!==void 0?yt:performance.now(),setNow(l){yt=l},restoreNow(){yt=void 0},frame(l){const e=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(l,e=0){const{width:o,height:c}=l;bt||(bt=document.createElement("canvas"));const f=bt.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>bt.width||c>bt.height)&&(bt.width=o,bt.height=c),f.clearRect(-e,-e,o+2*e,c+2*e),f.drawImage(l,0,0,o,c),f.getImageData(-e,-e,o+2*e,c+2*e)},resolveURL:l=>(mt||(mt=document.createElement("a")),mt.href=l,mt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(it==null&&(it=window.matchMedia("(prefers-reduced-motion: reduce)")),it.matches)},hasCanvasFingerprintNoise(){if(Et!==void 0)return Et;if(!Xt())return Et=!1,!1;const l=new OffscreenCanvas(85,1),e=l.getContext("2d",{willReadFrequently:!0});let o=0;for(let f=0;f<l.width;++f)e.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,e.fillRect(f,0,1,1);const c=e.getImageData(0,0,l.width,l.height);o=0;for(let f=0;f<c.data.length;++f)if(f%4!=3&&o++!==c.data[f])return Et=!0,!0;return Et=!1,!1}};function an(l,e){const o=l.indexOf("?");if(o<0)return`${l}?${new URLSearchParams(e).toString()}`;const c=new URLSearchParams(l.slice(o));for(const f in e)c.set(f,e[f]);return`${l.slice(0,o)}?${c.toString()}`}function Vn(l,e={persistentParams:[]}){const o=l.indexOf("?");if(o<0)return l;const c=new URLSearchParams,f=new URLSearchParams(l.slice(o));for(const g of e.persistentParams){const S=f.get(g);S&&c.set(g,S)}const d=c.toString();return`${l.slice(0,o)}${d.length>0?`?${d}`:""}`}const tr="mapbox-tiles";let Kn=500,Xn=50;const Wr=["language","worldview","jobid"];let Nr,wr;function Hr(){try{return caches}catch{}}function Xr(){const l=Hr();l&&Nr==null&&(Nr=l.open(tr))}let Vr=1/0;const Yo={supported:!1,testSupport:function(l){!Aa&&go&&(Pa?Mc(l):no=l)}};let no,go,Aa=!1,Pa=!1;const lh=typeof self<"u"?self:{};function Mc(l){const e=l.createTexture();l.bindTexture(l.TEXTURE_2D,e);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,go),l.isContextLost())return;Yo.supported=!0}catch{}l.deleteTexture(e),Aa=!0}lh.document&&(go=lh.document.createElement("img"),go.onload=function(){no&&Mc(no),no=null,Pa=!0},go.onerror=function(){Aa=!0,no=null},go.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ko={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Ko);class ch extends Error{constructor(e,o,c){o===401&&qe(c)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Jo=ai()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,ll=function(l,e){if(!(/^file:/.test(o=l.url)||/^file:/.test(Jo())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,f){const d=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Jo(),referrerPolicy:c.referrerPolicy,signal:d.signal});let S=!1,M=!1;const L=(w=g.url).indexOf("sku=")>0&&qe(w);var w;c.type==="json"&&g.headers.set("Accept","application/json");const A=(C,P,D)=>{if(M)return;if(C&&C.message!=="SecurityError"&&$n(C.toString()),P&&D)return R(P);const V=Date.now();fetch(g).then(q=>{if(q.ok){const K=L?q.clone():null;return R(q,K,V)}return f(new ch(q.statusText,q.status,c.url))}).catch(q=>{q.name!=="AbortError"&&f(new Error(`${q.message} ${c.url}`))})},R=(C,P,D)=>{(c.type==="arrayBuffer"?C.arrayBuffer():c.type==="json"?C.json():C.text()).then(V=>{M||(P&&D&&function(q,K,Q){if(Xr(),Nr==null)return;const X=Fi(K.headers.get("Cache-Control")||"");if(X["no-store"])return;const re={status:K.status,statusText:K.statusText,headers:new Headers};K.headers.forEach((Ce,Ee)=>re.headers.set(Ee,Ce)),X["max-age"]&&re.headers.set("Expires",new Date(Q+1e3*X["max-age"]).toUTCString());const de=re.headers.get("Expires");if(!de||new Date(de).getTime()-Q<42e4)return;let ye=Vn(q.url,{persistentParams:Wr});if(K.status===206){const Ce=q.headers.get("Range");if(!Ce)return;re.status=200,ye=an(ye,{range:Ce})}(function(Ce,Ee){if(wr===void 0)try{new Response(new ReadableStream),wr=!0}catch{wr=!1}wr?Ee(Ce.body):Ce.blob().then(Ee)})(K,Ce=>{const Ee=new Response((Te=K.status)!==200&&Te!==404&&[101,103,204,205,304].includes(Te)?null:Ce,re);var Te;Xr(),Nr!=null&&Nr.then(Be=>Be.put(ye,Ee)).catch(Be=>$n(Be.message))})}(g,P,D),S=!0,f(null,V,C.headers.get("Cache-Control"),C.headers.get("Expires")))}).catch(V=>{M||f(new Error(V.message))})};return L?function(C,P){if(Xr(),Nr==null)return P(null);Nr.then(D=>{let V=Vn(C.url,{persistentParams:Wr});const q=C.headers.get("Range");q&&(V=an(V,{range:q})),D.match(V).then(K=>{const Q=function(X){if(!X)return!1;const re=new Date(X.headers.get("Expires")||0),de=Fi(X.headers.get("Cache-Control")||"");return re>Date.now()&&!de["no-cache"]}(K);D.delete(V),Q&&D.put(V,K.clone()),P(null,K,Q)}).catch(P)}).catch(P)}(g,A):A(null,null),{cancel:()=>{M=!0,S||d.abort()}}}(l,e);if(ai()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,e,void 0,!0)}var o;return function(c,f){const d=new XMLHttpRequest;d.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const g in c.headers)d.setRequestHeader(g,c.headers[g]);return c.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=c.credentials==="include",d.onerror=()=>{f(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let g=d.response;if(c.type==="json")try{g=JSON.parse(d.response)}catch(S){return f(S)}f(null,g,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else f(new ch(d.statusText,d.status,c.url))},d.send(c.body),{cancel:()=>d.abort()}}(l,e)},Ic=function(l,e){return ll(Pn(l,{type:"arrayBuffer"}),e)};function Pp(l){const e=document.createElement("a");return e.href=l,e.protocol===location.protocol&&e.host===location.host}const dd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ac,cl;Ac=[],cl=0;const Pc=function(l,e){if(Yo.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),cl>=Re.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:l,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ac.push(d),d}cl++;let o=!1;const c=()=>{if(!o)for(o=!0,cl--;Ac.length&&cl<Re.MAX_PARALLEL_IMAGE_REQUESTS;){const d=Ac.shift(),{requestParameters:g,callback:S,cancelled:M}=d;M||(d.cancel=Pc(g,S).cancel)}},f=Ic(l,(d,g,S,M)=>{c(),d?e(d):g&&(self.createImageBitmap?function(L,w){const A=new Blob([new Uint8Array(L)],{type:"image/png"});createImageBitmap(A).then(R=>{w(null,R)}).catch(R=>{w(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(L,w)=>e(L,w,S,M)):function(L,w){const A=new Image;A.onload=()=>{w(null,A),URL.revokeObjectURL(A.src),A.onload=null,requestAnimationFrame(()=>{A.src=dd})},A.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const R=new Blob([new Uint8Array(L)],{type:"image/png"});A.src=L.byteLength?URL.createObjectURL(R):dd}(g,(L,w)=>e(L,w,S,M)))});return{cancel:()=>{f.cancel(),c()}}};var Rp,Ls,zs,Ds={exports:{}},Os={exports:{}},Fs={exports:{}},uh=function(){if(zs)return Ds.exports;zs=1;var l=(Rp||(Rp=1,Os.exports=function(o,c){var f,d,g,S,M,L,w,A;for(d=o.length-(f=3&o.length),g=c,M=3432918353,L=461845907,A=0;A<d;)w=255&o.charCodeAt(A)|(255&o.charCodeAt(++A))<<8|(255&o.charCodeAt(++A))<<16|(255&o.charCodeAt(++A))<<24,++A,g=27492+(65535&(S=5*(65535&(g=(g^=w=(65535&(w=(w=(65535&w)*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*L+(((w>>>16)*L&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(w=0,f){case 3:w^=(255&o.charCodeAt(A+2))<<16;case 2:w^=(255&o.charCodeAt(A+1))<<8;case 1:g^=w=(65535&(w=(w=(65535&(w^=255&o.charCodeAt(A)))*M+(((w>>>16)*M&65535)<<16)&4294967295)<<15|w>>>17))*L+(((w>>>16)*L&65535)<<16)&4294967295}return g^=o.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),Os.exports),e=(Ls||(Ls=1,Fs.exports=function(o,c){for(var f,d=o.length,g=c^d,S=0;d>=4;)f=1540483477*(65535&(f=255&o.charCodeAt(S)|(255&o.charCodeAt(++S))<<8|(255&o.charCodeAt(++S))<<16|(255&o.charCodeAt(++S))<<24))+((1540483477*(f>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),d-=4,++S;switch(d){case 3:g^=(255&o.charCodeAt(S+2))<<16;case 2:g^=(255&o.charCodeAt(S+1))<<8;case 1:g=1540483477*(65535&(g^=255&o.charCodeAt(S)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),Fs.exports);return Ds.exports=l,Ds.exports.murmur3=l,Ds.exports.murmur2=e,Ds.exports}(),Rc=I(uh);class ri{constructor(e,...o){Pn(this,o[0]||{}),this.type=e}}class ul extends ri{constructor(e,o={}){super("error",Pn({error:e},o))}}function hd(l,e,o){o[l]&&o[l].indexOf(e)!==-1||(o[l]=o[l]||[],o[l].push(e))}function pd(l,e,o){if(o&&o[l]){const c=o[l].indexOf(e);c!==-1&&o[l].splice(c,1)}}class kc{on(e,o){return this._listeners=this._listeners||{},hd(e,o,this._listeners),this}off(e,o){return pd(e,o,this._listeners),pd(e,o,this._oneTimeListeners),this}once(e,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},hd(e,o,this._oneTimeListeners),this):new Promise(c=>this.once(e,c))}fire(e,o){const c=typeof e=="string"?new ri(e,o):e,f=c.type;if(this.listens(f)){c.target=this;const d=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const M of d)M.call(this,c);const g=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const M of g)pd(f,M,this._oneTimeListeners),M.call(this,c);const S=this._eventedParent;S&&(Pn(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(c))}else c instanceof ul&&console.error(c.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var Bs,fd={},wu=function(){if(Bs)return fd;Bs=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function e(d){return(d=Math.round(d))<0?0:d>255?255:d}function o(d){return e(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function c(d){return(g=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:g>1?1:g;var g}function f(d,g,S){return S<0?S+=1:S>1&&(S-=1),6*S<1?d+(g-d)*S*6:2*S<1?g:3*S<2?d+(g-d)*(2/3-S)*6:d}try{fd.parseCSSColor=function(d){var g,S=d.replace(/ /g,"").toLowerCase();if(S in l)return l[S].slice();if(S[0]==="#")return S.length===4?(g=parseInt(S.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:S.length===7&&(g=parseInt(S.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var M=S.indexOf("("),L=S.indexOf(")");if(M!==-1&&L+1===S.length){var w=S.substr(0,M),A=S.substr(M+1,L-(M+1)).split(","),R=1;switch(w){case"rgba":if(A.length!==4)return null;R=c(A.pop());case"rgb":return A.length!==3?null:[o(A[0]),o(A[1]),o(A[2]),R];case"hsla":if(A.length!==4)return null;R=c(A.pop());case"hsl":if(A.length!==3)return null;var C=(parseFloat(A[0])%360+360)%360/360,P=c(A[1]),D=c(A[2]),V=D<=.5?D*(P+1):D+P-D*P,q=2*D-V;return[e(255*f(q,V,C+1/3)),e(255*f(q,V,C)),e(255*f(q,V,C-1/3)),R];default:return null}}return null}}catch{}return fd}();class kr{constructor(e,o,c,f=1){this.r=e,this.g=o,this.b=c,this.a=f}static parse(e){if(!e)return;if(e instanceof kr)return e;if(typeof e!="string")return;const o=wu.parseCSSColor(e);return o?new kr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toStringPremultipliedAlpha(){const[e,o,c,f]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(c)},${f})`}toString(){const[e,o,c,f]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*e)},${Math.round(255*o)},${Math.round(255*c)},${f})`}toRenderColor(e){const{r:o,g:c,b:f,a:d}=this;return new Ul(e,o,c,f,d)}clone(){return new kr(this.r,this.g,this.b,this.a)}}class Ul{constructor(e,o,c,f,d){if(e){const g=e.image.height,S=g*g;o=d===0?0:o/d*(g-1),c=d===0?0:c/d*(g-1),f=d===0?0:f/d*(g-1);const M=Math.floor(o),L=Math.floor(c),w=Math.floor(f),A=Math.ceil(o),R=Math.ceil(c),C=Math.ceil(f),P=o-M,D=c-L,V=f-w,q=e.image.data,K=4*(M+L*S+w*g),Q=4*(M+L*S+C*g),X=4*(M+R*S+w*g),re=4*(M+R*S+C*g),de=4*(A+L*S+w*g),ye=4*(A+L*S+C*g),Ce=4*(A+R*S+w*g),Ee=4*(A+R*S+C*g);if(K<0||Ee>=q.length)throw new Error("out of range");this.r=Fn(Fn(Fn(q[K],q[Q],V),Fn(q[X],q[re],V),D),Fn(Fn(q[de],q[ye],V),Fn(q[Ce],q[Ee],V),D),P)/255*d,this.g=Fn(Fn(Fn(q[K+1],q[Q+1],V),Fn(q[X+1],q[re+1],V),D),Fn(Fn(q[de+1],q[ye+1],V),Fn(q[Ce+1],q[Ee+1],V),D),P)/255*d,this.b=Fn(Fn(Fn(q[K+2],q[Q+2],V),Fn(q[X+2],q[re+2],V),D),Fn(Fn(q[de+2],q[ye+2],V),Fn(q[Ce+2],q[Ee+2],V),D),P)/255*d,this.a=d}else this.r=o,this.g=c,this.b=f,this.a=d}toArray(){const{r:e,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*e/f,255*o/f,255*c/f,f]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:e,g:o,b:c,a:f}=this,d=Math.min(Math.max(e/f,0),1),g=Math.min(Math.max(o/f,0),1),S=Math.min(Math.max(c/f,0),1),M=Math.min(d,g,S),L=Math.max(d,g,S),w=(M+L)/2;if(M===L)return[0,0,100*w,f];const A=L-M,R=w>.5?A/(2-L-M):A/(L+M);let C=0;return L===d?C=(g-S)/A+(g<S?6:0):L===g?C=(S-d)/A+2:L===S&&(C=(d-g)/A+4),C*=60,[Math.min(Math.max(C,0),360),Math.min(Math.max(100*R,0),100),Math.min(Math.max(100*w,0),100),f]}toArray01(){const{r:e,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[e/f,o/f,c/f,f]}toArray01Scaled(e){const{r:o,g:c,b:f,a:d}=this;return d===0?[0,0,0]:[o/d*e,c/d*e,f/d*e]}toArray01PremultipliedAlpha(){const{r:e,g:o,b:c,a:f}=this;return[e,o,c,f]}toArray01Linear(){const{r:e,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[Math.pow(e/f,2.2),Math.pow(o/f,2.2),Math.pow(c/f,2.2),f]}}function Fn(l,e,o){return l*(1-o)+e*o}function Ra(l,e,o){return l.map((c,f)=>Fn(c,e[f],o))}kr.black=new kr(0,0,0,1),kr.white=new kr(1,1,1,1),kr.transparent=new kr(0,0,0,0),kr.red=new kr(1,0,0,1),kr.blue=new kr(0,0,1,1);var Cr=Object.freeze({__proto__:null,array:Ra,color:function(l,e,o){return new kr(Fn(l.r,e.r,o),Fn(l.g,e.g,o),Fn(l.b,e.b,o),Fn(l.a,e.a,o))},number:Fn});function $l(l,...e){for(const o of e)for(const c in o)l[c]=o[c];return l}class bo extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}class kp{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[c,f]of o)this.bindings[c]=f}concat(e){return new kp(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Lc={kind:"null"},fn={kind:"number"},Ur={kind:"string"},zr={kind:"boolean"},Uo={kind:"color"},Vl={kind:"object"},Pr={kind:"value"},Gl={kind:"collator"},Ns={kind:"formatted"},oa={kind:"resolvedImage"};function _o(l,e){return{kind:"array",itemType:l,N:e}}function ui(l){if(l.kind==="array"){const e=ui(l.itemType);return typeof l.N=="number"?`array<${e}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${e}>`}return l.kind}const Wf=[Lc,fn,Ur,zr,Uo,Ns,Vl,_o(Pr),oa];function zc(l,e){if(e.kind==="error")return null;if(l.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!zc(l.itemType,e.itemType))&&(typeof l.N!="number"||l.N===e.N))return null}else{if(l.kind===e.kind)return null;if(l.kind==="value"){for(const o of Wf)if(!zc(o,e))return null}}return`Expected ${ui(l)} but found ${ui(e)} instead.`}function Dc(l,e){return e.some(o=>o.kind===l.kind)}function ql(l,e){return e.some(o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l)}class md{constructor(e,o,c){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class sa{constructor(e,o,c,f,d){this.text=e.normalize?e.normalize():e,this.image=o,this.scale=c,this.fontStack=f,this.textColor=d}}class wo{constructor(e){this.sections=e}static fromString(e){return new wo([new sa(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary)}static factory(e){return e instanceof wo?e:wo.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const o of this.sections){if(o.image){e.push(["image",o.image.namePrimary]);continue}e.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toRenderColor(null).toArray())),e.push(c)}return e}}class js{constructor(e,o){if(this.id=e,this.options=o||{params:{}},this.options.transform){const{a:c,b:f,c:d,d:g,e:S,f:M}=this.options.transform;this.options.transform=new DOMMatrix([c,f,d,g,S,M])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(e){return JSON.parse(e).id}static deserializeFromString(e){const o=JSON.parse(e),{a:c,b:f,c:d,d:g,e:S,f:M}=o.options.transform;return new DOMMatrix([c,f,d,g,S,M]),new js(o.id,o.options)}scaleSelf(e){return this.options.transform=this.options.transform.scale(e),this}serialize(){const e={id:this.id};this.options&&(e.options=this.options);const{a:o,b:c,c:f,d,e:g,f:S}=this.options.transform;return e.options.transform={a:o,b:c,c:f,d,e:g,f:S},JSON.stringify(e)}}class lo{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),e.optionsPrimary&&(this.optionsPrimary=e.optionsPrimary),e.optionsSecondary&&(this.optionsSecondary=e.optionsSecondary),this.available=e.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new js(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new js(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(e){return typeof e=="string"?lo.build(e):e}static build(e,o,c,f){return e?new lo({namePrimary:e,nameSecondary:o,optionsPrimary:c,optionsSecondary:f,available:!1}):null}}function ka(l,e,o,c){return typeof l=="number"&&l>=0&&l<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[l,e,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[l,e,o,c]:[l,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function La(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof kr||l instanceof md||l instanceof wo||l instanceof lo)return!0;if(Array.isArray(l)){for(const e of l)if(!La(e))return!1;return!0}if(typeof l=="object"){for(const e in l)if(!La(l[e]))return!1;return!0}return!1}function gi(l){if(l===null)return Lc;if(typeof l=="string")return Ur;if(typeof l=="boolean")return zr;if(typeof l=="number")return fn;if(l instanceof kr)return Uo;if(l instanceof md)return Gl;if(l instanceof wo)return Ns;if(l instanceof lo)return oa;if(Array.isArray(l)){const e=l.length;let o;for(const c of l){const f=gi(c);if(o){if(o===f)continue;o=Pr;break}o=f}return _o(o||Pr,e)}return Vl}function Xi(l){const e=typeof l;return l===null?"":e==="string"||e==="number"||e==="boolean"?String(l):l instanceof kr?l.toStringPremultipliedAlpha():l instanceof wo||l instanceof lo?l.toString():JSON.stringify(l)}class $o{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(e.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!La(e[1]))return o.error("invalid value");const c=e[1];let f=gi(c);const d=o.expectedType;return f.kind!=="array"||f.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(f=d),new $o(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof kr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof wo?this.value.serialize():this.value}}class Bi{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const dl={string:Ur,number:fn,boolean:zr,object:Vl};class aa{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let c,f=1;const d=e[0];if(d==="array"){let S,M;if(e.length>2){const L=e[1];if(typeof L!="string"||!(L in dl)||L==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);S=dl[L],f++}else S=Pr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);M=e[2],f++}c=_o(S,M)}else c=dl[d];const g=[];for(;f<e.length;f++){const S=o.parse(e[f],f,Pr);if(!S)return null;g.push(S)}return new aa(c,g)}evaluate(e){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(e);if(!zc(this.type,gi(c)))return c;if(o===this.args.length-1)throw new Bi(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${ui(gi(c))} but was expected to be of type ${ui(this.type)}.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,o=[e.kind];if(e.kind==="array"){const c=e.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){o.push(c.kind);const f=e.N;(typeof f=="number"||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map(c=>c.serialize()))}}class ga{constructor(e){this.type=Ns,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const f=[];let d=!1;for(let g=1;g<=e.length-1;++g){const S=e[g];if(d&&typeof S=="object"&&!Array.isArray(S)){d=!1;let M=null;if(S["font-scale"]&&(M=o.parseObjectValue(S["font-scale"],g,"font-scale",fn),!M))return null;let L=null;if(S["text-font"]&&(L=o.parseObjectValue(S["text-font"],g,"text-font",_o(Ur)),!L))return null;let w=null;if(S["text-color"]&&(w=o.parseObjectValue(S["text-color"],g,"text-color",Uo),!w))return null;const A=f[f.length-1];A.scale=M,A.font=L,A.textColor=w}else{const M=o.parse(e[g],g,Pr);if(!M)return null;const L=M.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,f.push({content:M,scale:null,font:null,textColor:null})}}return new ga(f)}evaluate(e){return new wo(this.sections.map(o=>{const c=o.content.evaluate(e);return gi(c)===oa?new sa("",c,null,null,null):new sa(Xi(c),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const o of this.sections){e.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),e.push(c)}return e}}class Wl{constructor(e,o,c,f){this._imageWarnHistory={},this.type=oa,this.inputPrimary=e,this.inputSecondary=o,this.inputPrimaryParams=c,this.inputSecondaryParams=f}static parse(e,o){if(e.length<2)return o.error("Expected two or more arguments.");let c=1;const f=[];function d(){if(c<e.length){const S=o.parse(e[c],c++,Ur);return S?(f.push({image:S,options:void 0}),!0):(o.error(f.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function g(){if(c<e.length){if((S=e[c])===null||typeof S!="object"||Array.isArray(S))return!0;const M=e[c].params,L=o.concat(c);if(!M)return c++,!0;if(typeof M!="object"||M.constructor!==Object)return L.error('Image options "params" should be an object'),!1;const w={},A=L.concat(void 0,"params");for(const R in M){if(!R)return A.error("Image parameter name should be non-empty"),!1;const C=A.concat(void 0,R).parse(M[R],void 0,Uo,void 0,{typeAnnotation:"coerce"});if(!C)return!1;w[R]=C}return f[f.length-1].options=w,c++,!0}var S;return!0}for(let S=0;S<2;S++)if(!d()||!g())return;return new Wl(f[0].image,f[1]?f[1].image:void 0,f[0].options,f[1]?f[1].options:void 0)}evaluateParams(e,o){const c={};if(o){for(const f in o)if(o[f])try{const d=o[f].evaluate(e),g=`Ignoring image parameter "${f}" with semi-transparent color ${d.toString()}`;if(d.a!==1){this._imageWarnHistory[g]||(console.warn(g),this._imageWarnHistory[g]=!0);continue}c[f]=d}catch{continue}if(Object.keys(c).length!==0)return{params:c}}}evaluate(e){const o=lo.build(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0,this.inputPrimaryParams?this.evaluateParams(e,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(e,this.inputSecondaryParams):void 0);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(o.namePrimary)>-1,o.nameSecondary&&o.available&&e.availableImages&&(o.available=e.availableImages.indexOf(o.nameSecondary)>-1)),o}eachChild(e){if(e(this.inputPrimary),this.inputPrimaryParams)for(const o in this.inputPrimaryParams)this.inputPrimaryParams[o]&&e(this.inputPrimaryParams[o]);if(this.inputSecondary&&(e(this.inputSecondary),this.inputSecondaryParams))for(const o in this.inputSecondaryParams)this.inputSecondaryParams[o]&&e(this.inputSecondaryParams[o])}outputDefined(){return!1}serializeParams(e){const o={};if(e){for(const c in e)e[c]&&(o[c]=e[c].serialize());return{params:o}}}serialize(){const e=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&e.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(e.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&e.push(this.serializeParams(this.inputSecondaryParams))),e}}function _a(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const dh={"to-boolean":zr,"to-color":Uo,"to-number":fn,"to-string":Ur};class za{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const c=e[0],f=[];let d=Lc;if(c==="to-array"){if(!Array.isArray(e[1]))return null;const g=e[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);d=_o(o.expectedType.itemType,g)}else{if(!(g>0&&La(e[1][0])))return null;d=_o(gi(e[1][0]),g)}for(let S=0;S<g;S++){const M=e[1][S];let L;if(_a(M)==="array")L=o.parse(M,void 0,d.itemType);else{const w=_a(M);if(w!==d.itemType.kind)return o.error(`Expected ${d.itemType.kind} but found ${w}.`);L=o.registry.literal.parse(["literal",M===void 0?null:M],o)}if(!L)return null;f.push(L)}}else{if((c==="to-boolean"||c==="to-string")&&e.length!==2)return o.error("Expected one argument.");d=dh[c];for(let g=1;g<e.length;g++){const S=o.parse(e[g],g,Pr);if(!S)return null;f.push(S)}}return new za(d,f)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let o,c;for(const f of this.args){if(o=f.evaluate(e),c=null,o instanceof kr)return o;if(typeof o=="string"){const d=e.parseColor(o);if(d)return d}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:ka(o[0],o[1],o[2],o[3]),!c))return new kr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Bi(c||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const c of this.args){if(o=c.evaluate(e),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Bi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?wo.fromString(Xi(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?lo.build(Xi(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(o=>o.evaluate(e)):Xi(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ga([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Wl(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{e.push(o.serialize())}),e}}const Hf=["Unknown","Point","LineString","Polygon"];class hh{constructor(e,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Hf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*o-e[0])+this.featureDistanceData.bearing[1]*(f*o-e[1])}return 0}parseColor(e){let o=this._parseColorCache[e];return o||(o=this._parseColorCache[e]=kr.parse(e)),o}getConfig(e){return this.options?this.options.get(e):null}}class xs{constructor(e,o,c,f,d){this.name=e,this.type=o,this._evaluate=c,this.args=f,this._overloadIndex=d}evaluate(e){if(!this._evaluate){const o=xs.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,o){const c=e[0],f=xs.definitions[c];if(!f)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(f)?f[0]:f.type,g=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,S=[];let M=null,L=-1;for(const[w,A]of g){if(Array.isArray(w)&&w.length!==e.length-1)continue;S.push(w),L++,M=new wh(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const R=[];let C=!1;for(let P=1;P<e.length;P++){const D=e[P],V=Array.isArray(w)?w[P-1]:w.type,q=M.parse(D,1+R.length,V);if(!q){C=!0;break}R.push(q)}if(!C)if(Array.isArray(w)&&w.length!==R.length)M.error(`Expected ${w.length} arguments, but found ${R.length} instead.`);else{for(let P=0;P<R.length;P++){const D=Array.isArray(w)?w[P]:w.type,V=R[P];M.concat(P+1).checkSubtype(D,V.type)}if(M.errors.length===0)return new xs(c,d,A,R,L)}}if(S.length===1)o.errors.push(...M.errors);else{const w=(S.length?S:g.map(([R])=>R)).map(Su).join(" | "),A=[];for(let R=1;R<e.length;R++){const C=o.parse(e[R],1+A.length);if(!C)return null;A.push(ui(C.type))}o.error(`Expected arguments of type ${w}, but found (${A.join(", ")}) instead.`)}return null}static register(e,o){xs.definitions=o;for(const c in o)e[c]=xs}}function Su(l){return Array.isArray(l)?`(${l.map(ui).join(", ")})`:`(${ui(l.type)}...)`}class ph{constructor(e,o,c){this.type=Gl,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(e.length!==2)return o.error("Expected one argument.");const c=e[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const f=c["case-sensitive"]===void 0?o.parse(!1,1,zr):o.parseObjectValue(c["case-sensitive"],1,"case-sensitive",zr);if(!f)return null;const d=c["diacritic-sensitive"]===void 0?o.parse(!1,1,zr):o.parseObjectValue(c["diacritic-sensitive"],1,"diacritic-sensitive",zr);if(!d)return null;let g=null;return c.locale&&(g=o.parseObjectValue(c.locale,1,"locale",Ur),!g)?null:new ph(f,d,g)}evaluate(e){return new md(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}function Zf(l,e,o=0,c=l.length-1,f=gg){for(;c>o;){if(c-o>600){const M=c-o+1,L=e-o+1,w=Math.log(M),A=.5*Math.exp(2*w/3),R=.5*Math.sqrt(w*A*(M-A)/M)*(L-M/2<0?-1:1);Zf(l,e,Math.max(o,Math.floor(e-L*A/M+R)),Math.min(c,Math.floor(e+(M-L)*A/M+R)),f)}const d=l[e];let g=o,S=c;for(gd(l,o,e),f(l[c],d)>0&&gd(l,o,c);g<S;){for(gd(l,g,S),g++,S--;f(l[g],d)<0;)g++;for(;f(l[S],d)>0;)S--}f(l[o],d)===0?gd(l,o,S):(S++,gd(l,S,c)),S<=e&&(o=S+1),e<=S&&(c=S-1)}}function gd(l,e,o){const c=l[e];l[e]=l[o],l[o]=c}function gg(l,e){return l<e?-1:l>e?1:0}function _g(l){let e=0;for(let o,c,f=0,d=l.length,g=d-1;f<d;g=f++)o=l[f],c=l[g],e+=(c.x-o.x)*(o.y+c.y);return e}function Tu(l,e){l[0]=Math.min(l[0],e[0]),l[1]=Math.min(l[1],e[1]),l[2]=Math.max(l[2],e[0]),l[3]=Math.max(l[3],e[1])}function _d(l,e){return!(l[0]<=e[0]||l[2]>=e[2]||l[1]<=e[1]||l[3]>=e[3])}function Xf(l,e,o){const c=l[0]-e[0],f=l[1]-e[1],d=l[0]-o[0],g=l[1]-o[1];return c*g-d*f==0&&c*d<=0&&f*g<=0}function ya(l,e,o=!1){let c=!1;for(let S=0,M=e.length;S<M;S++){const L=e[S];for(let w=0,A=L.length,R=A-1;w<A;R=w++){const C=L[R],P=L[w];if(Xf(l,C,P))return o;(d=C)[1]>(f=l)[1]!=(g=P)[1]>f[1]&&f[0]<(g[0]-d[0])*(f[1]-d[1])/(g[1]-d[1])+d[0]&&(c=!c)}}var f,d,g;return c}function Yf(l,e,o,c){const f=c[0]-o[0],d=c[1]-o[1],g=(l[0]-o[0])*d-f*(l[1]-o[1]),S=(e[0]-o[0])*d-f*(e[1]-o[1]);return g>0&&S<0||g<0&&S>0}function Eu(l,e,o,c){return(f=[c[0]-o[0],c[1]-o[1]])[0]*(d=[e[0]-l[0],e[1]-l[1]])[1]-f[1]*d[0]!=0&&!(!Yf(l,e,o,c)||!Yf(o,c,l,e));var f,d}const Da=8192;function yg(l,e){const o=(180+l[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(o*f*Da),Math.round(c*f*Da)]}function vg(l,e){for(let o=0;o<e.length;o++)if(ya(l,e[o]))return!0;return!1}function Kf(l,e,o){for(const c of o)for(let f=0,d=c.length,g=d-1;f<d;g=f++)if(Eu(l,e,c[g],c[f]))return!0;return!1}function Jf(l,e){for(let o=0;o<l.length;++o)if(!ya(l[o],e))return!1;for(let o=0;o<l.length-1;++o)if(Kf(l[o],l[o+1],e))return!1;return!0}function Cu(l,e){for(let o=0;o<e.length;o++)if(Jf(l,e[o]))return!0;return!1}function vr(l,e,o){const c=[];for(let f=0;f<l.length;f++){const d=[];for(let g=0;g<l[f].length;g++){const S=yg(l[f][g],o);Tu(e,S),d.push(S)}c.push(d)}return c}function kn(l,e,o){const c=[];for(let f=0;f<l.length;f++){const d=vr(l[f],e,o);c.push(d)}return c}function fh(l,e,o,c){if(l[0]<o[0]||l[0]>o[2]){const f=.5*c;let d=l[0]-o[0]>f?-c:o[0]-l[0]>f?c:0;d===0&&(d=l[0]-o[2]>f?-c:o[2]-l[0]>f?c:0),l[0]+=d}Tu(e,l)}function Jn(l,e,o,c){const f=Math.pow(2,c.z)*Da,d=[c.x*Da,c.y*Da],g=[];if(!l)return g;for(const S of l)for(const M of S){const L=[M.x+d[0],M.y+d[1]];fh(L,e,o,f),g.push(L)}return g}function mh(l,e,o,c){const f=Math.pow(2,c.z)*Da,d=[c.x*Da,c.y*Da],g=[];if(!l)return g;for(const M of l){const L=[];for(const w of M){const A=[w.x+d[0],w.y+d[1]];Tu(e,A),L.push(A)}g.push(L)}if(e[2]-e[0]<=f/2){(S=e)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const M of g)for(const L of M)fh(L,e,o,f)}var S;return g}class va{constructor(e,o){this.type=zr,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(La(e[1])){const c=e[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const d=c.features[f].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new va(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new va(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new va(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(o,c){const f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const S=vr(c.coordinates,d,g),M=Jn(o.geometry(),f,d,g);if(!_d(f,d))return!1;for(const L of M)if(!ya(L,S))return!1}if(c.type==="MultiPolygon"){const S=kn(c.coordinates,d,g),M=Jn(o.geometry(),f,d,g);if(!_d(f,d))return!1;for(const L of M)if(!vg(L,S))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(o,c){const f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const S=vr(c.coordinates,d,g),M=mh(o.geometry(),f,d,g);if(!_d(f,d))return!1;for(const L of M)if(!Jf(L,S))return!1}if(c.type==="MultiPolygon"){const S=kn(c.coordinates,d,g),M=mh(o.geometry(),f,d,g);if(!_d(f,d))return!1;for(const L of M)if(!Cu(L,S))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Nn={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Lp=1/298.257223563,yd=Lp*(2-Lp),Oc=Math.PI/180;class Fc{static fromTile(e,o,c){const f=Math.PI*(1-2*(e+.5)/Math.pow(2,o)),d=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/Oc;return new Fc(d,c)}static get units(){return Nn}constructor(e,o){if(e===void 0)throw new Error("No latitude given.");if(o&&!Nn[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(Nn).join(", ")}`);const c=6378.137*Oc*(o?Nn[o]:1),f=Math.cos(e*Oc),d=1/(1-yd*(1-f*f)),g=Math.sqrt(d);this.kx=c*g*f,this.ky=c*g*d*(1-yd)}distance(e,o){const c=To(e[0]-o[0])*this.kx,f=(e[1]-o[1])*this.ky;return Math.sqrt(c*c+f*f)}bearing(e,o){const c=To(o[0]-e[0])*this.kx;return Math.atan2(c,(o[1]-e[1])*this.ky)/Oc}destination(e,o,c){const f=c*Oc;return this.offset(e,Math.sin(f)*o,Math.cos(f)*o)}offset(e,o,c){return[e[0]+o/this.kx,e[1]+c/this.ky]}lineDistance(e){let o=0;for(let c=0;c<e.length-1;c++)o+=this.distance(e[c],e[c+1]);return o}area(e){let o=0;for(let c=0;c<e.length;c++){const f=e[c];for(let d=0,g=f.length,S=g-1;d<g;S=d++)o+=To(f[d][0]-f[S][0])*(f[d][1]+f[S][1])*(c?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(e,o){let c=0;if(o<=0)return e[0];for(let f=0;f<e.length-1;f++){const d=e[f],g=e[f+1],S=this.distance(d,g);if(c+=S,c>o)return So(d,g,(o-(c-S))/S)}return e[e.length-1]}pointToSegmentDistance(e,o,c){let[f,d]=o,g=To(c[0]-f)*this.kx,S=(c[1]-d)*this.ky;if(g!==0||S!==0){const M=(To(e[0]-f)*this.kx*g+(e[1]-d)*this.ky*S)/(g*g+S*S);M>1?(f=c[0],d=c[1]):M>0&&(f+=g/this.kx*M,d+=S/this.ky*M)}return g=To(e[0]-f)*this.kx,S=(e[1]-d)*this.ky,Math.sqrt(g*g+S*S)}pointOnLine(e,o){let c=1/0,f=e[0][0],d=e[0][1],g=0,S=0;for(let M=0;M<e.length-1;M++){let L=e[M][0],w=e[M][1],A=To(e[M+1][0]-L)*this.kx,R=(e[M+1][1]-w)*this.ky,C=0;A===0&&R===0||(C=(To(o[0]-L)*this.kx*A+(o[1]-w)*this.ky*R)/(A*A+R*R),C>1?(L=e[M+1][0],w=e[M+1][1]):C>0&&(L+=A/this.kx*C,w+=R/this.ky*C)),A=To(o[0]-L)*this.kx,R=(o[1]-w)*this.ky;const P=A*A+R*R;P<c&&(c=P,f=L,d=w,g=M,S=C)}return{point:[f,d],index:g,t:Math.max(0,Math.min(1,S))}}lineSlice(e,o,c){let f=this.pointOnLine(c,e),d=this.pointOnLine(c,o);if(f.index>d.index||f.index===d.index&&f.t>d.t){const L=f;f=d,d=L}const g=[f.point],S=f.index+1,M=d.index;!Mu(c[S],g[0])&&S<=M&&g.push(c[S]);for(let L=S+1;L<=M;L++)g.push(c[L]);return Mu(c[M],d.point)||g.push(d.point),g}lineSliceAlong(e,o,c){let f=0;const d=[];for(let g=0;g<c.length-1;g++){const S=c[g],M=c[g+1],L=this.distance(S,M);if(f+=L,f>e&&d.length===0&&d.push(So(S,M,(e-(f-L))/L)),f>=o)return d.push(So(S,M,(o-(f-L))/L)),d;f>e&&d.push(M)}return d}bufferPoint(e,o){const c=o/this.ky,f=o/this.kx;return[e[0]-f,e[1]-c,e[0]+f,e[1]+c]}bufferBBox(e,o){const c=o/this.ky,f=o/this.kx;return[e[0]-f,e[1]-c,e[2]+f,e[3]+c]}insideBBox(e,o){return To(e[0]-o[0])>=0&&To(e[0]-o[2])<=0&&e[1]>=o[1]&&e[1]<=o[3]}}function Mu(l,e){return l[0]===e[0]&&l[1]===e[1]}function So(l,e,o){const c=To(e[0]-l[0]);return[l[0]+c*o,l[1]+(e[1]-l[1])*o]}function To(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class gh{constructor(e=[],o=(c,f)=>c<f?-1:c>f?1:0){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:c}=this,f=o[e];for(;e>0;){const d=e-1>>1,g=o[d];if(c(f,g)>=0)break;o[e]=g,e=d}o[e]=f}_down(e){const{data:o,compare:c}=this,f=this.length>>1,d=o[e];for(;e<f;){let g=1+(e<<1);const S=g+1;if(S<this.length&&c(o[S],o[g])<0&&(g=S),c(o[g],d)>=0)break;o[e]=o[g],e=g}o[e]=d}}var tn=8192;function _h(l,e){return e.dist-l.dist}const Oa=100,Eo=50;function Iu(l){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==l.length)return!1;for(let o=0;o<e.length;o++)if(e[o]!==l[o])return!1;return!0}function Hl(l){return l[1]-l[0]+1}function hl(l,e){const o=l[1]>=l[0]&&l[1]<e;return o||console.warn("Distance Expression: Index is out of range"),o}function pl(l,e){if(l[0]>l[1])return[null,null];const o=Hl(l);if(e){if(o===2)return[l,null];const c=Math.floor(o/2);return[[l[0],l[0]+c],[l[0]+c,l[1]]]}{if(o===1)return[l,null];const c=Math.floor(o/2)-1;return[[l[0],l[0]+c],[l[0]+c+1,l[1]]]}}function Zl(l,e){const o=[1/0,1/0,-1/0,-1/0];if(!hl(e,l.length))return o;for(let c=e[0];c<=e[1];++c)Tu(o,l[c]);return o}function Bc(l){const e=[1/0,1/0,-1/0,-1/0];for(let o=0;o<l.length;++o)for(let c=0;c<l[o].length;++c)Tu(e,l[o][c]);return e}function Xl(l,e,o){if(Iu(l)||Iu(e))return NaN;let c=0,f=0;return l[2]<e[0]&&(c=e[0]-l[2]),l[0]>e[2]&&(c=l[0]-e[2]),l[1]>e[3]&&(f=l[1]-e[3]),l[3]<e[1]&&(f=e[1]-l[3]),o.distance([0,0],[c,f])}function zp(l){return 360*l-180}function Qf(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function yh(l,e){const o=Math.pow(2,e.z),c=(l.y/tn+e.y)/o;return[zp((l.x/tn+e.x)/o),Qf(c)]}function Dp(l,e){const o=[];for(let c=0;c<l.length;++c)o.push(yh(l[c],e));return o}function em(l,e,o){const c=o.pointOnLine(e,l).point;return o.distance(l,c)}function tm(l,e,o,c,f){const d=o.slice(c[0],c[1]+1);let g=1/0;for(let S=e[0];S<=e[1];++S)if((g=Math.min(g,em(l[S],d,f)))===0)return 0;return g}function vh(l,e,o,c,f){const d=Math.min(f.pointToSegmentDistance(l,o,c),f.pointToSegmentDistance(e,o,c)),g=Math.min(f.pointToSegmentDistance(o,l,e),f.pointToSegmentDistance(c,l,e));return Math.min(d,g)}function Nc(l,e,o,c,f){if(!hl(e,l.length)||!hl(c,o.length))return NaN;let d=1/0;for(let g=e[0];g<e[1];++g)for(let S=c[0];S<c[1];++S){if(Eu(l[g],l[g+1],o[S],o[S+1]))return 0;d=Math.min(d,vh(l[g],l[g+1],o[S],o[S+1],f))}return d}function xg(l,e,o,c,f){if(!hl(e,l.length)||!hl(c,o.length))return NaN;let d=1/0;for(let g=e[0];g<=e[1];++g)for(let S=c[0];S<=c[1];++S)if((d=Math.min(d,f.distance(l[g],o[S])))===0)return d;return d}function xa(l,e,o){if(ya(l,e,!0))return 0;let c=1/0;for(const f of e){const d=f.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[d-1]&&(c=Math.min(c,o.pointToSegmentDistance(l,f[d-1],f[0])))===0||(c=Math.min(c,em(l,f,o)))===0)return c}return c}function jc(l,e,o,c){if(!hl(e,l.length))return NaN;for(let d=e[0];d<=e[1];++d)if(ya(l[d],o,!0))return 0;let f=1/0;for(let d=e[0];d<e[1];++d)for(const g of o)for(let S=0,M=g.length,L=M-1;S<M;L=S++){if(Eu(l[d],l[d+1],g[L],g[S]))return 0;f=Math.min(f,vh(l[d],l[d+1],g[L],g[S],c))}return f}function xh(l,e){for(const o of l)for(let c=0;c<=o.length-1;++c)if(ya(o[c],e,!0))return!0;return!1}function Op(l,e,o,c=1/0){const f=Bc(l),d=Bc(e);if(c!==1/0&&Xl(f,d,o)>=c)return c;if(_d(f,d)){if(xh(l,e))return 0}else if(xh(e,l))return 0;let g=c;for(const S of l)for(let M=0,L=S.length,w=L-1;M<L;w=M++)for(const A of e)for(let R=0,C=A.length,P=C-1;R<C;P=R++){if(Eu(S[w],S[M],A[P],A[R]))return 0;g=Math.min(g,vh(S[w],S[M],A[P],A[R],o))}return g}function us(l,e,o,c,f,d,g){if(d===null||g===null)return;const S=Xl(Zl(c,d),Zl(f,g),o);S<e&&l.push({dist:S,range1:d,range2:g})}function Fp(l,e,o,c,f=1/0){let d=Math.min(c.distance(l[0],o[0][0]),f);if(d===0)return d;const g=new gh([{dist:0,range1:[0,l.length-1],range2:[0,0]}],_h),S=e?Eo:Oa,M=Bc(o);for(;g.length;){const L=g.pop();if(L.dist>=d)continue;const w=L.range1;if(Hl(w)<=S){if(!hl(w,l.length))return NaN;if(e){const A=jc(l,w,o,c);if((d=Math.min(d,A))===0)return d}else for(let A=w[0];A<=w[1];++A){const R=xa(l[A],o,c);if((d=Math.min(d,R))===0)return d}}else{const A=pl(w,e);if(A[0]!==null){const R=Xl(Zl(l,A[0]),M,c);R<d&&g.push({dist:R,range1:A[0],range2:[0,0]})}if(A[1]!==null){const R=Xl(Zl(l,A[1]),M,c);R<d&&g.push({dist:R,range1:A[1],range2:[0,0]})}}}return d}function vd(l,e,o,c,f,d=1/0){let g=Math.min(d,f.distance(l[0],o[0]));if(g===0)return g;const S=new gh([{dist:0,range1:[0,l.length-1],range2:[0,o.length-1]}],_h),M=e?Eo:Oa,L=c?Eo:Oa;for(;S.length;){const w=S.pop();if(w.dist>=g)continue;const A=w.range1,R=w.range2;if(Hl(A)<=M&&Hl(R)<=L){if(!hl(A,l.length)||!hl(R,o.length))return NaN;if(e&&c?g=Math.min(g,Nc(l,A,o,R,f)):e||c?e&&!c?g=Math.min(g,tm(o,R,l,A,f)):!e&&c&&(g=Math.min(g,tm(l,A,o,R,f))):g=Math.min(g,xg(l,A,o,R,f)),g===0)return g}else{const C=pl(A,e),P=pl(R,c);us(S,g,f,l,o,C[0],P[0]),us(S,g,f,l,o,C[0],P[1]),us(S,g,f,l,o,C[1],P[0]),us(S,g,f,l,o,C[1],P[1])}}return g}function bh(l,e,o,c,f=1/0){let d=f;const g=Zl(l,[0,l.length-1]);for(const S of o)if(!(d!==1/0&&Xl(g,Zl(S,[0,S.length-1]),c)>=d)&&(d=Math.min(d,vd(l,e,S,!0,c,d)),d===0))return d;return d}function xd(l,e,o,c,f=1/0){let d=f;const g=Zl(l,[0,l.length-1]);for(const S of o){if(d!==1/0&&Xl(g,Bc(S),c)>=d)continue;const M=Fp(l,e,S,c,d);if(isNaN(M))return M;if((d=Math.min(d,M))===0)return d}return d}function fl(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class Fa{constructor(e,o){this.type=fn,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(La(e[1])){const c=e[1];if(c.type==="FeatureCollection"){for(let f=0;f<c.features.length;++f)if(fl(c.features[f].geometry.type))return new Fa(c,c.features[f].geometry)}else if(c.type==="Feature"){if(fl(c.geometry.type))return new Fa(c,c.geometry)}else if(fl(c.type))return new Fa(c,c)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const o=e.geometry(),c=e.canonicalID();if(o!=null&&c!=null){if(e.geometryType()==="Point")return function(f,d,g){const S=[];for(const L of f)for(const w of L)S.push(yh(w,d));const M=new Fc(S[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?vd(S,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",M):g.type==="MultiLineString"?bh(S,!1,g.coordinates,M):g.type==="Polygon"||g.type==="MultiPolygon"?xd(S,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,M):null}(o,c,this.geometries);if(e.geometryType()==="LineString")return function(f,d,g){const S=[];for(const L of f){const w=[];for(const A of L)w.push(yh(A,d));S.push(w)}const M=new Fc(S[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return bh(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",S,M);if(g.type==="MultiLineString"){let L=1/0;for(let w=0;w<g.coordinates.length;w++){const A=bh(g.coordinates[w],!0,S,M,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}if(g.type==="Polygon"||g.type==="MultiPolygon"){let L=1/0;for(let w=0;w<S.length;w++){const A=xd(S[w],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,M,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}return null}(o,c,this.geometries);if(e.geometryType()==="Polygon")return function(f,d,g){const S=[];for(const L of function(w,A){const R=w.length;if(R<=1)return[w];const C=[];let P,D;for(let V=0;V<R;V++){const q=_g(w[V]);q!==0&&(w[V].area=Math.abs(q),D===void 0&&(D=q<0),D===q<0?(P&&C.push(P),P=[w[V]]):P.push(w[V]))}return P&&C.push(P),C}(f)){const w=[];for(let A=0;A<L.length;++A)w.push(Dp(L[A],d));S.push(w)}const M=new Fc(S[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return xd(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",S,M);if(g.type==="MultiLineString"){let L=1/0;for(let w=0;w<g.coordinates.length;w++){const A=xd(g.coordinates[w],!0,S,M,L);if(isNaN(A))return A;if((L=Math.min(L,A))===0)return L}return L}return g.type==="Polygon"||g.type==="MultiPolygon"?function(L,w,A){let R=1/0;for(const C of L)for(const P of w){const D=Op(C,P,A,R);if(isNaN(D))return D;if((R=Math.min(R,D))===0)return R}return R}(g.type==="Polygon"?[g.coordinates]:g.coordinates,S,M):null}(o,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Yl(l,e){switch(l){case"string":return Xi(e);case"number":return+e;case"boolean":return!!e;case"color":return kr.parse(e);case"formatted":return wo.fromString(Xi(e));case"resolvedImage":return lo.build(Xi(e))}return e}function bd(l,e,o,c){return c!==void 0&&(l=c*Math.round(l/c)),e!==void 0&&l<e&&(l=e),o!==void 0&&l>o&&(l=o),l}class Kl{constructor(e,o,c){this.type=e,this.key=o,this.scope=c}static parse(e,o){let c=o.expectedType;if(c==null&&(c=Pr),e.length<2||e.length>3)return o.error("Invalid number of arguments for 'config' expression.");const f=o.parse(e[1],1);if(!(f instanceof $o))return o.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){const d=o.parse(e[2],2);return d instanceof $o?new Kl(c,Xi(f.value),Xi(d.value)):o.error("Scope of 'config' expression must be a string literal.")}return new Kl(c,Xi(f.value))}evaluate(e){const o=[this.key,this.scope,e.scope].filter(Boolean).join(""),c=e.getConfig(o);if(!c)return null;const{type:f,value:d,values:g,minValue:S,maxValue:M,stepValue:L}=c,w=c.default.evaluate(e);let A=w;if(d){const R=e.scope;e.scope=(R||"").split("").slice(1).join(""),A=d.evaluate(e),e.scope=R}return f&&(A=Yl(f,A)),A===void 0||S===void 0&&M===void 0&&L===void 0||(typeof A=="number"?A=bd(A,S,M,L):Array.isArray(A)&&(A=A.map(R=>typeof R=="number"?bd(R,S,M,L):R))),d!==void 0&&A!==void 0&&g&&!g.includes(A)&&(A=w,f&&(A=Yl(f,A))),(f&&f!==this.type||A!==void 0&&gi(A)!==this.type)&&(A=Yl(this.type.kind,A)),A}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.key),e}}function ml(l){if(l instanceof xs&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof va||l instanceof Fa)return!1;let e=!0;return l.eachChild(o=>{e&&!ml(o)&&(e=!1)}),e}function Ba(l){if(l instanceof xs&&l.name==="feature-state")return!1;let e=!0;return l.eachChild(o=>{e&&!Ba(o)&&(e=!1)}),e}function gl(l){if(l instanceof Kl)return new Set([l.key]);let e=new Set;return l.eachChild(o=>{e=new Set([...e,...gl(o)])}),e}function Na(l,e){if(l instanceof xs&&e.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild(c=>{o&&!Na(c,e)&&(o=!1)}),o}class ja{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(e.length!==2||typeof e[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=e[1];return o.scope.has(c)?new ja(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class wd{constructor(e,o=[],c,f=new kp,d=[],g,S){this.registry=e,this.path=o,this.key=o.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=f,this.errors=d,this.expectedType=c,this._scope=g,this.options=S}parse(e,o,c,f,d={}){return o||c?this.concat(o,null,c,f)._parse(e,d):this._parse(e,d)}parseObjectValue(e,o,c,f,d,g={}){return this.concat(o,c,f,d)._parse(e,g)}_parse(e,o){function c(f,d,g){return g==="assert"?new aa(d,[f]):g==="coerce"?new za(d,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(f){let d=f.parse(e,this);if(!d)return null;if(this.expectedType){const g=this.expectedType,S=d.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||S.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(g,S))return null}else d=c(d,g,o.typeAnnotation||"coerce");else d=c(d,g,o.typeAnnotation||"assert")}if(!(d instanceof $o)&&d.type.kind!=="resolvedImage"&&Sd(d)){const g=new hh(this._scope,this.options);try{d=new $o(d.type,d.evaluate(g))}catch(S){return this.error(S.message),null}}return d}return za.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,c,f){let d=typeof e=="number"?this.path.concat(e):this.path;d=typeof o=="string"?d.concat(o):d;const g=f?this.scope.concat(f):this.scope;return new wd(this.registry,d,c||null,g,this.errors,this._scope,this.options)}error(e,...o){const c=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new bo(c,e))}checkSubtype(e,o){const c=zc(e,o);return c&&this.error(c),c}}var wh=wd;function Sd(l){if(l instanceof ja)return Sd(l.boundExpression);if(l instanceof xs&&l.name==="error"||l instanceof ph||l instanceof va||l instanceof Fa||l instanceof Kl)return!1;const e=l instanceof za||l instanceof aa;let o=!0;return l.eachChild(c=>{o=e?o&&Sd(c):o&&c instanceof $o}),!!o&&ml(l)&&Na(l,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Ua(l,e){const o=l.length-1;let c,f,d=0,g=o,S=0;for(;d<=g;)if(S=Math.floor((d+g)/2),c=l[S],f=l[S+1],c<=e){if(S===o||e<f)return S;d=S+1}else{if(!(c>e))throw new Bi("Input is not a number.");g=S-1}return 0}class Tr{constructor(e,o,c){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[f,d]of c)this.labels.push(f),this.outputs.push(d)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(e[1],1,fn);if(!c)return null;const f=[];let d=null;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);for(let g=1;g<e.length;g+=2){const S=g===1?-1/0:e[g],M=e[g+1],L=g,w=g+1;if(typeof S!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(f.length&&f[f.length-1][0]>=S)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const A=o.parse(M,w,d);if(!A)return null;d=d||A.type,f.push([S,A])}return new Tr(d,c,f)}evaluate(e){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return c[0].evaluate(e);const d=o.length;return f>=o[d-1]?c[d-1].evaluate(e):c[Ua(o,f)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&e.push(this.labels[o]),e.push(this.outputs[o].serialize());return e}}const Bp=.95047,_l=1.08883,Sh=4/29,yl=6/29,nm=3*yl*yl,_i=yl*yl*yl,Td=Math.PI/180,bg=180/Math.PI;function Th(l){return l>_i?Math.pow(l,1/3):l/nm+Sh}function Eh(l){return l>yl?l*l*l:nm*(l-Sh)}function Ri(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Ed(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Cd(l){const e=Ed(l.r),o=Ed(l.g),c=Ed(l.b),f=Th((.4124564*e+.3575761*o+.1804375*c)/Bp),d=Th((.2126729*e+.7151522*o+.072175*c)/1);return{l:116*d-16,a:500*(f-d),b:200*(d-Th((.0193339*e+.119192*o+.9503041*c)/_l)),alpha:l.a}}function Au(l){let e=(l.l+16)/116,o=isNaN(l.a)?e:e+l.a/500,c=isNaN(l.b)?e:e-l.b/200;return e=1*Eh(e),o=Bp*Eh(o),c=_l*Eh(c),new kr(Ri(3.2404542*o-1.5371385*e-.4985314*c),Ri(-.969266*o+1.8760108*e+.041556*c),Ri(.0556434*o-.2040259*e+1.0572252*c),l.alpha)}function rm(l,e,o){const c=e-l;return l+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const Uc={forward:Cd,reverse:Au,interpolate:function(l,e,o){return{l:Fn(l.l,e.l,o),a:Fn(l.a,e.a,o),b:Fn(l.b,e.b,o),alpha:Fn(l.alpha,e.alpha,o)}}},vl={forward:function(l){const{l:e,a:o,b:c}=Cd(l),f=Math.atan2(c,o)*bg;return{h:f<0?f+360:f,c:Math.sqrt(o*o+c*c),l:e,alpha:l.a}},reverse:function(l){const e=l.h*Td,o=l.c;return Au({l:l.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:l.alpha})},interpolate:function(l,e,o){return{h:rm(l.h,e.h,o),c:Fn(l.c,e.c,o),l:Fn(l.l,e.l,o),alpha:Fn(l.alpha,e.alpha,o)}}};var Md=Object.freeze({__proto__:null,hcl:vl,lab:Uc});class Co{constructor(e,o,c,f,d,g){this.type=e,this.operator=o,this.interpolation=c,this.input=f,this.dynamicStops=d,this.labels=[],this.outputs=[];for(const[S,M]of g)this.labels.push(S),this.outputs.push(M)}static interpolationFactor(e,o,c,f){let d=0;if(e.name==="exponential")d=Ch(o,e.base,c,f);else if(e.name==="linear")d=Ch(o,1,c,f);else if(e.name==="cubic-bezier"){const g=e.controlPoints;d=new pn(g[0],g[1],g[2],g[3]).solve(Ch(o,1,c,f))}return d}static parse(e,o){let[c,f,d,...g]=e;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const L=f[1];if(typeof L!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:L}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const L=f.slice(1);if(L.length!==4||L.some(w=>typeof w!="number"||w<0||w>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:L}}}if(e.length-1<3)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length-1>3&&(e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(d=o.parse(d,2,fn),!d)return null;const S=[];let M=null;if(c==="interpolate-hcl"||c==="interpolate-lab"?M=Uo:o.expectedType&&o.expectedType.kind!=="value"&&(M=o.expectedType),e.length-1==3){const L=o.parse(g[0],3,Pr);return L?new Co(M,c,f,d,L,S):null}for(let L=0;L<g.length;L+=2){const w=g[L],A=g[L+1],R=L+3,C=L+4;if(typeof w!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(S.length&&S[S.length-1][0]>=w)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const P=o.parse(A,C,M);if(!P)return null;M=M||P.type,S.push([w,P])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Co(M,c,f,d,null,S):o.error(`Type ${ui(M)} is not interpolatable.`)}evaluate(e){let o=this.labels,c=this.outputs;if(this.dynamicStops){const w=this.dynamicStops.evaluate(e);if(w.length%2!=0)throw new Bi("Expected an even number of arguments.");o=[],c=[];for(let A=0;A<w.length;A+=2){const R=w[A],C=new $o(fn,w[A+1]);if(typeof R!="number")throw new Bi('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(o.length&&o[o.length-1]>=R)throw new Bi('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');o.push(R),c.push(C)}if(o.length===0)throw new Bi("Expected at least one input/output pair.")}if(o.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return c[0].evaluate(e);const d=o.length;if(f>=o[d-1])return c[d-1].evaluate(e);const g=Ua(o,f),S=Co.interpolationFactor(this.interpolation,f,o[g],o[g+1]),M=c[g].evaluate(e),L=c[g+1].evaluate(e);return this.operator==="interpolate"?Cr[this.type.kind.toLowerCase()](M,L,S):this.operator==="interpolate-hcl"?vl.reverse(vl.interpolate(vl.forward(M),vl.forward(L),S)):Uc.reverse(Uc.interpolate(Uc.forward(M),Uc.forward(L),S))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,e,this.input.serialize()];if(this.dynamicStops)o.push(this.dynamicStops.serialize());else for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function Ch(l,e,o,c){const f=c-o,d=l-o;return f===0?0:e===1?d/f:(Math.pow(e,d)-1)/(Math.pow(e,f)-1)}class Mh{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let c=null;const f=o.expectedType;f&&f.kind!=="value"&&(c=f);const d=[];for(const S of e.slice(1)){const M=o.parse(S,1+d.length,c,void 0,{typeAnnotation:"omit"});if(!M)return null;c=c||M.type,d.push(M)}const g=f&&d.some(S=>zc(f,S.type));return new Mh(g?Pr:c,d)}evaluate(e){let o,c=null,f=0;for(const d of this.args){if(f++,c=d.evaluate(e),c&&c instanceof lo&&!c.available&&(o||(o=c),c=null,f===this.args.length))return o;if(c!==null)break}return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(o=>{e.push(o.serialize())}),e}}class Ih{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let d=1;d<e.length-1;d+=2){const g=e[d];if(typeof g!="string")return o.error(`Expected string, but found ${typeof g} instead.`,d);if(/[^a-zA-Z0-9_]/.test(g))return o.error("Variable names must contain only alphanumeric characters or '_'.",d);const S=o.parse(e[d+1],d+1);if(!S)return null;c.push([g,S])}const f=o.parse(e[e.length-1],e.length-1,o.expectedType,c);return f?new Ih(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[o,c]of this.bindings)e.push(o,c.serialize());return e.push(this.result.serialize()),e}}class Ah{constructor(e,o,c){this.type=e,this.index=o,this.input=c}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,fn),f=o.parse(e[2],2,_o(o.expectedType||Pr));return c&&f?new Ah(f.type.itemType,c,f):null}evaluate(e){const o=this.index.evaluate(e),c=this.input.evaluate(e);if(o<0)throw new Bi(`Array index out of bounds: ${o} < 0.`);if(o>c.length-1)throw new Bi(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o===Math.floor(o))return c[o];const f=Math.floor(o),d=Math.ceil(o),g=c[f],S=c[d];if(typeof g!="number"||typeof S!="number")throw new Bi(`Cannot interpolate between non-number values at index ${o}.`);const M=o-f;return g*(1-M)+S*M}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Pu{constructor(e,o){this.type=zr,this.needle=e,this.haystack=o}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,Pr),f=o.parse(e[2],2,Pr);return c&&f?Dc(c.type,[zr,Ur,fn,Lc,Pr])?new Pu(c,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(c.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(c==null)return!1;if(!ql(o,["boolean","string","number","null"]))throw new Bi(`Expected first argument to be of type boolean, string, number or null, but found ${ui(gi(o))} instead.`);if(!ql(c,["string","array"]))throw new Bi(`Expected second argument to be of type array or string, but found ${ui(gi(c))} instead.`);return c.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class $c{constructor(e,o,c){this.type=fn,this.needle=e,this.haystack=o,this.fromIndex=c}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,Pr),f=o.parse(e[2],2,Pr);if(!c||!f)return null;if(!Dc(c.type,[zr,Ur,fn,Lc,Pr]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(c.type)} instead`);if(e.length===4){const d=o.parse(e[3],3,fn);return d?new $c(c,f,d):null}return new $c(c,f)}evaluate(e){const o=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!ql(o,["boolean","string","number","null"]))throw new Bi(`Expected first argument to be of type boolean, string, number or null, but found ${ui(gi(o))} instead.`);if(!ql(c,["string","array"]))throw new Bi(`Expected second argument to be of type array or string, but found ${ui(gi(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(e);return c.indexOf(o,f)}return c.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Id{constructor(e,o,c,f,d,g){this.inputType=e,this.type=o,this.input=c,this.cases=f,this.outputs=d,this.otherwise=g}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let c,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const d={},g=[];for(let L=2;L<e.length-1;L+=2){let w=e[L];const A=e[L+1];Array.isArray(w)||(w=[w]);const R=o.concat(L);if(w.length===0)return R.error("Expected at least one branch label.");for(const P of w){if(typeof P!="number"&&typeof P!="string")return R.error("Branch labels must be numbers or strings.");if(typeof P=="number"&&Math.abs(P)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof P=="number"&&Math.floor(P)!==P)return R.error("Numeric branch labels must be integer values.");if(c){if(R.checkSubtype(c,gi(P)))return null}else c=gi(P);if(d[String(P)]!==void 0)return R.error("Branch labels must be unique.");d[String(P)]=g.length}const C=o.parse(A,L,f);if(!C)return null;f=f||C.type,g.push(C)}const S=o.parse(e[1],1,Pr);if(!S)return null;const M=o.parse(e[e.length-1],e.length-1,f);return M?S.type.kind!=="value"&&o.concat(1).checkSubtype(c,S.type)?null:new Id(c,f,S,d,g,M):null}evaluate(e){const o=this.input.evaluate(e);return(gi(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],f={};for(const g of o){const S=f[this.cases[g]];S===void 0?(f[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[S][1].push(g)}const d=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,S]of c)e.push(S.length===1?d(S[0]):S.map(d)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}class Ad{constructor(e,o,c){this.type=e,this.branches=o,this.otherwise=c}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const f=[];for(let g=1;g<e.length-1;g+=2){const S=o.parse(e[g],g,zr);if(!S)return null;const M=o.parse(e[g+1],g+1,c);if(!M)return null;f.push([S,M]),c=c||M.type}const d=o.parse(e[e.length-1],e.length-1,c);return d?new Ad(c,f,d):null}evaluate(e){for(const[o,c]of this.branches)if(o.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,c]of this.branches)e(o),e(c);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(o=>{e.push(o.serialize())}),e}}class Ru{constructor(e,o,c,f){this.type=e,this.input=o,this.beginIndex=c,this.endIndex=f}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,Pr),f=o.parse(e[2],2,fn);if(!c||!f)return null;if(!Dc(c.type,[_o(Pr),Ur,Pr]))return o.error(`Expected first argument to be of type array or string, but found ${ui(c.type)} instead`);if(e.length===4){const d=o.parse(e[3],3,fn);return d?new Ru(c.type,c,f,d):null}return new Ru(c.type,c,f)}evaluate(e){const o=this.input.evaluate(e),c=this.beginIndex.evaluate(e);if(!ql(o,["string","array"]))throw new Bi(`Expected first argument to be of type array or string, but found ${ui(gi(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(e);return o.slice(c,f)}return o.slice(c)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Ph(l,e){return l==="=="||l==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function im(l,e,o,c){return c.compare(e,o)===0}function Vc(l,e,o){const c=l!=="=="&&l!=="!=";return class kR{constructor(d,g,S){this.type=zr,this.lhs=d,this.rhs=g,this.collator=S,this.hasUntypedArgument=d.type.kind==="value"||g.type.kind==="value"}static parse(d,g){if(d.length!==3&&d.length!==4)return g.error("Expected two or three arguments.");const S=d[0];let M=g.parse(d[1],1,Pr);if(!M)return null;if(!Ph(S,M.type))return g.concat(1).error(`"${S}" comparisons are not supported for type '${ui(M.type)}'.`);let L=g.parse(d[2],2,Pr);if(!L)return null;if(!Ph(S,L.type))return g.concat(2).error(`"${S}" comparisons are not supported for type '${ui(L.type)}'.`);if(M.type.kind!==L.type.kind&&M.type.kind!=="value"&&L.type.kind!=="value")return g.error(`Cannot compare types '${ui(M.type)}' and '${ui(L.type)}'.`);c&&(M.type.kind==="value"&&L.type.kind!=="value"?M=new aa(L.type,[M]):M.type.kind!=="value"&&L.type.kind==="value"&&(L=new aa(M.type,[L])));let w=null;if(d.length===4){if(M.type.kind!=="string"&&L.type.kind!=="string"&&M.type.kind!=="value"&&L.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(w=g.parse(d[3],3,Gl),!w)return null}return new kR(M,L,w)}evaluate(d){const g=this.lhs.evaluate(d),S=this.rhs.evaluate(d);if(c&&this.hasUntypedArgument){const M=gi(g),L=gi(S);if(M.kind!==L.kind||M.kind!=="string"&&M.kind!=="number")throw new Bi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${M.kind}, ${L.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const M=gi(g),L=gi(S);if(M.kind!=="string"||L.kind!=="string")return e(d,g,S)}return this.collator?o(d,g,S,this.collator.evaluate(d)):e(d,g,S)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[l];return this.eachChild(g=>{d.push(g.serialize())}),d}}}const wg=Vc("==",function(l,e,o){return e===o},im),Sg=Vc("!=",function(l,e,o){return e!==o},function(l,e,o,c){return!im(0,e,o,c)}),Np=Vc("<",function(l,e,o){return e<o},function(l,e,o,c){return c.compare(e,o)<0}),Jl=Vc(">",function(l,e,o){return e>o},function(l,e,o,c){return c.compare(e,o)>0}),om=Vc("<=",function(l,e,o){return e<=o},function(l,e,o,c){return c.compare(e,o)<=0}),ku=Vc(">=",function(l,e,o){return e>=o},function(l,e,o,c){return c.compare(e,o)>=0});class bs{constructor(e,o,c,f,d,g){this.type=Ur,this.number=e,this.locale=o,this.currency=c,this.unit=f,this.minFractionDigits=d,this.maxFractionDigits=g}static parse(e,o){if(e.length!==3)return o.error("Expected two arguments.");const c=o.parse(e[1],1,fn);if(!c)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let d=null;if(f.locale&&(d=o.parseObjectValue(f.locale,2,"locale",Ur),!d))return null;let g=null;if(f.currency&&(g=o.parseObjectValue(f.currency,2,"currency",Ur),!g))return null;let S=null;if(f.unit&&(S=o.parseObjectValue(f.unit,2,"unit",Ur),!S))return null;let M=null;if(f["min-fraction-digits"]&&(M=o.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",fn),!M))return null;let L=null;return f["max-fraction-digits"]&&(L=o.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",fn),!L)?null:new bs(c,d,g,S,M,L)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Gc{constructor(e){this.type=fn,this.input=e}static parse(e,o){if(e.length!==2)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=o.parse(e[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ui(c.type)} instead.`):new Gc(c):null}evaluate(e){const o=this.input.evaluate(e);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Bi(`Expected value to be of type string or array, but found ${ui(gi(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(o=>{e.push(o.serialize())}),e}}function ba(l){return function(){l=1831565813+(l|=0)|0;let e=Math.imul(l^l>>>15,1|l);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const Ql={"==":wg,"!=":Sg,">":Jl,"<":Np,">=":ku,"<=":om,array:aa,at:Ah,boolean:aa,case:Ad,coalesce:Mh,collator:ph,format:ga,image:Wl,in:Pu,"index-of":$c,interpolate:Co,"interpolate-hcl":Co,"interpolate-lab":Co,length:Gc,let:Ih,literal:$o,match:Id,number:aa,"number-format":bs,object:aa,slice:Ru,step:Tr,string:aa,"to-boolean":za,"to-color":za,"to-number":za,"to-string":za,var:ja,within:va,distance:Fa,config:Kl};function sm(l,[e,o,c,f]){e=e.evaluate(l),o=o.evaluate(l),c=c.evaluate(l);const d=f?f.evaluate(l):1,g=ka(e,o,c,d);if(g)throw new Bi(g);return new kr(e/255*d,o/255*d,c/255*d,d)}function am(l,[e,o,c,f]){e=e.evaluate(l),o=o.evaluate(l),c=c.evaluate(l);const d=f?f.evaluate(l):1,g=function(L,w,A,R){return typeof L=="number"&&L>=0&&L<=360?typeof w=="number"&&w>=0&&w<=100&&typeof A=="number"&&A>=0&&A<=100?R===void 0||typeof R=="number"&&R>=0&&R<=1?null:`Invalid hsla value [${[L,w,A,R].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof R=="number"?[L,w,A,R]:[L,w,A]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof R=="number"?[L,w,A,R]:[L,w,A]).join(", ")}]: 'h' must be between 0 and 360.`}(e,o,c,d);if(g)throw new Bi(g);const S=`hsla(${e}, ${o}%, ${c}%, ${d})`,M=kr.parse(S);if(!M)throw new Bi(`Failed to parse HSLA color: ${S}`);return M}function xl(l,e){return l in e}function ec(l,e){const o=e[l];return o===void 0?null:o}function Vo(l){return{type:l}}function Lu(l){return{result:"success",value:l}}function wa(l){return{result:"error",value:l}}function tc(l,e){return!!l&&!!l.parameters&&l.parameters.indexOf(e)>-1}function Us(l){return l["property-type"]==="data-driven"}function Ai(l){return tc(l.expression,"measure-light")}function ki(l){return tc(l.expression,"zoom")}function $a(l){return!!l.expression&&l.expression.interpolated}function Mo(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function ds(l){return l}function nc(l,e){const o=e.type==="color",c=l.stops&&typeof l.stops[0][0]=="object",f=c||!(c||l.property!==void 0),d=l.type||($a(e)?"exponential":"interval");if(o&&((l=$l({},l)).stops&&(l.stops=l.stops.map(L=>[L[0],kr.parse(L[1])])),l.default=kr.parse(l.default?l.default:e.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Md[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let g,S,M;if(d==="exponential")g=Rh;else if(d==="interval")g=Pd;else if(d==="categorical"){g=ws,S=Object.create(null);for(const L of l.stops)S[L[0]]=L[1];M=typeof l.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);g=Rd}if(c){const L={},w=[];for(let C=0;C<l.stops.length;C++){const P=l.stops[C],D=P[0].zoom;L[D]===void 0&&(L[D]={zoom:D,type:l.type,property:l.property,default:l.default,stops:[]},w.push(D)),L[D].stops.push([P[0].value,P[1]])}const A=[];for(const C of w)A.push([L[C].zoom,nc(L[C],e)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:Co.interpolationFactor.bind(void 0,R),zoomStops:A.map(C=>C[0]),evaluate:({zoom:C},P)=>Rh({stops:A,base:l.base},e,C).evaluate(C,P)}}if(f){const L=d==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:Co.interpolationFactor.bind(void 0,L),zoomStops:l.stops.map(w=>w[0]),evaluate:({zoom:w})=>g(l,e,w,S,M)}}return{kind:"source",evaluate(L,w){const A=w&&w.properties?w.properties[l.property]:void 0;return A===void 0?Va(l.default,e.default):g(l,e,A,S,M)}}}function Va(l,e,o){return l!==void 0?l:e!==void 0?e:o!==void 0?o:void 0}function ws(l,e,o,c,f){return Va(typeof o===f?c[o]:void 0,l.default,e.default)}function Pd(l,e,o){if(_a(o)!=="number")return Va(l.default,e.default);const c=l.stops.length;if(c===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[c-1][0])return l.stops[c-1][1];const f=Ua(l.stops.map(d=>d[0]),o);return l.stops[f][1]}function Rh(l,e,o){const c=l.base!==void 0?l.base:1;if(_a(o)!=="number")return Va(l.default,e.default);const f=l.stops.length;if(f===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[f-1][0])return l.stops[f-1][1];const d=Ua(l.stops.map(w=>w[0]),o),g=function(w,A,R,C){const P=C-R,D=w-R;return P===0?0:A===1?D/P:(Math.pow(A,D)-1)/(Math.pow(A,P)-1)}(o,c,l.stops[d][0],l.stops[d+1][0]),S=l.stops[d][1],M=l.stops[d+1][1];let L=Cr[e.type]||ds;if(l.colorSpace&&l.colorSpace!=="rgb"){const w=Md[l.colorSpace];L=(A,R)=>w.reverse(w.interpolate(w.forward(A),w.forward(R),g))}return typeof S.evaluate=="function"?{evaluate(...w){const A=S.evaluate.apply(void 0,w),R=M.evaluate.apply(void 0,w);if(A!==void 0&&R!==void 0)return L(A,R,g)}}:L(S,M,g)}function Rd(l,e,o){return e.type==="color"?o=kr.parse(o):e.type==="formatted"?o=wo.fromString(o.toString()):e.type==="resolvedImage"?o=lo.build(o.toString()):_a(o)===e.type||e.type==="enum"&&e.values[o]||(o=void 0),Va(o,l.default,e.default)}xs.register(Ql,{error:[{kind:"error"},[Ur],(l,[e])=>{throw new Bi(e.evaluate(l))}],typeof:[Ur,[Pr],(l,[e])=>ui(gi(e.evaluate(l)))],"to-rgba":[_o(fn,4),[Uo],(l,[e])=>e.evaluate(l).toRenderColor(null).toArray()],"to-hsla":[_o(fn,4),[Uo],(l,[e])=>e.evaluate(l).toRenderColor(null).toHslaArray()],rgb:[Uo,[fn,fn,fn],sm],rgba:[Uo,[fn,fn,fn,fn],sm],hsl:[Uo,[fn,fn,fn],am],hsla:[Uo,[fn,fn,fn,fn],am],has:{type:zr,overloads:[[[Ur],(l,[e])=>xl(e.evaluate(l),l.properties())],[[Ur,Vl],(l,[e,o])=>xl(e.evaluate(l),o.evaluate(l))]]},get:{type:Pr,overloads:[[[Ur],(l,[e])=>ec(e.evaluate(l),l.properties())],[[Ur,Vl],(l,[e,o])=>ec(e.evaluate(l),o.evaluate(l))]]},"feature-state":[Pr,[Ur],(l,[e])=>ec(e.evaluate(l),l.featureState||{})],properties:[Vl,[],l=>l.properties()],"geometry-type":[Ur,[],l=>l.geometryType()],id:[Pr,[],l=>l.id()],zoom:[fn,[],l=>l.globals.zoom],pitch:[fn,[],l=>l.globals.pitch||0],"distance-from-center":[fn,[],l=>l.distanceFromCenter()],"measure-light":[fn,[Ur],(l,[e])=>l.measureLight(e.evaluate(l))],"heatmap-density":[fn,[],l=>l.globals.heatmapDensity||0],"line-progress":[fn,[],l=>l.globals.lineProgress||0],"raster-value":[fn,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[fn,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[fn,[],l=>l.globals.skyRadialProgress||0],accumulated:[Pr,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[fn,Vo(fn),(l,e)=>{let o=0;for(const c of e)o+=c.evaluate(l);return o}],"*":[fn,Vo(fn),(l,e)=>{let o=1;for(const c of e)o*=c.evaluate(l);return o}],"-":{type:fn,overloads:[[[fn,fn],(l,[e,o])=>e.evaluate(l)-o.evaluate(l)],[[fn],(l,[e])=>-e.evaluate(l)]]},"/":[fn,[fn,fn],(l,[e,o])=>e.evaluate(l)/o.evaluate(l)],"%":[fn,[fn,fn],(l,[e,o])=>e.evaluate(l)%o.evaluate(l)],ln2:[fn,[],()=>Math.LN2],pi:[fn,[],()=>Math.PI],e:[fn,[],()=>Math.E],"^":[fn,[fn,fn],(l,[e,o])=>Math.pow(e.evaluate(l),o.evaluate(l))],sqrt:[fn,[fn],(l,[e])=>Math.sqrt(e.evaluate(l))],log10:[fn,[fn],(l,[e])=>Math.log(e.evaluate(l))/Math.LN10],ln:[fn,[fn],(l,[e])=>Math.log(e.evaluate(l))],log2:[fn,[fn],(l,[e])=>Math.log(e.evaluate(l))/Math.LN2],sin:[fn,[fn],(l,[e])=>Math.sin(e.evaluate(l))],cos:[fn,[fn],(l,[e])=>Math.cos(e.evaluate(l))],tan:[fn,[fn],(l,[e])=>Math.tan(e.evaluate(l))],asin:[fn,[fn],(l,[e])=>Math.asin(e.evaluate(l))],acos:[fn,[fn],(l,[e])=>Math.acos(e.evaluate(l))],atan:[fn,[fn],(l,[e])=>Math.atan(e.evaluate(l))],min:[fn,Vo(fn),(l,e)=>Math.min(...e.map(o=>o.evaluate(l)))],max:[fn,Vo(fn),(l,e)=>Math.max(...e.map(o=>o.evaluate(l)))],abs:[fn,[fn],(l,[e])=>Math.abs(e.evaluate(l))],round:[fn,[fn],(l,[e])=>{const o=e.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[fn,[fn],(l,[e])=>Math.floor(e.evaluate(l))],ceil:[fn,[fn],(l,[e])=>Math.ceil(e.evaluate(l))],"filter-==":[zr,[Ur,Pr],(l,[e,o])=>l.properties()[e.value]===o.value],"filter-id-==":[zr,[Pr],(l,[e])=>l.id()===e.value],"filter-type-==":[zr,[Ur],(l,[e])=>l.geometryType()===e.value],"filter-<":[zr,[Ur,Pr],(l,[e,o])=>{const c=l.properties()[e.value],f=o.value;return typeof c==typeof f&&c<f}],"filter-id-<":[zr,[Pr],(l,[e])=>{const o=l.id(),c=e.value;return typeof o==typeof c&&o<c}],"filter->":[zr,[Ur,Pr],(l,[e,o])=>{const c=l.properties()[e.value],f=o.value;return typeof c==typeof f&&c>f}],"filter-id->":[zr,[Pr],(l,[e])=>{const o=l.id(),c=e.value;return typeof o==typeof c&&o>c}],"filter-<=":[zr,[Ur,Pr],(l,[e,o])=>{const c=l.properties()[e.value],f=o.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[zr,[Pr],(l,[e])=>{const o=l.id(),c=e.value;return typeof o==typeof c&&o<=c}],"filter->=":[zr,[Ur,Pr],(l,[e,o])=>{const c=l.properties()[e.value],f=o.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[zr,[Pr],(l,[e])=>{const o=l.id(),c=e.value;return typeof o==typeof c&&o>=c}],"filter-has":[zr,[Pr],(l,[e])=>e.value in l.properties()],"filter-has-id":[zr,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[zr,[_o(Ur)],(l,[e])=>e.value.indexOf(l.geometryType())>=0],"filter-id-in":[zr,[_o(Pr)],(l,[e])=>e.value.indexOf(l.id())>=0],"filter-in-small":[zr,[Ur,_o(Pr)],(l,[e,o])=>o.value.indexOf(l.properties()[e.value])>=0],"filter-in-large":[zr,[Ur,_o(Pr)],(l,[e,o])=>function(c,f,d,g){for(;d<=g;){const S=d+g>>1;if(f[S]===c)return!0;f[S]>c?g=S-1:d=S+1}return!1}(l.properties()[e.value],o.value,0,o.value.length-1)],all:{type:zr,overloads:[[[zr,zr],(l,[e,o])=>e.evaluate(l)&&o.evaluate(l)],[Vo(zr),(l,e)=>{for(const o of e)if(!o.evaluate(l))return!1;return!0}]]},any:{type:zr,overloads:[[[zr,zr],(l,[e,o])=>e.evaluate(l)||o.evaluate(l)],[Vo(zr),(l,e)=>{for(const o of e)if(o.evaluate(l))return!0;return!1}]]},"!":[zr,[zr],(l,[e])=>!e.evaluate(l)],"is-supported-script":[zr,[Ur],(l,[e])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(e.evaluate(l))}],upcase:[Ur,[Ur],(l,[e])=>e.evaluate(l).toUpperCase()],downcase:[Ur,[Ur],(l,[e])=>e.evaluate(l).toLowerCase()],concat:[Ur,Vo(Pr),(l,e)=>e.map(o=>Xi(o.evaluate(l))).join("")],"resolved-locale":[Ur,[Gl],(l,[e])=>e.evaluate(l).resolvedLocale()],random:[fn,[fn,fn,Pr],(l,e)=>{const[o,c,f]=e.map(g=>g.evaluate(l));if(o>c||o===c)return o;let d;if(typeof f=="string")d=function(g){let S=0;if(g.length===0)return S;for(let M=0;M<g.length;M++)S=(S<<5)-S+g.charCodeAt(M),S|=0;return S}(f);else{if(typeof f!="number")throw new Bi(`Invalid seed input: ${f}`);d=f}return o+ba(d)()*(c-o)}]});class zu{constructor(e,o,c,f){this.expression=e,this._warningHistory={},this._evaluator=new hh(c,f),this._defaultValue=o?function(d){return d.type==="color"&&(Mo(d.default)||Array.isArray(d.default))?new kr(0,0,0,0):d.type==="color"?kr.parse(d.default)||null:d.default===void 0?null:d.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=gl(e)}evaluateWithoutErrorHandling(e,o,c,f,d,g,S,M){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(e,o,c,f,d,g,S,M){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=M||null;try{const L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new Bi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${L.message}`)),this._defaultValue}}}function kd(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Ql}function $s(l,e,o,c){const f=new wh(Ql,[],e?function(g){const S={color:Uo,string:Ur,number:fn,enum:Ur,boolean:zr,formatted:Ns,resolvedImage:oa};return g.type==="array"?_o(S[g.value]||Pr,g.length):S[g.type]}(e):void 0,void 0,void 0,o,c),d=f.parse(l,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Lu(new zu(d,e,o,c)):wa(f.errors)}class Du{constructor(e,o,c,f){this.kind=e,this._styleExpression=o,this.isLightConstant=c,this.isLineProgressConstant=f,this.isStateDependent=e!=="constant"&&!Ba(o.expression),this.configDependencies=gl(o.expression)}evaluateWithoutErrorHandling(e,o,c,f,d,g){return this._styleExpression.evaluateWithoutErrorHandling(e,o,c,f,d,g)}evaluate(e,o,c,f,d,g){return this._styleExpression.evaluate(e,o,c,f,d,g)}}class rc{constructor(e,o,c,f,d,g){this.kind=e,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=e!=="camera"&&!Ba(o.expression),this.isLightConstant=d,this.isLineProgressConstant=g,this.configDependencies=gl(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,o,c,f,d,g){return this._styleExpression.evaluateWithoutErrorHandling(e,o,c,f,d,g)}evaluate(e,o,c,f,d,g){return this._styleExpression.evaluate(e,o,c,f,d,g)}interpolationFactor(e,o,c){return this.interpolationType?Co.interpolationFactor(this.interpolationType,e,o,c):0}}function kh(l,e,o,c){if((l=$s(l,e,o,c)).result==="error")return l;const f=l.value.expression,d=ml(f);if(!d&&!Us(e))return wa([new bo("","data expressions not supported")]);const g=Na(f,["zoom","pitch","distance-from-center"]);if(!g&&!ki(e))return wa([new bo("","zoom expressions not supported")]);const S=Na(f,["measure-light"]);if(!S&&!Ai(e))return wa([new bo("","measure-light expression not supported")]);const M=Na(f,["line-progress"]);if(!M&&!function(A){return tc(A.expression,"line-progress")}(e))return wa([new bo("","line-progress expression not supported")]);const L=e.expression&&e.expression.relaxZoomRestriction,w=Sa(f);return w||g||L?w instanceof bo?wa([w]):w instanceof Co&&!$a(e)?wa([new bo("",'"interpolate" expressions cannot be used with this property')]):Lu(w?new rc(d&&M?"camera":"composite",l.value,w.labels,w instanceof Co?w.interpolation:void 0,S,M):new Du(d&&M?"constant":"source",l.value,S,M)):wa([new bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Lh{constructor(e,o){this._parameters=e,this._specification=o,$l(this,nc(this._parameters,this._specification))}static deserialize(e){return new Lh(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Sa(l){let e=null;if(l instanceof Ih)e=Sa(l.result);else if(l instanceof Mh){for(const o of l.args)if(e=Sa(o),e)break}else(l instanceof Tr||l instanceof Co)&&l.input instanceof xs&&l.input.name==="zoom"&&(e=l);return e instanceof bo||l.eachChild(o=>{const c=Sa(o);c instanceof bo?e=c:e&&c&&e!==c&&(e=new bo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var ic,oc,zh=function(){if(oc)return ic;oc=1,ic=e;var l=3;function e(o,c,f){var d=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var g=new Int32Array(this.arrayBuffer);o=g[0],this.d=(c=g[1])+2*(f=g[2]);for(var S=0;S<this.d*this.d;S++){var M=g[l+S],L=g[l+S+1];d.push(M===L?null:g.subarray(M,L))}var w=g[l+d.length+1];this.keys=g.subarray(g[l+d.length],w),this.bboxes=g.subarray(w),this.insert=this._insertReadonly}else{this.d=c+2*f;for(var A=0;A<this.d*this.d;A++)d.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=o,this.padding=f,this.scale=c/o,this.uid=0;var R=f/c*o;this.min=-R,this.max=o+R}return e.prototype.insert=function(o,c,f,d,g){this._forEachCell(c,f,d,g,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(d),this.bboxes.push(g)},e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},e.prototype._insertCell=function(o,c,f,d,g,S){this.cells[g].push(S)},e.prototype.query=function(o,c,f,d,g){var S=this.min,M=this.max;if(o<=S&&c<=S&&M<=f&&M<=d&&!g)return Array.prototype.slice.call(this.keys);var L=[];return this._forEachCell(o,c,f,d,this._queryCell,L,{},g),L},e.prototype._queryCell=function(o,c,f,d,g,S,M,L){var w=this.cells[g];if(w!==null)for(var A=this.keys,R=this.bboxes,C=0;C<w.length;C++){var P=w[C];if(M[P]===void 0){var D=4*P;(L?L(R[D+0],R[D+1],R[D+2],R[D+3]):o<=R[D+2]&&c<=R[D+3]&&f>=R[D+0]&&d>=R[D+1])?(M[P]=!0,S.push(A[P])):M[P]=!1}}},e.prototype._forEachCell=function(o,c,f,d,g,S,M,L){for(var w=this._convertToCellCoord(o),A=this._convertToCellCoord(c),R=this._convertToCellCoord(f),C=this._convertToCellCoord(d),P=w;P<=R;P++)for(var D=A;D<=C;D++){var V=this.d*D+P;if((!L||L(this._convertFromCellCoord(P),this._convertFromCellCoord(D),this._convertFromCellCoord(P+1),this._convertFromCellCoord(D+1)))&&g.call(this,o,c,f,d,V,S,M,L))return}},e.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},e.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,c=l+this.cells.length+1+1,f=0,d=0;d<this.cells.length;d++)f+=this.cells[d].length;var g=new Int32Array(c+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var S=c,M=0;M<o.length;M++){var L=o[M];g[l+M]=S,g.set(L,S),S+=L.length}return g[l+o.length]=S,g.set(this.keys,S),g[l+o.length+1]=S+=this.keys.length,g.set(this.bboxes,S),S+=this.bboxes.length,g.buffer},ic}(),bl=I(zh);const Qo={};function dn(l,e,o={}){Object.defineProperty(l,"_classRegistryKey",{value:e,writable:!1}),Qo[e]={klass:l,omit:o.omit||[]}}dn(Object,"Object"),bl.serialize=function(l,e){const o=l.toArrayBuffer();return e&&e.add(o),{buffer:o}},bl.deserialize=function(l){return new bl(l.buffer)},Object.defineProperty(bl,"name",{value:"Grid"}),dn(bl,"Grid"),typeof DOMMatrix<"u"&&dn(DOMMatrix,"DOMMatrix"),dn(kr,"Color"),dn(Error,"Error"),dn(wo,"Formatted"),dn(sa,"FormattedSection"),dn(ch,"AJAXError"),dn(lo,"ResolvedImage"),dn(Lh,"StylePropertyFunction"),dn(zu,"StyleExpression",{omit:["_evaluator"]}),dn(js,"ImageIdWithOptions"),dn(rc,"ZoomDependentExpression"),dn(Du,"ZoomConstantExpression"),dn(xs,"CompoundExpression",{omit:["_evaluate"]});for(const l in Ql)Qo[Ql[l]._classRegistryKey]||dn(Ql[l],`Expression${l}`);function wl(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Ga(l){return self.ImageBitmap&&l instanceof ImageBitmap}function yo(l,e){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(wl(l)||Ga(l))return e&&e.add(l),l;if(ArrayBuffer.isView(l))return e&&e.add(l.buffer),l;if(l instanceof ImageData)return e&&e.add(l.data.buffer),l;if(Array.isArray(l)){const o=[];for(const c of l)o.push(yo(c,e));return o}if(l instanceof Map){const o={$name:"Map"};for(const[c,f]of l.entries())o[c]=yo(f);return o}if(l instanceof Set){const o={$name:"Set"};let c=0;for(const f of l.values())o[++c]=yo(f);return o}if(typeof l=="object"){const o=l.constructor,c=o._classRegistryKey;if(!c)throw new Error(`Can't serialize object of unregistered class "${c}".`);const f=o.serialize?o.serialize(l,e):{};if(!o.serialize){for(const d in l)l.hasOwnProperty(d)&&(Qo[c].omit.indexOf(d)>=0||(f[d]=yo(l[d],e)));l instanceof Error&&(f.message=l.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof l)}function Vs(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||wl(l)||Ga(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(Vs);if(typeof l=="object"){const e=l.$name||"Object";if(e==="Map"){const f=new Map;for(const d of Object.keys(l))d!=="$name"&&f.set(d,Vs(l[d]));return f}if(e==="Set"){const f=new Set;for(const d of Object.keys(l))d!=="$name"&&f.add(Vs(l[d]));return f}const{klass:o}=Qo[e];if(!o)throw new Error(`Can't deserialize unregistered class "${e}".`);if(o.deserialize)return o.deserialize(l);const c=Object.create(o.prototype);for(const f of Object.keys(l))f!=="$name"&&(c[f]=Vs(l[f]));return c}throw new Error("can't deserialize object of type "+typeof l)}const Mn={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function Ld(l){for(const e of l)if(es(e.charCodeAt(0)))return!0;return!1}function Dh(l){for(const e of l)if(!Ss(e.charCodeAt(0)))return!1;return!0}function Ss(l){return!(Mn.Arabic(l)||Mn["Arabic Supplement"](l)||Mn["Arabic Extended-A"](l)||Mn["Arabic Presentation Forms-A"](l)||Mn["Arabic Presentation Forms-B"](l))}function es(l){return!(l!==746&&l!==747&&(l<4352||!(Mn["Bopomofo Extended"](l)||Mn.Bopomofo(l)||Mn["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Mn["CJK Compatibility Ideographs"](l)||Mn["CJK Compatibility"](l)||Mn["CJK Radicals Supplement"](l)||Mn["CJK Strokes"](l)||!(!Mn["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Mn["CJK Unified Ideographs Extension A"](l)||Mn["CJK Unified Ideographs"](l)||Mn["Enclosed CJK Letters and Months"](l)||Mn["Hangul Compatibility Jamo"](l)||Mn["Hangul Jamo Extended-A"](l)||Mn["Hangul Jamo Extended-B"](l)||Mn["Hangul Jamo"](l)||Mn["Hangul Syllables"](l)||Mn.Hiragana(l)||Mn["Ideographic Description Characters"](l)||Mn.Kanbun(l)||Mn["Kangxi Radicals"](l)||Mn["Katakana Phonetic Extensions"](l)||Mn.Katakana(l)&&l!==12540||!(!Mn["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Mn["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Mn["Unified Canadian Aboriginal Syllabics"](l)||Mn["Unified Canadian Aboriginal Syllabics Extended"](l)||Mn["Vertical Forms"](l)||Mn["Yijing Hexagram Symbols"](l)||Mn["Yi Syllables"](l)||Mn["Yi Radicals"](l))))}function Ni(l){return!(es(l)||function(e){return!!(Mn["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Mn["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Mn["Letterlike Symbols"](e)||Mn["Number Forms"](e)||Mn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Mn["Control Pictures"](e)&&e!==9251||Mn["Optical Character Recognition"](e)||Mn["Enclosed Alphanumerics"](e)||Mn["Geometric Shapes"](e)||Mn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Mn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Mn["CJK Symbols and Punctuation"](e)||Mn.Katakana(e)||Mn["Private Use Area"](e)||Mn["CJK Compatibility Forms"](e)||Mn["Small Form Variants"](e)||Mn["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(l))}function Ts(l){return l>=1424&&l<=2303||Mn["Arabic Presentation Forms-A"](l)||Mn["Arabic Presentation Forms-B"](l)}function Oh(l,e){return!(!e&&Ts(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Mn.Khmer(l))}function jp(l){for(const e of l)if(Ts(e.charCodeAt(0)))return!0;return!1}const zd="deferred",la="loading",Fh="loaded";let Ou=null,ts="unavailable",Gs=null;const qc=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(ts="error"),Ou&&Ou(l)};function Bh(){qa.fire(new ri("pluginStateChange",{pluginStatus:ts,pluginURL:Gs}))}const qa=new kc,Wc=function(){return ts},Up=function(){if(ts!==zd||!Gs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ts=la,Bh(),Gs&&Ic({url:Gs},l=>{l?qc(l):(ts=Fh,Bh())})},qs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ts===Fh||qs.applyArabicShaping!=null,isLoading:()=>ts===la,setState(l){ts=l.pluginStatus,Gs=l.pluginURL},isParsed:()=>qs.applyArabicShaping!=null&&qs.processBidirectionalText!=null&&qs.processStyledBidirectionalText!=null,getPluginURL:()=>Gs};class Jr{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(o,c){for(const f of o)if(!Oh(f.charCodeAt(0),c))return!1;return!0}(e,qs.isLoaded())}}class Hc{constructor(e,o,c,f){this.property=e,this.value=o,this.expression=function(d,g,S,M){if(Mo(d))return new Lh(d,g);if(kd(d)||Array.isArray(d)&&d.length>0){const L=kh(d,g,S,M);if(L.result==="error")throw new Error(L.value.map(w=>`${w.key}: ${w.message}`).join(", "));return L.value}{let L=d;return typeof d=="string"&&g.type==="color"&&(L=kr.parse(d)),{kind:"constant",configDependencies:new Set,evaluate:()=>L}}}(o===void 0?e.specification.default:o,e.specification,c,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,o,c){return this.property.possiblyEvaluate(this,e,o,c)}}class Zc{constructor(e,o,c){this.property=e,this.value=new Hc(e,void 0,o,c)}transitioned(e,o){return new ca(this.property,this.value,o,Pn({},e.transition,this.transition),e.now)}untransitioned(){return new ca(this.property,this.value,null,{},0)}}class sc{constructor(e,o,c){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=o,this._options=c,this.configDependencies=new Set}getValue(e){return Ar(this._values[e].value.value)}setValue(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new Zc(this._values[e].property,this._scope,this._options)),this._values[e].value=new Hc(this._values[e].property,o===null?void 0:Ar(o),this._scope,this._options),this._values[e].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].value.expression.configDependencies]))}setTransitionOrValue(e,o){o&&(this._options=o);const c=this._properties.properties;if(e)for(const f in e){const d=e[f];if(Lr(f,"-transition")){const g=f.slice(0,-11);c[g]&&this.setTransition(g,d)}else c.hasOwnProperty(f)&&this.setValue(f,d)}}getTransition(e){return Ar(this._values[e].transition)}setTransition(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new Zc(this._values[e].property)),this._values[e].transition=Ar(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(e[o]=c);const f=this.getTransition(o);f!==void 0&&(e[`${o}-transition`]=f)}return e}transitioned(e,o){const c=new Nh(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(e,o._values[f]);return c}untransitioned(){const e=new Nh(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class ca{constructor(e,o,c,f,d){const g=f.delay||0,S=f.duration||0;d=d||0,this.property=e,this.value=o,this.begin=d+g,this.end=this.begin+S,e.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(e,o,c){const f=e.now||0,d=this.value.possiblyEvaluate(e,o,c),g=this.prior;if(g){if(f>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(f<this.begin)return g.possiblyEvaluate(e,o,c);{const S=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,o,c),d,Er(S))}}return d}}class Nh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,c){const f=new lc(this._properties);for(const d of Object.keys(this._values))f._values[d]=this._values[d].possiblyEvaluate(e,o,c);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class $p{constructor(e,o,c){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=o,this._options=c,this.configDependencies=new Set}getValue(e){return Ar(this._values[e].value)}setValue(e,o){this._values[e]=new Hc(this._values[e].property,o===null?void 0:Ar(o),this._scope,this._options),this._values[e].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].expression.configDependencies]))}serialize(){const e={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(e[o]=c)}return e}possiblyEvaluate(e,o,c){const f=new lc(this._properties);for(const d of Object.keys(this._values))f._values[d]=this._values[d].possiblyEvaluate(e,o,c);return f}}class ac{constructor(e,o,c){this.property=e,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,o,c,f){return this.property.evaluate(this.value,this.parameters,e,o,c,f)}}class lc{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Wt{constructor(e){this.specification=e}possiblyEvaluate(e,o){return e.expression.evaluate(o)}interpolate(e,o,c){const f=Cr[this.specification.type];return f?f(e,o,c):e}}class nn{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,c,f){return new ac(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(o,null,{},c,f)}:e.expression,o)}interpolate(e,o,c){if(e.value.kind!=="constant"||o.value.kind!=="constant")return e;if(e.value.value===void 0||o.value.value===void 0)return new ac(this,{kind:"constant",value:void 0},e.parameters);const f=Cr[this.specification.type];return f?new ac(this,{kind:"constant",value:f(e.value.value,o.value.value,c)},e.parameters):e}evaluate(e,o,c,f,d,g){return e.kind==="constant"?e.value:e.evaluate(o,c,f,d,g)}}class Es{constructor(e){this.specification=e}possiblyEvaluate(e,o,c,f){return!!e.expression.evaluate(o,null,{},c,f)}interpolate(){return!1}}class bi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new Jr(0,{});for(const c in e){const f=e[c];f.specification.overridable&&this.overridableProperties.push(c);const d=this.defaultPropertyValues[c]=new Hc(f,void 0),g=this.defaultTransitionablePropertyValues[c]=new Zc(f);this.defaultTransitioningPropertyValues[c]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=d.possiblyEvaluate(o)}}}dn(nn,"DataDrivenProperty"),dn(Wt,"DataConstantProperty"),dn(Es,"ColorRampProperty");var ft=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Wa(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Ta(l){if(Array.isArray(l))return l.map(Ta);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const e={};for(const o in l)e[o]=Ta(l[o]);return e}return Wa(l)}function Dd(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const e of l.slice(1))if(!Dd(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Vp(l,e="",o=null,c="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Dd(l)||(l=El(l));const f=l;let d=!0;try{d=function(w){if(!Tl(w))return w;let A=Ta(w);return Sl(A),A=Ha(A),A}(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}let g=null,S=null;if(c!=="background"&&c!=="sky"&&c!=="slot"){S=ft[`filter_${c}`];const w=$s(d,S,e,o);if(w.result==="error")throw new Error(w.value.map(A=>`${A.key}: ${A.message}`).join(", "));g=(A,R,C)=>w.value.evaluate(A,R,{},C)}let M=null,L=null;if(d!==f){const w=$s(f,S,e,o);if(w.result==="error")throw new Error(w.value.map(A=>`${A.key}: ${A.message}`).join(", "));M=(A,R,C,P,D)=>w.value.evaluate(A,R,{},C,void 0,void 0,P,D),L=!ml(w.value.expression)}return{filter:g,dynamicFilter:M||void 0,needGeometry:cc(d),needFeature:!!L}}function Ha(l){if(!Array.isArray(l))return l;const e=function(o){if(lm.has(o[0])){for(let c=1;c<o.length;c++)if(Tl(o[c]))return!0}return o}(l);return e===!0?e:e.map(o=>Ha(o))}function Sl(l){let e=!1;const o=[];if(l[0]==="case"){for(let c=1;c<l.length-1;c+=2)e=e||Tl(l[c]),o.push(l[c+1]);o.push(l[l.length-1])}else if(l[0]==="match"){e=e||Tl(l[1]);for(let c=2;c<l.length-1;c+=2)o.push(l[c+1]);o.push(l[l.length-1])}else if(l[0]==="step"){e=e||Tl(l[1]);for(let c=1;c<l.length-1;c+=2)o.push(l[c+1])}e&&(l.length=0,l.push("any",...o));for(let c=1;c<l.length;c++)Sl(l[c])}function Tl(l){if(!Array.isArray(l))return!1;if((e=l[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let o=1;o<l.length;o++)if(Tl(l[o]))return!0;return!1}const lm=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function jh(l,e){return l<e?-1:l>e?1:0}function cc(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let e=1;e<l.length;e++)if(cc(l[e]))return!0;return!1}function El(l){if(!l)return!0;const e=l[0];return l.length<=1?e!=="any":e==="=="?Ws(l[1],l[2],"=="):e==="!="?Za(Ws(l[1],l[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ws(l[1],l[2],e):e==="any"?(o=l.slice(1),["any"].concat(o.map(El))):e==="all"?["all"].concat(l.slice(1).map(El)):e==="none"?["all"].concat(l.slice(1).map(El).map(Za)):e==="in"?Cl(l[1],l.slice(2)):e==="!in"?Za(Cl(l[1],l.slice(2))):e==="has"?Fu(l[1]):e!=="!has"||Za(Fu(l[1]));var o}function Ws(l,e,o){switch(l){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,l,e]}}function Cl(l,e){if(e.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",l,["literal",e.sort(jh)]]:["filter-in-small",l,["literal",e]]}}function Fu(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Za(l){return["!",l]}const Hs="";function ns(l,e){return e?`${l}${Hs}${e}`:l}const uc="-transition",Gp=new Set(["fill","line","background","hillshade","raster"]);class Qr extends kc{constructor(e,o,c,f,d){if(super(),this.id=e.id,this.fqid=ns(this.id,c),this.type=e.type,this.scope=c,this.lut=f,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,e.type!=="custom"){if(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type&&e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"){this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter;const g=$s(this.filter,ft[`filter_${e.type}`]);g.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...g.value.configDependencies]))}if(e.slot&&(this.slot=e.slot),o.layout&&(this._unevaluatedLayout=new $p(o.layout,this.scope,d),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new sc(o.paint,this.scope,d);for(const g in e.paint)this.setPaintProperty(g,e.paint[g]);for(const g in e.layout)this.setLayoutProperty(g,e.layout[g]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new lc(o.paint)}}}onAdd(e){}onRemove(e){}isDraped(e){return!this.is3D()&&Gp.has(this.type)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o){if(this.type==="custom"&&e==="visibility")return void(this.visibility=o);const c=this._unevaluatedLayout;c._properties.properties[e]&&(c.setValue(e,o),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(e){return Lr(e,uc)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o){const c=this._transitionablePaint,f=c._properties.properties;if(Lr(e,uc)){const A=e.slice(0,-11);return f[A]&&c.setTransition(A,o||void 0),!1}if(!f[e])return!1;const d=c._values[e],g=d.value.isDataDriven(),S=d.value;c.setValue(e,o),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),this._handleSpecialPaintPropertyUpdate(e);const M=c._values[e].value,L=M.isDataDriven(),w=Lr(e,"pattern")||e==="line-dasharray";return L||g||w||this._handleOverridablePaintPropertyUpdate(e,S,M)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,o,c){return null}_handleOverridablePaintPropertyUpdate(e,o,c){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){return Yn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,o)=>!(e===void 0||o==="layout"&&!Object.keys(e).length||o==="paint"&&!Object.keys(e).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof ac&&Us(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(e){this._filterCompiled||(this._featureFilter=Vp(this.filter,this.scope,e),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,o,c,f,d,g,S,M,L){}}const Uh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xc{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class li{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dr(l,e=1){let o=0,c=0;return{members:l.map(f=>{const d=Uh[f.type].BYTES_PER_ELEMENT,g=o=Bu(o,Math.max(e,d)),S=f.components||1;return c=Math.max(c,d),o+=d*S,{name:f.name,type:f.type,components:S,offset:g}}),size:Bu(o,Math.max(c,e)),alignment:e}}function Bu(l,e){return Math.ceil(l/e)*e}class Go extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.int16[f+0]=o,this.int16[f+1]=c,e}}Go.prototype.bytesPerElement=4,dn(Go,"StructArrayLayout2i4");class Li extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const d=3*e;return this.int16[d+0]=o,this.int16[d+1]=c,this.int16[d+2]=f,e}}Li.prototype.bytesPerElement=6,dn(Li,"StructArrayLayout3i6");class ji extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,c,f)}emplace(e,o,c,f,d){const g=4*e;return this.int16[g+0]=o,this.int16[g+1]=c,this.int16[g+2]=f,this.int16[g+3]=d,e}}ji.prototype.bytesPerElement=8,dn(ji,"StructArrayLayout4i8");class vo extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,c,f,d)}emplace(e,o,c,f,d,g){const S=5*e;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=f,this.int16[S+3]=d,this.int16[S+4]=g,e}}vo.prototype.bytesPerElement=10,dn(vo,"StructArrayLayout5i10");class hs extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S){const M=this.length;return this.resize(M+1),this.emplace(M,e,o,c,f,d,g,S)}emplace(e,o,c,f,d,g,S,M){const L=6*e,w=12*e,A=3*e;return this.int16[L+0]=o,this.int16[L+1]=c,this.uint8[w+4]=f,this.uint8[w+5]=d,this.uint8[w+6]=g,this.uint8[w+7]=S,this.float32[A+2]=M,e}}hs.prototype.bytesPerElement=12,dn(hs,"StructArrayLayout2i4ub1f12");class ua extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,c,f)}emplace(e,o,c,f,d){const g=4*e;return this.float32[g+0]=o,this.float32[g+1]=c,this.float32[g+2]=f,this.float32[g+3]=d,e}}ua.prototype.bytesPerElement=16,dn(ua,"StructArrayLayout4f16");class Zs extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const d=3*e;return this.float32[d+0]=o,this.float32[d+1]=c,this.float32[d+2]=f,e}}Zs.prototype.bytesPerElement=12,dn(Zs,"StructArrayLayout3f12");class dc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,c,f,d)}emplace(e,o,c,f,d,g){const S=6*e,M=3*e;return this.uint16[S+0]=o,this.uint16[S+1]=c,this.uint16[S+2]=f,this.uint16[S+3]=d,this.float32[M+2]=g,e}}dc.prototype.bytesPerElement=12,dn(dc,"StructArrayLayout4ui1f12");class Io extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,c,f)}emplace(e,o,c,f,d){const g=4*e;return this.uint16[g+0]=o,this.uint16[g+1]=c,this.uint16[g+2]=f,this.uint16[g+3]=d,e}}Io.prototype.bytesPerElement=8,dn(Io,"StructArrayLayout4ui8");class Nu extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g){const S=this.length;return this.resize(S+1),this.emplace(S,e,o,c,f,d,g)}emplace(e,o,c,f,d,g,S){const M=6*e;return this.int16[M+0]=o,this.int16[M+1]=c,this.int16[M+2]=f,this.int16[M+3]=d,this.int16[M+4]=g,this.int16[M+5]=S,e}}Nu.prototype.bytesPerElement=12,dn(Nu,"StructArrayLayout6i12");class Od extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L,w,A,R){const C=this.length;return this.resize(C+1),this.emplace(C,e,o,c,f,d,g,S,M,L,w,A,R)}emplace(e,o,c,f,d,g,S,M,L,w,A,R,C){const P=12*e;return this.int16[P+0]=o,this.int16[P+1]=c,this.int16[P+2]=f,this.int16[P+3]=d,this.uint16[P+4]=g,this.uint16[P+5]=S,this.uint16[P+6]=M,this.uint16[P+7]=L,this.int16[P+8]=w,this.int16[P+9]=A,this.int16[P+10]=R,this.int16[P+11]=C,e}}Od.prototype.bytesPerElement=24,dn(Od,"StructArrayLayout4i4ui4i24");class Fd extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g){const S=this.length;return this.resize(S+1),this.emplace(S,e,o,c,f,d,g)}emplace(e,o,c,f,d,g,S){const M=10*e,L=5*e;return this.int16[M+0]=o,this.int16[M+1]=c,this.int16[M+2]=f,this.float32[L+2]=d,this.float32[L+3]=g,this.float32[L+4]=S,e}}Fd.prototype.bytesPerElement=20,dn(Fd,"StructArrayLayout3i3f20");class da extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}da.prototype.bytesPerElement=4,dn(da,"StructArrayLayout1ul4");class Ao extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.uint16[f+0]=o,this.uint16[f+1]=c,e}}Ao.prototype.bytesPerElement=4,dn(Ao,"StructArrayLayout2ui4");class Yc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L,w,A,R,C){const P=this.length;return this.resize(P+1),this.emplace(P,e,o,c,f,d,g,S,M,L,w,A,R,C)}emplace(e,o,c,f,d,g,S,M,L,w,A,R,C,P){const D=20*e,V=10*e;return this.int16[D+0]=o,this.int16[D+1]=c,this.int16[D+2]=f,this.int16[D+3]=d,this.int16[D+4]=g,this.float32[V+3]=S,this.float32[V+4]=M,this.float32[V+5]=L,this.float32[V+6]=w,this.int16[D+14]=A,this.uint32[V+8]=R,this.uint16[D+18]=C,this.uint16[D+19]=P,e}}Yc.prototype.bytesPerElement=40,dn(Yc,"StructArrayLayout5i4f1i1ul2ui40");class ju extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S){const M=this.length;return this.resize(M+1),this.emplace(M,e,o,c,f,d,g,S)}emplace(e,o,c,f,d,g,S,M){const L=8*e;return this.int16[L+0]=o,this.int16[L+1]=c,this.int16[L+2]=f,this.int16[L+4]=d,this.int16[L+5]=g,this.int16[L+6]=S,this.int16[L+7]=M,e}}ju.prototype.bytesPerElement=16,dn(ju,"StructArrayLayout3i2i2i16");class Uu extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,c,f,d)}emplace(e,o,c,f,d,g){const S=4*e,M=8*e;return this.float32[S+0]=o,this.float32[S+1]=c,this.float32[S+2]=f,this.int16[M+6]=d,this.int16[M+7]=g,e}}Uu.prototype.bytesPerElement=16,dn(Uu,"StructArrayLayout2f1f2i16");class $h extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g){const S=this.length;return this.resize(S+1),this.emplace(S,e,o,c,f,d,g)}emplace(e,o,c,f,d,g,S){const M=20*e,L=5*e;return this.uint8[M+0]=o,this.uint8[M+1]=c,this.float32[L+1]=f,this.float32[L+2]=d,this.float32[L+3]=g,this.float32[L+4]=S,e}}$h.prototype.bytesPerElement=20,dn($h,"StructArrayLayout2ub4f20");class Po extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const d=3*e;return this.uint16[d+0]=o,this.uint16[d+1]=c,this.uint16[d+2]=f,e}}Po.prototype.bytesPerElement=6,dn(Po,"StructArrayLayout3ui6");class Vh extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q,K,Q,X,re){const de=this.length;return this.resize(de+1),this.emplace(de,e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q,K,Q,X,re)}emplace(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q,K,Q,X,re,de){const ye=30*e,Ce=15*e,Ee=60*e;return this.int16[ye+0]=o,this.int16[ye+1]=c,this.int16[ye+2]=f,this.float32[Ce+2]=d,this.float32[Ce+3]=g,this.uint16[ye+8]=S,this.uint16[ye+9]=M,this.uint32[Ce+5]=L,this.uint32[Ce+6]=w,this.uint32[Ce+7]=A,this.uint16[ye+16]=R,this.uint16[ye+17]=C,this.uint16[ye+18]=P,this.float32[Ce+10]=D,this.float32[Ce+11]=V,this.uint8[Ee+48]=q,this.uint8[Ee+49]=K,this.uint8[Ee+50]=Q,this.uint32[Ce+13]=X,this.int16[ye+28]=re,this.uint8[Ee+58]=de,e}}Vh.prototype.bytesPerElement=60,dn(Vh,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Bd extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q,K,Q,X,re,de,ye,Ce,Ee,Te,Be,Ae,Ue,He,Ge,Ke){const rt=this.length;return this.resize(rt+1),this.emplace(rt,e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q,K,Q,X,re,de,ye,Ce,Ee,Te,Be,Ae,Ue,He,Ge,Ke)}emplace(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q,K,Q,X,re,de,ye,Ce,Ee,Te,Be,Ae,Ue,He,Ge,Ke,rt){const dt=20*e,Qe=40*e,wt=80*e;return this.float32[dt+0]=o,this.float32[dt+1]=c,this.int16[Qe+4]=f,this.int16[Qe+5]=d,this.int16[Qe+6]=g,this.int16[Qe+7]=S,this.int16[Qe+8]=M,this.int16[Qe+9]=L,this.int16[Qe+10]=w,this.int16[Qe+11]=A,this.int16[Qe+12]=R,this.uint16[Qe+13]=C,this.uint16[Qe+14]=P,this.uint16[Qe+15]=D,this.uint16[Qe+16]=V,this.uint16[Qe+17]=q,this.uint16[Qe+18]=K,this.uint16[Qe+19]=Q,this.uint16[Qe+20]=X,this.uint16[Qe+21]=re,this.uint16[Qe+22]=de,this.uint16[Qe+23]=ye,this.uint16[Qe+24]=Ce,this.uint16[Qe+25]=Ee,this.uint16[Qe+26]=Te,this.uint16[Qe+27]=Be,this.uint32[dt+14]=Ae,this.float32[dt+15]=Ue,this.float32[dt+16]=He,this.float32[dt+17]=Ge,this.float32[dt+18]=Ke,this.uint8[wt+76]=rt,e}}Bd.prototype.bytesPerElement=80,dn(Bd,"StructArrayLayout2f9i15ui1ul4f1ub80");class Kc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}Kc.prototype.bytesPerElement=4,dn(Kc,"StructArrayLayout1f4");class ps extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,c,f,d)}emplace(e,o,c,f,d,g){const S=5*e;return this.float32[S+0]=o,this.float32[S+1]=c,this.float32[S+2]=f,this.float32[S+3]=d,this.float32[S+4]=g,e}}ps.prototype.bytesPerElement=20,dn(ps,"StructArrayLayout5f20");class Nd extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S){const M=this.length;return this.resize(M+1),this.emplace(M,e,o,c,f,d,g,S)}emplace(e,o,c,f,d,g,S,M){const L=7*e;return this.float32[L+0]=o,this.float32[L+1]=c,this.float32[L+2]=f,this.float32[L+3]=d,this.float32[L+4]=g,this.float32[L+5]=S,this.float32[L+6]=M,e}}Nd.prototype.bytesPerElement=28,dn(Nd,"StructArrayLayout7f28");class Gh extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L,w,A){const R=this.length;return this.resize(R+1),this.emplace(R,e,o,c,f,d,g,S,M,L,w,A)}emplace(e,o,c,f,d,g,S,M,L,w,A,R){const C=11*e;return this.float32[C+0]=o,this.float32[C+1]=c,this.float32[C+2]=f,this.float32[C+3]=d,this.float32[C+4]=g,this.float32[C+5]=S,this.float32[C+6]=M,this.float32[C+7]=L,this.float32[C+8]=w,this.float32[C+9]=A,this.float32[C+10]=R,e}}Gh.prototype.bytesPerElement=44,dn(Gh,"StructArrayLayout11f44");class Jc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,c,f,d,g,S,M,L)}emplace(e,o,c,f,d,g,S,M,L,w){const A=9*e;return this.float32[A+0]=o,this.float32[A+1]=c,this.float32[A+2]=f,this.float32[A+3]=d,this.float32[A+4]=g,this.float32[A+5]=S,this.float32[A+6]=M,this.float32[A+7]=L,this.float32[A+8]=w,e}}Jc.prototype.bytesPerElement=36,dn(Jc,"StructArrayLayout9f36");class hc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.float32[f+0]=o,this.float32[f+1]=c,e}}hc.prototype.bytesPerElement=8,dn(hc,"StructArrayLayout2f8");class pc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,e,o,c,f)}emplace(e,o,c,f,d){const g=6*e;return this.uint32[3*e+0]=o,this.uint16[g+2]=c,this.uint16[g+3]=f,this.uint16[g+4]=d,e}}pc.prototype.bytesPerElement=12,dn(pc,"StructArrayLayout1ul3ui12");class Qc extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}Qc.prototype.bytesPerElement=2,dn(Qc,"StructArrayLayout1ui2");class qh extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V){const q=this.length;return this.resize(q+1),this.emplace(q,e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V)}emplace(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q){const K=16*e;return this.float32[K+0]=o,this.float32[K+1]=c,this.float32[K+2]=f,this.float32[K+3]=d,this.float32[K+4]=g,this.float32[K+5]=S,this.float32[K+6]=M,this.float32[K+7]=L,this.float32[K+8]=w,this.float32[K+9]=A,this.float32[K+10]=R,this.float32[K+11]=C,this.float32[K+12]=P,this.float32[K+13]=D,this.float32[K+14]=V,this.float32[K+15]=q,e}}qh.prototype.bytesPerElement=64,dn(qh,"StructArrayLayout16f64");class eu extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,d,g,S){const M=this.length;return this.resize(M+1),this.emplace(M,e,o,c,f,d,g,S)}emplace(e,o,c,f,d,g,S,M){const L=10*e,w=5*e;return this.uint16[L+0]=o,this.uint16[L+1]=c,this.uint16[L+2]=f,this.uint16[L+3]=d,this.float32[w+2]=g,this.float32[w+3]=S,this.float32[w+4]=M,e}}eu.prototype.bytesPerElement=20,dn(eu,"StructArrayLayout4ui3f20");class Wh extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.int16[1*e+0]=o,e}}Wh.prototype.bytesPerElement=2,dn(Wh,"StructArrayLayout1i2");class jd extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint8[1*e+0]=o,e}}jd.prototype.bytesPerElement=1,dn(jd,"StructArrayLayout1ub1");class $u extends Xc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}$u.prototype.size=40;class qp extends Yc{get(e){return new $u(this,e)}}dn(qp,"CollisionBoxArray");class Hh extends Xc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Hh.prototype.size=60;class Wp extends Vh{get(e){return new Hh(this,e)}}dn(Wp,"PlacedSymbolArray");class Hp extends Xc{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Hp.prototype.size=80;class Zp extends Bd{get(e){return new Hp(this,e)}}dn(Zp,"SymbolInstanceArray");class Ud extends Kc{getoffsetX(e){return this.float32[1*e+0]}}dn(Ud,"GlyphOffsetArray");class Vu extends Go{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}dn(Vu,"SymbolLineVertexArray");class Cs extends Xc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Cs.prototype.size=12;class $d extends pc{get(e){return new Cs(this,e)}}dn($d,"FeatureIndexArray");class Xp extends Ao{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}dn(Xp,"FillExtrusionCentroidArray");class Yp extends Xc{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Yp.prototype.size=6;class Kp extends Li{get(e){return new Yp(this,e)}}dn(Kp,"FillExtrusionWallArray");const Zh=Dr([{name:"a_pos",components:2,type:"Int16"}],4),Jp=Dr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ui{constructor(e=[]){this.segments=e}_prepareSegment(e,o,c,f){let d=this.segments[this.segments.length-1];return e>Ui.MAX_VERTEX_ARRAY_LENGTH&&$n(`Max vertices per segment is ${Ui.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!d||d.vertexLength+e>Ui.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==f)&&(d={vertexOffset:o,primitiveOffset:c,vertexLength:0,primitiveLength:0},f!==void 0&&(d.sortKey=f),this.segments.push(d)),d}prepareSegment(e,o,c,f){return this._prepareSegment(e,o.length,c.length,f)}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,c,f){return new Ui([{vertexOffset:e,primitiveOffset:o,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function Xh(l,e){return 256*(l=Dt(Math.floor(l),0,255))+Dt(Math.floor(e),0,255)}Ui.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(Ui,"SegmentVector");const Ea=Dr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Qp=Dr([{name:"a_dash",components:4,type:"Uint16"}]);class Xa{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,o,c,f){this.ids.push(ef(e)),this.positions.push(o,c,f)}eachPosition(e,o){const c=ef(e);let f=0,d=this.ids.length-1;for(;f<d;){const g=f+d>>1;this.ids[g]>=c?d=g:f=g+1}for(;this.ids[f]===c;)o(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(e,o){const c=new Float64Array(e.ids),f=new Uint32Array(e.positions);return Vd(c,f,0,c.length-1),o&&(o.add(c.buffer),o.add(f.buffer)),{ids:c,positions:f}}static deserialize(e){const o=new Xa;let c;o.ids=e.ids,o.positions=e.positions;for(const f of o.ids)f!==c&&o.uniqueIds.push(f),c=f;return o.indexed=!0,o}}function ef(l){const e=+l;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Rc(String(l))}function Vd(l,e,o,c){for(;o<c;){const f=l[o+c>>1];let d=o-1,g=c+1;for(;;){do d++;while(l[d]<f);do g--;while(l[g]>f);if(d>=g)break;Gu(l,d,g),Gu(e,3*d,3*g),Gu(e,3*d+1,3*g+1),Gu(e,3*d+2,3*g+2)}g-o<c-g?(Vd(l,e,o,g),o=g+1):(Vd(l,e,g+1,c),c=g)}}function Gu(l,e,o){const c=l[e];l[e]=l[o],l[o]=c}dn(Xa,"FeaturePositionMap");class Ca{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,o),this.initialized=!0),!!this.location}set(e,o,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Ma extends Ca{constructor(e){super(e),this.current=0}set(e,o,c){this.fetchUniformLocation(e,o)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class wi extends Ca{constructor(e){super(e),this.current=0}set(e,o,c){this.fetchUniformLocation(e,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Xs extends Ca{constructor(e){super(e),this.current=[0,0]}set(e,o,c){this.fetchUniformLocation(e,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class tf extends Ca{constructor(e){super(e),this.current=[0,0,0]}set(e,o,c){this.fetchUniformLocation(e,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class qu extends Ca{constructor(e){super(e),this.current=[0,0,0,0]}set(e,o,c){this.fetchUniformLocation(e,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class nf extends Ca{constructor(e){super(e),this.current=kr.transparent.toRenderColor(null)}set(e,o,c){this.fetchUniformLocation(e,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const Yh=new Float32Array(16);class Wu extends Ca{constructor(e){super(e),this.current=Yh}set(e,o,c){if(this.fetchUniformLocation(e,o)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const cm=new Float32Array(9),Tg=new Float32Array(4);class rs extends Ca{constructor(e){super(e),this.current=Tg}set(e,o,c){if(this.fetchUniformLocation(e,o)){for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function Oo(l){return[Xh(255*l.r,255*l.g),Xh(255*l.b,255*l.a)]}class tu{constructor(e,o,c,f){this.value=e,this.uniformNames=o.map(d=>`u_${d}`),this.type=c,this.context=f}setUniform(e,o,c,f,d){const g=f.constantOr(this.value);o.set(e,d,g instanceof kr?g.toRenderColor(this.ignoreLut?null:this.context.lut):g)}getBinding(e,o){return this.type==="color"?new nf(e):new wi(e)}}class nu{constructor(e,o){this.uniformNames=o.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,o,c,f,d){const g=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;g&&o.set(e,d,g)}getBinding(e,o){return o==="u_pattern"||o==="u_dash"?new qu(e):new wi(e)}}class Ya{constructor(e,o,c,f){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(d=>({name:`a_${d}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,o,c,f,d,g,S){const M=this.paintVertexArray.length,L=this.expression.evaluate(new Jr(0,{brightness:g}),o,{},d,f,S);this.paintVertexArray.resize(e),this._setPaintValue(M,e,L,this.context)}updatePaintArray(e,o,c,f,d,g,S){const M=this.expression.evaluate({zoom:0,brightness:S},c,f,void 0,d);this._setPaintValue(e,o,M,this.context)}_setPaintValue(e,o,c,f){if(this.type==="color"){const d=Oo(c.toRenderColor(this.ignoreLut?null:f.lut));for(let g=e;g<o;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=e;d<o;d++)this.paintVertexArray.emplace(d,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ha{constructor(e,o,c,f,d,g){this.expression=e,this.uniformNames=o.map(S=>`u_${S}_t`),this.type=c,this.useIntegerZoom=f,this.context=d,this.maxValue=0,this.paintVertexAttributes=o.map(S=>({name:`a_${S}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,o,c,f,d,g,S){const M=this.expression.evaluate(new Jr(this.context.zoom,{brightness:g}),o,{},d,f,S),L=this.expression.evaluate(new Jr(this.context.zoom+1,{brightness:g}),o,{},d,f,S),w=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(w,e,M,L,this.context)}updatePaintArray(e,o,c,f,d,g,S){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:S},c,f,void 0,d),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:S},c,f,void 0,d);this._setPaintValue(e,o,M,L,this.context)}_setPaintValue(e,o,c,f,d){if(this.type==="color"){const g=Oo(c.toRenderColor(this.ignoreLut?null:d.lut)),S=Oo(c.toRenderColor(this.ignoreLut?null:d.lut));for(let M=e;M<o;M++)this.paintVertexArray.emplace(M,g[0],g[1],S[0],S[1])}else{for(let g=e;g<o;g++)this.paintVertexArray.emplace(g,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o,c,f,d){const g=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,S=Dt(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);o.set(e,d,S)}getBinding(e,o){return new wi(e)}}class Ml{constructor(e,o,c,f,d){this.expression=e,this.layerId=d,this.paintVertexAttributes=(c==="array"?Qp:Ea).members;for(let g=0;g<o.length;++g);this.paintVertexArray=new f}populatePaintArray(e,o,c,f){const d=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(d,e,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(e,o,c,f,d,g,S){this._setPaintValues(e,o,c.patterns&&c.patterns[this.layerId],g)}_setPaintValues(e,o,c,f){if(!f||!c)return;const d=f[c];if(!d)return;const{tl:g,br:S,pixelRatio:M}=d;for(let L=e;L<o;L++)this.paintVertexArray.emplace(L,g[0],g[1],S[0],S[1],M)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Il{constructor(e,o,c=()=>!0){this.binders={},this._buffers=[],this.context=o;const f=[];for(const d in e.paint._values){const g=e.paint.get(d),S=e.paint.get(`${d}-use-theme`);if(d.endsWith("-use-theme")||!c(d)||!(g instanceof ac&&Us(g.property.specification)))continue;const M=Gd(d,e.type),L=g.value,w=g.property.specification.type,A=!!g.property.useIntegerZoom,R=d==="line-dasharray"||d.endsWith("pattern"),C=d==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(L.kind!=="constant"||C)if(L.kind==="source"||C||R){const P=ru(d,w,"source");this.binders[d]=R?new Ml(L,M,w,P,e.id):new Ya(L,M,w,P),f.push(`/a_${d}`)}else{const P=ru(d,w,"composite");this.binders[d]=new ha(L,M,w,A,o,P),f.push(`/z_${d}`)}else this.binders[d]=R?new nu(L.value,M):new tu(L.value,M,w,o),f.push(`/u_${d}`);S&&(this.binders[d].ignoreLut=S.constantOr("default")==="none",this.binders[d].checkUseTheme=!0)}this.cacheKey=f.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof Ya||o instanceof ha?o.maxValue:0}populatePaintArrays(e,o,c,f,d,g,S){for(const M in this.binders){const L=this.binders[M];L.context=this.context,(L instanceof Ya||L instanceof ha||L instanceof Ml)&&L.populatePaintArray(e,o,c,f,d,g,S)}}setConstantPatternPositions(e){for(const o in this.binders){const c=this.binders[o];c instanceof nu&&c.setConstantPatternPositions(e)}}updatePaintArrays(e,o,c,f,d,g,S,M,L){let w=!1;const A=Object.keys(e),R=A.length!==0&&!M,C=R?A:o.uniqueIds;this.context.lut=d.lut;for(const P in this.binders){const D=this.binders[P];if(D.context=this.context,(D instanceof Ya||D instanceof ha||D instanceof Ml)&&(D.expression.isStateDependent===!0||D.expression.isLightConstant===!1)){const V=d.paint.get(P);D.expression=V.value;for(const q of C){const K=e[q.toString()];o.eachPosition(q,(Q,X,re)=>{const de=f.feature(Q);D.updatePaintArray(X,re,de,K,g,S,L)})}if(!R)for(const q of c.uniqueIds){const K=e[q.toString()];c.eachPosition(q,(Q,X,re)=>{const de=f.feature(Q);D.updatePaintArray(X,re,de,K,g,S,L)})}w=!0}}return w}defines(){const e=[];for(const o in this.binders){const c=this.binders[o];(c instanceof tu||c instanceof nu)&&e.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Ya||c instanceof ha||c instanceof Ml)for(let f=0;f<c.paintVertexAttributes.length;f++)e.push(c.paintVertexAttributes[f].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof tu||c instanceof nu||c instanceof ha)for(const f of c.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof tu||f instanceof nu||f instanceof ha)for(const d of f.uniformNames)o.push({name:d,property:c,binding:f.getBinding(e,d)})}return o}setUniforms(e,o,c,f,d){for(const{name:g,property:S,binding:M}of c){if(this.binders[S].checkUseTheme&&this.binders[S]instanceof tu){const L=f.get(`${S}-use-theme`);L.isConstant()&&(this.binders[S].ignoreLut=L.constantOr("default")==="none")}this.binders[S].setUniform(e,M,d,f.get(S),g)}}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const o=this.binders[e];(o instanceof Ya||o instanceof ha||o instanceof Ml)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const o in this.binders){const c=this.binders[o];(c instanceof Ya||c instanceof ha||c instanceof Ml)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof Ya||o instanceof ha||o instanceof Ml)&&o.destroy()}}}class Al{constructor(e,o,c=()=>!0){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new Il(f,o,c);this.needsUpload=!1,this._featureMap=new Xa,this._featureMapWithoutIds=new Xa,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,o,c,f,d,g,S,M){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(e,o,f,d,g,S,M);o.id!==void 0?this._featureMap.add(o.id,c,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,c,f,d,g,S){for(const M of c)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,o,M,f,d,g,S||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const rf={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Gd(l,e){return rf[l]||[l.replace(`${e}-`,"").replace(/-/g,"_")]}const um={"line-pattern":{source:dc,composite:dc},"fill-pattern":{source:dc,composite:dc},"fill-extrusion-pattern":{source:dc,composite:dc},"line-dasharray":{source:Io,composite:Io}},of={color:{source:hc,composite:ua},number:{source:Kc,composite:hc}};function ru(l,e,o){const c=um[l];return c&&c[o]||of[e][o]}dn(tu,"ConstantBinder"),dn(nu,"PatternConstantBinder"),dn(Ya,"SourceExpressionBinder"),dn(Ml,"PatternCompositeBinder"),dn(ha,"CompositeExpressionBinder"),dn(Il,"ProgramConfiguration",{omit:["_buffers"]}),dn(Al,"ProgramConfigurationSet");const qo=tn/Math.PI/2,Hu=5,qd=6,dm=16383,fc=64,Zu=[fc,32,16],Ys=-qo,fs=qo;function Ms(l,e,o,c=qo){return o=_n(o),[l*Math.sin(o)*c,-e*c,l*Math.cos(o)*c]}function mc(l,e,o){return Ms(Math.cos(_n(l)),Math.sin(_n(l)),e,o)}const iu=63710088e-1,Wd=2*Math.PI*iu;class Or{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Or(sn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,c=this.lat*o,f=e.lat*o,d=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((e.lng-this.lng)*o);return iu*Math.acos(Math.min(d,1))}toBounds(e=0){const o=360*e/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new Pl({lng:this.lng-c,lat:this.lat-o},{lng:this.lng+c,lat:this.lat+o})}toEcef(e){return mc(this.lat,this.lng,qo+e*qo/iu)}static convert(e){if(e instanceof Or)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Or(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Or(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Pl{constructor(e,o){if(e)if(o)this.setSouthWest(e).setNorthEast(o);else if(e.length===4){const c=e;this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]])}else{const c=e;this.setSouthWest(c[0]).setNorthEast(c[1])}}setNorthEast(e){return this._ne=e instanceof Or?new Or(e.lng,e.lat):Or.convert(e),this}setSouthWest(e){return this._sw=e instanceof Or?new Or(e.lng,e.lat):Or.convert(e),this}extend(e){const o=this._sw,c=this._ne;let f,d;if(e instanceof Or)f=e,d=e;else{if(!(e instanceof Pl))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Pl.convert(e)):this.extend(Or.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Or.convert(e)):this;if(f=e._sw,d=e._ne,!f||!d)return this}return o||c?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),c.lng=Math.max(d.lng,c.lng),c.lat=Math.max(d.lat,c.lat)):(this._sw=new Or(f.lng,f.lat),this._ne=new Or(d.lng,d.lat)),this}getCenter(){return new Or((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Or(this.getWest(),this.getNorth())}getSouthEast(){return new Or(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:c}=Or.convert(e);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){if(e)return e instanceof Pl?e:new Pl(e)}}const Hd=0,Wo=25.5;function Zd(l){return Wd*Math.cos(l*Math.PI/180)}function Ka(l){return(180+l)/360}function pa(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function vi(l,e){return l/Zd(e)}function Is(l){return 360*l-180}function Ln(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function ou(l,e){return l*Zd(Ln(e))}const Fo=85.051129;function hm(l){return Math.cos(_n(Dt(l,-85.051129,Fo)))}function h(l,e){const o=Dt(e,Hd,Wo),c=Math.pow(2,o);return hm(l)*Wd/(512*c)}function t(l){return 1/Math.cos(l*Math.PI/180)}function a(l,e=0){const o=Math.exp(Math.PI*(1-(l.y+e/tn)/(1<<l.z)*2));return 80150034*o/(o*o+1)/tn/(1<<l.z)}class p{constructor(e,o,c=0){this.x=+e,this.y=+o,this.z=+c}static fromLngLat(e,o=0){const c=Or.convert(e);return new p(Ka(c.lng),pa(c.lat),vi(o,c.lat))}toLngLat(){return new Or(Is(this.x),Ln(this.y))}toAltitude(){return ou(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Wd*t(Ln(this.y))}}function v(l,e,o,c,f,d,g,S,M){const L=(e+c)/2,w=(o+f)/2,A=new _t(L,w);S(A),function(R,C,P,D,V,q){const K=P-V,Q=D-q;return Math.abs((D-C)*K-(P-R)*Q)/Math.hypot(K,Q)}(A.x,A.y,d.x,d.y,g.x,g.y)>=M?(v(l,e,o,L,w,d,A,S,M),v(l,L,w,c,f,A,g,S,M)):l.push(g)}function b(l,e,o){let c=l[0],f=c.x,d=c.y;e(c);const g=[c];for(let S=1;S<l.length;S++){const M=l[S],{x:L,y:w}=M;e(M),v(g,f,d,L,w,c,M,e,o),f=L,d=w,c=M}return g}function E(l,e,o,c){if(c(e,o)){const f=e.add(o)._mult(.5);E(l,e,f,c),E(l,f,o,c)}else l.push(o)}function k(l,e){let o=l[0];const c=[o];for(let f=1;f<l.length;f++){const d=l[f];E(c,o,d,e),o=d}return c}const O=Math.pow(2,14)-1,N=-O-1;function $(l,e){const o=Math.round(l.x*e),c=Math.round(l.y*e);return l.x=Dt(o,N,O),l.y=Dt(c,N,O),(o<l.x||o>l.x+1||c<l.y||c>l.y+1)&&$n("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function W(l,e,o){const c=l.loadGeometry(),f=l.extent,d=tn/f;if(e&&o&&o.projection.isReprojectedInTileSpace){const g=1<<e.z,{scale:S,x:M,y:L,projection:w}=o,A=R=>{const C=Is((e.x+R.x/f)/g),P=Ln((e.y+R.y/f)/g),D=w.project(C,P);R.x=(D.x*S-M)*f,R.y=(D.y*S-L)*f};for(let R=0;R<c.length;R++)if(l.type!==1)c[R]=b(c[R],A,1);else{const C=[];for(const P of c[R])P.x<0||P.x>=f||P.y<0||P.y>=f||(A(P),C.push(P));c[R]=C}}for(const g of c)for(const S of g)$(S,d);return c}function Z(l,e){return{type:l.type,id:l.id,properties:l.properties,geometry:e?W(l):[]}}function Y(l,e,o,c,f){l.emplaceBack(2*e+(c+1)/2,2*o+(f+1)/2)}function he(l,e,o){l.emplaceBack(e.x,e.y,e.z,o[0]*16384,o[1]*16384,o[2]*16384)}class ue{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Go,this.indexArray=new Po,this.segments=new Ui,this.programConfigurations=new Al(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}updateFootprints(e,o){}populate(e,o,c,f){const d=this.layers[0],g=[];let S=null;d.type==="circle"&&(S=d.layout.get("circle-sort-key"));for(const{feature:L,id:w,index:A,sourceLayerIndex:R}of e){const C=this.layers[0]._featureFilter.needGeometry,P=Z(L,C);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),P,c))continue;const D=S?S.evaluate(P,{},c):void 0,V={id:w,properties:L.properties,type:L.type,sourceLayerIndex:R,index:A,geometry:C?P.geometry:W(L,c,f),patterns:{},sortKey:D};g.push(V)}S&&g.sort((L,w)=>L.sortKey-w.sortKey);let M=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new Nu,M=f.projection);for(const L of g){const{geometry:w,index:A,sourceLayerIndex:R}=L,C=e[A].feature;this.addFeature(L,w,A,o.availableImages,c,M,o.brightness),o.featureIndex.insert(C,w,A,R,this.index)}}update(e,o,c,f,d,g,S){this.programConfigurations.updatePaintArrays(e,o,d,c,f,g,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Jp.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,o,c,f,d,g,S){for(const M of o)for(const L of M){const w=L.x,A=L.y;if(w<0||w>=tn||A<0||A>=tn)continue;if(g){const P=g.projectTilePoint(w,A,d),D=g.upVector(d,w,A),V=this.globeExtVertexArray;he(V,P,D),he(V,P,D),he(V,P,D),he(V,P,D)}const R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),C=R.vertexLength;Y(this.layoutVertexArray,w,A,-1,-1),Y(this.layoutVertexArray,w,A,1,-1),Y(this.layoutVertexArray,w,A,1,1),Y(this.layoutVertexArray,w,A,-1,1),this.indexArray.emplaceBack(C,C+1,C+2),this.indexArray.emplaceBack(C,C+2,C+3),R.vertexLength+=4,R.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{},f,d,S)}}function me(l,e){for(let o=0;o<l.length;o++)if(Ne(e,l[o]))return!0;for(let o=0;o<e.length;o++)if(Ne(l,e[o]))return!0;return!!Me(l,e)}function ve(l,e,o){return!!Ne(l,e)||!!De(e,l,o)}function Se(l,e){if(l.length===1)return ze(e,l[0]);for(let o=0;o<e.length;o++){const c=e[o];for(let f=0;f<c.length;f++)if(Ne(l,c[f]))return!0}for(let o=0;o<l.length;o++)if(ze(e,l[o]))return!0;for(let o=0;o<e.length;o++)if(Me(l,e[o]))return!0;return!1}function Pe(l,e,o){if(l.length>1){if(Me(l,e))return!0;for(let c=0;c<e.length;c++)if(De(e[c],l,o))return!0}for(let c=0;c<l.length;c++)if(De(l[c],e,o))return!0;return!1}function Me(l,e){if(l.length===0||e.length===0)return!1;for(let o=0;o<l.length-1;o++){const c=l[o],f=l[o+1];for(let d=0;d<e.length-1;d++)if(Fe(c,f,e[d],e[d+1]))return!0}return!1}function Fe(l,e,o,c){return Zi(l,o,c)!==Zi(e,o,c)&&Zi(l,e,o)!==Zi(l,e,c)}function De(l,e,o){const c=o*o;if(e.length===1)return l.distSqr(e[0])<c;for(let f=1;f<e.length;f++)if(Oe(l,e[f-1],e[f])<c)return!0;return!1}function Oe(l,e,o){const c=e.distSqr(o);if(c===0)return l.distSqr(e);const f=((l.x-e.x)*(o.x-e.x)+(l.y-e.y)*(o.y-e.y))/c;return l.distSqr(f<0?e:f>1?o:o.sub(e)._mult(f)._add(e))}function ze(l,e){let o,c,f,d=!1;for(let g=0;g<l.length;g++){o=l[g];for(let S=0,M=o.length-1;S<o.length;M=S++)c=o[S],f=o[M],c.y>e.y!=f.y>e.y&&e.x<(f.x-c.x)*(e.y-c.y)/(f.y-c.y)+c.x&&(d=!d)}return d}function Ne(l,e){let o=!1;for(let c=0,f=l.length-1;c<l.length;f=c++){const d=l[c],g=l[f];d.y>e.y!=g.y>e.y&&e.x<(g.x-d.x)*(e.y-d.y)/(g.y-d.y)+d.x&&(o=!o)}return o}function je(l,e,o,c,f){for(const g of l)if(e<=g.x&&o<=g.y&&c>=g.x&&f>=g.y)return!0;const d=[new _t(e,o),new _t(e,f),new _t(c,f),new _t(c,o)];if(l.length>2){for(const g of d)if(Ne(l,g))return!0}for(let g=0;g<l.length-1;g++)if(pt(l[g],l[g+1],d))return!0;return!1}function pt(l,e,o){const c=o[0],f=o[2];if(l.x<c.x&&e.x<c.x||l.x>f.x&&e.x>f.x||l.y<c.y&&e.y<c.y||l.y>f.y&&e.y>f.y)return!1;const d=Zi(l,e,o[0]);return d!==Zi(l,e,o[1])||d!==Zi(l,e,o[2])||d!==Zi(l,e,o[3])}function ot(l,e,o,c,f,d){let g=e.y-l.y,S=l.x-e.x;if(d=d||0){const M=g*g+S*S;if(M===0)return!0;const L=Math.sqrt(M);g/=L,S/=L}return!((o.x-l.x)*g+(o.y-l.y)*S-d<0||(c.x-l.x)*g+(c.y-l.y)*S-d<0||(f.x-l.x)*g+(f.y-l.y)*S-d<0)}function Ve(l,e,o,c,f,d,g){return!(ot(l,e,c,f,d,g)||ot(e,o,c,f,d,g)||ot(o,l,c,f,d,g)||ot(c,f,l,e,o,g)||ot(f,d,l,e,o,g)||ot(d,c,l,e,o,g))}function Je(l,e,o){const c=e.paint.get(l).value;return c.kind==="constant"?c.value:o.programConfigurations.get(e.id).getMaxValue(l)}function It(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function kt(l,e,o,c,f){if(!e[0]&&!e[1])return l;const d=_t.convert(e)._mult(f);o==="viewport"&&d._rotate(-c);const g=[];for(let S=0;S<l.length;S++)g.push(l[S].sub(d));return g}function Ht(l,e,o,c){const f=_t.convert(l)._mult(c);return e==="viewport"&&f._rotate(-o),f}let ut,Lt;dn(ue,"CircleBucket",{omit:["layers"]});var xt,Gt={exports:{}},At=(xt||(xt=1,function(l,e){(function(o){function c(d,g,S){var M=f(256*d,256*(g=Math.pow(2,S)-g-1),S),L=f(256*(d+1),256*(g+1),S);return M[0]+","+M[1]+","+L[0]+","+L[1]}function f(d,g,S){var M=2*Math.PI*6378137/256/Math.pow(2,S);return[d*M-2*Math.PI*6378137/2,g*M-2*Math.PI*6378137/2]}o.getURL=function(d,g,S,M,L,w){return w=w||{},d+"?"+["bbox="+c(S,M,L),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+g].join("&")},o.getTileBBox=c,o.getMercCoords=f,Object.defineProperty(o,"__esModule",{value:!0})})(e)}(0,Gt.exports)),Gt.exports);class Ct{constructor(e,o,c){this.z=e,this.x=o,this.y=c,this.key=cn(0,e,e,o,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o){const c=At.getTileBBox(this.x,this.y,this.z),f=function(d,g,S){let M,L="";for(let w=d;w>0;w--)M=1<<w-1,L+=(g&M?1:0)+(S&M?2:0);return L}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class on{constructor(e,o){this.wrap=e,this.canonical=o,this.key=cn(e,o.z,o.z,o.x,o.y)}}class Zt{constructor(e,o,c,f,d){this.overscaledZ=e,this.wrap=o,this.canonical=new Ct(c,+f,+d),this.key=o===0&&e===c?this.canonical.key:cn(o,e,c,f,d)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const o=this.canonical.z-e;return e>this.canonical.z?new Zt(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zt(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o=!0){if(this.overscaledZ===e&&o)return this.key;if(e>this.canonical.z)return cn(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-e;return cn(this.wrap*+o,e,e,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new Zt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Zt(o,this.wrap,o,c,f),new Zt(o,this.wrap,o,c+1,f),new Zt(o,this.wrap,o,c,f+1),new Zt(o,this.wrap,o,c+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Zt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Zt(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new on(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function cn(l,e,o,c,f){const d=1<<Math.min(o,22);let g=d*(f%d)+c%d;return l&&o<22&&(g+=d*d*((l<0?-2*l-1:2*l)%(1<<2*(22-o)))),16*(32*g+o)+(e-o)}const mn=[l=>{let e=l.canonical.x-1,o=l.wrap;return e<0&&(e=(1<<l.canonical.z)-1,o--),new Zt(l.overscaledZ,o,l.canonical.z,e,l.canonical.y)},l=>{let e=l.canonical.x+1,o=l.wrap;return e===1<<l.canonical.z&&(e=0,o++),new Zt(l.overscaledZ,o,l.canonical.z,e,l.canonical.y)},l=>new Zt(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new Zt(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];dn(Ct,"CanonicalTileID"),dn(Zt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const jn=Dr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:In}=jn,Rn=Dr([{name:"a_pos_3",components:3,type:"Int16"}]);var Gn=Dr([{name:"a_pos",type:"Int16",components:2}]);class br{constructor(e,o){this.pos=e,this.dir=o}intersectsPlane(e,o,c){const f=Le.vec3.dot(o,this.dir);if(Math.abs(f)<1e-6)return!1;const d=((e[0]-this.pos[0])*o[0]+(e[1]-this.pos[1])*o[1]+(e[2]-this.pos[2])*o[2])/f;return c[0]=this.pos[0]+this.dir[0]*d,c[1]=this.pos[1]+this.dir[1]*d,c[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(e,o,c){if(Le.vec3.equals(this.pos,e)||o===0)return c[0]=c[1]=c[2]=0,!1;const[f,d,g]=this.dir,S=this.pos[0]-e[0],M=this.pos[1]-e[1],L=this.pos[2]-e[2],w=f*f+d*d+g*g,A=2*(S*f+M*d+L*g),R=A*A-4*w*(S*S+M*M+L*L-o*o);if(R<0){const C=Math.max(-A/2,0),P=S+f*C,D=M+d*C,V=L+g*C,q=Math.hypot(P,D,V);return c[0]=P*o/q,c[1]=D*o/q,c[2]=V*o/q,!1}{const C=(-A-Math.sqrt(R))/(2*w);if(C<0){const P=Math.hypot(S,M,L);return c[0]=S*o/P,c[1]=M*o/P,c[2]=L*o/P,!1}return c[0]=S+f*C,c[1]=M+d*C,c[2]=L+g*C,!0}}}class dr{constructor(e,o,c,f,d){this.TL=e,this.TR=o,this.BR=c,this.BL=f,this.horizon=d}static fromInvProjectionMatrix(e,o,c){const f=[-1,1,1],d=[1,1,1],g=[1,-1,1],S=[-1,-1,1],M=Le.vec3.transformMat4(f,f,e),L=Le.vec3.transformMat4(d,d,e),w=Le.vec3.transformMat4(g,g,e),A=Le.vec3.transformMat4(S,S,e);return new dr(M,L,w,A,o/c)}}function Yr(l,e,o){let c=1/0,f=-1/0;const d=[];for(const g of l){Le.vec3.sub(d,g,e);const S=Le.vec3.dot(d,o);c=Math.min(c,S),f=Math.max(f,S)}return[c,f]}function ci(l,e){let o=!0;for(let c=0;c<l.planes.length;c++){const f=l.planes[c];let d=0;for(let g=0;g<e.length;g++)d+=Le.vec3.dot(f,e[g])+f[3]>=0;if(d===0)return 0;d!==e.length&&(o=!1)}return o?2:1}function xr(l,e){for(const o of l.projections){const c=Yr(e,l.points[0],o.axis);if(o.projection[1]<c[0]||o.projection[0]>c[1])return 0}return 1}function Fr(l,e){let o=0;const c=[0,0,0,0];for(let f=0;f<l.length;f++)c[0]=l[f][0],c[1]=l[f][1],c[2]=l[f][2],c[3]=1,Le.vec4.dot(c,e)>=0&&o++;return o}class Wn{constructor(e,o){this.points=e||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=Cn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Le.vec3.sub([],this.points[2],this.points[3]),Le.vec3.sub([],this.points[0],this.points[3]),Le.vec3.sub([],this.points[4],this.points[0]),Le.vec3.sub([],this.points[5],this.points[1]),Le.vec3.sub([],this.points[6],this.points[2]),Le.vec3.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const f=[0,-c[2],c[1]],d=[c[2],0,-c[0]];this.projections.push({axis:f,projection:Yr(this.points,this.points[0],f)}),this.projections.push({axis:d,projection:Yr(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(e,o,c,f){const d=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{const w=Le.vec4.transformMat4([],L,e),A=1/w[3]/o*d;return Le.vec4.mul(w,w,[A,A,f?1/w[3]:A,A])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{const w=Le.vec3.sub([],g[L[0]],g[L[1]]),A=Le.vec3.sub([],g[L[2]],g[L[1]]),R=Le.vec3.normalize([],Le.vec3.cross([],w,A)),C=-Le.vec3.dot(R,g[L[1]]);return R.concat(C)}),M=[];for(let L=0;L<g.length;L++)M.push([g[L][0],g[L][1],g[L][2]]);return new Wn(M,S)}intersectsPrecise(e,o,c){for(let f=0;f<o.length;f++)if(!Fr(e,o[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!Fr(e,this.planes[f]))return 0;for(const f of c)for(const d of this.frustumEdges){const g=Le.vec3.cross([],f,d),S=Le.vec3.length(g);if(S===0)continue;Le.vec3.scale(g,g,1/S);const M=Yr(this.points,this.points[0],g),L=Yr(e,this.points[0],g);if(M[0]>L[1]||L[0]>M[1])return 0}return 1}containsPoint(e){for(const o of this.planes){const c=o[3];if(Le.vec3.dot([o[0],o[1],o[2]],e)+c<0)return!1}return!0}}class Cn{static fromPoints(e){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of e)Le.vec3.min(o,o,f),Le.vec3.max(c,c,f);return new Cn(o,c)}static fromTileIdAndHeight(e,o,c){const f=1<<e.canonical.z,d=e.canonical.x,g=e.canonical.y;return new Cn([d/f,g/f,o],[(d+1)/f,(g+1)/f,c])}static applyTransform(e,o){const c=e.getCorners();for(let f=0;f<c.length;++f)Le.vec3.transformMat4(c[f],c[f],o);return Cn.fromPoints(c)}static applyTransformFast(e,o){const c=[o[12],o[13],o[14]],f=[...c];for(let d=0;d<3;d++)for(let g=0;g<3;g++){const S=o[4*g+d],M=S*e.min[g],L=S*e.max[g];c[d]+=Math.min(M,L),f[d]+=Math.max(M,L)}return new Cn(c,f)}static projectAabbCorners(e,o){const c=e.getCorners();for(let f=0;f<c.length;++f)Le.vec3.transformMat4(c[f],c[f],o);return c}constructor(e,o){this.min=e,this.max=o,this.center=Le.vec3.scale([],Le.vec3.add([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],c=Le.vec3.clone(this.min),f=Le.vec3.clone(this.max);for(let d=0;d<o.length;d++)c[d]=o[d]?this.min[d]:this.center[d],f[d]=o[d]?this.center[d]:this.max[d];return f[2]=this.max[2],new Cn(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,o=this.max;return[[e[0],e[1],e[2]],[o[0],e[1],e[2]],[o[0],o[1],e[2]],[e[0],o[1],e[2]],[e[0],e[1],o[2]],[o[0],e[1],o[2]],[o[0],o[1],o[2]],[e[0],o[1],o[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?ci(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?ci(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,o){return o||this.intersects(e)?xr(e,this.getCorners()):0}intersectsPreciseFlat(e,o){return o||this.intersectsFlat(e)?xr(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let o=0;o<3;++o)if(this.min[o]>e.max[o]||e.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],e.min[o]),this.max[o]=Math.max(this.max[o],e.max[o])}encapsulatePoint(e){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],e[o]),this.max[o]=Math.max(this.max[o],e[o])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}function Br(l){return l*qo/iu}dn(Cn,"Aabb");const $r=[new Cn([Ys,Ys,Ys],[fs,fs,fs]),new Cn([Ys,Ys,Ys],[0,0,fs]),new Cn([0,Ys,Ys],[fs,0,fs]),new Cn([Ys,0,Ys],[0,fs,fs]),new Cn([0,0,Ys],[fs,fs,fs])];function yi(l,e,o,c=!0){const f=Le.vec3.scale([],l._camera.position,l.worldSize),d=[e,o,1,1];Le.vec4.transformMat4(d,d,l.pixelMatrixInverse),Le.vec4.scale(d,d,1/d[3]);const g=Le.vec3.sub([],d,f),S=Le.vec3.normalize([],g),M=l.globeMatrix,L=[M[12],M[13],M[14]],w=Le.vec3.sub([],L,f),A=Le.vec3.length(w),R=Le.vec3.normalize([],w),C=l.worldSize/(2*Math.PI),P=Le.vec3.dot(R,S),D=Math.asin(C/A);if(D<Math.acos(P)){if(!c)return null;const Be=[],Ae=[];Le.vec3.scale(Be,S,A/P),Le.vec3.normalize(Ae,Le.vec3.sub(Ae,Be,w)),Le.vec3.normalize(S,Le.vec3.add(S,w,Le.vec3.scale(S,Ae,Math.tan(D)*A)))}const V=[];new br(f,S).closestPointOnSphere(L,C,V);const q=Le.vec3.normalize([],vs(M,0)),K=Le.vec3.normalize([],vs(M,1)),Q=Le.vec3.normalize([],vs(M,2)),X=Le.vec3.dot(q,V),re=Le.vec3.dot(K,V),de=Le.vec3.dot(Q,V),ye=ir(Math.asin(-re/C));let Ce=ir(Math.atan2(X,de));Ce=l.center.lng+function(Be,Ae){const Ue=(Ae-Be+180)%360-180;return Ue<-180?Ue+360:Ue}(l.center.lng,Ce);const Ee=Ka(Ce),Te=Dt(pa(ye),0,1);return new p(Ee,Te)}class Ro{constructor(e,o,c){this.a=Le.vec3.sub([],e,c),this.b=Le.vec3.sub([],o,c),this.center=c;const f=Le.vec3.normalize([],this.a),d=Le.vec3.normalize([],this.b);this.angle=Math.acos(Le.vec3.dot(f,d))}}function Yi(l,e){if(l.angle===0)return null;let o;return o=l.a[e]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[e]/l.a[e]/Math.sin(l.angle)-1/Math.tan(l.angle)),o<0||o>1?null:function(c,f,d,g){const S=Math.sin(d);return c*(Math.sin((1-g)*d)/S)+f*(Math.sin(g*d)/S)}(l.a[e],l.b[e],l.angle,Dt(o,0,1))+l.center[e]}function qi(l){if(l.z<=1)return $r[l.z+2*l.y+l.x];const e=ii(Gr(l));return Cn.fromPoints(e)}function ro(l,e,o){return Le.vec3.scale(l,l,1-o),Le.vec3.scaleAndAdd(l,l,e,o)}function Ki(l,e,o){for(const c of l)Le.vec3.transformMat4(c,c,e),Le.vec3.scale(c,c,o)}function Ei(l,e,o,c){const f=e/l.worldSize,d=l.globeMatrix;if(o.z<=1){const Ee=qi(o).getCorners();return Ki(Ee,d,f),Cn.fromPoints(Ee)}const g=Gr(o,c),S=ii(g,qo+Br(l._tileCoverLift));Ki(S,d,f);const M=Number.MAX_VALUE,L=[-M,-M,-M],w=[M,M,M];if(g.contains(l.center)){for(const Be of S)Le.vec3.min(w,w,Be),Le.vec3.max(L,L,Be);L[2]=0;const Ee=l.point,Te=[Ee.x*f,Ee.y*f,0];return Le.vec3.min(w,w,Te),Le.vec3.max(L,L,Te),new Cn(w,L)}if(l._tileCoverLift>0){for(const Ee of S)Le.vec3.min(w,w,Ee),Le.vec3.max(L,L,Ee);return new Cn(w,L)}const A=[d[12]*f,d[13]*f,d[14]*f],R=g.getCenter(),C=Dt(l.center.lat,-85.051129,Fo),P=Dt(R.lat,-85.051129,Fo),D=Ka(l.center.lng),V=pa(C);let q=D-Ka(R.lng);const K=V-pa(P);q>.5?q-=1:q<-.5&&(q+=1);let Q=0;if(Math.abs(q)>Math.abs(K))Q=q>=0?1:3;else{Q=K>=0?0:2;const Ee=[d[4]*f,d[5]*f,d[6]*f],Te=-Math.sin(_n(K>=0?g.getSouth():g.getNorth()))*qo;Le.vec3.scaleAndAdd(A,A,Ee,Te)}const X=S[Q],re=S[(Q+1)%4],de=new Ro(X,re,A),ye=[Yi(de,0)||X[0],Yi(de,1)||X[1],Yi(de,2)||X[2]],Ce=is(l.zoom);if(Ce>0){const Ee=function({x:Be,y:Ae,z:Ue},He,Ge,Ke,rt){const dt=1/(1<<Ue);let Qe=Be*dt,wt=Qe+dt,qt=Ae*dt,Tt=qt+dt,Qt=0;const Kt=(Qe+wt)/2-Ke;return Kt>.5?Qt=-1:Kt<-.5&&(Qt=1),Qe=((Qe+Qt)*He-(Ke*=He))*Ge+Ke,wt=((wt+Qt)*He-Ke)*Ge+Ke,qt=(qt*He-(rt*=He))*Ge+rt,Tt=(Tt*He-rt)*Ge+rt,[[Qe,Tt,0],[wt,Tt,0],[wt,qt,0],[Qe,qt,0]]}(o,e,l._pixelsPerMercatorPixel,D,V);for(let Be=0;Be<S.length;Be++)ro(S[Be],Ee[Be],Ce);const Te=Le.vec3.add([],Ee[Q],Ee[(Q+1)%4]);Le.vec3.scale(Te,Te,.5),ro(ye,Te,Ce)}for(const Ee of S)Le.vec3.min(w,w,Ee),Le.vec3.max(L,L,Ee);return w[2]=Math.min(X[2],re[2]),Le.vec3.min(w,w,ye),Le.vec3.max(L,L,ye),new Cn(w,L)}function Gr({x:l,y:e,z:o},c=!1){const f=1/(1<<o),d=new Or(Is(l*f),e===(1<<o)-1&&c?-90:Ln((e+1)*f)),g=new Or(Is((l+1)*f),e===0&&c?90:Ln(e*f));return new Pl(d,g)}function ii(l,e=qo){const o=_n(l.getNorth()),c=_n(l.getSouth()),f=Math.cos(o),d=Math.cos(c),g=Math.sin(o),S=Math.sin(c),M=l.getWest(),L=l.getEast();return[Ms(d,S,M,e),Ms(d,S,L,e),Ms(f,g,L,e),Ms(f,g,M,e)]}function Mr(l,e,o,c){const f=1<<o.z,d=(l/tn+o.x)/f;return mc(Ln((e/tn+o.y)/f),Is(d),c)}function Ci({min:l,max:e}){return dm/Math.max(e[0]-l[0],e[1]-l[1],e[2]-l[2])}const io=new Float64Array(16);function ei(l){const e=Ci(l),o=Le.mat4.fromScaling(io,[e,e,e]);return Le.mat4.translate(o,o,Le.vec3.negate([],l.min))}function Ho(l){const e=Le.mat4.fromTranslation(io,l.min),o=1/Ci(l);return Le.mat4.scale(e,e,[o,o,o])}function As(l){const e=tn/(2*Math.PI);return l/(2*Math.PI)/e}function ms(l,e){return tn/(512*Math.pow(2,l))*Ci(qi(e))}function gs(l,e,o,c,f){const d=As(o),g=[l,e,-o/(2*Math.PI)],S=Le.mat4.identity(new Float64Array(16));return Le.mat4.translate(S,S,g),Le.mat4.scale(S,S,[d,d,d]),Le.mat4.rotateX(S,S,_n(-f)),Le.mat4.rotateY(S,S,_n(-c)),S}function is(l){return Ft(Hu,qd,l)}function os(l,e){const o=mc(e.lat,e.lng),c=function(d){const g=mc(d._center.lat,d._center.lng),S=Le.vec3.fromValues(0,1,0);let M=Le.vec3.cross([],S,g);const L=Le.mat4.fromRotation([],-d.angle,g);M=Le.vec3.transformMat4(M,M,L),Le.mat4.fromRotation(L,-d._pitch,M);const w=Le.vec3.normalize([],g);return Le.vec3.scale(w,w,Br(d.cameraToCenterDistance/d.pixelsPerMeter)),Le.vec3.transformMat4(w,w,L),Le.vec3.add([],g,w)}(l),f=Le.vec3.subtract([],c,o);return Le.vec3.angle(f,o)}function _s(l,e){return os(l,e)>Math.PI/2*1.01}const Mi=_n(85),Ja=Math.cos(Mi),gc=Math.sin(Mi),Xd=Le.mat4.create(),Kh=l=>{const e=[];return l.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function Yd(l,e,o,c,f,d,g,S,M){if(d&&l.queryGeometry.isAboveHorizon)return!1;d&&(M*=l.pixelToTileUnitsFactor);const L=l.tileID.canonical,w=o.projection.upVectorScale(L,o.center.lat,o.worldSize).metersToTile;for(const A of e)for(const R of A){const C=R.add(S),P=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt(C.x,C.y,!0):0,D=o.projection.projectTilePoint(C.x,C.y,L);if(P>0){const Q=o.projection.upVector(L,C.x,C.y);D.x+=Q[0]*w*P,D.y+=Q[1]*w*P,D.z+=Q[2]*w*P}const V=d?C:hy(D.x,D.y,D.z,c),q=d?l.tilespaceRays.map(Q=>Eg(Q,P)):l.queryGeometry.screenGeometry,K=Le.vec4.transformMat4([],[D.x,D.y,D.z,1],c);if(!g&&d?M*=K[3]/o.cameraToCenterDistance:g&&!d&&(M*=o.cameraToCenterDistance/K[3]),d){const Q=Ln((R.y/tn+L.y)/(1<<L.z));M/=o.projection.pixelsPerMeter(Q,1)/vi(1,Q)}if(ve(q,V,M))return!0}return!1}function hy(l,e,o,c){const f=Le.vec4.transformMat4([],[l,e,o,1],c);return new _t(f[0]/f[3],f[1]/f[3])}const py=Le.vec3.fromValues(0,0,0),Qa=Le.vec3.fromValues(0,0,1);function Eg(l,e){const o=Le.vec3.create();return py[2]=e,l.intersectsPlane(py,Qa,o),new _t(o[0],o[1])}class fy extends ue{}let su,sf,Xu,af;function pm(l,{width:e,height:o},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*o*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(e*o*c);return l.width=e,l.height=o,l.data=f,l}function fm(l,e,o){const{width:c,height:f}=e;c===l.width&&f===l.height||(Cg(l,e,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,c),height:Math.min(l.height,f)},o,null),l.width=c,l.height=f,l.data=e.data)}function Cg(l,e,o,c,f,d,g,S){if(f.width===0||f.height===0)return e;if(f.width>l.width||f.height>l.height||o.x>l.width-f.width||o.y>l.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||c.x>e.width-f.width||c.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const M=l.data,L=e.data,w=d===4&&S;for(let A=0;A<f.height;A++){const R=((o.y+A)*l.width+o.x)*d,C=((c.y+A)*e.width+c.x)*d;if(w)for(let P=0;P<f.width;P++){const D=R+P*d+3,V=C+P*d;L[V+0]=255,L[V+1]=255,L[V+2]=255,L[V+3]=M[D]}else if(g)for(let P=0;P<f.width;P++){const D=R+P*d,V=C+P*d,q=M[D+3],K=new kr(M[D+0]/255*q,M[D+1]/255*q,M[D+2]/255*q,q).toRenderColor(g).toArray();L[V+0]=K[0],L[V+1]=K[1],L[V+2]=K[2],L[V+3]=K[3]}else for(let P=0;P<f.width*d;P++)L[C+P]=M[R+P]}return e}dn(fy,"HeatmapBucket",{omit:["layers"]});class _c{constructor(e,o){pm(this,e,1,o)}resize(e){fm(this,new _c(e),1)}clone(){return new _c({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,c,f,d){Cg(e,o,c,f,d,1,null)}}class ss{constructor(e,o){pm(this,e,4,o)}resize(e){fm(this,new ss(e),4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,c,f,d,g,S){Cg(e,o,c,f,d,4,g,S)}}class Mg{constructor(e,o){this.width=e.width,this.height=e.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function Jh(l){const e={},o=l.resolution||256,c=l.clips?l.clips.length:1,f=l.image||new ss({width:o,height:c}),d=(g,S,M)=>{e[l.evaluationKey]=M;const L=l.expression.evaluate(e);L&&(f.data[g+S+0]=Math.floor(255*L.r/L.a),f.data[g+S+1]=Math.floor(255*L.g/L.a),f.data[g+S+2]=Math.floor(255*L.b/L.a),f.data[g+S+3]=Math.floor(255*L.a))};if(l.clips)for(let g=0,S=0;g<c;++g,S+=4*o)for(let M=0,L=0;M<o;M++,L+=4){const w=M/(o-1),{start:A,end:R}=l.clips[g];d(S,L,A*(1-w)+R*w)}else for(let g=0,S=0;g<o;g++,S+=4)d(0,S,g/(o-1));return f}dn(_c,"AlphaImage"),dn(ss,"RGBAImage");const mm=Dr([{name:"a_pos",components:2,type:"Int16"}],4),{members:gm}=mm;function Qh(l,e,o=2){const c=e&&e.length,f=c?e[0]*o:l.length;let d=_m(l,0,f,o,!0);const g=[];if(!d||d.next===d.prev)return g;let S,M,L;if(c&&(d=function(w,A,R,C){const P=[];for(let D=0,V=A.length;D<V;D++){const q=_m(w,A[D]*C,D<V-1?A[D+1]*C:w.length,C,!1);q===q.next&&(q.steiner=!0),P.push(Nx(q))}P.sort(Fx);for(let D=0;D<P.length;D++)R=xm(P[D],R);return R}(l,e,d,o)),l.length>80*o){S=1/0,M=1/0;let w=-1/0,A=-1/0;for(let R=o;R<f;R+=o){const C=l[R],P=l[R+1];C<S&&(S=C),P<M&&(M=P),C>w&&(w=C),P>A&&(A=P)}L=Math.max(w-S,A-M),L=L!==0?32767/L:0}return Kd(d,g,o,S,M,L,0),g}function _m(l,e,o,c,f){let d;if(f===function(g,S,M,L){let w=0;for(let A=S,R=M-L;A<M;A+=L)w+=(g[R]-g[A])*(g[A+1]+g[R+1]),R=A;return w}(l,e,o,c)>0)for(let g=e;g<o;g+=c)d=vt(g/c|0,l[g],l[g+1],d);else for(let g=o-c;g>=e;g-=c)d=vt(g/c|0,l[g],l[g+1],d);return d&&z(d,d.next)&&(Vt(d),d=d.next),d}function Yu(l,e){if(!l)return l;e||(e=l);let o,c=l;do if(o=!1,c.steiner||!z(c,c.next)&&x(c.prev,c,c.next)!==0)c=c.next;else{if(Vt(c),c=e=c.prev,c===c.next)break;o=!0}while(o||c!==e);return e}function Kd(l,e,o,c,f,d,g){if(!l)return;!g&&d&&function(M,L,w,A){let R=M;do R.z===0&&(R.z=Jd(R.x,R.y,L,w,A)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==M);R.prevZ.nextZ=null,R.prevZ=null,function(C){let P,D=1;do{let V,q=C;C=null;let K=null;for(P=0;q;){P++;let Q=q,X=0;for(let de=0;de<D&&(X++,Q=Q.nextZ,Q);de++);let re=D;for(;X>0||re>0&&Q;)X!==0&&(re===0||!Q||q.z<=Q.z)?(V=q,q=q.nextZ,X--):(V=Q,Q=Q.nextZ,re--),K?K.nextZ=V:C=V,V.prevZ=K,K=V;q=Q}K.nextZ=null,D*=2}while(P>1)}(R)}(l,c,f,d);let S=l;for(;l.prev!==l.next;){const M=l.prev,L=l.next;if(d?Ig(l,c,f,d):ym(l))e.push(M.i,l.i,L.i),Vt(l),l=L.next,S=L.next;else if((l=L)===S){g?g===1?Kd(l=vm(Yu(l),e),e,o,c,f,d,2):g===2&&my(l,e,o,c,f,d):Kd(Yu(l),e,o,c,f,d,1);break}}}function ym(l){const e=l.prev,o=l,c=l.next;if(x(e,o,c)>=0)return!1;const f=e.x,d=o.x,g=c.x,S=e.y,M=o.y,L=c.y,w=f<d?f<g?f:g:d<g?d:g,A=S<M?S<L?S:L:M<L?M:L,R=f>d?f>g?f:g:d>g?d:g,C=S>M?S>L?S:L:M>L?M:L;let P=c.next;for(;P!==e;){if(P.x>=w&&P.x<=R&&P.y>=A&&P.y<=C&&au(f,S,d,M,g,L,P.x,P.y)&&x(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function Ig(l,e,o,c){const f=l.prev,d=l,g=l.next;if(x(f,d,g)>=0)return!1;const S=f.x,M=d.x,L=g.x,w=f.y,A=d.y,R=g.y,C=S<M?S<L?S:L:M<L?M:L,P=w<A?w<R?w:R:A<R?A:R,D=S>M?S>L?S:L:M>L?M:L,V=w>A?w>R?w:R:A>R?A:R,q=Jd(C,P,e,o,c),K=Jd(D,V,e,o,c);let Q=l.prevZ,X=l.nextZ;for(;Q&&Q.z>=q&&X&&X.z<=K;){if(Q.x>=C&&Q.x<=D&&Q.y>=P&&Q.y<=V&&Q!==f&&Q!==g&&au(S,w,M,A,L,R,Q.x,Q.y)&&x(Q.prev,Q,Q.next)>=0||(Q=Q.prevZ,X.x>=C&&X.x<=D&&X.y>=P&&X.y<=V&&X!==f&&X!==g&&au(S,w,M,A,L,R,X.x,X.y)&&x(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;Q&&Q.z>=q;){if(Q.x>=C&&Q.x<=D&&Q.y>=P&&Q.y<=V&&Q!==f&&Q!==g&&au(S,w,M,A,L,R,Q.x,Q.y)&&x(Q.prev,Q,Q.next)>=0)return!1;Q=Q.prevZ}for(;X&&X.z<=K;){if(X.x>=C&&X.x<=D&&X.y>=P&&X.y<=V&&X!==f&&X!==g&&au(S,w,M,A,L,R,X.x,X.y)&&x(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function vm(l,e){let o=l;do{const c=o.prev,f=o.next.next;!z(c,f)&&U(c,o,o.next,f)&&Ie(c,f)&&Ie(f,c)&&(e.push(c.i,o.i,f.i),Vt(o),Vt(o.next),o=l=f),o=o.next}while(o!==l);return Yu(o)}function my(l,e,o,c,f,d){let g=l;do{let S=g.next.next;for(;S!==g.prev;){if(g.i!==S.i&&_(g,S)){let M=lt(g,S);return g=Yu(g,g.next),M=Yu(M,M.next),Kd(g,e,o,c,f,d,0),void Kd(M,e,o,c,f,d,0)}S=S.next}g=g.next}while(g!==l)}function Fx(l,e){return l.x-e.x}function xm(l,e){const o=function(f,d){let g=d;const S=f.x,M=f.y;let L,w=-1/0;do{if(M<=g.y&&M>=g.next.y&&g.next.y!==g.y){const D=g.x+(M-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(D<=S&&D>w&&(w=D,L=g.x<g.next.x?g:g.next,D===S))return L}g=g.next}while(g!==d);if(!L)return null;const A=L,R=L.x,C=L.y;let P=1/0;g=L;do{if(S>=g.x&&g.x>=R&&S!==g.x&&au(M<C?S:w,M,R,C,M<C?w:S,M,g.x,g.y)){const D=Math.abs(M-g.y)/(S-g.x);Ie(g,f)&&(D<P||D===P&&(g.x>L.x||g.x===L.x&&Bx(L,g)))&&(L=g,P=D)}g=g.next}while(g!==A);return L}(l,e);if(!o)return e;const c=lt(o,l);return Yu(c,c.next),Yu(o,o.next)}function Bx(l,e){return x(l.prev,l,e.prev)<0&&x(e.next,l,l.next)<0}function Jd(l,e,o,c,f){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*f|0)|l<<8))|l<<4))|l<<2))|l<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-c)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Nx(l){let e=l,o=l;do(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next;while(e!==l);return o}function au(l,e,o,c,f,d,g,S){return(f-g)*(e-S)>=(l-g)*(d-S)&&(l-g)*(c-S)>=(o-g)*(e-S)&&(o-g)*(d-S)>=(f-g)*(c-S)}function _(l,e){return l.next.i!==e.i&&l.prev.i!==e.i&&!function(o,c){let f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==c.i&&f.next.i!==c.i&&U(f,f.next,o,c))return!0;f=f.next}while(f!==o);return!1}(l,e)&&(Ie(l,e)&&Ie(e,l)&&function(o,c){let f=o,d=!1;const g=(o.x+c.x)/2,S=(o.y+c.y)/2;do f.y>S!=f.next.y>S&&f.next.y!==f.y&&g<(f.next.x-f.x)*(S-f.y)/(f.next.y-f.y)+f.x&&(d=!d),f=f.next;while(f!==o);return d}(l,e)&&(x(l.prev,l,e.prev)||x(l,e.prev,e))||z(l,e)&&x(l.prev,l,l.next)>0&&x(e.prev,e,e.next)>0)}function x(l,e,o){return(e.y-l.y)*(o.x-e.x)-(e.x-l.x)*(o.y-e.y)}function z(l,e){return l.x===e.x&&l.y===e.y}function U(l,e,o,c){const f=le(x(l,e,o)),d=le(x(l,e,c)),g=le(x(o,c,l)),S=le(x(o,c,e));return f!==d&&g!==S||!(f!==0||!ee(l,o,e))||!(d!==0||!ee(l,c,e))||!(g!==0||!ee(o,l,c))||!(S!==0||!ee(o,e,c))}function ee(l,e,o){return e.x<=Math.max(l.x,o.x)&&e.x>=Math.min(l.x,o.x)&&e.y<=Math.max(l.y,o.y)&&e.y>=Math.min(l.y,o.y)}function le(l){return l>0?1:l<0?-1:0}function Ie(l,e){return x(l.prev,l,l.next)<0?x(l,e,l.next)>=0&&x(l,l.prev,e)>=0:x(l,e,l.prev)<0||x(l,l.next,e)<0}function lt(l,e){const o=yn(l.i,l.x,l.y),c=yn(e.i,e.x,e.y),f=l.next,d=e.prev;return l.next=e,e.prev=l,o.next=f,f.prev=o,c.next=o,o.prev=c,d.next=c,c.prev=d,c}function vt(l,e,o,c){const f=yn(l,e,o);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Vt(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function yn(l,e,o){return{i:l,x:e,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function wn(l,e){const o=l.length;if(o<=1)return[l];const c=[];let f,d;for(let g=0;g<o;g++){const S=ra(l[g]);S!==0&&(l[g].area=Math.abs(S),d===void 0&&(d=S<0),d===S<0?(f&&c.push(f),f=[l[g]]):f.push(l[g]))}if(f&&c.push(f),e>1)for(let g=0;g<c.length;g++)c[g].length<=e||(Zf(c[g],e,1,c[g].length-1,vn),c[g]=c[g].slice(0,e));return c}function vn(l,e){return e.area-l.area}function Zn(l,e){if(!l)return null;const o=typeof l=="string"?l:l.getPrimary().id;e[o]||(e[o]=[]);const c=lo.from(l).getPrimary();return e[o].push(c),c.serialize()}function nr(l,e,o){const c=o.patternDependencies;let f=!1;for(const d of e){const g=d.paint.get(`${l}-pattern`);g.isConstant()||(f=!0),Zn(g.constantOr(null),c)&&(f=!0)}return f}function or(l,e,o,c,f){const d=f.patternDependencies;for(const g of e){const S=g.paint.get(`${l}-pattern`).value;if(S.kind!=="constant"){let M=S.evaluate({zoom:c},o,{},f.availableImages);M=M&&M.name?M.name:M;const L=Zn(M,d);L&&(o.patterns[g.id]=L)}}return o}class co{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Go,this.indexArray=new Po,this.indexArray2=new Ao,this.programConfigurations=new Al(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new Ui,this.segments2=new Ui,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=e.projection}updateFootprints(e,o){}populate(e,o,c,f){this.hasPattern=nr("fill",this.layers,o);const d=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:S,id:M,index:L,sourceLayerIndex:w}of e){const A=this.layers[0]._featureFilter.needGeometry,R=Z(S,A);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),R,c))continue;const C=d?d.evaluate(R,{},c,o.availableImages):void 0,P={id:M,properties:S.properties,type:S.type,sourceLayerIndex:w,index:L,geometry:A?R.geometry:W(S,c,f),patterns:{},sortKey:C};g.push(P)}d&&g.sort((S,M)=>S.sortKey-M.sortKey);for(const S of g){const{geometry:M,index:L,sourceLayerIndex:w}=S;if(this.hasPattern){const A=or("fill",this.layers,S,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(S,M,L,c,{},o.availableImages,o.brightness);o.featureIndex.insert(e[L].feature,M,L,w,this.index)}}update(e,o,c,f,d,g,S){this.programConfigurations.updatePaintArrays(e,o,d,c,f,g,S)}addFeatures(e,o,c,f,d,g){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,o,c,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,c,f,d,g=[],S){for(const M of wn(o,500)){let L=0;for(const D of M)L+=D.length;const w=this.segments.prepareSegment(L,this.layoutVertexArray,this.indexArray),A=w.vertexLength,R=[],C=[];for(const D of M){if(D.length===0)continue;D!==M[0]&&C.push(R.length/2);const V=this.segments2.prepareSegment(D.length,this.layoutVertexArray,this.indexArray2),q=V.vertexLength;this.layoutVertexArray.emplaceBack(D[0].x,D[0].y),this.indexArray2.emplaceBack(q+D.length-1,q),R.push(D[0].x),R.push(D[0].y);for(let K=1;K<D.length;K++)this.layoutVertexArray.emplaceBack(D[K].x,D[K].y),this.indexArray2.emplaceBack(q+K-1,q+K),R.push(D[K].x),R.push(D[K].y);V.vertexLength+=D.length,V.primitiveLength+=D.length}const P=Qh(R,C);for(let D=0;D<P.length;D+=3)this.indexArray.emplaceBack(A+P[D],A+P[D+1],A+P[D+2]);w.vertexLength+=L,w.primitiveLength+=P.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,d,g,f,S)}}let Ot,St,jt,An;dn(co,"FillBucket",{omit:["layers","patternFeatures"]});class fr{constructor(e,o,c,f){if(this.triangleCount=o.length/3,this.min=new _t(0,0),this.max=new _t(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0)return;const[d,g]=[e[0].clone(),e[0].clone()];for(let A=1;A<e.length;++A){const R=e[A];d.x=Math.min(d.x,R.x),d.y=Math.min(d.y,R.y),g.x=Math.max(g.x,R.x),g.y=Math.max(g.y,R.y)}if(f){const A=Math.ceil(Math.max(g.x-d.x,g.y-d.y)/f);c=Math.max(c,A)}if(c===0)return;this.min=d,this.max=g;const S=this.max.sub(this.min);S.x=Math.max(S.x,1),S.y=Math.max(S.y,1);const M=Math.max(S.x,S.y)/c;this.cellsX=Math.max(1,Math.ceil(S.x/M)),this.cellsY=Math.max(1,Math.ceil(S.y/M)),this.xScale=1/M,this.yScale=1/M;const L=[];for(let A=0;A<this.triangleCount;A++){const R=e[o[3*A+0]].sub(this.min),C=e[o[3*A+1]].sub(this.min),P=e[o[3*A+2]].sub(this.min),D=mr(Math.floor(Math.min(R.x,C.x,P.x)),this.xScale,this.cellsX),V=mr(Math.floor(Math.max(R.x,C.x,P.x)),this.xScale,this.cellsX),q=mr(Math.floor(Math.min(R.y,C.y,P.y)),this.yScale,this.cellsY),K=mr(Math.floor(Math.max(R.y,C.y,P.y)),this.yScale,this.cellsY),Q=new _t(0,0),X=new _t(0,0),re=new _t(0,0),de=new _t(0,0);for(let ye=q;ye<=K;++ye){Q.y=X.y=ye*M,re.y=de.y=(ye+1)*M;for(let Ce=D;Ce<=V;++Ce)Q.x=re.x=Ce*M,X.x=de.x=(Ce+1)*M,(Ve(R,C,P,Q,X,de)||Ve(R,C,P,Q,de,re))&&L.push({cellIdx:ye*this.cellsX+Ce,triIdx:A})}}if(L.length===0)return;L.sort((A,R)=>A.cellIdx-R.cellIdx||A.triIdx-R.triIdx);let w=0;for(;w<L.length;){const A=L[w].cellIdx,R={start:this.payload.length,len:0};for(;w<L.length&&L[w].cellIdx===A;)++R.len,this.payload.push(L[w++].triIdx);this.cells[A]=R}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,o){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;const c=mr(e.x-this.min.x,this.xScale,this.cellsX),f=mr(e.y-this.min.y,this.yScale,this.cellsY),d=this.cells[f*this.cellsX+c];if(d){this._lazyInitLookup();for(let g=0;g<d.len;g++){const S=this.payload[d.start+g],M=Math.floor(S/8),L=1<<S%8;if(!(this.lookup[M]&L)&&(this.lookup[M]|=L,o.push(S),o.length===this.triangleCount))return}}}query(e,o,c){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>o.x||e.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const f=mr(e.x-this.min.x,this.xScale,this.cellsX),d=mr(o.x-this.min.x,this.xScale,this.cellsX),g=mr(e.y-this.min.y,this.yScale,this.cellsY),S=mr(o.y-this.min.y,this.yScale,this.cellsY);for(let M=g;M<=S;M++)for(let L=f;L<=d;L++){const w=this.cells[M*this.cellsX+L];if(w)for(let A=0;A<w.len;A++){const R=this.payload[w.start+A],C=Math.floor(R/8),P=1<<R%8;if(!(this.lookup[C]&P)&&(this.lookup[C]|=P,c.push(R),c.length===this.triangleCount))return}}}}function mr(l,e,o){return Math.max(0,Math.min(o-1,Math.floor(l*e)))}dn(fr,"TriangleGridIndex");class Ir{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[]}updateFootprints(e,o){for(const c of this.footprints)o.push({footprint:c,id:e})}populate(e,o,c,f){const d=[];for(const{feature:g,id:S,index:M,sourceLayerIndex:L}of e){const w=this.layers[0]._featureFilter.needGeometry,A=Z(g,w);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),A,c))continue;const R={id:S,properties:g.properties,type:g.type,sourceLayerIndex:L,index:M,geometry:w?A.geometry:W(g,c,f),patterns:{}};d.push(R)}for(const g of d){const{geometry:S,index:M,sourceLayerIndex:L}=g;this.addFeature(g,S,M,c,{},o.availableImages,o.brightness),o.featureIndex.insert(e[M].feature,S,M,L,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(e){}update(e,o,c,f,d,g,S){}destroy(){}addFeature(e,o,c,f,d,g=[],S){for(const M of wn(o,2)){const L=[],w=[],A=[],R=new _t(1/0,1/0),C=new _t(-1/0,-1/0);for(const V of M)if(V.length!==0){V!==M[0]&&A.push(w.length/2);for(let q=0;q<V.length;q++)w.push(V[q].x),w.push(V[q].y),L.push(V[q]),R.x=Math.min(R.x,V[q].x),R.y=Math.min(R.y,V[q].y),C.x=Math.max(C.x,V[q].x),C.y=Math.max(C.y,V[q].y)}const P=Qh(w,A),D=new fr(L,P,8,256);this.footprints.push({vertices:L,indices:P,grid:D,min:R,max:C})}}}dn(Ir,"ClipBucket",{omit:["layers"]});const jr=Dr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),as=Dr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Si=Dr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ku=Dr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),jx=Dr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),HR=Dr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ZR}=jr;var Ux,hS,$x,pS,Vx,fS,mS,gy={};function gS(){if(hS)return Ux;hS=1;var l=zn();function e(f,d,g,S,M){this.properties={},this.extent=g,this.type=0,this._pbf=f,this._geometry=-1,this._keys=S,this._values=M,f.readFields(o,this,d)}function o(f,d,g){f==1?d.id=g.readVarint():f==2?function(S,M){for(var L=S.readVarint()+S.pos;S.pos<L;){var w=M._keys[S.readVarint()],A=M._values[S.readVarint()];M.properties[w]=A}}(g,d):f==3?d.type=g.readVarint():f==4&&(d._geometry=g.pos)}function c(f){for(var d,g,S=0,M=0,L=f.length,w=L-1;M<L;w=M++)S+=((g=f[w]).x-(d=f[M]).x)*(d.y+g.y);return S}return Ux=e,e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var d,g=f.readVarint()+f.pos,S=1,M=0,L=0,w=0,A=[];f.pos<g;){if(M<=0){var R=f.readVarint();S=7&R,M=R>>3}if(M--,S===1||S===2)L+=f.readSVarint(),w+=f.readSVarint(),S===1&&(d&&A.push(d),d=[]),d.push(new l(L,w));else{if(S!==7)throw new Error("unknown command "+S);d&&d.push(d[0].clone())}}return d&&A.push(d),A},e.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var d=f.readVarint()+f.pos,g=1,S=0,M=0,L=0,w=1/0,A=-1/0,R=1/0,C=-1/0;f.pos<d;){if(S<=0){var P=f.readVarint();g=7&P,S=P>>3}if(S--,g===1||g===2)(M+=f.readSVarint())<w&&(w=M),M>A&&(A=M),(L+=f.readSVarint())<R&&(R=L),L>C&&(C=L);else if(g!==7)throw new Error("unknown command "+g)}return[w,R,A,C]},e.prototype.toGeoJSON=function(f,d,g){var S,M,L=this.extent*Math.pow(2,g),w=this.extent*f,A=this.extent*d,R=this.loadGeometry(),C=e.types[this.type];function P(q){for(var K=0;K<q.length;K++){var Q=q[K];q[K]=[360*(Q.x+w)/L-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+A)/L)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(S=0;S<R.length;S++)D[S]=R[S][0];P(R=D);break;case 2:for(S=0;S<R.length;S++)P(R[S]);break;case 3:for(R=function(q){var K=q.length;if(K<=1)return[q];for(var Q,X,re=[],de=0;de<K;de++){var ye=c(q[de]);ye!==0&&(X===void 0&&(X=ye<0),X===ye<0?(Q&&re.push(Q),Q=[q[de]]):Q.push(q[de]))}return Q&&re.push(Q),re}(R),S=0;S<R.length;S++)for(M=0;M<R[S].length;M++)P(R[S][M])}R.length===1?R=R[0]:C="Multi"+C;var V={type:"Feature",geometry:{type:C,coordinates:R},properties:this.properties};return"id"in this&&(V.id=this.id),V},Ux}function _S(){if(pS)return $x;pS=1;var l=gS();function e(c,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(o,this,f),this.length=this._features.length}function o(c,f,d){c===15?f.version=d.readVarint():c===1?f.name=d.readString():c===5?f.extent=d.readVarint():c===2?f._features.push(d.pos):c===3?f._keys.push(d.readString()):c===4&&f._values.push(function(g){for(var S=null,M=g.readVarint()+g.pos;g.pos<M;){var L=g.readVarint()>>3;S=L===1?g.readString():L===2?g.readFloat():L===3?g.readDouble():L===4?g.readVarint64():L===5?g.readVarint():L===6?g.readSVarint():L===7?g.readBoolean():null}return S}(d))}return $x=e,e.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var f=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,f,this.extent,this._keys,this._values)},$x}function yS(){return mS||(mS=1,gy.VectorTile=function(){if(fS)return Vx;fS=1;var l=_S();function e(o,c,f){if(o===3){var d=new l(f,f.readVarint()+f.pos);d.length&&(c[d.name]=d)}}return Vx=function(o,c){this.layers=o.readFields(e,{},c)},Vx}(),gy.VectorTileFeature=gS(),gy.VectorTileLayer=_S()),gy}var bm=yS();class lf extends _t{constructor(e,o,c){super(e,o),this.z=c}}class vS extends lf{constructor(e,o,c,f){super(e,o,c),this.w=f}}function _y(l,e,o,c){const f=[],d=c===0?(g,S,M,L,w,A)=>{g.push(new _t(A,M+(A-S)/(L-S)*(w-M)))}:(g,S,M,L,w,A)=>{g.push(new _t(S+(A-M)/(w-M)*(L-S),A))};for(const g of l){const S=[];for(const M of g){if(M.length<=2)continue;const L=[];for(let R=0;R<M.length-1;R++){const C=M[R].x,P=M[R].y,D=M[R+1].x,V=M[R+1].y,q=c===0?C:P,K=c===0?D:V;q<e?K>e&&d(L,C,P,D,V,e):q>o?K<o&&d(L,C,P,D,V,o):L.push(M[R]),K<e&&q>=e&&d(L,C,P,D,V,e),K>o&&q<=o&&d(L,C,P,D,V,o)}let w=M[M.length-1];const A=c===0?w.x:w.y;A>=e&&A<=o&&L.push(w),L.length&&(w=L[L.length-1],L[0].x===w.x&&L[0].y===w.y||L.push(L[0]),S.push(L))}S.length&&f.push(S)}return f}function xS(l,e,o,c){const f=o==="x"?"y":"x",d=(c-l[o])/(e[o]-l[o]);l[f]=l[f]+(e[f]-l[f])*d,l[o]=c,l.hasOwnProperty("z")&&(l.z=Fn(l.z,e.z,d)),l.hasOwnProperty("w")&&(l.w=Fn(l.w,e.w,d))}function bS(l,e,o,c){const f=o,d=c;for(const g of["x","y"]){let S=l,M=e;S[g]>=M[g]&&(S=e,M=l),S[g]<f&&M[g]>f&&xS(S,M,g,f),S[g]<d&&M[g]>d&&xS(M,S,g,d)}}const yy=Number.MAX_SAFE_INTEGER;function wS(l,e,o,c){return l.order<e||l.order===yy||!(l.clipMask&o)||function(f,d){return d.length!==0&&d.find(g=>g===f)===void 0}(c,l.clipScope)}function vy(l,e){return l.x-e.x||l.y-e.y}function SS(l,e){return vy(l.min,e.min)===0&&vy(l.max,e.max)===0}function Gx(l,e){return!(l.min.x>e.max.x||l.max.x<e.min.x||l.min.y>e.max.y||l.max.y<e.min.y)}function qx(l,e){if(l.length!==e.length)return!1;for(let o=0;o<l.length;o++)if(l[o].sourceId!==e[o].sourceId||!SS(l[o],e[o])||l[o].order!==e[o].order||l[o].clipMask!==e[o].clipMask||!er(l[o].clipScope,e[o].clipScope))return!1;return!0}function TS(l,e,o){const c=1/tn,f=1/(1<<o.canonical.z),d=(e.x*c+o.canonical.x)*f+o.wrap,g=(e.y*c+o.canonical.y)*f;return{min:new _t((l.x*c+o.canonical.x)*f+o.wrap,(l.y*c+o.canonical.y)*f),max:new _t(d,g)}}function XR(l,e,o){const c=1<<o.canonical.z,f=((e.x-o.wrap)*c-o.canonical.x)*tn,d=(e.y*c-o.canonical.y)*tn;return{min:new _t(((l.x-o.wrap)*c-o.canonical.x)*tn,(l.y*c-o.canonical.y)*tn),max:new _t(f,d)}}function ES(l,e,o,c,f,d,g){const S=l.indices,M=l.vertices,L=[];for(let w=c;w<c+f;w+=3){const A=e[o[w+0]+d],R=e[o[w+1]+d],C=e[o[w+2]+d],P=Math.min(A.x,R.x,C.x),D=Math.max(A.x,R.x,C.x),V=Math.min(A.y,R.y,C.y),q=Math.max(A.y,R.y,C.y);L.length=0,l.grid.query(new _t(P,V),new _t(D,q),L);for(let K=0;K<L.length;K++){const Q=L[K];if(Ve(M[S[3*Q+0]],M[S[3*Q+1]],M[S[3*Q+2]],A,R,C,g))return!0}}return!1}function CS(l,e,o,c){if(!l||!o)return!1;let f=l.vertices;if(!e.canonical.equals(c.canonical)||e.wrap!==c.wrap){if(o.vertices.length<l.vertices.length)return CS(o,c,l,e);const d=e.canonical,g=c.canonical,S=Math.pow(2,g.z-d.z);f=l.vertices.map(M=>new _t((M.x+d.x*tn)*S-g.x*tn,(M.y+d.y*tn)*S-g.y*tn))}return ES(o,f,l.indices,0,l.indices.length,0,0)}function MS(l,e,o,c){const f=Math.pow(2,c.z-o.z);return new _t((l+o.x*tn)*f-c.x*tn,(e+o.y*tn)*f-c.y*tn)}function IS(l,e){const o=[];e.grid.queryPoint(l,o);const c=e.indices,f=e.vertices;for(let d=0;d<o.length;d++){const g=o[d];if(Ne([f[c[3*g+0]],f[c[3*g+1]],f[c[3*g+2]]],l))return!0}return!1}const Wx=[new _t(0,0),new _t(tn,0),new _t(tn,tn),new _t(0,tn)];function AS(l,e){const o=[];let c=[];if(!e||l.length<2)return[l];if(l.length===2)return pt(l[0],l[1],Wx)?[l]:[];for(let f=0;f<l.length+2;f++){const d=l[f%l.length],g=l[(f+1)%l.length],S=pt(f===0?l[l.length-1]:l[(f-1)%l.length],d,Wx),M=pt(d,g,Wx),L=S||M;L&&c.push(d),L&&M||c.length>0&&(c.length>1&&o.push(c),c=[])}return c.length>1&&o.push(c),o}const Hx=bm.VectorTileFeature.types,YR=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],KR=["fill-extrusion-flood-light-ground-radius"],JR=Math.pow(2,13),QR=Math.pow(2,15)-1,PS=new _t(0,1),ep=2147483648;function Ag(l,e,o,c,f,d,g,S){l.emplaceBack((e<<1)+g,(o<<1)+d,(Math.floor(c*JR)<<1)+f,Math.round(S))}function Pg(l,e,o){l.emplaceBack(e.x*tn,e.y*tn,o?1:0)}function xy(l,e,o,c,f,d){l.emplaceBack(e.x,e.y,(o.x<<1)+c,(o.y<<1)+f,d)}function Rg(l,e,o){l.emplaceBack(e.x,e.y,e.z,o[0]*16384,o[1]*16384,o[2]*16384)}class RS{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class kS{constructor(){this.centroidXY=new _t(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new _t(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new _t(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new _t(this.max.x-this.min.x,this.max.y-this.min.y)}}class LS{constructor(){this.acc=new _t(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,o){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=o.x,e.min.y=e.max.y=o.y)}appendEdge(e,o,c){this.accCount++,this.acc._add(o);let f=!!this.borders;o.x<e.min.x?(e.min.x=o.x,f=!0):o.x>e.max.x&&(e.max.x=o.x,f=!0),o.y<e.min.y?(e.min.y=o.y,f=!0):o.y>e.max.y&&(e.max.y=o.y,f=!0),((o.x===0||o.x===tn)&&o.x===c.x)!=((o.y===0||o.y===tn)&&o.y===c.y)&&this.processBorderOverlap(o,c),f&&this.checkBorderIntersection(o,c)}checkBorderIntersection(e,o){o.x<0!=e.x<0&&this.addBorderIntersection(0,Fn(o.y,e.y,(0-o.x)/(e.x-o.x))),o.x>tn!=e.x>tn&&this.addBorderIntersection(1,Fn(o.y,e.y,(tn-o.x)/(e.x-o.x))),o.y<0!=e.y<0&&this.addBorderIntersection(2,Fn(o.x,e.x,(0-o.y)/(e.y-o.y))),o.y>tn!=e.y>tn&&this.addBorderIntersection(3,Fn(o.x,e.x,(tn-o.y)/(e.y-o.y)))}addBorderIntersection(e,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[e];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(e,o){if(e.x===o.x){if(e.y===o.y)return;const c=e.x===0?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,e.y)}else{const c=e.y===0?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,e.x)}}centroid(){return this.accCount===0?new _t(0,0):new _t(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,o)=>e+ +(o[0]!==Number.MAX_VALUE),0):0}}function zS(l,e){const o=l.add(e)._unit(),c=Dt(l.x*o.x+l.y*o.y,-1,1);var f,d,g;return g=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(g)))/4*QR*((f=l).x*(d=e).y-f.y*d.x<0?-1:1)}const ek=[l=>l.x<0,l=>l.x>tn,l=>l.y<0,l=>l.y>tn];function tk(l,e,o,c){const f=[4];if(c===0)return f;o._mult(c);const d=l.sub(o),g=e.sub(o),S=[l,e,d,g];for(let M=0;M<4;M++)for(const L of S)if(ek[M](L)){f.push(M);break}return f}class DS{constructor(e){this.vertexArray=new vo,this.indexArray=new Po,this.programConfigurations=new Al(e.layers,{zoom:e.zoom,lut:e.lut},o=>KR.includes(o)),this._segments=new Ui,this.hiddenByLandmarkVertexArray=new jd,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ui}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,o,c,f=!1){const d=e.length;if(d>2){let g=Math.max(0,this._segments.get().length-1);const S=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let M;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const L=e[0],w=e[1];M=zS(L.sub(e[d-1])._perp()._unit(),w.sub(L)._perp()._unit())}for(let L=0;L<d;L++){const w=L===d-1?0:L+1,A=e[L],R=e[w],C=e[w===d-1?0:w+1],P=R.sub(A)._perp()._unit(),D=zS(P,C.sub(R)._perp()._unit()),V=M,q=D;if(Zx(A,R,o)||f&&BS(A,o)&&BS(R,o)){M=D;continue}const K=S.vertexLength;xy(this.vertexArray,A,R,1,1,V),xy(this.vertexArray,A,R,1,0,V),xy(this.vertexArray,A,R,0,1,q),xy(this.vertexArray,A,R,0,0,q),S.vertexLength+=4;const Q=tk(A,R,P,c);for(const X of Q)this._segmentToGroundQuads[g].push({id:K,region:X}),this._segmentToRegionTriCounts[g][X]+=2,S.primitiveLength+=2;M=D}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),o=e.length;for(let c=0;c<o;c++)this._segmentToGroundQuads[c].sort((f,d)=>f.region-d.region);for(let c=0;c<o;c++){const f=this._segmentToGroundQuads[c],d=e[c],g=this._segmentToRegionTriCounts[c];g.reduce((M,L)=>M+L,0);let S=0;for(let M=0;M<=4;M++){const L=g[M];if(L!==0){let w=this.regionSegments[M];w||(w=this.regionSegments[M]=new Ui);const A={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+S,vertexLength:d.vertexLength,primitiveLength:L};w.get().push(A)}S+=L}for(let M=0;M<f.length;M++){const L=f[M].id;this.indexArray.emplaceBack(L,L+1,L+3),this.indexArray.emplaceBack(L,L+3,L+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,o,c,f,d,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,o,c,f,d,g)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,as.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,o,c,f,d,g,S){this.hasData()&&this.programConfigurations.updatePaintArrays(e,o,c,f,d,g,S)}updateHiddenByLandmark(e){if(!this.hasData())return;const o=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const c=e.flags&ep?1:0;for(let f=e.groundVertexArrayOffset;f<o;++f)this.hiddenByLandmarkVertexArray.emplace(f,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,jx.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const o=this.regionSegments[e];o&&o.destroy()}}}}class by{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Po,this.footprintVertices=new Go,this.footprintSegments=[],this.layoutVertexArray=new ji,this.centroidVertexArray=new Xp,this.wallVertexArray=new Kp,this.indexArray=new Po,this.programConfigurations=new Al(e.layers,{zoom:e.zoom,lut:e.lut},o=>YR.includes(o)),this.segments=new Ui,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new DS(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(e,o){}populate(e,o,c,f){this.features=[],this.hasPattern=nr("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=a(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:d,id:g,index:S,sourceLayerIndex:M}of e){const L=this.layers[0]._featureFilter.needGeometry,w=Z(d,L);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),w,c))continue;const A={id:g,sourceLayerIndex:M,index:S,geometry:L?w.geometry:W(d,c,f),properties:d.properties,type:d.type,patterns:{}},R=this.layoutVertexArray.length,C=Hx[A.type]==="Polygon";if(this.hasPattern)this.features.push(or("fill-extrusion",this.layers,A,this.zoom,o));else if(this.wallMode)for(const P of A.geometry)for(const D of AS(P,C))this.addFeature(A,[D],S,c,{},o.availableImages,f,o.brightness);else this.addFeature(A,A.geometry,S,c,{},o.availableImages,f,o.brightness);o.featureIndex.insert(d,A.geometry,S,M,this.index,R)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,o,c,f,d,g){for(const S of this.features){const M=Hx[S.type]==="Polygon",{geometry:L}=S;if(this.wallMode)for(const w of L)for(const A of AS(w,M))this.addFeature(S,[A],S.index,o,c,f,d,g);else this.addFeature(S,L,S.index,o,c,f,d,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,o,c,f,d,g,S){this.programConfigurations.updatePaintArrays(e,o,d,c,f,g,S),this.groundEffect.update(e,o,d,c,f,g,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ZR),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.wallVertexBuffer=e.createVertexBuffer(this.wallVertexArray,Ku.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,HR.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Si.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,c,f,d,g,S,M){const L=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,w=[new _t(0,0),new _t(tn,tn)],A=S.projection,R=A.name==="globe",C=this.wallMode||Hx[e.type]==="Polygon",P=new LS;P.centroidDataIndex=this.centroidData.length;const D=new kS,V=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},f)<=0,q=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},f);let K;if(D.height=q,D.vertexArrayOffset=this.layoutVertexArray.length,D.groundVertexArrayOffset=this.groundEffect.vertexArray.length,R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Nu),this.wallMode){if(R)return void $n("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;K=function(Te){const Be=Te[0].x===Te[Te.length-1].x&&Te[0].y===Te[Te.length-1].y;(function(ln){let Pt=0;const En=ln.length;for(let en=0;en<En;en++)Pt+=(ln[(en+1)%En].x-ln[en].x)*(ln[(en+1)%En].y+ln[en].y);return Pt>=0})(Te)||(Te=Te.reverse());const Ue={geometry:[],joinNormals:[],indices:[]},He=[],Ge=[],Ke=[];let rt=Te.length;for(;rt>=2&&Te[rt-1].equals(Te[rt-2]);)rt--;if(rt<(Be?3:2))return Ue;let dt,Qe,wt,qt,Tt,Qt=0;for(;Qt<rt-1&&Te[Qt].equals(Te[Qt+1]);)Qt++;Be&&(dt=Te[rt-2],Tt=Te[Qt].sub(dt)._unit()._perp());for(let ln=Qt;ln<rt;ln++){if(wt=ln===rt-1?Be?Te[Qt+1]:void 0:Te[ln+1],wt&&Te[ln].equals(wt))continue;Tt&&(qt=Tt),dt&&(Qe=dt),dt=Te[ln],Tt=wt?wt.sub(dt)._unit()._perp():qt,qt=qt||Tt;let Pt=qt.add(Tt);Pt.x===0&&Pt.y===0||Pt._unit();const En=Pt.x*Tt.x+Pt.y*Tt.y,en=En!==0?1/En:1/0,bn=qt.x*Tt.y-qt.y*Tt.x>0;let Un="miter";const hr=2;Un==="miter"&&en>hr&&(Un="bevel"),Un==="bevel"&&(en>100&&(Un="flipbevel"),en<hr&&(Un="miter"));const _r=(Sr,yr,Rr,di)=>{const ti=new _t(Sr.x,Sr.y),Qn=new _t(Sr.x,Sr.y);ti.x+=yr.x*di,ti.y+=yr.y*di,Qn.x-=yr.x*Math.max(Rr,1),Qn.y-=yr.y*Math.max(Rr,1),Ke.push(yr),He.push(ti),Ge.push(Qn)};if(Un==="miter")Pt._mult(en),_r(dt,Pt,0,0);else if(Un==="flipbevel")Pt=Tt.mult(-1),_r(dt,Pt,0,0),_r(dt,Pt.mult(-1),0,0);else{const Sr=-Math.sqrt(en*en-1),yr=bn?Sr:0,Rr=bn?0:Sr;Qe&&_r(dt,qt,yr,Rr),wt&&_r(dt,Tt,yr,Rr)}}Ue.geometry=[...He,...Ge.reverse(),He[0]],Ue.joinNormals=[...Ke,...Ke.reverse(),Ke[Ke.length-1]];const Kt=Ue.geometry.length-1;for(let ln=0;ln<Kt/2;ln++)if(ln+1<Kt/2){let Pt=ln,En=ln+1,en=Kt-1-ln,bn=Kt-2-ln;Pt=Pt===0?Kt-1:Pt-1,En=En===0?Kt-1:En-1,en=en===0?Kt-1:en-1,bn=bn===0?Kt-1:bn-1,Ue.indices.push(en),Ue.indices.push(En),Ue.indices.push(Pt),Ue.indices.push(en),Ue.indices.push(bn),Ue.indices.push(En)}return Ue}(o[0]),o=[K.geometry]}const Q=(Te,Be)=>Te<(Be.length-1)/2||Te===Be.length-1,X=this.wallMode?[o]:wn(o,500);for(let Te=X.length-1;Te>=0;Te--){const Be=X[Te];(Be.length===0||(re=Be[0]).every(Ae=>Ae.x<=0)||re.every(Ae=>Ae.x>=tn)||re.every(Ae=>Ae.y<=0)||re.every(Ae=>Ae.y>=tn))&&X.splice(Te,1)}var re;let de;if(R)de=$S(X,w,f);else{de=[];for(const Te of X)de.push({polygon:Te,bounds:w})}const ye=C?this.edgeRadius:0,Ce=ye>0&&this.zoom<17,Ee=(Te,Be)=>{if(Te.length===0)return!1;const Ae=Te[Te.length-1];return Be.x===Ae.x&&Be.y===Ae.y};for(const{polygon:Te,bounds:Be}of de){let Ae=0,Ue=0;for(const rt of Te)C&&!rt[0].equals(rt[rt.length-1])&&rt.push(rt[0]),Ue+=C?rt.length-1:rt.length;const He=this.segments.prepareSegment((C?5:4)*Ue,this.layoutVertexArray,this.indexArray);D.footprintSegIdx<0&&(D.footprintSegIdx=this.footprintSegments.length),D.polygonSegIdx<0&&(D.polygonSegIdx=this.polygonSegments.length);const Ge={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ke=new RS;if(Ke.vertexOffset=this.footprintVertices.length,Ke.indexOffset=3*this.footprintIndices.length,Ke.ringIndices=[],C){const rt=[],dt=[];Ae=He.vertexLength;for(let wt=0;wt<Te.length;wt++){const qt=Te[wt];qt.length&&wt!==0&&dt.push(rt.length/2);const Tt=[];let Qt,Kt;Qt=qt[1].sub(qt[0])._perp()._unit(),Ke.ringIndices.push(qt.length-1);for(let ln=1;ln<qt.length;ln++){const Pt=qt[ln],En=qt[ln===qt.length-1?1:ln+1],en=Pt.clone();if(ye){Kt=En.sub(Pt)._perp()._unit();const bn=Qt.add(Kt)._unit(),Un=ye*Math.min(4,1/(Qt.x*bn.x+Qt.y*bn.y));en.x+=Un*bn.x,en.y+=Un*bn.y,en.x=Math.round(en.x),en.y=Math.round(en.y),Qt=Kt}if(!V||ye!==0&&!Ce||Ee(Tt,en)||Tt.push(en),Ag(this.layoutVertexArray,en.x,en.y,0,0,1,1,0),this.wallMode){const bn=Q(ln,qt);Pg(this.wallVertexArray,K.joinNormals[ln],!bn)}He.vertexLength++,this.footprintVertices.emplaceBack(Pt.x,Pt.y),rt.push(Pt.x,Pt.y),R&&Rg(this.layoutVertexExtArray,A.projectTilePoint(en.x,en.y,f),A.upVector(f,en.x,en.y))}V&&(ye===0||Ce)&&(Tt.length!==0&&Ee(Tt,Tt[0])&&Tt.pop(),this.groundEffect.addData(Tt,Be,L))}const Qe=this.wallMode?K.indices:Qh(rt,dt);for(let wt=0;wt<Qe.length;wt+=3)this.footprintIndices.emplaceBack(Ke.vertexOffset+Qe[wt+0],Ke.vertexOffset+Qe[wt+1],Ke.vertexOffset+Qe[wt+2]),this.indexArray.emplaceBack(Ae+Qe[wt],Ae+Qe[wt+2],Ae+Qe[wt+1]),He.primitiveLength++;Ke.indexCount+=Qe.length,Ke.vertexCount+=this.footprintVertices.length-Ke.vertexOffset}for(let rt=0;rt<Te.length;rt++){const dt=Te[rt];P.startRing(D,dt[0]);let Qe=dt.length>4&&NS(dt[dt.length-2],dt[0],dt[1]),wt=ye?nk(dt[dt.length-2],dt[0],dt[1],ye):0;const qt=[];let Tt,Qt,Kt;Qt=dt[1].sub(dt[0])._perp()._unit();let ln=!0;for(let Pt=1,En=0;Pt<dt.length;Pt++){let en=dt[Pt-1],bn=dt[Pt];const Un=dt[Pt===dt.length-1?1:Pt+1];if(P.appendEdge(D,bn,en),Zx(bn,en,Be)){ye&&(Qt=Un.sub(bn)._perp()._unit(),ln=!ln);continue}const hr=bn.sub(en)._perp(),_r=hr.x/(Math.abs(hr.x)+Math.abs(hr.y)),Sr=hr.y>0?1:0,yr=en.dist(bn);if(En+yr>32768&&(En=0),ye){Kt=Un.sub(bn)._perp()._unit();let Qn=FS(en,bn,Un,OS(Qt,Kt),ye);isNaN(Qn)&&(Qn=0);const ni=bn.sub(en)._unit();en=en.add(ni.mult(wt))._round(),bn=bn.add(ni.mult(-Qn))._round(),wt=Qn,Qt=Kt,V&&this.zoom>=17&&(Ee(qt,en)||qt.push(en),Ee(qt,bn)||qt.push(bn))}const Rr=He.vertexLength,di=dt.length>4&&NS(en,bn,Un);let ti=jS(En,Qe,ln);if(Ag(this.layoutVertexArray,en.x,en.y,_r,Sr,0,0,ti),Ag(this.layoutVertexArray,en.x,en.y,_r,Sr,0,1,ti),this.wallMode){const Qn=Q(Pt-1,dt),ni=K.joinNormals[Pt-1];Pg(this.wallVertexArray,ni,Qn),Pg(this.wallVertexArray,ni,Qn)}if(En+=yr,ti=jS(En,di,!ln),Qe=di,Ag(this.layoutVertexArray,bn.x,bn.y,_r,Sr,0,0,ti),Ag(this.layoutVertexArray,bn.x,bn.y,_r,Sr,0,1,ti),this.wallMode){const Qn=Q(Pt,dt),ni=K.joinNormals[Pt];Pg(this.wallVertexArray,ni,Qn),Pg(this.wallVertexArray,ni,Qn)}if(He.vertexLength+=4,this.indexArray.emplaceBack(Rr+0,Rr+1,Rr+2),this.indexArray.emplaceBack(Rr+1,Rr+3,Rr+2),He.primitiveLength+=2,ye){const Qn=Ae+(Pt===1?dt.length-2:Pt-2),ni=Pt===1?Ae:Qn+1;if(this.indexArray.emplaceBack(Rr+1,Qn,Rr+3),this.indexArray.emplaceBack(Qn,ni,Rr+3),He.primitiveLength+=2,Tt===void 0&&(Tt=Rr),!Zx(Un,dt[Pt],Be)){const Kr=Pt===dt.length-1?Tt:He.vertexLength;this.indexArray.emplaceBack(Rr+2,Rr+3,Kr),this.indexArray.emplaceBack(Rr+3,Kr+1,Kr),this.indexArray.emplaceBack(Rr+3,ni,Kr+1),He.primitiveLength+=3}ln=!ln}if(R){const Qn=this.layoutVertexExtArray,ni=A.projectTilePoint(en.x,en.y,f),Kr=A.projectTilePoint(bn.x,bn.y,f),hi=A.upVector(f,en.x,en.y),ho=A.upVector(f,bn.x,bn.y);Rg(Qn,ni,hi),Rg(Qn,ni,hi),Rg(Qn,Kr,ho),Rg(Qn,Kr,ho)}}C&&(Ae+=dt.length-1),V&&ye&&this.zoom>=17&&(qt.length!==0&&Ee(qt,qt[0])&&qt.pop(),this.groundEffect.addData(qt,Be,L,ye>0))}this.footprintSegments.push(Ke),Ge.triangleCount=this.indexArray.length-Ge.triangleArrayOffset,this.polygonSegments.push(Ge),++D.footprintSegLen,++D.polygonSegLen}if(D.vertexCount=this.layoutVertexArray.length-D.vertexArrayOffset,D.groundVertexCount=this.groundEffect.vertexArray.length-D.groundVertexArrayOffset,D.vertexCount!==0){if(D.centroidXY=P.borders?PS:this.encodeCentroid(P,D),this.centroidData.push(D),P.borders){this.featuresOnBorder.push(P);const Te=this.featuresOnBorder.length-1;for(let Be=0;Be<P.borders.length;Be++)P.borders[Be][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Be].push(Te)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,d,g,f,M),this.groundEffect.addPaintPropertiesData(e,c,d,g,f,M),this.maxHeight=Math.max(this.maxHeight,q)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((o,c)=>this.featuresOnBorder[o].borders[e][0]-this.featuresOnBorder[c].borders[e][0])}splitToSubtiles(){const e=[];for(let S=0;S<this.centroidData.length;S++){const M=this.centroidData[S],L=+(M.min.y+M.max.y>tn),w=2*L+(+(M.min.x+M.max.x>tn)^L);for(let A=0;A<M.polygonSegLen;A++){const R=M.polygonSegIdx+A;e.push({centroidIdx:S,subtile:w,polygonSegmentIdx:R,triangleSegmentIdx:this.polygonSegments[R].triangleSegIdx})}}const o=new Po;e.sort((S,M)=>S.triangleSegmentIdx===M.triangleSegmentIdx?S.subtile-M.subtile:S.triangleSegmentIdx-M.triangleSegmentIdx);let c=0,f=0,d=0;for(const S of e){if(S.triangleSegmentIdx!==c)break;d++}const g=e.length;for(;f!==e.length;){c=e[f].triangleSegmentIdx;let S=0,M=f,L=f;for(let w=M;w<d&&e[w].subtile===S;w++)L++;for(;M!==d;){const w=e[M];S=w.subtile;const A=this.centroidData[w.centroidIdx].min.clone(),R=this.centroidData[w.centroidIdx].max.clone(),C={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let P=M;P<L;P++){const D=e[P],V=this.polygonSegments[D.polygonSegmentIdx],q=this.centroidData[D.centroidIdx].min,K=this.centroidData[D.centroidIdx].max,Q=this.indexArray.uint16;for(let X=V.triangleArrayOffset;X<V.triangleArrayOffset+V.triangleCount;X++)o.emplaceBack(Q[3*X],Q[3*X+1],Q[3*X+2]);C.primitiveLength+=V.triangleCount,A.x=Math.min(A.x,q.x),A.y=Math.min(A.y,q.y),R.x=Math.max(R.x,K.x),R.y=Math.max(R.y,K.y)}C.primitiveLength>0&&this.triangleSubSegments.push({segment:C,min:A,max:R}),M=L;for(let P=M;P<d&&e[P].subtile===e[M].subtile;P++)L++}f=d;for(let w=f;w<g&&e[w].triangleSegmentIdx===e[f].triangleSegmentIdx;w++)d++}o._trim(),this.indexArray=o}getVisibleSegments(e,o,c){const f=new Ui;if(this.wallMode){for(const D of this.triangleSubSegments)f.segments.push(D.segment);return f}let d=0,g=0;const S=1<<e.canonical.z;if(o){const D=o.getMinMaxForTile(e);D&&(d=D.min,g=D.max)}g+=this.maxHeight;const M=e.toUnwrapped();let L;const w=[M.canonical.x/S+M.wrap,M.canonical.y/S],A=[(M.canonical.x+1)/S+M.wrap,(M.canonical.y+1)/S],R=(D,V,q)=>[D[0]*(1-q[0])+V[0]*q[0],D[1]*(1-q[1])+V[1]*q[1]],C=[],P=[];for(const D of this.triangleSubSegments){C[0]=D.min.x/tn,C[1]=D.min.y/tn,P[0]=D.max.x/tn,P[1]=D.max.y/tn;const V=R(w,A,C),q=R(w,A,P);if(new Cn([V[0],V[1],d],[q[0],q[1],g]).intersectsPrecise(c)===0){L&&(f.segments.push(L),L=void 0);continue}const K=D.segment;L&&L.vertexOffset!==K.vertexOffset&&(f.segments.push(L),L=void 0),L?(L.vertexLength+=K.vertexLength,L.primitiveLength+=K.primitiveLength):L={vertexOffset:K.vertexOffset,primitiveLength:K.primitiveLength,vertexLength:K.vertexLength,primitiveOffset:K.primitiveOffset,sortKey:void 0,vaos:{}}}return L&&f.segments.push(L),f}encodeCentroid(e,o){const c=e.centroid(),f=o.span(),d=Math.min(7,Math.round(f.x*this.tileToMeter/10)),g=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new _t(Dt(c.x,1,tn-1)<<3|d,Dt(c.y,1,tn-1)<<3|g)}encodeBorderCentroid(e){if(!e.borders)return new _t(0,0);const o=e.borders,c=Number.MAX_VALUE;if(o[0][0]!==c||o[1][0]!==c){const f=o[0][0]!==c?0:1;return new _t(6|(o[0][0]!==c?0:65528),(o[f][0]+o[f][1])/2<<3|6)}{const f=o[2][0]!==c?2:3;return new _t((o[f][0]+o[f][1])/2<<3|6,6|(o[2][0]!==c?0:65528))}}showCentroid(e){const o=this.centroidData[e.centroidDataIndex];o.flags&=ep,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const o=e.vertexArrayOffset,c=e.vertexCount+e.vertexArrayOffset,f=e.flags&ep?PS:e.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==f.y||d!==f.x){for(let g=o;g<c;++g)this.centroidVertexArray.emplace(g,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,o,c){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const f=o.getReplacementRegionsForTile(e.toUnwrapped());if(qx(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const d=[];for(const g of this.activeReplacements){if(g.order<c)continue;const S=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-e.canonical.z));for(const M of this.centroidData)if(!(M.flags&ep||g.min.x>M.max.x||M.min.x>g.max.x||g.min.y>M.max.y||M.min.y>g.max.y))for(let L=0;L<M.footprintSegLen;L++){const w=this.footprintSegments[M.footprintSegIdx+L];if(d.length=0,rk(this.footprintVertices,w.vertexOffset,w.vertexCount,g.footprintTileId.canonical,e.canonical,d),ES(g.footprint,d,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-S)){M.flags|=ep;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,o,c){let f=!1;for(let d=0;d<c.footprintSegLen;d++){const g=this.footprintSegments[c.footprintSegIdx+d];let S=0;for(const M of g.ringIndices){for(let L=S,w=M+S-1;L<M+S;w=L++){const A=this.footprintVertices.int16[2*(L+g.vertexOffset)+0],R=this.footprintVertices.int16[2*(L+g.vertexOffset)+1],C=this.footprintVertices.int16[2*(w+g.vertexOffset)+1];R>o!=C>o&&e<(this.footprintVertices.int16[2*(w+g.vertexOffset)+0]-A)*(o-R)/(C-R)+A&&(f=!f)}S=M}}return f}getHeightAtTileCoord(e,o){let c=Number.NEGATIVE_INFINITY,f=!0;const d=4*(e+tn)*tn+(o+tn);if(this.partLookup.hasOwnProperty(d)){const g=this.partLookup[d];return g?{height:g.height,hidden:!!(g.flags&ep)}:void 0}for(const g of this.centroidData)e>g.max.x||g.min.x>e||o>g.max.y||g.min.y>o||this.footprintContainsPoint(e,o,g)&&g&&g.height>c&&(c=g.height,this.partLookup[d]=g,f=!!(g.flags&ep));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:f};this.partLookup[d]=void 0}}function OS(l,e){const o=l.add(e)._unit();return l.x*o.x+l.y*o.y}function nk(l,e,o,c){const f=e.sub(l)._perp()._unit(),d=o.sub(e)._perp()._unit();return FS(l,e,o,OS(f,d),c)}function FS(l,e,o,c,f){const d=Math.sqrt(1-c*c);return Math.min(l.dist(e)/3,e.dist(o)/3,f*d/c)}function Zx(l,e,o){return l.x<o[0].x&&e.x<o[0].x||l.x>o[1].x&&e.x>o[1].x||l.y<o[0].y&&e.y<o[0].y||l.y>o[1].y&&e.y>o[1].y}function BS(l,e){return l.x<e[0].x||l.x>e[1].x||l.y<e[0].y||l.y>e[1].y}function NS(l,e,o){if(l.x<0||l.x>=tn||e.x<0||e.x>=tn||o.x<0||o.x>=tn)return!1;const c=o.sub(e),f=c.perp(),d=l.sub(e);return(c.x*d.x+c.y*d.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(d.x*d.x+d.y*d.y))>-.866&&f.x*d.x+f.y*d.y<0}function jS(l,e,o){const c=e?2|l:-3&l;return o?1|c:-2&c}function US(){const l=Math.PI/32,e=Math.tan(l),o=iu;return o*Math.sqrt(1+2*e*e)-o}function $S(l,e,o){const c=1<<o.z,f=Is(o.x/c),d=Is((o.x+1)/c),g=Ln(o.y/c),S=Ln((o.y+1)/c);return function(M,L,w,A,R=0,C){const P=[];if(!M.length||!w||!A)return P;const D=(de,ye)=>{for(const Ce of de)P.push({polygon:Ce,bounds:ye})},V=Math.ceil(Math.log2(w)),q=Math.ceil(Math.log2(A)),K=V-q,Q=[];for(let de=0;de<Math.abs(K);de++)Q.push(K>0?0:1);for(let de=0;de<Math.min(V,q);de++)Q.push(0),Q.push(1);let X=M;if(X=_y(X,L[0].y-R,L[1].y+R,1),X=_y(X,L[0].x-R,L[1].x+R,0),!X.length)return P;const re=[];for(Q.length?re.push({polygons:X,bounds:L,depth:0}):D(X,L);re.length;){const de=re.pop(),ye=de.depth,Ce=Q[ye],Ee=de.bounds[0],Te=de.bounds[1],Be=Ce===0?Ee.x:Ee.y,Ae=Ce===0?Te.x:Te.y,Ue=C(Ce,Be,Ae),He=_y(de.polygons,Be-R,Ue+R,Ce),Ge=_y(de.polygons,Ue-R,Ae+R,Ce);if(He.length){const Ke=[Ee,new _t(Ce===0?Ue:Te.x,Ce===1?Ue:Te.y)];Q.length>ye+1?re.push({polygons:He,bounds:Ke,depth:ye+1}):D(He,Ke)}if(Ge.length){const Ke=[new _t(Ce===0?Ue:Ee.x,Ce===1?Ue:Ee.y),Te];Q.length>ye+1?re.push({polygons:Ge,bounds:Ke,depth:ye+1}):D(Ge,Ke)}}return P}(l,e,Math.ceil((d-f)/11.25),Math.ceil((g-S)/11.25),1,(M,L,w)=>{if(M===0)return .5*(L+w);{const A=Ln((o.y+L/tn)/c);return(pa(.5*(Ln((o.y+w/tn)/c)+A))*c-o.y)*tn}})}function rk(l,e,o,c,f,d){const g=Math.pow(2,c.z-f.z);for(let S=0;S<o;S++){let M=l.int16[2*(S+e)+0],L=l.int16[2*(S+e)+1];M=(M+f.x*tn)*g-c.x*tn,L=(L+f.y*tn)*g-c.y*tn,d.push(new _t(M,L))}}let VS,GS;function kg(l,e){return l.x*e.x+l.y*e.y}function qS(l,e){if(l.length===1){let o=0;const c=e[o++];let f;for(;!f||c.equals(f);)if(f=e[o++],!f)return 1/0;for(;o<e.length;o++){const d=e[o],g=l[0],S=f.sub(c),M=d.sub(c),L=g.sub(c),w=kg(S,S),A=kg(S,M),R=kg(M,M),C=kg(L,S),P=kg(L,M),D=w*R-A*A,V=(R*C-A*P)/D,q=(w*P-A*C)/D,K=c.z*(1-V-q)+f.z*V+d.z*q;if(isFinite(K))return K}return 1/0}{let o=1/0;for(const c of e)o=Math.min(o,c.z);return o}}function WS(l,e,o,c,f,d,g,S){const M=g*f.getElevationAt(l,e,!0,!0),L=d[0]!==0,w=L?d[1]===0?g*(d[0]/7-450):g*function(A,R,C){const P=Math.floor(R[0]/8),D=Math.floor(R[1]/8),V=10*(R[0]-8*P),q=10*(R[1]-8*D),K=A.getElevationAt(P,D,!0,!0),Q=A.getMeterToDEM(C),X=Math.floor(.5*(V*Q-1)),re=Math.floor(.5*(q*Q-1)),de=A.tileCoordToPixel(P,D),ye=2*X+1,Ce=2*re+1,Ee=function(Ge,Ke,rt,dt,Qe){return[Ge.getElevationAtPixel(Ke,rt,!0),Ge.getElevationAtPixel(Ke+Qe,rt,!0),Ge.getElevationAtPixel(Ke,rt+Qe,!0),Ge.getElevationAtPixel(Ke+dt,rt+Qe,!0)]}(A,de.x-X,de.y-re,ye,Ce),Te=Math.abs(Ee[0]-Ee[1]),Be=Math.abs(Ee[2]-Ee[3]),Ae=Math.abs(Ee[0]-Ee[2])+Math.abs(Ee[1]-Ee[3]),Ue=Math.min(.25,.5*Q*(Te+Be)/ye),He=Math.min(.25,.5*Q*Ae/Ce);return K+Math.max(Ue*V,He*q)}(f,d,S):M;return{base:M+(o===0?-1:o),top:L?Math.max(w+c,M+o+2):M+c}}dn(by,"FillExtrusionBucket",{omit:["layers","features"]}),dn(kS,"PartData"),dn(RS,"FootprintSegment"),dn(LS,"BorderCentroidData"),dn(DS,"GroundEffect");const ik=Dr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),ok=Dr([{name:"a_z_offset_width",components:2,type:"Float32"}],4),{members:sk}=ik,ak=Dr([{name:"a_packed",components:4,type:"Float32"}]),{members:lk}=ak,ck=Dr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:uk}=ck;class HS{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.image=new _c({width:e,height:o}),this.positions={},this.uploaded=!1}getDash(e,o){const c=this.getKey(e,o);return this.positions[c]}trim(){const e=this.width,o=this.height=Hn(this.nextRow);this.image.resize({width:e,height:o})}getKey(e,o){return e.join(",")+o}getDashRanges(e,o,c){const f=[];let d=e.length%2==1?-e[e.length-1]*c:0,g=e[0]*c,S=!0;f.push({left:d,right:g,isDash:S,zeroLength:e[0]===0});let M=e[0];for(let L=1;L<e.length;L++){S=!S;const w=e[L];d=M*c,M+=w,g=M*c,f.push({left:d,right:g,isDash:S,zeroLength:w===0})}return f}addRoundDash(e,o,c){const f=o/2;for(let d=-c;d<=c;d++){const g=this.width*(this.nextRow+c+d);let S=0,M=e[S];for(let L=0;L<this.width;L++){L/M.right>1&&(M=e[++S]);const w=Math.abs(L-M.left),A=Math.abs(L-M.right),R=Math.min(w,A);let C;const P=d/c*(f+1);if(M.isDash){const D=f-Math.abs(P);C=Math.sqrt(R*R+D*D)}else C=f-Math.sqrt(R*R+P*P);this.image.data[g+L]=Math.max(0,Math.min(255,C+128))}}}addRegularDash(e,o){for(let M=e.length-1;M>=0;--M){const L=e[M],w=e[M+1];L.zeroLength?e.splice(M,1):w&&w.isDash===L.isDash&&(w.left=L.left,e.splice(M,1))}const c=e[0],f=e[e.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const d=this.width*this.nextRow;let g=0,S=e[g];for(let M=0;M<this.width;M++){M/S.right>1&&(S=e[++g]);const L=Math.abs(M-S.left),w=Math.abs(M-S.right),A=Math.min(L,w);this.image.data[d+M]=Math.max(0,Math.min(255,(S.isDash?A:-A)+o+128))}}addDash(e,o){const c=this.getKey(e,o);if(this.positions[c])return this.positions[c];const f=o==="round",d=f?7:0,g=2*d+1;if(this.nextRow+g>this.height)return $n("LineAtlas out of space"),null;e.length===0&&e.push(1);let S=0;for(let w=0;w<e.length;w++)e[w]<0&&($n("Negative value is found in line dasharray, replacing values with 0"),e[w]=0),S+=e[w];if(S!==0){const w=this.width/S,A=this.getDashRanges(e,this.width,w);f?this.addRoundDash(A,w,d):this.addRegularDash(A,o==="square"?.5*w:0)}const M=this.nextRow+d;this.nextRow+=g;const L={tl:[M,d],br:[S,0]};return this.positions[c]=L,L}}dn(HS,"LineAtlas");const dk=bm.VectorTileFeature.types,hk=Math.cos(Math.PI/180*37.5),pk=Math.cos(Math.PI/180*5);class Xx{constructor(e){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=e.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new hs,this.layoutVertexArray2=new ua,this.patternVertexArray=new Zs,this.indexArray=new Po,this.programConfigurations=new Al(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new Ui,this.maxLineLength=0,this.zOffsetVertexArray=new hc,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=e.tessellationStep?e.tessellationStep:tn/64}updateFootprints(e,o){}populate(e,o,c,f){this.hasPattern=nr("line",this.layers,o);const d=this.layers[0].layout.get("line-sort-key");this.tileToMeter=a(c),this.hasZOffset=!this.layers[0].isDraped();const g=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&g==="none"&&$n(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const S=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&S!==void 0;const M=[];for(const{feature:R,id:C,index:P,sourceLayerIndex:D}of e){const V=this.layers[0]._featureFilter.needGeometry,q=Z(R,V);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),q,c))continue;const K=d?d.evaluate(q,{},c):void 0,Q={id:C,properties:R.properties,type:R.type,sourceLayerIndex:D,index:P,geometry:V?q.geometry:W(R,c,f),patterns:{},sortKey:K};M.push(Q)}d&&M.sort((R,C)=>R.sortKey-C.sortKey);const{lineAtlas:L,featureIndex:w}=o,A=this.addConstantDashes(L);for(const R of M){const{geometry:C,index:P,sourceLayerIndex:D}=R;if(A&&this.addFeatureDashes(R,L),this.hasPattern){const V=or("line",this.layers,R,this.zoom,o);this.patternFeatures.push(V)}else this.addFeature(R,C,P,c,L.positions,o.availableImages,o.brightness);w.insert(e[P].feature,C,P,D,this.index)}}addConstantDashes(e){let o=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,d=c.layout.get("line-cap").value;if(f.kind!=="constant"||d.kind!=="constant")o=!0;else{const g=d.value,S=f.value;if(!S)continue;e.addDash(S,g)}}return o}addFeatureDashes(e,o){const c=this.zoom;for(const f of this.layers){const d=f.paint.get("line-dasharray").value,g=f.layout.get("line-cap").value;if(d.kind==="constant"&&g.kind==="constant")continue;let S,M;if(d.kind==="constant"){if(S=d.value,!S)continue}else S=d.evaluate({zoom:c},e);M=g.kind==="constant"?g.value:g.evaluate({zoom:c},e),o.addDash(S,M),e.patterns[f.id]=o.getKey(S,M)}}update(e,o,c,f,d,g,S){this.programConfigurations.updatePaintArrays(e,o,d,c,f,g,S)}addFeatures(e,o,c,f,d,g){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,o,c,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,lk)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,uk)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,ok.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sk),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,c,f,d,g,S){const M=this.layers[0].layout,L=M.get("line-join").evaluate(e,{}),w=M.get("line-cap").evaluate(e,{}),A=M.get("line-miter-limit"),R=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(e),this.lineFeature=e,this.zOffsetValue=M.get("line-z-offset").value;const C=this.layers[0].paint.get("line-width").value;C.kind!=="constant"&&C.isLineProgressConstant===!1&&(this.variableWidthValue=C);for(const P of o)this.addLine(P,e,f,L,w,A,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,d,g,f,S)}addLine(e,o,c,f,d,g,S){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const M=f==="none";if(this.patternJoinNone=this.hasPattern&&M,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const L=dk[o.type]==="Polygon";let w=e.length;for(;w>=2&&e[w-1].equals(e[w-2]);)w--;let A=0;for(;A<w-1&&e[A].equals(e[A+1]);)A++;if(w<(L?3:2))return;f==="bevel"&&(g=1.05);const R=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let C,P,D,V,q,K;this.e1=this.e2=-1,L&&(C=e[w-2],q=e[A].sub(C)._unit()._perp());for(let Q=A;Q<w;Q++){if(D=Q===w-1?L?e[A+1]:void 0:e[Q+1],D&&e[Q].equals(D))continue;q&&(V=q),C&&(P=C),C=e[Q],K=this.evaluateLineProgressFeatures(P?P.dist(C):0),q=D?D.sub(C)._unit()._perp():V,V=V||q;const X=P&&D;let re=X?f:L||M?"butt":d;const de=V.x*q.x+V.y*q.y;if(M){const He=function(Ge){if(Ge.patternJoinNone){const Ke=Ge.segmentPoints.length/2,rt=Ge.lineSoFar-Ge.segmentStart;for(let dt=0;dt<Ke;++dt){const Qe=Ge.segmentPoints[2*dt+1],wt=Math.round(Ge.segmentPoints[2*dt])+.5+.25*Qe;Ge.patternVertexArray.emplaceBack(wt,rt,Ge.segmentStart),Ge.patternVertexArray.emplaceBack(wt,rt,Ge.segmentStart)}Ge.segmentPoints.length=0}Ge.e1=Ge.e2=-1};if(X&&de<pk){this.updateDistance(P,C),this.addCurrentVertex(C,V,1,1,R,K),He(this),this.addCurrentVertex(C,q,-1,-1,R,K);continue}if(P){if(!D){this.updateDistance(P,C),this.addCurrentVertex(C,V,1,1,R,K),He(this);continue}re="miter"}}let ye=V.add(q);ye.x===0&&ye.y===0||ye._unit();const Ce=ye.x*q.x+ye.y*q.y,Ee=Ce!==0?1/Ce:1/0,Te=2*Math.sqrt(2-2*Ce),Be=Ce<hk&&P&&D,Ae=V.x*q.y-V.y*q.x>0,Ue=this.overscaling<=16?15*tn/(512*this.overscaling):0;if(X&&re==="round"){if(Ee<S)re="miter";else if(Ee<=2){const He=Yx(C,-10,tn+10);re=this.hasZOffset&&(He||this.hasCrossSlope)?"miter":"fakeround"}}if(re==="miter"&&Ee>g&&(re="bevel"),re==="bevel"&&(Ee>2&&(re="flipbevel"),Ee<g&&(re="miter")),P&&!(re==="miter"&&Be)&&this.updateDistance(P,C),re==="miter")if(Be){const He=C.dist(P);if(He>2*Ue){const Ke=C.sub(C.sub(P)._mult(Ue/He)._round());this.updateDistance(P,Ke),this.addCurrentVertex(Ke,V,0,0,R,K),P=Ke}this.updateDistance(P,C),ye._mult(Ee),this.addCurrentVertex(C,ye,0,0,R,K);const Ge=C.dist(D);if(Ge>2*Ue){const Ke=C.add(D.sub(C)._mult(Ue/Ge)._round());this.updateDistance(C,Ke),this.addCurrentVertex(Ke,q,0,0,R,K),C=Ke}}else ye._mult(Ee),this.addCurrentVertex(C,ye,0,0,R,K);else if(re==="flipbevel"){if(Ee>100)ye=q.mult(-1);else{const He=Ee*V.add(q).mag()/V.sub(q).mag();ye._perp()._mult(He*(Ae?-1:1))}this.addCurrentVertex(C,ye,0,0,R,K),this.addCurrentVertex(C,ye.mult(-1),0,0,R,K)}else if(re==="bevel"||re==="fakeround"){K!=null&&P&&this.addCurrentVertex(C,V,-1,-1,R,K);const He=C.dist(P)<=2*Ue&&re!=="bevel",Ge=ye.mult(Ae?1:-1);Ge._mult(Ee);const Ke=q.mult(Ae?-1:1),rt=V.mult(Ae?-1:1),dt=this.evaluateLineProgressFeatures(this.distance);if(K==null&&(this.addHalfVertex(C,Ge.x,Ge.y,!1,!Ae,0,R,dt),He||this.addHalfVertex(C,Ge.x+2*rt.x,Ge.y+2*rt.y,!1,Ae,0,R,dt)),re==="fakeround"){const Qe=Math.round(180*Te/Math.PI/20);this.addHalfVertex(C,rt.x,rt.y,!1,Ae,0,R,dt);for(let wt=0;wt<Qe;wt++){let qt=wt/Qe;if(qt!==.5){const Qt=qt-.5;qt+=qt*Qt*(qt-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*Qt*Qt+(.848013+de*(.215638*de-1.06021)))}const Tt=Ke.sub(rt)._mult(qt)._add(rt)._unit();this.addHalfVertex(C,Tt.x,Tt.y,!1,Ae,0,R,dt)}this.addHalfVertex(C,Ke.x,Ke.y,!1,Ae,0,R,dt)}He||K!=null||this.addHalfVertex(C,Ge.x+2*Ke.x,Ge.y+2*Ke.y,!1,Ae,0,R,dt),K!=null&&D&&this.addCurrentVertex(C,q,1,1,R,K)}else re==="butt"?this.addCurrentVertex(C,ye,0,0,R,K):re==="square"?(P||this.addCurrentVertex(C,ye,-1,-1,R,K),this.addCurrentVertex(C,ye,0,0,R,K),P&&this.addCurrentVertex(C,ye,1,1,R,K)):re==="round"&&(P&&(this.addCurrentVertex(C,V,0,0,R,K),this.addCurrentVertex(C,V,1,1,R,K,!0)),D&&(this.addCurrentVertex(C,q,-1,-1,R,K,!0),this.addCurrentVertex(C,q,0,0,R,K)))}}addVerticesTo(e,o,c,f,d,g,S,M,L,w){const A=(o.w-e.w)/this.tessellationStep|0;let R=0;const C=this.scaledDistance;if(A>1){this.lineSoFar=e.w;const D=(o.x-e.x)/A,V=(o.y-e.y)/A,q=(o.z-e.z)/A,K=(o.w-e.w)/A;for(let Q=1;Q<A;++Q){e.x+=D,e.y+=V,e.z+=q,this.lineSoFar+=K,R+=K;const X=this.evaluateLineProgressFeatures(this.prevDistance+R);this.scaledDistance=(this.prevDistance+R)/this.totalDistance,this.addHalfVertex(e,c,f,w,!1,S,L,X),this.addHalfVertex(e,d,g,w,!0,-M,L,X)}}this.lineSoFar=o.w,this.scaledDistance=C;const P=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,c,f,w,!1,S,L,P),this.addHalfVertex(o,d,g,w,!0,-M,L,P)}evaluateLineProgressFeatures(e){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+e)/this.totalFeatureLength):$n(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}:{zOffset:0,variableWidth:o}}addCurrentVertex(e,o,c,f,d,g,S=!1){const M=o.x+o.y*c,L=o.y-o.x*c,w=o.y*f-o.x,A=-o.y-o.x*f;if(g!=null){const R=this.hasZOffset,C=-10,P=tn+10,D=g.zOffset,V=new vS(e.x,e.y,D,this.lineSoFar),q=!!R&&Yx(e,C,P),K=this.lineSoFar,Q=this.distance;if(this.currentVertex)if(q){const X=this.currentVertexIsOutside,re=this.currentVertex,de=new vS(e.x,e.y,D,this.lineSoFar);if(bS(re,de,C,P),!Yx(de,C,P)){if(X){this.e1=this.e2=-1,this.distance-=re.dist(V),this.lineSoFar=re.w;const ye=this.evaluateLineProgressFeatures(re.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(re,M,L,S,!1,c,d,ye),this.addHalfVertex(re,w,A,S,!0,-f,d,ye),this.prevDistance=this.distance}this.distance=this.prevDistance+re.dist(de),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(re,de,M,L,w,A,c,f,d,S),this.distance=Q,this.scaledDistance=this.distance/this.totalDistance}}else{const X=this.currentVertex;if(this.currentVertexIsOutside){bS(X,V,C,P),this.e1=this.e2=-1,this.distance-=X.dist(V),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=X.w;const re=this.evaluateLineProgressFeatures(X.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(X,M,L,S,!1,c,d,re),this.addHalfVertex(X,w,A,S,!0,-f,d,re),this.prevDistance=this.distance,this.distance=Q,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(X,V,M,L,w,A,c,f,d,S)}else q||(this.addHalfVertex(e,M,L,S,!1,c,d,g),this.addHalfVertex(e,w,A,S,!0,-f,d,g));this.currentVertex=V,this.currentVertexIsOutside=q,this.lineSoFar=K}else this.addHalfVertex(e,M,L,S,!1,c,d,g),this.addHalfVertex(e,w,A,S,!0,-f,d,g)}addHalfVertex({x:e,y:o},c,f,d,g,S,M,L){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,S)),this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(o<<1)+(g?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(S===0?0:S<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),M.primitiveLength++),g?this.e2=w:this.e1=w,L!=null&&this.zOffsetVertexArray.emplaceBack(L.zOffset,L.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(e,o){this.prevDistance=this.distance,this.distance+=e.dist(o),this.updateScaledDistance()}}function Yx(l,e,o){return l.x<e||l.x>o||l.y<e||l.y>o}let ZS,XS;function YS(l,e,o){return e*(tn/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}dn(Xx,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const KS=(l,e,o)=>(1-o)*l+o*e;function JS(l,e){return 1/YS(l,1,e.tileZoom)}function QS(l,e,o,c){return l.translatePosMatrix(c||e.tileID.projMatrix,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const e2=l=>{const e=[];t2(l)&&e.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const o=l.paint.get("line-trim-offset");o[0]===0&&o[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER");const c=l.layout.get("line-join").constantOr("miter")==="none",f=!!l.paint.get("line-pattern").constantOr(1);return c&&f&&e.push("LINE_JOIN_NONE"),e};function t2(l){const e=l.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}let Kx;const n2=()=>Kx||(Kx={layout:ZS||(ZS=new bi({"line-cap":new nn(ft.layout_line["line-cap"]),"line-join":new nn(ft.layout_line["line-join"]),"line-miter-limit":new Wt(ft.layout_line["line-miter-limit"]),"line-round-limit":new Wt(ft.layout_line["line-round-limit"]),"line-sort-key":new nn(ft.layout_line["line-sort-key"]),"line-z-offset":new nn(ft.layout_line["line-z-offset"]),"line-elevation-reference":new Wt(ft.layout_line["line-elevation-reference"]),"line-cross-slope":new Wt(ft.layout_line["line-cross-slope"]),visibility:new Wt(ft.layout_line.visibility),"line-width-unit":new Wt(ft.layout_line["line-width-unit"])})),paint:XS||(XS=new bi({"line-opacity":new nn(ft.paint_line["line-opacity"]),"line-color":new nn(ft.paint_line["line-color"]),"line-translate":new Wt(ft.paint_line["line-translate"]),"line-translate-anchor":new Wt(ft.paint_line["line-translate-anchor"]),"line-width":new nn(ft.paint_line["line-width"]),"line-gap-width":new nn(ft.paint_line["line-gap-width"]),"line-offset":new nn(ft.paint_line["line-offset"]),"line-blur":new nn(ft.paint_line["line-blur"]),"line-dasharray":new nn(ft.paint_line["line-dasharray"]),"line-pattern":new nn(ft.paint_line["line-pattern"]),"line-gradient":new Es(ft.paint_line["line-gradient"]),"line-trim-offset":new Wt(ft.paint_line["line-trim-offset"]),"line-trim-fade-range":new Wt(ft.paint_line["line-trim-fade-range"]),"line-trim-color":new Wt(ft.paint_line["line-trim-color"]),"line-emissive-strength":new Wt(ft.paint_line["line-emissive-strength"]),"line-border-width":new nn(ft.paint_line["line-border-width"]),"line-border-color":new nn(ft.paint_line["line-border-color"]),"line-occlusion-opacity":new Wt(ft.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},Kx);class fk extends nn{possiblyEvaluate(e,o){return o=new Jr(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(e,o)}evaluate(e,o,c,f){return o=Pn({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(e,o,c,f)}}let Lg;function r2(l,e){return e>0?e+2*l:l}const mk=Dr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gk=Dr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),_k=Dr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const yk=Dr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),vk=Dr([{name:"a_texb",components:2,type:"Uint16"}]),xk=Dr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),bk=Dr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Dr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const i2=Dr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wk=Dr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dr([{name:"triangle",components:3,type:"Uint16"}]),Dr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Dr([{type:"Float32",name:"offsetX"}]),Dr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ys=24;const lu=128;function wy(l,e,o,c,f){if(l.kind==="camera")return l.maxSize;if(l.kind==="composite"){const d=e.possiblyEvaluate(new Jr(l.maxZoom),o).evaluate(f,{},o),g=e.possiblyEvaluate(new Jr(l.minZoom),o).evaluate(f,{},o);return Math.max(d,g)}return e.possiblyEvaluate(new Jr(c)).evaluate(f,{},o)}function Jx(l,e){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Jr(l+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=o;let d=0;for(;d<c.length&&c[d]<=l;)d++;d=Math.max(0,d-1);let g=d;for(;g<c.length&&c[g]<l+1;)g++;g=Math.min(c.length-1,g);const S=c[d],M=c[g];return o.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:M,interpolationType:f}:{kind:"camera",minZoom:S,maxZoom:M,minSize:o.evaluate(new Jr(S)),maxSize:o.evaluate(new Jr(M)),interpolationType:f}}}function Sy(l,{uSize:e,uSizeT:o},{lowerSize:c,upperSize:f}){return l.kind==="source"?c/lu:l.kind==="composite"?Fn(c/lu,f/lu,o):e}function wm(l,e,o=1){let c=0,f=0;if(l.kind==="constant")f=l.layoutSize*o;else if(l.kind!=="source"){const{interpolationType:d,minZoom:g,maxZoom:S}=l,M=d?Dt(Co.interpolationFactor(d,e,g,S),0,1):0;l.kind==="camera"?f=Fn(l.minSize,l.maxSize,M)*o:c=M*o}return{uSizeT:c,uSize:f}}var Sk=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:lu,evaluateSizeForFeature:Sy,evaluateSizeForZoom:wm,getRasterizedIconSize:wy,getSizeData:Jx});function Tk(l,e,o){return l.sections.forEach(c=>{c.text=function(f,d,g){const S=d.layout.get("text-transform").evaluate(g,{});return S==="uppercase"?f=f.toLocaleUpperCase():S==="lowercase"&&(f=f.toLocaleLowerCase()),qs.applyArabicShaping&&(f=qs.applyArabicShaping(f)),f}(c.text,e,o)}),l}const zg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Ek(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function Ck(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}var o2,Qx,s2,e0={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Mk(){return o2||(o2=1,e0.read=function(l,e,o,c,f){var d,g,S=8*f-c-1,M=(1<<S)-1,L=M>>1,w=-7,A=o?f-1:0,R=o?-1:1,C=l[e+A];for(A+=R,d=C&(1<<-w)-1,C>>=-w,w+=S;w>0;d=256*d+l[e+A],A+=R,w-=8);for(g=d&(1<<-w)-1,d>>=-w,w+=c;w>0;g=256*g+l[e+A],A+=R,w-=8);if(d===0)d=1-L;else{if(d===M)return g?NaN:1/0*(C?-1:1);g+=Math.pow(2,c),d-=L}return(C?-1:1)*g*Math.pow(2,d-c)},e0.write=function(l,e,o,c,f,d){var g,S,M,L=8*d-f-1,w=(1<<L)-1,A=w>>1,R=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=c?0:d-1,P=c?1:-1,D=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(S=isNaN(e)?1:0,g=w):(g=Math.floor(Math.log(e)/Math.LN2),e*(M=Math.pow(2,-g))<1&&(g--,M*=2),(e+=g+A>=1?R/M:R*Math.pow(2,1-A))*M>=2&&(g++,M/=2),g+A>=w?(S=0,g=w):g+A>=1?(S=(e*M-1)*Math.pow(2,f),g+=A):(S=e*Math.pow(2,A-1)*Math.pow(2,f),g=0));f>=8;l[o+C]=255&S,C+=P,S/=256,f-=8);for(g=g<<f|S,L+=f;L>0;l[o+C]=255&g,C+=P,g/=256,L-=8);l[o+C-P]|=128*D}),e0}function a2(){if(s2)return Qx;s2=1,Qx=e;var l=Mk();function e(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var o=4294967296,c=1/o,f=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function d(X){return X.type===e.Bytes?X.readVarint()+X.pos:X.pos+1}function g(X,re,de){return de?4294967296*re+(X>>>0):4294967296*(re>>>0)+(X>>>0)}function S(X,re,de){var ye=re<=16383?1:re<=2097151?2:re<=268435455?3:Math.floor(Math.log(re)/(7*Math.LN2));de.realloc(ye);for(var Ce=de.pos-1;Ce>=X;Ce--)de.buf[Ce+ye]=de.buf[Ce]}function M(X,re){for(var de=0;de<X.length;de++)re.writeVarint(X[de])}function L(X,re){for(var de=0;de<X.length;de++)re.writeSVarint(X[de])}function w(X,re){for(var de=0;de<X.length;de++)re.writeFloat(X[de])}function A(X,re){for(var de=0;de<X.length;de++)re.writeDouble(X[de])}function R(X,re){for(var de=0;de<X.length;de++)re.writeBoolean(X[de])}function C(X,re){for(var de=0;de<X.length;de++)re.writeFixed32(X[de])}function P(X,re){for(var de=0;de<X.length;de++)re.writeSFixed32(X[de])}function D(X,re){for(var de=0;de<X.length;de++)re.writeFixed64(X[de])}function V(X,re){for(var de=0;de<X.length;de++)re.writeSFixed64(X[de])}function q(X,re){return(X[re]|X[re+1]<<8|X[re+2]<<16)+16777216*X[re+3]}function K(X,re,de){X[de]=re,X[de+1]=re>>>8,X[de+2]=re>>>16,X[de+3]=re>>>24}function Q(X,re){return(X[re]|X[re+1]<<8|X[re+2]<<16)+(X[re+3]<<24)}return e.prototype={destroy:function(){this.buf=null},readFields:function(X,re,de){for(de=de||this.length;this.pos<de;){var ye=this.readVarint(),Ce=ye>>3,Ee=this.pos;this.type=7&ye,X(Ce,re,this),this.pos===Ee&&this.skip(ye)}return re},readMessage:function(X,re){return this.readFields(X,re,this.readVarint()+this.pos)},readFixed32:function(){var X=q(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=Q(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=q(this.buf,this.pos)+q(this.buf,this.pos+4)*o;return this.pos+=8,X},readSFixed64:function(){var X=q(this.buf,this.pos)+Q(this.buf,this.pos+4)*o;return this.pos+=8,X},readFloat:function(){var X=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var re,de,ye=this.buf;return re=127&(de=ye[this.pos++]),de<128?re:(re|=(127&(de=ye[this.pos++]))<<7,de<128?re:(re|=(127&(de=ye[this.pos++]))<<14,de<128?re:(re|=(127&(de=ye[this.pos++]))<<21,de<128?re:function(Ce,Ee,Te){var Be,Ae,Ue=Te.buf;if(Be=(112&(Ae=Ue[Te.pos++]))>>4,Ae<128||(Be|=(127&(Ae=Ue[Te.pos++]))<<3,Ae<128)||(Be|=(127&(Ae=Ue[Te.pos++]))<<10,Ae<128)||(Be|=(127&(Ae=Ue[Te.pos++]))<<17,Ae<128)||(Be|=(127&(Ae=Ue[Te.pos++]))<<24,Ae<128)||(Be|=(1&(Ae=Ue[Te.pos++]))<<31,Ae<128))return g(Ce,Be,Ee);throw new Error("Expected varint not more than 10 bytes")}(re|=(15&(de=ye[this.pos]))<<28,X,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2==1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,re=this.pos;return this.pos=X,X-re>=12&&f?function(de,ye,Ce){return f.decode(de.subarray(ye,Ce))}(this.buf,re,X):function(de,ye,Ce){for(var Ee="",Te=ye;Te<Ce;){var Be,Ae,Ue,He=de[Te],Ge=null,Ke=He>239?4:He>223?3:He>191?2:1;if(Te+Ke>Ce)break;Ke===1?He<128&&(Ge=He):Ke===2?(192&(Be=de[Te+1]))==128&&(Ge=(31&He)<<6|63&Be)<=127&&(Ge=null):Ke===3?(Ae=de[Te+2],(192&(Be=de[Te+1]))==128&&(192&Ae)==128&&((Ge=(15&He)<<12|(63&Be)<<6|63&Ae)<=2047||Ge>=55296&&Ge<=57343)&&(Ge=null)):Ke===4&&(Ae=de[Te+2],Ue=de[Te+3],(192&(Be=de[Te+1]))==128&&(192&Ae)==128&&(192&Ue)==128&&((Ge=(15&He)<<18|(63&Be)<<12|(63&Ae)<<6|63&Ue)<=65535||Ge>=1114112)&&(Ge=null)),Ge===null?(Ge=65533,Ke=1):Ge>65535&&(Ge-=65536,Ee+=String.fromCharCode(Ge>>>10&1023|55296),Ge=56320|1023&Ge),Ee+=String.fromCharCode(Ge),Te+=Ke}return Ee}(this.buf,re,X)},readBytes:function(){var X=this.readVarint()+this.pos,re=this.buf.subarray(this.pos,X);return this.pos=X,re},readPackedVarint:function(X,re){if(this.type!==e.Bytes)return X.push(this.readVarint(re));var de=d(this);for(X=X||[];this.pos<de;)X.push(this.readVarint(re));return X},readPackedSVarint:function(X){if(this.type!==e.Bytes)return X.push(this.readSVarint());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==e.Bytes)return X.push(this.readBoolean());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==e.Bytes)return X.push(this.readFloat());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==e.Bytes)return X.push(this.readDouble());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==e.Bytes)return X.push(this.readFixed32());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==e.Bytes)return X.push(this.readSFixed32());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==e.Bytes)return X.push(this.readFixed64());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==e.Bytes)return X.push(this.readSFixed64());var re=d(this);for(X=X||[];this.pos<re;)X.push(this.readSFixed64());return X},skip:function(X){var re=7&X;if(re===e.Varint)for(;this.buf[this.pos++]>127;);else if(re===e.Bytes)this.pos=this.readVarint()+this.pos;else if(re===e.Fixed32)this.pos+=4;else{if(re!==e.Fixed64)throw new Error("Unimplemented type: "+re);this.pos+=8}},writeTag:function(X,re){this.writeVarint(X<<3|re)},realloc:function(X){for(var re=this.length||16;re<this.pos+X;)re*=2;if(re!==this.length){var de=new Uint8Array(re);de.set(this.buf),this.buf=de,this.length=re}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),K(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),K(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),K(this.buf,-1&X,this.pos),K(this.buf,Math.floor(X*c),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),K(this.buf,-1&X,this.pos),K(this.buf,Math.floor(X*c),this.pos+4),this.pos+=8},writeVarint:function(X){(X=+X||0)>268435455||X<0?function(re,de){var ye,Ce;if(re>=0?(ye=re%4294967296|0,Ce=re/4294967296|0):(Ce=~(-re/4294967296),4294967295^(ye=~(-re%4294967296))?ye=ye+1|0:(ye=0,Ce=Ce+1|0)),re>=18446744073709552e3||re<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");de.realloc(10),function(Ee,Te,Be){Be.buf[Be.pos++]=127&Ee|128,Ee>>>=7,Be.buf[Be.pos++]=127&Ee|128,Ee>>>=7,Be.buf[Be.pos++]=127&Ee|128,Ee>>>=7,Be.buf[Be.pos++]=127&Ee|128,Be.buf[Be.pos]=127&(Ee>>>=7)}(ye,0,de),function(Ee,Te){var Be=(7&Ee)<<4;Te.buf[Te.pos++]|=Be|((Ee>>>=3)?128:0),Ee&&(Te.buf[Te.pos++]=127&Ee|((Ee>>>=7)?128:0),Ee&&(Te.buf[Te.pos++]=127&Ee|((Ee>>>=7)?128:0),Ee&&(Te.buf[Te.pos++]=127&Ee|((Ee>>>=7)?128:0),Ee&&(Te.buf[Te.pos++]=127&Ee|((Ee>>>=7)?128:0),Ee&&(Te.buf[Te.pos++]=127&Ee)))))}(Ce,de)}(X,this):(this.realloc(4),this.buf[this.pos++]=127&X|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=X>>>7&127))))},writeSVarint:function(X){this.writeVarint(X<0?2*-X-1:2*X)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(4*X.length),this.pos++;var re=this.pos;this.pos=function(ye,Ce,Ee){for(var Te,Be,Ae=0;Ae<Ce.length;Ae++){if((Te=Ce.charCodeAt(Ae))>55295&&Te<57344){if(!Be){Te>56319||Ae+1===Ce.length?(ye[Ee++]=239,ye[Ee++]=191,ye[Ee++]=189):Be=Te;continue}if(Te<56320){ye[Ee++]=239,ye[Ee++]=191,ye[Ee++]=189,Be=Te;continue}Te=Be-55296<<10|Te-56320|65536,Be=null}else Be&&(ye[Ee++]=239,ye[Ee++]=191,ye[Ee++]=189,Be=null);Te<128?ye[Ee++]=Te:(Te<2048?ye[Ee++]=Te>>6|192:(Te<65536?ye[Ee++]=Te>>12|224:(ye[Ee++]=Te>>18|240,ye[Ee++]=Te>>12&63|128),ye[Ee++]=Te>>6&63|128),ye[Ee++]=63&Te|128)}return Ee}(this.buf,X,this.pos);var de=this.pos-re;de>=128&&S(re,de,this),this.pos=re-1,this.writeVarint(de),this.pos+=de},writeFloat:function(X){this.realloc(4),l.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),l.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var re=X.length;this.writeVarint(re),this.realloc(re);for(var de=0;de<re;de++)this.buf[this.pos++]=X[de]},writeRawMessage:function(X,re){this.pos++;var de=this.pos;X(re,this);var ye=this.pos-de;ye>=128&&S(de,ye,this),this.pos=de-1,this.writeVarint(ye),this.pos+=ye},writeMessage:function(X,re,de){this.writeTag(X,e.Bytes),this.writeRawMessage(re,de)},writePackedVarint:function(X,re){re.length&&this.writeMessage(X,M,re)},writePackedSVarint:function(X,re){re.length&&this.writeMessage(X,L,re)},writePackedBoolean:function(X,re){re.length&&this.writeMessage(X,R,re)},writePackedFloat:function(X,re){re.length&&this.writeMessage(X,w,re)},writePackedDouble:function(X,re){re.length&&this.writeMessage(X,A,re)},writePackedFixed32:function(X,re){re.length&&this.writeMessage(X,C,re)},writePackedSFixed32:function(X,re){re.length&&this.writeMessage(X,P,re)},writePackedFixed64:function(X,re){re.length&&this.writeMessage(X,D,re)},writePackedSFixed64:function(X,re){re.length&&this.writeMessage(X,V,re)},writeBytesField:function(X,re){this.writeTag(X,e.Bytes),this.writeBytes(re)},writeFixed32Field:function(X,re){this.writeTag(X,e.Fixed32),this.writeFixed32(re)},writeSFixed32Field:function(X,re){this.writeTag(X,e.Fixed32),this.writeSFixed32(re)},writeFixed64Field:function(X,re){this.writeTag(X,e.Fixed64),this.writeFixed64(re)},writeSFixed64Field:function(X,re){this.writeTag(X,e.Fixed64),this.writeSFixed64(re)},writeVarintField:function(X,re){this.writeTag(X,e.Varint),this.writeVarint(re)},writeSVarintField:function(X,re){this.writeTag(X,e.Varint),this.writeSVarint(re)},writeStringField:function(X,re){this.writeTag(X,e.Bytes),this.writeString(re)},writeFloatField:function(X,re){this.writeTag(X,e.Fixed32),this.writeFloat(re)},writeDoubleField:function(X,re){this.writeTag(X,e.Fixed64),this.writeDouble(re)},writeBooleanField:function(X,re){this.writeVarintField(X,!!re)}},Qx}var Ty=I(a2());const t0=3;function Ik(l,e,o){e.glyphs=[],l===1&&o.readMessage(Ak,e)}function Ak(l,e,o){if(l===3){const{id:c,bitmap:f,width:d,height:g,left:S,top:M,advance:L}=o.readMessage(Pk,{});e.glyphs.push({id:c,bitmap:new _c({width:d+2*t0,height:g+2*t0},f),metrics:{width:d,height:g,left:S,top:M,advance:L}})}else l===4?e.ascender=o.readSVarint():l===5&&(e.descender=o.readSVarint())}function Pk(l,e,o){l===1?e.id=o.readVarint():l===2?e.bitmap=o.readBytes():l===3?e.width=o.readVarint():l===4?e.height=o.readVarint():l===5?e.left=o.readSVarint():l===6?e.top=o.readSVarint():l===7&&(e.advance=o.readVarint())}const Rk=t0,Rl={horizontal:1,vertical:2,horizontalOnly:3};class Dg{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(e,o){const c=new Dg;return c.scale=e||1,c.fontStack=o,c}static forImage(e){const o=new Dg;return o.image=e,o}}class Sm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const c=new Sm;for(let f=0;f<e.sections.length;f++){const d=e.sections[f];d.image?c.addImageSection(d):c.addTextSection(d,o)}return c}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(o,c){let f="";for(let d=0;d<o.length;d++){const g=o.charCodeAt(d+1)||null,S=o.charCodeAt(d-1)||null;f+=!c&&(g&&Ni(g)&&!zg[o[d+1]]||S&&Ni(S)&&!zg[o[d-1]])||!zg[o[d]]?o[d]:zg[o[d]]}return f}(this.text,e)}trim(){let e=0;for(let c=0;c<this.text.length&&Ey[this.text.charCodeAt(c)];c++)e++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=e&&Ey[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const c=new Sm;return c.text=this.text.substring(e,o),c.sectionIndex=this.sectionIndex.slice(e,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(Dg.forText(e.scale,e.fontStack||o));const c=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(c)}addImageSection(e){const o=e.image&&e.image.namePrimary?e.image.getPrimary():null;if(!o)return void $n("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(Dg.forImage(o)),this.sectionIndex.push(this.sections.length-1)):$n("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function n0(l,e,o,c,f,d,g,S,M,L,w,A,R,C,P){const D=Sm.fromFeature(l,f);A===Rl.vertical&&D.verticalizePunctuation(R);let V=[];const q=function(de,ye,Ce,Ee,Te,Be){if(!de)return[];const Ae=[],Ue=function(rt,dt,Qe,wt,qt,Tt){let Qt=0;for(let Kt=0;Kt<rt.length();Kt++){const ln=rt.getSection(Kt);Qt+=l2(rt.getCodePoint(Kt),ln,wt,qt,dt,Tt)}return Qt/Math.max(1,Math.ceil(Qt/Qe))}(de,ye,Ce,Ee,Te,Be),He=de.text.indexOf("")>=0;let Ge=0;for(let rt=0;rt<de.length();rt++){const dt=de.getSection(rt),Qe=de.getCodePoint(rt);if(Ey[Qe]||(Ge+=l2(Qe,dt,Ee,Te,ye,Be)),rt<de.length()-1){const wt=!((Ke=Qe)<11904||!(Mn["Bopomofo Extended"](Ke)||Mn.Bopomofo(Ke)||Mn["CJK Compatibility Forms"](Ke)||Mn["CJK Compatibility Ideographs"](Ke)||Mn["CJK Compatibility"](Ke)||Mn["CJK Radicals Supplement"](Ke)||Mn["CJK Strokes"](Ke)||Mn["CJK Symbols and Punctuation"](Ke)||Mn["CJK Unified Ideographs Extension A"](Ke)||Mn["CJK Unified Ideographs"](Ke)||Mn["Enclosed CJK Letters and Months"](Ke)||Mn["Halfwidth and Fullwidth Forms"](Ke)||Mn.Hiragana(Ke)||Mn["Ideographic Description Characters"](Ke)||Mn["Kangxi Radicals"](Ke)||Mn["Katakana Phonetic Extensions"](Ke)||Mn.Katakana(Ke)||Mn["Vertical Forms"](Ke)||Mn["Yi Radicals"](Ke)||Mn["Yi Syllables"](Ke)));(kk[Qe]||wt||dt.image)&&Ae.push(u2(rt+1,Ge,Ue,Ae,Lk(Qe,de.getCodePoint(rt+1),wt&&He),!1))}}var Ke;return d2(u2(de.length(),Ge,Ue,Ae,0,!0))}(D,L,d,e,c,C),{processBidirectionalText:K,processStyledBidirectionalText:Q}=qs;if(K&&D.sections.length===1){const de=K(D.toString(),q);for(const ye of de){const Ce=new Sm;Ce.text=ye,Ce.sections=D.sections;for(let Ee=0;Ee<ye.length;Ee++)Ce.sectionIndex.push(0);V.push(Ce)}}else if(Q){const de=Q(D.text,D.sectionIndex,q);for(const ye of de){const Ce=new Sm;Ce.text=ye[0],Ce.sectionIndex=ye[1],Ce.sections=D.sections,V.push(Ce)}}else V=function(de,ye){const Ce=[],Ee=de.text;let Te=0;for(const Be of ye)Ce.push(de.substring(Te,Be)),Te=Be;return Te<Ee.length&&Ce.push(de.substring(Te,Ee.length)),Ce}(D,q);const X=[],re={positionedLines:X,text:D.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:A,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(de,ye,Ce,Ee,Te,Be,Ae,Ue,He,Ge,Ke,rt){let dt=0,Qe=0,wt=0;const qt=Ue==="right"?1:Ue==="left"?0:.5;let Tt=!1;for(const en of Te){const bn=en.getSections();for(const Un of bn){if(Un.image)continue;const hr=ye[Un.fontStack];if(hr&&(Tt=hr.ascender!==void 0&&hr.descender!==void 0,!Tt))break}if(!Tt)break}let Qt=0;for(const en of Te){en.trim();const bn=en.getMaxScale(),Un=(bn-1)*ys,hr={positionedGlyphs:[],lineOffset:0};de.positionedLines[Qt]=hr;const _r=hr.positionedGlyphs;let Sr=0;if(!en.length()){Qe+=Be,++Qt;continue}let yr=0,Rr=0;for(let ti=0;ti<en.length();ti++){const Qn=en.getSection(ti),ni=en.getSectionIndex(ti),Kr=en.getCodePoint(ti);let hi=Qn.scale,ho=null,po=null,Ji=null,fa=ys,Ii=0;const Pi=!(He===Rl.horizontal||!Ke&&!es(Kr)||Ke&&(Ey[Kr]||(Kt=Kr,Mn.Arabic(Kt)||Mn["Arabic Supplement"](Kt)||Mn["Arabic Extended-A"](Kt)||Mn["Arabic Presentation Forms-A"](Kt)||Mn["Arabic Presentation Forms-B"](Kt))));if(Qn.image){const Ks=Ee[Qn.image.serialize()];if(!Ks)continue;Ji=Qn.image.id,de.iconsInText=de.iconsInText||!0,po=Ks.paddedRect;const fo=Ks.displaySize;hi=hi*ys/rt,ho={width:fo[0],height:fo[1],left:0,top:-3,advance:Pi?fo[1]:fo[0],localGlyph:!1},Ii=Tt?-ho.height*hi:bn*ys-17-fo[1]*hi,fa=ho.advance;const Ia=(Pi?fo[0]:fo[1])*hi-ys*bn;Ia>0&&Ia>Sr&&(Sr=Ia)}else{const Ks=Ce[Qn.fontStack];if(!Ks)continue;Ks[Kr]&&(po=Ks[Kr]);const fo=ye[Qn.fontStack];if(!fo)continue;const Ia=fo.glyphs[Kr];if(!Ia)continue;if(ho=Ia.metrics,fa=Kr!==8203?ys:0,Tt){const ko=fo.ascender!==void 0?Math.abs(fo.ascender):0,Ju=fo.descender!==void 0?Math.abs(fo.descender):0,op=(ko+Ju)*hi;yr<op&&(yr=op,Rr=(ko-Ju)/2*hi),Ii=-ko*hi}else Ii=(bn-hi)*ys-17}Pi?(de.verticalizable=!0,_r.push({glyph:Kr,imageName:Ji,x:dt,y:Qe+Ii,vertical:Pi,scale:hi,localGlyph:ho.localGlyph,fontStack:Qn.fontStack,sectionIndex:ni,metrics:ho,rect:po}),dt+=fa*hi+Ge):(_r.push({glyph:Kr,imageName:Ji,x:dt,y:Qe+Ii,vertical:Pi,scale:hi,localGlyph:ho.localGlyph,fontStack:Qn.fontStack,sectionIndex:ni,metrics:ho,rect:po}),dt+=ho.advance*hi+Ge)}_r.length!==0&&(wt=Math.max(dt-Ge,wt),Tt?h2(_r,qt,Sr,Rr,Be*bn/2):h2(_r,qt,Sr,0,Be/2)),dt=0;const di=Be*bn+Sr;hr.lineOffset=Math.max(Sr,Un),Qe+=di,++Qt}var Kt;const ln=Qe,{horizontalAlign:Pt,verticalAlign:En}=r0(Ae);(function(en,bn,Un,hr,_r,Sr){const yr=(bn-Un)*_r,Rr=-Sr*hr;for(const di of en)for(const ti of di.positionedGlyphs)ti.x+=yr,ti.y+=Rr})(de.positionedLines,qt,Pt,En,wt,ln),de.top+=-En*ln,de.bottom=de.top+ln,de.left+=-Pt*wt,de.right=de.left+wt,de.hasBaseline=Tt}(re,e,o,c,V,g,S,M,A,L,R,P),!function(de){for(const ye of de)if(ye.positionedGlyphs.length!==0)return!1;return!0}(X)&&re}const Ey={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},kk={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function l2(l,e,o,c,f,d){if(e.image){const g=c[e.image.serialize()];return g?g.displaySize[0]*e.scale*ys/d+f:0}{const g=o[e.fontStack],S=g&&g.glyphs[l];return S?S.metrics.advance*e.scale+f:0}}function c2(l,e,o,c){const f=Math.pow(l-e,2);return c?l<e?f/2:2*f:f+Math.abs(o)*o}function Lk(l,e,o){let c=0;return l===10&&(c-=1e4),o&&(c+=150),l!==40&&l!==65288||(c+=50),e!==41&&e!==65289||(c+=50),c}function u2(l,e,o,c,f,d){let g=null,S=c2(e,o,f,d);for(const M of c){const L=c2(e-M.x,o,f,d)+M.badness;L<=S&&(g=M,S=L)}return{index:l,x:e,priorBreak:g,badness:S}}function d2(l){return l?d2(l.priorBreak).concat(l.index):[]}function r0(l){let e=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function h2(l,e,o,c,f){if(!(e||o||c||f))return;const d=l.length-1,g=l[d],S=(g.x+g.metrics.advance*g.scale)*e;for(let M=0;M<=d;M++)l[M].x-=S,l[M].y+=o+c+f}function zk(l,e,o,c){const{horizontalAlign:f,verticalAlign:d}=r0(c),g=o[0]-l.displaySize[0]*f,S=o[1]-l.displaySize[1]*d;return{imagePrimary:l,imageSecondary:e,top:S,bottom:S+l.displaySize[1],left:g,right:g+l.displaySize[0]}}function p2(l,e,o,c,f,d){const g=l.imagePrimary;let S;if(g.content){const V=g.content,q=g.pixelRatio||1;S=[V[0]/q,V[1]/q,g.displaySize[0]-V[2]/q,g.displaySize[1]-V[3]/q]}const M=e.left*d,L=e.right*d;let w,A,R,C;o==="width"||o==="both"?(C=f[0]+M-c[3],A=f[0]+L+c[1]):(C=f[0]+(M+L-g.displaySize[0])/2,A=C+g.displaySize[0]);const P=e.top*d,D=e.bottom*d;return o==="height"||o==="both"?(w=f[1]+P-c[0],R=f[1]+D+c[2]):(w=f[1]+(P+D-g.displaySize[1])/2,R=w+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:w,right:A,bottom:R,left:C,collisionPadding:S}}class Qd extends _t{constructor(e,o,c,f,d){super(e,o),this.angle=f,this.z=c,d!==void 0&&(this.segment=d)}clone(){return new Qd(this.x,this.y,this.z,this.angle,this.segment)}}function f2(l,e,o,c,f){if(e.segment===void 0)return!0;let d=e,g=e.segment+1,S=0;for(;S>-o/2;){if(g--,g<0)return!1;S-=l[g].dist(d),d=l[g]}S+=l[g].dist(l[g+1]),g++;const M=[];let L=0;for(;S<o/2;){const w=l[g],A=l[g+1];if(!A)return!1;let R=l[g-1].angleTo(w)-w.angleTo(A);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:S,angleDelta:R}),L+=R;S-M[0].distance>c;)L-=M.shift().angleDelta;if(L>f)return!1;g++,S+=w.dist(A)}return!0}function m2(l){let e=0;for(let o=0;o<l.length-1;o++)e+=l[o].dist(l[o+1]);return e}function g2(l,e,o){return l?.6*e*o:0}function _2(l,e){return Math.max(l?l.right-l.left:0,e?e.right-e.left:0)}function Dk(l,e,o,c,f,d){const g=g2(o,f,d),S=_2(o,c)*d;let M=0;const L=m2(l)/2;for(let w=0;w<l.length-1;w++){const A=l[w],R=l[w+1],C=A.dist(R);if(M+C>L){const P=(L-M)/C,D=Fn(A.x,R.x,P),V=Fn(A.y,R.y,P),q=new Qd(D,V,0,R.angleTo(A),w);return!g||f2(l,q,S,g,e)?q:void 0}M+=C}}function Ok(l,e,o,c,f,d,g,S,M){const L=g2(c,d,g),w=_2(c,f),A=w*g,R=l[0].x===0||l[0].x===M||l[0].y===0||l[0].y===M;return e-A<e/4&&(e=A+e/4),y2(l,R?e/2*S%e:(w/2+2*d)*g*S%e,e,L,o,A,R,!1,M)}function y2(l,e,o,c,f,d,g,S,M){const L=d/2,w=m2(l);let A=0,R=e-o,C=[];for(let P=0;P<l.length-1;P++){const D=l[P],V=l[P+1],q=D.dist(V),K=V.angleTo(D);for(;R+o<A+q;){R+=o;const Q=(R-A)/q,X=Fn(D.x,V.x,Q),re=Fn(D.y,V.y,Q);if(X>=0&&X<M&&re>=0&&re<M&&R-L>=0&&R+L<=w){const de=new Qd(X,re,0,K,P);c&&!f2(l,de,d,c,f)||C.push(de)}}A+=q}return S||C.length||g||(C=y2(l,A/2,o,c,f,d,g,!0,M)),C}function v2(l,e,o,c,f){const d=[];for(let g=0;g<l.length;g++){const S=l[g];let M;for(let L=0;L<S.length-1;L++){let w=S[L],A=S[L+1];w.x<e&&A.x<e||(w.x<e?w=new _t(e,w.y+(e-w.x)/(A.x-w.x)*(A.y-w.y))._round():A.x<e&&(A=new _t(e,w.y+(e-w.x)/(A.x-w.x)*(A.y-w.y))._round()),w.y<o&&A.y<o||(w.y<o?w=new _t(w.x+(o-w.y)/(A.y-w.y)*(A.x-w.x),o)._round():A.y<o&&(A=new _t(w.x+(o-w.y)/(A.y-w.y)*(A.x-w.x),o)._round()),w.x>=c&&A.x>=c||(w.x>=c?w=new _t(c,w.y+(c-w.x)/(A.x-w.x)*(A.y-w.y))._round():A.x>=c&&(A=new _t(c,w.y+(c-w.x)/(A.x-w.x)*(A.y-w.y))._round()),w.y>=f&&A.y>=f||(w.y>=f?w=new _t(w.x+(f-w.y)/(A.y-w.y)*(A.x-w.x),f)._round():A.y>=f&&(A=new _t(w.x+(f-w.y)/(A.y-w.y)*(A.x-w.x),f)._round()),M&&w.equals(M[M.length-1])||(M=[w],d.push(M)),M.push(A)))))}}return d}function x2(l){let e=0,o=0;for(const g of l)e+=g.w*g.h,o=Math.max(o,g.w);l.sort((g,S)=>S.h-g.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let f=0,d=0;for(const g of l)for(let S=c.length-1;S>=0;S--){const M=c[S];if(!(g.w>M.w||g.h>M.h)){if(g.x=M.x,g.y=M.y,d=Math.max(d,g.y+g.h),f=Math.max(f,g.x+g.w),g.w===M.w&&g.h===M.h){const L=c.pop();S<c.length&&(c[S]=L)}else g.h===M.h?(M.x+=g.w,M.w-=g.w):g.w===M.w?(M.y+=g.h,M.h-=g.h):(c.push({x:M.x+g.w,y:M.y,w:M.w-g.w,h:g.h}),M.y+=g.h,M.h-=g.h);break}}return{w:f,h:d,fill:e/(f*d)||0}}dn(Qd,"Anchor");const Og=1;class i0{constructor(e,{pixelRatio:o,version:c,stretchX:f,stretchY:d,content:g},S){this.paddedRect=e,this.pixelRatio=o,this.stretchX=f,this.stretchY=d,this.content=g,this.version=c,this.padding=S}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class b2{constructor(e,o,c){const f={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(e,f,Og,g),this.addImages(o,d,2,g);const{w:S,h:M}=x2(g),L=new ss({width:S||1,height:M||1});for(const w in e){const A=e[w],R=f[w].paddedRect;ss.copy(A.data,L,{x:0,y:0},{x:R.x+Og,y:R.y+Og},A.data,c,A.sdf)}for(const w in o){const A=o[w],R=d[w].paddedRect;let C=d[w].padding;const P=R.x+C,D=R.y+C,V=A.data.width,q=A.data.height;C=C>1?C-1:C,ss.copy(A.data,L,{x:0,y:0},{x:P,y:D},A.data,c),ss.copy(A.data,L,{x:0,y:q-C},{x:P,y:D-C},{width:V,height:C},c),ss.copy(A.data,L,{x:0,y:0},{x:P,y:D+q},{width:V,height:C},c),ss.copy(A.data,L,{x:V-C,y:0},{x:P-C,y:D},{width:C,height:q},c),ss.copy(A.data,L,{x:0,y:0},{x:P+V,y:D},{width:C,height:q},c),ss.copy(A.data,L,{x:V-C,y:q-C},{x:P-C,y:D-C},{width:C,height:C},c),ss.copy(A.data,L,{x:0,y:q-C},{x:P+V,y:D-C},{width:C,height:C},c),ss.copy(A.data,L,{x:0,y:0},{x:P+V,y:D+q},{width:C,height:C},c),ss.copy(A.data,L,{x:V-C,y:0},{x:P-C,y:D+q},{width:C,height:C},c)}this.image=L,this.iconPositions=f,this.patternPositions=d}addImages(e,o,c,f){for(const d in e){const g=e[d],S={x:0,y:0,w:g.data.width+2*c,h:g.data.height+2*c};f.push(S),o[d]=new i0(S,g,c),g.hasRenderCallback&&this.haveRenderCallbacks.push(js.deserializeId(d))}}patchUpdatedImages(e,o,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>e.hasImage(f,c)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const f in e.getUpdatedImages(c)){for(const d of Object.keys(this.iconPositions))js.deserializeId(d)===f&&this.patchUpdatedImage(this.iconPositions[d],e.getImage(f,c),o);for(const d of Object.keys(this.patternPositions))js.deserializeId(d)===f&&this.patchUpdatedImage(this.patternPositions[d],e.getImage(f,c),o)}}patchUpdatedImage(e,o,c){if(!e||!o||e.version===o.version)return;e.version=o.version;const[f,d]=e.tl;c.update(o.data,{position:{x:f,y:d}})}}dn(i0,"ImagePosition"),dn(b2,"ImageAtlas");const Cy=1e20;function w2(l,e,o,c,f,d,g,S,M){for(let L=e;L<e+c;L++)S2(l,o*d+L,d,f,g,S,M);for(let L=o;L<o+f;L++)S2(l,L*d+e,1,c,g,S,M)}function S2(l,e,o,c,f,d,g){d[0]=0,g[0]=-1e20,g[1]=Cy,f[0]=l[e];for(let S=1,M=0,L=0;S<c;S++){f[S]=l[e+S*o];const w=S*S;do{const A=d[M];L=(f[S]-f[A]+w-A*A)/(S-A)/2}while(L<=g[M]&&--M>-1);M++,d[M]=S,g[M]=L,g[M+1]=Cy}for(let S=0,M=0;S<c;S++){for(;g[M+1]<S;)M++;const L=d[M],w=S-L;l[e+S*o]=f[L]+w*w}}const cu=2,o0={none:0,ideographs:1,all:2};class Tm{constructor(e,o,c){this.requestManager=e,this.localGlyphMode=o,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,o){this.urls[o]=e}getGlyphs(e,o,c){const f=[],d=this.urls[o]||Re.GLYPHS_URL;for(const g in e)for(const S of e[g])f.push({stack:g,id:S});Tn(f,({stack:g,id:S},M)=>{let L=this.entries[g];L||(L=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=L.glyphs[S];if(w!==void 0)return void M(null,{stack:g,id:S,glyph:w});if(w=this._tinySDF(L,g,S),w)return L.glyphs[S]=w,void M(null,{stack:g,id:S,glyph:w});const A=Math.floor(S/256);if(256*A>65535)return $n("glyphs > 65535 not supported"),void M(null,{stack:g,id:S,glyph:w});if(L.ranges[A])return void M(null,{stack:g,id:S,glyph:w});let R=L.requests[A];R||(R=L.requests[A]=[],Tm.loadGlyphRange(g,A,d,this.requestManager,(C,P)=>{if(P){L.ascender=P.ascender,L.descender=P.descender;for(const D in P.glyphs)this._doesCharSupportLocalGlyph(+D)||(L.glyphs[+D]=P.glyphs[+D]);L.ranges[A]=!0}for(const D of R)D(C,P);delete L.requests[A]})),R.push((C,P)=>{C?M(C):P&&M(null,{stack:g,id:S,glyph:P.glyphs[S]||null})})},(g,S)=>{if(g)c(g);else if(S){const M={};for(const{stack:L,id:w,glyph:A}of S)M[L]===void 0&&(M[L]={}),M[L].glyphs===void 0&&(M[L].glyphs={}),M[L].glyphs[w]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},M[L].ascender=this.entries[L].ascender,M[L].descender=this.entries[L].descender;c(null,M)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==o0.none&&(this.localGlyphMode===o0.all?!!this.localFontFamily:!!this.localFontFamily&&(Mn["CJK Unified Ideographs"](e)||Mn["Hangul Syllables"](e)||Mn.Hiragana(e)||Mn.Katakana(e)||Mn["CJK Symbols and Punctuation"](e)||Mn["CJK Unified Ideographs Extension A"](e)||Mn["CJK Unified Ideographs Extension B"](e)||Mn.Osage(e)))}_tinySDF(e,o,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let d=e.tinySDF;if(!d){let D="400";/bold/i.test(o)?D="900":/medium/i.test(o)?D="500":/light/i.test(o)&&(D="200"),d=e.tinySDF=new Tm.TinySDF({fontFamily:f,fontWeight:D,fontSize:24*cu,buffer:3*cu,radius:8*cu}),d.fontWeight=D}if(this.localGlyphs[d.fontWeight][c])return this.localGlyphs[d.fontWeight][c];const g=String.fromCodePoint(c),{data:S,width:M,height:L,glyphWidth:w,glyphHeight:A,glyphLeft:R,glyphTop:C,glyphAdvance:P}=d.draw(g);return this.localGlyphs[d.fontWeight][c]={id:c,bitmap:new _c({width:M,height:L},S),metrics:{width:w/cu,height:A/cu,left:R/cu,top:C/cu-27,advance:P/cu,localGlyph:!0}}}}Tm.loadGlyphRange=function(l,e,o,c,f){const d=256*e,g=d+255,S=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",l).replace("{range}",`${d}-${g}`),Ko.Glyphs);Ic(S,(M,L)=>{if(M)f(M);else if(L){const w={},A=function(R){return new Ty(R).readFields(Ik,{})}(L);for(const R of A.glyphs)w[R.id]=R;f(null,{glyphs:w,ascender:A.ascender,descender:A.descender})}})},Tm.TinySDF=class{constructor({fontSize:l=24,buffer:e=3,radius:o=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:d="normal",fontStyle:g="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=o;const S=this.size=l+4*e,M=this._createCanvas(S),L=this.ctx=M.getContext("2d",{willReadFrequently:!0});L.font=`${g} ${d} ${l}px ${f}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(l){const e=document.createElement("canvas");return e.width=e.height=l,e}draw(l){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:d}=this.ctx.measureText(l),g=Math.ceil(o),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-f))),M=Math.min(this.size-this.buffer,g+Math.ceil(c)),L=S+2*this.buffer,w=M+2*this.buffer,A=Math.max(L*w,0),R=new Uint8ClampedArray(A),C={data:R,width:L,height:w,glyphWidth:S,glyphHeight:M,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(S===0||M===0)return C;const{ctx:P,buffer:D,gridInner:V,gridOuter:q}=this;P.clearRect(D,D,S,M),P.fillText(l,D,D+g);const K=P.getImageData(D,D,S,M);q.fill(Cy,0,A),V.fill(0,0,A);for(let Q=0;Q<M;Q++)for(let X=0;X<S;X++){const re=K.data[4*(Q*S+X)+3]/255;if(re===0)continue;const de=(Q+D)*L+X+D;if(re===1)q[de]=0,V[de]=Cy;else{const ye=.5-re;q[de]=ye>0?ye*ye:0,V[de]=ye<0?ye*ye:0}}w2(q,0,0,L,w,L,this.f,this.v,this.z),w2(V,D,D,S,M,L,this.f,this.v,this.z);for(let Q=0;Q<A;Q++){const X=Math.sqrt(q[Q])-Math.sqrt(V[Q]);R[Q]=Math.round(255-255*(X/this.radius+this.cutoff))}return C}};const cf=Og;function T2(l,e){return l+e[1]-e[0]}function E2(l,e,o,c,f=1){const d=[],g=l.imagePrimary,S=g.pixelRatio,M=g.paddedRect.w-2*cf,L=g.paddedRect.h-2*cf,w=(l.right-l.left)*f,A=(l.bottom-l.top)*f,R=g.stretchX||[[0,M]],C=g.stretchY||[[0,L]],P=R.reduce(T2,0),D=C.reduce(T2,0),V=M-P,q=L-D;let K=0,Q=P,X=0,re=D,de=0,ye=V,Ce=0,Ee=q;if(g.content&&c){const Be=g.content;K=My(R,0,Be[0]),X=My(C,0,Be[1]),Q=My(R,Be[0],Be[2]),re=My(C,Be[1],Be[3]),de=Be[0]-K,Ce=Be[1]-X,ye=Be[2]-Be[0]-Q,Ee=Be[3]-Be[1]-re}const Te=(Be,Ae,Ue,He)=>{const Ge=Iy(Be.stretch-K,Q,w,l.left*f),Ke=Ay(Be.fixed-de,ye,Be.stretch,P),rt=Iy(Ae.stretch-X,re,A,l.top*f),dt=Ay(Ae.fixed-Ce,Ee,Ae.stretch,D),Qe=Iy(Ue.stretch-K,Q,w,l.left*f),wt=Ay(Ue.fixed-de,ye,Ue.stretch,P),qt=Iy(He.stretch-X,re,A,l.top*f),Tt=Ay(He.fixed-Ce,Ee,He.stretch,D),Qt=new _t(Ge,rt),Kt=new _t(Qe,rt),ln=new _t(Qe,qt),Pt=new _t(Ge,qt),En=new _t(Ke/S,dt/S),en=new _t(wt/S,Tt/S),bn=e*Math.PI/180;if(bn){const Rr=Math.sin(bn),di=Math.cos(bn),ti=[di,-Rr,Rr,di];Qt._matMult(ti),Kt._matMult(ti),Pt._matMult(ti),ln._matMult(ti)}const Un=Be.stretch+Be.fixed,hr=Ue.stretch+Ue.fixed,_r=Ae.stretch+Ae.fixed,Sr=He.stretch+He.fixed,yr=l.imageSecondary;return{tl:Qt,tr:Kt,bl:Pt,br:ln,texPrimary:{x:g.paddedRect.x+cf+Un,y:g.paddedRect.y+cf+_r,w:hr-Un,h:Sr-_r},texSecondary:yr?{x:yr.paddedRect.x+cf+Un,y:yr.paddedRect.y+cf+_r,w:hr-Un,h:Sr-_r}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:En,pixelOffsetBR:en,minFontScaleX:ye/S/w,minFontScaleY:Ee/S/A,isSDF:o}};if(c&&(g.stretchX||g.stretchY)){const Be=C2(R,V,P),Ae=C2(C,q,D);for(let Ue=0;Ue<Be.length-1;Ue++){const He=Be[Ue],Ge=Be[Ue+1];for(let Ke=0;Ke<Ae.length-1;Ke++)d.push(Te(He,Ae[Ke],Ge,Ae[Ke+1]))}}else d.push(Te({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:L+1}));return d}function My(l,e,o){let c=0;for(const f of l)c+=Math.max(e,Math.min(o,f[1]))-Math.max(e,Math.min(o,f[0]));return c}function C2(l,e,o){const c=[{fixed:-1,stretch:0}];for(const[f,d]of l){const g=c[c.length-1];c.push({fixed:f-g.stretch,stretch:g.stretch}),c.push({fixed:f-g.stretch,stretch:g.stretch+(d-f)})}return c.push({fixed:e+cf,stretch:o}),c}function Iy(l,e,o,c){return l/e*o+c}function Ay(l,e,o,c){return l-e*o/c}function Fk(l,e,o,c){const f=e+l.positionedLines[c].lineOffset;return c===0?o+f/2:o+(f+(e+l.positionedLines[c-1].lineOffset))/2}function Bk(l,e=1,o=!1){let c=1/0,f=1/0,d=-1/0,g=-1/0;const S=l[0];for(let C=0;C<S.length;C++){const P=S[C];(!C||P.x<c)&&(c=P.x),(!C||P.y<f)&&(f=P.y),(!C||P.x>d)&&(d=P.x),(!C||P.y>g)&&(g=P.y)}const M=Math.min(d-c,g-f);let L=M/2;const w=new gh([],Nk);if(M===0)return new _t(c,f);for(let C=c;C<d;C+=M)for(let P=f;P<g;P+=M)w.push(new Em(C+L,P+L,L,l));let A=function(C){let P=0,D=0,V=0;const q=C[0];for(let K=0,Q=q.length,X=Q-1;K<Q;X=K++){const re=q[K],de=q[X],ye=re.x*de.y-de.x*re.y;D+=(re.x+de.x)*ye,V+=(re.y+de.y)*ye,P+=3*ye}return new Em(D/P,V/P,0,C)}(l),R=w.length;for(;w.length;){const C=w.pop();(C.d>A.d||!A.d)&&(A=C,o&&console.log("found best %d after %d probes",Math.round(1e4*C.d)/1e4,R)),C.max-A.d<=e||(L=C.h/2,w.push(new Em(C.p.x-L,C.p.y-L,L,l)),w.push(new Em(C.p.x+L,C.p.y-L,L,l)),w.push(new Em(C.p.x-L,C.p.y+L,L,l)),w.push(new Em(C.p.x+L,C.p.y+L,L,l)),R+=4)}return o&&(console.log(`num probes: ${R}`),console.log(`best distance: ${A.d}`)),A.p}function Nk(l,e){return e.max-l.max}class Em{constructor(e,o,c,f){this.p=new _t(e,o),this.h=c,this.d=function(d,g){let S=!1,M=1/0;for(let L=0;L<g.length;L++){const w=g[L];for(let A=0,R=w.length,C=R-1;A<R;C=A++){const P=w[A],D=w[C];P.y>d.y!=D.y>d.y&&d.x<(D.x-P.x)*(d.y-P.y)/(D.y-P.y)+P.x&&(S=!S),M=Math.min(M,Oe(d,P,D))}}return(S?1:-1)*Math.sqrt(M)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const s0=Number.POSITIVE_INFINITY,jk=Math.sqrt(2);function M2(l,[e,o]){let c=0,f=0;if(o===s0){e<0&&(e=0);const d=e/jk;switch(l){case"top-right":case"top-left":f=d-7;break;case"bottom-right":case"bottom-left":f=7-d;break;case"bottom":f=7-e;break;case"top":f=e-7}switch(l){case"top-right":case"bottom-right":c=-d;break;case"top-left":case"bottom-left":c=d;break;case"left":c=e;break;case"right":c=-e}}else{switch(e=Math.abs(e),o=Math.abs(o),l){case"top-right":case"top-left":case"top":f=o-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-o}switch(l){case"top-right":case"bottom-right":case"right":c=-e;break;case"top-left":case"bottom-left":case"left":c=e}}return[c,f]}function a0(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uk(l,e,o,c,f,d,g,S,M,L,w,A,R,C,P,D){let V=d.textMaxSize.evaluate(e,{},R);V===void 0?V=g*d.textScaleFactor:V*=d.textScaleFactor;const q=l.layers[0].layout,K=q.get("icon-offset").evaluate(e,{},R),Q=A2(o.horizontal)||o.vertical,X=C.name==="globe",re=ys,de=g*d.textScaleFactor/re,ye=l.tilePixelRatio*V/re,Ce=(Ke=l.overscaling,l.zoom>18&&Ke>2&&(Ke>>=1),Math.max(tn/(512*Ke),1)*q.get("symbol-spacing")),Ee=q.get("text-padding")*l.tilePixelRatio,Te=q.get("icon-padding")*l.tilePixelRatio,Be=_n(q.get("text-max-angle")),Ae=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Ue=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",He=q.get("symbol-placement"),Ge=Ce/2;var Ke;const rt=q.get("icon-text-fit").evaluate(e,{},R),dt=q.get("icon-text-fit-padding").evaluate(e,{},R),Qe=rt!=="none";let wt;l.hasAnyIconTextFit===!1&&Qe&&(l.hasAnyIconTextFit=!0),c&&Qe&&(l.allowVerticalPlacement&&o.vertical&&(wt=p2(c,o.vertical,rt,dt,K,de)),Q&&(c=p2(c,Q,rt,dt,K,de)));const qt=(Tt,Qt,Kt)=>{if(Qt.x<0||Qt.x>=tn||Qt.y<0||Qt.y>=tn)return;let ln=null;if(X){const{x:Pt,y:En,z:en}=C.projectTilePoint(Qt.x,Qt.y,Kt);ln={anchor:new Qd(Pt,En,en,0,void 0),up:C.upVector(Kt,Qt.x,Qt.y)}}(function(Pt,En,en,bn,Un,hr,_r,Sr,yr,Rr,di,ti,Qn,ni,Kr,hi,ho,po,Ji,fa,Ii,Pi,Ks,fo,Ia,ko,Ju,op){const sp=Pt.addToLineVertexArray(En,bn);let eh,ap,lp,nv,aE,lE,cE,uE=0,dE=0,hE=0,pE=0,$0=-1,V0=-1;const Qu={};let fE=Rc("");const ff=en?en.anchor:En,G0=yr.layout.get("icon-text-fit").evaluate(Ii,{},ko)!=="none";let q0=0,W0=0;if(yr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[q0,W0]=yr.layout.get("text-offset").evaluate(Ii,{},ko).map(Ll=>Ll*ys):(q0=yr.layout.get("text-radial-offset").evaluate(Ii,{},ko)*ys,W0=s0),Pt.allowVerticalPlacement&&Un.vertical){const Ll=Un.vertical;if(Kr)lE=l0(Ll),Sr&&(cE=l0(Sr));else{const el=yr.layout.get("text-rotate").evaluate(Ii,{},ko)+90;lp=Py(Rr,ff,En,di,ti,Qn,Ll,ni,el,hi),Sr&&(nv=Py(Rr,ff,En,di,ti,Qn,Sr,po,el))}}if(hr){const Ll=Pt.iconSizeData,el=fo?wy(Pt.iconSizeData,Pt.layers[0]._unevaluatedLayout._values["icon-size"],ko,Pt.zoom,Ii):1,Om=yr.layout.get("icon-rotate").evaluate(Ii,{},ko),mE=E2(hr,Om,Ks,G0,fo?1/el:Pi.iconScaleFactor),Z0=Sr?E2(Sr,Om,Ks,G0,Pi.iconScaleFactor):void 0;ap=Py(Rr,ff,En,di,ti,Qn,hr,po,Om,null,fo?Pi.iconScaleFactor*el:1),uE=4*mE.length;let mf=null;Ll.kind==="source"?(mf=[lu*yr.layout.get("icon-size").evaluate(Ii,{},ko)*Pi.iconScaleFactor],mf[0]>tp&&$n(`${Pt.layerIds[0]}: Value for "icon-size" is >= ${Fg}. Reduce your "icon-size".`)):Ll.kind==="composite"&&(mf=[lu*Pi.compositeIconSizes[0].evaluate(Ii,{},ko)*Pi.iconScaleFactor,lu*Pi.compositeIconSizes[1].evaluate(Ii,{},ko)*Pi.iconScaleFactor],(mf[0]>tp||mf[1]>tp)&&$n(`${Pt.layerIds[0]}: Value for "icon-size" is >= ${Fg}. Reduce your "icon-size".`)),Pt.addSymbols(Pt.icon,mE,mf,fa,Ji,Ii,!1,en,En,sp.lineStartIndex,sp.lineLength,-1,Ia,ko,Ju,op),$0=Pt.icon.placedSymbolArray.length-1,Z0&&(dE=4*Z0.length,Pt.addSymbols(Pt.icon,Z0,mf,fa,Ji,Ii,Rl.vertical,en,En,sp.lineStartIndex,sp.lineLength,-1,Ia,ko,Ju,op),V0=Pt.icon.placedSymbolArray.length-1)}for(const Ll in Un.horizontal){const el=Un.horizontal[Ll];eh||(fE=Rc(el.text),Kr?aE=l0(el):eh=Py(Rr,ff,En,di,ti,Qn,el,ni,yr.layout.get("text-rotate").evaluate(Ii,{},ko),hi));const Om=el.positionedLines.length===1;if(hE+=I2(Pt,en,En,el,_r,yr,Kr,Ii,hi,sp,Un.vertical?Rl.horizontal:Rl.horizontalOnly,Om?Object.keys(Un.horizontal):[Ll],Qu,$0,Pi,Ia,ko,Ju),Om)break}Un.vertical&&(pE+=I2(Pt,en,En,Un.vertical,_r,yr,Kr,Ii,hi,sp,Rl.vertical,["vertical"],Qu,V0,Pi,Ia,ko,Ju));let cp=-1;const H0=(Ll,el)=>Ll?Math.max(Ll,el):el;cp=H0(aE,cp),cp=H0(lE,cp),cp=H0(cE,cp);const x3=cp>-1?1:0;Pt.glyphOffsetArray.length>=65535&&$n("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ii.sortKey!==void 0&&Pt.addToSortKeyRanges(Pt.symbolInstances.length,Ii.sortKey),Pt.symbolInstances.emplaceBack(En.x,En.y,ff.x,ff.y,ff.z,Qu.right>=0?Qu.right:-1,Qu.center>=0?Qu.center:-1,Qu.left>=0?Qu.left:-1,Qu.vertical>=0?Qu.vertical:-1,$0,V0,fE,eh!==void 0?eh:Pt.collisionBoxArray.length,eh!==void 0?eh+1:Pt.collisionBoxArray.length,lp!==void 0?lp:Pt.collisionBoxArray.length,lp!==void 0?lp+1:Pt.collisionBoxArray.length,ap!==void 0?ap:Pt.collisionBoxArray.length,ap!==void 0?ap+1:Pt.collisionBoxArray.length,nv||Pt.collisionBoxArray.length,nv?nv+1:Pt.collisionBoxArray.length,di,hE,pE,uE,dE,x3,0,q0,W0,cp,0,G0?1:0)})(l,Qt,ln,Tt,o,c,f,wt,l.layers[0],l.collisionBoxArray,e.index,e.sourceLayerIndex,l.index,Ee,Ae,M,0,Te,Ue,K,e,d,L,w,A,R,P,D)};if(He==="line")for(const Tt of v2(e.geometry,0,0,tn,tn)){const Qt=Ok(Tt,Ce,Be,o.vertical||Q,c,re,ye,l.overscaling,tn);for(const Kt of Qt)Q&&$k(l,Q.text,Ge,Kt)||qt(Tt,Kt,R)}else if(He==="line-center"){for(const Tt of e.geometry)if(Tt.length>1){const Qt=Dk(Tt,Be,o.vertical||Q,c,re,ye);Qt&&qt(Tt,Qt,R)}}else if(e.type==="Polygon")for(const Tt of wn(e.geometry,0)){const Qt=Bk(Tt,16);qt(Tt[0],new Qd(Qt.x,Qt.y,0,0,void 0),R)}else if(e.type==="LineString")for(const Tt of e.geometry)qt(Tt,new Qd(Tt[0].x,Tt[0].y,0,0,void 0),R);else if(e.type==="Point")for(const Tt of e.geometry)for(const Qt of Tt)qt([Qt],new Qd(Qt.x,Qt.y,0,0,void 0),R)}const Fg=255,tp=Fg*lu;function I2(l,e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V,q){const K=function(re,de,ye,Ce,Ee,Te,Be,Ae){const Ue=[];if(de.positionedLines.length===0)return Ue;const He=Ce.layout.get("text-rotate").evaluate(Te,{})*Math.PI/180,Ge=function(wt){const qt=wt[0],Tt=wt[1],Qt=qt*Tt;return Qt>0?[qt,-Tt]:Qt<0?[-qt,Tt]:qt===0?[Tt,qt]:[Tt,-qt]}(ye);let Ke=Math.abs(de.top-de.bottom);for(const wt of de.positionedLines)Ke-=wt.lineOffset;const rt=de.positionedLines.length,dt=Ke/rt;let Qe=de.top-ye[1];for(let wt=0;wt<rt;++wt){const qt=de.positionedLines[wt];Qe=Fk(de,dt,Qe,wt);for(const Tt of qt.positionedGlyphs){if(!Tt.rect)continue;const Qt=Tt.rect||{};let Kt=Rk+1,ln=!0,Pt=1,En=0;if(Tt.imageName){const Ji=Be[lo.build(Tt.imageName).getSerializedPrimary()];if(!Ji)continue;if(Ji.sdf){$n("SDF images are not supported in formatted text and will be ignored.");continue}ln=!1,Pt=Ji.pixelRatio,Kt=Og/Pt}const en=(Ee||Ae)&&Tt.vertical,bn=Tt.metrics.advance*Tt.scale/2,Un=Tt.metrics,hr=Tt.rect;if(hr===null)continue;Ae&&de.verticalizable&&(En=Tt.imageName?bn-Tt.metrics.width*Tt.scale/2:0);const _r=Ee?[Tt.x+bn,Tt.y]:[0,0];let Sr=[0,0],yr=[0,0],Rr=!1;Ee||(en?(yr=[Tt.x+bn+Ge[0],Tt.y+Ge[1]-En],Rr=!0):Sr=[Tt.x+bn+ye[0],Tt.y+ye[1]-En]);const di=hr.w*Tt.scale/(Pt*(Tt.localGlyph?cu:1)),ti=hr.h*Tt.scale/(Pt*(Tt.localGlyph?cu:1));let Qn,ni,Kr,hi;if(en){const Ji=Tt.y-Qe,fa=new _t(-bn,bn-Ji),Ii=-Math.PI/2,Pi=new _t(...yr);Qn=new _t(-bn+Sr[0],Sr[1]),Qn._rotateAround(Ii,fa)._add(Pi),Qn.x+=-Ji+bn,Qn.y-=(Un.left-Kt)*Tt.scale;const Ks=Tt.imageName?Un.advance*Tt.scale:ys*Tt.scale,fo=String.fromCodePoint(Tt.glyph);Ek(fo)?Qn.x+=(1-Kt)*Tt.scale:Ck(fo)?Qn.x+=Ks-Un.height*Tt.scale+(-Kt-1)*Tt.scale:Qn.x+=Tt.imageName||Un.width+2*Kt===hr.w&&Un.height+2*Kt===hr.h?(Ks-ti)/2:(Ks-(Un.height+2*Kt)*Tt.scale)/2,ni=new _t(Qn.x,Qn.y-di),Kr=new _t(Qn.x+ti,Qn.y),hi=new _t(Qn.x+ti,Qn.y-di)}else{const Ji=(Un.left-Kt)*Tt.scale-bn+Sr[0],fa=(-Un.top-Kt)*Tt.scale+Sr[1],Ii=Ji+di,Pi=fa+ti;Qn=new _t(Ji,fa),ni=new _t(Ii,fa),Kr=new _t(Ji,Pi),hi=new _t(Ii,Pi)}if(He){let Ji;Ji=Ee?new _t(0,0):Rr?new _t(Ge[0],Ge[1]):new _t(ye[0],ye[1]),Qn._rotateAround(He,Ji),ni._rotateAround(He,Ji),Kr._rotateAround(He,Ji),hi._rotateAround(He,Ji)}const ho=new _t(0,0),po=new _t(0,0);Ue.push({tl:Qn,tr:ni,bl:Kr,br:hi,texPrimary:Qt,texSecondary:void 0,writingMode:de.writingMode,glyphOffset:_r,sectionIndex:Tt.sectionIndex,isSDF:ln,pixelOffsetTL:ho,pixelOffsetBR:po,minFontScaleX:0,minFontScaleY:0})}}return Ue}(0,c,M,d,g,S,f,l.allowVerticalPlacement),Q=l.textSizeData;let X=null;Q.kind==="source"?(X=[lu*d.layout.get("text-size").evaluate(S,{},V)*P.textScaleFactor],X[0]>tp&&$n(`${l.layerIds[0]}: Value for "text-size" is >= ${Fg}. Reduce your "text-size".`)):Q.kind==="composite"&&(X=[lu*P.compositeTextSizes[0].evaluate(S,{},V)*P.textScaleFactor,lu*P.compositeTextSizes[1].evaluate(S,{},V)*P.textScaleFactor],(X[0]>tp||X[1]>tp)&&$n(`${l.layerIds[0]}: Value for "text-size" is >= ${Fg}. Reduce your "text-size".`)),l.addSymbols(l.text,K,X,M,g,S,w,e,o,L.lineStartIndex,L.lineLength,C,D,V,q,!1);for(const re of A)R[re]=l.text.placedSymbolArray.length-1;return 4*K.length}function A2(l){for(const e in l)return l[e];return null}function Py(l,e,o,c,f,d,g,S,M,L,w=1){let A=g.top/w,R=g.bottom/w,C=g.left/w,P=g.right/w;const D=g.collisionPadding;if(D&&(C-=D[0],A-=D[1],P+=D[2],R+=D[3]),M){const V=new _t(C,A),q=new _t(P,A),K=new _t(C,R),Q=new _t(P,R),X=_n(M);let re=new _t(0,0);L&&(re=new _t(L[0],L[1])),V._rotateAround(X,re),q._rotateAround(X,re),K._rotateAround(X,re),Q._rotateAround(X,re),C=Math.min(V.x,q.x,K.x,Q.x),P=Math.max(V.x,q.x,K.x,Q.x),A=Math.min(V.y,q.y,K.y,Q.y),R=Math.max(V.y,q.y,K.y,Q.y)}return l.emplaceBack(e.x,e.y,e.z,o.x,o.y,C,A,P,R,S,c,f,d),l.length-1}function l0(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const e=l.bottom-l.top;return e>0?Math.max(10,e):null}function $k(l,e,o,c){const f=l.compareText;if(e in f){const d=f[e];for(let g=d.length-1;g>=0;g--)if(c.dist(d[g])<o)return!0}else f[e]=[];return f[e].push(c),!1}function P2(l,e){const o=l.fovAboveCenter,c=l.elevation?l.elevation.getMinElevationBelowMSL()*e:0,f=(l._camera.position[2]*l.worldSize-c)/Math.cos(l._pitch),d=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-l._pitch-o,.01));let g=Math.sin(l._pitch)*d+f;const S=f*(1/l._horizonShift);return l.elevation&&l.elevation.exaggeration()!==0||(g*=1+Math.max(l.zoom-17,0)),Math.min(1.01*g,S)}function Bg(l,e){if(!e.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:e};const o=Math.pow(2,-l.z),c=l.x*o,f=(l.x+1)*o,d=l.y*o,g=(l.y+1)*o,S=Is(c),M=Is(f),L=Ln(d),w=Ln(g),A=e.project(S,L),R=e.project(M,L),C=e.project(M,w),P=e.project(S,w);let D=Math.min(A.x,R.x,C.x,P.x),V=Math.min(A.y,R.y,C.y,P.y),q=Math.max(A.x,R.x,C.x,P.x),K=Math.max(A.y,R.y,C.y,P.y);const Q=o/16;function X(de,ye,Ce,Ee,Te,Be){const Ae=(Ce+Te)/2,Ue=(Ee+Be)/2,He=e.project(Is(Ae),Ln(Ue)),Ge=Math.max(0,D-He.x,V-He.y,He.x-q,He.y-K);D=Math.min(D,He.x),q=Math.max(q,He.x),V=Math.min(V,He.y),K=Math.max(K,He.y),Ge>Q&&(X(de,He,Ce,Ee,Ae,Ue),X(He,ye,Ae,Ue,Te,Be))}X(A,R,c,d,f,d),X(R,C,f,d,f,g),X(C,P,f,g,c,g),X(P,A,c,g,c,d),D-=Q,V-=Q,q+=Q,K+=Q;const re=1/Math.max(q-D,K-V);return{scale:re,x:D*re,y:V*re,x2:q*re,y2:K*re,projection:e}}function R2(l,{x:e,y:o},c=0){return new _t(((e-c)*l.scale-l.x)*tn,(o*l.scale-l.y)*tn)}const Vk=Le.mat4.identity(new Float32Array(16));class np{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,o){return{x:0,y:0,z:0}}unproject(e,o){return new Or(0,0)}projectTilePoint(e,o,c){return{x:e,y:o,z:0}}locationPoint(e,o,c=!0){return e._coordinatePoint(e.locationCoordinate(o),c)}pixelsPerMeter(e,o){return vi(1,e)*o}pixelSpaceConversion(e,o,c){return 1}farthestPixelDistance(e){return P2(e,e.pixelsPerMeter)}pointCoordinate(e,o,c,f){const d=e.horizonLineFromTop(!1),g=new _t(o,Math.max(d,c));return e.rayIntersectionCoordinate(e.pointRayIntersection(g,f))}pointCoordinate3D(e,o,c){const f=new _t(o,c);if(e.elevation)return e.elevation.pointCoordinate(f);{const d=this.pointCoordinate(e,f.x,f.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(e,o){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,o.x,o.y);const c=e.horizonLineFromTop();return o.y<c}createInversionMatrix(e,o){return Vk}createTileMatrix(e,o,c){let f,d,g;const S=c.canonical,M=Le.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const L=Bg(S,this);f=1,d=L.x+c.wrap*L.scale,g=L.y,Le.mat4.scale(M,M,[f/L.scale,f/L.scale,e.pixelsPerMeter/o])}else f=o/e.zoomScale(S.z),d=(S.x+Math.pow(2,S.z)*c.wrap)*f,g=S.y*f;return Le.mat4.translate(M,M,[d,g,0]),Le.mat4.scale(M,M,[f/tn,f/tn,1]),M}upVector(e,o,c){return[0,0,1]}upVectorScale(e,o,c){return{metersToTile:1}}}class Gk extends np{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[o,c]=this.parallels=e.parallels||[29.5,45.5],f=Math.sin(_n(o));this.n=(f+Math.sin(_n(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(e,o){const{n:c,c:f,r0:d}=this,g=_n(e-this.center[0]),S=_n(o),M=Math.sqrt(f-2*c*Math.sin(S))/c;return{x:M*Math.sin(g*c),y:M*Math.cos(g*c)-d,z:0}}unproject(e,o){const{n:c,c:f,r0:d}=this,g=d+o;let S=Math.atan2(e,Math.abs(g))*Math.sign(g);g*c<0&&(S-=Math.PI*Math.sign(e)*Math.sign(g));const M=_n(this.center[0])*c;S=sn(S,-Math.PI-M,Math.PI-M);const L=Dt(ir(S/c)+this.center[0],-180,180),w=Math.asin(Dt((f-(e*e+g*g)*c*c)/(2*c),-1,1)),A=Dt(ir(w),-85.051129,Fo);return new Or(L,A)}}const Ng=1.340264,jg=-.081106,Ug=893e-6,$g=.003796,Ry=Math.sqrt(3)/2;class qk extends np{project(e,o){o=o/180*Math.PI,e=e/180*Math.PI;const c=Math.asin(Ry*Math.sin(o)),f=c*c,d=f*f*f;return{x:.5*(e*Math.cos(c)/(Ry*(Ng+3*jg*f+d*(7*Ug+9*$g*f)))/Math.PI+.5),y:1-.5*(c*(Ng+jg*f+d*(Ug+$g*f))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=c*c,d=f*f*f;for(let w,A,R,C=0;C<12&&(A=c*(Ng+jg*f+d*(Ug+$g*f))-o,R=Ng+3*jg*f+d*(7*Ug+9*$g*f),w=A/R,c=Dt(c-w,-Math.PI/3,Math.PI/3),f=c*c,d=f*f*f,!(Math.abs(w)<1e-12));++C);const g=Ry*e*(Ng+3*jg*f+d*(7*Ug+9*$g*f))/Math.cos(c),S=Math.asin(Math.sin(c)/Ry),M=Dt(180*g/Math.PI,-180,180),L=Dt(180*S/Math.PI,-85.051129,Fo);return new Or(M,L)}}class Wk extends np{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){return{x:.5+e/360,y:.5-o/360,z:0}}unproject(e,o){const c=360*(e-.5),f=Dt(360*(.5-o),-85.051129,Fo);return new Or(c,f)}}const Cm=Math.PI/2;function ky(l){return Math.tan((Cm+l)/2)}class Hk extends np{constructor(e){super(e),this.center=e.center||[0,30];const[o,c]=this.parallels=e.parallels||[30,30];let f=_n(o),d=_n(c);this.southernCenter=f+d<0,this.southernCenter&&(f=-f,d=-d);const g=Math.cos(f),S=ky(f);this.n=f===d?Math.sin(f):Math.log(g/Math.cos(d))/Math.log(ky(d)/S),this.f=g*Math.pow(ky(f),this.n)/this.n}project(e,o){o=_n(o),this.southernCenter&&(o=-o),e=_n(e-this.center[0]);const c=1e-6,{n:f,f:d}=this;d>0?o<-Cm+c&&(o=-Cm+c):o>Cm-c&&(o=Cm-c);const g=d/Math.pow(ky(o),f);let S=g*Math.sin(f*e),M=d-g*Math.cos(f*e);return S=.5*(S/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:S,y:this.southernCenter?M:1-M,z:0}}unproject(e,o){e=(2*e-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f}=this,d=f-o,g=Math.sign(d),S=Math.sign(c)*Math.sqrt(e*e+d*d);let M=Math.atan2(e,Math.abs(d))*g;d*c<0&&(M-=Math.PI*Math.sign(e)*g);const L=Dt(ir(M/c)+this.center[0],-180,180),w=Dt(ir(2*Math.atan(Math.pow(f/S,1/c))-Cm),-85.051129,Fo);return new Or(L,this.southernCenter?-w:w)}}class k2 extends np{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,o){return{x:Ka(e),y:pa(o),z:0}}unproject(e,o){const c=Is(e),f=Ln(o);return new Or(c,f)}}const L2=_n(Fo);class Zk extends np{project(e,o){const c=(o=_n(o))*o,f=c*c;return{x:.5*((e=_n(e))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=25,d=0,g=c*c;do{g=c*c;const L=g*g;d=(c*(1.007226+g*(.015085+L*(.028874*g-.044475-.005916*L)))-o)/(1.007226+g*(.045255+L*(.259866*g-.311325-.005916*11*L))),c=Dt(c-d,-L2,L2)}while(Math.abs(d)>1e-6&&--f>0);g=c*c;const S=Dt(ir(e/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),M=ir(c);return new Or(S,M)}}const z2=_n(Fo);class Xk extends np{project(e,o){o=_n(o),e=_n(e);const c=Math.cos(o),f=2/Math.PI,d=Math.acos(c*Math.cos(e/2)),g=Math.sin(d)/d,S=.5*(e*f+2*c*Math.sin(e/2)/g)||0,M=.5*(o+Math.sin(o)/g)||0;return{x:.5*(S/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(e,o){let c=e=(2*e-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,d=25;const g=1e-6;let S=0,M=0;do{const L=Math.cos(f),w=Math.sin(f),A=2*w*L,R=w*w,C=L*L,P=Math.cos(c/2),D=Math.sin(c/2),V=2*P*D,q=D*D,K=1-C*P*P,Q=K?1/K:0,X=K?Math.acos(L*P)*Math.sqrt(1/K):0,re=.5*(2*X*L*D+2*c/Math.PI)-e,de=.5*(X*w+f)-o,ye=.5*Q*(C*q+X*L*P*R)+1/Math.PI,Ce=Q*(V*A/4-X*w*D),Ee=.125*Q*(A*D-X*w*C*V),Te=.5*Q*(R*P+X*q*L)+.5,Be=Ce*Ee-Te*ye;S=(de*Ce-re*Te)/Be,M=(re*Ee-de*ye)/Be,c=Dt(c-S,-Math.PI,Math.PI),f=Dt(f-M,-z2,z2)}while((Math.abs(S)>g||Math.abs(M)>g)&&--d>0);return new Or(ir(c),ir(f))}}class D2 extends np{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(_n(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){const{scale:c,cosPhi:f}=this;return{x:_n(e)*f*c+.5,y:-Math.sin(_n(o))/f*c+.5,z:0}}unproject(e,o){const{scale:c,cosPhi:f}=this,d=-(o-.5)/c,g=Dt(ir((e-.5)/c)/f,-180,180),S=Math.asin(Dt(d*f,-1,1)),M=Dt(ir(S),-85.051129,Fo);return new Or(g,M)}}class Yk extends k2{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,o,c){const f=Mr(e,o,c),d=ei(qi(c));return Le.vec3.transformMat4(f,f,d),{x:f[0],y:f[1],z:f[2]}}locationPoint(e,o){const c=mc(o.lat,o.lng),f=Le.vec3.normalize([],c),d=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(o),e._centerAltitude):e._centerAltitude,g=vi(1,0)*tn*d;Le.vec3.scaleAndAdd(c,c,f,g);const S=Le.mat4.identity(new Float64Array(16));return Le.mat4.multiply(S,e.pixelMatrix,e.globeMatrix),Le.vec3.transformMat4(c,c,S),new _t(c[0],c[1])}pixelsPerMeter(e,o){return vi(1,0)*o}pixelSpaceConversion(e,o,c){const f=vi(1,e)*o,d=Fn(vi(1,45)*o,f,c);return this.pixelsPerMeter(e,o)/d}createTileMatrix(e,o,c){const f=Ho(qi(c.canonical));return Le.mat4.multiply(new Float64Array(16),e.globeMatrix,f)}createInversionMatrix(e,o){const{center:c}=e,f=ei(qi(o));return Le.mat4.rotateY(f,f,_n(c.lng)),Le.mat4.rotateX(f,f,_n(c.lat)),Le.mat4.scale(f,f,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(e,o,c,f){return yi(e,o,c,!0)||new p(0,0)}pointCoordinate3D(e,o,c){const f=this.pointCoordinate(e,o,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(e,o){return!yi(e,o.x,o.y,!1)}farthestPixelDistance(e){const o=function(f,d){const g=f.cameraToCenterDistance,S=f._centerAltitude*d,M=f._camera,L=f._camera.forward(),w=Le.vec3.add([],Le.vec3.scale([],L,-g),[0,0,S]),A=f.worldSize/(2*Math.PI),R=[0,0,-A],C=f.width/f.height,P=Math.tan(f.fovAboveCenter),D=Le.vec3.scale([],M.up(),P),V=Le.vec3.scale([],M.right(),P*C),q=Le.vec3.normalize([],Le.vec3.add([],Le.vec3.add([],L,D),V)),K=[];let Q;if(new br(w,q).closestPointOnSphere(R,A,K)){const X=Le.vec3.add([],K,R),re=Le.vec3.sub([],X,w);Q=Math.cos(f.fovAboveCenter)*Le.vec3.length(re)}else{const X=Le.vec3.sub([],w,R),re=Le.vec3.sub([],R,w);Le.vec3.normalize(re,re);const de=Le.vec3.length(X)-A;Q=Math.sqrt(de*(de+2*A));const ye=Math.acos(Q/(A+de))-Math.acos(Le.vec3.dot(L,re));Q*=Math.cos(ye)}return 1.01*Q}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),c=is(e.zoom);if(c>0){const f=P2(e,vi(1,e.center.lat)*e.worldSize),d=e.worldSize/(2*Math.PI),g=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Fn(o,f+d*(1-Math.cos(g)),Math.pow(c,10))}return o}upVector(e,o,c){return Mr(o,c,e,1)}upVectorScale(e){return{metersToTile:Br(Ci(qi(e)))}}}function O2(l){const e=l.parallels,o=!!e&&Math.abs(e[0]+e[1])<.01;switch(l.name){case"mercator":return new k2(l);case"equirectangular":return new Wk(l);case"naturalEarth":return new Zk(l);case"equalEarth":return new qk(l);case"winkelTripel":return new Xk(l);case"albers":return o?new D2(l):new Gk(l);case"lambertConformalConic":return o?new D2(l):new Hk(l);case"globe":return new Yk(l)}throw new Error(`Invalid projection name: ${l.name}`)}const Kk=bm.VectorTileFeature.types,Jk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ly(l,e,o,c,f,d,g,S,M,L,w,A,R){const C=S?Math.min(tp,Math.round(S[0])):0,P=S?Math.min(tp,Math.round(S[1])):0;l.emplaceBack(e,o,Math.round(32*c),Math.round(32*f),d,g,(C<<1)+(M?1:0),P,16*L,16*w,256*A,256*R)}function zy(l,e,o){l.emplaceBack(e,o)}function Dy(l,e,o,c,f,d,g){l.emplaceBack(e,o,c,f,d,g)}function Oy(l,e,o,c,f){l.emplaceBack(e,o,c,f),l.emplaceBack(e,o,c,f),l.emplaceBack(e,o,c,f),l.emplaceBack(e,o,c,f)}function Qk(l){for(const e of l.sections)if(jp(e.text))return!0;return!1}class c0{constructor(e){this.layoutVertexArray=new Od,this.indexArray=new Po,this.programConfigurations=e,this.segments=new Ui,this.dynamicLayoutVertexArray=new ua,this.opacityVertexArray=new da,this.placedSymbolArray=new Wp,this.iconTransitioningVertexArray=new Ao,this.globeExtVertexArray=new Fd,this.zOffsetVertexArray=new Kc}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,o,c,f,d){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mk.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,_k.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Jk,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,vk.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,gk.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,yk.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}dn(c0,"SymbolBuffers");class u0{constructor(e,o,c){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Ui,this.collisionVertexArray=new $h,this.collisionVertexArrayExt=new ua}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,xk.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,bk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(u0,"CollisionBuffers");class Fy{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Le.mat4.identity([]),this.placementViewportMatrix=Le.mat4.identity([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jx(this.zoom,o["text-size"]),this.iconSizeData=Jx(this.zoom,o["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),d=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(g=>Rl[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new c0(new Al(this.layers,{zoom:this.zoom,lut:this.lut},e=>e.startsWith("text")||e.startsWith("symbol"))),this.icon=new c0(new Al(this.layers,{zoom:this.zoom,lut:this.lut},e=>e.startsWith("icon")||e.startsWith("symbol"))),this.glyphOffsetArray=new Ud,this.lineVertexArray=new Vu,this.symbolInstances=new Zp}calculateGlyphDependencies(e,o,c,f,d){for(const g of e){const S=g.codePointAt(0);if(S===void 0)break;if(o[S]=!0,f&&d&&S<=65535){const M=zg[g];M&&(o[M.charCodeAt(0)]=!0)}}}updateFootprints(e,o){}updateReplacement(e,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!qx(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}populate(e,o,c,f){const d=this.layers[0],g=d.layout,S=this.projection.name==="globe",M=g.get("text-font"),L=g.get("text-field"),w=g.get("icon-image"),[A,R]=g.get("icon-size-scale-range"),C=Dt(o.scaleFactor||1,A,R),P=(L.value.kind!=="constant"||L.value.value instanceof wo&&!L.value.value.isEmpty()||L.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),D=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,V=g.get("symbol-sort-key");if(this.features=[],!P&&!D)return;const q=o.iconDependencies,K=o.glyphDependencies,Q=o.availableImages,X=new Jr(this.zoom);for(const{feature:re,id:de,index:ye,sourceLayerIndex:Ce}of e){const Ee=d._featureFilter.needGeometry,Te=Z(re,Ee);if(!d._featureFilter.filter(X,Te,c))continue;if(Ee||(Te.geometry=W(re,c,f)),S&&re.type!==1&&c.z<=5){const Ge=Te.geometry,Ke=.98078528056,rt=(dt,Qe)=>{const wt=Mr(dt.x,dt.y,c,1),qt=Mr(Qe.x,Qe.y,c,1);return Le.vec3.dot(wt,qt)<Ke};for(let dt=0;dt<Ge.length;dt++)Ge[dt]=k(Ge[dt],rt)}let Be,Ae;if(P){const Ge=d.getValueAndResolveTokens("text-field",Te,c,Q),Ke=wo.factory(Ge);Qk(Ke)&&(this.hasRTLText=!0),(!this.hasRTLText||Wc()==="unavailable"||this.hasRTLText&&qs.isParsed())&&(Be=Tk(Ke,d,Te))}if(D){const Ge=d.getValueAndResolveTokens("icon-image",Te,c,Q);Ae=Ge instanceof lo?Ge:lo.build(Ge)}if(!Be&&!Ae)continue;const Ue=this.sortFeaturesByKey?V.evaluate(Te,{},c):void 0,He={id:de,text:Be,icon:Ae,index:ye,sourceLayerIndex:Ce,geometry:Te.geometry,properties:re.properties,type:Kk[re.type],sortKey:Ue};if(this.features.push(He),Ae){const Ge=wy(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],c,this.zoom,He)*C*this.pixelRatio,Ke=Ae.getPrimary().scaleSelf(Ge);if(q[Ke.id]=q[Ke.id]||[],q[Ke.id].push(Ke),Ae.nameSecondary){const rt=Ae.getSecondary().scaleSelf(Ge);q[rt.id]=q[rt.id]||[],q[rt.id].push(rt)}}if(Be){const Ge=M.evaluate(Te,{},c).join(","),Ke=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Rl.vertical)>=0;for(const rt of Be.sections)if(rt.image){const dt=rt.image.getPrimary().scaleSelf(this.pixelRatio);q[dt.id]=q[dt.id]||[],q[dt.id].push(dt)}else{const dt=Ld(Be.toString()),Qe=rt.fontStack||Ge,wt=K[Qe]=K[Qe]||{};this.calculateGlyphDependencies(rt.text,wt,Ke,this.allowVerticalPlacement,dt)}}}g.get("symbol-placement")==="line"&&(this.features=function(re){const de={},ye={},Ce=[];let Ee=0;function Te(He){Ce.push(re[He]),Ee++}function Be(He,Ge,Ke){const rt=ye[He];return delete ye[He],ye[Ge]=rt,Ce[rt].geometry[0].pop(),Ce[rt].geometry[0]=Ce[rt].geometry[0].concat(Ke[0]),rt}function Ae(He,Ge,Ke){const rt=de[Ge];return delete de[Ge],de[He]=rt,Ce[rt].geometry[0].shift(),Ce[rt].geometry[0]=Ke[0].concat(Ce[rt].geometry[0]),rt}function Ue(He,Ge,Ke){const rt=Ke?Ge[0][Ge[0].length-1]:Ge[0][0];return`${He}:${rt.x}:${rt.y}`}for(let He=0;He<re.length;He++){const Ge=re[He],Ke=Ge.geometry,rt=Ge.text?Ge.text.toString():null;if(!rt){Te(He);continue}const dt=Ue(rt,Ke),Qe=Ue(rt,Ke,!0);if(dt in ye&&Qe in de&&ye[dt]!==de[Qe]){const wt=Ae(dt,Qe,Ke),qt=Be(dt,Qe,Ce[wt].geometry);delete de[dt],delete ye[Qe],ye[Ue(rt,Ce[qt].geometry,!0)]=qt,Ce[wt].geometry=null}else dt in ye?Be(dt,Qe,Ke):Qe in de?Ae(dt,Qe,Ke):(Te(He),de[dt]=Ee-1,ye[Qe]=Ee-1)}return Ce.filter(He=>He.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((re,de)=>re.sortKey-de.sortKey)}update(e,o,c,f,d,g,S){this.text.programConfigurations.updatePaintArrays(e,o,d,c,f,g,S),this.icon.programConfigurations.updatePaintArrays(e,o,d,c,f,g,S)}updateZOffset(){const e=(d,g,S)=>{c+=g,c>d.length&&d.resize(c);for(let M=-g;M<0;M++)d.emplace(M+c,S)},o=(d,g,S)=>{f+=g,f>d.length&&d.resize(f);for(let M=-g;M<0;M++)d.emplace(M+f,S)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,f=0;for(let d=0;d<this.symbolInstances.length;d++){const g=this.symbolInstances.get(d),{numHorizontalGlyphVertices:S,numVerticalGlyphVertices:M,numIconVertices:L}=g,w=g.zOffset,A=L>0;if((S>0||M>0)&&(e(this.text.zOffsetVertexArray,S,w),e(this.text.zOffsetVertexArray,M,w)),A){const{placedIconSymbolIndex:R,verticalPlacedIconSymbolIndex:C}=g;R>=0&&o(this.icon.zOffsetVertexArray,L,w),C>=0&&o(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=O2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const c=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:f,y:d}of o)this.lineVertexArray.emplaceBack(f,d);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,o,c,f,d,g,S,M,L,w,A,R,C,P,D,V){const q=e.indexArray,K=e.layoutVertexArray,Q=e.globeExtVertexArray,X=e.segments.prepareSegment(4*o.length,K,q,this.canOverlap?g.sortKey:void 0),re=this.glyphOffsetArray.length,de=X.vertexLength,ye=this.allowVerticalPlacement&&S===Rl.vertical?Math.PI/2:0,Ce=g.text&&g.text.sections;for(let Te=0;Te<o.length;Te++){const{tl:Be,tr:Ae,bl:Ue,br:He,texPrimary:Ge,texSecondary:Ke,pixelOffsetTL:rt,pixelOffsetBR:dt,minFontScaleX:Qe,minFontScaleY:wt,glyphOffset:qt,isSDF:Tt,sectionIndex:Qt}=o[Te],Kt=X.vertexLength,ln=qt[1];if(Ly(K,L.x,L.y,Be.x,ln+Be.y,Ge.x,Ge.y,c,Tt,rt.x,rt.y,Qe,wt),Ly(K,L.x,L.y,Ae.x,ln+Ae.y,Ge.x+Ge.w,Ge.y,c,Tt,dt.x,rt.y,Qe,wt),Ly(K,L.x,L.y,Ue.x,ln+Ue.y,Ge.x,Ge.y+Ge.h,c,Tt,rt.x,dt.y,Qe,wt),Ly(K,L.x,L.y,He.x,ln+He.y,Ge.x+Ge.w,Ge.y+Ge.h,c,Tt,dt.x,dt.y,Qe,wt),M){const{x:Pt,y:En,z:en}=M.anchor,[bn,Un,hr]=M.up;Dy(Q,Pt,En,en,bn,Un,hr),Dy(Q,Pt,En,en,bn,Un,hr),Dy(Q,Pt,En,en,bn,Un,hr),Dy(Q,Pt,En,en,bn,Un,hr),Oy(e.dynamicLayoutVertexArray,Pt,En,en,ye)}else Oy(e.dynamicLayoutVertexArray,L.x,L.y,L.z,ye);if(V){const Pt=Ke||Ge;zy(e.iconTransitioningVertexArray,Pt.x,Pt.y),zy(e.iconTransitioningVertexArray,Pt.x+Pt.w,Pt.y),zy(e.iconTransitioningVertexArray,Pt.x,Pt.y+Pt.h),zy(e.iconTransitioningVertexArray,Pt.x+Pt.w,Pt.y+Pt.h)}q.emplaceBack(Kt,Kt+1,Kt+2),q.emplaceBack(Kt+1,Kt+2,Kt+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qt[0]),Te!==o.length-1&&Qt===o[Te+1].sectionIndex||e.programConfigurations.populatePaintArrays(K.length,g,g.index,{},C,P,D,Ce&&Ce[Qt])}const Ee=M?M.anchor:L;e.placedSymbolArray.emplaceBack(Ee.x,Ee.y,Ee.z,L.x,L.y,re,this.glyphOffsetArray.length-re,de,w,A,L.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],S,0,!1,0,R,0)}_commitLayoutVertex(e,o,c,f,d,g,S){e.emplaceBack(o,c,f,d,g,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(e,o,c,f,d,g,S){const M=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),L=M.vertexLength,w=S.tileAnchorX,A=S.tileAnchorY;for(let C=0;C<4;C++)c.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,o,e.padding,S.zOffset),this._commitLayoutVertex(c.layoutVertexArray,f,d,g,w,A,new _t(e.x1,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,d,g,w,A,new _t(e.x2,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,d,g,w,A,new _t(e.x2,e.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,d,g,w,A,new _t(e.x1,e.y2)),M.vertexLength+=4;const R=c.indexArray;R.emplaceBack(L,L+1),R.emplaceBack(L+1,L+2),R.emplaceBack(L+2,L+3),R.emplaceBack(L+3,L),M.primitiveLength+=4}_addTextDebugCollisionBoxes(e,o,c,f,d,g){for(let S=f;S<d;S++){const M=c.get(S),L=this.getSymbolInstanceTextSize(e,g,o,S);this._addCollisionDebugVertices(M,L,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,o,c,f,d,g){for(let S=f;S<d;S++){const M=c.get(S),L=this.getSymbolInstanceIconSize(e,o,g.placedIconSymbolIndex);this._addCollisionDebugVertices(M,L,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,o,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new u0(ju,i2.members,Ao),this.iconCollisionBox=new u0(ju,i2.members,Ao);const f=wm(this.iconSizeData,e),d=wm(this.textSizeData,e,c);for(let g=0;g<this.symbolInstances.length;g++){const S=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(d,e,o,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(d,e,o,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,e,o,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(f,e,o,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(e,o,c,f){const d=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),g=Sy(this.textSizeData,e,d)/ys;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,o,c){const f=this.icon.placedSymbolArray.get(c),d=Sy(this.iconSizeData,e,f);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(e,o,c,f){e.emplaceBack(o,-c,-c,f),e.emplaceBack(o,c,-c,f),e.emplaceBack(o,c,c,f),e.emplaceBack(o,-c,c,f)}_updateTextDebugCollisionBoxes(e,o,c,f,d,g,S){for(let M=f;M<d;M++){const L=c.get(M),w=this.getSymbolInstanceTextSize(e,g,o,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,L.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(e,o,c,f,d,g,S){for(let M=f;M<d;M++){const L=c.get(M),w=this.getSymbolInstanceIconSize(e,o,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,L.padding,g.zOffset)}}updateCollisionDebugBuffers(e,o,c,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=wm(this.iconSizeData,e,f),g=wm(this.textSizeData,e,c);for(let S=0;S<this.symbolInstances.length;S++){const M=this.symbolInstances.get(S);this._updateTextDebugCollisionBoxes(g,e,o,M.textBoxStartIndex,M.textBoxEndIndex,M,c),this._updateTextDebugCollisionBoxes(g,e,o,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M,c),this._updateIconDebugCollisionBoxes(d,e,o,M.iconBoxStartIndex,M.iconBoxEndIndex,M,f),this._updateIconDebugCollisionBoxes(d,e,o,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,o,c,f,d,g,S,M,L){const w={};if(o<c){const{x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X,featureIndex:re}=e.get(o);w.textBox={x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X},w.textFeatureIndex=re}if(f<d){const{x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X,featureIndex:re}=e.get(f);w.verticalTextBox={x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X},w.verticalTextFeatureIndex=re}if(g<S){const{x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X,featureIndex:re}=e.get(g);w.iconBox={x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X},w.iconFeatureIndex=re}if(M<L){const{x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X,featureIndex:re}=e.get(M);w.verticalIconBox={x1:A,y1:R,x2:C,y2:P,padding:D,projectedAnchorX:V,projectedAnchorY:q,projectedAnchorZ:K,tileAnchorX:Q,tileAnchorY:X},w.verticalIconFeatureIndex=re}return w}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,o){const c=e.placedSymbolArray.get(o),f=c.vertexStartIndex+4*c.numGlyphs;for(let d=c.vertexStartIndex;d<f;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(e),c=Math.cos(e),f=[],d=[],g=[];for(let S=0;S<this.symbolInstances.length;++S){g.push(S);const M=this.symbolInstances.get(S);f.push(0|Math.round(o*M.tileAnchorX+c*M.tileAnchorY)),d.push(M.featureIndex)}return g.sort((S,M)=>f[S]-f[M]||d[M]-d[S]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:S,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:L}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),d>=0&&d!==f&&this.addIndicesForPlacedSymbol(this.text,d),g>=0&&g!==d&&g!==f&&this.addIndicesForPlacedSymbol(this.text,g),S>=0&&this.addIndicesForPlacedSymbol(this.text,S),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),L>=0&&this.addIndicesForPlacedSymbol(this.icon,L)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let F2,B2,d0;dn(Fy,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Fy.addDynamicAttributes=Oy;class N2{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Lc,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(N2,"FormatSectionOverride",{omit:["defaultValue"]});const h0=()=>d0||(d0={layout:F2||(F2=new bi({"symbol-placement":new Wt(ft.layout_symbol["symbol-placement"]),"symbol-spacing":new Wt(ft.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wt(ft.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nn(ft.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wt(ft.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Wt(ft.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Wt(ft.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Wt(ft.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Wt(ft.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wt(ft.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wt(ft.layout_symbol["icon-rotation-alignment"]),"icon-size":new nn(ft.layout_symbol["icon-size"]),"icon-size-scale-range":new Wt(ft.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new nn(ft.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nn(ft.layout_symbol["icon-text-fit-padding"]),"icon-image":new nn(ft.layout_symbol["icon-image"]),"icon-rotate":new nn(ft.layout_symbol["icon-rotate"]),"icon-padding":new Wt(ft.layout_symbol["icon-padding"]),"icon-keep-upright":new Wt(ft.layout_symbol["icon-keep-upright"]),"icon-offset":new nn(ft.layout_symbol["icon-offset"]),"icon-anchor":new nn(ft.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wt(ft.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wt(ft.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wt(ft.layout_symbol["text-rotation-alignment"]),"text-field":new nn(ft.layout_symbol["text-field"]),"text-font":new nn(ft.layout_symbol["text-font"]),"text-size":new nn(ft.layout_symbol["text-size"]),"text-size-scale-range":new Wt(ft.layout_symbol["text-size-scale-range"]),"text-max-width":new nn(ft.layout_symbol["text-max-width"]),"text-line-height":new nn(ft.layout_symbol["text-line-height"]),"text-letter-spacing":new nn(ft.layout_symbol["text-letter-spacing"]),"text-justify":new nn(ft.layout_symbol["text-justify"]),"text-radial-offset":new nn(ft.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wt(ft.layout_symbol["text-variable-anchor"]),"text-anchor":new nn(ft.layout_symbol["text-anchor"]),"text-max-angle":new Wt(ft.layout_symbol["text-max-angle"]),"text-writing-mode":new Wt(ft.layout_symbol["text-writing-mode"]),"text-rotate":new nn(ft.layout_symbol["text-rotate"]),"text-padding":new Wt(ft.layout_symbol["text-padding"]),"text-keep-upright":new Wt(ft.layout_symbol["text-keep-upright"]),"text-transform":new nn(ft.layout_symbol["text-transform"]),"text-offset":new nn(ft.layout_symbol["text-offset"]),"text-allow-overlap":new Wt(ft.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Wt(ft.layout_symbol["text-ignore-placement"]),"text-optional":new Wt(ft.layout_symbol["text-optional"]),visibility:new Wt(ft.layout_symbol.visibility)})),paint:B2||(B2=new bi({"icon-opacity":new nn(ft.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new nn(ft.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new nn(ft.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new nn(ft.paint_symbol["text-emissive-strength"]),"icon-color":new nn(ft.paint_symbol["icon-color"]),"icon-halo-color":new nn(ft.paint_symbol["icon-halo-color"]),"icon-halo-width":new nn(ft.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nn(ft.paint_symbol["icon-halo-blur"]),"icon-translate":new Wt(ft.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wt(ft.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new nn(ft.paint_symbol["icon-image-cross-fade"]),"text-opacity":new nn(ft.paint_symbol["text-opacity"]),"text-occlusion-opacity":new nn(ft.paint_symbol["text-occlusion-opacity"]),"text-color":new nn(ft.paint_symbol["text-color"],{runtimeType:Uo,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new nn(ft.paint_symbol["text-halo-color"]),"text-halo-width":new nn(ft.paint_symbol["text-halo-width"]),"text-halo-blur":new nn(ft.paint_symbol["text-halo-blur"]),"text-translate":new Wt(ft.paint_symbol["text-translate"]),"text-translate-anchor":new Wt(ft.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Wt(ft.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Wt(ft.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Wt(ft.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Wt(ft.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new nn(ft.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},d0);class By extends Qr{constructor(e,o,c,f){super(e,h0(),o,c,f),this._colorAdjustmentMatrix=Le.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=e.paint!==void 0&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,o){super.recalculate(e,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const d of c)f.indexOf(d)<0&&f.push(d);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,o,c,f){return this._saturation===e&&this._contrast===o&&this._brightnessMin===c&&this._brightnessMax===f||(this._colorAdjustmentMatrix=function(d,g,S,M){d=be(d),g=ge(g);const L=Le.mat4.create(),w=d/3,A=1-2*w,R=[A,w,w,0,w,A,w,0,w,w,A,0,0,0,0,1],C=.5-.5*g,P=M-S;return Le.mat4.multiply(L,[P,0,0,0,0,P,0,0,0,0,P,0,S,S,S,1],[g,0,0,0,0,g,0,0,0,0,g,0,C,C,C,1]),Le.mat4.multiply(L,L,R),L}(e,o,c,f),this._saturation=e,this._contrast=o,this._brightnessMin=c,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,o,c,f){const d=this.layout.get(e).evaluate(o,{},c,f),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||kd(g.value)||!d?d:function(S,M){return M.replace(/{([^{}]+)}/g,(L,w)=>w in S?String(S[w]):"")}(o.properties,d)}createBucket(e){return new Fy(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of h0().paint.overridableProperties){if(!By.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),c=new N2(o),f=new zu(c,o.property.specification,this.scope,this.options);let d=null;d=o.value.kind==="constant"||o.value.kind==="source"?new Du("source",f):new rc("composite",f,o.value.zoomStops,o.value._interpolationType),this.paint._values[e]=new ac(o.property,d,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&By.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const c=e.get("text-field"),f=h0().paint.properties[o];let d=!1;const g=S=>{for(const M of S)if(f.overrides&&f.overrides.hasOverride(M))return void(d=!0)};if(c.value.kind==="constant"&&c.value.value instanceof wo)g(c.value.value.sections);else if(c.value.kind==="source"){const S=L=>{d||(L instanceof $o&&gi(L.value)===Ns?g(L.value.sections):L instanceof ga?g(L.sections):L.eachChild(S))},M=c.value;M._styleExpression&&S(M._styleExpression.expression)}return d}getProgramIds(){return["symbol"]}getDefaultProgramParams(e,o,c){return{config:new Il(this,{zoom:o,lut:c}),overrideFog:!1}}}let j2,U2,$2,V2;var p0=Dr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function f0(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function m0(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class g0{constructor(e,o,c,f){this.context=e,this.format=c,this.useMipmap=f&&f.useMipmap,this.texture=e.gl.createTexture(),this.update(o,{premultiply:f&&f.premultiply})}update(e,o){const c=e&&e instanceof HTMLVideoElement&&e.width===0?e.videoWidth:e.width,f=e&&e instanceof HTMLVideoElement&&e.height===0?e.videoHeight:e.height,{context:d}=this,{gl:g}=d,{x:S,y:M}=o&&o.position?o.position:{x:0,y:0},L=S+c,w=M+f;!this.size||this.size[0]===L&&this.size[1]===w||(g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(this.texture),this.texture=g.createTexture(),this.size=null),g.bindTexture(g.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA8&&(!o||o.premultiply!==!1));const A=e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap;if(!this.size&&L>0&&w>0){const R=this.useMipmap?Math.floor(Math.log2(Math.max(L,w)))+1:1;g.texStorage2D(g.TEXTURE_2D,R,this.format,L,w),this.size=[L,w]}if(this.size)if(A)g.texSubImage2D(g.TEXTURE_2D,0,S,M,f0(this.format),m0(this.format),e);else{const R=e.data;R&&g.texSubImage2D(g.TEXTURE_2D,0,S,M,c,f,f0(this.format),m0(this.format),R)}this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(e,o,c=!1){const{context:f}=this,{gl:d}=f;d.bindTexture(d.TEXTURE_2D,this.texture),e!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!c?e===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(e,o,c,f){const{context:d}=this,{gl:g}=d;g.bindTexture(g.TEXTURE_2D,this.texture),o!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,o),this.magFilter=o),e!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?e===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),c!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,c),this.wrapS=c),f!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,f),this.wrapT=f)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Ny{constructor(e,o){this.context=e,this.texture=o}bind(e,o){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),e!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,e),this.minFilter=e),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}}function jy(l,e,o,c,f,d,g,S){const M=[l,e,1,o,c,1,f,d,1],L=[g,S,1],w=Le.mat3.adjoint([],M),[A,R,C]=Le.vec3.transformMat3(L,L,w);return Le.mat3.multiply(M,M,[A,0,0,0,R,0,0,0,C])}function G2(l,e,o,c,f,d,g,S){const M=function(L,w,A,R,C,P,D,V){const q=jy(0,0,1,0,1,1,0,1),K=jy(L,w,A,R,C,P,D,V),Q=Le.mat3.adjoint([],q);return Le.mat3.multiply(K,K,Q)}(l,e,o,c,f,d,g,S);return[M[2]/M[8]/tn,M[5]/M[8]/tn]}function Uy(l){return[l[0],Math.min(Math.max(l[1],-85.051129),Fo)]}class q2 extends kc{constructor(e,o,c,f){super(),this.id=e,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=o,this._dirty=!1}load(e,o){if(this._loaded=o||!1,this.fire(new ri("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=Pc(this.map._requestManager.transformRequest(this.url,Ko.Image),(c,f)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new ul(c)):f&&(this.image=f instanceof HTMLImageElement?un.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Ny(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ri("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Ny||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=e[0][1],c=e[0][1];for(const d of e)d[1]>c&&(c=d[1]),d[1]<o&&(o=d[1]);const f=(c+o)/2;if(f>Fo?this.onNorthPole=!0:f<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=e.map(p.fromLngLat);this.tileID=function(g){let S=1/0,M=1/0,L=-1/0,w=-1/0;for(const D of g)S=Math.min(S,D.x),M=Math.min(M,D.y),L=Math.max(L,D.x),w=Math.max(w,D.y);const A=Math.max(L-S,w-M),R=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),C=Math.pow(2,R);let P=Math.floor((S+L)/2*C);return P>1&&(P-=1),new Ct(R,P,Math.floor((M+w)/2*C))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new ri("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const q in this.tiles){const K=this.tiles[q];K.state!=="loaded"&&(K.state="loaded",K.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Bg(new Ct(0,0,0),this.map.transform.projection),c=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(q){const K=q[1].x-q[0].x,Q=q[1].y-q[0].y,X=q[2].x-q[1].x,re=q[2].y-q[1].y,de=q[3].x-q[2].x,ye=q[3].y-q[2].y,Ce=q[0].x-q[3].x,Ee=q[0].y-q[3].y,Te=K*re-X*Q,Be=X*ye-de*re,Ae=de*Ee-Ce*ye,Ue=Ce*Q-K*Ee;return Te>0&&Be>0&&Ae>0&&Ue>0||Te<0&&Be<0&&Ae<0&&Ue<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=Bg(this.tileID,this.map.transform.projection),[d,g,S,M]=this.coordinates.map(q=>{const K=f.projection.project(q[0],q[1]);return R2(f,K)._round()});this.perspectiveTransform=G2(d.x,d.y,g.x,g.y,S.x,S.y,M.x,M.y);const L=this._boundsArray=new ji;L.emplaceBack(d.x,d.y,0,0),L.emplaceBack(g.x,g.y,tn,0),L.emplaceBack(M.x,M.y,0,tn),L.emplaceBack(S.x,S.y,tn,tn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(L,p0.members),this.boundsSegments=Ui.simpleSegment(0,0,4,2);const w=[],A=[Uy((R=this.coordinates)[0]),Uy(R[1]),Uy(R[2]),Uy(R[3])];var R;const[C,P,D,V]=function(q){let K=q[0][0],Q=K,X=q[0][1],re=X;for(let de=1;de<q.length;de++)q[de][0]<K?K=q[de][0]:q[de][0]>Q&&(Q=q[de][0]),q[de][1]<X?X=q[de][1]:q[de][1]>re&&(re=q[de][1]);return[K,X,Q-K,re-X]}(A);{const q=new ji,[K,Q,X,re]=function(rt){let dt=rt[0].x,Qe=dt,wt=rt[0].y,qt=wt;for(let Tt=1;Tt<rt.length;Tt++)rt[Tt].x<dt?dt=rt[Tt].x:rt[Tt].x>Qe&&(Qe=rt[Tt].x),rt[Tt].y<wt?wt=rt[Tt].y:rt[Tt].y>qt&&(qt=rt[Tt].y);return[dt,wt,Qe-dt,qt-wt]}(c),de=rt=>[(rt.x-K)/X,(rt.y-Q)/re],[ye,Ce,Ee,Te]=c.map(de),Be=function(rt,dt,Qe,wt,qt,Tt,Qt,Kt){const ln=jy(0,0,1,0,1,1,0,1),Pt=jy(rt,dt,Qe,wt,qt,Tt,Qt,Kt),En=Le.mat3.adjoint([],Pt);return Le.mat3.multiply(ln,ln,En)}(ye[0],ye[1],Ce[0],Ce[1],Ee[0],Ee[1],Te[0],Te[1]);this.elevatedGlobePerspectiveTransform=G2(ye[0],ye[1],Ce[0],Ce[1],Ee[0],Ee[1],Te[0],Te[1]);const Ae=(rt,dt)=>{w.push(rt.lng);const Qe=Math.round((rt.lng-C)/D*tn),wt=Math.round((rt.lat-P)/V*tn),qt=de(dt),Tt=Le.vec3.transformMat3([],[qt[0],qt[1],1],Be),Qt=Math.round(Tt[0]/Tt[2]*tn),Kt=Math.round(Tt[1]/Tt[2]*tn);q.emplaceBack(Qe,wt,Qt,Kt)},Ue=c[3].x-c[0].x,He=c[3].y-c[0].y,Ge=c[2].x-c[1].x,Ke=c[2].y-c[1].y;for(let rt=0;rt<65;rt++){const dt=rt/64,Qe=[c[0].x+dt*Ue,c[0].y+dt*He],wt=[c[1].x+dt*Ge,c[1].y+dt*Ke],qt=wt[0]-Qe[0],Tt=wt[1]-Qe[1];for(let Qt=0;Qt<65;Qt++){const Kt=Qt/64,ln={x:Qe[0]+qt*Kt,y:Qe[1]+Tt*Kt,z:0};Ae(o.projection.unproject(ln.x,ln.y),ln)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(q,p0.members)}{this.maxLongitudeTriangleSize=0;let q=[],K=new Po;const Q=(X,re,de)=>{K.emplaceBack(X,re,de);const ye=w[X],Ce=w[re],Ee=w[de],Te=Math.min(Math.min(ye,Ce),Ee),Be=Math.max(Math.max(ye,Ce),Ee)-Te;Be>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Be),q.push(Te+Be/2)};for(let X=0;X<64;X++)for(let re=0;re<64;re++){const de=65*X+re,ye=de+1,Ce=de+65,Ee=Ce+1;Q(de,Ce,ye),Q(ye,Ce,Ee)}[q,K]=function(X,re){const de=Array.from({length:X.length},(Ee,Te)=>Te);de.sort((Ee,Te)=>X[Ee]-X[Te]);const ye=[],Ce=new Po;for(let Ee=0;Ee<de.length;Ee++){const Te=de[Ee];ye.push(X[Te]);const Be=3*Te,Ae=Be+1;Ce.emplaceBack(re.uint16[Be],re.uint16[Ae],re.uint16[Ae+1])}return[ye,Ce]}(q,K),this.elevatedGlobeTrianglesCenterLongitudes=q,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(K)}this.elevatedGlobeSegments=Ui.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,D/tn,0,V/tn,0,0,P,C,0])}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const o=this.map.painter.context,c=o.gl;!this._dirty||this.texture instanceof Ny||(this.texture?this.texture.update(this.image):(this.texture=new g0(o,this.image,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(o)}loadTile(e,o){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},o(null)):(e.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let f=(d=e+180)+360*Math.round((c[0]-d)/360);var d;const g=new Ui,S=(A,R)=>{g.segments.push({vertexOffset:0,primitiveOffset:A,vertexLength:o.segments[0].vertexLength,primitiveLength:R,sortKey:void 0,vaos:{}})},M=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-f)<=M){const A=ht(c,0,c.length,f+M);return A===c.length||S(A,Do(c,A+1,c.length,f+360-M)-A),g}f<c[0]&&(f+=360);const L=Do(c,0,c.length,f-M);if(L===c.length)return S(0,c.length),g;S(0,L-0);const w=ht(c,L+1,c.length,f+M);return w!==c.length&&S(w,c.length-w),g}}const eL=(Math.pow(256,2)-1)/16907520;class W2 extends Qr{constructor(e,o,c,f){super(e,{layout:$2||($2=new bi({visibility:new Wt(ft.layout_raster.visibility)})),paint:V2||(V2=new bi({"raster-opacity":new Wt(ft.paint_raster["raster-opacity"]),"raster-color":new Es(ft.paint_raster["raster-color"]),"raster-color-mix":new Wt(ft.paint_raster["raster-color-mix"]),"raster-color-range":new Wt(ft.paint_raster["raster-color-range"]),"raster-hue-rotate":new Wt(ft.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wt(ft.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wt(ft.paint_raster["raster-brightness-max"]),"raster-saturation":new Wt(ft.paint_raster["raster-saturation"]),"raster-contrast":new Wt(ft.paint_raster["raster-contrast"]),"raster-resampling":new Wt(ft.paint_raster["raster-resampling"]),"raster-fade-duration":new Wt(ft.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Wt(ft.paint_raster["raster-emissive-strength"]),"raster-array-band":new Wt(ft.paint_raster["raster-array-band"]),"raster-elevation":new Wt(ft.paint_raster["raster-elevation"]),"raster-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof q2&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[c,f]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(f)||c===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=Jh({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,f])}}let H2,Z2,X2,Y2,K2;class J2 extends Qr{constructor(e,o,c,f){super(e,{layout:H2||(H2=new bi({visibility:new Wt(ft["layout_raster-particle"].visibility)})),paint:Z2||(Z2=new bi({"raster-particle-array-band":new Wt(ft["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Wt(ft["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Es(ft["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Wt(ft["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Wt(ft["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Wt(ft["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Wt(ft["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Wt(ft["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},o,c,f),this._updateColorRamp(),this.lastInvalidatedAt=un.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Jh({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=un.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class tL extends Qr{constructor(e,o){super(e,{},o,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}function _0(l,e,o){const c=[0,0,1],f=Le.quat.identity([]);return Le.quat.rotateY(f,f,o?-_n(l)+Math.PI:_n(l)),Le.quat.rotateX(f,f,-_n(e)),Le.vec3.transformQuat(c,c,f),Le.vec3.normalize(c,c)}function Q2(l,e){const o=$y(l.projection,l.zoom,l.width,l.height),c=function(d,g,S,M,L){const w=new Or(S.lng-180*rp,S.lat),A=new Or(S.lng+180*rp,S.lat),R=d.project(w.lng,w.lat),C=d.project(A.lng,A.lat),P=-Math.atan2(C.y-R.y,C.x-R.x),D=p.fromLngLat(S);D.y=Dt(D.y,-1+rp,1-rp);const V=D.toLngLat(),q=d.project(V.lng,V.lat),K=p.fromLngLat(V);K.x+=rp;const Q=K.toLngLat(),X=d.project(Q.lng,Q.lat),re=tT(X.x-q.x,X.y-q.y,P),de=p.fromLngLat(V);de.y+=rp;const ye=de.toLngLat(),Ce=d.project(ye.lng,ye.lat),Ee=tT(Ce.x-q.x,Ce.y-q.y,P),Te=Math.abs(re.x)/Math.abs(Ee.y),Be=Le.mat4.identity([]);Le.mat4.rotateZ(Be,Be,-P*(1-(L?0:M)));const Ae=Le.mat4.identity([]);return Le.mat4.scale(Ae,Ae,[1,1-(1-Te)*M,1]),Ae[4]=-Ee.x/Ee.y*M,Le.mat4.rotateZ(Ae,Ae,P),Le.mat4.multiply(Ae,Be,Ae),Ae}(l.projection,0,l.center,o,e),f=eT(l);return Le.mat4.scale(c,c,[f,f,1]),c}function eT(l){const e=l.projection,o=$y(l.projection,l.zoom,l.width,l.height),c=y0(e,l.center),f=y0(e,Or.convert(e.center));return Math.pow(2,c*o+(1-o)*f)}function $y(l,e,o,c,f=1/0){const d=l.range;if(!d)return 0;const g=Math.min(f,Math.max(o,c)),S=Math.log(g/1024)/Math.LN2;return Ft(d[0]+S,d[1]+S,e)}const rp=1/4e4;function y0(l,e){const o=Dt(e.lat,-85.051129,Fo),c=new Or(e.lng-180*rp,o),f=new Or(e.lng+180*rp,o),d=l.project(c.lng,o),g=l.project(f.lng,o),S=p.fromLngLat(c),M=p.fromLngLat(f),L=g.x-d.x,w=g.y-d.y,A=M.x-S.x,R=M.y-S.y,C=Math.sqrt((A*A+R*R)/(L*L+w*w));return Math.log(C)/Math.LN2}function tT(l,e,o){const c=Math.cos(o),f=Math.sin(o);return{x:l*c-e*f,y:l*f+e*c}}function nT(l,e,o){Le.mat4.identity(l),Le.mat4.rotateZ(l,l,_n(e[2])),Le.mat4.rotateX(l,l,_n(e[0])),Le.mat4.rotateY(l,l,_n(e[1])),Le.mat4.scale(l,l,o),Le.mat4.multiply(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Vy(l,e,o,c,f,d,g,S){const M=[o[0]-e[0],o[1]-e[1],0],L=[c[0]-e[0],c[1]-e[1],0];if(Le.vec3.length(M)<1e-12||Le.vec3.length(L)<1e-12)return Le.quat.identity(l);const w=Le.vec3.cross([],M,L);Le.vec3.normalize(w,w),Le.vec3.subtract(L,c,e),M[2]=(d-f)*S,L[2]=(g-f)*S;const A=M;return Le.vec3.cross(A,M,L),Le.vec3.normalize(A,A),Le.quat.rotationTo(l,w,A)}function v0(l,e,o=!1){const c=is(e.zoom),f=function(d,g,S){const M=g.worldSize,L=[d[12],d[13],d[14]],w=Ln(L[1]/M),A=Is(L[0]/M),R=Le.mat4.identity([]),C=vi(1,w)*M,P=vi(1,0)*M*h(w,g.zoom),D=1/As(M);let V=P*D;if(S){const X=$y(g.projection,g.zoom,g.width,g.height,1024);V=D*g.projection.pixelSpaceConversion(g.center.lat,M,X)}const q=mc(w,A);Le.vec3.add(q,q,Le.vec3.scale([],Le.vec3.normalize([],q),C*V*L[2]));const K=function(X){const re=[X[0],X[1],X[2]];let de=[0,1,0];const ye=Le.vec3.cross([],de,re);return Le.vec3.cross(de,re,ye),Le.vec3.squaredLength(de)===0&&(de=[0,1,0],Le.vec3.cross(ye,re,de)),Le.vec3.normalize(ye,ye),Le.vec3.normalize(de,de),Le.vec3.normalize(re,re),[ye[0],ye[1],ye[2],0,de[0],de[1],de[2],0,re[0],re[1],re[2],0,X[0],X[1],X[2],1]}(q);Le.mat4.scale(R,R,[V,V,V*C]),Le.mat4.translate(R,R,[-L[0],-L[1],-L[2]]);const Q=Le.mat4.multiply([],g.globeMatrix,K);return Le.mat4.multiply(Q,Q,R),Le.mat4.multiply(Q,Q,d),Q}(l,e,o);if(c>0){const d=function(g,S){const M=S.worldSize,L=vi(1,0)*M*h(S.center.lat,S.zoom)/As(M),w=vi(1,S.center.lat)*M,A=Le.mat4.identity([]);return Le.mat4.rotateY(A,A,_n(S.center.lng)),Le.mat4.rotateX(A,A,_n(S.center.lat)),Le.mat4.translate(A,A,[0,0,qo]),Le.mat4.scale(A,A,[L,L,L*w]),Le.mat4.translate(A,A,[S.point.x-.5*M,S.point.y-.5*M,0]),Le.mat4.multiply(A,A,g),Le.mat4.multiply(A,S.globeMatrix,A)}(l,e);return function(g,S,M){const L=(P,D,V)=>{const q=Le.vec3.length(P),K=Le.vec3.length(D),Q=ro(P,D,V);return Le.vec3.scale(Q,Q,1/Le.vec3.length(Q)*Fn(q,K,V))},w=L([g[0],g[1],g[2]],[S[0],S[1],S[2]],M),A=L([g[4],g[5],g[6]],[S[4],S[5],S[6]],M),R=L([g[8],g[9],g[10]],[S[8],S[9],S[10]],M),C=ro([g[12],g[13],g[14]],[S[12],S[13],S[14]],M);return[w[0],w[1],w[2],0,A[0],A[1],A[2],0,R[0],R[1],R[2],0,C[0],C[1],C[2],1]}(f,d,c)}return f}function rT(l,e,o,c){const f=Cn.projectAabbCorners(c,o);let d=Number.MAX_VALUE,g=-1;for(let L=0;L<f.length;++L){const w=f[L];w[0]=(.5*w[0]+.5)*e.width,w[1]=(.5-.5*w[1])*e.height,w[2]<d&&(g=L,d=w[2])}const S=L=>new _t(f[L][0],f[L][1]);let M;switch(g){case 0:case 6:M=[S(1),S(5),S(4),S(7),S(3),S(2),S(1)];break;case 1:case 7:M=[S(0),S(4),S(5),S(6),S(2),S(3),S(0)];break;case 3:case 5:M=[S(1),S(0),S(4),S(7),S(6),S(2),S(1)];break;default:M=[S(1),S(5),S(6),S(7),S(3),S(0),S(1)]}if(me(l,M))return d}const nL=Dr([{name:"a_pos_3f",components:3,type:"Float32"}]),rL=Dr([{name:"a_color_3f",components:3,type:"Float32"}]),iL=Dr([{name:"a_color_4f",components:4,type:"Float32"}]),oL=Dr([{name:"a_uv_2f",components:2,type:"Float32"}]),sL=Dr([{name:"a_normal_3f",components:3,type:"Float32"}]),aL=Dr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),lL=Dr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),iT={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Gy{constructor(e,o,c,f){this.message=(e?`${e}: `:"")+c,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function oT(l,e){const o=l.indexOf("://")===-1;try{return new URL(l,o&&e?"http://example.com":void 0),!0}catch{return!1}}class sT{constructor(e,o){this.feature=e,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class aT{constructor(){this.instancedDataArray=new qh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class x0{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(e,o){}populate(e,o,c,f){this.tileToMeter=a(c);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:S,index:M,sourceLayerIndex:L}of e){const w=S??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),A=Z(g,d);if(!this.layers[0]._featureFilter.filter(new Jr(this.zoom),A,c))continue;const R={id:w,sourceLayerIndex:L,index:M,geometry:d?A.geometry:W(g,c,f),properties:g.properties,type:g.type,patterns:{}},C=this.addFeature(R,R.geometry,A);C&&o.featureIndex.insert(g,R.geometry,M,L,this.index,this.instancesPerModel[C].instancedDataArray.length,tn/32)}this.lookup=null}update(e,o,c,f){for(const d in this.instancesPerModel){const g=this.instancesPerModel[d];for(const S in e)g.idToFeaturesIndex.hasOwnProperty(S)&&(this.evaluate(g.features[g.idToFeaturesIndex[S]],e[S],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];for(const f of c.features){const d=this.layers[0],g=f.feature,S=this.canonical,M=d.paint.get("model-rotation").evaluate(g,{},S),L=d.paint.get("model-scale").evaluate(g,{},S),w=d.paint.get("model-translation").evaluate(g,{},S);Le.vec3.exactEquals(f.rotation,M)&&Le.vec3.exactEquals(f.scale,L)&&Le.vec3.exactEquals(f.translation,w)||(this.evaluate(f,f.featureStates,c,!0),e=!0)}}return e}updateReplacement(e,o,c,f){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(qx(this.activeReplacements,d))return!1;this.activeReplacements=d;let g=!1;for(const S in this.instancesPerModel){const M=this.instancesPerModel[S],L=M.instancedDataArray;for(const w of M.features){const A=w.instancedDataOffset,R=w.instancedDataCount;for(let C=0;C<R;C++){const P=16*(C+A);let D=L.float32[P+0];const V=D>tn;D=V?D-tn:D;const q=Math.floor(D),K=L.float32[P+1];let Q=!1;for(const X of this.activeReplacements)if(!wS(X,c,iT.Model,f)&&!(X.min.x>q||q>X.max.x||X.min.y>K||K>X.max.y)&&(Q=IS(MS(q,K,e.canonical,X.footprintTileId.canonical),X.footprint),Q))break;L.float32[P]=Q?D+tn:D,g=g||Q!==V}}}return g}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=e.createVertexBuffer(c.instancedDataArray,aL.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const e=this.layers[0].modelManager;if(e&&this.modelUris)for(const o of this.modelUris)e.removeModel(o,"")}addFeature(e,o,c){const f=this.layers[0],d=f.layout.get("model-id").evaluate(c,{},this.canonical);if(!d)return $n(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),d;oT(d,!1)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new aT);const g=this.instancesPerModel[d],S=g.instancedDataArray,M=new sT(c,S.length);for(const L of o)for(const w of L){if(w.x<0||w.x>=tn||w.y<0||w.y>=tn)continue;const A=(this.lookupDim-1)/tn,R=this.lookupDim*(w.y*A|0)+w.x*A|0;if(this.lookup){if(this.lookup[R]!==0)continue;this.lookup[R]=1}this.instanceCount++;const C=S.length;S.resize(C+1),g.instancesEvaluatedElevation.push(0),S.float32[16*C]=w.x,S.float32[16*C+1]=w.y}return M.instancedDataCount=g.instancedDataArray.length-M.instancedDataOffset,M.instancedDataCount>0&&(e.id&&(g.idToFeaturesIndex[e.id]=g.features.length),g.features.push(M),this.evaluate(M,{},g,!1)),d}getModelUris(){return this.modelUris}evaluate(e,o,c,f){const d=this.layers[0],g=e.feature,S=this.canonical,M=e.rotation=d.paint.get("model-rotation").evaluate(g,o,S),L=e.scale=d.paint.get("model-scale").evaluate(g,o,S),w=e.translation=d.paint.get("model-translation").evaluate(g,o,S),A=d.paint.get("model-color").evaluate(g,o,S);A.a=d.paint.get("model-color-mix-intensity").evaluate(g,o,S);const R=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,L[0]),Math.max(L[1],L[2])),nT(R,M,L);const C=Math.round(100*A.a)+A.b/1.05;for(let P=0;P<e.instancedDataCount;++P){const D=e.instancedDataOffset+P,V=16*D,q=c.instancedDataArray.float32;let K=0;f&&(K=q[V+6]-c.instancesEvaluatedElevation[D]);const Q=0|q[V+1];q[V]=(0|q[V])+A.r/1.05,q[V+1]=Q+A.g/1.05,q[V+2]=C,q[V+3]=1/(S.z>10?this.tileToMeter:a(S,Q)),q[V+4]=w[0],q[V+5]=w[1],q[V+6]=w[2]+K,q[V+7]=R[0],q[V+8]=R[1],q[V+9]=R[2],q[V+10]=R[4],q[V+11]=R[5],q[V+12]=R[6],q[V+13]=R[8],q[V+14]=R[9],q[V+15]=R[10],c.instancesEvaluatedElevation[D]=w[2]}}}let lT,cT;dn(x0,"ModelBucket",{omit:["layers"]}),dn(aT,"PerModelAttributes"),dn(sT,"ModelFeature");const uf=64,Mm={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function uT(l,e,o,c,f,d,g,S,M,L=!1){const w=o.zoom,A=o.project(c),R=h(c.lat,w),C=1/R;Le.mat4.identity(l),Le.mat4.translate(l,l,[A.x+g[0]*C,A.y+g[1]*C,g[2]]);let P=1,D=1;const V=o.worldSize;if(L){if(o.projection.name==="mercator"){let X=0;o.elevation&&(X=o.elevation.getAtPointOrZero(new p(A.x/V,A.y/V),0));const re=Le.vec4.transformMat4([],[A.x,A.y,X,1],o.projMatrix)[3]/o.cameraToCenterDistance;P=re,D=re*h(o.center.lat,w)}else if(o.projection.name==="globe"){const X=v0(l,o),re=Le.mat4.multiply([],o.projMatrix,X),de=[0,0,0,1];Le.vec4.transformMat4(de,de,re);const ye=de[3]/o.cameraToCenterDistance,Ce=is(w),Ee=o.projection.pixelsPerMeter(c.lat,V)*h(c.lat,w),Te=o.projection.pixelsPerMeter(o.center.lat,V)*h(o.center.lat,w);P=ye/Fn(Ee,hm(o.center.lat),Ce),D=ye*R/Ee,P*=Te,D*=Te}}else P=C;Le.mat4.scale(l,l,[P,P,D]);const q=[...l],K=e.orientation,Q=[];if(nT(Q,[K[0]+f[0],K[1]+f[1],K[2]+f[2]],d),Le.mat4.multiply(l,q,Q),S&&o.elevation){let X=0;const re=[];if(M&&o.elevation){X=function(Ce,Ee,Te,Be,Ae){const Ue=Ee.elevation;if(!Ue)return 0;const He=Cn.projectAabbCorners(Te,Be),Ge=vi(1,Ae.lat)*Ee.worldSize,Ke=function(En,en){const bn=[0,0,1],Un=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const hr of Un){const _r=En[hr.corners[0]],Sr=En[hr.corners[1]],yr=En[hr.corners[2]],Rr=[Sr[0]-_r[0],Sr[1]-_r[1],en*(Sr[2]-_r[2])],di=Le.vec3.cross(Rr,Rr,[yr[0]-_r[0],yr[1]-_r[1],en*(yr[2]-_r[2])]);Le.vec3.normalize(di,di),hr.dotProductWithUp=Le.vec3.dot(di,bn)}return Un.sort((hr,_r)=>hr.dotProductWithUp-_r.dotProductWithUp),Un[0].corners}(He,Ge),rt=He[Ke[0]],dt=He[Ke[1]],Qe=He[Ke[2]],wt=He[Ke[3]],qt=Ue.getAtPointOrZero(new p(rt[0]/Ee.worldSize,rt[1]/Ee.worldSize),0),Tt=Ue.getAtPointOrZero(new p(dt[0]/Ee.worldSize,dt[1]/Ee.worldSize),0),Qt=Ue.getAtPointOrZero(new p(Qe[0]/Ee.worldSize,Qe[1]/Ee.worldSize),0),Kt=Ue.getAtPointOrZero(new p(wt[0]/Ee.worldSize,wt[1]/Ee.worldSize),0),ln=(qt+Kt)/2,Pt=(Tt+Qt)/2;return ln>Pt?Tt<Qt?Vy(Ce,dt,wt,rt,Tt,Kt,qt,Ge):Vy(Ce,Qe,rt,wt,Qt,qt,Kt,Ge):qt<Kt?Vy(Ce,rt,dt,Qe,qt,Tt,Qt,Ge):Vy(Ce,wt,Qe,dt,Kt,Qt,Tt,Ge),Math.max(ln,Pt)}(re,o,e.aabb,l,c);const de=Le.mat4.fromQuat([],re),ye=Le.mat4.multiply([],de,Q);Le.mat4.multiply(l,q,ye)}else X=o.elevation.getAtPointOrZero(new p(A.x/V,A.y/V),0);X!==0&&(l[14]+=X)}}function Vg(l,e,o=!1){l.uploaded||(l.gfxTexture=new g0(e,l.image,o?e.gl.R8:e.gl.RGBA8,{useMipmap:l.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function cL(l,e,o){l.indexBuffer=e.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=e.createVertexBuffer(l.vertexArray,nL.members,!1,!0),l.normalArray&&(l.normalBuffer=e.createVertexBuffer(l.normalArray,sL.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=e.createVertexBuffer(l.texcoordArray,oL.members,!1,!0)),l.colorArray&&(l.colorBuffer=e.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?rL:iL).members,!1,!0)),l.featureArray&&(l.pbrBuffer=e.createVertexBuffer(l.featureArray,lL.members,!0)),l.segments=Ui.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const c=l.material;c.pbrMetallicRoughness.baseColorTexture&&Vg(c.pbrMetallicRoughness.baseColorTexture,e),c.pbrMetallicRoughness.metallicRoughnessTexture&&Vg(c.pbrMetallicRoughness.metallicRoughnessTexture,e),c.normalTexture&&Vg(c.normalTexture,e),c.occlusionTexture&&Vg(c.occlusionTexture,e,o),c.emissionTexture&&Vg(c.emissionTexture,e)}function b0(l,e,o){if(l.meshes)for(const c of l.meshes)cL(c,e,o);if(l.children)for(const c of l.children)b0(c,e,o)}function qy(l){if(l.meshes)for(const e of l.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(l.children)for(const e of l.children)qy(e)}function w0(l){if(l.meshes)for(const o of l.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((e=o.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(l.children)for(const o of l.children)w0(o)}class Im{constructor(e,o,c){this._demTile=e,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(e,o,c){const f=c||e.findDEMTileFor(o);if(!f||!f.dem)return;const d=f.dem,g=f.tileID,S=1<<o.canonical.z-g.canonical.z;return new Im(f,d.dim/tn/S,[(o.canonical.x/S-g.canonical.x)*d.dim,(o.canonical.y/S-g.canonical.y)*d.dim])}tileCoordToPixel(e,o){const c=o*this._scale+this._offset[1],f=Math.floor(e*this._scale+this._offset[0]),d=Math.floor(c);return new _t(f,d)}getElevationAt(e,o,c,f){const d=e*this._scale+this._offset[0],g=o*this._scale+this._offset[1],S=Math.floor(d),M=Math.floor(g),L=this._dem;return f=!!f,c?Fn(Fn(L.get(S,M,f),L.get(S,M+1,f),g-M),Fn(L.get(S+1,M,f),L.get(S+1,M+1,f),g-M),d-S):L.get(S,M,f)}getElevationAtPixel(e,o,c){return this._dem.get(e,o,!!c)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*vi(1,e)*this._dem.stride}}const S0=new Float32Array(262144),df=new Uint8Array(262144);function dT(l){let e=0;if(l.meshes)for(const o of l.meshes)e=Math.max(e,o.aabb.max[2]);if(l.children)for(const o of l.children)e=Math.max(e,dT(o));return e}function hT(l,e,o){if(l.meshes)for(const c of l.meshes){if(c.aabb.min[0]===1/0)continue;const f=Cn.applyTransform(c.aabb,l.matrix);o.insert(e,f.min[0],f.min[1],f.max[0],f.max[1])}if(l.children)for(const c of l.children)hT(c,e,o)}const pT=["","wall","door","roof","window","lamp","logo"];class fT{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:e.id,geometry:[],properties:{height:dT(e)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Cn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const o=new Cn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==e&&(c.transformedAabb=Cn.applyTransformFast(c.aabb,this.node.matrix),o.encapsulate(c.transformedAabb)),e++;this.aabb=o}return this.aabb}}class Wy{constructor(e,o,c,f,d,g,S){this.id=c,this.layers=e,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=Mm.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=Mm.HasMapboxMeshFeatures),d&&(this.modelTraits|=Mm.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const M of o)this.nodesInfo.push(new fT(M)),hT(M,S.featureIndexArray.length,S.grid),S.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,S.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(e,o){for(const c of this.getNodesInfo()){const f=c.node;f.footprint&&o.push({footprint:f.footprint,id:e})}}update(e){const o=Object.keys(e).length!==0;if(o&&!this.stateDependentLayers.length)return;const c=o?this.stateDependentLayers:this.layers;if(!er(e,this.states))for(const f of c)this.evaluate(f,e);this.states=structuredClone(e)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const c of o){const f=c.node;this.uploaded?this.updatePbrBuffer(f):b0(f,e,!0)}for(const c of o)qy(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let o=!1;if(!e.meshes)return o;for(const c of e.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),o=!0);return o}needsReEvaluation(e,o,c){const f=e.transform.projectionOptions,d=e.style.getBrightness(),g=this.brightness!==d;if(!this.uploaded||this.dirty||f.name!==this.projection.name||Gg(c.paint.get("model-color").value,g)||Gg(c.paint.get("model-color-mix-intensity").value,g)||Gg(c.paint.get("model-roughness").value,g)||Gg(c.paint.get("model-emissive-strength").value,g)||Gg(c.paint.get("model-height-based-emissive-strength-multiplier").value,g)){this.projection=f,this.brightness=d;const S=this.getNodesInfo();for(const M of S)M.state=null;return!0}return!1}evaluateScale(e,o){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const c=this.getNodesInfo(),f=this.id.canonical;for(const d of c){const g=d.feature;d.evaluatedScale=o.paint.get("model-scale").evaluate(g,{},f)}}evaluate(e,o){const c=this.getNodesInfo();for(const f of c){if(!f.node.meshes)continue;const d=f.feature,g=o&&o[d.id];if(er(g,f.state))continue;f.state=structuredClone(g);const S=f.node.meshes&&f.node.meshes[0].featureData,M=f.evaluatedColor[2],L=f.evaluatedRMEA[2],w=this.id.canonical;if(f.hasTranslucentParts=!1,S){for(let A=0;A<pT.length;A++){const R=pT[A];R.length&&(d.properties.part=R);const C=e.paint.get("model-color").evaluate(d,g,w).toRenderColor(null),P=e.paint.get("model-color-mix-intensity").evaluate(d,g,w);f.evaluatedColor[A]=[C.r,C.g,C.b,P],f.evaluatedRMEA[A][0]=e.paint.get("model-roughness").evaluate(d,g,w),f.evaluatedRMEA[A][2]=e.paint.get("model-emissive-strength").evaluate(d,g,w),f.evaluatedRMEA[A][3]=C.a,f.emissionHeightBasedParams[A]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,g,w),!f.hasTranslucentParts&&C.a<1&&(f.hasTranslucentParts=!0)}delete d.properties.part,dL(f,M!==f.evaluatedColor[2]||L!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(d,g,w);f.evaluatedScale=e.paint.get("model-scale").evaluate(d,g,w),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,o,c,f){const d=e.findDEMTileFor(c);if(d&&(d.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const g=Im.create(e,c,d);if(!g)return;this.modelTraits&Mm.HasMapboxMeshFeatures&&this.updateDEM(e,g,c,f);for(const S of this.getNodesInfo()){const M=S.node;if(!M.footprint||!M.footprint.vertices||!M.footprint.vertices.length)continue;const L=M.footprint.vertices;let w=g.getElevationAt(L[0].x,L[0].y,!0,!0);for(let A=1;A<L.length;A++)w=Math.min(w,g.getElevationAt(L[A].x,L[A].y,!0,!0));M.elevation=w}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=o}}updateDEM(e,o,c,f){let d=o._dem._modifiedForSources[f];if(d===void 0&&(o._dem._modifiedForSources[f]=[],d=o._dem._modifiedForSources[f]),d.includes(c.canonical))return;const g=o._dem.dim;d.push(c.canonical);let S=!1;for(const M of this.getNodesInfo()){const L=M.node;if(!L.footprint||!L.footprint.grid)continue;const w=L.footprint.grid,A=o.tileCoordToPixel(w.min.x,w.min.y),R=o.tileCoordToPixel(w.max.x,w.max.y),C=Math.min(Math.min(g-R.y,A.x),Math.min(A.y,g-R.x));if(C<0)continue;const P=Dt(C,2,5);let D=Math.max(0,A.x-P),V=Math.max(0,A.y-P),q=Math.min(R.x+P,g-1),K=Math.min(R.y+P,g-1);for(let de=V;de<=K;++de)for(let ye=D;ye<=q;++ye)df[de*g+ye]=255;let Q=0,X=0;for(let de=0;de<w.cellsY;++de)for(let ye=0;ye<w.cellsX;++ye){if(!w.cells[de*w.cellsX+ye])continue;const Ce=o.tileCoordToPixel(w.min.x+ye/w.xScale,w.min.y+de/w.yScale),Ee=o.tileCoordToPixel(w.min.x+(ye+1)/w.xScale,w.min.y+(de+1)/w.yScale);for(let Te=Ce.y;Te<=Math.min(Ee.y+1,g-1);++Te)for(let Be=Ce.x;Be<=Math.min(Ee.x+1,g-1);++Be)df[Te*g+Be]===255&&(df[Te*g+Be]=0,Q+=o.getElevationAtPixel(Be,Te),X++)}const re=Q/X;D=Math.max(1,A.x-P),V=Math.max(1,A.y-P),q=Math.min(R.x+P,g-2),K=Math.min(R.y+P,g-2),S=!0;for(let de=V;de<=K;++de)for(let ye=D;ye<=q;++ye)df[de*g+ye]===0&&(S0[de*g+ye]=o._dem.set(ye,de,re));for(let de=1;de<P;++de){D=Math.max(1,A.x-de),V=Math.max(1,A.y-de),q=Math.min(R.x+de,g-2),K=Math.min(R.y+de,g-2);for(let ye=V;ye<=K;++ye)for(let Ce=D;Ce<=q;++Ce){const Ee=ye*g+Ce;if(df[Ee]===255){let Te=0,Be=0,Ae=-1,Ue=-1;for(let He=-1;He<=1;++He)for(let Ge=-1;Ge<=1;++Ge){const Ke=(ye+He)*g+Ce+Ge;if(df[Ke]>=de)continue;const rt=S0[Ke],dt=Math.abs(rt);dt>Be&&(Te=rt,Be=dt,Ae=Ge,Ue=He)}if(Be>.1){const He=1-(de+.5*Math.abs(Ae*Ue))/P;let Ge=o._dem.get(Ce,ye)+Te*He;const Ke=o._dem.get(Ce+Ae,ye+Ue),rt=o._dem.get(Ce-Ae,ye-Ue,!0);(Ge-Ke)*(Ge-rt)>0&&(Ge=(Ke+rt)/2),S0[Ee]=o._dem.set(Ce,ye,Ge),df[Ee]=de}}}}}S&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=un.now())}getNodesInfo(){return this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const o of e)qy(o.node),w0(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(e.toUnwrapped()),f=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const g=f[d].node;f[d].hiddenByReplacement=!!g.footprint&&!c.find(S=>S.footprint===g.footprint)}}getHeightAtTileCoord(e,o){const c=this.getNodesInfo(),f=[],d=[0,0,0],g=Le.mat4.identity([]);for(let S=0;S<this.nodesInfo.length;S++){const M=c[S],L=M.node.meshes[0],w=L.transformedAabb;if(e<w.min[0]||o<w.min[1]||e>w.max[0]||o>w.max[1])continue;if(M.node.hidden===!0)return{height:1/0,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};Le.mat4.invert(g,M.node.matrix),d[0]=e,d[1]=o,Le.vec3.transformMat4(d,d,g);const A=(d[0]-L.aabb.min[0])/(L.aabb.max[0]-L.aabb.min[0])*uf|0,R=Math.min(63,(d[1]-L.aabb.min[1])/(L.aabb.max[1]-L.aabb.min[1])*uf|0)*uf+Math.min(63,A),C=L.heightmap[R];if(!(C<0&&M.node.footprint))return M.hiddenByReplacement?void 0:{height:C,maxHeight:M.feature.properties.height,hidden:!1,verticalScale:M.evaluatedScale[2]};if(M.node.footprint.grid.query(new _t(e,o),new _t(e,o),f),f.length>0)return{height:void 0,maxHeight:M.feature.properties.height,hidden:M.hiddenByReplacement,verticalScale:M.evaluatedScale[2]}}}}function Gg(l,e){return!l.isLightConstant&&e}function uL(l,e,o,c,f,d,g,S){let M=(61440&e|(61440&e)>>4)>>8,L=(3840&e|(3840&e)>>4)>>4,w=240&e|(240&e)>>4;o[3]>0&&(M=Fn(M,255*o[0],o[3]),L=Fn(L,255*o[1],o[3]),w=Fn(w,255*o[2],o[3]));const A=M<<8|L,R=w<<8|Math.floor(255*c[3]),C=function(de){const ye=Dt(de,0,2);return Math.min(Math.round(.5*ye*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],P=Dt(f[0],0,1),D=Dt(f[1],0,1),V=Dt(f[2],0,1),q=Dt(f[3],0,1);let K,Q,X,re;if(P!==D&&g!==d&&D!==P){const de=g-d;Q=1/(de*(D-P)),X=-(d+de*P)/(de*(D-P));const ye=Dt(f[4],-1,1);re=Math.pow(10,ye),K=255*V<<8|255*q}else K=65535,Q=0,X=1,re=1;if(l.emplaceBack(A,R,C,K,Q,X,re),S){const de=S.length;S.clear();for(let ye=0;ye<de;ye++)S.emplaceBack(A,R,C,K,Q,X,re)}}function dL(l,e,o){const c=l.node;let f=0;const d=o&Mm.HasMeshoptCompression;for(const g of c.meshes){if(c.lights&&c.lightMeshIndex===f||!g.featureData)continue;g.featureArray=new eu,g.featureArray.reserve(g.featureData.length);let S=e;for(const M of g.featureData){const L=d?65535&M:M>>16&65535,w=d?M>>16&65535:65535&M,A=(15&w)<8?15&w:0,R=l.evaluatedRMEA[A],C=l.evaluatedColor[A],P=l.emissionHeightBasedParams[A];let D;if(S&&A===2&&c.lights&&(D=new eu,D.resize(10*c.lights.length)),uL(g.featureArray,L,C,R,P,g.aabb.min[2],g.aabb.max[2],D),D&&S){S=!1;const V=c.meshes[c.lightMeshIndex];V.featureArray=D,V.featureArray._trim()}}g.featureArray._trim(),f++}}function mT(l,e,o,c){const f=1<<l.z;e.lat=Ln((c/tn+l.y)/f),e.lng=Is((o/tn+l.x)/f)}dn(Wy,"Tiled3dModelBucket",{omit:["layers"]}),dn(fT,"Tiled3dModelFeature");const hL={circle:class extends Qr{constructor(l,e,o,c){super(l,{layout:ut||(ut=new bi({"circle-sort-key":new nn(ft.layout_circle["circle-sort-key"]),visibility:new Wt(ft.layout_circle.visibility)})),paint:Lt||(Lt=new bi({"circle-radius":new nn(ft.paint_circle["circle-radius"]),"circle-color":new nn(ft.paint_circle["circle-color"]),"circle-blur":new nn(ft.paint_circle["circle-blur"]),"circle-opacity":new nn(ft.paint_circle["circle-opacity"]),"circle-translate":new Wt(ft.paint_circle["circle-translate"]),"circle-translate-anchor":new Wt(ft.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wt(ft.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wt(ft.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nn(ft.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nn(ft.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nn(ft.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Wt(ft.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c)}createBucket(l){return new ue(l)}queryRadius(l){const e=l;return Je("circle-radius",this,e)+Je("circle-stroke-width",this,e)+It(this.paint.get("circle-translate"))}queryIntersectsFeature(l,e,o,c,f,d,g,S){const M=Ht(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),L=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o);return Yd(l,c,d,g,S,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,L)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,e,o){const c=Kh(this);return{config:new Il(this,{zoom:e,lut:o}),defines:c,overrideFog:!1}}},heatmap:class extends Qr{createBucket(l){return new fy(l)}constructor(l,e,o,c){super(l,{layout:su||(su=new bi({visibility:new Wt(ft.layout_heatmap.visibility)})),paint:sf||(sf=new bi({"heatmap-radius":new nn(ft.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nn(ft.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wt(ft.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Es(ft.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wt(ft.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return Je("heatmap-radius",this,l)}queryIntersectsFeature(l,e,o,c,f,d,g,S){const M=this.paint.get("heatmap-radius").evaluate(e,o);return Yd(l,c,d,g,S,!0,!0,new _t(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,e,o){return l==="heatmap"?{config:new Il(this,{zoom:e,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Qr{constructor(l,e,o,c){super(l,{layout:Xu||(Xu=new bi({visibility:new Wt(ft.layout_hillshade.visibility)})),paint:af||(af=new bi({"hillshade-illumination-direction":new Wt(ft.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wt(ft.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wt(ft.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wt(ft.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wt(ft.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wt(ft.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Wt(ft.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,e,o){return{overrideFog:!1}}},fill:class extends Qr{constructor(l,e,o,c){super(l,{layout:Ot||(Ot=new bi({"fill-sort-key":new nn(ft.layout_fill["fill-sort-key"]),visibility:new Wt(ft.layout_fill.visibility),"fill-elevation-reference":new Wt(ft.layout_fill["fill-elevation-reference"])})),paint:St||(St=new bi({"fill-antialias":new Wt(ft.paint_fill["fill-antialias"]),"fill-opacity":new nn(ft.paint_fill["fill-opacity"]),"fill-color":new nn(ft.paint_fill["fill-color"]),"fill-outline-color":new nn(ft.paint_fill["fill-outline-color"]),"fill-translate":new Wt(ft.paint_fill["fill-translate"]),"fill-translate-anchor":new Wt(ft.paint_fill["fill-translate-anchor"]),"fill-pattern":new nn(ft.paint_fill["fill-pattern"]),"fill-emissive-strength":new Wt(ft.paint_fill["fill-emissive-strength"]),"fill-z-offset":new nn(ft.paint_fill["fill-z-offset"]),"fill-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c)}getProgramIds(){const l=this.paint.get("fill-pattern"),e=l&&l.constantOr(1),o=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(l,e,o){return{config:new Il(this,{zoom:e,lut:o}),overrideFog:!1}}recalculate(l,e){super.recalculate(l,e);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new co(l)}queryRadius(){return It(this.paint.get("fill-translate"))}queryIntersectsFeature(l,e,o,c,f,d){return!l.queryGeometry.isAboveHorizon&&Se(kt(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Qr{constructor(l,e,o,c){super(l,{layout:VS||(VS=new bi({visibility:new Wt(ft["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Wt(ft["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:GS||(GS=new bi({"fill-extrusion-opacity":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nn(ft["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nn(ft["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new nn(ft["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nn(ft["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new nn(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new nn(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new nn(ft["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new nn(ft["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Wt(ft["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new by(l)}queryRadius(){return It(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,e,o,c,f,d,g,S,M){const L=Ht(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(e,o),A=this.paint.get("fill-extrusion-base").evaluate(e,o),R=[0,0],C=S&&d.elevation,P=d.elevation?d.elevation.exaggeration():1,D=l.tile.getBucket(this);if(C&&D instanceof by){const X=D.centroidVertexArray,re=M+1;re<X.length&&(R[0]=X.geta_centroid_pos0(re),R[1]=X.geta_centroid_pos1(re))}if(R[0]===0&&R[1]===1)return!1;d.projection.name==="globe"&&(c=$S([c],[new _t(0,0),new _t(tn,tn)],l.tileID.canonical).map(X=>X.polygon).flat());const V=C?S:null,[q,K]=function(X,re,de,ye,Ce,Ee,Te,Be,Ae,Ue,He){return X.projection.name==="globe"?function(Ge,Ke,rt,dt,Qe,wt,qt,Tt,Qt,Kt,ln){const Pt=[],En=[],en=Ge.projection.upVectorScale(ln,Ge.center.lat,Ge.worldSize).metersToTile,bn=[0,0,0,1],Un=[0,0,0,1],hr=(Sr,yr,Rr,di)=>{Sr[0]=yr,Sr[1]=Rr,Sr[2]=di,Sr[3]=1},_r=US();rt>0&&(rt+=_r),dt+=_r;for(const Sr of Ke){const yr=[],Rr=[];for(const di of Sr){const ti=di.x+Qe.x,Qn=di.y+Qe.y,ni=Ge.projection.projectTilePoint(ti,Qn,ln),Kr=Ge.projection.upVector(ln,di.x,di.y);let hi=rt,ho=dt;if(qt){const po=WS(ti,Qn,rt,dt,qt,Tt,Qt,Kt);hi+=po.base,ho+=po.top}rt!==0?hr(bn,ni.x+Kr[0]*en*hi,ni.y+Kr[1]*en*hi,ni.z+Kr[2]*en*hi):hr(bn,ni.x,ni.y,ni.z),hr(Un,ni.x+Kr[0]*en*ho,ni.y+Kr[1]*en*ho,ni.z+Kr[2]*en*ho),Le.vec3.transformMat4(bn,bn,wt),Le.vec3.transformMat4(Un,Un,wt),yr.push(new lf(bn[0],bn[1],bn[2])),Rr.push(new lf(Un[0],Un[1],Un[2]))}Pt.push(yr),En.push(Rr)}return[Pt,En]}(X,re,de,ye,Ce,Ee,Te,Be,Ae,Ue,He):Te?function(Ge,Ke,rt,dt,Qe,wt,qt,Tt,Qt){const Kt=[],ln=[],Pt=[0,0,0,1];for(const En of Ge){const en=[],bn=[];for(const Un of En){const hr=Un.x+dt.x,_r=Un.y+dt.y,Sr=WS(hr,_r,Ke,rt,wt,qt,Tt,Qt);Pt[0]=hr,Pt[1]=_r,Pt[2]=Sr.base,Pt[3]=1,Le.vec4.transformMat4(Pt,Pt,Qe),Pt[3]=Math.max(Pt[3],1e-5);const yr=new lf(Pt[0]/Pt[3],Pt[1]/Pt[3],Pt[2]/Pt[3]);Pt[0]=hr,Pt[1]=_r,Pt[2]=Sr.top,Pt[3]=1,Le.vec4.transformMat4(Pt,Pt,Qe),Pt[3]=Math.max(Pt[3],1e-5);const Rr=new lf(Pt[0]/Pt[3],Pt[1]/Pt[3],Pt[2]/Pt[3]);en.push(yr),bn.push(Rr)}Kt.push(en),ln.push(bn)}return[Kt,ln]}(re,de,ye,Ce,Ee,Te,Be,Ae,Ue):function(Ge,Ke,rt,dt,Qe){const wt=[],qt=[],Tt=Qe[8]*Ke,Qt=Qe[9]*Ke,Kt=Qe[10]*Ke,ln=Qe[11]*Ke,Pt=Qe[8]*rt,En=Qe[9]*rt,en=Qe[10]*rt,bn=Qe[11]*rt;for(const Un of Ge){const hr=[],_r=[];for(const Sr of Un){const yr=Sr.x+dt.x,Rr=Sr.y+dt.y,di=Qe[0]*yr+Qe[4]*Rr+Qe[12],ti=Qe[1]*yr+Qe[5]*Rr+Qe[13],Qn=Qe[2]*yr+Qe[6]*Rr+Qe[14],ni=Qe[3]*yr+Qe[7]*Rr+Qe[15],Kr=di+Tt,hi=ti+Qt,ho=Qn+Kt,po=Math.max(ni+ln,1e-5),Ji=di+Pt,fa=ti+En,Ii=Qn+en,Pi=Math.max(ni+bn,1e-5);hr.push(new lf(Kr/po,hi/po,ho/po)),_r.push(new lf(Ji/Pi,fa/Pi,Ii/Pi))}wt.push(hr),qt.push(_r)}return[wt,qt]}(re,de,ye,Ce,Ee)}(d,c,A,w,L,g,V,R,P,d.center.lat,l.tileID.canonical),Q=l.queryGeometry;return function(X,re,de){let ye=1/0;Se(de,re)&&(ye=qS(de,re[0]));for(let Ce=0;Ce<re.length;Ce++){const Ee=re[Ce],Te=X[Ce];for(let Be=0;Be<Ee.length-1;Be++){const Ae=Ee[Be],Ue=[Ae,Ee[Be+1],Te[Be+1],Te[Be],Ae];me(de,Ue)&&(ye=Math.min(ye,qS(de,Ue)))}}return ye!==1/0&&ye}(q,K,Q.isPointQuery()?Q.screenBounds:Q.screenGeometry)}},line:class extends Qr{constructor(l,e,o,c){const f=n2();super(l,f,e,o,c),f.layout&&(this.layout=new lc(f.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Tr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,e){super.recalculate(l,e),this.paint._values["line-floorwidth"]=(()=>{if(Lg)return Lg;const o=n2();return Lg=new fk(o.paint.properties["line-width"].specification),Lg.useIntegerZoom=!0,Lg})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Xx(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,e,o){const c=e2(this);return{config:new Il(this,{zoom:e,lut:o}),defines:c,overrideFog:!1}}queryRadius(l){const e=l,o=r2(Je("line-width",this,e),Je("line-gap-width",this,e)),c=Je("line-offset",this,e);return o/2+Math.abs(c)+It(this.paint.get("line-translate"))}queryIntersectsFeature(l,e,o,c,f,d){if(l.queryGeometry.isAboveHorizon)return!1;const g=kt(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),S=l.pixelToTileUnitsFactor/2*r2(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),M=this.paint.get("line-offset").evaluate(e,o);return M&&(c=function(L,w){const A=[],R=new _t(0,0);for(let C=0;C<L.length;C++){const P=L[C],D=[];for(let V=0;V<P.length;V++){const q=P[V],K=P[V+1],Q=V===0?R:q.sub(P[V-1])._unit()._perp(),X=V===P.length-1?R:K.sub(q)._unit()._perp(),re=Q._add(X)._unit();re._mult(1/(re.x*X.x+re.y*X.y)),D.push(re._mult(w)._add(q))}A.push(D)}return A}(c,M*l.pixelToTileUnitsFactor)),function(L,w,A){for(let R=0;R<w.length;R++){const C=w[R];if(L.length>=3){for(let P=0;P<C.length;P++)if(Ne(L,C[P]))return!0}if(Pe(L,C,A))return!0}return!1}(g,c,S)}isTileClipped(){return!0}isDraped(l){const e=this.layout.get("line-z-offset"),o=e.isConstant()&&!e.constantOr(0),c=this.layout.get("line-elevation-reference");return!(c==="sea"||c==="ground")&&(o||c!=="none")}},symbol:By,background:class extends Qr{constructor(l,e,o,c){super(l,{layout:j2||(j2=new bi({visibility:new Wt(ft.layout_background.visibility)})),paint:U2||(U2=new bi({"background-pitch-alignment":new Wt(ft.paint_background["background-pitch-alignment"]),"background-color":new Wt(ft.paint_background["background-color"]),"background-pattern":new Wt(ft.paint_background["background-pattern"]),"background-opacity":new Wt(ft.paint_background["background-opacity"]),"background-emissive-strength":new Wt(ft.paint_background["background-emissive-strength"]),"background-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,e,o){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:W2,"raster-particle":J2,sky:class extends Qr{constructor(l,e,o,c){super(l,{layout:X2||(X2=new bi({visibility:new Wt(ft.layout_sky.visibility)})),paint:Y2||(Y2=new bi({"sky-type":new Wt(ft.paint_sky["sky-type"]),"sky-atmosphere-sun":new Wt(ft.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Wt(ft.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Wt(ft.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Wt(ft.paint_sky["sky-gradient-radius"]),"sky-gradient":new Es(ft.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Wt(ft.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Wt(ft.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Wt(ft.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Jh({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(l,e){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,d=l.style.light,g=d.properties.get("position");return f&&d.properties.get("anchor")==="viewport"&&$n("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?_0(g.azimuthal,90-g.polar,e):_0(c[0],90-c[1],e)}const o=this.paint.get("sky-gradient-center");return _0(o[0],90-o[1],e)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends Qr{constructor(l,e,o,c){super(l,{paint:K2||(K2=new bi({}))},e,null)}},model:class extends Qr{constructor(l,e,o,c){super(l,{layout:lT||(lT=new bi({visibility:new Wt(ft.layout_model.visibility),"model-id":new nn(ft.layout_model["model-id"])})),paint:cT||(cT=new bi({"model-opacity":new nn(ft.paint_model["model-opacity"]),"model-rotation":new nn(ft.paint_model["model-rotation"]),"model-scale":new nn(ft.paint_model["model-scale"]),"model-translation":new nn(ft.paint_model["model-translation"]),"model-color":new nn(ft.paint_model["model-color"]),"model-color-mix-intensity":new nn(ft.paint_model["model-color-mix-intensity"]),"model-type":new Wt(ft.paint_model["model-type"]),"model-cast-shadows":new Wt(ft.paint_model["model-cast-shadows"]),"model-receive-shadows":new Wt(ft.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Wt(ft.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new nn(ft.paint_model["model-emissive-strength"]),"model-roughness":new nn(ft.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new nn(ft.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Wt(ft.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Wt(ft.paint_model["model-front-cutoff"]),"model-color-use-theme":new nn({type:"string",default:"default","property-type":"data-driven"})}))},e,o,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new x0(l)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof Wy?tn-1:0}queryIntersectsFeature(l,e,o,c,f,d){if(!this.modelManager)return!1;const g=this.modelManager,S=l.tile.getBucket(this);if(!(S&&S instanceof x0))return!1;for(const M in S.instancesPerModel){const L=S.instancesPerModel[M],w=e.id!==void 0?e.id:e.properties&&e.properties.hasOwnProperty("id")?e.properties.id:void 0;if(L.idToFeaturesIndex.hasOwnProperty(w)){const A=L.features[L.idToFeaturesIndex[w]],R=g.getModel(M,this.scope);if(!R)return!1;let C=Le.mat4.create();const P=new Or(0,0),D=S.canonical;let V=Number.MAX_VALUE;for(let q=0;q<A.instancedDataCount;++q){const K=16*(A.instancedDataOffset+q),Q=L.instancedDataArray.float32,X=[Q[K+4],Q[K+5],Q[K+6]];mT(D,P,Q[K],0|Q[K+1]),uT(C,R,d,P,A.rotation,A.scale,X,!1,!1,!1),d.projection.name==="globe"&&(C=v0(C,d));const re=Le.mat4.multiply([],d.projMatrix,C),de=l.queryGeometry,ye=rT(de.isPointQuery()?de.screenBounds:de.screenGeometry,d,re,R.aabb);ye!=null&&(V=Math.min(ye,V))}return V!==Number.MAX_VALUE&&V}}return!1}_handleOverridablePaintPropertyUpdate(l,e,o){return!(!this.layout||e.isDataDriven()||o.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const e=this._transitionablePaint._values[l];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof rc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Qr{constructor(l,e,o,c){super(l,{layout:jt||(jt=new bi({"clip-layer-types":new Wt(ft.layout_clip["clip-layer-types"]),"clip-layer-scope":new Wt(ft.layout_clip["clip-layer-scope"])})),paint:An||(An=new bi({}))},e,o,c)}recalculate(l,e){super.recalculate(l,e)}createBucket(l){return new Ir(l)}isTileClipped(){return!0}is3D(){return!0}}};class pL{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class fL{constructor(){this.tasks={},this.taskQueue=[],Zr(["process"],this),this.invoker=new pL(this.process),this.nextId=0}add(e,o){const c=this.nextId++,f=function({type:d,isSymbolTile:g,zoom:S}){return S=S||0,d==="message"?0:d!=="maybePrepare"||g?d!=="parseTile"||g?d==="parseTile"&&g?300-S:d==="maybePrepare"&&g?400-S:500:200-S:100-S}(o);if(f===0){try{e()}finally{}return null}return this.tasks[c]={fn:e,metadata:o,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const o=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let e=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const d=this.tasks[this.taskQueue[f]];d.priority<o&&(o=d.priority,e=f)}if(e===null)return null;const c=this.taskQueue[e];return this.taskQueue.splice(e,1),c}remove(){this.invoker.remove()}}class gT{constructor(e,o,c){this.target=e,this.parent=o,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Zr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new fL}send(e,o,c,f,d=!1,g){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=g,this.callbacks[S]=c);const M=new Set;return this.target.postMessage({id:S,type:e,hasCallback:!!c,targetMapId:f,mustQueue:d,sourceMapId:this.mapId,data:yo(o,M)},M),{cancel:()=>{c&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(e){const o=e.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(o.mustQueue||ai()){const f=this.callbacks[c],d=this.scheduler.add(()=>this.processTask(c,o),f&&f.metadata||{type:"message"});d&&(this.cancelCallbacks[c]=d)}else this.processTask(c,o)}processTask(e,o){if(delete this.cancelCallbacks[e],o.type==="<response>"){const c=this.callbacks[e];delete this.callbacks[e],c&&(o.error?c(Vs(o.error)):c(null,Vs(o.data)))}else{const c=new Set,f=o.hasCallback?(g,S)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:g?yo(g):null,data:yo(S,c)},c)}:()=>{},d=Vs(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,d,f);else if(this.parent.getWorkerSource){const g=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,g[0],d.source,d.scope)[g[1]](d,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var qg={workerUrl:"",workerClass:null,workerParams:void 0};const T0="mapboxgl_preloaded_worker_pool";class hf{constructor(){this.active={}}acquire(e,o=hf.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(qg.workerClass!=null?new qg.workerClass:new self.Worker(qg.workerUrl,qg.workerParams));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[T0]}numActive(){return Object.keys(this.active).length}}hf.workerCount=2;class Am{constructor(e,o,c="Worker",f=hf.workerCount){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Bn();const d=this.workerPool.acquire(this.id,f);for(let g=0;g<d.length;g++){const S=new Am.Actor(d[g],o,this.id);S.name=`${c} ${g}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,o,c){Tn(this.actors,(f,d)=>{f.send(e,o,d)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Wg,E0;function Hy(){return Wg||(Wg=new hf),Wg}Am.Actor=gT;const C0=new kr(0,0,0);var Zy=(l=>(l[l.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",l[l.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",l[l.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",l))(Zy||{}),Xy=(l=>(l[l.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",l[l.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",l[l.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",l[l.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",l))(Xy||{}),Hg=(l=>(l[l.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",l[l.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",l[l.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",l[l.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",l[l.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",l))(Hg||{}),_T=(l=>(l[l.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",l[l.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",l[l.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",l))(_T||{}),Pm=(l=>(l[l.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",l[l.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",l[l.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",l[l.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",l[l.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",l[l.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",l))(Pm||{}),yT=(l=>(l[l.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",l[l.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",l[l.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",l))(yT||{});function mL(l,e,o){l===1&&e.icons.push(function(c,f){return function(d){if(d.usvg_tree.height||(d.usvg_tree.height=d.usvg_tree.width),!d.metadata)return d;const{metadata:g}=d;if(g.content_area){const{content_area:S}=g;S.top==null&&(S.top=S.left),S.width==null&&(S.width=d.usvg_tree.width),S.height==null&&(S.height=S.width)}return g.stretch_x&&g.stretch_x.length&&vT(g,"x"),g.stretch_y&&g.stretch_y.length&&vT(g,"y"),d}(c.readFields(gL,{name:void 0},f))}(o,o.readVarint()+o.pos))}function vT(l,e){const o=[],c=l[`stretch_${e}`];let f=null;for(let d=0;d<c.length;d++)f===null?f=o.length===0?c[0]:o[o.length-1][1]+c[d]:(o.push([f,f+c[d]]),f=null);l[`stretch_${e}_areas`]=o}function gL(l,e,o){l===1?e.name=o.readString():l===2?e.metadata=function(c,f){return c.readFields(_L,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},f)}(o,o.readVarint()+o.pos):l===3&&(e.usvg_tree=function(c,f){return c.readFields(xL,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},f)}(o,o.readVarint()+o.pos),e.data="usvg_tree")}function _L(l,e,o){l===1?e.stretch_x=o.readPackedVarint():l===2?e.stretch_y=o.readPackedVarint():l===3?e.content_area=function(c,f){return c.readFields(yL,{left:0},f)}(o,o.readVarint()+o.pos):l===4&&e.variables.push(function(c,f){return c.readFields(vL,{name:void 0},f)}(o,o.readVarint()+o.pos))}function yL(l,e,o){l===1?e.left=o.readVarint():l===2?e.width=o.readVarint():l===3?e.top=o.readVarint():l===4&&(e.height=o.readVarint())}function vL(l,e,o){l===1?e.name=o.readString():l===2&&(e.rgb_color=Jy(o.readVarint()),e.value="rgb_color")}function xL(l,e,o){l===1?e.width=e.height=o.readVarint():l===2?e.height=o.readVarint():l===3?e.children.push(Yy(o,o.readVarint()+o.pos)):l===4?e.linear_gradients.push(function(c,f){return c.readFields(ML,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},f)}(o,o.readVarint()+o.pos)):l===5?e.radial_gradients.push(function(c,f){return c.readFields(AL,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},f)}(o,o.readVarint()+o.pos)):l===7?e.clip_paths.push(function(c,f){return c.readFields(PL,{children:[]},f)}(o,o.readVarint()+o.pos)):l===8&&e.masks.push(function(c,f){const d=c.readFields(RL,{left:0,width:20,mask_type:1,children:[]},f);return d.height==null&&(d.height=d.width),d.top==null&&(d.top=d.left),d}(o,o.readVarint()+o.pos))}function Yy(l,e){return l.readFields(bL,{},e)}function bL(l,e,o){l===1?(e.group=function(c,f){return c.readFields(wL,{opacity:255,children:[]},f)}(o,o.readVarint()+o.pos),e.node="group"):l===2&&(e.path=function(c,f){return c.readFields(TL,{paint_order:1,commands:[],step:1,diffs:[],rule:1},f)}(o,o.readVarint()+o.pos),e.node="path")}function wL(l,e,o){l===1?e.transform=Ky(o,o.readVarint()+o.pos):l===2?e.opacity=o.readVarint():l===5?e.clip_path_idx=o.readVarint():l===6?e.mask_idx=o.readVarint():l===7&&e.children.push(Yy(o,o.readVarint()+o.pos))}function Ky(l,e){return l.readFields(SL,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},e)}function SL(l,e,o){l===1?e.sx=o.readFloat():l===2?e.ky=o.readFloat():l===3?e.kx=o.readFloat():l===4?e.sy=o.readFloat():l===5?e.tx=o.readFloat():l===6&&(e.ty=o.readFloat())}function TL(l,e,o){l===1?e.fill=function(c,f){return c.readFields(EL,{rgb_color:C0,paint:"rgb_color",opacity:255},f)}(o,o.readVarint()+o.pos):l===2?e.stroke=function(c,f){return c.readFields(CL,{rgb_color:C0,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},f)}(o,o.readVarint()+o.pos):l===3?e.paint_order=o.readVarint():l===5?o.readPackedVarint(e.commands):l===6?e.step=o.readFloat():l===7?o.readPackedSVarint(e.diffs):l===8&&(e.rule=o.readVarint())}function EL(l,e,o){l===1?(e.rgb_color=Jy(o.readVarint()),e.paint="rgb_color"):l===2?(e.linear_gradient_idx=o.readVarint(),e.paint="linear_gradient_idx"):l===3?(e.radial_gradient_idx=o.readVarint(),e.paint="radial_gradient_idx"):l===5&&(e.opacity=o.readVarint())}function Jy(l){return new kr((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function CL(l,e,o){l===1?(e.rgb_color=Jy(o.readVarint()),e.paint="rgb_color"):l===2?(e.linear_gradient_idx=o.readVarint(),e.paint="linear_gradient_idx"):l===3?(e.radial_gradient_idx=o.readVarint(),e.paint="radial_gradient_idx"):l===5?o.readPackedFloat(e.dasharray):l===6?e.dashoffset=o.readFloat():l===7?e.miterlimit=o.readFloat():l===8?e.opacity=o.readVarint():l===9?e.width=o.readFloat():l===10?e.linecap=o.readVarint():l===11&&(e.linejoin=o.readVarint())}function ML(l,e,o){l===1?e.transform=Ky(o,o.readVarint()+o.pos):l===2?e.spread_method=o.readVarint():l===3?e.stops.push(xT(o,o.readVarint()+o.pos)):l===4?e.x1=o.readFloat():l===5?e.y1=o.readFloat():l===6?e.x2=o.readFloat():l===7&&(e.y2=o.readFloat())}function xT(l,e){return l.readFields(IL,{offset:0,opacity:255,rgb_color:C0},e)}function IL(l,e,o){l===1?e.offset=o.readFloat():l===2?e.opacity=o.readVarint():l===3&&(e.rgb_color=Jy(o.readVarint()))}function AL(l,e,o){l===1?e.transform=Ky(o,o.readVarint()+o.pos):l===2?e.spread_method=o.readVarint():l===3?e.stops.push(xT(o,o.readVarint()+o.pos)):l===4?e.cx=o.readFloat():l===5?e.cy=o.readFloat():l===6?e.r=o.readFloat():l===7?e.fx=o.readFloat():l===8?e.fy=o.readFloat():l===9&&(e.fr=o.readFloat())}function PL(l,e,o){l===1?e.transform=Ky(o,o.readVarint()+o.pos):l===2?e.clip_path_idx=o.readVarint():l===3&&e.children.push(Yy(o,o.readVarint()+o.pos))}function RL(l,e,o){l===1?e.left=e.top=o.readFloat():l===2?e.width=e.height=o.readFloat():l===3?e.top=o.readFloat():l===4?e.height=o.readFloat():l===5?e.mask_type=o.readVarint():l===6?e.mask_idx=o.readVarint():l===7&&e.children.push(Yy(o,o.readVarint()+o.pos))}class kL{static calculate(e,o){const c=new Map,f=new Map;if(Object.keys(e).length===0)return c;o.forEach(d=>{f.set(d.name,d.rgb_color||new kr(0,0,0))});for(const[d,g]of Object.entries(e))f.has(d)?c.set(f.get(d).toStringPremultipliedAlpha(),g):console.warn(`Ignoring unknown image variable "${d}"`);return c}}function Rm(l,e=255,o){const c=e/255,f=l.toStringPremultipliedAlpha(),d=o.has(f)?o.get(f).clone():l.clone();return d.a=c,d.toString()}function M0(l,e){if(!Xt()){const o=document.createElement("canvas");return o.width=l,o.height=e,o}return new OffscreenCanvas(l,e)}function LL(l,e){const o=kL.calculate(e.params,l.metadata?l.metadata.variables:[]),c=l.usvg_tree,f=c.width,d=c.height,g=e.transform?e.transform:new DOMMatrix,S=Math.max(1,Math.round(f*g.a)),M=Math.max(1,Math.round(d*g.d)),L=new DOMMatrix([S/f,0,0,M/d,0,0]),w=M0(S,M).getContext("2d");return I0(w,L,c,c,o),w.getImageData(0,0,S,M)}function I0(l,e,o,c,f){for(const d of c.children)bT(l,e,o,d,f)}function bT(l,e,o,c,f){c.group?(l.save(),function(d,g,S,M,L){const w=M.mask_idx!=null?S.masks[M.mask_idx]:null,A=M.clip_path_idx!=null?S.clip_paths[M.clip_path_idx]:null;if(M.transform&&(g=Zg(M.transform).preMultiplySelf(g)),!function(P,D,V){return P.opacity!==255||D||V}(M,A!=null,w!=null))return void I0(d,g,S,M,L);const R=M0(d.canvas.width,d.canvas.height),C=R.getContext("2d");A&&CT(C,g,S,A),I0(C,g,S,M,L),w&&MT(C,g,S,w,L),d.globalAlpha=M.opacity/255,d.drawImage(R,0,0)}(l,e,o,c.group,f),l.restore()):c.path&&(l.save(),function(d,g,S,M,L){const w=IT(M);d.setTransform(g),M.paint_order===_T.PAINT_ORDER_FILL_AND_STROKE?(wT(d,S,M,w,L),ST(d,S,M,w,L)):(ST(d,S,M,w,L),wT(d,S,M,w,L))}(l,e,o,c.path,f),l.restore())}function wT(l,e,o,c,f){const d=o.fill;if(!d)return;const g=d.opacity/255;switch(d.paint){case"rgb_color":l.fillStyle=Rm(d.rgb_color,d.opacity,f);break;case"linear_gradient_idx":l.fillStyle=TT(l,e.linear_gradients[d.linear_gradient_idx],g,f);break;case"radial_gradient_idx":l.fillStyle=ET(l,e.radial_gradients[d.radial_gradient_idx],g,f)}let S;switch(o.rule){case Zy.PATH_RULE_NON_ZERO:S="nonzero";break;case Zy.PATH_RULE_EVEN_ODD:S="evenodd"}l.fill(c,S)}function ST(l,e,o,c,f){const d=o.stroke;if(!d)return;l.lineWidth=d.width,l.miterLimit=d.miterlimit,l.setLineDash(d.dasharray),l.lineDashOffset=d.dashoffset;const g=d.opacity/255;switch(d.paint){case"rgb_color":l.strokeStyle=Rm(d.rgb_color,d.opacity,f);break;case"linear_gradient_idx":l.strokeStyle=TT(l,e.linear_gradients[d.linear_gradient_idx],g,f);break;case"radial_gradient_idx":l.strokeStyle=ET(l,e.radial_gradients[d.radial_gradient_idx],g,f)}switch(d.linejoin){case Hg.LINE_JOIN_MITER_CLIP:case Hg.LINE_JOIN_MITER:l.lineJoin="miter";break;case Hg.LINE_JOIN_ROUND:l.lineJoin="round";break;case Hg.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(d.linecap){case Xy.LINE_CAP_BUTT:l.lineCap="butt";break;case Xy.LINE_CAP_ROUND:l.lineCap="round";break;case Xy.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(c)}function TT(l,e,o,c){if(e.stops.length===1){const R=e.stops[0];return Rm(R.rgb_color,R.opacity*o,c)}const f=Zg(e.transform),{x1:d,y1:g,x2:S,y2:M}=e,L=f.transformPoint(new DOMPoint(d,g)),w=f.transformPoint(new DOMPoint(S,M)),A=l.createLinearGradient(L.x,L.y,w.x,w.y);for(const R of e.stops)A.addColorStop(R.offset,Rm(R.rgb_color,R.opacity*o,c));return A}function ET(l,e,o,c){if(e.stops.length===1){const R=e.stops[0];return Rm(R.rgb_color,R.opacity*o,c)}const f=Zg(e.transform),{fx:d,fy:g,cx:S,cy:M}=e,L=f.transformPoint(new DOMPoint(d,g)),w=f.transformPoint(new DOMPoint(S,M)),A=l.createRadialGradient(L.x,L.y,0,w.x,w.y,e.r*((f.a+f.d)/2));for(const R of e.stops)A.addColorStop(R.offset,Rm(R.rgb_color,R.opacity*o,c));return A}function CT(l,e,o,c){const f=Zg(c.transform).preMultiplySelf(e),d=c.clip_path_idx!=null?o.clip_paths[c.clip_path_idx]:null;d&&CT(l,f,o,d);const g=new Path2D;let S;function M(L,w){if(L.path){const A=L.path;g.addPath(IT(A),w),A.rule===Zy.PATH_RULE_EVEN_ODD&&(S="evenodd")}else if(L.group){const A=L.group.transform?Zg(L.group.transform).preMultiplySelf(w):w;for(const R of L.group.children)M(R,A)}}for(const L of c.children)M(L,f);l.clip(g,S)}function MT(l,e,o,c,f){if(c.children.length===0)return;const d=c.mask_idx!=null?o.masks[c.mask_idx]:null;d&&MT(l,e,o,d,f);const g=l.canvas.width,S=l.canvas.height,M=M0(g,S),L=M.getContext("2d"),w=c.width,A=c.height,R=c.left,C=c.top,P=new Path2D,D=new Path2D;D.rect(R,C,w,A),P.addPath(D,e),L.clip(P);for(const K of c.children)bT(L,e,o,K,f);const V=L.getImageData(0,0,g,S),q=V.data;if(c.mask_type===yT.MASK_TYPE_LUMINANCE)for(let K=0;K<q.length;K+=4)q[K+3]=q[K+3]/255*(.2126*q[K]+.7152*q[K+1]+.0722*q[K+2]);L.putImageData(V,0,0),l.globalCompositeOperation="destination-in",l.drawImage(M,0,0)}function Zg(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function IT(l){const e=new Path2D,o=l.step;let c=l.diffs[0]*o,f=l.diffs[1]*o;e.moveTo(c,f);for(let d=0,g=2;d<l.commands.length;d++)switch(l.commands[d]){case Pm.PATH_COMMAND_MOVE:c+=l.diffs[g++]*o,f+=l.diffs[g++]*o,e.moveTo(c,f);break;case Pm.PATH_COMMAND_LINE:c+=l.diffs[g++]*o,f+=l.diffs[g++]*o,e.lineTo(c,f);break;case Pm.PATH_COMMAND_QUAD:{const S=c+l.diffs[g++]*o,M=f+l.diffs[g++]*o;c=S+l.diffs[g++]*o,f=M+l.diffs[g++]*o,e.quadraticCurveTo(S,M,c,f);break}case Pm.PATH_COMMAND_CUBIC:{const S=c+l.diffs[g++]*o,M=f+l.diffs[g++]*o,L=S+l.diffs[g++]*o,w=M+l.diffs[g++]*o;c=L+l.diffs[g++]*o,f=w+l.diffs[g++]*o,e.bezierCurveTo(S,M,L,w,c,f);break}case Pm.PATH_COMMAND_CLOSE:e.closePath()}return e}class A0{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const o=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,o),o}put(e,o){this.cache.has(e)?this.cache.delete(e):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(e,o)}delete(e){this.cache.delete(e)}}class P0{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(e){return new ss(e,e.data)}getFromCache(e,o,c){return this.cacheMap.has(c)||this.cacheMap.set(c,new A0(150)),this.cacheMap.get(c).get(ns(e.serialize(),o))}setInCache(e,o,c,f){this.cacheDependenciesMap.has(f)||this.cacheDependenciesMap.set(f,new Map),this.cacheMap.has(f)||this.cacheMap.set(f,new A0(150));const d=this.cacheDependenciesMap.get(f);d.get(ns(e.id,c))||d.set(ns(e.id,c),new Set);const g=this.cacheMap.get(f),S=e.serialize();d.get(ns(e.id,c)).add(S),g.put(ns(e.serialize(),c),o)}removeImagesFromCacheByIds(e,o,c=""){if(!this.cacheMap.has(c)||!this.cacheDependenciesMap.has(c))return;const f=this.cacheMap.get(c),d=this.cacheDependenciesMap.get(c);for(const g of e)if(d.has(ns(g,o))){for(const S of d.get(ns(g,o)))f.delete(S);d.delete(ns(g,o))}}rasterize(e,o,c,f,d=LL){const g=this.getFromCache(e,c,f);if(g)return g.clone();const S=d(o.icon,e.options),M=P0._getImage(S);return this.setInCache(e,M,c,f),M.clone()}}class AT{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,o){const c=this.toIdx(e,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(e,o){return this.leaves[this.toIdx(e,o)]}toIdx(e,o){return o*this.size+e}}function PT(l,e,o,c){let f=0,d=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(c[g])<1e-15){if(o[g]<l[g]||o[g]>e[g])return null}else{const S=1/c[g];let M=(l[g]-o[g])*S,L=(e[g]-o[g])*S;if(M>L){const w=M;M=L,L=w}if(M>f&&(f=M),L<d&&(d=L),f>d)return null}return f}function RT(l,e,o,c,f,d,g,S,M,L,w){const A=c-l,R=f-e,C=d-o,P=g-l,D=S-e,V=M-o,q=w[1]*V-w[2]*D,K=w[2]*P-w[0]*V,Q=w[0]*D-w[1]*P,X=A*q+R*K+C*Q;if(Math.abs(X)<1e-15)return null;const re=1/X,de=L[0]-l,ye=L[1]-e,Ce=L[2]-o,Ee=(de*q+ye*K+Ce*Q)*re;if(Ee<0||Ee>1)return null;const Te=ye*C-Ce*R,Be=Ce*A-de*C,Ae=de*R-ye*A,Ue=(w[0]*Te+w[1]*Be+w[2]*Ae)*re;return Ue<0||Ee+Ue>1?null:(P*Te+D*Be+V*Ae)*re}function kT(l,e,o){return(l-e)/(o-e)}function LT(l,e,o,c,f,d,g,S,M){const L=1<<o,w=d-c,A=g-f,R=(l+1)/L*w+c,C=(e+0)/L*A+f,P=(e+1)/L*A+f;S[0]=(l+0)/L*w+c,S[1]=C,M[0]=R,M[1]=P}class zT{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(d){const g=Math.ceil(Math.log2(d.dim/8)),S=[];let M=Math.ceil(Math.pow(2,g));const L=1/M,w=(C,P,D,V,q)=>{const K=V?1:0,Q=(C+1)*D-K,X=P*D,re=(P+1)*D-K;q[0]=C*D,q[1]=X,q[2]=Q,q[3]=re};let A=new AT(M);const R=[];for(let C=0;C<M*M;C++){w(C%M,Math.floor(C/M),L,!1,R);const P=ip(R[0],R[1],d),D=ip(R[2],R[1],d),V=ip(R[2],R[3],d),q=ip(R[0],R[3],d);A.minimums.push(Math.min(P,D,V,q)),A.maximums.push(Math.max(P,D,V,q)),A.leaves.push(1)}for(S.push(A),M/=2;M>=1;M/=2){const C=S[S.length-1];A=new AT(M);for(let P=0;P<M*M;P++){w(P%M,Math.floor(P/M),2,!0,R);const D=C.getElevation(R[0],R[1]),V=C.getElevation(R[2],R[1]),q=C.getElevation(R[2],R[3]),K=C.getElevation(R[0],R[3]),Q=C.isLeaf(R[0],R[1]),X=C.isLeaf(R[2],R[1]),re=C.isLeaf(R[2],R[3]),de=C.isLeaf(R[0],R[3]),ye=Math.min(D.min,V.min,q.min,K.min),Ce=Math.max(D.max,V.max,q.max,K.max),Ee=Q&&X&&re&&de;A.maximums.push(Ce),A.minimums.push(ye),A.leaves.push(Ce-ye<=5&&Ee?1:0)}S.push(A)}return S}(this.dem),c=o.length-1,f=o[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(e,o,c,f,d,g,S=1){return PT([e,o,-100],[c,f,this.maximums[0]*S],d,g)}raycast(e,o,c,f,d,g,S=1){if(!this.nodeCount)return null;const M=this.raycastRoot(e,o,c,f,d,g,S);if(M==null)return null;const L=[],w=[],A=[],R=[],C=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;C.length>0;){const{idx:P,t:D,nodex:V,nodey:q,depth:K}=C.pop();if(this.leaves[P]){LT(V,q,K,e,o,c,f,A,R);const X=1<<K,re=(V+0)/X,de=(V+1)/X,ye=(q+0)/X,Ce=(q+1)/X,Ee=ip(re,ye,this.dem)*S,Te=ip(de,ye,this.dem)*S,Be=ip(de,Ce,this.dem)*S,Ae=ip(re,Ce,this.dem)*S,Ue=RT(A[0],A[1],Ee,R[0],A[1],Te,R[0],R[1],Be,d,g),He=RT(R[0],R[1],Be,A[0],R[1],Ae,A[0],A[1],Ee,d,g),Ge=Math.min(Ue!==null?Ue:Number.MAX_VALUE,He!==null?He:Number.MAX_VALUE);if(Ge!==Number.MAX_VALUE)return Ge;{const Ke=Le.vec3.scaleAndAdd([],d,g,D);if(DT(Ee,Te,Ae,Be,kT(Ke[0],A[0],R[0]),kT(Ke[1],A[1],R[1]))>=Ke[2])return D}continue}let Q=0;for(let X=0;X<this._siblingOffset.length;X++){LT((V<<1)+this._siblingOffset[X][0],(q<<1)+this._siblingOffset[X][1],K+1,e,o,c,f,A,R),A[2]=-100,R[2]=this.maximums[this.childOffsets[P]+X]*S;const re=PT(A,R,d,g);if(re!=null){const de=re;L[X]=de;let ye=!1;for(let Ce=0;Ce<Q&&!ye;Ce++)de>=L[w[Ce]]&&(w.splice(Ce,0,X),ye=!0);ye||(w[Q]=X),Q++}}for(let X=0;X<Q;X++){const re=w[X];C.push({idx:this.childOffsets[P]+re,t:L[re],nodex:(V<<1)+this._siblingOffset[re][0],nodey:(q<<1)+this._siblingOffset[re][1],depth:K+1})}}return null}_addNode(e,o,c){return this.minimums.push(e),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(e,o,c,f,d){if(e[f].isLeaf(o,c)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const g=f-1,S=e[g];let M=0,L=0;for(let w=0;w<this._siblingOffset.length;w++){const A=2*o+this._siblingOffset[w][0],R=2*c+this._siblingOffset[w][1],C=S.getElevation(A,R),P=S.isLeaf(A,R),D=this._addNode(C.min,C.max,P);P&&(M|=1<<w),L||(L=D)}for(let w=0;w<this._siblingOffset.length;w++)M&1<<w||this._construct(e,2*o+this._siblingOffset[w][0],2*c+this._siblingOffset[w][1],g,L+w)}}function DT(l,e,o,c,f,d){return Fn(Fn(l,o,d),Fn(e,c,d),f)}function ip(l,e,o){const c=o.dim,f=Dt(l*c-.5,0,c-1),d=Dt(e*c-.5,0,c-1),g=Math.floor(f),S=Math.floor(d),M=Math.min(g+1,c-1),L=Math.min(S+1,c-1);return DT(o.get(g,S),o.get(M,S),o.get(g,L),o.get(M,L),f-g,d-S)}const zL={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function DL(l,e,o){return(256*l*256+256*e+o)/10-1e4}function OL(l,e,o){return 256*l+e+o/256-32768}class Qy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,o,c,f=!1){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void $n(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const d=this.dim=o.height-2,g=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let M=0;M<d;M++)g[this._idx(-1,M)]=g[this._idx(0,M)],g[this._idx(d,M)]=g[this._idx(d-1,M)],g[this._idx(M,-1)]=g[this._idx(M,0)],g[this._idx(M,d)]=g[this._idx(M,d-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(d,-1)]=g[this._idx(d-1,0)],g[this._idx(-1,d)]=g[this._idx(0,d-1)],g[this._idx(d,d)]=g[this._idx(d-1,d-1)]}const S=c==="terrarium"?OL:DL;for(let M=0;M<g.length;++M){const L=4*M;this.floatView[M]=S(this.pixels[L],this.pixels[L+1],this.pixels[L+2])}this._timestamp=un.now()}_buildQuadTree(){this._tree=new zT(this)}get(e,o,c=!1){c&&(e=Dt(e,-1,this.dim),o=Dt(o,-1,this.dim));const f=this._idx(e,o);return this.floatView[f]}set(e,o,c){const f=this._idx(e,o),d=this.floatView[f];return this.floatView[f]=c,c-d}static getUnpackVector(e){return zL[e]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}static pack(e,o){const c=[0,0,0,0],f=Qy.getUnpackVector(o);let d=Math.floor((e+f[3])/f[2]);return c[2]=d%256,d=Math.floor(d/256),c[1]=d%256,d=Math.floor(d/256),c[0]=d,c}getPixels(){return new Mg({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,o,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,d=o*this.dim+this.dim,g=c*this.dim,S=c*this.dim+this.dim;switch(o){case-1:f=d-1;break;case 1:d=f+1}switch(c){case-1:g=S-1;break;case 1:S=g+1}const M=-o*this.dim,L=-c*this.dim;for(let w=g;w<S;w++)for(let A=f;A<d;A++){const R=4*this._idx(A,w),C=4*this._idx(A+M,w+L);this.pixels[R+0]=e.pixels[C+0],this.pixels[R+1]=e.pixels[C+1],this.pixels[R+2]=e.pixels[C+2],this.pixels[R+3]=e.pixels[C+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function FL(l,e,o){l===1?e.headerLength=o.readFixed32():l===2?e.x=o.readVarint():l===3?e.y=o.readVarint():l===4?e.z=o.readVarint():l===5&&e.layers.push(function(c,f){return c.readFields($L,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},f)}(o,o.readVarint()+o.pos))}function BL(l,e,o){l===1?(e.delta_filter=function(c,f){return c.readFields(NL,{blockSize:0},f)}(o,o.readVarint()+o.pos),e.filter="delta_filter"):l===2?(o.readVarint(),e.filter="zigzag_filter"):l===3?(o.readVarint(),e.filter="bitshuffle_filter"):l===4&&(o.readVarint(),e.filter="byteshuffle_filter")}function NL(l,e,o){l===1&&(e.blockSize=o.readVarint())}function jL(l,e,o){l===1?(o.readVarint(),e.codec="gzip_data"):l===2?(o.readVarint(),e.codec="jpeg_image"):l===3?(o.readVarint(),e.codec="webp_image"):l===4&&(o.readVarint(),e.codec="png_image")}function UL(l,e,o){let c=0,f=0;l===1?e.firstByte=o.readFixed64():l===2?e.lastByte=o.readFixed64():l===3?e.filters.push(function(d,g){return d.readFields(BL,{},g)}(o,o.readVarint()+o.pos)):l===4?e.codec=function(d,g){return d.readFields(jL,{},g)}(o,o.readVarint()+o.pos):l===5?f=o.readFloat():l===6?c=o.readFloat():l===7?e.bands.push(o.readString()):l===8?e.offset=o.readDouble():l===9&&(e.scale=o.readDouble()),e.offset===0&&(e.offset=f),e.scale===0&&(e.scale=c)}function $L(l,e,o){l===1?e.version=o.readVarint():l===2?e.name=o.readString():l===3?e.units=o.readString():l===4?e.tileSize=o.readVarint():l===5?e.buffer=o.readVarint():l===6?e.pixelFormat=o.readVarint():l===7&&e.dataIndex.push(function(c,f){return c.readFields(UL,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},f)}(o,o.readVarint()+o.pos))}function VL(l,e,o){if(l===2)(function(c,f,d){c.readFields(GL,d,f)})(o,o.readVarint()+o.pos,e);else if(l===3)throw new Error("Not implemented")}function GL(l,e,o){if(l===1){let c=0;const f=o.readVarint()+o.pos;for(;o.pos<f;)e[c++]=o.readVarint()}}function qL(l,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let o=e[3];for(let c=2;c>=1;c--){const f=c===1?1:0,d=c===2?1:0;for(let g=0;g<e[0];g++){const S=e[1]*g;for(let M=f;M<e[1];M++){const L=e[2]*(M+S);for(let w=d;w<e[2];w++){const A=e[3]*(w+L);for(let R=0;R<e[3];R++){const C=A+R;l[C]+=l[C-o]}}}}o*=e[c]}return l}function WL(l){for(let e=0,o=l.length;e<o;e++)l[e]=l[e]>>>1^-(1&l[e]);return l}function HL(l,e){switch(e){case"uint32":return l;case"uint16":for(let o=0;o<l.length;o+=2){const c=l[o],f=l[o+1];l[o]=(240&c)>>4|(61440&c)>>8|(240&f)<<4|61440&f,l[o+1]=15&c|(3840&c)>>4|(15&f)<<8|(3840&f)<<4}return l;case"uint8":for(let o=0;o<l.length;o+=4){const c=l[o],f=l[o+1],d=l[o+2],g=l[o+3];l[o+0]=(192&c)>>6|(192&f)>>4|(192&d)>>2|192&g,l[o+1]=(48&c)>>4|(48&f)>>2|48&d|(48&g)<<2,l[o+2]=(12&c)>>2|12&f|(12&d)<<2|(12&g)<<4,l[o+3]=3&c|(3&f)<<2|(3&d)<<4|(3&g)<<6}return l;default:throw new Error(`Invalid pixel format, "${e}"`)}}dn(Qy,"DEMData"),dn(zT,"DemMinMaxQuadTree",{omit:["dem"]});var kl=Uint8Array,Xg=Uint16Array,ZL=Int32Array,OT=new kl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),FT=new kl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),XL=new kl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BT=function(l,e){for(var o=new Xg(31),c=0;c<31;++c)o[c]=e+=1<<l[c-1];var f=new ZL(o[30]);for(c=1;c<30;++c)for(var d=o[c];d<o[c+1];++d)f[d]=d-o[c]<<5|c;return{b:o,r:f}},NT=BT(OT,2),jT=NT.b,YL=NT.r;jT[28]=258,YL[258]=28;for(var KL=BT(FT,0).b,UT=new Xg(32768),uo=0;uo<32768;++uo){var km=(43690&uo)>>1|(21845&uo)<<1;UT[uo]=((65280&(km=(61680&(km=(52428&km)>>2|(13107&km)<<2))>>4|(3855&km)<<4))>>8|(255&km)<<8)>>1}var Yg=function(l,e,o){for(var c=l.length,f=0,d=new Xg(e);f<c;++f)l[f]&&++d[l[f]-1];var g,S=new Xg(e);for(f=1;f<e;++f)S[f]=S[f-1]+d[f-1]<<1;g=new Xg(1<<e);var M=15-e;for(f=0;f<c;++f)if(l[f])for(var L=f<<4|l[f],w=e-l[f],A=S[l[f]-1]++<<w,R=A|(1<<w)-1;A<=R;++A)g[UT[A]>>M]=L;return g},Kg=new kl(288);for(uo=0;uo<144;++uo)Kg[uo]=8;for(uo=144;uo<256;++uo)Kg[uo]=9;for(uo=256;uo<280;++uo)Kg[uo]=7;for(uo=280;uo<288;++uo)Kg[uo]=8;var $T=new kl(32);for(uo=0;uo<32;++uo)$T[uo]=5;var JL=Yg(Kg,9),QL=Yg($T,5),R0=function(l){for(var e=l[0],o=1;o<l.length;++o)l[o]>e&&(e=l[o]);return e},uu=function(l,e,o){var c=e/8|0;return(l[c]|l[c+1]<<8)>>(7&e)&o},k0=function(l,e){var o=e/8|0;return(l[o]|l[o+1]<<8|l[o+2]<<16)>>(7&e)},e3=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],du=function(l,e,o){var c=new Error(e||e3[l]);if(c.code=l,Error.captureStackTrace&&Error.captureStackTrace(c,du),!o)throw c;return c},t3=new kl(0),n3=typeof TextDecoder<"u"&&new TextDecoder;try{n3.decode(t3,{stream:!0})}catch{}const r3={gzip_data:"gzip"};class yc extends Error{constructor(e){super(e),this.name="MRTError"}}const i3={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},VT={uint32:1,uint16:2,uint8:4},o3={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let L0;class z0{constructor(e=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){const o=this.layers[e];if(!o)throw new yc(`Layer '${e}' not found`);return o}getHeaderLength(e){const o=new Uint8Array(e),c=new DataView(e);if(o[0]!==13)throw new yc("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(e){const o=new Uint8Array(e),c=this.getHeaderLength(e);if(o.length<c)throw new yc(`Expected header with length >= ${c} but got buffer of length ${o.length}`);const f=function(d,g){return d.readFields(FL,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new L0(o.subarray(0,c)));if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new yc(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const d of f.layers)this.layers[d.name]=new s3(d,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const o=[],c=this.getLayer(e.layerName);for(let f of e.blockIndices){const d=c.dataIndex[f],g=d.firstByte-e.firstByte,S=d.lastByte-e.firstByte;if(c._blocksInProgress.has(f))continue;const M={layerName:c.name,firstByte:g,lastByte:S,pixelFormat:c.pixelFormat,blockIndex:f,blockShape:[d.bands.length].concat(c.bandShape),buffer:c.buffer,codec:d.codec.codec,filters:d.filters.map(L=>L.filter)};c._blocksInProgress.add(f),o.push(M)}return new GT(o,()=>{o.forEach(f=>c._blocksInProgress.delete(f.blockIndex))},(f,d)=>{if(o.forEach(g=>c._blocksInProgress.delete(g.blockIndex)),f)throw f;d.forEach(g=>{this.getLayer(g.layerName).processDecodedData(g)})})}}class s3{constructor({version:e,name:o,units:c,tileSize:f,pixelFormat:d,buffer:g,dataIndex:S},M){if(this.version=e,this.version!==1)throw new yc(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=o,this.units=c,this.tileSize=f,this.buffer=g,this.pixelFormat=i3[d],this.dataIndex=S,this.bandShape=[f+2*g,f+2*g,VT[this.pixelFormat]],this._decodedBlocks=new A0(M?M.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return VT[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:e})=>e).flat()}processDecodedData(e){const o=e.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,e.data)}getBlockForBand(e){let o=0;switch(typeof e){case"string":for(const[c,f]of this.dataIndex.entries()){for(const[d,g]of f.bands.entries())if(g===e)return{bandIndex:o+d,blockIndex:c,blockBandIndex:d};o+=f.bands.length}break;case"number":for(const[c,f]of this.dataIndex.entries()){if(e>=o&&e<o+f.bands.length)return{bandIndex:e,blockIndex:c,blockBandIndex:e-o};o+=f.bands.length}break;default:throw new yc(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new yc(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let o=1/0,c=-1/0;const f=[],d=new Set;for(const g of e){const{blockIndex:S}=this.getBlockForBand(g);if(S<0)throw new yc(`Invalid band: ${JSON.stringify(g)}`);const M=this.dataIndex[S];f.includes(S)||f.push(S),d.add(S),o=Math.min(o,M.firstByte),c=Math.max(c,M.lastByte)}if(d.size>this.cacheSize)throw new yc(`Number of blocks to decode (${d.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:c,blockIndices:f}}hasBand(e){const{blockIndex:o}=this.getBlockForBand(e);return o>=0}hasDataForBand(e){const{blockIndex:o}=this.getBlockForBand(e);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(e){const{blockIndex:o,blockBandIndex:c}=this.getBlockForBand(e),f=this._decodedBlocks.get(o.toString());if(!f)throw new yc(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const d=this.dataIndex[o],g=this.bandShape.reduce((L,w)=>L*w,1),S=c*g,M=f.subarray(S,S+g);return{data:M,bytes:new Uint8Array(M.buffer).subarray(M.byteOffset,M.byteOffset+M.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:d.offset,scale:d.scale}}}z0.setPbf=function(l){L0=l};class GT{constructor(e,o,c){this.tasks=e,this._onCancel=o,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,o){this._finalized||(this._onComplete(e,o),this._finalized=!0)}}z0.performDecoding=function(l,e){const o=new Uint8Array(l);return Promise.all(e.tasks.map(c=>{const{layerName:f,firstByte:d,lastByte:g,pixelFormat:S,blockShape:M,blockIndex:L,filters:w,codec:A}=c,R=o.subarray(d,g+1),C=new Uint32Array(M[0]*M[1]*M[2]);let P;if(A!=="gzip_data")throw new yc(`Unhandled codec: ${A}`);return P=function(D,V){if(!globalThis.DecompressionStream&&V==="gzip_data")return Promise.resolve(((X=function(ye){ye[0]==31&&ye[1]==139&&ye[2]==8||du(6,"invalid gzip data");var Ce=ye[3],Ee=10;4&Ce&&(Ee+=2+(ye[10]|ye[11]<<8));for(var Te=(Ce>>3&1)+(Ce>>4&1);Te>0;Te-=!ye[Ee++]);return Ee+(2&Ce)}(Q=D))+8>Q.length&&du(6,"invalid gzip data"),function(ye,Ce,Ee,Te){var Be=ye.length;if(!Be||Ce.f&&!Ce.l)return Ee||new kl(0);var Ae=!Ee,Ue=Ae||Ce.i!=2,He=Ce.i;Ae&&(Ee=new kl(3*Be));var Ge,Ke,rt=function(eh){var ap=Ee.length;if(eh>ap){var lp=new kl(Math.max(2*ap,eh));lp.set(Ee),Ee=lp}},dt=Ce.f||0,Qe=Ce.p||0,wt=Ce.b||0,qt=Ce.l,Tt=Ce.d,Qt=Ce.m,Kt=Ce.n,ln=8*Be;do{if(!qt){dt=uu(ye,Qe,1);var Pt=uu(ye,Qe+1,3);if(Qe+=3,!Pt){var En=ye[(Qn=4+((Qe+7)/8|0))-4]|ye[Qn-3]<<8,en=Qn+En;if(en>Be){He&&du(0);break}Ue&&rt(wt+En),Ee.set(ye.subarray(Qn,en),wt),Ce.b=wt+=En,Ce.p=Qe=8*en,Ce.f=dt;continue}if(Pt==1)qt=JL,Tt=QL,Qt=9,Kt=5;else if(Pt==2){var bn=uu(ye,Qe,31)+257,Un=uu(ye,Qe+10,15)+4,hr=bn+uu(ye,Qe+5,31)+1;Qe+=14;for(var _r=new kl(hr),Sr=new kl(19),yr=0;yr<Un;++yr)Sr[XL[yr]]=uu(ye,Qe+3*yr,7);Qe+=3*Un;var Rr=R0(Sr),di=(1<<Rr)-1,ti=Yg(Sr,Rr);for(yr=0;yr<hr;){var Qn,ni=ti[uu(ye,Qe,di)];if(Qe+=15&ni,(Qn=ni>>4)<16)_r[yr++]=Qn;else{var Kr=0,hi=0;for(Qn==16?(hi=3+uu(ye,Qe,3),Qe+=2,Kr=_r[yr-1]):Qn==17?(hi=3+uu(ye,Qe,7),Qe+=3):Qn==18&&(hi=11+uu(ye,Qe,127),Qe+=7);hi--;)_r[yr++]=Kr}}var ho=_r.subarray(0,bn),po=_r.subarray(bn);Qt=R0(ho),Kt=R0(po),qt=Yg(ho,Qt),Tt=Yg(po,Kt)}else du(1);if(Qe>ln){He&&du(0);break}}Ue&&rt(wt+131072);for(var Ji=(1<<Qt)-1,fa=(1<<Kt)-1,Ii=Qe;;Ii=Qe){var Pi=(Kr=qt[k0(ye,Qe)&Ji])>>4;if((Qe+=15&Kr)>ln){He&&du(0);break}if(Kr||du(2),Pi<256)Ee[wt++]=Pi;else{if(Pi==256){Ii=Qe,qt=null;break}var Ks=Pi-254;Pi>264&&(Ks=uu(ye,Qe,(1<<(ko=OT[yr=Pi-257]))-1)+jT[yr],Qe+=ko);var fo=Tt[k0(ye,Qe)&fa],Ia=fo>>4;if(fo||du(3),Qe+=15&fo,po=KL[Ia],Ia>3){var ko=FT[Ia];po+=k0(ye,Qe)&(1<<ko)-1,Qe+=ko}if(Qe>ln){He&&du(0);break}Ue&&rt(wt+131072);var Ju=wt+Ks;if(wt<po){var op=0-po,sp=Math.min(po,Ju);for(op+wt<0&&du(3);wt<sp;++wt)Ee[wt]=(void 0)[op+wt]}for(;wt<Ju;++wt)Ee[wt]=Ee[wt-po]}}Ce.l=qt,Ce.p=Ii,Ce.b=wt,Ce.f=dt,qt&&(dt=1,Ce.m=Qt,Ce.d=Tt,Ce.n=Kt)}while(!dt);return wt!=Ee.length&&Ae?(Ge=Ee,((Ke=wt)==null||Ke>Ge.length)&&(Ke=Ge.length),new kl(Ge.subarray(0,Ke))):Ee.subarray(0,wt)}(Q.subarray(X,-8),{i:2},new kl(((q=Q)[(K=q.length)-4]|q[K-3]<<8|q[K-2]<<16|q[K-1]<<24)>>>0))));var q,K,Q,X;const re=r3[V];if(!re)throw new Error(`Unhandled codec: ${V}`);const de=new globalThis.DecompressionStream(re);return new Response(new Blob([D]).stream().pipeThrough(de)).arrayBuffer().then(ye=>new Uint8Array(ye))}(R,A).then(D=>(function(V,q){V.readFields(VL,q)}(new L0(D),C),new o3[S](C.buffer))),P.then(D=>{for(let V=w.length-1;V>=0;V--)switch(w[V]){case"delta_filter":qL(D,M);break;case"zigzag_filter":WL(D);break;case"bitshuffle_filter":HL(D,S);break;default:throw new yc(`Unhandled filter "${w[V]}"`)}return{layerName:f,blockIndex:L,data:D}}).catch(D=>{throw D})}))},dn(GT,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let Jg,D0,hu,Lm,O0,zm=null;function qT(){return ai()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:D0||Re.DRACO_URL}function WT(){if(ai()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Lm)return Lm;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Lm=WebAssembly.validate(l)?Re.MESHOPT_SIMD_URL:Re.MESHOPT_URL,Lm}const ev={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},a3={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Qg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function HT(l,e,o){const c=o.json.bufferViews.length,f=o.buffers.length;e.bufferView=c,o.json.bufferViews[c]={buffer:f,byteLength:l.byteLength},o.buffers[f]=l}const F0="KHR_draco_mesh_compression";function l3(l,e){const o=l.extensions&&l.extensions[F0];if(!o)return;const c=new hu.Decoder,f=KT(e,o.bufferView),d=new hu.Mesh;if(!c.DecodeArrayToMesh(f,f.byteLength,d))throw new Error("Failed to decode Draco mesh");const g=e.json.accessors[l.indices],S=ev[g.componentType],M=g.count*S.BYTES_PER_ELEMENT,L=hu._malloc(M);S===Uint16Array?c.GetTrianglesUInt16Array(d,M,L):c.GetTrianglesUInt32Array(d,M,L),HT(hu.memory.buffer.slice(L,L+M),g,e),hu._free(L);for(const w of Object.keys(o.attributes)){const A=c.GetAttributeByUniqueId(d,o.attributes[w]),R=e.json.accessors[l.attributes[w]],C=a3[R.componentType],P=R.count*Qg[R.type]*ev[R.componentType].BYTES_PER_ELEMENT,D=hu._malloc(P);c.GetAttributeDataArrayForAllPoints(d,A,hu[C],P,D),HT(hu.memory.buffer.slice(D,D+P),R,e),hu._free(D)}c.destroy(),d.destroy(),delete l.extensions[F0]}const tv="EXT_meshopt_compression";function c3(l,e){if(!l.extensions||!l.extensions[tv])return;const o=l.extensions[tv],c=new Uint8Array(e.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),f=new Uint8Array(o.count*o.byteStride);O0.decodeGltfBuffer(f,o.count,o.byteStride,c,o.mode,o.filter),l.buffer=e.buffers.length,l.byteOffset=0,e.buffers[l.buffer]=f.buffer,delete l.extensions[tv]}const ZT=1179937895,XT=new TextDecoder("utf8");function YT(l,e){return new URL(l,e).href}function u3(l,e,o,c){return fetch(YT(l.uri,c)).then(f=>f.arrayBuffer()).then(f=>{e.buffers[o]=f})}function KT(l,e){const o=l.json.bufferViews[e];return new Uint8Array(l.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function d3(l,e,o,c){if(l.uri){const f=YT(l.uri,c);return fetch(f).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{e.images[o]=d})}if(l.bufferView!==void 0){const f=KT(e,l.bufferView),d=new Blob([f],{type:l.mimeType});return createImageBitmap(d).then(g=>{e.images[o]=g})}}function JT(l,e=0,o){const c={json:null,images:[],buffers:[]};if(new Uint32Array(l,e,1)[0]===ZT){const w=new Uint32Array(l,e);let A=2;const R=(w[A++]>>2)-3,C=w[A++]>>2;if(A++,c.json=JSON.parse(XT.decode(w.subarray(A,A+C))),A+=C,A<R){const P=w[A++];A++;const D=e+(A<<2);c.buffers[0]=l.slice(D,D+P)}}else c.json=JSON.parse(XT.decode(new Uint8Array(l,e)));const{buffers:f,images:d,meshes:g,extensionsUsed:S,bufferViews:M}=c.json;let L=Promise.resolve();if(f){const w=[];for(let A=0;A<f.length;A++){const R=f[A];R.uri?w.push(u3(R,c,A,o)):c.buffers[A]||(c.buffers[A]=null)}L=Promise.all(w)}return L.then(()=>{const w=[],A=S&&S.includes(F0),R=S&&S.includes(tv);if(A&&w.push(function(){if(!hu)return Jg??(Jg=function(C){let P,D=null;function V(){P=new Uint8Array(D.buffer)}function q(){throw new Error("Unexpected Draco error.")}const K={a:{a:q,d:function(Q,X,re){return P.copyWithin(Q,X,X+re)},c:function(Q){const X=P.length,re=Math.max(Q>>>0,Math.ceil(1.2*X)),de=Math.ceil((re-X)/65536);try{return D.grow(de),V(),!0}catch{return!1}},b:q}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(C,K):C.then(Q=>Q.arrayBuffer()).then(Q=>WebAssembly.instantiate(Q,K))).then(Q=>{const{Rb:X,Qb:re,P:de,T:ye,X:Ce,Ja:Ee,La:Te,Qa:Be,Va:Ae,Wa:Ue,eb:He,jb:Ge,f:Ke,e:rt,yb:dt,zb:Qe,Ab:wt,Bb:qt,Db:Tt,Gb:Qt}=Q.instance.exports;D=rt;const Kt=(()=>{let ln=0,Pt=0,En=0,en=0;return bn=>{En&&(X(en),X(ln),Pt+=En,En=ln=0),ln||(Pt+=128,ln=re(Pt));const Un=bn.length+7&-8;let hr=ln;Un>=Pt&&(En=Un,hr=en=re(Un));for(let _r=0;_r<bn.length;_r++)P[hr+_r]=bn[_r];return hr}})();return V(),Ke(),{memory:rt,_free:X,_malloc:re,Mesh:class{constructor(){this.ptr=de()}destroy(){ye(this.ptr)}},Decoder:class{constructor(){this.ptr=Ee()}destroy(){Ge(this.ptr)}DecodeArrayToMesh(ln,Pt,En){const en=Kt(ln),bn=Te(this.ptr,en,Pt,En.ptr);return!!Ce(bn)}GetAttributeByUniqueId(ln,Pt){return{ptr:Be(this.ptr,ln.ptr,Pt)}}GetTrianglesUInt16Array(ln,Pt,En){Ae(this.ptr,ln.ptr,Pt,En)}GetTrianglesUInt32Array(ln,Pt,En){Ue(this.ptr,ln.ptr,Pt,En)}GetAttributeDataArrayForAllPoints(ln,Pt,En,en,bn){He(this.ptr,ln.ptr,Pt.ptr,En,en,bn)}},DT_INT8:dt(),DT_UINT8:Qe(),DT_INT16:wt(),DT_UINT16:qt(),DT_UINT32:Tt(),DT_FLOAT32:Qt()}})}(fetch(qT())),Jg.then(C=>{hu=C,Jg=void 0}))}()),R&&w.push(function(){if(O0)return;const C=function(P){let D;const V=WebAssembly.instantiateStreaming(P,{}).then(Q=>{D=Q.instance,D.exports.__wasm_call_ctors()}),q={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},K={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:V,supported:!0,decodeGltfBuffer(Q,X,re,de,ye,Ce){(function(Ee,Te,Be,Ae,Ue,He,Ge){const Ke=Ee.exports.sbrk,rt=Ae+3&-4,dt=Ke(rt*Ue),Qe=Ke(He.length),wt=new Uint8Array(Ee.exports.memory.buffer);wt.set(He,Qe);const qt=Te(dt,Ae,Ue,Qe,He.length);if(qt===0&&Ge&&Ge(dt,rt,Ue),Be.set(wt.subarray(dt,dt+Ae*Ue)),Ke(dt-Ke(0)),qt!==0)throw new Error(`Malformed buffer data: ${qt}`)})(D,D.exports[K[ye]],Q,X,re,de,D.exports[q[Ce]])}}}(fetch(WT()));return C.ready.then(()=>{O0=C})}()),d)for(let C=0;C<d.length;C++)w.push(d3(d[C],c,C,o));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(A&&g)for(const{primitives:C}of g)for(const P of C)l3(P,c);if(R&&g&&M)for(const C of M)c3(C,c);return c})})}function pf(l,e){const o=l.json.bufferViews[e.bufferView],c=ev[e.componentType];return new c(l.buffers[o.buffer],(e.byteOffset||0)+(o.byteOffset||0),e.count*(o.byteStride&&o.byteStride!==Qg[e.type]*c.BYTES_PER_ELEMENT?o.byteStride/c.BYTES_PER_ELEMENT:Qg[e.type]))}function B0(l,e,o,c){const f=ev[e.componentType],d=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),g=l.json.bufferViews[e.bufferView],S=g.byteStride?g.byteStride/f.BYTES_PER_ELEMENT:Qg[e.type],M=o.float32,L=M.length/o.capacity;for(let w=0,A=0;w<e.count*S;w+=S,A+=L)for(let R=0;R<L;R++)M[A+R]=c[w+R]*d;o._trim()}function h3(l,e,o){const c=l.indices,f=l.attributes,d={};d.indexArray=new Po;const g=e.json.accessors[c],S=g.count/3;d.indexArray.reserve(S);const M=pf(e,g);for(let R=0;R<S;R++)d.indexArray.emplaceBack(M[3*R],M[3*R+1],M[3*R+2]);d.indexArray._trim(),d.vertexArray=new Zs;const L=e.json.accessors[f.POSITION];d.vertexArray.reserve(L.count);const w=pf(e,L);for(let R=0;R<L.count;R++)d.vertexArray.emplaceBack(w[3*R],w[3*R+1],w[3*R+2]);if(d.vertexArray._trim(),d.aabb=new Cn(L.min,L.max),d.centroid=function(R,C){const P=[0,0,0],D=R.length;if(D>0){for(let V=0;V<D;V++){const q=3*R[V];P[0]+=C[q],P[1]+=C[q+1],P[2]+=C[q+2]}P[0]/=D,P[1]/=D,P[2]/=D}return P}(M,w),f.COLOR_0!==void 0){const R=e.json.accessors[f.COLOR_0],C=Qg[R.type],P=pf(e,R);d.colorArray=C===3?new Zs:new ua,d.colorArray.resize(R.count),B0(e,R,d.colorArray,P)}if(f.NORMAL!==void 0){d.normalArray=new Zs;const R=e.json.accessors[f.NORMAL];d.normalArray.resize(R.count);const C=pf(e,R);B0(e,R,d.normalArray,C)}if(f.TEXCOORD_0!==void 0&&o.length>0){d.texcoordArray=new hc;const R=e.json.accessors[f.TEXCOORD_0];d.texcoordArray.resize(R.count);const C=pf(e,R);B0(e,R,d.texcoordArray,C)}if(f._FEATURE_ID_RGBA4444!==void 0){const R=e.json.accessors[f._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=pf(e,R))}f._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(pf(e,e.json.accessors[f._FEATURE_RGBA4444]).buffer));const A=l.material;return d.material=function(R,C){const{emissiveFactor:P=[0,0,0],alphaMode:D="OPAQUE",alphaCutoff:V=.5,normalTexture:q,occlusionTexture:K,emissiveTexture:Q,doubleSided:X}=R,{baseColorFactor:re=[1,1,1,1],metallicFactor:de=1,roughnessFactor:ye=1,baseColorTexture:Ce,metallicRoughnessTexture:Ee}=R.pbrMetallicRoughness||{},Te=K?C[K.index]:void 0;if(K&&K.extensions&&K.extensions.KHR_texture_transform&&Te){const Be=K.extensions.KHR_texture_transform;Te.offsetScale=[Be.offset[0],Be.offset[1],Be.scale[0],Be.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new kr(...re),metallicFactor:de,roughnessFactor:ye,baseColorTexture:Ce?C[Ce.index]:void 0,metallicRoughnessTexture:Ee?C[Ee.index]:void 0},doubleSided:X,emissiveFactor:P,alphaMode:D,alphaCutoff:V,normalTexture:q?C[q.index]:void 0,occlusionTexture:Te,emissionTexture:Q?C[Q.index]:void 0,defined:R.defined===void 0}}(A!==void 0?e.json.materials[A]:{defined:!1},o),d}function QT(l,e,o){const{matrix:c,rotation:f,translation:d,scale:g,mesh:S,extras:M,children:L}=l,w={};if(w.matrix=c||Le.mat4.fromRotationTranslationScale([],f||[0,0,0,1],d||[0,0,0],g||[1,1,1]),S!==void 0){w.meshes=o[S];const A=w.anchor=[0,0];for(const R of w.meshes){const{min:C,max:P}=R.aabb;A[0]+=C[0]+P[0],A[1]+=C[1]+P[1]}A[0]=Math.floor(A[0]/w.meshes.length/2),A[1]=Math.floor(A[1]/w.meshes.length/2)}if(M&&(M.id&&(w.id=M.id),M.lights&&(w.lights=function(A){if(!A.length)return[];const R=function(q){const K=atob(q),Q=new Uint8Array(K.length);for(let X=0;X<K.length;X++)Q[X]=K.codePointAt(X);return Q}(A),C=[],P=R.length/24,D=new Uint16Array(R.buffer),V=new Float32Array(R.buffer);for(let q=0;q<P;q++){const K=D[2*q*6]/30,Q=D[2*q*6+1]/30,X=D[2*q*6+10]/100,re=V[6*q+1],de=V[6*q+2],ye=V[6*q+3],Ce=V[6*q+4],Ee=ye-re,Te=Ce-de,Be=Math.hypot(Ee,Te);C.push({pos:[re+.5*Ee,de+.5*Te,Q],normal:[Te/Be,-Ee/Be,0],width:Be,height:K,depth:X,points:[re,de,ye,Ce]})}return C}(M.lights))),L){const A=[];for(const R of L)A.push(QT(e.json.nodes[R],e,o));w.children=A}return w}function p3(l){if(l.vertices.length===0||l.indices.length===0)return null;const e=new fr(l.vertices,l.indices,8,256),[o,c]=[e.min.clone(),e.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:e,min:o,max:c}}function f3(l){if(!l.extras||!l.extras.ground)return null;const e=l.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const o=e[0];if(!o||!Array.isArray(o)||o.length===0)return null;const c=[];for(const g of o){if(!Array.isArray(g)||g.length!==2)continue;const S=g[0],M=g[1];typeof S=="number"&&typeof M=="number"&&c.push(new _t(S,M))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let f=0;for(let g=0;g<c.length;g++){const S=c[g],M=c[(g+1)%c.length],L=c[(g+2)%c.length];f+=(S.x-M.x)*(L.y-M.y)-(L.x-M.x)*(S.y-M.y)}f>0&&c.reverse();const d=Qh(c.flatMap(g=>[g.x,g.y]),[]);return d.length===0?null:{vertices:c,indices:d}}function m3(l,e){const o=[],c=[];let f=0;const d=[];for(const g of l){f=o.length;const S=g.vertexArray.float32,M=g.indexArray.uint16;for(let L=0;L<g.vertexArray.length;L++)d[0]=S[3*L+0],d[1]=S[3*L+1],d[2]=S[3*L+2],Le.vec3.transformMat4(d,d,e),o.push(new _t(d[0],d[1]));for(let L=0;L<3*g.indexArray.length;L++)c.push(M[L]+f)}if(c.length%3!=0)return null;for(let g=0;g<c.length;g+=3){const S=o[c[g+0]],M=o[c[g+1]],L=o[c[g+2]];(S.x-M.x)*(L.y-M.y)-(L.x-M.x)*(S.y-M.y)>0&&([c[g+1],c[g+2]]=[c[g+2],c[g+1]])}return{vertices:o,indices:c}}function eE(l){const e=function(M,L){const w=[],A=WebGL2RenderingContext;if(M.json.textures)for(const R of M.json.textures){const C={magFilter:A.LINEAR,minFilter:A.NEAREST,wrapS:A.REPEAT,wrapT:A.REPEAT};R.sampler!==void 0&&Object.assign(C,M.json.samplers[R.sampler]),w.push({image:L[R.source],sampler:C,uploaded:!1})}return w}(l,l.images),o=function(M,L){const w=[];for(const A of M.json.meshes){const R=[];for(const C of A.primitives)R.push(h3(C,M,L));w.push(R)}return w}(l,e),{scenes:c,scene:f,nodes:d}=l.json,g=c?c[f||0].nodes:d,S=[];for(const M of g)S.push(QT(d[M],l,o));return function(M,L,w){const A={},R=new Set;for(let C=0;C<M.length;C++){const P=w[L[C]];if(!P.extras)continue;const D=P.extras["mapbox:footprint:version"],V=P.extras["mapbox:footprint:id"];(D||V)&&R.add(C),D==="1.0.0"&&V&&(A[V]=C)}for(let C=0;C<M.length;C++){if(R.has(C))continue;const P=M[C],D=w[L[C]];if(!D.extras)continue;let V=null;P.id in A&&(V=m3(M[A[P.id]].meshes,P.matrix)),V||(V=f3(D)),V&&(P.footprint=p3(V))}if(R.size>0){const C=Array.from(R.values()).sort((P,D)=>P-D);for(let P=C.length-1;P>=0;P--)M.splice(C[P],1)}}(S,g,l.json.nodes),S}function g3(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const e=l.vertexArray.float32,o=l.aabb.min[0]-1,c=l.aabb.min[1]-1,f=uf/(l.aabb.max[0]-o+2),d=uf/(l.aabb.max[1]-c+2);for(let g=0;g<e.length;g+=3){const S=e[g+2],M=(e[g+0]-o)*f|0,L=(e[g+1]-c)*d|0;S>l.heightmap[L*uf+M]&&(l.heightmap[L*uf+M]=S)}}function _3(l,e){const o={};o.indexArray=new Po,o.indexArray.reserve(4*l.length),o.vertexArray=new Zs,o.vertexArray.reserve(10*l.length),o.colorArray=new ua,o.vertexArray.reserve(10*l.length);let c=0;for(const g of l){const S=Math.min(10,Math.max(4,1.3*g.height))*e,M=[-g.normal[1],g.normal[0],0],L=Math.min(.29,.1*g.width/g.depth),w=g.width-2*g.depth*e*(L+.01),A=Le.vec3.scaleAndAdd([],g.pos,M,w/2),R=Le.vec3.scaleAndAdd([],g.pos,M,-w/2),C=[A[0],A[1],A[2]+g.height],P=[R[0],R[1],R[2]+g.height],D=Le.vec3.scaleAndAdd([],g.normal,M,L);Le.vec3.scale(D,D,S);const V=Le.vec3.scaleAndAdd([],g.normal,M,-L);Le.vec3.scale(V,V,S),Le.vec3.add(D,A,D),Le.vec3.add(V,R,V),A[2]+=.1,R[2]+=.1,o.vertexArray.emplaceBack(D[0],D[1],D[2]),o.vertexArray.emplaceBack(V[0],V[1],V[2]),o.vertexArray.emplaceBack(A[0],A[1],A[2]),o.vertexArray.emplaceBack(R[0],R[1],R[2]),o.vertexArray.emplaceBack(C[0],C[1],C[2]),o.vertexArray.emplaceBack(P[0],P[1],P[2]),o.vertexArray.emplaceBack(A[0],A[1],A[2]),o.vertexArray.emplaceBack(R[0],R[1],R[2]),o.vertexArray.emplaceBack(D[0],D[1],D[2]),o.vertexArray.emplaceBack(V[0],V[1],V[2]);const q=w/S/2;o.colorArray.emplaceBack(-q-L,-1,q,.8),o.colorArray.emplaceBack(q+L,-1,q,.8),o.colorArray.emplaceBack(-q,0,q,1.3),o.colorArray.emplaceBack(q,0,q,1.3),o.colorArray.emplaceBack(q+L,-.8,q,.7),o.colorArray.emplaceBack(q+L,-.8,q,.7),o.colorArray.emplaceBack(0,0,q,1.3),o.colorArray.emplaceBack(0,0,q,1.3),o.colorArray.emplaceBack(q+L,-1.2,q,.8),o.colorArray.emplaceBack(q+L,-1.2,q,.8),o.indexArray.emplaceBack(6+c,4+c,8+c),o.indexArray.emplaceBack(7+c,9+c,5+c),o.indexArray.emplaceBack(0+c,1+c,2+c),o.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const f={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=kr.white,f.pbrMetallicRoughness=d,o.material=f,o.aabb=new Cn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}class tE{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const c=e[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const y3=["id","tile","layer","source","sourceLayer","state"];class Dm{constructor(e,o,c,f,d){this.type="Feature",this._vectorTileFeature=e,this._z=o,this._x=c,this._y=f,this.properties=e.properties,this.id=d}clone(){const e=new Dm(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(e.state={...this.state}),this.layer&&(e.layer={...this.layer}),this.source&&(e.source=this.source),this.sourceLayer&&(e.sourceLayer=this.sourceLayer),e}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of y3)this[o]!==void 0&&(e[o]=this[o]);return e}}class nE{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new bl(tn,16,0),this.featureIndexArray=new $d,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(e,o,c,f,d,g=0,S=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,d,g);const L=this.grid;for(let w=0;w<o.length;w++){const A=o[w],R=[1/0,1/0,-1/0,-1/0];for(let C=0;C<A.length;C++){const P=A[C];R[0]=Math.min(R[0],P.x),R[1]=Math.min(R[1],P.y),R[2]=Math.max(R[2],P.x),R[3]=Math.max(R[3],P.y)}S!==0&&(R[0]-=S,R[1]-=S,R[2]+=S,R[3]+=S),R[0]<tn&&R[1]<tn&&R[2]>=0&&R[3]>=0&&L.insert(M,R[0],R[1],R[2],R[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new bm.VectorTile(new Ty(this.rawTileData)).layers,this.sourceLayerCoder=new tE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,o){const{tilespaceGeometry:c,transform:f,tileTransform:d,pixelPosMatrix:g,availableImages:S}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const M=c.bufferedTilespaceBounds,L=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(C,P,D,V)=>je(c.bufferedTilespaceGeometry,C,P,D,V));L.sort(v3);let w=null;f.elevation&&L.length>0&&(w=Im.create(f.elevation,this.tileID));const A={};let R;for(let C=0;C<L.length;C++){const P=L[C];if(P===R)continue;R=P;const D=this.featureIndexArray.get(P);let V=null;this.is3DTile?this.loadMatchingModelFeature(A,D,e,c,f):this.loadMatchingFeature(A,D,e,S,(q,K,Q,X=0)=>(V||(V=W(q,this.tileID.canonical,d)),K.queryIntersectsFeature(c,q,Q,V,this.z,f,g,w,X)))}return A}loadMatchingFeature(e,o,c,f,d){const{featureIndex:g,bucketIndex:S,sourceLayerIndex:M,layoutVertexArrayOffset:L}=o,w=this.bucketLayerIDs[S],A=c.layers,R=Object.keys(A);if(R.length&&!function(q,K){for(let Q=0;Q<q.length;Q++)if(K.indexOf(q[Q])>=0)return!0;return!1}(R,w))return;const C=c.sourceCache,P=this.sourceLayerCoder.decode(M),D=this.vtLayers[P].feature(g),V=this.getId(D,P);for(let q=0;q<w.length;q++){const K=w[q];if(!A[K])continue;const{styleLayer:Q,targets:X}=A[K];let re={};V!==void 0&&(re=C.getFeatureState(Q.sourceLayer,V));const de=!d||d(D,Q,re,L);if(!de)continue;const ye=new Dm(D,this.z,this.x,this.y,V);ye.tile=this.tileID.canonical,ye.state=re;let Ce=this.serializedLayersCache.get(K);Ce||(Ce=Q.serialize(),Ce.id=K,this.serializedLayersCache.set(K,Ce)),ye.source=Ce.source,ye.sourceLayer=Ce["source-layer"],ye.layer=Pn({},Ce),ye.layer.paint=rE(Ce.paint,Q.paint,D,re,f),ye.layer.layout=rE(Ce.layout,Q.layout,D,re,f);let Ee=!1;for(const Te of X){this.updateFeatureProperties(ye,Te);const{filter:Be}=Te;if(Be){if(D.properties=ye.properties,Be.needGeometry){const Ae=Z(D,!0);if(!Be.filter(new Jr(this.tileID.overscaledZ),Ae,this.tileID.canonical))continue}else if(!Be.filter(new Jr(this.tileID.overscaledZ),D))continue}Ee=!0,Te.targetId&&this.addFeatureVariant(ye,Te)}Ee&&this.appendToResult(e,K,g,ye,de)}}loadMatchingModelFeature(e,o,c,f,d){const g=this.bucketLayerIDs[0][0],S=c.layers;if(!S[g])return;const{styleLayer:M,targets:L}=S[g];if(M.type!=="model")return;const w=f.tile,A=o.featureIndex,R=w.getBucket(M);if(!(R&&R instanceof Wy))return;const C=function(Ce,Ee,Te,Be){const Ae=Ce.getNodesInfo()[Ee];if(Ae.hiddenByReplacement||!Ae.node.meshes)return;let Ue=Number.MAX_VALUE;const He=Ae.node,Ge=Te.tile,Ke=Be.calculatePosMatrix(Ge.tileID.toUnwrapped(),Be.worldSize),rt=Ae.evaluatedScale;let dt=0;Be.elevation&&He.elevation&&(dt=He.elevation*Be.elevation.exaggeration()),Le.mat4.translate(Ke,Ke,[(He.anchor?He.anchor[0]:0)*(rt[0]-1),(He.anchor?He.anchor[1]:0)*(rt[1]-1),dt]),Le.mat4.scale(Ke,Ke,rt);const Qe=Te.queryGeometry,wt=Qe.isPointQuery()?Qe.screenBounds:Qe.screenGeometry,qt=function(Qt){const Kt=Le.mat4.multiply([],Ke,Qt.matrix);Le.mat4.multiply(Kt,Be.expandedFarZProjMatrix,Kt);for(let ln=0;ln<Qt.meshes.length;++ln){const Pt=Qt.meshes[ln];if(ln===Qt.lightMeshIndex)continue;const En=rT(wt,Be,Kt,Pt.aabb);En!=null&&(Ue=Math.min(En,Ue))}if(Qt.children)for(const ln of Qt.children)qt(ln)};if(qt(He),Ue===Number.MAX_VALUE)return;const Tt=new Or(0,0);return mT(Ge.tileID.canonical,Tt,Ae.node.anchor[0],Ae.node.anchor[1]),{intersectionZ:Ue,position:Tt,feature:Ae.feature}}(R,A,f,d);if(!C)return;const{z:P,x:D,y:V}=w.tileID.canonical,{feature:q,intersectionZ:K,position:Q}=C;let X={};q.id!==void 0&&(X=c.sourceCache.getFeatureState(M.sourceLayer,q.id));const re=new Dm({},P,D,V,q.id);re.tile=this.tileID.canonical,re.state=X,re.properties=q.properties,re.geometry={type:"Point",coordinates:[Q.lng,Q.lat]};let de=this.serializedLayersCache.get(g);de||(de=M.serialize(),de.id=g,this.serializedLayersCache.set(g,de)),re.source=de.source,re.sourceLayer=de["source-layer"],re.layer=Pn({},de);let ye=!1;for(const Ce of L){this.updateFeatureProperties(re,Ce);const{filter:Ee}=Ce;if(Ee){if(q.properties=re.properties,Ee.needGeometry){if(!Ee.filter(new Jr(this.tileID.overscaledZ),q,this.tileID.canonical))continue}else if(!Ee.filter(new Jr(this.tileID.overscaledZ),q))continue}ye=!0,Ce.targetId&&this.addFeatureVariant(re,Ce)}ye&&this.appendToResult(e,g,A,re,K)}updateFeatureProperties(e,o,c){if(o.properties){const f={};for(const d in o.properties){const g=o.properties[d].evaluate({zoom:this.z},e._vectorTileFeature,e.state,e.tile,c);g!=null&&(f[d]=g)}e.properties=f}}addFeatureVariant(e,o,c){const f={target:o.target,namespace:o.namespace};o.properties&&(f.properties=e.properties),e.variants=e.variants||{},e.variants[o.targetId]=e.variants[o.targetId]||[],e.variants[o.targetId].push(f)}appendToResult(e,o,c,f,d){let g=e[o];g===void 0&&(g=e[o]=[]),g.push({featureIndex:c,feature:f,intersectionZ:d})}lookupSymbolFeatures(e,o,c,f,d){const g={};this.loadVTLayers();for(const S of e)this.loadMatchingFeature(g,{bucketIndex:o,sourceLayerIndex:c,featureIndex:S,layoutVertexArrayOffset:0},f,d);return g}loadFeature(e){const{featureIndex:o,sourceLayerIndex:c}=e;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),d=this.vtFeatures[f];if(d[o])return d[o];const g=this.vtLayers[f].feature(o);return d[o]=g,g}hasLayer(e){for(const o of this.bucketLayerIDs)for(const c of o)if(e===c)return!0;return!1}getId(e,o){let c=e.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];f!=null&&(c=e.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function rE(l,e,o,c,f){return qr(l,(d,g)=>{const S=e instanceof lc?e.get(g):null;return S&&S.evaluate?S.evaluate(o,c,f):S})}function v3(l,e){return e-l}dn(nE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const iE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class N0{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(e,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const d=iE[15&c];if(!d)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[S]=new Uint32Array(e,4,1);return new N0(S,g,d,e)}constructor(e,o=64,c=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const d=iE.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,S=e*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-S%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+M,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+S+M),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+M,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=e)}add(e,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=e,this.coords[this._pos++]=o,c}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return j0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,o,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:S}=this,M=[0,d.length-1,0],L=[];for(;M.length;){const w=M.pop()||0,A=M.pop()||0,R=M.pop()||0;if(A-R<=S){for(let V=R;V<=A;V++){const q=g[2*V],K=g[2*V+1];q>=e&&q<=c&&K>=o&&K<=f&&L.push(d[V])}continue}const C=R+A>>1,P=g[2*C],D=g[2*C+1];P>=e&&P<=c&&D>=o&&D<=f&&L.push(d[C]),(w===0?e<=P:o<=D)&&(M.push(R),M.push(C-1),M.push(1-w)),(w===0?c>=P:f>=D)&&(M.push(C+1),M.push(A),M.push(1-w))}return L}within(e,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:d,nodeSize:g}=this,S=[0,f.length-1,0],M=[],L=c*c;for(;S.length;){const w=S.pop()||0,A=S.pop()||0,R=S.pop()||0;if(A-R<=g){for(let V=R;V<=A;V++)sE(d[2*V],d[2*V+1],e,o)<=L&&M.push(f[V]);continue}const C=R+A>>1,P=d[2*C],D=d[2*C+1];sE(P,D,e,o)<=L&&M.push(f[C]),(w===0?e-c<=P:o-c<=D)&&(S.push(R),S.push(C-1),S.push(1-w)),(w===0?e+c>=P:o+c>=D)&&(S.push(C+1),S.push(A),S.push(1-w))}return M}}function j0(l,e,o,c,f,d){if(f-c<=o)return;const g=c+f>>1;oE(l,e,g,c,f,d),j0(l,e,o,c,g-1,1-d),j0(l,e,o,g+1,f,1-d)}function oE(l,e,o,c,f,d){for(;f>c;){if(f-c>600){const L=f-c+1,w=o-c+1,A=Math.log(L),R=.5*Math.exp(2*A/3),C=.5*Math.sqrt(A*R*(L-R)/L)*(w-L/2<0?-1:1);oE(l,e,o,Math.max(c,Math.floor(o-w*R/L+C)),Math.min(f,Math.floor(o+(L-w)*R/L+C)),d)}const g=e[2*o+d];let S=c,M=f;for(e_(l,e,c,o),e[2*f+d]>g&&e_(l,e,c,f);S<M;){for(e_(l,e,S,M),S++,M--;e[2*S+d]<g;)S++;for(;e[2*M+d]>g;)M--}e[2*c+d]===g?e_(l,e,c,M):(M++,e_(l,e,M,f)),M<=o&&(c=M+1),o<=M&&(f=M-1)}}function e_(l,e,o,c){U0(l,o,c),U0(e,2*o,2*c),U0(e,2*o+1,2*c+1)}function U0(l,e,o){const c=l[e];l[e]=l[o],l[o]=c}function sE(l,e,o,c){const f=l-o,d=e-c;return f*f+d*d}i.$=Dd,i.A=lo,i.B=2,i.C=x2,i.D=Am,i.E=kc,i.F=i0,i.G=class extends Gy{},i.H=_a,i.I=P0,i.J=$l,i.K=Wa,i.L=$a,i.M=Us,i.N=ki,i.O=kd,i.P=_t,i.Q=Ta,i.R=Ko,i.S=kh,i.T=g0,i.U=$s,i.V=Gy,i.W=Ba,i.X=Na,i.Y=ml,i.Z=xs,i._=wu,i.a=function(l){return Re.API_CDN_URL_REGEX.test(l)},i.a$=Dm,i.a0=Mo,i.a1=Ai,i.a2=function(l){const e=l.value;let o=[];if(!e)return o;const c=_a(e);return c!=="string"?(o=o.concat([new Gy(l.key,e,`string expected, "${c}" found`)]),o):(oT(e,!0)||(o=o.concat([new Gy(l.key,e,`invalid url "${e}"`)])),o)},i.a3=ft,i.a4=sc,i.a5=bi,i.a6=Wt,i.a7=class{constructor(l){this.specification=l}possiblyEvaluate(l,e){return Wi(l.expression.evaluate(e))}interpolate(l,e,o){return{x:Fn(l.x,e.x,o),y:Fn(l.y,e.y,o),z:Fn(l.z,e.z,o),azimuthal:Fn(l.azimuthal,e.azimuthal,o),polar:Fn(l.polar,e.polar,o)}}},i.a8=Jr,i.a9=rc,i.aA=pa,i.aB=class{constructor(l){this.entries={},this.scheduler=l}request(l,e,o,c){const f=this.entries[l]=this.entries[l]||{callbacks:[]};if(f.result){const[d,g]=f.result;return this.scheduler?this.scheduler.add(()=>{c(d,g)},e):c(d,g),()=>{}}return f.callbacks.push(c),f.cancel||(f.cancel=o((d,g)=>{f.result=[d,g];for(const S of f.callbacks)this.scheduler?this.scheduler.add(()=>{S(d,g)},e):S(d,g);setTimeout(()=>delete this.entries[l],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(d=>d!==c),f.callbacks.length||(f.cancel(),delete this.entries[l]))}}},i.aC=ns,i.aD=function(l,e,o){const c=JSON.stringify(l.request);return l.data&&(this.deduped.entries[c]={result:[null,l.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},f=>{const d=Ic(l.request,(g,S,M,L)=>{g?f(g):S&&f(null,{vectorTile:o?void 0:new bm.VectorTile(new Ty(S)),rawData:S,cacheControl:M,expires:L})});return()=>{d.cancel(),f()}},e)},i.aE=function(l){Vr++,Vr>Xn&&(l.getActor().send("enforceCacheSizeLimit",Kn),Vr=0)},i.aF=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},i.aG=Zt,i.aH=W2,i.aI=J2,i.aJ=q2,i.aK=function(l,e){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let c=0;c<l.length;c++){const f=document.createElement("source");Pp(l[c])||(o.crossOrigin="Anonymous"),f.src=l[c],o.appendChild(f)}return{cancel:()=>{}}},i.aL=Ny,i.aM=function(l){return fetch(l).then(e=>e.arrayBuffer()).then(e=>JT(e,0,l))},i.aN=eE,i.aO=class{constructor(l,e,o,c){this.id=l,this.position=e!=null?new Or(e[0],e[1]):new Or(0,0),this.orientation=o??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new Cn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,e){if(Le.mat4.multiply(l.matrix,e,l.matrix),l.meshes)for(const o of l.meshes){const c=Cn.applyTransformFast(o.aabb,l.matrix);this.aabb.encapsulate(c)}if(l.children)for(const o of l.children)this._applyTransformations(o,l.matrix)}computeBoundsAndApplyParent(){const l=Le.mat4.identity([]);for(const e of this.nodes)this._applyTransformations(e,l)}computeModelMatrix(l,e,o,c,f,d,g=!1){uT(this.matrix,this,l.transform,this.position,e,o,c,f,d,g)}upload(l){if(!this.uploaded){for(const e of this.nodes)b0(e,l);for(const e of this.nodes)qy(e);this.uploaded=!0}}destroy(){for(const l of this.nodes)w0(l)}},i.aP=Zr,i.aQ=Bg,i.aR=Is,i.aS=Ln,i.aT=ji,i.aU=Po,i.aV=Bn,i.aW=qp,i.aX=Fy,i.aY=function(){qs.isLoading()||qs.isLoaded()||Wc()!=="deferred"||Up()},i.aZ=Vp,i.a_=Z,i.aa=p,i.ab=Le,i.ac=Ft,i.ad=lc,i.ae=is,i.af=Fn,i.ag=tn,i.ah=Ra,i.ai=_n,i.aj=kr,i.ak=class{constructor(l){this.specification=l}possiblyEvaluate(l,e){return function([o,c]){const f=Wi([1,o,c]);return{x:f.x,y:f.y,z:f.z}}(l.expression.evaluate(e))}interpolate(l,e,o){return{x:Fn(l.x,e.x,o),y:Fn(l.y,e.y,o),z:Fn(l.z,e.z,o)}}},i.al=function(l,e,o=0,c=!0){const f=new _t(o,o),d=l.sub(f),g=e.add(f),S=[d,new _t(g.x,d.y),g,new _t(d.x,g.y)];return c&&S.push(d.clone()),S},i.am=function(l,e){const o=[];for(let c=0;c<l.length;c++){const f=sn(c-1,-1,l.length-1),d=sn(c+1,-1,l.length-1),g=l[c],S=l[d],M=l[f].sub(g).unit(),L=S.sub(g).unit(),w=L.angleWithSep(M.x,M.y),A=M.add(L).unit().mult(-1*e/Math.sin(w/2));o.push(g.add(A))}return o},i.an=R2,i.ao=je,i.ap=function(l,e,o=0){return Le.vec3.fromValues(((e.x-o)*l.scale-l.x)*tn,(e.y*l.scale-l.y)*tn,ou(e.z,e.y))},i.aq=br,i.ar=YS,i.as=function(l){let e=1/0,o=1/0,c=-1/0,f=-1/0;for(const d of l)e=Math.min(e,d.x),o=Math.min(o,d.y),c=Math.max(c,d.x),f=Math.max(f,d.y);return{min:new _t(e,o),max:new _t(c,f)}},i.at=Ka,i.au=Ne,i.av=b,i.aw=Dt,i.ax=qo,i.ay=function(l,e){const o={};for(let c=0;c<e.length;c++){const f=e[c];f in l&&(o[f]=l[f])}return o},i.az=Pl,i.b=function(l){return Re.API_FONTS_REGEX.test(l)},i.b$=$y,i.b0=Fi,i.b1=Xx,i.b2=co,i.b3=W,i.b4=Go,i.b5=Qc,i.b6=Gn,i.b7=Ui,i.b8=Qh,i.b9=p0,i.bA=IS,i.bB=a0,i.bC=M2,i.bD=r0,i.bE=N0,i.bF=sn,i.bG=vs,i.bH=vi,i.bI=function(l,e,o){l[4*e+0]=o[0],l[4*e+1]=o[1],l[4*e+2]=o[2],l[4*e+3]=o[3]},i.bJ=Wu,i.bK=Xs,i.bL=tf,i.bM=wi,i.bN=Ma,i.bO=Or,i.bP=O2,i.bQ=on,i.bR=Wn,i.bS=eT,i.bT=Ct,i.bU=Ei,i.bV=function(l,e,o,c,f,d,g,S,M){if(M.name==="globe")return Ei(l,e,new Ct(o,c,f),!1);const L=Bg({z:o,x:c,y:f},M);return new Cn([(d+L.x/L.scale)*e,e*(L.y/L.scale),g],[(d+L.x2/L.scale)*e,e*(L.y2/L.scale),S])},i.bW=function(l,e,o){let c=0;for(let f=0;f<2;++f)l[f]>0&&(c+=(l[f]-0)*(l[f]-0)),e[f]<0&&(c+=(0-e[f])*(0-e[f]));return c},i.bX=Fo,i.bY=qd,i.bZ=function(l){const e=Le.mat4.identity(new Float64Array(16));Le.mat4.multiply(e,l.pixelMatrix,l.globeMatrix);const o=[0,Ys,0],c=[0,fs,0];return Le.vec3.transformMat4(o,o,e),Le.vec3.transformMat4(c,c,e),[o[0]>0&&o[0]<=l.width&&o[1]>0&&o[1]<=l.height&&!_s(l,new Or(l.center.lat,90)),c[0]>0&&c[0]<=l.width&&c[1]>0&&c[1]<=l.height&&!_s(l,new Or(l.center.lat,-90))]},i.b_=function(l,e){const{scale:o}=l.tileTransform,c=o*tn/(l.tileSize*Math.pow(2,e.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return Le.mat2.scale(new Float32Array(4),e.inverseAdjustmentMatrix,[c,c])},i.ba=function(l,e){const o=is(e.zoom);if(o===0)return qi(l);const c=Gr(l),f=ii(c),d=Ka(c.getWest())*e.worldSize,g=Ka(c.getEast())*e.worldSize,S=pa(c.getNorth())*e.worldSize,M=pa(c.getSouth())*e.worldSize,L=[d,S,0],w=[g,S,0],A=[d,M,0],R=[g,M,0],C=Le.mat4.invert([],e.globeMatrix);return Le.vec3.transformMat4(L,L,C),Le.vec3.transformMat4(w,w,C),Le.vec3.transformMat4(A,A,C),Le.vec3.transformMat4(R,R,C),f[0]=ro(f[0],A,o),f[1]=ro(f[1],R,o),f[2]=ro(f[2],w,o),f[3]=ro(f[3],L,o),Cn.fromPoints(f)},i.bb=ei,i.bc=Mr,i.bd=ro,i.be=Li,i.bf=Rn,i.bg=z0,i.bh=Ty,i.bi=Ic,i.bj=function(l){const e=[];for(const o in l)e.push(l[o]);return e},i.bk=function(l,e){const o=[];for(const c in l)c in e||o.push(c);return o},i.bl=Tn,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=er,i.bo=function(l,e){const{x:o,y:c}=l.point,f=gs(o,c,l.worldSize/l._pixelsPerMercatorPixel,0,0);return Le.mat4.multiply(f,f,Ho(qi(e)))},i.bp=wm,i.bq=Rl,i.br=Sy,i.bs=function(l,e,o,c,f){const d=5*e+2;l.float32[d+0]=o,l.float32[d+1]=c,l.float32[d+2]=f},i.bt=Oy,i.bu=v2,i.bv=me,i.bw=ys,i.bx=wS,i.by=iT,i.bz=MS,i.c=We,i.c$=(l,e,o,c,f,d,g,S)=>{const M=l.transform,L=M.pitch<15?KS(.07,.7,Dt((14-M.zoom)/5,0,1)):.07,w=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:QS(l,e,o,c),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:M.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:f,u_width_scale:d,u_floor_width_scale:g,u_image:0,u_tile_units_to_pixels:JS(e,M),u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:S,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(w?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:a(e.tileID.canonical,0)}},i.c0=Q2,i.c1=function(l){const e=Q2(l,!0);return Le.mat2.invert([],[e[0],e[1],e[4],e[5]])},i.c2=dr,i.c3=function(l){const{x:e,y:o}=l.point,{lng:c,lat:f}=l._center;return gs(e,o,l.worldSize,c,f)},i.c4=ir,i.c5=cn,i.c6=Hu,i.c7=function(l){const e=Math.round((l+45+360)%360/90)%4;return cr[e]},i.c8=45,i.c9=Zd,i.cA=class extends Ca{constructor(l){super(l),this.current=cm}set(l,e,o){if(this.fetchUniformLocation(l,e)){for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},i.cB=Er,i.cC=function(l,e,o){const c=is(o.zoom),f=l.style.map._antialias,d=e.options.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return c===0&&!f&&!d},i.cD=function(l){const e=l.pixelsPerMeter,o=e/vi(1,l.center.lat),c=Le.mat4.identity(new Float64Array(16));return Le.mat4.translate(c,c,[l.point.x,l.point.y,0]),Le.mat4.scale(c,c,[o,o,e]),Float32Array.from(c)},i.cE=Gr,i.cF=function(l){const e=Fo-5;l=Dt(l,-80.051129,e)/e*90;const o=Math.pow(Math.abs(Math.sin(_n(l))),3);return Math.round(o*(Zu.length-1))},i.cG=function(l,e,o,c){const f=e.getNorth(),d=e.getSouth(),g=e.getWest(),S=e.getEast(),M=1<<l.z,L=S-g,w=f-d,A=L/fc,R=-w/Zu[o],C=[0,A,0,R,0,0,f,g,0];if(l.z>0){const P=180/c;Le.mat3.multiply(C,C,[P/L+1,0,0,0,P/w+1,0,-.5*P/A,.5*P/R,1])}return C[2]=M,C[5]=l.x,C[8]=l.y,C},i.cH=qi,i.cI=function(l,e,o){const c=Le.mat4.identity(new Float64Array(16)),f=(e/(1<<l)-.5)*Math.PI*2;return Le.mat4.rotateY(c,o.globeMatrix,f),Float32Array.from(c)},i.cJ=class{isDataAvailableAtPoint(l){const e=this._source();if(this.isUsingMockSource()||!e||l.y<0||l.y>1)return!1;const o=e.getSource().maxzoom,c=1<<o,f=Math.floor(l.x),d=Math.floor((l.x-f)*c),g=Math.floor(l.y*c),S=this.findDEMTileFor(new Zt(o,f,o,d,g));return!(!S||!S.dem)}getAtPointOrZero(l,e=0){return this.getAtPoint(l,e)||0}getAtPoint(l,e,o=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const c=this._source();if(!c||l.y<0||l.y>1)return e;const f=c.getSource().maxzoom,d=1<<f,g=Math.floor(l.x),S=l.x-g,M=new Zt(f,g,f,Math.floor(S*d),Math.floor(l.y*d)),L=this.findDEMTileFor(M);if(!L||!L.dem)return e;const w=L.dem,A=1<<L.tileID.canonical.z,R=(S*A-L.tileID.canonical.x)*w.dim,C=(l.y*A-L.tileID.canonical.y)*w.dim,P=Math.floor(R),D=Math.floor(C);return(o?this.exaggeration():1)*Fn(Fn(w.get(P,D),w.get(P,D+1),C-D),Fn(w.get(P+1,D),w.get(P+1,D+1),C-D),R-P)}getAtTileOffset(l,e,o){const c=1<<l.canonical.z;return this.getAtPointOrZero(new p(l.wrap+(l.canonical.x+e/tn)/c,(l.canonical.y+o/tn)/c))}getAtTileOffsetFunc(l,e,o,c){return f=>{const d=this.getAtTileOffset(l,f.x,f.y),g=c.upVector(l.canonical,f.x,f.y),S=c.upVectorScale(l.canonical,e,o).metersToTile;return Le.vec3.scale(g,g,d*S),g}}getForTilePoints(l,e,o,c){if(this.isUsingMockSource())return!1;const f=Im.create(this,l,c);return!!f&&(e.forEach(d=>{d[2]=this.exaggeration()*f.getElevationAt(d[0],d[1],o)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(l);if(!e||!e.dem)return null;const o=e.dem.tree,c=e.tileID,f=1<<l.canonical.z-c.canonical.z;let d=l.canonical.x/f-c.canonical.x,g=l.canonical.y/f-c.canonical.y,S=0;for(let M=0;M<l.canonical.z-c.canonical.z&&!o.leaves[S];M++){d*=2,g*=2;const L=2*Math.floor(g)+Math.floor(d);S=o.childOffsets[S]+L,d%=1,g%=1}return{min:this.exaggeration()*o.minimums[S],max:this.exaggeration()*o.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,e,o){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let e=!1,o=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const f of l){const d=this.getMinMaxForTile(f.tileID);d&&(o=Math.min(o,d.min),c=Math.max(c,d.max),e=!0)}return e?{min:o,max:c}:null}},i.cK=Mg,i.cL=Br,i.cM=function(l,e){return[Math.pow(l[0],2.2)*e,Math.pow(l[1],2.2)*e,Math.pow(l[2],2.2)*e]},i.cN=ms,i.cO=be,i.cP=ge,i.cQ=256,i.cR=function(l,e){const o=[0,0,0],c=ei(qi(e.canonical));return Le.vec3.transformMat4(o,o,c),Le.vec3.transformMat4(o,o,l),o},i.cS=l=>({u_camera_to_center_distance:new wi(l),u_extrude_scale:new rs(l),u_device_pixel_ratio:new wi(l),u_matrix:new Wu(l),u_inv_rot_matrix:new Wu(l),u_merc_center:new Xs(l),u_tile_id:new tf(l),u_zoom_transition:new wi(l),u_up_dir:new tf(l),u_emissive_strength:new wi(l)}),i.cT=l=>({u_matrix:new Wu(l),u_pixels_to_tile_units:new rs(l),u_device_pixel_ratio:new wi(l),u_width_scale:new wi(l),u_floor_width_scale:new wi(l),u_units_to_pixels:new Xs(l),u_dash_image:new Ma(l),u_gradient_image:new Ma(l),u_image_height:new wi(l),u_texsize:new Xs(l),u_tile_units_to_pixels:new wi(l),u_alpha_discard_threshold:new wi(l),u_trim_offset:new Xs(l),u_trim_fade_range:new Xs(l),u_trim_color:new qu(l),u_emissive_strength:new wi(l),u_zbias_factor:new wi(l),u_tile_to_meter:new wi(l)}),i.cU=l=>({u_matrix:new Wu(l),u_texsize:new Xs(l),u_pixels_to_tile_units:new rs(l),u_device_pixel_ratio:new wi(l),u_width_scale:new wi(l),u_floor_width_scale:new wi(l),u_image:new Ma(l),u_units_to_pixels:new Xs(l),u_tile_units_to_pixels:new wi(l),u_alpha_discard_threshold:new wi(l),u_trim_offset:new Xs(l),u_trim_fade_range:new Xs(l),u_trim_color:new qu(l),u_emissive_strength:new wi(l),u_zbias_factor:new wi(l),u_tile_to_meter:new wi(l)}),i.cV=Uu,i.cW=wk,i.cX=Sk,i.cY=Kh,i.cZ=(l,e,o,c,f,d)=>{const g=l.transform,S=g.projection.name==="globe";let M;if(d.paint.get("circle-pitch-alignment")==="map")if(S){const w=ms(g.zoom,e.canonical)*g._pixelsPerMercatorPixel;M=Float32Array.from([w,0,0,w])}else M=g.calculatePixelsToTileUnitsMatrix(o);else M=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const L={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(g.projection),u_matrix:l.translatePosMatrix(e.projMatrix,o,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:un.devicePixelRatio,u_extrude_scale:M,u_inv_rot_matrix:Xd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(S){L.u_inv_rot_matrix=c,L.u_merc_center=f,L.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],L.u_zoom_transition=is(g.zoom);const w=f[0]*tn,A=f[1]*tn;L.u_up_dir=g.projection.upVector(new Ct(0,0,0),w,A)}return L},i.c_=e2,i.ca=qu,i.cb=function(l,e,o){const c=Math.sqrt(l*l+e*e+o*o),f=c>0?Math.acos(o/c)*qn:0;let d=l!==0||e!==0?Math.atan2(-e,-l)*qn+90:0;return d<0&&(d+=360),[c,d,f]},i.cc=a,i.cd=Cn,i.ce=Wi,i.cf=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},i.cg=function(l,e){return l.readFields(mL,{icons:[]},e)},i.ch=function(l){return l({pluginStatus:ts,pluginURL:Gs}),qa.on("pluginStateChange",l),l},i.ci=Hy,i.cj=Tm,i.ck=o0,i.cl=Jo,i.cm=qc,i.cn=Vn,i.co=Rc,i.cp=Ar,i.cq=function(l){const e=l.indexOf(Hs);return e>=0?l.slice(0,e):l},i.cr=function(l){return l.indexOf(Hs)>=0},i.cs=function(l){const e=l.indexOf(Hs);return e>=0?l.slice(e+1):""},i.ct=function(l){const e=[],o=l.id;return o===void 0&&e.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&e.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},i.cu=function(l,e,o,c){return l.type==="custom"?new tL(l,e):new hL[l.type](l,e,o,c)},i.cv=Yn,i.cw=class extends Dm{constructor(l,e){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state={...l.state}),this.target=e.target,this.namespace=e.namespace,e.properties&&(this.properties=e.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=l.source,this.sourceLayer=l.sourceLayer,this.layer=l.layer)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},i.cx=qa,i.cy=ll,i.cz=nf,i.d=function(l){return Re.API_TILEJSON_REGEX.test(l)},i.d$=qr,i.d0=(l,e,o,c,f,d,g,S,M)=>{const L=l.transform,w=L.calculatePixelsToTileUnitsMatrix(e),A=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",R=L.pitch<15?KS(.07,.7,Dt((14-L.zoom)/5,0,1)):.07;return{u_matrix:QS(l,e,o,c),u_pixels_to_tile_units:w,u_device_pixel_ratio:d,u_width_scale:g,u_floor_width_scale:S,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:t2(o)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:JS(e,l.transform),u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(A?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:R,u_tile_to_meter:a(e.tileID.canonical,0)}},i.d1=Hn,i.d2=Jh,i.d3=US,i.d4=mn,i.d5=by,i.d6=ep,i.d7=450,i.d8=7,i.d9=eL,i.dA=fi,i.dB=t,i.dC=mc,i.dD=function([l,e,o]){const c=Math.hypot(l,e,o),f=Math.atan2(l,o),d=.5*Math.PI-Math.acos(-e/c);return new Or(ir(f),ir(d))},i.dE=y0,i.dF=function(l){const e=l.navigator?l.navigator.userAgent:null;return!!function(o){if(ia==null){const c=o.navigator?o.navigator.userAgent:null;ia=!!o.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return ia}(l)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(l,e){Kn=l,Xn=e},i.dH=_s,i.dI=os,i.dJ=function(l){const e=[0,0,0],o=Le.mat4.identity(new Float64Array(16));return Le.mat4.multiply(o,l.pixelMatrix,l.globeMatrix),Le.vec3.transformMat4(e,e,o),new _t(e[0],e[1])},i.dK=function(l,e,o=!1){if(ts===zd||ts===la||ts===Fh)throw new Error("setRTLTextPlugin cannot be called multiple times.");Gs=un.resolveURL(l),ts=zd,Ou=e,Bh(),o||Up()},i.dL=Wc,i.dM=function(){Hy().acquire(T0)},i.dN=function(){const l=Wg;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(T0),Wg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=hf,i.dP=function(l){const e=Hr();if(!e)return;const o=e.delete(tr);l&&o.catch(l).then(()=>l())},i.dQ=qg,i.dR=qT,i.dS=function(l){D0=un.resolveURL(l),zm||(zm=new Am(Hy(),new kc)),zm.broadcast("setDracoUrl",D0)},i.dT=WT,i.dU=function(l){Lm=un.resolveURL(l),zm||(zm=new Am(Hy(),new kc)),zm.broadcast("setMeshoptUrl",Lm)},i.dV=dn,i.dW=_c,i.dX=cu,i.dY=tE,i.dZ=nE,i.d_=HS,i.da=Dr,i.db=Wh,i.dc=256,i.dd=Ho,i.de=Zs,i.df=ps,i.dg=Nd,i.dh=function(l,e,o,c,f){return Dt((l-e)/(o-e)*(f-c)+c,c,f)},i.di=ba,i.dj=h,i.dk=class{constructor(l,e,o,c){this.context=l,this.format=c,this.size=o,this.texture=l.gl.createTexture();const[f,d,g]=this.size,{gl:S}=l;S.bindTexture(S.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),S.texImage3D(S.TEXTURE_3D,0,this.format,f,d,g,0,f0(this.format),m0(this.format),e.data)}bind(l,e){const{context:o}=this,{gl:c}=o;c.bindTexture(c.TEXTURE_3D,this.texture),l!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,l),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,l),this.minFilter=l),e!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,e),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},i.dl=v0,i.dm=[1,1,1],i.dn=Im,i.dp=Mm,i.dq=Ao,i.dr=hc,i.ds=iu,i.dt=Jc,i.du=Gh,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new _t(1/0,1/0),max:new _t(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,e=!1){const o=TS(new _t(0,0),new _t(tn,tn),l),c=[];if(e&&!Gx(o,this._globalClipBounds))return c;for(const f of this._activeRegions){if(f.hiddenByOverlap||!Gx(o,f))continue;const d=XR(f.min,f.max,l);c.push({min:d.min,max:d.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return c}setSources(l){this._setSources(l.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const o=[];for(const c of e.cache.getVisibleCoordinates()){const f=e.cache.getTile(c).buckets[e.layer];f&&f.updateFootprints(c.toUnwrapped(),o)}return o},getOrder:()=>e.order,getClipMask:()=>e.clipMask,getClipScope:()=>e.clipScope})))}_addSource(l){const e=l.getFootprints();if(e.length===0)return;const o=l.getOrder(),c=l.getClipMask(),f=l.getClipScope();for(const d of e){if(!d.footprint)continue;const g=TS(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:g.min,max:g.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint,order:o,clipMask:c,clipScope:f})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((e,o)=>e.priority-o.priority||vy(e.min,o.min)||vy(e.max,o.max)||e.order-o.order||e.clipMask-o.clipMask||function(c,f){const d=(g,S)=>g+S;return c.length-f.length||c.reduce(d,"").localeCompare(f.reduce(d,""))}(e.clipScope,o.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let e=0;for(;!l&&e!==this._activeRegions.length;){const o=this._activeRegions[e],c=this._prevRegions[e];l=o.priority!==c.priority||!SS(o,c)||o.order!==c.order||o.clipMask!==c.clipMask||!er(o.clipScope,c.clipScope),++e}}if(l){++this._updateTime;for(const o of this._activeRegions)o.order!==yy&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const e=o=>{const c=this._activeRegions;if(o>=c.length)return o;const f=c[o].priority;for(;o<c.length&&c[o].priority===f;)++o;return o};if(this._sourceIds.length>1){let o=0,c=e(o);for(;o!==c;){let f=o;const d=o;for(;f!==c;){const g=this._activeRegions[f];g.hiddenByOverlap=!1;for(let S=0;S<d;S++){const M=this._activeRegions[S];if(!M.hiddenByOverlap&&g.order===yy&&Gx(g,M)&&(g.hiddenByOverlap=CS(g.footprint,g.tileId,M.footprint,M.tileId),g.hiddenByOverlap))break}++f}o=c,c=e(o)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=l.length-1;e>=0;e--)this._addSource(l[e]);this._computeReplacement()}},i.dw=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,e){const o=new Go,c=new Po,f=[],d=l+1+2,g=e[0]+1,S=e[0]+1+(1+e.length),M=(L,w,A)=>{let R=L===d-1?L-2:L===0?L:L-1;return R+=A?24575:0,[R,w]};for(let L=0;L<d;++L)o.emplaceBack(...M(L,0,!0));for(let L=0;L<g;++L)for(let w=0;w<d;++w)o.emplaceBack(...M(w,L,(w===0||w===d-1)&&!0));for(let L=0;L<e.length;++L){const w=e[L];for(let A=0;A<d;++A)o.emplaceBack(...M(A,w,!0))}for(let L=0;L<e.length;++L){const w=c.length,A=e[L]+1+2,R=new Po;for(let D=0;D<A-1;D++){const V=D===A-2,q=V?d*(S-e.length+L-D):d;for(let K=0;K<d-1;K++){const Q=D*d+K;D===0||V||K===0||K===d-2?(R.emplaceBack(Q+1,Q,Q+q),R.emplaceBack(Q+q,Q+q+1,Q+1)):(c.emplaceBack(Q+1,Q,Q+q),c.emplaceBack(Q+q,Q+q+1,Q+1))}}const C=Ui.simpleSegment(0,w,o.length,c.length-w);for(let D=0;D<R.uint16.length;D+=3)c.emplaceBack(R.uint16[D],R.uint16[D+1],R.uint16[D+2]);const P=Ui.simpleSegment(0,w,o.length,c.length-w);f.push({withoutSkirts:C,withSkirts:P})}return{vertices:o,indices:c,segments:f}}_createGrid(l){const e=this._fillGridMeshWithLods(fc,Zu);this._gridSegments=e.segments,this._gridBuffer=l.createVertexBuffer(e.vertices,Gn.members),this._gridIndexBuffer=l.createIndexBuffer(e.indices,!0)}_createPoles(l){const e=new Po;for(let g=0;g<=fc;g++)e.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=l.createIndexBuffer(e,!0);const o=new ps,c=new ps,f=new ps,d=new ps;this._poleSegments=[];for(let g=0,S=0;g<Hu;g++){const M=360/(1<<g);o.emplaceBack(0,-qo,0,.5,0),c.emplaceBack(0,-qo,0,.5,1),f.emplaceBack(0,-qo,0,.5,.5),d.emplaceBack(0,-qo,0,.5,.5);for(let L=0;L<=fc;L++){let w=L/fc,A=0;const R=Fn(0,M,w),[C,P,D]=Ms(Ja,gc,R,qo);o.emplaceBack(C,P,D,w,A),c.emplaceBack(C,P,D,w,1-A);const V=_n(R);w=.5+.5*Math.sin(V),A=.5+.5*Math.cos(V),f.emplaceBack(C,P,D,w,A),d.emplaceBack(C,P,D,w,1-A)}this._poleSegments.push(Ui.simpleSegment(S,0,66,64)),S+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(o,In,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(c,In,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(f,In,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(d,In,!1)}getGridBuffers(l,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},i.dx=yy,i.dy=On,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=Re,i.e0=js,i.e1=b2,i.e2=function(l,e,o,c,f,d,g,S,M,L,w=1,A,R){l.createArrays(),l.tilePixelRatio=tn/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const C=l.layers[0].layout,P=l.layers[0]._unevaluatedLayout._values,D={};D.scaleFactor=w,D.textSizeScaleRange=C.get("text-size-scale-range"),D.iconSizeScaleRange=C.get("icon-size-scale-range");const[V,q]=D.textSizeScaleRange,[K,Q]=D.iconSizeScaleRange;if(D.textScaleFactor=Dt(D.scaleFactor,V,q),D.iconScaleFactor=Dt(D.scaleFactor,K,Q),l.textSizeData.kind==="composite"){const{minZoom:ye,maxZoom:Ce}=l.textSizeData;D.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Jr(ye),S),P["text-size"].possiblyEvaluate(new Jr(Ce),S)]}if(l.iconSizeData.kind==="composite"){const{minZoom:ye,maxZoom:Ce}=l.iconSizeData;D.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Jr(ye),S),P["icon-size"].possiblyEvaluate(new Jr(Ce),S)]}D.layoutTextSize=P["text-size"].possiblyEvaluate(new Jr(M+1),S),D.layoutIconSize=P["icon-size"].possiblyEvaluate(new Jr(M+1),S),D.textMaxSize=P["text-size"].possiblyEvaluate(new Jr(18),S);const X=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point",re=C.get("text-size");let de=!1;for(const ye of l.features)if(ye.icon&&ye.icon.nameSecondary){de=!0;break}for(const ye of l.features){const Ce=C.get("text-font").evaluate(ye,{},S).join(","),Ee=re.evaluate(ye,{},S)*D.textScaleFactor,Te=D.layoutTextSize.evaluate(ye,{},S)*D.textScaleFactor,Be=(D.layoutIconSize.evaluate(ye,{},S),{horizontal:{},vertical:void 0}),Ae=ye.text;let Ue,He=[0,0];if(Ae){const dt=Ae.toString(),Qe=C.get("text-letter-spacing").evaluate(ye,{},S)*ys,wt=C.get("text-line-height").evaluate(ye,{},S)*ys,qt=Dh(dt)?Qe:0,Tt=C.get("text-anchor").evaluate(ye,{},S),Qt=C.get("text-variable-anchor");if(!Qt){const en=C.get("text-radial-offset").evaluate(ye,{},S);He=en?M2(Tt,[en*ys,s0]):C.get("text-offset").evaluate(ye,{},S).map(bn=>bn*ys)}let Kt=X?"center":C.get("text-justify").evaluate(ye,{},S);const ln=C.get("symbol-placement")==="point",Pt=ln?C.get("text-max-width").evaluate(ye,{},S)*ys:1/0,En=en=>{l.allowVerticalPlacement&&Ld(dt)&&(Be.vertical=n0(Ae,e,o,f,Ce,Pt,wt,Tt,en,qt,He,Rl.vertical,!0,Te,Ee))};if(!X&&Qt){const en=Kt==="auto"?Qt.map(Un=>a0(Un)):[Kt];let bn=!1;for(let Un=0;Un<en.length;Un++){const hr=en[Un];if(!Be.horizontal[hr])if(bn)Be.horizontal[hr]=Be.horizontal[0];else{const _r=n0(Ae,e,o,f,Ce,Pt,wt,"center",hr,qt,He,Rl.horizontal,!1,Te,Ee);_r&&(Be.horizontal[hr]=_r,bn=_r.positionedLines.length===1)}}En("left")}else{if(Kt==="auto"&&(Kt=a0(Tt)),ln||C.get("text-writing-mode").indexOf("horizontal")>=0||!Ld(dt)){const en=n0(Ae,e,o,f,Ce,Pt,wt,Tt,Kt,qt,He,Rl.horizontal,!1,Te,Ee);en&&(Be.horizontal[Kt]=en)}En(ln?"left":Kt)}}let Ge=!1,Ke=!1;if(ye.icon&&ye.icon.namePrimary){const dt=wy(l.iconSizeData,P["icon-size"],S,l.zoom,ye)*D.iconScaleFactor*A,Qe=ye.icon.getPrimary().scaleSelf(dt).serialize(),wt=c[Qe];wt&&(Ue=zk(f[Qe],ye.icon.nameSecondary?f[ye.icon.getSecondary().scaleSelf(dt).serialize()]:void 0,C.get("icon-offset").evaluate(ye,{},S),C.get("icon-anchor").evaluate(ye,{},S)),Ge=wt.sdf,Ke=wt.usvg,l.sdfIcons===void 0?l.sdfIcons=wt.sdf:l.sdfIcons!==wt.sdf&&$n("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(wt.pixelRatio!==l.pixelRatio||C.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const rt=A2(Be.horizontal)||Be.vertical;l.iconsInText||(l.iconsInText=!!rt&&rt.iconsInText),(rt||Ue)&&Uk(l,ye,Be,Ue,c,D,Te,0,He,Ge,Ke,g,S,L,R,de)}d&&l.generateCollisionDebugBuffers(M,l.collisionBoxArray,D.textScaleFactor)},i.e3=bm,i.e4=Qy,i.e5=zn,i.e6=yS,i.e7=a2,i.e8=I,i.e9=function(l){let e=0;if(new Uint32Array(l,0,1)[0]!==ZT){const o=new Uint32Array(l,0,7),[,,c,f,d,g]=o;e=o.byteLength+f+d+g+d,(c!==l.byteLength||e>=l.byteLength)&&$n("Invalid b3dm header information.")}return JT(l,e)},i.ea=function(l,e){const o=eE(l);for(const c of o){for(const f of c.meshes)g3(f);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(_3(c.lights,e)))}return o},i.eb=Wy,i.ec=gT,i.ed=qs,i.ee=function(l){Xr(),Nr!=null&&Nr.then(e=>{e.keys().then(o=>{for(let c=0;c<o.length-l;c++)e.delete(o[c])})})},i.f=function(l){return l.indexOf("mapbox:")===0},i.g=function(l,e){return ll(Pn(l,{method:"GET"}),e)},i.h=qe,i.i=function(l){return Re.API_STYLE_REGEX.test(l)&&!We(l)},i.j=function(l){return decodeURIComponent(atob(l).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(e,o)=>String.fromCharCode(+("0x"+o))))},i.l=Pn,i.m=Yo,i.n=function(l,e){return ll(Pn(l,{type:"json"}),e)},i.o=Pc,i.p=function(l,e){return ll(Pn(l,{method:"POST"}),e)},i.q=un,i.r=ss,i.s=function(l){try{const e=self[l];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Xt,i.u=function(){return function l(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},i.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},i.w=$n,i.x=function(){return E0||(E0=new hf),E0},i.y=ul,i.z=ri}),y(["./shared"],function(i){function I(ht){const ge=ht?ht.url.toString():void 0;return ge?performance.getEntriesByName(ge):[]}function F(ht){if(typeof ht=="number"||typeof ht=="boolean"||typeof ht=="string"||ht==null)return JSON.stringify(ht);if(Array.isArray(ht)){let be="[";for(const Re of ht)be+=`${F(Re)},`;return`${be}]`}let ge="{";for(const be of Object.keys(ht).sort())ge+=`${be}:${F(ht[be])},`;return`${ge}}`}function B(ht){let ge="";for(const be of i.bm)ge+=`/${F(ht[be])}`;return ge}class G{constructor(ge){this.keyCache={},this._layers={},this._layerConfigs={},ge&&this.replace(ge)}replace(ge,be){this._layerConfigs={},this._layers={},this.update(ge,[],be)}update(ge,be,Re){this._options=Re;for(const We of ge)this._layerConfigs[We.id]=We,(this._layers[We.id]=i.cu(We,this.scope,null,this._options)).compileFilter(Re),this.keyCache[We.id]&&delete this.keyCache[We.id];for(const We of be)delete this.keyCache[We],delete this._layerConfigs[We],delete this._layers[We];this.familiesBySource={};const qe=function(We,tt){const mt={};for(let yt=0;yt<We.length;yt++){const bt=We[yt];let Et=tt&&tt[bt.id];!Et&&(Et=B(bt),bt.type==="line"&&bt.paint)&&function un(an){return typeof an=="string"&&an==="line-progress"||(Array.isArray(an)?an.some(un):!(!an||typeof an!="object")&&Object.values(an).some(un))}(bt.paint["line-width"])&&(Et+=`/${F(bt.paint["line-width"])}`),tt&&(tt[bt.id]=Et);let Xt=mt[Et];Xt||(Xt=mt[Et]=[]),Xt.push(bt)}const it=[];for(const yt in mt)it.push(mt[yt]);return it}(i.bj(this._layerConfigs),this.keyCache);for(const We of qe){const tt=We.map(Xt=>this._layers[Xt.id]),mt=tt[0];if(mt.visibility==="none")continue;const it=mt.source||"";let yt=this.familiesBySource[it];yt||(yt=this.familiesBySource[it]={});const bt=mt.sourceLayer||"_geojsonTileLayer";let Et=yt[bt];Et||(Et=yt[bt]=[]),Et.push(tt)}}}const J=1*i.dX;class te{constructor(ge){const be={},Re=[];for(const mt in ge){const it=ge[mt],yt=be[mt]={};for(const bt in it.glyphs){const Et=it.glyphs[+bt];if(!Et||Et.bitmap.width===0||Et.bitmap.height===0)continue;const Xt=Et.metrics.localGlyph?J:1,un={x:0,y:0,w:Et.bitmap.width+2*Xt,h:Et.bitmap.height+2*Xt};Re.push(un),yt[bt]=un}}const{w:qe,h:We}=i.C(Re),tt=new i.dW({width:qe||1,height:We||1});for(const mt in ge){const it=ge[mt];for(const yt in it.glyphs){const bt=it.glyphs[+yt];if(!bt||bt.bitmap.width===0||bt.bitmap.height===0)continue;const Et=be[mt][yt],Xt=bt.metrics.localGlyph?J:1;i.dW.copy(bt.bitmap,tt,{x:0,y:0},{x:Et.x+Xt,y:Et.y+Xt},bt.bitmap)}}this.image=tt,this.positions=be}}i.dV(te,"GlyphAtlas");class H{constructor(ge){this.tileID=new i.aG(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.lut=ge.lut,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.scope=ge.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ge.showCollisionBoxes,this.collectResourceTiming=!!ge.request&&ge.request.collectResourceTiming,this.promoteId=ge.promoteId,this.isSymbolTile=ge.isSymbolTile,this.tileTransform=i.aQ(ge.tileID.canonical,ge.projection),this.projection=ge.projection,this.worldview=ge.worldview,this.localizableLayerIds=ge.localizableLayerIds,this.brightness=ge.brightness,this.extraShadowCaster=!!ge.extraShadowCaster,this.tessellationStep=ge.tessellationStep,this.scaleFactor=ge.scaleFactor}parse(ge,be,Re,qe,We){this.status="parsing",this.data=ge,this.collisionBoxArray=new i.aW;const tt=new i.dY(Object.keys(ge.layers).sort()),mt=new i.dZ(this.tileID,this.promoteId);mt.bucketLayerIDs=[];const it={},yt=new i.d_(256,256),bt={featureIndex:mt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:yt,availableImages:Re,brightness:this.brightness,scaleFactor:this.scaleFactor},Et=be.familiesBySource[this.source];for(const Xn in Et){const Wr=ge.layers[Xn];if(!Wr)continue;let Nr=!1,wr=!1,Hr=!1;for(const Yo of Et[Xn])Yo[0].type==="symbol"?Nr=!0:wr=!0,Yo[0].is3D()&&Yo[0].type!=="model"&&(Hr=!0);if(this.extraShadowCaster&&!Hr||this.isSymbolTile===!0&&!Nr||this.isSymbolTile===!1&&!wr)continue;Wr.version===1&&i.w(`Vector tile source "${this.source}" layer "${Xn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xr=tt.encode(Xn),Vr=[];for(let Yo=0,no=0;Yo<Wr.length;Yo++){const go=Wr.feature(Yo),Aa=mt.getId(go,Xn);if(this.localizableLayerIds&&this.localizableLayerIds.has(Xn)){const Pa=go.properties?go.properties.worldview:null;if(this.worldview&&typeof Pa=="string")if(Pa==="all")go.properties.$localized=!0;else{if(!Pa.split(",").includes(this.worldview))continue;go.properties.$localized=!0,go.properties.worldview=this.worldview}}Vr.push({feature:go,id:Aa,index:no,sourceLayerIndex:Xr}),no++}for(const Yo of Et[Xn]){const no=Yo[0];(!this.extraShadowCaster||no.is3D()&&no.type!=="model")&&(this.isSymbolTile!==void 0&&no.type==="symbol"!==this.isSymbolTile||no.minzoom&&this.zoom<Math.floor(no.minzoom)||no.maxzoom&&this.zoom>=no.maxzoom||no.visibility!=="none"&&(j(Yo,this.zoom,bt.brightness,Re),(it[no.id]=no.createBucket({index:mt.bucketLayerIDs.length,layers:Yo,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Vr,bt,this.tileID.canonical,this.tileTransform),mt.bucketLayerIDs.push(Yo.map(go=>i.aC(go.id,go.scope)))))}}let Xt,un,an,Vn;yt.trim();const tr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Kn=()=>{if(Xt)return this.status="done",We(Xt);if(this.extraShadowCaster)this.status="done",We(null,{buckets:i.bj(it).filter(Xn=>!Xn.isEmpty()),featureIndex:mt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:bt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(un&&an&&Vn){const Xn=new te(un),Wr=new i.e1(an,Vn,this.lut);for(const Nr in it){const wr=it[Nr];wr instanceof i.aX?(j(wr.layers,this.zoom,bt.brightness,Re),i.e2(wr,un,Xn.positions,an,Wr.iconPositions,this.showCollisionBoxes,Re,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):wr.hasPattern&&(wr instanceof i.b1||wr instanceof i.b2||wr instanceof i.d5)&&(j(wr.layers,this.zoom,bt.brightness,Re),wr.addFeatures(bt,this.tileID.canonical,Wr.patternPositions,Re,this.tileTransform,this.brightness))}this.status="done",We(null,{buckets:i.bj(it).filter(Nr=>!Nr.isEmpty()),featureIndex:mt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xn.image,lineAtlas:yt,imageAtlas:Wr,brightness:bt.brightness})}};if(!this.extraShadowCaster){const Xn=i.d$(bt.glyphDependencies,wr=>Object.keys(wr).map(Number));Object.keys(Xn).length?qe.send("getGlyphs",{uid:this.uid,stacks:Xn,scope:this.scope},(wr,Hr)=>{Xt||(Xt=wr,un=Hr,Kn())},void 0,!1,tr):un={};const Wr=Object.keys(bt.iconDependencies);Wr.length?qe.send("getImages",{icons:Wr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(wr,Hr)=>{if(Xt)return;Xt=wr;const Xr={};Object.values(Hr).some(Vr=>Vr.usvg)?this.rasterize(qe,Xr,Hr,bt.iconDependencies,()=>{an=Xr,Kn()}):(this.fillImageMap(Xr,bt.iconDependencies,Hr),an=Xr,Kn())},void 0,!1,tr):an={};const Nr=Object.keys(bt.patternDependencies);Nr.length?qe.send("getImages",{icons:Nr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(wr,Hr)=>{if(!Xt){Xt=wr;const Xr={};Object.values(Hr).some(Vr=>Vr.usvg)?this.rasterize(qe,Xr,Hr,bt.patternDependencies,()=>{Vn=Xr,Kn()}):(this.fillImageMap(Xr,bt.patternDependencies,Hr),Vn=Xr,Kn())}},void 0,!1,tr):Vn={}}Kn()}fillImageMap(ge,be,Re){for(const qe in Re){const We=be[qe]||[];for(const tt of We)Re[tt.id].usvg||(ge[tt.serialize()]=Re[tt.id])}}getImageTaskQueue(ge,be,Re){const qe={};for(const We in be){const tt=Re[We]||[];for(const mt of tt){const it=mt.serialize();be[mt.id].usvg?qe[it]||(qe[it]=mt):ge[it]=be[mt.id]}}return qe}rasterize(ge,be,Re,qe,We){const tt=this.getImageTaskQueue(be,Re,qe);this.rasterizeTask=ge.send("rasterizeImages",{scope:this.scope,imageTasks:tt},(mt,it)=>{if(!mt)for(const yt in it){const{id:bt}=i.e0.deserializeFromString(yt);be[yt]=Object.assign({},Re[bt],{data:it[yt]})}We()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function j(ht,ge,be,Re){const qe=new i.a8(ge,{brightness:be});for(const We of ht)We.recalculate(qe,Re)}class ne extends i.E{constructor(ge,be,Re,qe,We,tt){super(),this.actor=ge,this.layerIndex=be,this.availableImages=Re,this.loadVectorData=We||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(ge.scheduler),this.isSpriteLoaded=qe,this.scheduler=ge.scheduler,this.brightness=tt}loadTile(ge,be){const Re=ge.uid,qe=ge&&ge.request,We=qe&&qe.collectResourceTiming,tt=this.loading[Re]=new H(ge);tt.abort=this.loadVectorData(ge,(mt,it)=>{const yt=!this.loading[Re];if(delete this.loading[Re],tt.cancelRasterize(),yt||mt||!it)return tt.status="done",yt||(this.loaded[Re]=tt),be(mt);const bt=it.rawData,Et={};it.expires&&(Et.expires=it.expires),it.cacheControl&&(Et.cacheControl=it.cacheControl),tt.vectorTile=it.vectorTile||new i.e3.VectorTile(new i.bh(bt));const Xt=()=>{tt.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor,(un,an)=>{if(un||!an)return be(un);const Vn={};if(We){const tr=I(qe);tr.length>0&&(Vn.resourceTiming=JSON.parse(JSON.stringify(tr)))}be(null,i.l({rawTileData:bt.slice(0)},an,Et,Vn))})};this.isSpriteLoaded?Xt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Xt,{type:"parseTile",isSymbolTile:ge.isSymbolTile,zoom:ge.tileZoom}):Xt()}),this.loaded=this.loaded||{},this.loaded[Re]=tt})}reloadTile(ge,be){const Re=this.loaded,qe=ge.uid;if(Re&&Re[qe]){const We=Re[qe];We.scaleFactor=ge.scaleFactor,We.showCollisionBoxes=ge.showCollisionBoxes,We.projection=ge.projection,We.brightness=ge.brightness,We.tileTransform=i.aQ(ge.tileID.canonical,ge.projection),We.extraShadowCaster=ge.extraShadowCaster,We.lut=ge.lut;const tt=(mt,it)=>{const yt=We.reloadCallback;yt&&(delete We.reloadCallback,We.parse(We.vectorTile,this.layerIndex,this.availableImages,this.actor,yt)),be(mt,it)};We.status==="parsing"?We.reloadCallback=tt:We.status==="done"&&(We.vectorTile?We.parse(We.vectorTile,this.layerIndex,this.availableImages,this.actor,tt):tt())}else be(null,void 0)}abortTile(ge,be){const Re=ge.uid,qe=this.loading[Re];qe&&(qe.abort&&qe.abort(),delete this.loading[Re]),be()}removeTile(ge,be){const Re=this.loaded,qe=ge.uid;Re&&Re[qe]&&delete Re[qe],be()}}class oe{loadTile(ge,be){const{uid:Re,encoding:qe,rawImageData:We,padding:tt}=ge,mt=ImageBitmap&&We instanceof ImageBitmap?this.getImageData(We,tt):We;be(null,new i.e4(Re,mt,qe,tt<1))}getImageData(ge,be){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ge.width,ge.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ge.width,this.offscreenCanvas.height=ge.height,this.offscreenCanvasContext.drawImage(ge,0,0,ge.width,ge.height);const Re=this.offscreenCanvasContext.getImageData(-be,-be,ge.width+2*be,ge.height+2*be);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Re}}i.bg.setPbf(i.bh);class pe{decodeRasterArray({task:ge,buffer:be},Re){i.bg.performDecoding(be,ge).then(qe=>{Re(null,qe)},qe=>{Re(qe)})}}const se=i.e3.VectorTileFeature.prototype.toGeoJSON;class ie{constructor(ge){this._feature=ge,this.extent=i.ag,this.type=ge.type,this.properties=ge.tags,"id"in ge&&!isNaN(ge.id)&&(this.id=parseInt(ge.id,10))}loadGeometry(){if(this._feature.type===1){const ge=[];for(const be of this._feature.geometry)ge.push([new i.P(be[0],be[1])]);return ge}{const ge=[];for(const be of this._feature.geometry){const Re=[];for(const qe of be)Re.push(new i.P(qe[0],qe[1]));ge.push(Re)}return ge}}toGeoJSON(ge,be,Re){return se.call(this,ge,be,Re)}}class ce{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=ge.length,this._features=ge}feature(ge){return new ie(this._features[ge])}}const we=64/4096,xe=128;class $e{constructor(){this.features=new Map}clear(){this.features.clear()}load(ge=[],be){for(const Re of ge){const qe=Re.id;if(qe==null)continue;let We=this.features.get(qe);We&&this.updateCache(We,be),Re.geometry?(We=ae(Re),this.updateCache(We,be),this.features.set(qe,We)):this.features.delete(qe),this.updateCache(We,be)}}updateCache(ge,be){for(const{canonical:Re,uid:qe}of Object.values(be)){const{z:We,x:tt,y:mt}=Re;Ze(ge,Math.pow(2,We),tt,mt)&&delete be[qe]}}getTile(ge,be,Re){const qe=Math.pow(2,ge),We=[];for(const tt of this.features.values())Ze(tt,qe,be,Re)&&We.push(st(tt,qe,be,Re));return{features:We}}getFeatures(){return[...this.features.values()]}}function Ze({minX:ht,minY:ge,maxX:be,maxY:Re},qe,We,tt){return ht<(We+1+we)/qe&&ge<(tt+1+we)/qe&&be>(We-we)/qe&&Re>(tt-we)/qe}function ae(ht){const{id:ge,geometry:be,properties:Re}=ht;if(!be)return;if(be.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:qe,coordinates:We}=be,tt={id:ge,type:1,geometry:[],tags:Re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},mt=tt.geometry;if(qe==="Point")ke(We,mt,tt);else if(qe==="MultiPoint")for(const it of We)ke(it,mt,tt);else if(qe==="LineString")tt.type=2,ct(We,mt,tt);else if(qe==="MultiLineString")tt.type=2,Xe(We,mt,tt);else if(qe==="Polygon")tt.type=3,Xe(We,mt,tt,!0);else{if(qe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");tt.type=3;for(const it of We)Xe(it,mt,tt,!0)}return tt}function ke([ht,ge],be,Re){const qe=i.at(ht);let We=i.aA(ge);We=We<0?0:We>1?1:We,be.push(qe,We),Re.minX=Math.min(Re.minX,qe),Re.minY=Math.min(Re.minY,We),Re.maxX=Math.max(Re.maxX,qe),Re.maxY=Math.max(Re.maxY,We)}function ct(ht,ge,be,Re=!1,qe=!1){const We=[];for(const tt of ht)ke(tt,We,be);ge.push(We),Re&&function(tt,mt){let it=0;for(let yt=0,bt=tt.length,Et=bt-2;yt<bt;Et=yt,yt+=2)it+=(tt[yt]-tt[Et])*(tt[yt+1]+tt[Et+1]);if(it>0===mt)for(let yt=0,bt=tt.length;yt<bt/2;yt+=2){const Et=tt[yt],Xt=tt[yt+1];tt[yt]=tt[bt-2-yt],tt[yt+1]=tt[bt-1-yt],tt[bt-2-yt]=Et,tt[bt-1-yt]=Xt}}(We,qe)}function Xe(ht,ge,be,Re=!1){for(let qe=0;qe<ht.length;qe++)ct(ht[qe],ge,be,Re,qe===0)}function st(ht,ge,be,Re){const{id:qe,type:We,geometry:tt,tags:mt}=ht,it=[];if(We===1)(function(yt,bt,Et,Xt,un){for(let an=0;an<yt.length;an+=2){const Vn=Math.round(i.ag*(yt[an+0]*bt-Et)),tr=Math.round(i.ag*(yt[an+1]*bt-Xt));un.push([Vn,tr])}})(tt,ge,be,Re,it);else for(const yt of tt)et(yt,ge,be,Re,it);return{id:qe,type:We,geometry:it,tags:mt}}function et(ht,ge,be,Re,qe){const tt=i.ag+xe;let mt;for(let it=0;it<ht.length-2;it+=2){let yt=Math.round(i.ag*(ht[it+0]*ge-be)),bt=Math.round(i.ag*(ht[it+1]*ge-Re)),Et=Math.round(i.ag*(ht[it+2]*ge-be)),Xt=Math.round(i.ag*(ht[it+3]*ge-Re));const un=Et-yt,an=Xt-bt;yt<-128&&Et<-128||(yt<-128?(bt+=Math.round(an*((-128-yt)/un)),yt=-128):Et<-128&&(Xt=bt+Math.round(an*((-128-yt)/un)),Et=-128),bt<-128&&Xt<-128||(bt<-128?(yt+=Math.round(un*((-128-bt)/an)),bt=-128):Xt<-128&&(Et=yt+Math.round(un*((-128-bt)/an)),Xt=-128),yt>=tt&&Et>=tt||(yt>=tt?(bt+=Math.round(an*((tt-yt)/un)),yt=tt):Et>=tt&&(Xt=bt+Math.round(an*((tt-yt)/un)),Et=tt),bt>=tt&&Xt>=tt||(bt>=tt?(yt+=Math.round(un*((tt-bt)/an)),bt=tt):Xt>=tt&&(Et=yt+Math.round(un*((tt-bt)/an)),Xt=tt),mt&&yt===mt[mt.length-1][0]&&bt===mt[mt.length-1][1]||(mt=[[yt,bt]],qe.push(mt)),mt.push([Et,Xt])))))}}var gt,zt,at,Ye={exports:{}},Bt=function(){if(at)return Ye.exports;at=1;var ht=i.e7(),ge=function(){if(zt)return gt;zt=1;var bt=i.e5(),Et=i.e6().VectorTileFeature;function Xt(an,Vn){this.options=Vn||{},this.features=an,this.length=an.length}function un(an,Vn){this.id=typeof an.id=="number"?an.id:void 0,this.type=an.type,this.rawGeometry=an.type===1?[an.geometry]:an.geometry,this.properties=an.tags,this.extent=Vn||4096}return gt=Xt,Xt.prototype.feature=function(an){return new un(this.features[an],this.options.extent)},un.prototype.loadGeometry=function(){var an=this.rawGeometry;this.geometry=[];for(var Vn=0;Vn<an.length;Vn++){for(var tr=an[Vn],Kn=[],Xn=0;Xn<tr.length;Xn++)Kn.push(new bt(tr[Xn][0],tr[Xn][1]));this.geometry.push(Kn)}return this.geometry},un.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var an=this.geometry,Vn=1/0,tr=-1/0,Kn=1/0,Xn=-1/0,Wr=0;Wr<an.length;Wr++)for(var Nr=an[Wr],wr=0;wr<Nr.length;wr++){var Hr=Nr[wr];Vn=Math.min(Vn,Hr.x),tr=Math.max(tr,Hr.x),Kn=Math.min(Kn,Hr.y),Xn=Math.max(Xn,Hr.y)}return[Vn,Kn,tr,Xn]},un.prototype.toGeoJSON=Et.prototype.toGeoJSON,gt}();function be(bt){var Et=new ht;return function(Xt,un){for(var an in Xt.layers)un.writeMessage(3,Re,Xt.layers[an])}(bt,Et),Et.finish()}function Re(bt,Et){var Xt;Et.writeVarintField(15,bt.version||1),Et.writeStringField(1,bt.name||""),Et.writeVarintField(5,bt.extent||4096);var un={keys:[],values:[],keycache:{},valuecache:{}};for(Xt=0;Xt<bt.length;Xt++)un.feature=bt.feature(Xt),Et.writeMessage(2,qe,un);var an=un.keys;for(Xt=0;Xt<an.length;Xt++)Et.writeStringField(3,an[Xt]);var Vn=un.values;for(Xt=0;Xt<Vn.length;Xt++)Et.writeMessage(4,yt,Vn[Xt])}function qe(bt,Et){var Xt=bt.feature;Xt.id!==void 0&&Et.writeVarintField(1,Xt.id),Et.writeMessage(2,We,bt),Et.writeVarintField(3,Xt.type),Et.writeMessage(4,it,Xt)}function We(bt,Et){var Xt=bt.feature,un=bt.keys,an=bt.values,Vn=bt.keycache,tr=bt.valuecache;for(var Kn in Xt.properties){var Xn=Xt.properties[Kn],Wr=Vn[Kn];if(Xn!==null){Wr===void 0&&(un.push(Kn),Vn[Kn]=Wr=un.length-1),Et.writeVarint(Wr);var Nr=typeof Xn;Nr!=="string"&&Nr!=="boolean"&&Nr!=="number"&&(Xn=JSON.stringify(Xn));var wr=Nr+":"+Xn,Hr=tr[wr];Hr===void 0&&(an.push(Xn),tr[wr]=Hr=an.length-1),Et.writeVarint(Hr)}}}function tt(bt,Et){return(Et<<3)+(7&bt)}function mt(bt){return bt<<1^bt>>31}function it(bt,Et){for(var Xt=bt.loadGeometry(),un=bt.type,an=0,Vn=0,tr=Xt.length,Kn=0;Kn<tr;Kn++){var Xn=Xt[Kn],Wr=1;un===1&&(Wr=Xn.length),Et.writeVarint(tt(1,Wr));for(var Nr=un===3?Xn.length-1:Xn.length,wr=0;wr<Nr;wr++){wr===1&&un!==1&&Et.writeVarint(tt(2,Nr-1));var Hr=Xn[wr].x-an,Xr=Xn[wr].y-Vn;Et.writeVarint(mt(Hr)),Et.writeVarint(mt(Xr)),an+=Hr,Vn+=Xr}un===3&&Et.writeVarint(tt(7,1))}}function yt(bt,Et){var Xt=typeof bt;Xt==="string"?Et.writeStringField(1,bt):Xt==="boolean"?Et.writeBooleanField(7,bt):Xt==="number"&&(bt%1!=0?Et.writeDoubleField(3,bt):bt<0?Et.writeSVarintField(6,bt):Et.writeVarintField(5,bt))}return Ye.exports=be,Ye.exports.fromVectorTileJs=be,Ye.exports.fromGeojsonVt=function(bt,Et){Et=Et||{};var Xt={};for(var un in bt)Xt[un]=new ge(bt[un].features,Et),Xt[un].name=un,Xt[un].version=Et.version,Xt[un].extent=Et.extent;return be({layers:Xt})},Ye.exports.GeoJSONWrapper=ge,Ye.exports}(),nt=i.e8(Bt);const Rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ht=>ht},Nt=Math.fround||(gn=new Float32Array(1),ht=>(gn[0]=+ht,gn[0]));var gn;const Mt=3,$t=5,Ut=6;class hn{constructor(ge){this.options=Object.assign(Object.create(Rt),ge),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ge){const{log:be,minZoom:Re,maxZoom:qe}=this.options;be&&console.time("total time");const We=`prepare ${ge.length} points`;be&&console.time(We),this.points=ge;const tt=[];for(let it=0;it<ge.length;it++){const yt=ge[it];if(!yt.geometry)continue;const[bt,Et]=yt.geometry.coordinates,Xt=Nt(Dn(bt)),un=Nt(pn(Et));tt.push(Xt,un,1/0,it,-1,1),this.options.reduce&&tt.push(0)}let mt=this.trees[qe+1]=this._createTree(tt);be&&console.timeEnd(We);for(let it=qe;it>=Re;it--){const yt=+Date.now();mt=this.trees[it]=this._createTree(this._cluster(mt,it)),be&&console.log("z%d: %d clusters in %dms",it,mt.numItems,+Date.now()-yt)}return be&&console.timeEnd("total time"),this}getClusters(ge,be){let Re=((ge[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,ge[1]));let We=ge[2]===180?180:((ge[2]+180)%360+360)%360-180;const tt=Math.max(-90,Math.min(90,ge[3]));if(ge[2]-ge[0]>=360)Re=-180,We=180;else if(Re>We){const Et=this.getClusters([Re,qe,180,tt],be),Xt=this.getClusters([-180,qe,We,tt],be);return Et.concat(Xt)}const mt=this.trees[this._limitZoom(be)],it=mt.range(Dn(Re),pn(tt),Dn(We),pn(qe)),yt=mt.data,bt=[];for(const Et of it){const Xt=this.stride*Et;bt.push(yt[Xt+$t]>1?xn(yt,Xt,this.clusterProps):this.points[yt[Xt+Mt]])}return bt}getChildren(ge){const be=this._getOriginId(ge),Re=this._getOriginZoom(ge),qe="No cluster with the specified id.",We=this.trees[Re];if(!We)throw new Error(qe);const tt=We.data;if(be*this.stride>=tt.length)throw new Error(qe);const mt=this.options.radius/(this.options.extent*Math.pow(2,Re-1)),it=We.within(tt[be*this.stride],tt[be*this.stride+1],mt),yt=[];for(const bt of it){const Et=bt*this.stride;tt[Et+4]===ge&&yt.push(tt[Et+$t]>1?xn(tt,Et,this.clusterProps):this.points[tt[Et+Mt]])}if(yt.length===0)throw new Error(qe);return yt}getLeaves(ge,be,Re){const qe=[];return this._appendLeaves(qe,ge,be=be||10,Re=Re||0,0),qe}getTile(ge,be,Re){const qe=this.trees[this._limitZoom(ge)],We=Math.pow(2,ge),{extent:tt,radius:mt}=this.options,it=mt/tt,yt=(Re-it)/We,bt=(Re+1+it)/We,Et={features:[]};return this._addTileFeatures(qe.range((be-it)/We,yt,(be+1+it)/We,bt),qe.data,be,Re,We,Et),be===0&&this._addTileFeatures(qe.range(1-it/We,yt,1,bt),qe.data,We,Re,We,Et),be===We-1&&this._addTileFeatures(qe.range(0,yt,it/We,bt),qe.data,-1,Re,We,Et),Et.features.length?Et:null}getClusterExpansionZoom(ge){let be=this._getOriginZoom(ge)-1;for(;be<=this.options.maxZoom;){const Re=this.getChildren(ge);if(be++,Re.length!==1)break;ge=Re[0].properties.cluster_id}return be}_appendLeaves(ge,be,Re,qe,We){const tt=this.getChildren(be);for(const mt of tt){const it=mt.properties;if(it&&it.cluster?We+it.point_count<=qe?We+=it.point_count:We=this._appendLeaves(ge,it.cluster_id,Re,qe,We):We<qe?We++:ge.push(mt),ge.length===Re)break}return We}_createTree(ge){const be=new i.bE(ge.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Re=0;Re<ge.length;Re+=this.stride)be.add(ge[Re],ge[Re+1]);return be.finish(),be.data=ge,be}_addTileFeatures(ge,be,Re,qe,We,tt){for(const mt of ge){const it=mt*this.stride,yt=be[it+$t]>1;let bt,Et,Xt;if(yt)bt=Le(be,it,this.clusterProps),Et=be[it],Xt=be[it+1];else{const Vn=this.points[be[it+Mt]];bt=Vn.properties;const[tr,Kn]=Vn.geometry.coordinates;Et=Dn(tr),Xt=pn(Kn)}const un={type:1,geometry:[[Math.round(this.options.extent*(Et*We-Re)),Math.round(this.options.extent*(Xt*We-qe))]],tags:bt};let an;an=yt||this.options.generateId?be[it+Mt]:this.points[be[it+Mt]].id,an!==void 0&&(un.id=an),tt.features.push(un)}}_limitZoom(ge){return Math.max(this.options.minZoom,Math.min(Math.floor(+ge),this.options.maxZoom+1))}_cluster(ge,be){const{radius:Re,extent:qe,reduce:We,minPoints:tt}=this.options,mt=Re/(qe*Math.pow(2,be)),it=ge.data,yt=[],bt=this.stride;for(let Et=0;Et<it.length;Et+=bt){if(it[Et+2]<=be)continue;it[Et+2]=be;const Xt=it[Et],un=it[Et+1],an=ge.within(it[Et],it[Et+1],mt),Vn=it[Et+$t];let tr=Vn;for(const Kn of an){const Xn=Kn*bt;it[Xn+2]>be&&(tr+=it[Xn+$t])}if(tr>Vn&&tr>=tt){let Kn,Xn=Xt*Vn,Wr=un*Vn,Nr=-1;const wr=(Et/bt<<5)+(be+1)+this.points.length;for(const Hr of an){const Xr=Hr*bt;if(it[Xr+2]<=be)continue;it[Xr+2]=be;const Vr=it[Xr+$t];Xn+=it[Xr]*Vr,Wr+=it[Xr+1]*Vr,it[Xr+4]=wr,We&&(Kn||(Kn=this._map(it,Et,!0),Nr=this.clusterProps.length,this.clusterProps.push(Kn)),We(Kn,this._map(it,Xr)))}it[Et+4]=wr,yt.push(Xn/tr,Wr/tr,1/0,wr,-1,tr),We&&yt.push(Nr)}else{for(let Kn=0;Kn<bt;Kn++)yt.push(it[Et+Kn]);if(tr>1)for(const Kn of an){const Xn=Kn*bt;if(!(it[Xn+2]<=be)){it[Xn+2]=be;for(let Wr=0;Wr<bt;Wr++)yt.push(it[Xn+Wr])}}}}return yt}_getOriginId(ge){return ge-this.points.length>>5}_getOriginZoom(ge){return(ge-this.points.length)%32}_map(ge,be,Re){if(ge[be+$t]>1){const tt=this.clusterProps[ge[be+Ut]];return Re?Object.assign({},tt):tt}const qe=this.points[ge[be+Mt]].properties,We=this.options.map(qe);return Re&&We===qe?Object.assign({},We):We}}function xn(ht,ge,be){return{type:"Feature",id:ht[ge+Mt],properties:Le(ht,ge,be),geometry:{type:"Point",coordinates:[(Re=ht[ge],360*(Re-.5)),zn(ht[ge+1])]}};var Re}function Le(ht,ge,be){const Re=ht[ge+$t],qe=Re>=1e4?`${Math.round(Re/1e3)}k`:Re>=1e3?Math.round(Re/100)/10+"k":Re,We=ht[ge+Ut],tt=We===-1?{}:Object.assign({},be[We]);return Object.assign(tt,{cluster:!0,cluster_id:ht[ge+Mt],point_count:Re,point_count_abbreviated:qe})}function Dn(ht){return ht/360+.5}function pn(ht){const ge=Math.sin(ht*Math.PI/180),be=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return be<0?0:be>1?1:be}function zn(ht){const ge=(180-360*ht)*Math.PI/180;return 360*Math.atan(Math.exp(ge))/Math.PI-90}function _t(ht,ge,be,Re){let qe=Re;const We=ge+(be-ge>>1);let tt,mt=be-ge;const it=ht[ge],yt=ht[ge+1],bt=ht[be],Et=ht[be+1];for(let Xt=ge+3;Xt<be;Xt+=3){const un=er(ht[Xt],ht[Xt+1],it,yt,bt,Et);if(un>qe)tt=Xt,qe=un;else if(un===qe){const an=Math.abs(Xt-We);an<mt&&(tt=Xt,mt=an)}}qe>Re&&(tt-ge>3&&_t(ht,ge,tt,Re),ht[tt+2]=qe,be-tt>3&&_t(ht,tt,be,Re))}function er(ht,ge,be,Re,qe,We){let tt=qe-be,mt=We-Re;if(tt!==0||mt!==0){const it=((ht-be)*tt+(ge-Re)*mt)/(tt*tt+mt*mt);it>1?(be=qe,Re=We):it>0&&(be+=tt*it,Re+=mt*it)}return tt=ht-be,mt=ge-Re,tt*tt+mt*mt}function pr(ht,ge,be,Re){const qe={id:ht??null,type:ge,geometry:be,tags:Re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")qn(qe,be);else if(ge==="Polygon")qn(qe,be[0]);else if(ge==="MultiLineString")for(const We of be)qn(qe,We);else if(ge==="MultiPolygon")for(const We of be)qn(qe,We[0]);return qe}function qn(ht,ge){for(let be=0;be<ge.length;be+=3)ht.minX=Math.min(ht.minX,ge[be]),ht.minY=Math.min(ht.minY,ge[be+1]),ht.maxX=Math.max(ht.maxX,ge[be]),ht.maxY=Math.max(ht.maxY,ge[be+1])}function _n(ht,ge,be,Re){if(!ge.geometry)return;const qe=ge.geometry.coordinates;if(qe&&qe.length===0)return;const We=ge.geometry.type,tt=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2);let mt=[],it=ge.id;if(be.promoteId?it=ge.properties[be.promoteId]:be.generateId&&(it=Re||0),We==="Point")ir(qe,mt);else if(We==="MultiPoint")for(const yt of qe)ir(yt,mt);else if(We==="LineString")cr(qe,mt,tt,!1);else if(We==="MultiLineString"){if(be.lineMetrics){for(const yt of qe)mt=[],cr(yt,mt,tt,!1),ht.push(pr(it,"LineString",mt,ge.properties));return}Er(qe,mt,tt,!1)}else if(We==="Polygon")Er(qe,mt,tt,!0);else{if(We!=="MultiPolygon"){if(We==="GeometryCollection"){for(const yt of ge.geometry.geometries)_n(ht,{id:it,geometry:yt,properties:ge.properties},be,Re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const yt of qe){const bt=[];Er(yt,bt,tt,!0),mt.push(bt)}}ht.push(pr(it,We,mt,ge.properties))}function ir(ht,ge){ge.push(On(ht[0]),fi(ht[1]),0)}function cr(ht,ge,be,Re){let qe,We,tt=0;for(let it=0;it<ht.length;it++){const yt=On(ht[it][0]),bt=fi(ht[it][1]);ge.push(yt,bt,0),it>0&&(tt+=Re?(qe*bt-yt*We)/2:Math.sqrt(Math.pow(yt-qe,2)+Math.pow(bt-We,2))),qe=yt,We=bt}const mt=ge.length-3;ge[2]=1,_t(ge,0,mt,be),ge[mt+2]=1,ge.size=Math.abs(tt),ge.start=0,ge.end=ge.size}function Er(ht,ge,be,Re){for(let qe=0;qe<ht.length;qe++){const We=[];cr(ht[qe],We,be,Re),ge.push(We)}}function On(ht){return ht/360+.5}function fi(ht){const ge=Math.sin(ht*Math.PI/180),be=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return be<0?0:be>1?1:be}function Dt(ht,ge,be,Re,qe,We,tt,mt){if(Re/=ge,We>=(be/=ge)&&tt<Re)return ht;if(tt<be||We>=Re)return null;const it=[];for(const yt of ht){const bt=yt.geometry;let Et=yt.type;const Xt=qe===0?yt.minX:yt.minY,un=qe===0?yt.maxX:yt.maxY;if(Xt>=be&&un<Re){it.push(yt);continue}if(un<be||Xt>=Re)continue;let an=[];if(Et==="Point"||Et==="MultiPoint")Ft(bt,an,be,Re,qe);else if(Et==="LineString")sn(bt,an,be,Re,qe,!1,mt.lineMetrics);else if(Et==="MultiLineString")Pn(bt,an,be,Re,qe,!1);else if(Et==="Polygon")Pn(bt,an,be,Re,qe,!0);else if(Et==="MultiPolygon")for(const Vn of bt){const tr=[];Pn(Vn,tr,be,Re,qe,!0),tr.length&&an.push(tr)}if(an.length){if(mt.lineMetrics&&Et==="LineString"){for(const Vn of an)it.push(pr(yt.id,Et,Vn,yt.tags));continue}Et!=="LineString"&&Et!=="MultiLineString"||(an.length===1?(Et="LineString",an=an[0]):Et="MultiLineString"),Et!=="Point"&&Et!=="MultiPoint"||(Et=an.length===3?"Point":"MultiPoint"),it.push(pr(yt.id,Et,an,yt.tags))}}return it.length?it:null}function Ft(ht,ge,be,Re,qe){for(let We=0;We<ht.length;We+=3){const tt=ht[We+qe];tt>=be&&tt<=Re&&ur(ge,ht[We],ht[We+1],ht[We+2])}}function sn(ht,ge,be,Re,qe,We,tt){let mt=Tn(ht);const it=qe===0?Bn:Hn;let yt,bt,Et=ht.start;for(let tr=0;tr<ht.length-3;tr+=3){const Kn=ht[tr],Xn=ht[tr+1],Wr=ht[tr+2],Nr=ht[tr+3],wr=ht[tr+4],Hr=qe===0?Kn:Xn,Xr=qe===0?Nr:wr;let Vr=!1;tt&&(yt=Math.sqrt(Math.pow(Kn-Nr,2)+Math.pow(Xn-wr,2))),Hr<be?Xr>be&&(bt=it(mt,Kn,Xn,Nr,wr,be),tt&&(mt.start=Et+yt*bt)):Hr>Re?Xr<Re&&(bt=it(mt,Kn,Xn,Nr,wr,Re),tt&&(mt.start=Et+yt*bt)):ur(mt,Kn,Xn,Wr),Xr<be&&Hr>=be&&(bt=it(mt,Kn,Xn,Nr,wr,be),Vr=!0),Xr>Re&&Hr<=Re&&(bt=it(mt,Kn,Xn,Nr,wr,Re),Vr=!0),!We&&Vr&&(tt&&(mt.end=Et+yt*bt),ge.push(mt),mt=Tn(ht)),tt&&(Et+=yt)}let Xt=ht.length-3;const un=ht[Xt],an=ht[Xt+1],Vn=qe===0?un:an;Vn>=be&&Vn<=Re&&ur(mt,un,an,ht[Xt+2]),Xt=mt.length-3,We&&Xt>=3&&(mt[Xt]!==mt[0]||mt[Xt+1]!==mt[1])&&ur(mt,mt[0],mt[1],mt[2]),mt.length&&ge.push(mt)}function Tn(ht){const ge=[];return ge.size=ht.size,ge.start=ht.start,ge.end=ht.end,ge}function Pn(ht,ge,be,Re,qe,We){for(const tt of ht)sn(tt,ge,be,Re,qe,We,!1)}function ur(ht,ge,be,Re){ht.push(ge,be,Re)}function Bn(ht,ge,be,Re,qe,We){const tt=(We-ge)/(Re-ge);return ur(ht,We,be+(qe-be)*tt,1),tt}function Hn(ht,ge,be,Re,qe,We){const tt=(We-be)/(qe-be);return ur(ht,ge+(Re-ge)*tt,We,1),tt}function Zr(ht,ge){const be=[];for(let Re=0;Re<ht.length;Re++){const qe=ht[Re],We=qe.type;let tt;if(We==="Point"||We==="MultiPoint"||We==="LineString")tt=Lr(qe.geometry,ge);else if(We==="MultiLineString"||We==="Polygon"){tt=[];for(const mt of qe.geometry)tt.push(Lr(mt,ge))}else if(We==="MultiPolygon"){tt=[];for(const mt of qe.geometry){const it=[];for(const yt of mt)it.push(Lr(yt,ge));tt.push(it)}}be.push(pr(qe.id,We,tt,qe.tags))}return be}function Lr(ht,ge){const be=[];be.size=ht.size,ht.start!==void 0&&(be.start=ht.start,be.end=ht.end);for(let Re=0;Re<ht.length;Re+=3)be.push(ht[Re]+ge,ht[Re+1],ht[Re+2]);return be}function qr(ht,ge){if(ht.transformed)return ht;const be=1<<ht.z,Re=ht.x,qe=ht.y;for(const We of ht.features){const tt=We.geometry,mt=We.type;if(We.geometry=[],mt===1)for(let it=0;it<tt.length;it+=2)We.geometry.push(Yn(tt[it],tt[it+1],ge,be,Re,qe));else for(let it=0;it<tt.length;it++){const yt=[];for(let bt=0;bt<tt[it].length;bt+=2)yt.push(Yn(tt[it][bt],tt[it][bt+1],ge,be,Re,qe));We.geometry.push(yt)}}return ht.transformed=!0,ht}function Yn(ht,ge,be,Re,qe,We){return[Math.round(be*(ht*Re-qe)),Math.round(be*(ge*Re-We))]}function Ar(ht,ge,be,Re,qe){const We=ge===qe.maxZoom?0:qe.tolerance/((1<<ge)*qe.extent),tt={features:[],numPoints:0,numSimplified:0,numFeatures:ht.length,source:null,x:be,y:Re,z:ge,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const mt of ht)si(tt,mt,We,qe);return tt}function si(ht,ge,be,Re){const qe=ge.geometry,We=ge.type,tt=[];if(ht.minX=Math.min(ht.minX,ge.minX),ht.minY=Math.min(ht.minY,ge.minY),ht.maxX=Math.max(ht.maxX,ge.maxX),ht.maxY=Math.max(ht.maxY,ge.maxY),We==="Point"||We==="MultiPoint")for(let mt=0;mt<qe.length;mt+=3)tt.push(qe[mt],qe[mt+1]),ht.numPoints++,ht.numSimplified++;else if(We==="LineString")$n(tt,qe,ht,be,!1,!1);else if(We==="MultiLineString"||We==="Polygon")for(let mt=0;mt<qe.length;mt++)$n(tt,qe[mt],ht,be,We==="Polygon",mt===0);else if(We==="MultiPolygon")for(let mt=0;mt<qe.length;mt++){const it=qe[mt];for(let yt=0;yt<it.length;yt++)$n(tt,it[yt],ht,be,!0,yt===0)}if(tt.length){let mt=ge.tags||null;if(We==="LineString"&&Re.lineMetrics){mt={};for(const yt in ge.tags)mt[yt]=ge.tags[yt];mt.mapbox_clip_start=qe.start/qe.size,mt.mapbox_clip_end=qe.end/qe.size}const it={geometry:tt,type:We==="Polygon"||We==="MultiPolygon"?3:We==="LineString"||We==="MultiLineString"?2:1,tags:mt};ge.id!==null&&(it.id=ge.id),ht.features.push(it)}}function $n(ht,ge,be,Re,qe,We){const tt=Re*Re;if(Re>0&&ge.size<(qe?tt:Re))return void(be.numPoints+=ge.length/3);const mt=[];for(let it=0;it<ge.length;it+=3)(Re===0||ge[it+2]>tt)&&(be.numSimplified++,mt.push(ge[it],ge[it+1])),be.numPoints++;qe&&function(it,yt){let bt=0;for(let Et=0,Xt=it.length,un=Xt-2;Et<Xt;un=Et,Et+=2)bt+=(it[Et]-it[un])*(it[Et+1]+it[un+1]);if(bt>0===yt)for(let Et=0,Xt=it.length;Et<Xt/2;Et+=2){const un=it[Et],an=it[Et+1];it[Et]=it[Xt-2-Et],it[Et+1]=it[Xt-1-Et],it[Xt-2-Et]=un,it[Xt-1-Et]=an}}(mt,We),ht.push(mt)}const Zi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ra{constructor(ge,be){const Re=(be=this.options=function(We,tt){for(const mt in tt)We[mt]=tt[mt];return We}(Object.create(Zi),be)).debug;if(Re&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");let qe=function(We,tt){const mt=[];if(We.type==="FeatureCollection")for(let it=0;it<We.features.length;it++)_n(mt,We.features[it],tt,it);else _n(mt,We.type==="Feature"?We:{geometry:We},tt);return mt}(ge,be);this.tiles={},this.tileCoords=[],Re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),qe=function(We,tt){const mt=tt.buffer/tt.extent;let it=We;const yt=Dt(We,1,-1-mt,mt,0,-1,2,tt),bt=Dt(We,1,1-mt,2+mt,0,-1,2,tt);return(yt||bt)&&(it=Dt(We,1,-mt,1+mt,0,-1,2,tt)||[],yt&&(it=Zr(yt,1).concat(it)),bt&&(it=it.concat(Zr(bt,-1)))),it}(qe,be),qe.length&&this.splitTile(qe,0,0,0),Re&&(qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ge,be,Re,qe,We,tt,mt){const it=[ge,be,Re,qe],yt=this.options,bt=yt.debug;for(;it.length;){qe=it.pop(),Re=it.pop(),be=it.pop(),ge=it.pop();const Et=1<<be,Xt=Wi(be,Re,qe);let un=this.tiles[Xt];if(!un&&(bt>1&&console.time("creation"),un=this.tiles[Xt]=Ar(ge,be,Re,qe,yt),this.tileCoords.push({z:be,x:Re,y:qe}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,Re,qe,un.numFeatures,un.numPoints,un.numSimplified),console.timeEnd("creation"));const Vr=`z${be}`;this.stats[Vr]=(this.stats[Vr]||0)+1,this.total++}if(un.source=ge,We==null){if(be===yt.indexMaxZoom||un.numPoints<=yt.indexMaxPoints)continue}else{if(be===yt.maxZoom||be===We)continue;if(We!=null){const Vr=We-be;if(Re!==tt>>Vr||qe!==mt>>Vr)continue}}if(un.source=null,ge.length===0)continue;bt>1&&console.time("clipping");const an=.5*yt.buffer/yt.extent,Vn=.5-an,tr=.5+an,Kn=1+an;let Xn=null,Wr=null,Nr=null,wr=null,Hr=Dt(ge,Et,Re-an,Re+tr,0,un.minX,un.maxX,yt),Xr=Dt(ge,Et,Re+Vn,Re+Kn,0,un.minX,un.maxX,yt);ge=null,Hr&&(Xn=Dt(Hr,Et,qe-an,qe+tr,1,un.minY,un.maxY,yt),Wr=Dt(Hr,Et,qe+Vn,qe+Kn,1,un.minY,un.maxY,yt),Hr=null),Xr&&(Nr=Dt(Xr,Et,qe-an,qe+tr,1,un.minY,un.maxY,yt),wr=Dt(Xr,Et,qe+Vn,qe+Kn,1,un.minY,un.maxY,yt),Xr=null),bt>1&&console.timeEnd("clipping"),it.push(Xn||[],be+1,2*Re,2*qe),it.push(Wr||[],be+1,2*Re,2*qe+1),it.push(Nr||[],be+1,2*Re+1,2*qe),it.push(wr||[],be+1,2*Re+1,2*qe+1)}}getTile(ge,be,Re){ge=+ge,be=+be,Re=+Re;const qe=this.options,{extent:We,debug:tt}=qe;if(ge<0||ge>24)return null;const mt=1<<ge,it=Wi(ge,be=be+mt&mt-1,Re);if(this.tiles[it])return qr(this.tiles[it],We);tt>1&&console.log("drilling down to z%d-%d-%d",ge,be,Re);let yt,bt=ge,Et=be,Xt=Re;for(;!yt&&bt>0;)bt--,Et>>=1,Xt>>=1,yt=this.tiles[Wi(bt,Et,Xt)];return yt&&yt.source?(tt>1&&(console.log("found parent tile z%d-%d-%d",bt,Et,Xt),console.time("drilling down")),this.splitTile(yt.source,bt,Et,Xt,ge,be,Re),tt>1&&console.timeEnd("drilling down"),this.tiles[it]?qr(this.tiles[it],We):null):null}}function Wi(ht,ge,be){return 32*((1<<ht)*be+ge)+ht}function ai(ht,ge){const be=ht.tileID.canonical;if(!this._geoJSONIndex)return void ge(null,null);const Re=this._geoJSONIndex.getTile(be.z,be.x,be.y);if(!Re)return void ge(null,null);const qe=new ce(Re.features);let We=nt(qe);We.byteOffset===0&&We.byteLength===We.buffer.byteLength||(We=new Uint8Array(We)),ge(null,{vectorTile:qe,rawData:We.buffer})}class Fi extends ne{constructor(ge,be,Re,qe,We,tt){super(ge,be,Re,qe,ai,tt),We&&(this.loadGeoJSON=We),this._dynamicIndex=new $e}loadData(ge,be){const Re=ge&&ge.request,qe=Re&&Re.collectResourceTiming;this.loadGeoJSON(ge,(We,tt)=>{if(We||!tt)return be(We);if(typeof tt!="object")return be(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));{try{if(ge.filter){const it=i.U(ge.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(it.result==="error")throw new Error(it.value.map(yt=>`${yt.key}: ${yt.message}`).join(", "));tt.features=tt.features.filter(yt=>it.value.evaluate({zoom:0},yt))}ge.dynamic?(tt.type==="Feature"&&(tt={type:"FeatureCollection",features:[tt]}),ge.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(tt.features,this.loaded),ge.cluster&&(tt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ge.cluster?new hn(function({superclusterOptions:it,clusterProperties:yt}){if(!yt||!it)return it;const bt={},Et={},Xt={accumulated:null,zoom:0},un={properties:null},an=Object.keys(yt);for(const Vn of an){const[tr,Kn]=yt[Vn],Xn=i.U(Kn),Wr=i.U(typeof tr=="string"?[tr,["accumulated"],["get",Vn]]:tr);bt[Vn]=Xn.value,Et[Vn]=Wr.value}return it.map=Vn=>{un.properties=Vn;const tr={};for(const Kn of an)tr[Kn]=bt[Kn].evaluate(Xt,un);return tr},it.reduce=(Vn,tr)=>{un.properties=tr;for(const Kn of an)Xt.accumulated=Vn[Kn],Vn[Kn]=Et[Kn].evaluate(Xt,un)},it}(ge)).load(tt.features):ge.dynamic?this._dynamicIndex:function(it,yt){return new ra(it,yt)}(tt,ge.geojsonVtOptions)}catch(it){return be(it)}const mt={};if(qe){const it=I(Re);it&&(mt.resourceTiming={},mt.resourceTiming[ge.source]=JSON.parse(JSON.stringify(it)))}be(null,mt)}})}reloadTile(ge,be){const Re=this.loaded;return Re&&Re[ge.uid]?ge.partial?be(null,void 0):super.reloadTile(ge,be):this.loadTile(ge,be)}loadGeoJSON(ge,be){if(ge.request)i.n(ge.request,be);else{if(typeof ge.data!="string")return be(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));try{return be(null,JSON.parse(ge.data))}catch{return be(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ge,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(ge.clusterId))}catch(Re){be(Re)}}getClusterChildren(ge,be){try{be(null,this._geoJSONIndex.getChildren(ge.clusterId))}catch(Re){be(Re)}}getClusterLeaves(ge,be){try{be(null,this._geoJSONIndex.getLeaves(ge.clusterId,ge.limit,ge.offset))}catch(Re){be(Re)}}}class ia{constructor(ge,be){this.tileID=new i.aG(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ge.projection,this.brightness=be}parse(ge,be,Re,qe){this.status="parsing";const We=new i.aG(Re.tileID.overscaledZ,Re.tileID.wrap,Re.tileID.canonical.z,Re.tileID.canonical.x,Re.tileID.canonical.y),tt=[],mt=be.familiesBySource[Re.source],it=new i.dZ(We,Re.promoteId);return it.bucketLayerIDs=[],it.is3DTile=!0,i.e9(ge).then(yt=>{if(!yt)return qe(new Error("Could not parse tile"));const bt=i.ea(yt,1/i.cc(Re.tileID.canonical)),Et=yt.json.extensionsUsed&&yt.json.extensionsUsed.includes("MAPBOX_mesh_features")||yt.json.asset.extras&&yt.json.asset.extras.MAPBOX_mesh_features,Xt=yt.json.extensionsUsed&&yt.json.extensionsUsed.includes("EXT_meshopt_compression"),un=new i.a8(this.zoom,{brightness:this.brightness});for(const an in mt)for(const Vn of mt[an]){const tr=Vn[0];it.bucketLayerIDs.push(Vn.map(Xn=>i.aC(Xn.id,Xn.scope))),tr.recalculate(un,[]);const Kn=new i.eb(Vn,bt,We,Et,Xt,this.brightness,it);Et||(Kn.needsUpload=!0),tt.push(Kn),Kn.evaluate(tr)}this.status="done",qe(null,{buckets:tt,featureIndex:it,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(yt=>qe(new Error(yt.message)))}}class vs{constructor(ge,be,Re,qe,We,tt){this.actor=ge,this.layerIndex=be,this.availableImages=Re,this.brightness=tt,this.loading={},this.loaded={}}loadTile(ge,be){const Re=ge.uid,qe=this.loading[Re]=new ia(ge,this.brightness);i.bi(ge.request,(We,tt)=>{const mt=!this.loading[Re];return delete this.loading[Re],mt||We?(qe.status="done",mt||(this.loaded[Re]=qe),be(We)):tt&&tt.byteLength!==0?void qe.parse(tt,this.layerIndex,ge,(it,yt)=>{qe.status="done",this.loaded=this.loaded||{},this.loaded[Re]=qe,it||!yt?be(it):be(null,yt)}):(qe.status="done",this.loaded[Re]=qe,be())})}reloadTile(ge,be){const Re=this.loaded,qe=ge.uid;if(Re&&Re[qe]){const We=Re[qe];We.projection=ge.projection,We.brightness=ge.brightness;const tt=(mt,it)=>{We.reloadCallback&&(delete We.reloadCallback,this.loadTile(ge,be)),be(mt,it)};We.status==="parsing"?We.reloadCallback=tt:We.status==="done"&&this.loadTile(ge,be)}}abortTile(ge,be){const Re=ge.uid;this.loading[Re]&&delete this.loading[Re],be()}removeTile(ge,be){const Re=this.loaded,qe=ge.uid;Re&&Re[qe]&&delete Re[qe],be()}}class Do{constructor(ge){this.self=ge,this.actor=new i.ec(ge,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:ne,geojson:Fi,"batched-model":vs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(be,Re)=>{if(this.workerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.workerSourceTypes[be]=Re},this.self.registerRTLTextPlugin=be=>{if(i.ed.isParsed())throw new Error("RTL text plugin already registered.");i.ed.applyArabicShaping=be.applyArabicShaping,i.ed.processBidirectionalText=be.processBidirectionalText,i.ed.processStyledBidirectionalText=be.processStyledBidirectionalText}}clearCaches(ge,be,Re){delete this.layerIndexes[ge],delete this.availableImages[ge],delete this.workerSources[ge],delete this.demWorkerSources[ge],delete this.rasterArrayWorkerSource,Re()}checkIfReady(ge,be,Re){Re()}setReferrer(ge,be){this.referrer=be}spriteLoaded(ge,{scope:be,isLoaded:Re}){if(this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.isSpriteLoaded[ge][be]=Re,this.workerSources[ge]&&this.workerSources[ge][be])for(const qe in this.workerSources[ge][be]){const We=this.workerSources[ge][be][qe];for(const tt in We){const mt=We[tt];mt instanceof ne&&(mt.isSpriteLoaded=Re,mt.fire(new i.z("isSpriteLoaded")))}}}setImages(ge,{scope:be,images:Re},qe){if(this.availableImages[ge]||(this.availableImages[ge]={}),this.availableImages[ge][be]=Re,this.workerSources[ge]&&this.workerSources[ge][be]){for(const We in this.workerSources[ge][be]){const tt=this.workerSources[ge][be][We];for(const mt in tt)tt[mt].availableImages=Re}qe()}else qe()}setProjection(ge,be){this.projections[ge]=i.bP(be)}setBrightness(ge,be,Re){this.brightness=be,Re()}setLayers(ge,be,Re){this.getLayerIndex(ge,be.scope).replace(be.layers,be.options),Re()}updateLayers(ge,be,Re){this.getLayerIndex(ge,be.scope).update(be.layers,be.removedIds,be.options),Re()}loadTile(ge,be,Re){be.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,be.type,be.source,be.scope).loadTile(be,Re)}loadDEMTile(ge,be,Re){this.getDEMWorkerSource(ge,be.source,be.scope).loadTile(be,Re)}decodeRasterArray(ge,be,Re){this.getRasterArrayWorkerSource().decodeRasterArray(be,Re)}reloadTile(ge,be,Re){be.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,be.type,be.source,be.scope).reloadTile(be,Re)}abortTile(ge,be,Re){this.getWorkerSource(ge,be.type,be.source,be.scope).abortTile(be,Re)}removeTile(ge,be,Re){this.getWorkerSource(ge,be.type,be.source,be.scope).removeTile(be,Re)}removeSource(ge,be,Re){if(!(this.workerSources[ge]&&this.workerSources[ge][be.scope]&&this.workerSources[ge][be.scope][be.type]&&this.workerSources[ge][be.scope][be.type][be.source]))return;const qe=this.workerSources[ge][be.scope][be.type][be.source];delete this.workerSources[ge][be.scope][be.type][be.source],qe.removeSource!==void 0?qe.removeSource(be,Re):Re()}loadWorkerSource(ge,be,Re){try{this.self.importScripts(be.url),Re()}catch(qe){Re(qe.toString())}}syncRTLPluginState(ge,be,Re){try{i.ed.setState(be);const qe=i.ed.getPluginURL();if(i.ed.isLoaded()&&!i.ed.isParsed()&&qe!=null){this.self.importScripts(qe);const We=i.ed.isParsed();Re(We?void 0:new Error(`RTL Text Plugin failed to import scripts from ${qe}`),We)}}catch(qe){Re(qe.toString())}}setDracoUrl(ge,be){this.dracoUrl=be}getAvailableImages(ge,be){this.availableImages[ge]||(this.availableImages[ge]={});let Re=this.availableImages[ge][be];return Re||(Re=[]),Re}getLayerIndex(ge,be){this.layerIndexes[ge]||(this.layerIndexes[ge]={});let Re=this.layerIndexes[ge][be];return Re||(Re=this.layerIndexes[ge][be]=new G,Re.scope=be),Re}getWorkerSource(ge,be,Re,qe){return this.workerSources[ge]||(this.workerSources[ge]={}),this.workerSources[ge][qe]||(this.workerSources[ge][qe]={}),this.workerSources[ge][qe][be]||(this.workerSources[ge][qe][be]={}),this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.workerSources[ge][qe][be][Re]||(this.workerSources[ge][qe][be][Re]=new this.workerSourceTypes[be]({send:(We,tt,mt,it,yt,bt)=>{this.actor.send(We,tt,mt,ge,yt,bt)},scheduler:this.actor.scheduler},this.getLayerIndex(ge,qe),this.getAvailableImages(ge,qe),this.isSpriteLoaded[ge][qe],void 0,this.brightness)),this.workerSources[ge][qe][be][Re]}rasterizeImages(ge,be,Re){const{imageTasks:qe,scope:We}=be,tt={};for(const mt in qe){const{image:it,imageIdWithOptions:yt}=qe[mt];tt[mt]=this.imageRasterizer.rasterize(yt,it,We,ge)}Re(void 0,tt)}removeRasterizedImages(ge,be,Re){const{imageIds:qe,scope:We}=be;this.imageRasterizer.removeImagesFromCacheByIds(qe,We,ge),Re()}getDEMWorkerSource(ge,be,Re){return this.demWorkerSources[ge]||(this.demWorkerSources[ge]={}),this.demWorkerSources[ge][Re]||(this.demWorkerSources[ge][Re]={}),this.demWorkerSources[ge][Re][be]||(this.demWorkerSources[ge][Re][be]=new oe),this.demWorkerSources[ge][Re][be]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new pe),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ge,be){i.ee(be)}getWorkerPerformanceMetrics(ge,be,Re){Re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Do(self)),Do}),y(["./shared"],function(i){var I="3.9.4";const F={create:"create",load:"load",fullLoad:"fullLoad"},B={mark(h){performance.mark(h)},measure(h,t,a){performance.measure(h,t,a)}};function G(h){const t=h.name.split("?")[0];return i.a(t)&&t.includes("mapbox-gl.js")?"javascript":i.a(t)&&t.includes("mapbox-gl.css")?"css":i.b(t)?"fontRange":i.c(t)?"sprite":i.i(t)?"style":i.d(t)?"tilejson":"other"}var J,te={},H=function(){if(J)return te;function h(p){return!t(p)}function t(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,E,k=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(k);try{E=new Worker(O),b=!0}catch{b=!1}return E&&E.terminate(),URL.revokeObjectURL(O),b}()?function(){var b=document.createElement("canvas");b.width=b.height=1;var E=b.getContext("2d");if(!E)return!1;var k=E.getImageData(0,0,1,1);return k&&k.width===b.width}()?(a[v=p&&p.failIfMajorPerformanceCaveat]===void 0&&(a[v]=function(b){var E,k=function(O){var N=document.createElement("canvas"),$=Object.create(h.webGLContextAttributes);return $.failIfMajorPerformanceCaveat=O,N.getContext("webgl2",$)}(b);if(!k)return!1;try{E=k.createShader(k.VERTEX_SHADER)}catch{return!1}return!(!E||k.isContextLost())&&(k.shaderSource(E,"void main() {}"),k.compileShader(E),k.getShaderParameter(E,k.COMPILE_STATUS)===!0)}(v)),a[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var v}J=1,te.supported=h,te.notSupportedReason=t;var a={};return h.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},te}();function j(h,t,a){const p=document.createElement(h);return t!=null&&(p.className=t),a&&a.appendChild(p),p}function ne(h,t,a){const p=document.createElementNS("http://www.w3.org/2000/svg",h);for(const v of Object.keys(t))p.setAttributeNS(null,v,String(t[v]));return a&&a.appendChild(p),p}const oe=typeof document<"u"?document.documentElement&&document.documentElement.style:null,pe=oe&&oe.userSelect!==void 0?"userSelect":"WebkitUserSelect";let se;function ie(){oe&&pe&&(se=oe[pe],oe[pe]="none")}function ce(){oe&&pe&&(oe[pe]=se)}function we(h){h.preventDefault(),h.stopPropagation(),window.removeEventListener("click",we,!0)}function xe(){window.addEventListener("click",we,!0),window.setTimeout(()=>{window.removeEventListener("click",we,!0)},0)}function $e(h,t){const a=h.getBoundingClientRect();return ke(h,a,t)}function Ze(h,t){const a=h.getBoundingClientRect(),p=[];for(let v=0;v<t.length;v++)p.push(ke(h,a,t[v]));return p}function ae(h){return window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function ke(h,t,a){const p=h.offsetWidth===t.width?1:h.offsetWidth/t.width;return new i.P((a.clientX-t.left)*p,(a.clientY-t.top)*p)}const ct="01",Xe="NO_ACCESS_TOKEN";class st{constructor(t,a,p){this._transformRequestFn=t,this._customAccessToken=a,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const t=function(){let a="";for(let p=0;p<10;p++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ct,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}normalizeStyleURL(t,a){if(!i.f(t))return t;const p=gt(t);return p.params.push(`sdk=js-${I}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||a)}normalizeGlyphsURL(t,a){if(!i.f(t))return t;const p=gt(t);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||a)}normalizeModelURL(t,a){if(!i.f(t))return t;const p=gt(t);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||a)}normalizeSourceURL(t,a,p,v){if(!i.f(t))return t;const b=gt(t);return b.path=`/v4/${b.authority}.json`,b.params.push("secure"),p&&b.params.push(`language=${p}`),v&&b.params.push(`worldview=${v}`),this._makeAPIURL(b,this._customAccessToken||a)}normalizeIconsetURL(t,a){const p=gt(t);return i.f(t)?(p.path=`/styles/v1${p.path}/iconset.pbf`,this._makeAPIURL(p,this._customAccessToken||a)):zt(p)}normalizeSpriteURL(t,a,p,v){const b=gt(t);return i.f(t)?(b.path=`/styles/v1${b.path}/sprite${a}${p}`,this._makeAPIURL(b,this._customAccessToken||v)):(b.path+=`${a}${p}`,zt(b))}normalizeTileURL(t,a,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!i.f(t))return t;const v=gt(t);v.path=v.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||p&&v.authority!=="raster"&&p===512?"@2x":""}${i.m.supported?".webp":"$1"}`),v.authority==="raster"?v.path=`/${i.e.RASTER_URL_PREFIX}${v.path}`:v.authority==="rasterarrays"?v.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${v.path}`:v.authority==="3dtiles"?v.path=`/${i.e.TILES3D_URL_PREFIX}${v.path}`:(v.path=v.path.replace(/^.+\/v4\//,"/"),v.path=`/${i.e.TILE_URL_VERSION}${v.path}`);const b=this._customAccessToken||function(E){for(const k of E){const O=k.match(/^access_token=(.*)$/);if(O)return O[1]}return null}(v.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&b&&this._skuToken&&v.params.push(`sku=${this._skuToken}`),this._makeAPIURL(v,b)}canonicalizeTileURL(t,a){const p=gt(t);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return t;let v="mapbox://";p.path.match(/^\/raster\/v1\//)?v+=`raster/${p.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?v+=`rasterarrays/${p.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:v+=`tiles/${p.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let b=p.params;return a&&(b=b.filter(E=>!E.match(/^access_token=/))),b.length&&(v+=`?${b.join("&")}`),v}canonicalizeTileset(t,a){const p=!!a&&i.f(a),v=[];for(const b of t.tiles||[])i.h(b)?v.push(this.canonicalizeTileURL(b,p)):v.push(b);return v}_makeAPIURL(t,a){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",v=gt(i.e.API_URL);if(t.protocol=v.protocol,t.authority=v.authority,t.protocol==="http"){const b=t.params.indexOf("secure");b>=0&&t.params.splice(b,1)}if(v.path!=="/"&&(t.path=`${v.path}${t.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return zt(t);if(a=a||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(a[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return t.params=t.params.filter(b=>b.indexOf("access_token")===-1),t.params.push(`access_token=${a||""}`),zt(t)}}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function gt(h){const t=h.match(et);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function zt(h){const t=h.params.length?`?${h.params.join("&")}`:"";return`${h.protocol}://${h.authority}${h.path}${t}`}const at="mapbox.eventData";function Ye(h){if(!h)return null;const t=h.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(i.j(t[1]))}catch{return null}}class Bt{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const a=Ye(i.e.ACCESS_TOKEN);let p="";return p=a&&a.u?i.k(a.u):i.e.ACCESS_TOKEN||"",t?`${at}.${t}:${p}`:`${at}:${p}`}fetchEventData(){const t=i.s("localStorage"),a=this.getStorageKey(),p=this.getStorageKey("uuid");if(t)try{const v=localStorage.getItem(a);v&&(this.eventData=JSON.parse(v));const b=localStorage.getItem(p);b&&(this.anonId=b)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const t=i.s("localStorage"),a=this.getStorageKey(),p=this.getStorageKey("uuid"),v=this.anonId;if(t&&v)try{localStorage.setItem(p,v),Object.keys(this.eventData).length>=1&&localStorage.setItem(a,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,a,p,v){if(!i.e.EVENTS_URL)return;const b=gt(i.e.EVENTS_URL);b.params.push(`access_token=${v||i.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(t).toISOString()},k=a?i.l(E,a):E,O={url:zt(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=i.p(O,N=>{this.pendingRequest=null,p(N),this.saveEventData(),this.processRequests(v)})}queueRequest(t,a){this.queue.push(t),this.processRequests(a)}}const nt=new class extends Bt{constructor(h){super("appUserTurnstile"),this._customAccessToken=h}postTurnstileEvent(h,t){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(h)&&h.some(a=>i.f(a)||i.h(a))&&this.queueRequest(Date.now(),t)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Ye(i.e.ACCESS_TOKEN),a=t?t.u:i.e.ACCESS_TOKEN;let p=a!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),p=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),E=new Date(v),k=(v-this.eventData.lastSuccess)/864e5;p=p||k>=1||k<-1||b.getDate()!==E.getDate()}else p=!0;p?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:ct,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=v,this.eventData.tokenU=a)},h):this.processRequests()}},Rt=nt.postTurnstileEvent.bind(nt),Nt=new class extends Bt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(h,t,a,p){this.skuToken=t,this.errorCb=p,i.e.EVENTS_URL&&(a||i.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},a):this.errorCb(new Error(Xe)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:a}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:ct,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):t&&(this.success[t]=!0)},h))}remove(){this.errorCb=null}},gn=Nt.postMapLoadEvent.bind(Nt),Mt=new class extends Bt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(h){let t=this.mapInstanceIdMap.get(h);return t||(t=i.u(),this.mapInstanceIdMap.set(h,t)),t}getEventId(h){const t=this.eventIdPerMapInstanceMap.get(h)||0;return this.eventIdPerMapInstanceMap.set(h,t+1),t}postStyleLoadEvent(h,t){const{map:a,style:p,importedStyles:v}=t;if(!i.e.EVENTS_URL||!h&&!i.e.ACCESS_TOKEN)return;const b=this.getMapInstanceId(a),E={mapInstanceId:b,eventId:this.getEventId(b),style:p};v.length&&(E.importedStyles=v),this.queueRequest({timestamp:Date.now(),payload:E},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,payload:a}=this.queue.shift();this.postEvent(t,a,()=>{},h)}},$t=Mt.postStyleLoadEvent.bind(Mt),Ut=new class extends Bt{constructor(){super("gljs.performance")}postPerformanceEvent(h,t){i.e.EVENTS_URL&&(h||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:a}=this.queue.shift(),p=function(v){const b=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),k=function(Y){const he={};if(Y){for(const ue in Y)if(ue!=="other")for(const me of Y[ue]){const ve=`${ue}ResolveRangeMin`,Se=`${ue}ResolveRangeMax`,Pe=`${ue}RequestCount`,Me=`${ue}RequestCachedCount`;he[ve]=Math.min(he[ve]||1/0,me.startTime),he[Se]=Math.max(he[Se]||-1/0,me.responseEnd);const Fe=De=>{he[De]===void 0&&(he[De]=0),++he[De]};me.transferSize!==void 0&&me.transferSize===0&&Fe(Me),Fe(Pe)}}return he}(function(Y,he){const ue={};if(Y)for(const me of Y){const ve=he(me);ue[ve]===void 0&&(ue[ve]=[]),ue[ve].push(me)}return ue}(b,G)),O=window.devicePixelRatio,N=navigator.connection||navigator.mozConnection||navigator.webkitConnection,$=N?N.effectiveType:void 0,W={counters:[],metadata:[],attributes:[]},Z=(Y,he,ue)=>{ue!=null&&Y.push({name:he,value:ue.toString()})};for(const Y in k)Z(W.counters,Y,k[Y]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(Z(W.counters,"interactionRangeMin",v.interactionRange[0]),Z(W.counters,"interactionRangeMax",v.interactionRange[1])),E)for(const Y of Object.keys(F)){const he=F[Y],ue=E.find(me=>me.name===he);ue&&Z(W.counters,he,ue.startTime)}return Z(W.counters,"visibilityHidden",v.visibilityHidden),Z(W.attributes,"style",function(Y){if(Y)for(const he of Y){const ue=he.name.split("?")[0];if(i.i(ue)){const me=ue.split("/").slice(-2);if(me.length===2)return`mapbox://styles/${me[0]}/${me[1]}`}}}(b)),Z(W.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),Z(W.attributes,"fogEnabled",v.fogEnabled?"true":"false"),Z(W.attributes,"projection",v.projection),Z(W.attributes,"zoom",v.zoom),Z(W.metadata,"devicePixelRatio",O),Z(W.metadata,"connectionEffectiveType",$),Z(W.metadata,"navigatorUserAgent",navigator.userAgent),Z(W.metadata,"screenWidth",window.screen.width),Z(W.metadata,"screenHeight",window.screen.height),Z(W.metadata,"windowWidth",window.innerWidth),Z(W.metadata,"windowHeight",window.innerHeight),Z(W.metadata,"mapWidth",v.width/O),Z(W.metadata,"mapHeight",v.height/O),Z(W.metadata,"webglRenderer",v.renderer),Z(W.metadata,"webglVendor",v.vendor),Z(W.metadata,"sdkVersion",I),Z(W.metadata,"sdkIdentifier","mapbox-gl-js"),W}(a);for(const v of p.metadata);for(const v of p.counters);for(const v of p.attributes);this.postEvent(t,p,()=>{},h)}},hn=Ut.postPerformanceEvent.bind(Ut),xn=new class extends Bt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(h,t,a,p){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const v=gt(i.e.API_URL+i.e.SESSION_PATH);v.params.push(`sku=${t||""}`),v.params.push(`access_token=${p||i.e.ACCESS_TOKEN||""}`);const b={url:zt(v),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(b,E=>{this.pendingRequest=null,a(E),this.saveEventData(),this.processRequests(p)})}getSessionAPI(h,t,a,p){this.skuToken=t,this.errorCb=p,i.e.SESSION_PATH&&i.e.API_URL&&(a||i.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},a):this.errorCb(new Error(Xe)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:a}=this.queue.shift();t&&this.success[t]||this.getSession(a,this.skuToken,p=>{p?this.errorCb(p):t&&(this.success[t]=!0)},h)}remove(){this.errorCb=null}},Le=xn.getSessionAPI.bind(xn),Dn=new Set;function pn(h,t){t?Dn.add(h):Dn.delete(h)}class zn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,a){this._updatedSourceCaches[t]=a,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const a=t.scope;this._updatedLayers[a]=this._updatedLayers[a]||new Set,this._updatedLayers[a].add(t.id),this.setDirty()}removeLayer(t){const a=t.scope;this._removedLayers[a]=this._removedLayers[a]||{},this._updatedLayers[a]=this._updatedLayers[a]||new Set,this._removedLayers[a][t.id]=t,this._updatedLayers[a].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const a in this._updatedLayers)t[a]=t[a]||{},t[a].updatedIds=Array.from(this._updatedLayers[a].values());for(const a in this._removedLayers)t[a]=t[a]||{},t[a].removedIds=Object.keys(this._removedLayers[a]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function _t(h){const{userImage:t}=h;return!!(t&&t.render&&t.render())&&(h.data.replace(new Uint8Array(t.data.buffer)),!0)}class er extends i.E{constructor(t){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=t,t!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new i.r({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,a){if(this.loaded[a]!==t&&(this.loaded[a]=t,t)){for(const{ids:p,callback:v}of this.requestors)this._notify(p,a,v);this.requestors=[]}}hasImage(t,a){return!!this.getImage(t,a)}getImage(t,a){return this.images[a][t]}addImage(t,a,p){this._validate(t,p)&&(this.images[a][t]=p)}_validate(t,a){let p=!0;return this._validateStretch(a.stretchX,a.data&&a.data.width)||(this.fire(new i.y(new Error(`Image "${t}" has invalid "stretchX" value`))),p=!1),this._validateStretch(a.stretchY,a.data&&a.data.height)||(this.fire(new i.y(new Error(`Image "${t}" has invalid "stretchY" value`))),p=!1),this._validateContent(a.content,a)||(this.fire(new i.y(new Error(`Image "${t}" has invalid "content" value`))),p=!1),p}_validateStretch(t,a){if(!t)return!0;let p=0;for(const v of t){if(v[0]<p||v[1]<v[0]||a<v[1])return!1;p=v[1]}return!0}_validateContent(t,a){return t?t.length!==4||!a.usvg&&(t[0]<0||a.data.width<t[0]||t[1]<0||a.data.height<t[1]||t[2]<0||a.data.width<t[2]||t[3]<0||a.data.height<t[3])?!1:!(t[2]<t[0]||t[3]<t[1]):!0}updateImage(t,a,p){p.version=this.images[a][t].version+1,this.images[a][t]=p,this.updatedImages[a][t]=!0,this.removeFromImageRasterizerCache(t,a)}removeFromImageRasterizerCache(t,a){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[t],scope:a}):this.imageRasterizer.removeImagesFromCacheByIds([t],a))}removeImage(t,a){const p=this.images[a][t];delete this.images[a][t],delete this.patterns[a][t],this.removeFromImageRasterizerCache(t,a),p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,a,p){let v=!0;const b=!!this.loaded[a];if(!b)for(const E of t)this.images[a][E]||(v=!1);b||v?this._notify(t,a,p):this.requestors.push({ids:t,scope:a,callback:p})}rasterizeImages({scope:t,imageTasks:a},p){const v={};for(const b in a){const E=a[b],k=this.getImage(E.id,t);k&&(v[b]={image:k,imageIdWithOptions:E})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:v,scope:t},p):this.rasterizeImagesInMainThread({imageTasks:v,scope:t},p)}rasterizeImagesInMainThread(t,a){const{imageTasks:p,scope:v}=t,b={};for(const E in p){const{image:k,imageIdWithOptions:O}=p[E];b[E]=this.imageRasterizer.rasterize(O,k,v,"")}a(void 0,b)}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,a,p){const v={};for(const b of t){this.images[a][b]||this.fire(new i.z("styleimagemissing",{id:b}));const E=this.images[a][b];E?v[b]={data:E.usvg?null:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,usvg:E.usvg,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:i.w(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,v)}getPixelSize(t){const{width:a,height:p}=this.atlasImage[t];return{width:a,height:p}}getPattern(t,a,p){const v=this.patterns[a][t],b=this.getImage(t,a);if(!b)return null;if(v&&v.position.version===b.version)return v.position;if(v)v.position.version=b.version;else{b.usvg&&!b.data&&(b.data=this.imageRasterizer.rasterize(i.A.from(t).getPrimary(),b,a,""));const E={w:b.data.width+2*i.B,h:b.data.height+2*i.B,x:0,y:0},k=new i.F(E,b,i.B);this.patterns[a][t]={bin:E,position:k}}return this._updatePatternAtlas(a,p),this.patterns[a][t].position}bind(t,a){const p=t.gl;let v=this.atlasTexture[a];v?this.dirty&&(v.update(this.atlasImage[a]),this.dirty=!1):(v=new i.T(t,this.atlasImage[a],p.RGBA8),this.atlasTexture[a]=v),v.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(t,a){const p=[];for(const k in this.patterns[t])p.push(this.patterns[t][k].bin);const{w:v,h:b}=i.C(p),E=this.atlasImage[t];E.resize({width:v||1,height:b||1});for(const k in this.patterns[t]){const{bin:O,position:N}=this.patterns[t][k];let $=N.padding;const W=O.x+$,Z=O.y+$,Y=this.images[t][k].data,he=Y.width,ue=Y.height;$=$>1?$-1:$,i.r.copy(Y,E,{x:0,y:0},{x:W,y:Z},{width:he,height:ue},a),i.r.copy(Y,E,{x:0,y:ue-$},{x:W,y:Z-$},{width:he,height:$},a),i.r.copy(Y,E,{x:0,y:0},{x:W,y:Z+ue},{width:he,height:$},a),i.r.copy(Y,E,{x:he-$,y:0},{x:W-$,y:Z},{width:$,height:ue},a),i.r.copy(Y,E,{x:0,y:0},{x:W+he,y:Z},{width:$,height:ue},a),i.r.copy(Y,E,{x:he-$,y:ue-$},{x:W-$,y:Z-$},{width:$,height:$},a),i.r.copy(Y,E,{x:0,y:ue-$},{x:W+he,y:Z-$},{width:$,height:$},a),i.r.copy(Y,E,{x:0,y:0},{x:W+he,y:Z+ue},{width:$,height:$},a),i.r.copy(Y,E,{x:he-$,y:0},{x:W-$,y:Z+ue},{width:$,height:$},a)}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,a){for(const p of t){if(this.callbackDispatchedThisFrame[a][p])continue;this.callbackDispatchedThisFrame[a][p]=!0;const v=this.images[a][p];_t(v)&&this.updateImage(p,a,v)}}}function pr(h){const t=h.key,a=h.value,p=h.valueSpec||{},v=h.objectElementValidators||{},b=h.style,E=h.styleSpec;let k=[];const O=i.H(a);if(O!=="object")return[new i.V(t,a,`object expected, ${O} found`)];for(const N in a){const $=N.split(".")[0];let W;v[$]?W=v[$]:p[$]?W=$n:v["*"]?W=v["*"]:p["*"]&&(W=$n),W?k=k.concat(W({key:(t&&`${t}.`)+N,value:a[N],valueSpec:p[$]||p["*"],style:b,styleSpec:E,object:a,objectKey:N},a)):k.push(new i.G(t,a[N],`unknown property "${N}"`))}for(const N in p)v[N]||p[N].required&&p[N].default===void 0&&a[N]===void 0&&k.push(new i.V(t,a,`missing required property "${N}"`));return k}function qn(h){const t=h.value,a=h.valueSpec,p=h.style,v=h.styleSpec,b=h.key,E=h.arrayElementValidator||$n;if(i.H(t)!=="array")return[new i.V(b,t,`array expected, ${i.H(t)} found`)];if(a.length&&t.length!==a.length)return[new i.V(b,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new i.V(b,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let k={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};v.$version<7&&(k.function=a.function),i.H(a.value)==="object"&&(k=a.value);let O=[];for(let N=0;N<t.length;N++)O=O.concat(E({array:t,arrayIndex:N,value:t[N],valueSpec:k,style:p,styleSpec:v,key:`${b}[${N}]`},!0));return O}function _n(h){const t=h.key,a=h.value,p=h.valueSpec;let v=i.H(a);if(v==="number"&&a!=a&&(v="NaN"),v!=="number")return[new i.V(t,a,`number expected, ${v} found`)];if("minimum"in p){let b=p.minimum;if(i.H(p.minimum)==="array"&&(b=p.minimum[h.arrayIndex]),a<b)return[new i.V(t,a,`${a} is less than the minimum value ${b}`)]}if("maximum"in p){let b=p.maximum;if(i.H(p.maximum)==="array"&&(b=p.maximum[h.arrayIndex]),a>b)return[new i.V(t,a,`${a} is greater than the maximum value ${b}`)]}return[]}function ir(h){const t=h.valueSpec,a=i.K(h.value.type);let p,v,b,E={};const k=a!=="categorical"&&h.value.property===void 0,O=!k,N=i.H(h.value.stops)==="array"&&i.H(h.value.stops[0])==="array"&&i.H(h.value.stops[0][0])==="object",$=pr({key:h.key,value:h.value,valueSpec:h.styleSpec.function,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(Y){if(a==="identity")return[new i.V(Y.key,Y.value,'identity function may not have a "stops" property')];let he=[];const ue=Y.value;return he=he.concat(qn({key:Y.key,value:ue,valueSpec:Y.valueSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:W})),i.H(ue)==="array"&&ue.length===0&&he.push(new i.V(Y.key,ue,"array must have at least one stop")),he},default:function(Y){return $n({key:Y.key,value:Y.value,valueSpec:t,style:Y.style,styleSpec:Y.styleSpec})}}});return a==="identity"&&k&&$.push(new i.V(h.key,h.value,'missing required property "property"')),a==="identity"||h.value.stops||$.push(new i.V(h.key,h.value,'missing required property "stops"')),a==="exponential"&&h.valueSpec.expression&&!i.L(h.valueSpec)&&$.push(new i.V(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(O&&!i.M(h.valueSpec)?$.push(new i.V(h.key,h.value,"property functions not supported")):k&&!i.N(h.valueSpec)&&$.push(new i.V(h.key,h.value,"zoom functions not supported"))),a!=="categorical"&&!N||h.value.property!==void 0||$.push(new i.V(h.key,h.value,'"property" property is required')),$;function W(Y){let he=[];const ue=Y.value,me=Y.key;if(i.H(ue)!=="array")return[new i.V(me,ue,`array expected, ${i.H(ue)} found`)];if(ue.length!==2)return[new i.V(me,ue,`array length 2 expected, length ${ue.length} found`)];if(N){if(i.H(ue[0])!=="object")return[new i.V(me,ue,`object expected, ${i.H(ue[0])} found`)];if(ue[0].zoom===void 0)return[new i.V(me,ue,"object stop key must have zoom")];if(ue[0].value===void 0)return[new i.V(me,ue,"object stop key must have value")];const ve=i.K(ue[0].zoom);if(typeof ve!="number")return[new i.V(me,ue[0].zoom,"stop zoom values must be numbers")];if(b&&b>ve)return[new i.V(me,ue[0].zoom,"stop zoom values must appear in ascending order")];ve!==b&&(b=ve,v=void 0,E={}),he=he.concat(pr({key:`${me}[0]`,value:ue[0],valueSpec:{zoom:{}},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:_n,value:Z}}))}else he=he.concat(Z({key:`${me}[0]`,value:ue[0],valueSpec:{},style:Y.style,styleSpec:Y.styleSpec},ue));return i.O(i.Q(ue[1]))?he.concat([new i.V(`${me}[1]`,ue[1],"expressions are not allowed in function stops.")]):he.concat($n({key:`${me}[1]`,value:ue[1],valueSpec:t,style:Y.style,styleSpec:Y.styleSpec}))}function Z(Y,he){const ue=i.H(Y.value),me=i.K(Y.value),ve=Y.value!==null?Y.value:he;if(p){if(ue!==p)return[new i.V(Y.key,ve,`${ue} stop domain type must match previous stop domain type ${p}`)]}else p=ue;if(ue!=="number"&&ue!=="string"&&ue!=="boolean"&&typeof me!="number"&&typeof me!="string"&&typeof me!="boolean")return[new i.V(Y.key,ve,"stop domain value must be a number, string, or boolean")];if(ue!=="number"&&a!=="categorical"){let Se=`number expected, ${ue} found`;return i.M(t)&&a===void 0&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(Y.key,ve,Se)]}return a!=="categorical"||ue!=="number"||typeof me=="number"&&isFinite(me)&&Math.floor(me)===me?a!=="categorical"&&ue==="number"&&typeof me=="number"&&typeof v=="number"&&v!==void 0&&me<v?[new i.V(Y.key,ve,"stop domain values must appear in ascending order")]:(v=me,a==="categorical"&&me in E?[new i.V(Y.key,ve,"stop domain values must be unique")]:(E[me]=!0,[])):[new i.V(Y.key,ve,`integer expected, found ${String(me)}`)]}}function cr(h){const t=(h.expressionContext==="property"?i.S:i.U)(i.Q(h.value),h.valueSpec);if(t.result==="error")return t.value.map(p=>new i.V(`${h.key}${p.key}`,h.value,p.message));const a=t.value.expression||t.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!a.outputDefined())return[new i.V(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!i.W(a))return[new i.V(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter")return Er(a,h);if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!i.X(a,["zoom","feature-state"]))return[new i.V(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!i.Y(a))return[new i.V(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Er(h,t){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const v of t.valueSpec.expression.parameters)a.delete(v);if(a.size===0)return[];const p=[];return h instanceof i.Z&&a.has(h.name)?[new i.V(t.key,t.value,`["${h.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(h.eachChild(v=>{p.push(...Er(v,t))}),p)}function On(h){const t=h.key,a=h.value,p=h.valueSpec,v=[];return Array.isArray(p.values)?p.values.indexOf(i.K(a))===-1&&v.push(new i.V(t,a,`expected one of [${p.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(p.values).indexOf(i.K(a))===-1&&v.push(new i.V(t,a,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(a)} found`)),v}function fi(h){return i.$(i.Q(h.value))?cr(i.J({},h,{expressionContext:"filter",valueSpec:h.styleSpec[`filter_${h.layerType||"fill"}`]})):Dt(h)}function Dt(h){const t=h.value,a=h.key;if(i.H(t)!=="array")return[new i.V(a,t,`array expected, ${i.H(t)} found`)];const p=h.styleSpec;let v,b=[];if(t.length<1)return[new i.V(a,t,"filter array must have at least 1 element")];switch(b=b.concat(On({key:`${a}[0]`,value:t[0],valueSpec:p.filter_operator,style:h.style,styleSpec:h.styleSpec})),i.K(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&i.K(t[1])==="$type"&&b.push(new i.V(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new i.V(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(v=i.H(t[1]),v!=="string"&&b.push(new i.V(`${a}[1]`,t[1],`string expected, ${v} found`)));for(let E=2;E<t.length;E++)v=i.H(t[E]),i.K(t[1])==="$type"?b=b.concat(On({key:`${a}[${E}]`,value:t[E],valueSpec:p.geometry_type,style:h.style,styleSpec:h.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&b.push(new i.V(`${a}[${E}]`,t[E],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let E=1;E<t.length;E++)b=b.concat(Dt({key:`${a}[${E}]`,value:t[E],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":v=i.H(t[1]),t.length!==2?b.push(new i.V(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):v!=="string"&&b.push(new i.V(`${a}[1]`,t[1],`string expected, ${v} found`))}return b}function Ft(h,t){const a=h.key,p=h.style,v=h.layer,b=h.styleSpec,E=h.value,k=h.objectKey,O=b[`${t}_${h.layerType}`];if(!O)return[];const N=k.match(/^(.*)-use-theme$/);if(t==="paint"&&N&&O[N[1]])return $n({key:a,value:E,valueSpec:{type:"string"},style:p,styleSpec:b});const $=k.match(/^(.*)-transition$/);if(t==="paint"&&$&&O[$[1]]&&O[$[1]].transition)return $n({key:a,value:E,valueSpec:b.transition,style:p,styleSpec:b});const W=h.valueSpec||O[k];if(!W)return[new i.G(a,E,`unknown property "${k}"`)];let Z;if(i.H(E)==="string"&&i.M(W)&&!W.tokens&&(Z=/^{([^}]+)}$/.exec(E))){const he=`\`{ "type": "identity", "property": ${Z?JSON.stringify(Z[1]):'"_"'} }\``;return[new i.V(a,E,`"${k}" does not support interpolation syntax
Use an identity property function instead: ${he}.`)]}const Y=[];if(h.layerType==="symbol")k!=="text-field"||!p||p.glyphs||p.imports||Y.push(new i.V(a,E,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&i.a0(i.Q(E))&&i.K(E.type)==="identity"&&Y.push(new i.V(a,E,'"text-font" does not support identity functions'));else if(h.layerType==="model"&&t==="paint"&&v&&v.layout&&v.layout.hasOwnProperty("model-id")&&i.M(W)&&(i.a1(W)||i.N(W))){const he=i.S(i.Q(E),W),ue=he.value.expression||he.value._styleExpression.expression;ue&&!i.X(ue,["measure-light"])&&(k==="model-emissive-strength"&&i.Y(ue)&&i.W(ue)||Y.push(new i.V(a,E,`${k} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Y.concat($n({key:h.key,value:E,valueSpec:W,style:p,styleSpec:b,expressionContext:"property",propertyType:t,propertyKey:k}))}function sn(h){return Ft(h,"paint")}function Tn(h){return Ft(h,"layout")}function Pn(h){let t=[];const a=h.value,p=h.key,v=h.style,b=h.styleSpec;a.type||a.ref||t.push(new i.V(p,a,'either "type" or "ref" is required'));let E=i.K(a.type);const k=i.K(a.ref);if(a.id){const O=i.K(a.id);for(let N=0;N<h.arrayIndex;N++){const $=v.layers[N];i.K($.id)===O&&t.push(new i.V(p,a.id,`duplicate layer id "${a.id}", previously used at line ${$.id.__line__}`))}}if("ref"in a){let O;["type","source","source-layer","filter","layout"].forEach(N=>{N in a&&t.push(new i.V(p,a[N],`"${N}" is prohibited for ref layers`))}),v.layers.forEach(N=>{i.K(N.id)===k&&(O=N)}),O?O.ref?t.push(new i.V(p,a.ref,"ref cannot reference another ref layer")):E=i.K(O.type):typeof k=="string"&&t.push(new i.V(p,a.ref,`ref layer "${k}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(a.source){const O=v.sources&&v.sources[a.source],N=O&&i.K(O.type);O?N==="vector"&&E==="raster"?t.push(new i.V(p,a.source,`layer "${a.id}" requires a raster source`)):N==="raster"&&E!=="raster"?t.push(new i.V(p,a.source,`layer "${a.id}" requires a vector source`)):N!=="vector"||a["source-layer"]?N==="raster-dem"&&E!=="hillshade"?t.push(new i.V(p,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):N!=="raster-array"||["raster","raster-particle"].includes(E)?E!=="line"||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||N==="geojson"&&O.lineMetrics?E==="raster-particle"&&N!=="raster-array"&&t.push(new i.V(p,a.source,`layer "${a.id}" requires a 'raster-array' source.`)):t.push(new i.V(p,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new i.V(p,a.source,"raster-array source can only be used with layer type 'raster'.")):t.push(new i.V(p,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new i.V(p,a.source,`source "${a.source}" not found`))}else t.push(new i.V(p,a,'missing required property "source"'));return t=t.concat(pr({key:p,value:a,valueSpec:b.layer,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{"*":()=>[],type:()=>$n({key:`${p}.type`,value:a.type,valueSpec:b.layer.type,style:h.style,styleSpec:h.styleSpec,object:a,objectKey:"type"}),filter:O=>fi(i.J({layerType:E},O)),layout:O=>pr({layer:a,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":N=>Tn(i.J({layerType:E},N))}}),paint:O=>pr({layer:a,key:O.key,value:O.value,valueSpec:{},style:O.style,styleSpec:O.styleSpec,objectElementValidators:{"*":N=>sn(i.J({layerType:E,layer:a},N))}})}})),t}function ur(h){const t=h.value,a=h.key,p=i.H(t);return p!=="string"?[new i.V(a,t,`string expected, ${p} found`)]:[]}const Bn={promoteId:function({key:h,value:t}){if(i.H(t)==="string")return ur({key:h,value:t});{const a=[];for(const p in t)a.push(...ur({key:`${h}.${p}`,value:t[p]}));return a}}};function Hn(h){const t=h.value,a=h.key,p=h.styleSpec,v=h.style;if(!t.type)return[new i.V(a,t,'"type" is required')];const b=i.K(t.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&(t.url||t.tiles||E.push(new i.G(a,t,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(pr({key:a,value:t,valueSpec:p[`source_${b.replace("-","_")}`],style:h.style,styleSpec:p,objectElementValidators:Bn})),E;case"geojson":if(E=pr({key:a,value:t,valueSpec:p.source_geojson,style:v,styleSpec:p,objectElementValidators:Bn}),t.cluster)for(const k in t.clusterProperties){const[O,N]=t.clusterProperties[k],$=typeof O=="string"?[O,["accumulated"],["get",k]]:O;E.push(...cr({key:`${a}.${k}.map`,value:N,expressionContext:"cluster-map"})),E.push(...cr({key:`${a}.${k}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return E;case"video":return pr({key:a,value:t,valueSpec:p.source_video,style:v,styleSpec:p});case"image":return pr({key:a,value:t,valueSpec:p.source_image,style:v,styleSpec:p});case"canvas":return[new i.V(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return On({key:`${a}.type`,value:t.type,valueSpec:{values:Zr(p)},style:v,styleSpec:p})}}function Zr(h){return h.source.reduce((t,a)=>{const p=h[a];return p.type.type==="enum"&&(t=t.concat(Object.keys(p.type.values))),t},[])}function Lr(h){const t=h.value,a=h.styleSpec,p=a.light,v=h.style;let b=[];const E=i.H(t);if(t===void 0)return b;if(E!=="object")return b=b.concat([new i.V("light",t,`object expected, ${E} found`)]),b;for(const k in t){const O=k.match(/^(.*)-transition$/),N=k.match(/^(.*)-use-theme$/);b=b.concat(N&&p[N[1]]?$n({key:k,value:t[k],valueSpec:{type:"string"},style:v,styleSpec:a}):O&&p[O[1]]&&p[O[1]].transition?$n({key:k,value:t[k],valueSpec:a.transition,style:v,styleSpec:a}):p[k]?$n({key:k,value:t[k],valueSpec:p[k],style:v,styleSpec:a}):[new i.V(k,t[k],`unknown property "${k}"`)])}return b}function qr(h){const t=h.value;let a=[];if(!t)return a;const p=i.H(t);if(p!=="object")return a=a.concat([new i.V("light-3d",t,`object expected, ${p} found`)]),a;const v=h.styleSpec,b=v["light-3d"],E=h.key,k=h.style,O=h.style.lights;for(const W of["type","id"])if(!(W in t))return a=a.concat([new i.V("light-3d",t,`missing property ${W} on light`)]),a;if(t.type&&O)for(let W=0;W<h.arrayIndex;W++){const Z=i.K(t.type),Y=O[W];i.K(Y.type)===Z&&a.push(new i.V(E,t.id,`duplicate light type "${t.type}", previously defined at line ${Y.id.__line__}`))}const N=`properties_light_${t.type}`;if(!(N in v))return a=a.concat([new i.V("light-3d",t,`Invalid light type ${t.type}`)]),a;const $=v[N];for(const W in t)if(W==="properties"){const Z=t[W],Y=i.H(Z);if(Y!=="object")return a=a.concat([new i.V("properties",Z,`object expected, ${Y} found`)]),a;for(const he in Z)a=a.concat($[he]?$n({key:he,value:Z[he],valueSpec:$[he],style:k,styleSpec:v}):[new i.G(h.key,Z[he],`unknown property "${he}"`)])}else{const Z=W.match(/^(.*)-transition$/),Y=W.match(/^(.*)-use-theme$/);a=a.concat(Y&&b[Y[1]]?$n({key:W,value:t[W],valueSpec:{type:"string"},style:k,styleSpec:v}):Z&&b[Z[1]]&&b[Z[1]].transition?$n({key:W,value:t[W],valueSpec:v.transition,style:k,styleSpec:v}):b[W]?$n({key:W,value:t[W],valueSpec:b[W],style:k,styleSpec:v}):[new i.G(W,t[W],`unknown property "${W}"`)])}return a}function Yn(h){const t=h.value,a=h.key,p=h.style,v=h.styleSpec,b=v.terrain;let E=[];const k=i.H(t);if(t===void 0||k==="null")return E;if(k!=="object")return E=E.concat([new i.V("terrain",t,`object expected, ${k} found`)]),E;for(const O in t){const N=O.match(/^(.*)-transition$/),$=O.match(/^(.*)-use-theme$/);E=E.concat($&&b[$[1]]?$n({key:O,value:t[O],valueSpec:{type:"string"},style:p,styleSpec:v}):N&&b[N[1]]&&b[N[1]].transition?$n({key:O,value:t[O],valueSpec:v.transition,style:p,styleSpec:v}):b[O]?$n({key:O,value:t[O],valueSpec:b[O],style:p,styleSpec:v}):[new i.G(O,t[O],`unknown property "${O}"`)])}if(t.source){const O=p.sources&&p.sources[t.source],N=O&&i.K(O.type);O?N!=="raster-dem"&&E.push(new i.V(a,t.source,`terrain cannot be used with a source of type ${String(N)}, it only be used with a "raster-dem" source type`)):E.push(new i.V(a,t.source,`source "${t.source}" not found`))}else E.push(new i.V(a,t,'terrain is missing required property "source"'));return E}function Ar(h){const t=h.value,a=h.style,p=h.styleSpec,v=p.fog;let b=[];const E=i.H(t);if(t===void 0)return b;if(E!=="object")return b=b.concat([new i.V("fog",t,`object expected, ${E} found`)]),b;for(const k in t){const O=k.match(/^(.*)-transition$/),N=k.match(/^(.*)-use-theme$/);b=b.concat(N&&v[N[1]]?$n({key:k,value:t[k],valueSpec:{type:"string"},style:a,styleSpec:p}):O&&v[O[1]]&&v[O[1]].transition?$n({key:k,value:t[k],valueSpec:p.transition,style:a,styleSpec:p}):v[k]?$n({key:k,value:t[k],valueSpec:v[k],style:a,styleSpec:p}):[new i.G(k,t[k],`unknown property "${k}"`)])}return b}const si={"*":()=>[],array:qn,boolean:function(h){const t=h.value,a=h.key,p=i.H(t);return p!=="boolean"?[new i.V(a,t,`boolean expected, ${p} found`)]:[]},number:_n,color:function(h){const t=h.key,a=h.value,p=i.H(a);return p!=="string"?[new i.V(t,a,`color expected, ${p} found`)]:i._.parseCSSColor(a)===null?[new i.V(t,a,`color expected, "${a}" found`)]:[]},enum:On,filter:fi,function:ir,layer:Pn,object:pr,source:Hn,model:i.a2,light:Lr,"light-3d":qr,terrain:Yn,fog:Ar,string:ur,formatted:function(h){return ur(h).length===0?[]:cr(h)},resolvedImage:function(h){return ur(h).length===0?[]:cr(h)},projection:function(h){const t=h.value,a=h.styleSpec,p=a.projection,v=h.style;let b=[];const E=i.H(t);if(E==="object")for(const k in t)b=b.concat($n({key:k,value:t[k],valueSpec:p[k],style:v,styleSpec:a}));else E!=="string"&&(b=b.concat([new i.V("projection",t,`object or string expected, ${E} found`)]));return b},import:function(h){const{value:t,styleSpec:a}=h,{data:p,...v}=t;Object.defineProperty(v,"__line__",{value:t.__line__,enumerable:!1});let b=pr(i.J({},h,{value:v,valueSpec:a.import}));return i.K(v.id)===""&&b.push(new i.V(`${h.key}.id`,v,"import id can't be an empty string")),p&&(b=b.concat(ra(p,a,{key:`${h.key}.data`}))),b}};function $n(h,t=!1){const a=h.value,p=h.valueSpec,v=h.styleSpec;if(p.expression&&i.a0(i.K(a)))return ir(h);if(p.expression&&i.O(i.Q(a)))return cr(h);if(p.type&&si[p.type]){const b=si[p.type](h);return t===!0&&b.length>0&&i.H(h.value)==="array"?cr(h):b}return pr(i.J({},h,{valueSpec:p.type?v[p.type]:p}))}function Zi(h){const t=h.value,a=h.key,p=ur(h);return p.length||(t.indexOf("{fontstack}")===-1&&p.push(new i.V(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&p.push(new i.V(a,t,'"glyphs" url must include a "{range}" token'))),p}function ra(h,t=i.a3,a={}){return $n({key:a.key||"",value:h,valueSpec:t.$root,styleSpec:t,style:h,objectElementValidators:{glyphs:Zi,"*":()=>[]}})}function Wi(h,t=i.a3){return mt(ra(h,t))}const ai=h=>mt(Hn(h)),Fi=h=>mt(Lr(h)),ia=h=>mt(qr(h)),vs=h=>mt(Yn(h)),Do=h=>mt(Ar(h)),ht=h=>mt(function(t){const a=t.value,p=t.style,v=t.styleSpec,b=v.snow;let E=[];const k=i.H(a);if(a===void 0)return E;if(k!=="object")return E=E.concat([new i.V("snow",a,`object expected, ${k} found`)]),E;for(const O in a){const N=O.match(/^(.*)-transition$/);E=E.concat(N&&b[N[1]]&&b[N[1]].transition?$n({key:O,value:a[O],valueSpec:v.transition,style:p,styleSpec:v}):b[O]?$n({key:O,value:a[O],valueSpec:b[O],style:p,styleSpec:v}):[new i.G(O,a[O],`unknown property "${O}"`)])}return E}(h)),ge=h=>mt(function(t){const a=t.value,p=t.style,v=t.styleSpec,b=v.rain;let E=[];const k=i.H(a);if(a===void 0)return E;if(k!=="object")return E=E.concat([new i.V("rain",a,`object expected, ${k} found`)]),E;for(const O in a){const N=O.match(/^(.*)-transition$/);E=E.concat(N&&b[N[1]]&&b[N[1]].transition?$n({key:O,value:a[O],valueSpec:v.transition,style:p,styleSpec:v}):b[O]?$n({key:O,value:a[O],valueSpec:b[O],style:p,styleSpec:v}):[new i.G(O,a[O],`unknown property "${O}"`)])}return E}(h)),be=h=>mt(Pn(h)),Re=h=>mt(fi(h)),qe=h=>mt(sn(h)),We=h=>mt(Tn(h)),tt=h=>mt(i.a2(h));function mt(h){return h.slice().sort((t,a)=>t.line&&a.line?t.line-a.line:0)}function it(h,t){let a=!1;if(t&&t.length)for(const p of t)p instanceof i.G?i.w(p.message):(h.fire(new i.y(new Error(p.message))),a=!0);return a}let yt;class bt extends i.E{constructor(t,a="flat"){super(),this._transitionable=new i.a4(yt||(yt=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(t,a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a,p={}){this._validate(Fi,t,p)||(this._transitionable.setTransitionOrValue(t),this.id=a)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,p){return(!p||p.validate!==!1)&&it(this,t.call(Wi,i.l({value:a,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Et=class extends i.E{constructor(h,t,a,p){super(),this.scope=a,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),a,p),this._transitionable.setTransitionOrValue(h,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}get(){return this._transitionable.serialize()}set(h,t){this._transitionable.setTransitionOrValue(h,t)}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}getExaggeration(h){return this._transitioning.possiblyEvaluate(new i.a8(h)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const h=this._transitionable._values.exaggeration;if(!h)return null;const t=h.value.expression;if(!t)return null;let a=-1,p=-1,v=1;for(const b of t.zoomStops)v=t.evaluate(new i.a8(b)),v>.01?(a=b,p=-1):p=b;return v<.01&&a>0&&p>a?[a,p]:null}isZoomDependent(){const h=this._transitionable._values.exaggeration;return h!=null&&h.value!=null&&h.value.expression!=null&&h.value.expression instanceof i.a9}};const Xt=45,un=65,an=.05;function Vn(h,t,a,p){const v=i.ac(Xt,un,a),[b,E]=tr(h,p);let k=1-Math.min(1,Math.exp((t-b)/(E-b)*-6));return k*=k*k,k=Math.min(1,1.00747*k),k*v*h.alpha}function tr(h,t){const a=.5/Math.tan(.5*t);return[h.range[0]+a,h.range[1]+a]}function Kn(h,t,a,p,v){const b=i.ab.vec3.transformMat4([],[t,a,p],v.mercatorFogMatrix);return Vn(h,i.ab.vec3.length(b),v.pitch,v._fov)}function Xn(h,t,a,p,v,b,E){const k=[[a,p,0],[v,p,0],[v,b,0],[a,b,0]];let O=Number.MAX_VALUE,N=-Number.MAX_VALUE;for(const $ of k){const W=i.ab.vec3.transformMat4([],$,t),Z=i.ab.vec3.length(W);O=Math.min(O,Z),N=Math.max(N,Z)}return[Vn(h,O,E.pitch,E._fov),Vn(h,N,E.pitch,E._fov)]}class Wr extends i.E{constructor(t,a,p,v){super();const b=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(b,p,new Map(v)),this.set(t,v),this._transitioning=this._transitionable.untransitioned(),this._transform=a,this.properties=new i.ad(b),this.scope=p}get state(){const t=this._transform,a=t.projection.name==="globe",p=i.ae(t.zoom),v=this.properties.get("range"),b=[.5,3];return{range:a?[i.af(b[0],v[0],p),i.af(b[1],v[1],p)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,a,p={}){if(this._validate(Do,t,p))return;const v=i.l({},t);for(const b of Object.keys(i.a3.fog))v[b]===void 0&&(v[b]=i.a3.fog[b].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,a)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const a=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(Xt,un,t))*a.a}getOpacityAtLatLng(t,a){return this._transform.projection.supportsFog?function(p,v,b){const E=i.aa.fromLngLat(v),k=b.elevation?b.elevation.getAtPointOrZero(E):0;return Kn(p,E.x,E.y,k,b)}(this.state,t,a):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const a=this._transform.calculateFogTileMatrix(t.toUnwrapped());return Xn(this.state,a,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(t,a,p,v,b){return this._transform.projection.supportsFog?Xn(this.state,t,a,p,v,b,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?tr(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const a=[4,5,6,7];for(const p of a){const v=t.points[p];let b;if(v[2]>=0)b=v;else{const E=t.points[p-4];b=i.ah(E,v,E[2]/(E[2]-v[2]))}if(Kn(this.state,b[0],b[1],0,this._transform)>=an)return!0}return!1}updateConfig(t){this._transitionable.setTransitionOrValue(this._options,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,p){return(!p||p.validate!==!1)&&it(this,t.call(Wi,i.l({value:a,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Nr,wr,Hr,Xr,Vr=class extends i.E{constructor(h,t,a,p){super();const v=Nr||(Nr=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(v,a,new Map(p)),this.set(h,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(v),this.scope=a}get state(){const h=this.properties.get("opacity"),t=this.properties.get("color"),a=this.properties.get("direction"),p=i.ai(a[0]),v=-Math.max(i.ai(a[1]),.01),b=[Math.cos(p)*Math.cos(v),Math.sin(p)*Math.cos(v),Math.sin(v)],E=this.properties.get("vignette"),k=this.properties.get("vignette-color");return k.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(t.r,t.g,t.b,t.a*h),direction:b,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:k}}get(){return this._transitionable.serialize()}set(h,t,a={}){if(this._validate(ht,h,a))return;const p=i.l({},h);for(const v of Object.keys(i.a3.snow))p[v]===void 0&&(p[v]=i.a3.snow[v].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,t)}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,t,a){return(!a||a.validate!==!1)&&it(this,h.call(Wi,i.l({value:t,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},Yo=class extends i.E{constructor(h,t,a,p){super();const v=wr||(wr=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(v,a,new Map(p)),this.set(h,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(v),this.scope=a}get state(){const h=this.properties.get("opacity"),t=this.properties.get("color"),a=this.properties.get("direction"),p=i.ai(a[0]),v=-Math.max(i.ai(a[1]),.01),b=[Math.cos(p)*Math.cos(v),Math.sin(p)*Math.cos(v),Math.sin(v)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(t.r,t.g,t.b,t.a*h),direction:b,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(h,t,a={}){if(this._validate(ge,h,a))return;const p=i.l({},h);for(const v of Object.keys(i.a3.rain))p[v]===void 0&&(p[v]=i.a3.rain[v].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,t)}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,t,a){return(!a||a.validate!==!1)&&it(this,h.call(Wi,i.l({value:t,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class no extends i.E{constructor(t,a,p,v){super(),this.scope=p,this._options=t,this.properties=new i.ad(a),this._transitionable=new i.a4(a,p,new Map(v)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,a){this._options=t,this._transitionable.setTransitionOrValue(t.properties,a)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class go{constructor(t,a,p,v){this.screenBounds=t,this.cameraPoint=a,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(t,a){let p,v;if(t instanceof i.P||typeof t[0]=="number"){const b=i.P.convert(t);p=[b],v=a.isPointAboveHorizon(b)}else{const b=i.P.convert(t[0]),E=i.P.convert(t[1]);p=[b,E],v=i.al(b,E).every(k=>a.isPointAboveHorizon(k))}return new go(p,a.getCameraPoint(),v,a)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const a=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],v=i.al(a,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>a.x&&this.cameraPoint.x<p.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?v[2]=this.cameraPoint:this.cameraPoint.x<=a.x&&(v[3]=this.cameraPoint)),i.am(v,t)}bufferedCameraGeometryGlobe(t){const a=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],v=i.al(a,p,t),b=this.cameraPoint.clone();switch(3*((b.y>a.y)+(b.y>p.y))+((b.x>a.x)+(b.x>p.x))){case 0:v[0]=b,v[4]=b.clone();break;case 1:v.splice(1,0,b);break;case 2:v[1]=b;break;case 3:v.splice(4,0,b);break;case 5:v.splice(2,0,b);break;case 6:v[3]=b;break;case 7:v.splice(3,0,b);break;case 8:v[2]=b}return v}containsTile(t,a,p,v=0){const b=t.queryPadding/a._pixelsPerMercatorPixel+1,E=p?this._bufferedCameraMercator(b,a):this._bufferedScreenMercator(b,a);let k=t.tileID.wrap+(E.unwrapped?v:0);const O=E.polygon.map(me=>i.an(t.tileTransform,me,k));if(!i.ao(O,0,0,i.ag,i.ag))return;k=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const N=this.screenGeometryMercator.polygon.map(me=>i.ap(t.tileTransform,me,k)),$=N.map(me=>new i.P(me[0],me[1])),W=a.getFreeCameraOptions().position||new i.aa(0,0,0),Z=i.ap(t.tileTransform,W,k),Y=N.map(me=>{const ve=i.ab.vec3.sub(me,me,Z);return i.ab.vec3.normalize(ve,ve),new i.aq(Z,ve)}),he=i.ar(t,1,a.zoom)*a._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:Y,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(ue=i.as(O),ue.min.x=i.aw(ue.min.x,0,i.ag),ue.min.y=i.aw(ue.min.y,0,i.ag),ue.max.x=i.aw(ue.max.x,0,i.ag),ue.max.y=i.aw(ue.max.y,0,i.ag),ue),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:he};var ue}_bufferedScreenMercator(t,a){const p=lh(t);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let v;return v=a.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),a):{polygon:this.bufferedScreenGeometry(t).map(b=>a.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[p]=v,v}}_bufferedCameraMercator(t,a){const p=lh(t);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let v;return v=a.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),a):{polygon:this.bufferedCameraGeometry(t).map(b=>a.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[p]=v,v}}_projectAndResample(t,a){const p=function(b,E){const k=i.ab.mat4.multiply([],E.pixelMatrix,E.globeMatrix),O=[0,-i.ax,0,1],N=[0,i.ax,0,1],$=[0,0,0,1];i.ab.vec4.transformMat4(O,O,k),i.ab.vec4.transformMat4(N,N,k),i.ab.vec4.transformMat4($,$,k);const W=new i.P(O[0]/O[3],O[1]/O[3]),Z=new i.P(N[0]/N[3],N[1]/N[3]),Y=i.au(b,W)&&O[3]<$[3],he=i.au(b,Z)&&N[3]<$[3];if(!Y&&!he)return null;const ue=function(Oe,ze,Ne){for(let je=1;je<Oe.length;je++){const pt=Pa(ze.pointCoordinate3D(Oe[je-1]).x),ot=Pa(ze.pointCoordinate3D(Oe[je]).x);if(Ne<0){if(pt<ot)return{idx:je,t:-pt/(ot-1-pt)}}else if(ot<pt)return{idx:je,t:(1-pt)/(ot+1-pt)}}return null}(b,E,Y?-1:1);if(!ue)return null;const{idx:me,t:ve}=ue;let Se=me>1?Aa(b.slice(0,me),E):[],Pe=me<b.length?Aa(b.slice(me),E):[];Se=Se.map(Oe=>new i.P(Pa(Oe.x),Oe.y)),Pe=Pe.map(Oe=>new i.P(Pa(Oe.x),Oe.y));const Me=[...Se];Me.length===0&&Me.push(Pe[Pe.length-1]);const Fe=i.af(Me[Me.length-1].y,(Pe.length===0?Se[0]:Pe[0]).y,ve);let De;return De=Y?[new i.P(0,Fe),new i.P(0,0),new i.P(1,0),new i.P(1,Fe)]:[new i.P(1,Fe),new i.P(1,1),new i.P(0,1),new i.P(0,Fe)],Me.push(...De),Pe.length===0?Me.push(Se[0]):Me.push(...Pe),{polygon:Me.map(Oe=>new i.aa(Oe.x,Oe.y)),unwrapped:!1}}(t,a);if(p)return p;const v=function(b,E){let k=!1,O=-1/0,N=0;for(let W=0;W<b.length-1;W++)b[W].x>O&&(O=b[W].x,N=W);for(let W=0;W<b.length-1;W++){const Z=(N+W)%(b.length-1),Y=b[Z],he=b[Z+1];Math.abs(Y.x-he.x)>.5&&(Y.x<he.x?(Y.x+=1,Z===0&&(b[b.length-1].x+=1)):(he.x+=1,Z+1===b.length-1&&(b[0].x+=1)),k=!0)}const $=i.at(E.center.lng);return k&&$<Math.abs($-1)&&b.forEach(W=>{W.x-=1}),{polygon:b,unwrapped:k}}(Aa(t,a).map(b=>new i.P(Pa(b.x),b.y)),a);return{polygon:v.polygon.map(b=>new i.aa(b.x,b.y)),unwrapped:v.unwrapped}}}function Aa(h,t){return i.av(h,a=>{const p=t.pointCoordinate3D(a);a.x=p.x,a.y=p.y},1/256)}function Pa(h){return h<0?1+h%1:h%1}function lh(h){return 100*h|0}function Mc(h,t,a,p,v){const b=function(k,O){if(k)return v(k);if(O){if(h.url&&O.tiles&&h.tiles&&delete h.tiles,O.variants){if(!Array.isArray(O.variants))return v(new Error("variants must be an array"));for(const $ of O.variants){if($==null||typeof $!="object"||$.constructor!==Object)return v(new Error("variant must be an object"));if(!Array.isArray($.capabilities))return v(new Error("capabilities must be an array"));if($.capabilities.length===1&&$.capabilities[0]==="meshopt"){O=i.l(O,$);break}}}const N=i.ay(i.l({},O,h),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);N.tiles=t.canonicalizeTileset(N,h.url),v(null,N)}},E=function(k,O,N){if(!k)return null;if(!O&&!N)return k;N=N||k.worldview_default;const $=Object.values(k.language||{});if($.length===0)return null;const W=Object.values(k.worldview||{});if(W.length===0)return null;const Z=$.every(he=>he===O),Y=W.every(he=>he===N);return Z&&Y?k:O in(k.language_options||{})||N in(k.worldview_options||{})?null:k.language_options&&k.worldview_options?k:null}(h.data,a,p);return E?i.q.frame(()=>b(null,E)):h.url?i.n(t.transformRequest(t.normalizeSourceURL(h.url,null,a,p),i.R.Source),b):i.q.frame(()=>{const{data:k,...O}=h;b(null,O)})}class Ko{constructor(t,a,p){this.bounds=i.az.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=p||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),p=Math.floor(i.at(this.bounds.getWest())*a),v=Math.floor(i.aA(this.bounds.getNorth())*a),b=Math.ceil(i.at(this.bounds.getEast())*a),E=Math.ceil(i.aA(this.bounds.getSouth())*a);return t.x>=p&&t.x<b&&t.y>=v&&t.y<E}}class ch extends i.E{constructor(t,a,p,v){if(super(),this.id=t,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(a,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},a),this._collectResourceTiming=!!a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new i.aB}load(t){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const a=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=Mc(this._options,this.map._requestManager,a,p,(v,b)=>{if(this._tileJSONRequest=null,this._loaded=!0,v)a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${a}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new i.y(v));else if(b){if(i.l(this,b),this.hasWorldviews=!!b.worldview_options,b.worldview_default&&(this.worldviewDefault=b.worldview_default),b.vector_layers){this.vectorLayers=b.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of b.vector_layers)this.vectorLayerIds.push(E.id),b.worldview&&b.worldview[E.source]&&this.localizableLayerIds.add(E.id)}b.bounds&&(this.tileBounds=new Ko(b.bounds,this.minzoom,this.maxzoom)),Rt(b.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}t&&t(v)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(t,a){const p=t.tileID.canonical.url(this.tiles,this.scheme),v=this.map._requestManager.normalizeTileURL(p),b=this.map._requestManager.transformRequest(v,i.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,k=E?{image:E.image.clone()}:null,O={request:b,data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,lut:k,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(p)&&(O.worldview=this.map.getWorldview()||this.worldviewDefault,O.localizableLayerIds=this.localizableLayerIds),O.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=a:t.request=t.actor.send("reloadTile",O,N.bind(this));else if(t.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",O,N.bind(this),void 0,!0);else{const $=i.aD.call({deduped:this._deduped},O,(W,Z)=>{W||!Z?N.call(this,W):(O.data={cacheControl:Z.cacheControl,expires:Z.expires,rawData:Z.rawData.slice(0)},t.actor&&t.actor.send("loadTile",O,N.bind(this),void 0,!0))},!0);t.request={cancel:$}}function N($,W){return delete t.request,t.aborted?a(null):$&&$.status!==404?a($):(W&&W.resourceTiming&&(t.resourceTiming=W.resourceTiming),this.map._refreshExpiredTiles&&W&&t.setExpiryData(W),t.loadVectorData(W,this.map.painter),i.aE(this.dispatcher),a(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t,a){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Jo extends i.E{constructor(t,a,p,v){super(),this.id=t,this.dispatcher=p,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},a),i.l(this,i.ay(a,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Mc(this._options,this.map._requestManager,null,null,(a,p)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new i.y(a)):p&&(i.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(v=>v.id)),p.bounds&&(this.tileBounds=new Ko(p.bounds,this.minzoom,this.maxzoom)),Rt(p.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),t&&t(a)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,a){const p=i.q.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);t.request=i.o(this.map._requestManager.transformRequest(v,i.R.Tile),(b,E,k,O)=>(delete t.request,t.aborted?(t.state="unloaded",a(null)):b?(t.state="errored",a(b)):E?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:k,expires:O}),t.setTexture(E,this.map.painter),t.state="loaded",i.aE(this.dispatcher),void a(null)):a(null)))}abortTile(t,a){t.request&&(t.request.cancel(),delete t.request),a&&a()}unloadTile(t,a){t.texture&&t.texture instanceof i.T?(t.destroy(!0),t.texture&&t.texture instanceof i.T&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),a&&a()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ll extends Jo{constructor(t,a,p,v){super(t,a,p,v),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},a)}triggerRepaint(t){const a=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);a&&a.enabled&&p&&a._clearRenderCacheForTile(p.id,t.tileID),this.map.triggerRepaint()}loadTile(t,a){const p=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(p,i.R.Tile);t.requestParams=v,t.actor||(t.actor=this.dispatcher.getActor()),t.request=t.fetchHeader(void 0,(b,E,k,O)=>{if(delete t.request,t.aborted)return t.state="unloaded",a(null);if(b)return b.code===20?void 0:(t.state="errored",a(b));this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:k,expires:O}),t.state="empty",a(null)})}unloadTile(t,a){const p=t.texture;p&&p instanceof i.T?(t.destroy(!0),this.map.painter.saveTileTexture(p)):(t.destroy(),t.flushQueues(),t._isHeaderLoaded=!1,delete t._mrt,delete t.textureDescriptor),t.fbo&&(t.fbo.destroy(),delete t.fbo),delete t.request,delete t.requestParams,delete t.neighboringTiles,t.state="unloaded"}prepareTile(t,a,p){t._isHeaderLoaded&&(t.state!=="empty"&&(t.state="reloading"),t.fetchBand(a,p,(v,b)=>{if(v)return t.state="errored",this.fire(new i.y(v)),void this.triggerRepaint(t);b&&(t.setTexture(b,this.map.painter),t.state="loaded",this.triggerRepaint(t))}))}getInitialBand(t){if(!this.rasterLayers)return 0;const a=this.rasterLayers.find(({id:b})=>b===t),p=a&&a.fields,v=p&&p.bands&&p.bands;return v?v[0]:0}getTextureDescriptor(t,a,p){if(!t)return;const v=a.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!v)return;let b=null;a instanceof i.aH?b=a.paint.get("raster-array-band"):a instanceof i.aI&&(b=a.paint.get("raster-particle-array-band"));const E=b||this.getInitialBand(v);if(E!=null)if(t.textureDescriptor){if(!t.updateNeeded(v,E)||p)return Object.assign({},t.textureDescriptor,{texture:t.texture})}else this.prepareTile(t,v,E)}}const Ic={vector:ch,raster:Jo,"raster-dem":class extends Jo{constructor(h,t,a,p){super(h,t,a,p),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(h,t){const a=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(v,b){v&&(h.state="errored",t(v)),b&&(h.dem=b,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",t(null))}h.request=i.o(this.map._requestManager.transformRequest(a,i.R.Tile),(function(v,b,E,k){if(delete h.request,h.aborted)h.state="unloaded",t(null);else if(v)h.state="errored",t(v);else if(b){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:E,expires:k});const O=ImageBitmap&&b instanceof ImageBitmap&&i.t(),N=1-(b.width-i.aF(b.width))/2;N<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const $=O?b:i.q.getImageData(b,N),W={uid:h.uid,coord:h.tileID,source:this.id,scope:this.scope,rawImageData:$,encoding:this.encoding,padding:N};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",W,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(h){const t=h.canonical,a=Math.pow(2,t.z),p=(t.x-1+a)%a,v=t.x===0?h.wrap-1:h.wrap,b=(t.x+1+a)%a,E=t.x+1===a?h.wrap+1:h.wrap,k={};return k[new i.aG(h.overscaledZ,v,t.z,p,t.y).key]={backfilled:!1},k[new i.aG(h.overscaledZ,E,t.z,b,t.y).key]={backfilled:!1},t.y>0&&(k[new i.aG(h.overscaledZ,v,t.z,p,t.y-1).key]={backfilled:!1},k[new i.aG(h.overscaledZ,h.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},k[new i.aG(h.overscaledZ,E,t.z,b,t.y-1).key]={backfilled:!1}),t.y+1<a&&(k[new i.aG(h.overscaledZ,v,t.z,p,t.y+1).key]={backfilled:!1},k[new i.aG(h.overscaledZ,h.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},k[new i.aG(h.overscaledZ,E,t.z,b,t.y+1).key]={backfilled:!1}),k}},"raster-array":ll,geojson:class extends i.E{constructor(h,t,a,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=a.getActor(),this.setEventedParent(p),this._data=t.data,this._options=i.l({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.minzoom!==void 0&&(this.minzoom=t.minzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const v=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*v,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*v,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:i.ag,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*v,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter,dynamic:t.dynamic},t.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}updateData(h){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof h!="string"&&(h.type==="Feature"&&(h={type:"FeatureCollection",features:[h]}),h.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof h!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const t=new Map;for(const a of this._data.features)t.set(a.id,a);for(const a of h.features)t.set(a.id,a);this._data.features=[...t.values()]}else this._data=h;return this._updateWorkerData(!0),this}getClusterExpansionZoom(h,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id,scope:this.scope},t),this}getClusterChildren(h,t){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id,scope:this.scope},t),this}getClusterLeaves(h,t,a,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:h,limit:t,offset:a},p),this}_updateWorkerData(h=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const t=i.l({append:h},this.workerOptions);t.scope=this.scope;const a=this._data;typeof a=="string"?(t.request=this.map._requestManager.transformRequest(i.q.resolveURL(a),i.R.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(a),this._pendingLoad=this.actor.send(`${this.type}.loadData`,t,(p,v)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new i.y(p));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(b.resourceTiming=v.resourceTiming[this.id]),h&&(this._partialReload=!0),this.fire(new i.z("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(h),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,t){const a=h.actor?"reloadTile":"loadTile";h.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,v=p?{image:p.image.clone()}:null,b=this._partialReload,E={type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:v,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:b};h.request=this.actor.send(a,E,(k,O)=>b&&!O?(h.state="loaded",t(null)):(delete h.request,h.destroy(),h.aborted?t(null):k?t(k):(h.loadVectorData(O,this.map.painter,a==="reloadTile"),t(null))),void 0,a==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h,t){this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id,scope:this.scope}),h.destroy()}onRemove(h){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(h,t,a,p){super(h,t,a,p),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const t of h.urls)this.urls.push(this.map._requestManager.transformRequest(t,i.R.Source).url);i.aK(this.urls,(t,a)=>{this._loaded=!0,t?this.fire(new i.y(t)):a&&(this.video=a,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const t=this.video.seekable;h<t.start(0)||h>t.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,t=h.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(h,this.video,t.RGBA8),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(h,t,a,p){super(),this.id=h,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const h=[];for(const t in this._options.models){const a=this._options.models[t],p=i.aM(this.map._requestManager.transformRequest(a.uri,i.R.Model).url).then(v=>{if(!v)return;const b=i.aN(v),E=new i.aO(t,a.position,a.orientation,b);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(v=>{this.fire(new i.y(new Error(`Could not load model ${t} from ${a.uri}: ${v.message}`)))});h.push(p)}return Promise.allSettled(h).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(t=>{this.fire(new i.y(new Error(`Could not load models: ${t.message}`)))})}onAdd(h){this.map=h,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(h,t){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(h,t,a,p){super(),this.type="batched-model",this.id=h,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=a,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(h){this.map=h,this.load()}load(h){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,a=this.map.getWorldview();this._tileJSONRequest=Mc(this._options,this.map._requestManager,t,a,(p,v)=>{this._tileJSONRequest=null,this._loaded=!0,p?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),a&&a.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${a}`),this.fire(new i.y(p))):v&&(i.l(this,v),v.bounds&&(this.tileBounds=new Ko(v.bounds,this.minzoom,this.maxzoom)),Rt(v.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),h&&h(p)})}hasTransition(){return!1}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loaded(){return this._loaded}loadTile(h,t){const a=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(a,i.R.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:h.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(h.actor&&h.state!=="expired")if(h.state==="loading")h.reloadCallback=t;else{if(h.buckets){const b=Object.values(h.buckets);for(const E of b)E.dirty=!0;return void(h.state="loaded")}h.request=h.actor.send("reloadTile",p,v.bind(this))}else h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",p,v.bind(this),void 0,!0);function v(b,E){return h.aborted?t(null):b&&b.status!==404?t(b):(this.map._refreshExpiredTiles&&E&&h.setExpiryData(E),h.loadModelData(E,this.map.painter),h.state="loaded",void t(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(h,t,a,p){super(h,t,a,p),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(b=>typeof b!="number"))||this.fire(new i.y(new i.V(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${h}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${h}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(h){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!h&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(t,this.canvas,t.gl.RGBA8,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends i.E{constructor(h,t,a,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=a,this._implementation=t,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ko(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this.map=h,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:t,y:a,z:p}=h.canonical;return this._implementation.hasTile({x:t,y:a,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,t){const{x:a,y:p,z:v}=h.tileID.canonical,b=new AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:a,y:p,z:v},{signal:b.signal})).then((function(E){return delete h.request,h.aborted?(h.state="unloaded",t(null)):E===void 0?(h.state="errored",t(null)):E===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",t(null)):function(k){return k instanceof ImageData||k instanceof HTMLCanvasElement||k instanceof ImageBitmap||k instanceof HTMLImageElement}(E)?(this.loadTileData(h,E),h.state="loaded",void t(null)):(h.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.code!==20&&(h.state="errored",t(E))}),h.request.cancel=()=>b.abort()}loadTileData(h,t){h.setTexture(t,this.map.painter)}unloadTile(h,t){if(h.texture&&h.texture instanceof i.T?(h.destroy(!0),h.texture&&h.texture instanceof i.T&&this.map.painter.saveTileTexture(h.texture)):h.destroy(),this._implementation.unloadTile){const{x:a,y:p,z:v}=h.tileID.canonical;this._implementation.unloadTile({x:a,y:p,z:v})}t&&t()}abortTile(h,t){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),t&&t()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){const h=i.aC(this.id,this.scope);this.map.style.clearSource(h)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},Pp=function(h,t,a,p){const v=new Ic[t.type](h,t,a,p);if(v.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${v.id}`);return i.aP(["load","abort","unload","serialize","prepare"],v),v};function dd(h,t,a,p,v=!1){const b=t.sourceCache.transform,E=t.sourceCache.tilesIn(h,t.has3DLayers,v);E.sort(Pc);const k=[];for(const O of E){const N=O.tile.queryRenderedFeatures(t,O,a,p,b,v);Object.keys(N).length&&k.push({wrappedTileID:O.tile.tileID.wrapped().key,queryResults:N})}return k.length===0?{}:function(O){const N={},$={};for(const W of O){const Z=W.queryResults,Y=W.wrappedTileID,he=$[Y]=$[Y]||{};for(const ue in Z){const me=Z[ue],ve=he[ue]=he[ue]||{},Se=N[ue]=N[ue]||[];for(const Pe of me)ve[Pe.featureIndex]||(ve[Pe.featureIndex]=!0,Se.push(Pe))}}return N}(k)}function Ac(h,t,a,p,v){const b={},E=p.queryRenderedSymbols(h),k=[];for(const O of Object.keys(E).map(Number))k.push(v[O]);k.sort(Pc);for(const O of k){const N=O.featureIndex.lookupSymbolFeatures(E[O.bucketInstanceId],O.bucketIndex,O.sourceLayerIndex,t,a);for(const $ in N){const W=b[$]=b[$]||[],Z=N[$];Z.sort((Y,he)=>{const ue=O.featureSortOrder;if(ue){const me=ue.indexOf(Y.featureIndex);return ue.indexOf(he.featureIndex)-me}return he.featureIndex-Y.featureIndex});for(const Y of Z)W.push(Y)}}return b}function cl(h,t){const a=h.getRenderableIds().map(b=>h.getTileByID(b)),p=[],v={};for(let b=0;b<a.length;b++){const E=a[b],k=E.tileID.canonical.key;v[k]||(v[k]=!0,E.querySourceFeatures(p,t))}return p}function Pc(h,t){const a=h.tileID,p=t.tileID;return a.overscaledZ-p.overscaledZ||a.canonical.y-p.canonical.y||a.wrap-p.wrap||a.canonical.x-p.canonical.x}function Rp(h,t){const a={};if(!t)return a;for(const p of h){const v=p.layerIds.map(b=>t.getLayer(b)).filter(Boolean);if(v.length!==0){p.layers=v,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(b=>v.filter(E=>E.id===b)[0]));for(const b of v)a[b.fqid]=p}}return a}const Ls=32,zs=33,Ds=new Uint16Array(8184);for(let h=0;h<2046;h++){let t=h+2,a=0,p=0,v=0,b=0,E=0,k=0;for(1&t?v=b=E=Ls:a=p=k=Ls;(t>>=1)>1;){const N=a+v>>1,$=p+b>>1;1&t?(v=a,b=p,a=E,p=k):(a=v,p=b,v=E,b=k),E=N,k=$}const O=4*h;Ds[O+0]=a,Ds[O+1]=p,Ds[O+2]=v,Ds[O+3]=b}const Os=new Uint16Array(2178),Fs=new Uint8Array(1089),uh=new Uint16Array(1089);function Rc(h){return h===0?-.03125:h===32?.03125:0}const ri={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class ul{constructor(t,a,p,v,b){this.tileID=t,this.uid=i.aV(),this.uses=0,this.tileSize=a,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,v&&v.style&&(this._lastUpdatedBrightness=v.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection)}registerFadeDuration(t){const a=t+this.timeAdded;a<i.q.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,a,p){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=Rp(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const b=this.buckets[v];if(b instanceof i.aX){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const b=this.buckets[v];if(b instanceof i.aX&&b.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const v in this.buckets){const b=this.buckets[v],E=a.style.getOwnLayer(v);if(!E)continue;const k=E.queryRadius(b);this.queryPadding=Math.max(this.queryPadding,k)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(t,a,p){t&&(t.resourceTiming&&(this.resourceTiming=t.resourceTiming),this.buckets={...this.buckets,...Rp(t.buckets,a.style)},t.featureIndex&&(this.latestFeatureIndex=t.featureIndex))}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const v in this.buckets){const b=this.buckets[v];b.uploadPending()&&b.upload(t)}const a=t.gl,p=this.imageAtlas;if(p&&!p.uploaded){const v=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new i.T(t,p.image,a.RGBA8,{useMipmap:v}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(t,this.glyphAtlasImage,a.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(t,this.lineAtlas.image,a.R8),this.lineAtlas.uploaded=!0)}prepare(t,a,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,p),!a||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const v=a.style.getBrightness();(this._lastUpdatedBrightness||v)&&(this._lastUpdatedBrightness&&v&&Math.abs(this._lastUpdatedBrightness-v)<.001||(this.updateBuckets(a,this._lastUpdatedBrightness!==v),this._lastUpdatedBrightness=v))}queryRenderedFeatures(t,a,p,v,b,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const k=function(O,N){const $=i.ab.mat4.fromScaling([],[.5*O.width,.5*-O.height,1]);return i.ab.mat4.translate($,$,[1,-1,0]),i.ab.mat4.multiply($,$,O.calculateProjMatrix(N.toUnwrapped())),Float32Array.from($)}(b,this.tileID);return this.latestFeatureIndex.query(t,{tilespaceGeometry:a,pixelPosMatrix:k,transform:v,availableImages:p,tileTransform:this.tileTransform})}querySourceFeatures(t,a){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const v=p.loadVTLayers(),b=a?a.sourceLayer:"",E=v._geojsonTileLayer||v[b];if(!E)return;const k=i.aZ(a&&a.filter),{z:O,x:N,y:$}=this.tileID.canonical,W={z:O,x:N,y:$};for(let Z=0;Z<E.length;Z++){const Y=E.feature(Z);if(k.needGeometry){const me=i.a_(Y,!0);if(!k.filter(new i.a8(this.tileID.overscaledZ),me,this.tileID.canonical))continue}else if(!k.filter(new i.a8(this.tileID.overscaledZ),Y))continue;const he=p.getId(Y,b),ue=new i.a$(Y,O,N,$,he);ue.tile=W,t.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const p=i.b0(t.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const p=Date.now();let v=!1;if(this.expirationTime>p)v=!1;else if(a)if(this.expirationTime<a)v=!0;else{const b=this.expirationTime-a;b?this.expirationTime=p+Math.max(b,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(t){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&t&&this.updateBuckets(t)}updateBuckets(t,a){if(!this.latestFeatureIndex||!t.style)return;const p=this.latestFeatureIndex.loadVTLayers(),v=t.style.listImages(),b=t.style.getBrightness();for(const E in this.buckets){if(!t.style.hasLayer(E))continue;const k=this.buckets[E],O=k.layers[0],N=O.sourceLayer||"_geojsonTileLayer",$=p[N],W=t.style.getLayerSourceCache(O);let Z={};W&&(Z=W._state.getState(N,void 0));const Y=this.imageAtlas&&this.imageAtlas.patternPositions||{},he=Object.keys(Z).length>0&&!a;he&&!k.stateDependentLayers.length&&!a||k.update(Z,$,v,Y,he?k.stateDependentLayers:k.layers,a,b),(k instanceof i.b1||k instanceof i.b2)&&t._terrain&&t._terrain.enabled&&W&&k.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(W.id,this.tileID);const ue=t&&t.style&&t.style.getOwnLayer(E);ue&&(this.queryPadding=Math.max(this.queryPadding,ue.queryRadius(k)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=i.q.now()+t}setTexture(t,a){const p=a.context,v=p.gl;this.texture=this.texture||a.getTileTexture(t.width),this.texture&&this.texture instanceof i.T?this.texture.update(t):(this.texture=new i.T(p,t,v.RGBA8,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(t,a){const p={};for(const v of a)p[v]=!0;this.dependencies[t]=p}hasDependency(t,a){for(const p of t){const v=this.dependencies[p];if(v){for(const b of a)if(v[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,a){if(!a||a.name==="mercator"||this._tileDebugBuffer)return;const p=i.b3(ri,this.tileID.canonical,this.tileTransform)[0],v=new i.b4,b=new i.b5;for(let E=0;E<p.length;E++){const{x:k,y:O}=p[E];v.emplaceBack(k,O),b.emplaceBack(E)}b.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(b),this._tileDebugBuffer=t.createVertexBuffer(v,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,v.length,b.length)}_makeTileBoundsBuffers(t,a){if(this._tileBoundsBuffer||!a||a.name==="mercator")return;const p=i.b3(ri,this.tileID.canonical,this.tileTransform)[0];let v,b;if(this.isRaster){const E=function(k,O){const N=i.aQ(k,O),$=Math.pow(2,k.z);for(let me=0;me<zs;me++)for(let ve=0;ve<zs;ve++){const Se=i.aR((k.x+(ve+Rc(ve))/Ls)/$),Pe=i.aS((k.y+(me+Rc(me))/Ls)/$),Me=O.project(Se,Pe),Fe=me*zs+ve;Os[2*Fe+0]=Math.round((Me.x*N.scale-N.x)*i.ag),Os[2*Fe+1]=Math.round((Me.y*N.scale-N.y)*i.ag)}Fs.fill(0),uh.fill(0);for(let me=2045;me>=0;me--){const ve=4*me,Se=Ds[ve+0],Pe=Ds[ve+1],Me=Ds[ve+2],Fe=Ds[ve+3],De=Se+Me>>1,Oe=Pe+Fe>>1,ze=De+Oe-Pe,Ne=Oe+Se-De,je=Pe*zs+Se,pt=Fe*zs+Me,ot=Oe*zs+De,Ve=Math.hypot((Os[2*je+0]+Os[2*pt+0])/2-Os[2*ot+0],(Os[2*je+1]+Os[2*pt+1])/2-Os[2*ot+1])>=16;Fs[ot]=Fs[ot]||(Ve?1:0),me<1022&&(Fs[ot]=Fs[ot]||Fs[(Pe+Ne>>1)*zs+(Se+ze>>1)]||Fs[(Fe+Ne>>1)*zs+(Me+ze>>1)])}const W=new i.aT,Z=new i.aU;let Y=0;function he(me,ve){const Se=ve*zs+me;return uh[Se]===0&&(W.emplaceBack(Os[2*Se+0],Os[2*Se+1],me*i.ag/Ls,ve*i.ag/Ls),uh[Se]=++Y),uh[Se]-1}function ue(me,ve,Se,Pe,Me,Fe){const De=me+Se>>1,Oe=ve+Pe>>1;if(Math.abs(me-Me)+Math.abs(ve-Fe)>1&&Fs[Oe*zs+De])ue(Me,Fe,me,ve,De,Oe),ue(Se,Pe,Me,Fe,De,Oe);else{const ze=he(me,ve),Ne=he(Se,Pe),je=he(Me,Fe);Z.emplaceBack(ze,Ne,je)}}return ue(0,0,Ls,Ls,Ls,0),ue(Ls,Ls,0,0,0,Ls),{vertices:W,indices:Z}}(this.tileID.canonical,a);v=E.vertices,b=E.indices}else{v=new i.aT,b=new i.aU;for(const{x:k,y:O}of p)v.emplaceBack(k,O,0,0);const E=i.b8(v.int16,void 0,4);for(let k=0;k<E.length;k+=3)b.emplaceBack(E[k],E[k+1],E[k+2])}this._tileBoundsBuffer=t.createVertexBuffer(v,i.b9.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(b),this._tileBoundsSegments=i.b7.simpleSegment(0,0,v.length,b.length)}_makeGlobeTileDebugBuffers(t,a){const p=a.projection;if(!p||p.name!=="globe"||a.freezeTileCoverage)return;const v=this.tileID.canonical,b=i.ba(v,a),E=i.bb(b),k=i.ae(a.zoom);let O;k>0&&(O=i.ab.mat4.invert(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,v,a,E,O,k),this._makeGlobeTileDebugTextBuffer(t,v,a,E,O,k)}_globePoint(t,a,p,v,b,E,k){let O=i.bc(t,a,p);if(E){const N=1<<p.z,$=i.at(v.center.lng),W=i.aA(v.center.lat),Z=(p.x+.5)/N-$;let Y=0;Z>.5?Y=-1:Z<-.5&&(Y=1);let he=(t/i.ag+p.x)/N+Y,ue=(a/i.ag+p.y)/N;he=(he-$)*v._pixelsPerMercatorPixel+$,ue=(ue-W)*v._pixelsPerMercatorPixel+W;const me=[he*v.worldSize,ue*v.worldSize,0];i.ab.vec3.transformMat4(me,me,E),O=i.bd(O,me,k)}return i.ab.vec3.transformMat4(O,O,b)}_makeGlobeTileDebugBorderBuffer(t,a,p,v,b,E){const k=new i.b4,O=new i.b5,N=new i.be,$=(Z,Y,he,ue,me)=>{const ve=(he-Z)/(me-1),Se=(ue-Y)/(me-1),Pe=k.length;for(let Me=0;Me<me;Me++){const Fe=Z+Me*ve,De=Y+Me*Se;k.emplaceBack(Fe,De);const Oe=this._globePoint(Fe,De,a,p,v,b,E);N.emplaceBack(Oe[0],Oe[1],Oe[2]),O.emplaceBack(Pe+Me)}},W=i.ag;$(0,0,W,0,16),$(W,0,W,W,16),$(W,W,0,W,16),$(0,W,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(O),this._tileDebugBuffer=t.createVertexBuffer(k,i.b6.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(N,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,k.length,O.length)}_makeGlobeTileDebugTextBuffer(t,a,p,v,b,E){const k=i.ag/4,O=new i.b4,N=new i.aU,$=new i.be,W=25;N.reserve(32),O.reserve(W),$.reserve(W);const Z=(Y,he)=>W*Y+he;for(let Y=0;Y<W;Y++){const he=Y*k;for(let ue=0;ue<W;ue++){const me=ue*k;O.emplaceBack(me,he);const ve=this._globePoint(me,he,a,p,v,b,E);$.emplaceBack(ve[0],ve[1],ve[2])}}for(let Y=0;Y<4;Y++)for(let he=0;he<4;he++){const ue=Z(Y,he),me=Z(Y,he+1),ve=Z(Y+1,he),Se=Z(Y+1,he+1);N.emplaceBack(ue,me,ve),N.emplaceBack(ve,me,Se)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(N),this._tileDebugTextBuffer=t.createVertexBuffer(O,i.b6.members),this._globeTileDebugTextBuffer=t.createVertexBuffer($,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,W,32)}destroy(t=!1){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class hd extends ul{constructor(t,a,p,v,b){super(t,a,p,v,b),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(t,a){const p=a.context,v=p.gl;this.texture=this.texture||a.getTileTexture(t.width),this.texture&&this.texture instanceof i.T?this.texture.update(t,{premultiply:!1}):this.texture=new i.T(p,t,v.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(t=16384,a){const p=this._mrt=new i.bg(30),v=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(t-1)}});return this.entireBuffer=null,this.request=i.bi(v,(b,E,k,O)=>{if(b)a(b);else try{const N=p.getHeaderLength(E);if(N>t)return void(this.request=this.fetchHeader(N,a));p.parseHeader(E),this._isHeaderLoaded=!0;let $=0;for(const W of Object.values(p.layers))$=Math.max($,W.dataIndex[W.dataIndex.length-1].last_byte);E.byteLength>=$&&(this.entireBuffer=E),a(null,this.entireBuffer||E,k,O)}catch(N){a(N)}}),this.request}fetchBand(t,a,p){const v=this._mrt;if(!this._isHeaderLoaded||!v)return void p(new Error("Tile header is not ready"));const b=this.actor;if(!b)return void p(new Error("Can't fetch tile band without an actor"));let E;const k=(W,Z)=>{E.complete(W,Z),W?p(W):(this.updateTextureDescriptor(t,a),p(null,this.textureDescriptor&&this.textureDescriptor.img))},O=(W,Z)=>{if(W)return p(W);const Y=b.send("decodeRasterArray",{buffer:Z,task:E},k,void 0,!0);this._workQueue.push(()=>{Y&&Y.cancel(),E.cancel()})},N=v.getLayer(t);if(!N)return void p(new Error(`Unknown sourceLayer "${t}"`));if(N.hasDataForBand(a))return this.updateTextureDescriptor(t,a),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const $=N.getDataRange([a]);if(E=v.createDecodingTask($),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)O(null,this.entireBuffer.slice($.firstByte,$.lastByte+1));else{const W=Object.assign({},this.requestParams,{headers:{Range:`bytes=${$.firstByte}-${$.lastByte}`}}),Z=i.bi(W,O);this._fetchQueue.push(()=>{Z.cancel(),E.cancel()})}else p(null)}updateNeeded(t,a){return(!this.textureDescriptor||this.textureDescriptor.band!==a||this.textureDescriptor.layer!==t)&&this.state!=="errored"}updateTextureDescriptor(t,a){if(!this._mrt)return;const p=this._mrt.getLayer(t);if(!p||!p.hasBand(a)||!p.hasDataForBand(a))return;const{bytes:v,tileSize:b,buffer:E,offset:k,scale:O}=p.getBandView(a),N=b+2*E,$={data:v,width:N,height:N},W=this.texture;W&&W instanceof i.T&&W.update($,{premultiply:!1}),this.textureDescriptor={layer:t,band:a,img:$,buffer:E,offset:k,tileSize:b,format:p.pixelFormat,mix:[O,256*O,65536*O,16777216*O]}}}class pd{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,p){const v=t.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const b={value:a,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(t,b)},p)),this.data[v].push(b),this.order.push(v),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const p=t.wrapped().key,v=a===void 0?0:this.data[p].indexOf(a),b=this.data[p][v];return this.data[p].splice(v,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const p in this.data)for(const v of this.data[p])t(v.value)||a.push(v);for(const p of a)this.remove(p.value.tileID,p)}}class kc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,p){const v=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][v]=this.stateChanges[t][v]||{},i.l(this.stateChanges[t][v],p),this.deletedStates[t]===null){this.deletedStates[t]={};for(const b in this.state[t])b!==v&&(this.deletedStates[t][b]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][v]===null){this.deletedStates[t][v]={};for(const b in this.state[t][v])p[b]||(this.deletedStates[t][v][b]=null)}else for(const b in p)this.deletedStates[t]&&this.deletedStates[t][v]&&this.deletedStates[t][v][b]===null&&delete this.deletedStates[t][v][b]}removeFeatureState(t,a,p){if(this.deletedStates[t]===null)return;const v=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},p&&a!==void 0)this.deletedStates[t][v]!==null&&(this.deletedStates[t][v]=this.deletedStates[t][v]||{},this.deletedStates[t][v][p]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][v])for(p in this.deletedStates[t][v]={},this.stateChanges[t][v])this.deletedStates[t][v][p]=null;else this.deletedStates[t][v]=null;else this.deletedStates[t]=null}getState(t,a){const p=this.state[t]||{},v=this.stateChanges[t]||{},b=this.deletedStates[t];if(b===null)return{};if(a!==void 0){const k=String(a),O=i.l({},p[k],v[k]);if(b){const N=b[a];if(N===null)return{};for(const $ in N)delete O[$]}return O}const E=i.l({},p,v);if(b)for(const k in b)delete E[k];return E}initializeTileState(t,a){t.refreshFeatureState(a)}coalesceChanges(t,a){const p={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const b={};for(const E in this.stateChanges[v])this.state[v][E]||(this.state[v][E]={}),i.l(this.state[v][E],this.stateChanges[v][E]),b[E]=this.state[v][E];p[v]=b}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const b={};if(this.deletedStates[v]===null)for(const E in this.state[v])b[E]={},this.state[v][E]={};else for(const E in this.deletedStates[v]){if(this.deletedStates[v][E]===null)this.state[v][E]={};else if(this.state[v][E])for(const k of Object.keys(this.deletedStates[v][E]))delete this.state[v][E][k];b[E]=this.state[v][E]}p[v]=p[v]||{},i.l(p[v],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const v in t)t[v].refreshFeatureState(a)}}class Bs extends i.E{constructor(t,a,p){super(),this.id=t,this._onlySymbols=p,a.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new pd(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new kc,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,a){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,a)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t)}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t)}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const p=this._tiles[a];p.upload(t),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(t=>t.tileID).sort(fd).map(t=>t.key)}getRenderableIds(t,a){const p=[];for(const v in this._tiles)this._isIdRenderable(+v,t,a)&&p.push(this._tiles[v]);return t?p.sort((v,b)=>{const E=v.tileID,k=b.tileID,O=new i.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),N=new i.P(k.canonical.x,k.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-k.overscaledZ||N.y-O.y||N.x-O.x}).map(v=>v.tileID.key):p.map(v=>v.tileID).sort(fd).map(v=>v.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a,p){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())&&(p||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,a){const p=this._tiles[t];p&&(p.state!=="loading"&&(p.state=a),this._loadTile(p,this._tileLoaded.bind(this,p,t,a)))}_tileLoaded(t,a,p,v){if(v)if(t.state="errored",v.status!==404)this._source.fire(new i.y(v,{tile:t}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:t})),!(t.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=i.q.now(),p==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const a=this.getRenderableIds();for(let v=0;v<a.length;v++){const b=a[v];if(t.neighboringTiles&&t.neighboringTiles[b]){const E=this.getTileByID(b);p(t,E),p(E,t)}}function p(v,b){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let E=b.tileID.canonical.x-v.tileID.canonical.x;const k=b.tileID.canonical.y-v.tileID.canonical.y,O=Math.pow(2,v.tileID.canonical.z),N=b.tileID.key;E===0&&k===0||Math.abs(k)>1||(Math.abs(E)>1&&(Math.abs(E+O)===1?E+=O:Math.abs(E-O)===1&&(E-=O)),b.dem&&v.dem&&(v.dem.backfillBorder(b.dem,E,k),v.neighboringTiles&&v.neighboringTiles[N]&&(v.neighboringTiles[N].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,p,v){for(const b in this._tiles){let E=this._tiles[b];if(v[b]||!E.hasData()||E.tileID.overscaledZ<=a||E.tileID.overscaledZ>p)continue;let k=E.tileID;for(;E&&E.tileID.overscaledZ>a+1;){const N=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[N.key],E&&E.hasData()&&(k=N)}let O=k;for(;O.overscaledZ>a;)if(O=O.scaledTo(O.overscaledZ-1),t[O.key]){v[k.key]=k;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const p=this._loadedParentTiles[t.key];return p&&p.tileID.overscaledZ>=a?p:null}for(let p=t.overscaledZ-1;p>=a;p--){const v=t.scaledTo(p),b=this._getLoadedTile(v);if(b)return b}}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,a){a=a||this._source.tileSize;const p=Math.ceil(t.width/a)+1,v=Math.ceil(t.height/a)+1,b=Math.floor(p*v*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,k=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(k)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const p={};for(const v in this._tiles){const b=this._tiles[v];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+a),p[b.tileID.key]=b}this._tiles=p;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(t,a,p,v){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(t,a),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const b=this._source.type==="batched-model";let E,k=this._source.maxzoom;const O=this.map&&this.map.painter?this.map.painter._terrain:null;if(O&&O.sourceCache===this&&O.attenuationRange()){const W=O.attenuationRange()[0],Z=Math.floor(W)-Math.log2(O.getDemUpscale());k>Z&&(k=Z)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new i.aG(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y));else if(this.tileCoverLift!==0){const W=t.clone();W.tileCoverLift=this.tileCoverLift,E=W.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:k,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.minzoom<=1&&t.projection.name==="globe"&&(E.push(new i.aG(1,0,1,0,0)),E.push(new i.aG(1,0,1,1,0)),E.push(new i.aG(1,0,1,0,1)),E.push(new i.aG(1,0,1,1,1)))}else if(E=t.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:k,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.hasTile){const W=this._source.hasTile.bind(this._source);E=E.filter(Z=>W(Z))}}else E=[];if(E.length>0&&this.castsShadows&&v&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!wu(this._source.type)){const W=t.coveringZoomLevel({tileSize:a||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),Z=Math.min(W,this._source.maxzoom);if(b){const Y=t.extendTileCover(E,Z);for(const he of Y)E.push(he)}else{const Y=t.extendTileCover(E,Z,v);for(const he of Y)this._shadowCasterTiles[he.key]=!0,E.push(he)}}const N=this._updateRetainedTiles(E);if(wu(this._source.type)&&E.length!==0){const W={},Z={},Y=Object.keys(N);for(const ue of Y){const me=N[ue],ve=this._tiles[ue];if(!ve||ve.fadeEndTime&&ve.fadeEndTime<=i.q.now())continue;const Se=this.findLoadedParent(me,Math.max(me.overscaledZ-Bs.maxOverzooming,this._source.minzoom));Se&&(this._addTile(Se.tileID),W[Se.tileID.key]=Se.tileID),Z[ue]=me}const he=E[E.length-1].overscaledZ;for(const ue in this._tiles){const me=this._tiles[ue];if(N[ue]||!me.hasData())continue;let ve=me.tileID;for(;ve.overscaledZ>he;){ve=ve.scaledTo(ve.overscaledZ-1);const Se=this._tiles[ve.key];if(Se&&Se.hasData()&&Z[ve.key]){N[ue]=me.tileID;break}}}for(const ue in W)N[ue]||(this._coveredTiles[ue]=!0,N[ue]=W[ue])}for(const W in N)this._tiles[W].clearFadeHold();const $=i.bk(this._tiles,N);for(const W of $){const Z=this._tiles[W];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const a={};if(t.length===0)return a;const p={},v=t.reduce((N,$)=>Math.min(N,$.overscaledZ),1/0),b=t[0].overscaledZ,E=Math.max(b-Bs.maxOverzooming,this._source.minzoom),k=Math.max(b+Bs.maxUnderzooming,this._source.minzoom),O={};for(const N of t){const $=this._addTile(N);a[N.key]=N,$.hasData()||v<this._source.maxzoom&&(O[N.key]=N)}this._retainLoadedChildren(O,v,k,a);for(const N of t){let $=this._tiles[N.key];if($.hasData())continue;if(N.canonical.z>=this._source.maxzoom){const Z=N.children(this._source.maxzoom)[0],Y=this.getTile(Z);if(Y&&Y.hasData()){a[Z.key]=Z;continue}}else{const Z=N.children(this._source.maxzoom);if(a[Z[0].key]&&a[Z[1].key]&&a[Z[2].key]&&a[Z[3].key])continue}let W=$.wasRequested();for(let Z=N.overscaledZ-1;Z>=E;--Z){const Y=N.scaledTo(Z);if(p[Y.key]||(p[Y.key]=!0,$=this.getTile(Y),!$&&W&&($=this._addTile(Y)),$&&(a[Y.key]=Y,W=$.wasRequested(),$.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let p,v=this._tiles[t].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){p=this._loadedParentTiles[v.key];break}a.push(v.key);const b=v.scaledTo(v.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;v=b}for(const b of a)this._loadedParentTiles[b]=p}}_addTile(t){let a=this._tiles[t.key];if(a)return a.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const p=!!a;if(!p){const v=this.map?this.map.painter:null,b=this._source.tileSize*t.overscaleFactor();a=this._source.type==="raster-array"?new hd(t,b,this.transform.tileZoom,v,this._isRaster):new ul(t,b,this.transform.tileZoom,v,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,t.key,a.state))}return a?(a.uses++,this._tiles[t.key]=a,p||this._source.fire(new i.z("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const p=a.getExpiryTimeout();p&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},p))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"||a.state==="empty"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,a,p){const v=[],b=this.transform;if(!b)return v;const E=b.projection.name==="globe",k=i.at(b.center.lng);for(const O in this._tiles){const N=this._tiles[O];if(p&&N.clearQueryDebugViz(),N.holdingForFade())continue;let $;if(E){const W=N.tileID.canonical;if(W.z===0){const Z=[Math.abs(i.aw(k,...kr(W,-1))-k),Math.abs(i.aw(k,...kr(W,1))-k)];$=[0,2*Z.indexOf(Math.min(...Z))-1]}else{const Z=[Math.abs(i.aw(k,...kr(W,-1))-k),Math.abs(i.aw(k,...kr(W,0))-k),Math.abs(i.aw(k,...kr(W,1))-k)];$=[Z.indexOf(Math.min(...Z))-1]}}else $=[0];for(const W of $){const Z=t.containsTile(N,b,a,W);Z&&v.push(Z)}}return v}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,a){const p=this.getRenderableIds(t,a).map(b=>this._tiles[b].tileID),v=this.transform.projection.name==="globe";for(const b of p)b.projMatrix=this.transform.calculateProjMatrix(b.toUnwrapped()),b.expandedProjMatrix=v?this.transform.calculateProjMatrix(b.toUnwrapped(),!1,!0):b.projMatrix;return p}sortCoordinatesByDistance(t){const a=t.slice(),p=this.transform._camera.position,v=this.transform._camera.forward(),b={};for(const E of a){const k=1/(1<<E.canonical.z);b[E.key]=((E.canonical.x+.5)*k+E.wrap-p[0])*v[0]+((E.canonical.y+.5)*k-p[1])*v[1]-p[2]*v[2]}return a.sort((E,k)=>b[E.key]-b[k.key]),a}hasTransition(){if(this._source.hasTransition())return!0;if(wu(this._source.type))for(const t in this._tiles){const a=this._tiles[t];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(t,a,p){this._state.updateState(t=t||"_geojsonTileLayer",a,p)}removeFeatureState(t,a,p){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,p)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,p){const v=this._tiles[t];v&&v.setDependencies(a,p)}reloadTilesForDependencies(t,a){for(const p in this._tiles)this._tiles[p].hasDependency(t,a)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(t,a))}_preloadTiles(t,a){if(!this._sourceLoaded){const O=()=>{this._sourceLoaded&&(this._source.off("data",O),this._preloadTiles(t,a))};return void this._source.on("data",O)}const p=new Map,v=Array.isArray(t)?t:[t],b=this.map.painter.terrain,E=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const O of v){const N=O.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const $ of N)p.set($.key,$);this.usedForTerrain&&O.updateElevation(!1)}const k=Array.from(p.values());i.bl(k,(O,N)=>{const $=new ul(O,this._source.tileSize*O.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile($,W=>{this._source.type==="raster-dem"&&$.dem&&this._backfillDEM($),N(W,$)})},a)}}function fd(h,t){const a=Math.abs(2*h.wrap)-+(h.wrap<0),p=Math.abs(2*t.wrap)-+(t.wrap<0);return h.overscaledZ-t.overscaledZ||p-a||t.canonical.y-h.canonical.y||t.canonical.x-h.canonical.x}function wu(h){return h==="raster"||h==="image"||h==="video"||h==="custom"}function kr(h,t){const a=1<<h.z;return[h.x/a+t,(h.x+1)/a+t]}Bs.maxOverzooming=10,Bs.maxUnderzooming=3;class Ul{constructor(t){this.style=t,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const t=!1,a=!1;for(const p in this.style._mergedLayers){const v=this.style._mergedLayers[p];if(v.type==="fill-extrusion")this.layers.push({layer:v,visible:t,visibilityChanged:a});else if(v.type==="model"){const b=this.style.getLayerSource(v);b&&b.type==="batched-model"&&this.layers.push({layer:v,visible:t,visibilityChanged:a})}}}onNewFrame(t){this.layersGotHidden=!1;for(const a of this.layers){const p=a.layer;let v=!1;p.type==="fill-extrusion"?v=!p.isHidden(t)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(v=!p.isHidden(t)&&p.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!v&&a.visible,a.visible=v}}updateZOffset(t,a){this.currentBuildingBuckets=[];for(const v of this.layers){const b=v.layer,E=this.style.getLayerSourceCache(b);let k=1;b.type==="fill-extrusion"&&(k=v.visible?b.paint.get("fill-extrusion-vertical-scale"):0);let O=E?E.getTile(a):null;if(!O&&E&&a.canonical.z>E.getSource().minzoom){let N=a.scaledTo(Math.min(E.getSource().maxzoom,a.overscaledZ-1));for(;N.overscaledZ>=E.getSource().minzoom&&(O=E.getTile(N),!O&&N.overscaledZ!==0);)N=N.scaledTo(N.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:O?O.getBucket(b):null,tileID:O?O.tileID:a,verticalScale:k})}t.hasAnyZOffset=!1;let p=!1;for(let v=0;v<t.symbolInstances.length;v++){const b=t.symbolInstances.get(v),E=b.zOffset,k=this._getHeightAtTileOffset(a,b.tileAnchorX,b.tileAnchorY);b.zOffset=k!==Number.NEGATIVE_INFINITY?k:E,p||E===b.zOffset||(p=!0),t.hasAnyZOffset||b.zOffset===0||(t.hasAnyZOffset=!0)}p&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,a,p,v){let b=a,E=p;if(t.canonical.z!==v.canonical.z){const k=v.canonical,O=1/(1<<t.canonical.z-k.z);b=(a+t.canonical.x*i.ag)*O-k.x*i.ag|0,E=(p+t.canonical.y*i.ag)*O-k.y*i.ag|0}return{tileX:b,tileY:E}}_getHeightAtTileOffset(t,a,p){let v,b;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;const{bucket:k,tileID:O,verticalScale:N}=this.currentBuildingBuckets[E];if(!k)continue;const{tileX:$,tileY:W}=this._mapCoordToOverlappingTile(t,a,p,O),Z=k.getHeightAtTileCoord($,W);Z&&Z.height!==void 0&&(Z.hidden?v=Z.height:b=Math.max(Z.height*N,b||0))}if(b!==void 0)return b;for(let E=0;E<this.layers.length;++E){const k=this.layers[E];if(k.layer.type!=="model"||!k.visible)continue;const{bucket:O,tileID:N}=this.currentBuildingBuckets[E];if(!O)continue;const{tileX:$,tileY:W}=this._mapCoordToOverlappingTile(t,a,p,N),Z=O.getHeightAtTileCoord($,W);if(Z&&!Z.hidden)return Z.height===void 0&&v!==void 0?Math.min(Z.maxHeight,v)*Z.verticalScale:Z.height?Z.height*Z.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Fn(h,t){const a={};for(const p in h)p!=="ref"&&(a[p]=h[p]);return i.bm.forEach(p=>{p in t&&(a[p]=t[p])}),a}function Ra(h){h=h.slice();const t=Object.create(null);for(let a=0;a<h.length;a++)t[h[a].id]=h[a];for(let a=0;a<h.length;a++)"ref"in h[a]&&(h[a]=Fn(h[a],t[h[a].ref]));return h}const Cr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function $l(h,t,a){a.push({command:Cr.addSource,args:[h,t[h]]})}function bo(h,t,a){t.push({command:Cr.removeSource,args:[h]}),a[h]=!0}function kp(h,t,a,p){bo(h,a,p),$l(h,t,a)}function Lc(h,t,a){let p;for(p in h[a])if(h[a].hasOwnProperty(p)&&p!=="data"&&!i.bn(h[a][p],t[a][p]))return!1;for(p in t[a])if(t[a].hasOwnProperty(p)&&p!=="data"&&!i.bn(h[a][p],t[a][p]))return!1;return!0}function fn(h,t,a,p,v,b){let E;for(E in t=t||{},h=h||{})h.hasOwnProperty(E)&&(i.bn(h[E],t[E])||a.push({command:b,args:[p,E,t[E],v]}));for(E in t)t.hasOwnProperty(E)&&!h.hasOwnProperty(E)&&(i.bn(h[E],t[E])||a.push({command:b,args:[p,E,t[E],v]}))}function Ur(h){return h.id}function zr(h,t){return h[t.id]=t,h}class Uo{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=i.aw(t,0,1);let a=1,p=this._distances[a];const v=t*this.paddedLength+this.padding;for(;p<v&&a<this._distances.length;)p=this._distances[++a];const b=a-1,E=this._distances[b],k=p-E,O=k>0?(v-E)/k:0;return this.points[b].mult(1-O).add(this.points[a].mult(O))}}class Vl{constructor(t,a,p){const v=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(t/p),this.yCellCount=Math.ceil(a/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)v.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,p,v,b){this._forEachCell(a,p,v,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(b)}insertCircle(t,a,p,v){this._forEachCell(a-v,p-v,a+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(p),this.circles.push(v)}_insertBoxCell(t,a,p,v,b,E){this.boxCells[b].push(E)}_insertCircleCell(t,a,p,v,b,E){this.circleCells[b].push(E)}_query(t,a,p,v,b,E){if(p<0||t>this.width||v<0||a>this.height)return!b&&[];const k=[];if(t<=0&&a<=0&&this.width<=p&&this.height<=v){if(b)return!0;for(let O=0;O<this.boxKeys.length;O++)k.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const N=this.circles[3*O],$=this.circles[3*O+1],W=this.circles[3*O+2];k.push({key:this.circleKeys[O],x1:N-W,y1:$-W,x2:N+W,y2:$+W})}return E?k.filter(E):k}return this._forEachCell(t,a,p,v,this._queryCell,k,{hitTest:b,seenUids:{box:{},circle:{}}},E),b?k.length>0:k}_queryCircle(t,a,p,v,b){const E=t-p,k=t+p,O=a-p,N=a+p;if(k<0||E>this.width||N<0||O>this.height)return!v&&[];const $=[];return this._forEachCell(E,O,k,N,this._queryCellCircle,$,{hitTest:v,circle:{x:t,y:a,radius:p},seenUids:{box:{},circle:{}}},b),v?$.length>0:$}query(t,a,p,v,b){return this._query(t,a,p,v,!1,b)}hitTest(t,a,p,v,b){return this._query(t,a,p,v,!0,b)}hitTestCircle(t,a,p,v){return this._queryCircle(t,a,p,!0,v)}_queryCell(t,a,p,v,b,E,k,O){const N=k.seenUids,$=this.boxCells[b];if($!==null){const Z=this.bboxes;for(const Y of $)if(!N.box[Y]){N.box[Y]=!0;const he=4*Y;if(t<=Z[he+2]&&a<=Z[he+3]&&p>=Z[he+0]&&v>=Z[he+1]&&(!O||O(this.boxKeys[Y]))){if(k.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[Y],x1:Z[he],y1:Z[he+1],x2:Z[he+2],y2:Z[he+3]})}}}const W=this.circleCells[b];if(W!==null){const Z=this.circles;for(const Y of W)if(!N.circle[Y]){N.circle[Y]=!0;const he=3*Y;if(this._circleAndRectCollide(Z[he],Z[he+1],Z[he+2],t,a,p,v)&&(!O||O(this.circleKeys[Y]))){if(k.hitTest)return E.push(!0),!0;{const ue=Z[he],me=Z[he+1],ve=Z[he+2];E.push({key:this.circleKeys[Y],x1:ue-ve,y1:me-ve,x2:ue+ve,y2:me+ve})}}}}}_queryCellCircle(t,a,p,v,b,E,k,O){const N=k.circle,$=k.seenUids,W=this.boxCells[b];if(W!==null){const Y=this.bboxes;for(const he of W)if(!$.box[he]){$.box[he]=!0;const ue=4*he;if(this._circleAndRectCollide(N.x,N.y,N.radius,Y[ue+0],Y[ue+1],Y[ue+2],Y[ue+3])&&(!O||O(this.boxKeys[he])))return E.push(!0),!0}}const Z=this.circleCells[b];if(Z!==null){const Y=this.circles;for(const he of Z)if(!$.circle[he]){$.circle[he]=!0;const ue=3*he;if(this._circlesCollide(Y[ue],Y[ue+1],Y[ue+2],N.x,N.y,N.radius)&&(!O||O(this.circleKeys[he])))return E.push(!0),!0}}}_forEachCell(t,a,p,v,b,E,k,O){const N=this._convertToXCellCoord(t),$=this._convertToYCellCoord(a),W=this._convertToXCellCoord(p),Z=this._convertToYCellCoord(v);for(let Y=N;Y<=W;Y++)for(let he=$;he<=Z;he++)if(b.call(this,t,a,p,v,this.xCellCount*he+Y,E,k,O))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,p,v,b,E){const k=v-t,O=b-a,N=p+E;return N*N>k*k+O*O}_circleAndRectCollide(t,a,p,v,b,E,k){const O=(E-v)/2,N=Math.abs(t-(v+O));if(N>O+p)return!1;const $=(k-b)/2,W=Math.abs(a-(b+$));if(W>$+p)return!1;if(N<=O||W<=$)return!0;const Z=N-O,Y=W-$;return Z*Z+Y*Y<=p*p}}const Pr={unknown:0,flipRequired:1,flipNotRequired:2},Gl=Math.tan(85*Math.PI/180);function Ns(h,t,a,p,v,b,E){const k=i.ab.mat4.create();if(a)if(b.name==="globe"){const O=i.bo(v,t);i.ab.mat4.multiply(k,k,O)}else{const O=i.ab.mat2.invert([],E);k[0]=O[0],k[1]=O[1],k[4]=O[2],k[5]=O[3],p||i.ab.mat4.rotateZ(k,k,v.angle)}else i.ab.mat4.multiply(k,v.labelPlaneMatrix,h);return k}function oa(h,t,a,p,v,b,E){const k=Ns(h,t,a,p,v,b,E);return b.name==="globe"&&a||(k[2]=k[6]=k[10]=k[14]=0),k}function _o(h,t,a,p,v,b,E){if(a){if(b.name==="globe"){const k=Ns(h,t,a,p,v,b,E);return i.ab.mat4.invert(k,k),i.ab.mat4.multiply(k,h,k),k}{const k=i.ab.mat4.clone(h),O=i.ab.mat4.identity([]);return O[0]=E[0],O[1]=E[1],O[4]=E[2],O[5]=E[3],i.ab.mat4.multiply(k,k,O),p||i.ab.mat4.rotateZ(k,k,-v.angle),k}}return v.glCoordMatrix}function ui(h,t,a,p){const v=[h,t,a,1];a?i.ab.vec4.transformMat4(v,v,p):La(v,v,p);const b=v[3];return v[0]/=b,v[1]/=b,v[2]/=b,v}function Wf(h,t){return Math.min(.5+h/t*.5,1.5)}function zc(h,t){const a=h[0]/h[3],p=h[1]/h[3];return a>=-t[0]&&a<=t[0]&&p>=-t[1]&&p<=t[1]}function Dc(h,t,a,p,v,b,E,k,O,N){const $=a.transform,W=p?h.textSizeData:h.iconSizeData,Z=i.bp(W,a.transform.zoom),Y=$.projection.name==="globe",he=[256/a.width*2+1,256/a.height*2+1],ue=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;ue.clear();let me=null;Y&&(me=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const ve=h.lineVertexArray,Se=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,Pe=a.transform.width/a.transform.height;let Me,Fe=!1;for(let De=0;De<Se.length;De++){const Oe=Se.get(De),{numGlyphs:ze,writingMode:Ne}=Oe;if(Ne!==i.bq.vertical||Fe||Me===i.bq.horizontal||(Fe=!0),Me=Ne,(Oe.hidden||Ne===i.bq.vertical)&&!Fe){ka(ze,ue);continue}Fe=!1;const je=new i.P(Oe.tileAnchorX,Oe.tileAnchorY);let{x:pt,y:ot,z:Ve}=$.projection.projectTilePoint(je.x,je.y,N.canonical);if(O){const[Ct,on,Zt]=O(je);pt+=Ct,ot+=on,Ve+=Zt}const Je=[pt,ot,Ve,1];if(i.ab.vec4.transformMat4(Je,Je,t),!zc(Je,he)){ka(ze,ue);continue}const It=Je[3],kt=Wf(a.transform.getCameraToCenterDistance($.projection),It),Ht=i.br(W,Z,Oe),ut=E?Ht/kt:Ht*kt,Lt=ui(pt,ot,Ve,v);if(Lt[3]<=0){ka(ze,ue);continue}let xt={};const Gt=E?null:O,At=sa(Oe,ut,!1,k,t,v,b,h.glyphOffsetArray,ve,ue,me,Lt,je,xt,Pe,Gt,$.projection,N,E);Fe=At.useVertical,Gt&&At.needsFlipping&&(xt={}),(At.notEnoughRoom||Fe||At.needsFlipping&&sa(Oe,ut,!0,k,t,v,b,h.glyphOffsetArray,ve,ue,me,Lt,je,xt,Pe,Gt,$.projection,N,E).notEnoughRoom)&&ka(ze,ue)}p?(h.text.dynamicLayoutVertexBuffer.updateData(ue),me&&h.text.globeExtVertexBuffer&&h.text.globeExtVertexBuffer.updateData(me)):(h.icon.dynamicLayoutVertexBuffer.updateData(ue),me&&h.icon.globeExtVertexBuffer&&h.icon.globeExtVertexBuffer.updateData(me))}function ql(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue){const{lineStartIndex:me,glyphStartIndex:ve,segment:Se}=k,Pe=ve+k.numGlyphs,Me=me+k.lineLength,Fe=t.getoffsetX(ve),De=t.getoffsetX(Pe-1),Oe=lo(h*Fe,a,p,v,b,E,Se,me,Me,O,N,$,W,Z,!0,Y,he,ue);if(!Oe)return null;const ze=lo(h*De,a,p,v,b,E,Se,me,Me,O,N,$,W,Z,!0,Y,he,ue);return ze?{first:Oe,last:ze}:null}function md(h,t,a,p){return h===i.bq.horizontal&&Math.abs(p)>Math.abs(a)?{useVertical:!0}:h===i.bq.vertical?p>0?{needsFlipping:!0}:null:t!==Pr.unknown&&function(v,b){return v===0||Math.abs(b/v)>Gl}(a,p)?t===Pr.flipRequired?{needsFlipping:!0}:null:a<0?{needsFlipping:!0}:null}function sa(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve,Se){const Pe=t/24,Me=h.lineOffsetX*Pe,Fe=h.lineOffsetY*Pe,{lineStartIndex:De,glyphStartIndex:Oe,numGlyphs:ze,segment:Ne,writingMode:je,flipState:pt}=h,ot=De+h.lineLength,Ve=Je=>{if($){const[ut,Lt,xt]=Je.up,Gt=N.length;i.bs($,Gt+0,ut,Lt,xt),i.bs($,Gt+1,ut,Lt,xt),i.bs($,Gt+2,ut,Lt,xt),i.bs($,Gt+3,ut,Lt,xt)}const[It,kt,Ht]=Je.point;i.bt(N,It,kt,Ht,Je.angle)};if(ze>1){const Je=ql(Pe,k,Me,Fe,a,W,Z,h,O,b,Y,ue,!1,me,ve,Se);if(!Je)return{notEnoughRoom:!0};if(p&&!a){let[It,kt,Ht]=Je.first.point,[ut,Lt,xt]=Je.last.point;[It,kt]=ui(It,kt,Ht,E),[ut,Lt]=ui(ut,Lt,xt,E);const Gt=md(je,pt,(ut-It)*he,Lt-kt);if(h.flipState=Gt&&Gt.needsFlipping?Pr.flipRequired:Pr.flipNotRequired,Gt)return Gt}Ve(Je.first);for(let It=Oe+1;It<Oe+ze-1;It++){const kt=lo(Pe*k.getoffsetX(It),Me,Fe,a,W,Z,Ne,De,ot,O,b,Y,ue,!1,!1,me,ve,Se);if(!kt)return N.length-=4*(It-Oe),{notEnoughRoom:!0};Ve(kt)}Ve(Je.last)}else{if(p&&!a){const It=ui(Z.x,Z.y,0,v),kt=De+Ne+1,Ht=new i.P(O.getx(kt),O.gety(kt)),ut=ui(Ht.x,Ht.y,0,v),Lt=ut[3]>0?ut:js(Z,Ht,It,1,v,void 0,me,ve.canonical),xt=md(je,pt,(Lt[0]-It[0])*he,Lt[1]-It[1]);if(h.flipState=xt&&xt.needsFlipping?Pr.flipRequired:Pr.flipNotRequired,xt)return xt}const Je=lo(Pe*k.getoffsetX(Oe),Me,Fe,a,W,Z,Ne,De,ot,O,b,Y,ue,!1,!1,me,ve,Se);if(!Je)return{notEnoughRoom:!0};Ve(Je)}return{}}function wo(h,t,a,p,v){const{x:b,y:E,z:k}=p.projectTilePoint(h.x,h.y,t);if(!v)return ui(b,E,k,a);const[O,N,$]=v(h);return ui(b+O,E+N,k+$,a)}function js(h,t,a,p,v,b,E,k){const O=wo(h.sub(t)._unit()._add(h),k,v,E,b);return i.ab.vec3.sub(O,a,O),i.ab.vec3.normalize(O,O),i.ab.vec3.scaleAndAdd(O,a,O,p)}function lo(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve){const Se=p?h-t:h+t;let Pe=Se>0?1:-1,Me=0;p&&(Pe*=-1,Me=Math.PI),Pe<0&&(Me+=Math.PI);let Fe=k+E+(Pe>0?0:1)|0,De=v,Oe=v,ze=0,Ne=0;const je=Math.abs(Se),pt=[],ot=[];let Ve=b,Je=Ve;const It=()=>js(Je,Ve,Oe,je-ze+1,$,Z,ue,me.canonical);for(;ze+Ne<=je;){if(Fe+=Pe,Fe<k||Fe>=O)return null;if(Oe=De,Je=Ve,pt.push(Oe),Y&&ot.push(Je),Ve=new i.P(N.getx(Fe),N.gety(Fe)),De=W[Fe],!De){const on=wo(Ve,me.canonical,$,ue,Z);De=on[3]>0?W[Fe]=on:It()}ze+=Ne,Ne=i.ab.vec3.distance(Oe,De)}he&&Z&&(W[Fe]&&(De=It(),Ne=i.ab.vec3.distance(Oe,De)),W[Fe]=De);const kt=(je-ze)/Ne,Ht=Ve.sub(Je)._mult(kt)._add(Je),ut=i.ab.vec3.sub([],De,Oe),Lt=i.ab.vec3.scaleAndAdd([],Oe,ut,kt);let xt=[0,0,1],Gt=ut[0],At=ut[1];if(ve&&(xt=ue.upVector(me.canonical,Ht.x,Ht.y),xt[0]!==0||xt[1]!==0||xt[2]!==1)){const on=[xt[2],0,-xt[0]],Zt=i.ab.vec3.cross([],xt,on);i.ab.vec3.normalize(on,on),i.ab.vec3.normalize(Zt,Zt),Gt=i.ab.vec3.dot(ut,on),At=i.ab.vec3.dot(ut,Zt)}if(a){const on=i.ab.vec3.cross([],xt,ut);i.ab.vec3.normalize(on,on),i.ab.vec3.scaleAndAdd(Lt,Lt,on,a*Pe)}const Ct=Me+Math.atan2(At,Gt);return pt.push(Lt),Y&&ot.push(Ht),{point:Lt,angle:Ct,path:pt,tilePath:ot,up:xt}}function ka(h,t){const a=t.length,p=a+4*h;t.resize(p),t.float32.fill(-1/0,4*a,4*p)}function La(h,t,a){const p=t[0],v=t[1];return h[0]=a[0]*p+a[4]*v+a[12],h[1]=a[1]*p+a[5]*v+a[13],h[3]=a[3]*p+a[7]*v+a[15],h}const gi=100;class Xi{constructor(t,a,p=new Vl(t.width+200,t.height+200,25),v=new Vl(t.width+200,t.height+200,25)){this.transform=t,this.grid=p,this.ignoredGrid=v,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+gi,this.screenBottomBoundary=t.height+gi,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=a}placeCollisionBox(t,a,p,v,b,E,k,O){let N=p.projectedAnchorX,$=p.projectedAnchorY,W=p.projectedAnchorZ;const Z=p.elevation,Y=p.tileID,he=t.getProjection();if(Z&&Y){const[De,Oe,ze]=he.upVector(Y.canonical,p.tileAnchorX,p.tileAnchorY),Ne=he.upVectorScale(Y.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=De*Z*Ne,$+=Oe*Z*Ne,W+=ze*Z*Ne}const ue=this.projectAndGetPerspectiveRatio(k,N,$,W,p.tileID,he.name==="globe"||!!Z||this.transform.pitch>0,he),me=E*ue.perspectiveRatio,ve=(p.x1*a+v.x-p.padding)*me+ue.point.x,Se=(p.y1*a+v.y-p.padding)*me+ue.point.y,Pe=(p.x2*a+v.x+p.padding)*me+ue.point.x,Me=(p.y2*a+v.y+p.padding)*me+ue.point.y,Fe=ue.perspectiveRatio<=.55||ue.occluded;return!this.isInsideGrid(ve,Se,Pe,Me)||!b&&this.grid.hitTest(ve,Se,Pe,Me,O)||Fe?{box:[],offscreen:!1,occluded:ue.occluded}:{box:[ve,Se,Pe,Me],offscreen:this.isOffscreen(ve,Se,Pe,Me),occluded:!1}}placeCollisionCircles(t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue){const me=[],ve=this.transform.elevation,Se=t.getProjection(),Pe=ve?ve.getAtTileOffsetFunc(ue,this.transform.center.lat,this.transform.worldSize,Se):null,Me=new i.P(p.tileAnchorX,p.tileAnchorY);let{x:Fe,y:De,z:Oe}=Se.projectTilePoint(Me.x,Me.y,ue.canonical);if(Pe){const[Ht,ut,Lt]=Pe(Me);Fe+=Ht,De+=ut,Oe+=Lt}const ze=Se.name==="globe",Ne=this.projectAndGetPerspectiveRatio(k,Fe,De,Oe,ue,ze||!!ve||this.transform.pitch>0,Se),{perspectiveRatio:je}=Ne,pt=(W?E/je:E*je)/i.bw,ot=ui(Fe,De,Oe,O),Ve=Ne.signedDistanceFromCamera>0?ql(pt,b,p.lineOffsetX*pt,p.lineOffsetY*pt,!1,ot,Me,p,v,O,{},ve&&!W?Pe:null,W&&!!ve,Se,ue,W):null;let Je=!1,It=!1,kt=!0;if(Ve&&!Ne.occluded){const Ht=.5*Y*je+he,ut=new i.P(-100,-100),Lt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),xt=new Uo,{first:Gt,last:At}=Ve,Ct=Gt.path.length;let on=[];for(let mn=Ct-1;mn>=1;mn--)on.push(Gt.path[mn]);for(let mn=1;mn<At.path.length;mn++)on.push(At.path[mn]);const Zt=2.5*Ht;N&&(on=on.map(([mn,jn,In],Rn)=>(Pe&&!ze&&(In=Pe(Rn<Ct-1?Gt.tilePath[Ct-1-Rn]:At.tilePath[Rn-Ct+2])[2]),ui(mn,jn,In,N))),on.some(mn=>mn[3]<=0)&&(on=[]));let cn=[];if(on.length>0){let mn=1/0,jn=-1/0,In=1/0,Rn=-1/0;for(const Gn of on)mn=Math.min(mn,Gn[0]),In=Math.min(In,Gn[1]),jn=Math.max(jn,Gn[0]),Rn=Math.max(Rn,Gn[1]);jn>=ut.x&&mn<=Lt.x&&Rn>=ut.y&&In<=Lt.y&&(cn=[on.map(Gn=>new i.P(Gn[0],Gn[1]))],(mn<ut.x||jn>Lt.x||In<ut.y||Rn>Lt.y)&&(cn=i.bu(cn,ut.x,ut.y,Lt.x,Lt.y)))}for(const mn of cn){xt.reset(mn,.25*Ht);let jn=0;jn=xt.length<=.5*Ht?1:Math.ceil(xt.paddedLength/Zt)+1;for(let In=0;In<jn;In++){const Rn=In/Math.max(jn-1,1),Gn=xt.lerp(Rn),br=Gn.x+gi,dr=Gn.y+gi;me.push(br,dr,Ht,0);const Yr=br-Ht,ci=dr-Ht,xr=br+Ht,Fr=dr+Ht;if(kt=kt&&this.isOffscreen(Yr,ci,xr,Fr),It=It||this.isInsideGrid(Yr,ci,xr,Fr),!a&&this.grid.hitTestCircle(br,dr,Ht,Z)&&(Je=!0,!$))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!$&&Je||!It?[]:me,offscreen:kt,collisionDetected:Je,occluded:Ne.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let p=1/0,v=1/0,b=-1/0,E=-1/0;for(const $ of t){const W=new i.P($.x+gi,$.y+gi);p=Math.min(p,W.x),v=Math.min(v,W.y),b=Math.max(b,W.x),E=Math.max(E,W.y),a.push(W)}const k=this.grid.query(p,v,b,E).concat(this.ignoredGrid.query(p,v,b,E)),O={},N={};for(const $ of k){const W=$.key;if(O[W.bucketInstanceId]===void 0&&(O[W.bucketInstanceId]={}),O[W.bucketInstanceId][W.featureIndex])continue;const Z=[new i.P($.x1,$.y1),new i.P($.x2,$.y1),new i.P($.x2,$.y2),new i.P($.x1,$.y2)];i.bv(a,Z)&&(O[W.bucketInstanceId][W.featureIndex]=!0,N[W.bucketInstanceId]===void 0&&(N[W.bucketInstanceId]=[]),N[W.bucketInstanceId].push(W.featureIndex))}return N}insertCollisionBox(t,a,p,v,b){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:v,collisionGroupID:b},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,p,v,b){const E=a?this.ignoredGrid:this.grid,k={bucketInstanceId:p,featureIndex:v,collisionGroupID:b};for(let O=0;O<t.length;O+=4)E.insertCircle(k,t[O],t[O+1],t[O+2])}projectAndGetPerspectiveRatio(t,a,p,v,b,E,k){const O=[a,p,v,1];let N=!1;v||this.transform.pitch>0?(i.ab.vec4.transformMat4(O,O,t),this.fogState&&b&&k.name!=="globe"&&(N=function(Z,Y,he,ue,me,ve){const Se=ve.calculateFogTileMatrix(me),Pe=[Y,he,ue];return i.ab.vec3.transformMat4(Pe,Pe,Se),Vn(Z,i.ab.vec3.length(Pe),ve.pitch,ve._fov)}(this.fogState,a,p,v,b.toUnwrapped(),this.transform)>.9)):La(O,O,t);const $=O[3];return{point:new i.P((O[0]/$+1)/2*this.transform.width+gi,(-O[1]/$+1)/2*this.transform.height+gi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(k)/$*.5,1.5),signedDistanceFromCamera:$,occluded:E&&O[2]>$||N}}isOffscreen(t,a,p,v){return p<gi||t>=this.screenRightBoundary||v<gi||a>this.screenBottomBoundary}isInsideGrid(t,a,p,v){return p>=0&&t<this.gridRightBoundary&&v>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=i.ab.mat4.identity([]);return i.ab.mat4.translate(t,t,[-100,-100,0]),t}}function $o(h,t,a){const p=t.createTileMatrix(h,h.worldSize,a.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),h.projMatrix,p)}function Bi(h,t,a){if(t.projection.name===a.projection.name)return h.projMatrix;const p=a.clone();return p.setProjection(t.projection),$o(p,t.getProjection(),h)}function dl(h,t,a){return t.name===a.projection.name?h.projMatrix:$o(a,t,h)}class aa{constructor(t,a,p,v){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):v&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ga{constructor(t,a,p,v,b,E=!1){this.text=new aa(t?t.text:null,a,p,b),this.icon=new aa(t?t.icon:null,a,v,b),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Wl{constructor(t,a,p,v=!1){this.text=t,this.icon=a,this.skipFade=p,this.clipped=v}}class _a{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class dh{constructor(t,a,p,v,b){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=b}}class za{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:p=>p.collisionGroupID===a}}return this.collisionGroups[t]}}function Hf(h,t,a,p,v){const{horizontalAlign:b,verticalAlign:E}=i.bD(h),k=-(b-.5)*t,O=-(E-.5)*a,N=i.bC(h,p);return new i.P(k+N[0]*v,O+N[1]*v)}function hh(h,t,a,p,v){const b=new i.P(h,t);return a&&b._rotate(p?v:-v),b}class xs{constructor(t,a,p,v,b,E){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new Xi(this.transform,b),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new za(p),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,a,p,v,b=1){const E=p.getBucket(a),k=p.latestFeatureIndex;if(!E||!k||a.fqid!==E.layerIds[0])return;const O=E.layers[0].layout,N=E.layers[0].paint,$=p.collisionBoxArray,W=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),Z=p.tileSize/i.ag,Y=p.tileID.toUnwrapped();this.transform.setProjection(E.projection);const he=(ue=p.tileID,me=E.getProjection(),ve=this.transform,me.name===this.projection?ve.calculateProjMatrix(ue.toUnwrapped()):$o(ve,me,ue));var ue,me,ve;const Se=O.get("text-pitch-alignment")==="map",Pe=O.get("text-rotation-alignment")==="map";a.compileFilter(a.options);const Me=a.dynamicFilter(),Fe=a.dynamicFilterNeedsFeature(),De=this.transform.calculatePixelsToTileUnitsMatrix(p),Oe=oa(he,p.tileID.canonical,Se,Pe,this.transform,E.getProjection(),De);let ze=null;if(Se){const Ht=_o(he,p.tileID.canonical,Se,Pe,this.transform,E.getProjection(),De);ze=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Ht)}let Ne=null;Me&&p.latestFeatureIndex&&(Ne={unwrappedTileID:Y,dynamicFilter:Me,dynamicFilterNeedsFeature:Fe}),this.retainedQueryData[E.bucketInstanceId]=new dh(E.bucketInstanceId,k,E.sourceLayerIndex,E.index,p.tileID);const[je,pt]=E.layers[0].layout.get("text-size-scale-range"),ot=i.aw(b,je,pt),[Ve,Je]=O.get("icon-size-scale-range"),It=i.aw(b,Ve,Je),kt={bucket:E,layout:O,paint:N,posMatrix:he,textLabelPlaneMatrix:Oe,labelToScreenMatrix:ze,clippingData:Ne,scale:W,textPixelRatio:Z,holdingForFade:p.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:i.bp(E.textSizeData,this.transform.zoom,ot),partiallyEvaluatedIconSize:i.bp(E.iconSizeData,this.transform.zoom,It),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(v)for(const Ht of E.sortKeyRanges){const{sortKey:ut,symbolInstanceStart:Lt,symbolInstanceEnd:xt}=Ht;t.push({sortKey:ut,symbolInstanceStart:Lt,symbolInstanceEnd:xt,parameters:kt})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:kt})}attemptAnchorPlacement(t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve,Se){const{textOffset0:Pe,textOffset1:Me,crossTileID:Fe}=Z,De=[Pe,Me],Oe=Hf(t,p,v,De,b),ze=this.collisionIndex.placeCollisionBox(he,b,a,hh(Oe.x,Oe.y,E,k,this.transform.angle),W,O,N,$.predicate);if(me){const Ne=he.getSymbolInstanceIconSize(Se,this.transform.zoom,Z.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(he,Ne,me,hh(Oe.x,Oe.y,E,k,this.transform.angle),W,O,N,$.predicate).box.length===0)return}if(ze.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Fe]&&this.prevPlacement.placements[Fe]&&this.prevPlacement.placements[Fe].text&&(Ne=this.prevPlacement.variableOffsets[Fe].anchor),this.variableOffsets[Fe]={textOffset:De,width:p,height:v,anchor:t,textScale:b,prevAnchor:Ne},this.markUsedJustification(he,t,Z,ue),he.allowVerticalPlacement&&(this.markUsedOrientation(he,ue,Z),this.placedOrientations[Fe]=ue),{shift:Oe,placedGlyphBoxes:ze}}}placeLayerBucketPart(t,a,p,v,b=1){const{bucket:E,layout:k,paint:O,posMatrix:N,textLabelPlaneMatrix:$,labelToScreenMatrix:W,clippingData:Z,textPixelRatio:Y,holdingForFade:he,collisionBoxArray:ue,partiallyEvaluatedTextSize:me,partiallyEvaluatedIconSize:ve,collisionGroup:Se,latestFeatureIndex:Pe}=t.parameters,Me=k.get("text-optional"),Fe=k.get("icon-optional"),De=k.get("text-allow-overlap"),Oe=k.get("icon-allow-overlap"),ze=k.get("text-rotation-alignment")==="map",Ne=k.get("text-pitch-alignment")==="map",je=k.get("symbol-z-elevate"),pt=O.get("symbol-z-offset"),ot=k.get("symbol-elevation-reference")==="sea",[Ve,Je]=k.get("text-size-scale-range"),[It,kt]=k.get("icon-size-scale-range"),Ht=i.aw(b,Ve,Je),ut=i.aw(b,It,kt);this.transform.setProjection(E.projection);let Lt=De&&(Oe||!E.hasIconData()||Fe),xt=Oe&&(De||!E.hasTextData()||Me);const Gt=!pt.isConstant();!E.collisionArrays&&ue&&E.deserializeCollisionBoxes(ue),p&&v&&E.updateCollisionDebugBuffers(this.transform.zoom,ue,Ht,ut);const At=(Ct,on,Zt)=>{const{crossTileID:cn,numVerticalGlyphVertices:mn}=Ct;let jn=null;if(Z&&Z.dynamicFilterNeedsFeature||Gt){const Gr=this.retainedQueryData[E.bucketInstanceId];jn=Pe.loadFeature({featureIndex:Ct.featureIndex,bucketIndex:Gr.bucketIndex,sourceLayerIndex:Gr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Z&&!(0,Z.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},jn,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new i.P(Ct.tileAnchorX,Ct.tileAnchorY),this.transform.calculateDistanceTileData(Z.unwrappedTileID)))return this.placements[cn]=new Wl(!1,!1,!1,!0),void a.add(cn);const In=pt.evaluate(jn,{});if(a.has(cn))return;if(he)return void(this.placements[cn]=new Wl(!1,!1,!1));let Rn=!1,Gn=!1,br=!0,dr=!1,Yr=!1,ci=null,xr={box:null,offscreen:null,occluded:null},Fr={box:null,offscreen:null,occluded:null},Wn=null,Cn=null,Br=null,$r=0,yi=0,Ro=0;Zt.textFeatureIndex?$r=Zt.textFeatureIndex:Ct.useRuntimeCollisionCircles&&($r=Ct.featureIndex),Zt.verticalTextFeatureIndex&&(yi=Zt.verticalTextFeatureIndex);const Yi=Gr=>{Gr.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const ii=this.transform.elevation;Gr.elevation=ot?In:In+(ii?ii.getAtTileOffset(Gr.tileID,Gr.tileAnchorX,Gr.tileAnchorY):0),Gr.elevation+=Ct.zOffset},qi=Zt.textBox;if(qi){Yi(qi);const Gr=Mr=>{let Ci=i.bq.horizontal;if(E.allowVerticalPlacement&&!Mr&&this.prevPlacement){const io=this.prevPlacement.placedOrientations[cn];io&&(this.placedOrientations[cn]=io,Ci=io,this.markUsedOrientation(E,Ci,Ct))}return Ci},ii=(Mr,Ci)=>{if(E.allowVerticalPlacement&&mn>0&&Zt.verticalTextBox){for(const io of E.writingModes)if(io===i.bq.vertical?(xr=Ci(),Fr=xr):xr=Mr(),xr&&xr.box&&xr.box.length)break}else xr=Mr()};if(k.get("text-variable-anchor")){let Mr=k.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[cn]){const ei=this.prevPlacement.variableOffsets[cn];Mr.indexOf(ei.anchor)>0&&(Mr=Mr.filter(Ho=>Ho!==ei.anchor),Mr.unshift(ei.anchor))}const Ci=(ei,Ho,As)=>{const ms=E.getSymbolInstanceTextSize(me,Ct,this.transform.zoom,on),gs=(ei.x2-ei.x1)*ms+2*ei.padding,is=(ei.y2-ei.y1)*ms+2*ei.padding,os=Ct.hasIconTextFit&&!Oe?Ho:null;os&&Yi(os);let _s={box:[],offscreen:!1,occluded:!1};const Mi=De?2*Mr.length:Mr.length;for(let Ja=0;Ja<Mi;++Ja){const gc=this.attemptAnchorPlacement(Mr[Ja%Mr.length],ei,gs,is,ms,ze,Ne,Y,N,Se,Ja>=Mr.length,Ct,on,E,As,os,me,ve);if(gc&&(_s=gc.placedGlyphBoxes,_s&&_s.box&&_s.box.length)){Rn=!0,ci=gc.shift;break}}return _s};ii(()=>Ci(qi,Zt.iconBox,i.bq.horizontal),()=>{const ei=Zt.verticalTextBox;return ei&&Yi(ei),E.allowVerticalPlacement&&!(xr&&xr.box&&xr.box.length)&&mn>0&&ei?Ci(ei,Zt.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),xr&&(Rn=xr.box,br=xr.offscreen,dr=xr.occluded);const io=Gr(!(!xr||!xr.box));if(!Rn&&this.prevPlacement){const ei=this.prevPlacement.variableOffsets[cn];ei&&(this.variableOffsets[cn]=ei,this.markUsedJustification(E,ei.anchor,Ct,io))}}else{const Mr=(Ci,io)=>{const ei=E.getSymbolInstanceTextSize(me,Ct,this.transform.zoom,on,b),Ho=this.collisionIndex.placeCollisionBox(E,ei,Ci,new i.P(0,0),De,Y,N,Se.predicate);return Ho&&Ho.box&&Ho.box.length&&(this.markUsedOrientation(E,io,Ct),this.placedOrientations[cn]=io),Ho};ii(()=>Mr(qi,i.bq.horizontal),()=>{const Ci=Zt.verticalTextBox;return E.allowVerticalPlacement&&mn>0&&Ci?(Yi(Ci),Mr(Ci,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Gr(!!(xr&&xr.box&&xr.box.length))}}if(Wn=xr,Rn=Wn&&Wn.box&&Wn.box.length>0,br=Wn&&Wn.offscreen,dr=Wn&&Wn.occluded,Ct.useRuntimeCollisionCircles){const Gr=E.text.placedSymbolArray.get(Ct.centerJustifiedTextSymbolIndex>=0?Ct.centerJustifiedTextSymbolIndex:Ct.verticalPlacedTextSymbolIndex),ii=i.br(E.textSizeData,me,Gr),Mr=k.get("text-padding");Cn=this.collisionIndex.placeCollisionCircles(E,De,Gr,E.lineVertexArray,E.glyphOffsetArray,ii,N,$,W,p,Ne,Se.predicate,Ct.collisionCircleDiameter*ii/i.bw,Mr,this.retainedQueryData[E.bucketInstanceId].tileID),Rn=De||Cn.circles.length>0&&!Cn.collisionDetected,br=br&&Cn.offscreen,dr=Cn.occluded}if(Zt.iconFeatureIndex&&(Ro=Zt.iconFeatureIndex),Zt.iconBox){const Gr=ii=>{Yi(ii);const Mr=Ct.hasIconTextFit&&ci?hh(ci.x,ci.y,ze,Ne,this.transform.angle):new i.P(0,0),Ci=E.getSymbolInstanceIconSize(ve,this.transform.zoom,Ct.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Ci,ii,Mr,Oe,Y,N,Se.predicate)};Fr&&Fr.box&&Fr.box.length&&Zt.verticalIconBox?(Br=Gr(Zt.verticalIconBox),Gn=Br.box.length>0):(Br=Gr(Zt.iconBox),Gn=Br.box.length>0),br=br&&Br.offscreen,Yr=Br.occluded}const ro=Me||Ct.numHorizontalGlyphVertices===0&&mn===0,Ki=Fe||Ct.numIconVertices===0;if(ro||Ki?Ki?ro||(Gn=Gn&&Rn):Rn=Gn&&Rn:Gn=Rn=Gn&&Rn,Rn&&Wn&&Wn.box&&this.collisionIndex.insertCollisionBox(Wn.box,k.get("text-ignore-placement"),E.bucketInstanceId,Fr&&Fr.box&&yi?yi:$r,Se.ID),Gn&&Br&&this.collisionIndex.insertCollisionBox(Br.box,k.get("icon-ignore-placement"),E.bucketInstanceId,Ro,Se.ID),Cn&&(Rn&&this.collisionIndex.insertCollisionCircles(Cn.circles,k.get("text-ignore-placement"),E.bucketInstanceId,$r,Se.ID),p)){const Gr=E.bucketInstanceId;let ii=this.collisionCircleArrays[Gr];ii===void 0&&(ii=this.collisionCircleArrays[Gr]=new _a);for(let Mr=0;Mr<Cn.circles.length;Mr+=4)ii.circles.push(Cn.circles[Mr+0]),ii.circles.push(Cn.circles[Mr+1]),ii.circles.push(Cn.circles[Mr+2]),ii.circles.push(Cn.collisionDetected?1:0)}const Ei=E.projection.name!=="globe";Lt=Lt&&(Ei||!dr),xt=xt&&(Ei||!Yr),this.placements[cn]=new Wl(Rn||Lt,Gn||xt,br||E.justReloaded),a.add(cn)};if(je&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),E.sortFeaturesByY){const Ct=E.getSortedSymbolIndexes(this.transform.angle);for(let on=Ct.length-1;on>=0;--on){const Zt=Ct[on];At(E.symbolInstances.get(Zt),Zt,E.collisionArrays[Zt])}E.hasAnyZOffset&&i.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const Ct=E.getSortedIndexesByZOffset();for(let on=0;on<Ct.length;++on){const Zt=Ct[on];At(E.symbolInstances.get(Zt),Zt,E.collisionArrays[Zt])}}else for(let Ct=t.symbolInstanceStart;Ct<t.symbolInstanceEnd;Ct++)At(E.symbolInstances.get(Ct),Ct,E.collisionArrays[Ct]);if(p&&E.bucketInstanceId in this.collisionCircleArrays){const Ct=this.collisionCircleArrays[E.bucketInstanceId];i.ab.mat4.invert(Ct.invProjMatrix,N),Ct.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(t,a,p,v){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:O,crossTileID:N}=p,$=i.bB(a),W=v===i.bq.vertical?O:$==="left"?b:$==="center"?E:$==="right"?k:-1;b>=0&&(t.text.placedSymbolArray.get(b).crossTileID=W>=0&&b!==W?0:N),E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=W>=0&&E!==W?0:N),k>=0&&(t.text.placedSymbolArray.get(k).crossTileID=W>=0&&k!==W?0:N),O>=0&&(t.text.placedSymbolArray.get(O).crossTileID=W>=0&&O!==W?0:N)}markUsedOrientation(t,a,p){const v=a===i.bq.horizontal||a===i.bq.horizontalOnly?a:0,b=a===i.bq.vertical?a:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:N}=p,$=t.text.placedSymbolArray;E>=0&&($.get(E).placedOrientation=v),k>=0&&($.get(k).placedOrientation=v),O>=0&&($.get(O).placedOrientation=v),N>=0&&($.get(N).placedOrientation=b)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let p=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const v=a?a.symbolFadeChange(t):1,b=a?a.opacities:{},E=a?a.variableOffsets:{},k=a?a.placedOrientations:{};for(const O in this.placements){const N=this.placements[O],$=b[O];$?(this.opacities[O]=new ga($,v,N.text,N.icon,null,N.clipped),p=p||N.text!==$.text.placed||N.icon!==$.icon.placed):(this.opacities[O]=new ga(null,v,N.text,N.icon,N.skipFade,N.clipped),p=p||N.text||N.icon)}for(const O in b){const N=b[O];if(!this.opacities[O]){const $=new ga(N,v,!1,!1);$.isHidden()||(this.opacities[O]=$,p=p||N.text.placed||N.icon.placed)}}for(const O in E)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=E[O]);for(const O in k)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=k[O]);p?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a,p,v){const b=new Set;for(const E of a){const k=E.getBucket(t);k&&E.latestFeatureIndex&&t.fqid===k.layerIds[0]&&(this.updateBucketOpacities(k,b,E,E.collisionBoxArray,p,v,E.tileID,t.scope),k.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(k,E.tileID),k.updateZOffset()))}}updateBucketOpacities(t,a,p,v,b,E,k,O){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const N=t.layers[0].layout,$=t.layers[0].paint,W=!!t.layers[0].dynamicFilter(),Z=new ga(null,0,!1,!1,!0),Y=N.get("text-allow-overlap"),he=N.get("icon-allow-overlap"),ue=N.get("text-variable-anchor"),me=N.get("text-rotation-alignment")==="map",ve=N.get("text-pitch-alignment")==="map",Se=$.get("symbol-z-offset"),Pe=N.get("symbol-elevation-reference")==="sea",Me=!Se.isConstant(),Fe=new ga(null,0,Y&&(he||!t.hasIconData()||N.get("icon-optional")),he&&(Y||!t.hasTextData()||N.get("text-optional")),!0);!t.collisionArrays&&v&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(v);const De=(ze,Ne,je)=>{for(let pt=0;pt<Ne/4;pt++)ze.opacityVertexArray.emplaceBack(je)};let Oe=0;E&&t.updateReplacement(k,E);for(let ze=0;ze<t.symbolInstances.length;ze++){const Ne=t.symbolInstances.get(ze),{numHorizontalGlyphVertices:je,numVerticalGlyphVertices:pt,crossTileID:ot,numIconVertices:Ve,tileAnchorX:Je,tileAnchorY:It}=Ne;let kt=null;const Ht=this.retainedQueryData[t.bucketInstanceId];Me&&Ne&&Ht&&(kt=p.latestFeatureIndex.loadFeature({featureIndex:Ne.featureIndex,bucketIndex:Ht.bucketIndex,sourceLayerIndex:Ht.sourceLayerIndex,layoutVertexArrayOffset:0}));const ut=Se.evaluate(kt,{}),Lt=a.has(ot);let xt=this.opacities[ot];Lt?xt=Z:xt||(xt=Fe,this.opacities[ot]=xt),a.add(ot);const Gt=je>0||pt>0,At=Ve>0,Ct=this.placedOrientations[ot],on=Ct===i.bq.vertical,Zt=Ct===i.bq.horizontal||Ct===i.bq.horizontalOnly;!Gt&&!At||xt.isHidden()||Oe++;let cn=!1;if((Gt||At)&&E)for(const mn of t.activeReplacements){if(i.bx(mn,b,i.by.Symbol,O)||mn.min.x>Je||Je>mn.max.x||mn.min.y>It||It>mn.max.y)continue;const jn=i.bz(Je,It,k.canonical,mn.footprintTileId.canonical);if(cn=i.bA(jn,mn.footprint),cn)break}if(Gt){const mn=cn?ya:Xf(xt.text);De(t.text,je,on?ya:mn),De(t.text,pt,Zt?ya:mn);const jn=xt.text.isHidden(),{leftJustifiedTextSymbolIndex:In,centerJustifiedTextSymbolIndex:Rn,rightJustifiedTextSymbolIndex:Gn,verticalPlacedTextSymbolIndex:br}=Ne,dr=t.text.placedSymbolArray,Yr=jn||on?1:0;In>=0&&(dr.get(In).hidden=Yr),Rn>=0&&(dr.get(Rn).hidden=Yr),Gn>=0&&(dr.get(Gn).hidden=Yr),br>=0&&(dr.get(br).hidden=jn||Zt?1:0);const ci=this.variableOffsets[ot];ci&&this.markUsedJustification(t,ci.anchor,Ne,Ct);const xr=this.placedOrientations[ot];xr&&(this.markUsedJustification(t,"left",Ne,xr),this.markUsedOrientation(t,xr,Ne))}if(At){const mn=cn?ya:Xf(xt.icon),{placedIconSymbolIndex:jn,verticalPlacedIconSymbolIndex:In}=Ne,Rn=t.icon.placedSymbolArray,Gn=xt.icon.isHidden()?1:0;jn>=0&&(De(t.icon,Ve,on?ya:mn),Rn.get(jn).hidden=Gn),In>=0&&(De(t.icon,Ne.numVerticalIconVertices,Zt?ya:mn),Rn.get(In).hidden=Gn)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const mn=t.collisionArrays[ze];if(mn){let jn=new i.P(0,0),In=!0;if(mn.textBox||mn.verticalTextBox){if(ue){const Gn=this.variableOffsets[ot];Gn?(jn=Hf(Gn.anchor,Gn.width,Gn.height,Gn.textOffset,Gn.textScale),me&&jn._rotate(ve?this.transform.angle:-this.transform.angle)):In=!1}W&&(In=!xt.clipped),mn.textBox&&Su(t.textCollisionBox.collisionVertexArray,xt.text.placed,!In||on,ut,Pe,jn.x,jn.y),mn.verticalTextBox&&Su(t.textCollisionBox.collisionVertexArray,xt.text.placed,!In||Zt,ut,Pe,jn.x,jn.y)}const Rn=In&&!!(!Zt&&mn.verticalIconBox);mn.iconBox&&Su(t.iconCollisionBox.collisionVertexArray,xt.icon.placed,Rn,ut,Pe,Ne.hasIconTextFit?jn.x:0,Ne.hasIconTextFit?jn.y:0),mn.verticalIconBox&&Su(t.iconCollisionBox.collisionVertexArray,xt.icon.placed,!Rn,ut,Pe,Ne.hasIconTextFit?jn.x:0,Ne.hasIconTextFit?jn.y:0)}}}if(t.fullyClipped=Oe===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ze.invProjMatrix,t.placementViewportMatrix=ze.viewportMatrix,t.collisionCircleArray=ze.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const p=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*p>t}setStale(){this.stale=!0}}function Su(h,t,a,p,v,b,E){h.emplaceBack(t?1:0,a?1:0,b||0,E||0,p,v?1:0),h.emplaceBack(t?1:0,a?1:0,b||0,E||0,p,v?1:0),h.emplaceBack(t?1:0,a?1:0,b||0,E||0,p,v?1:0),h.emplaceBack(t?1:0,a?1:0,b||0,E||0,p,v?1:0)}const ph=Math.pow(2,25),Zf=Math.pow(2,24),gd=Math.pow(2,17),gg=Math.pow(2,16),_g=Math.pow(2,9),Tu=Math.pow(2,8),_d=Math.pow(2,1);function Xf(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const t=h.placed?1:0,a=Math.floor(127*h.opacity);return a*ph+t*Zf+a*gd+t*gg+a*_g+t*Tu+a*_d+t}const ya=0;class Yf{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,a,p,v,b,E){const k=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(k,v,t[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((O,N)=>O.sortKey-N.sortKey));this._currentPartIndex<k.length;){const O=k[this._currentPartIndex];if(a.placeLayerBucketPart(O,this._seenCrossTileIDs,p,O.symbolInstanceStart===0,E),this._currentPartIndex++,b())return!0}return!1}}class Eu{constructor(t,a,p,v,b,E,k,O,N){this.placement=new xs(t,b,E,k,O,N),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(t,a,p,v,b){const E=i.q.now(),k=()=>{const O=i.q.now()-E;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=a[t[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=N)&&(!O.maxzoom||O.maxzoom>N)){const $=O,W=$.layout.get("symbol-z-elevate"),Z=$.layout.get("symbol-sort-key").constantOr(1)!==void 0,Y=$.layout.get("symbol-z-order"),he=Y==="viewport-y"||Y==="auto"&&!(Y!=="viewport-y"&&Z),ue=$.layout.get("text-allow-overlap")||$.layout.get("icon-allow-overlap")||$.layout.get("text-ignore-placement")||$.layout.get("icon-ignore-placement"),me=he&&ue,ve=this._inProgressLayer=this._inProgressLayer||new Yf($),Se=i.aC(O.source,O.scope);if(ve.continuePlacement(W||me?v[Se]:p[Se],this.placement,this._showCollisionBoxes,O,k,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Da=512/i.ag/2;class yg{constructor(t,a,p){this.tileID=t,this.bucketInstanceId=p,this.index=new i.bE(a.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=t.canonical.x*i.ag,b=t.canonical.y*i.ag;for(let E=0;E<a.length;E++){const{key:k,crossTileID:O,tileAnchorX:N,tileAnchorY:$}=a.get(E),W=Math.floor((v+N)*Da),Z=Math.floor((b+$)*Da);this.index.add(W,Z),this.keys.push(k),this.crossTileIDs.push(O)}this.index.finish()}findMatches(t,a,p){const v=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),b=Da/Math.pow(2,a.canonical.z-this.tileID.canonical.z),E=a.canonical.x*i.ag,k=a.canonical.y*i.ag;for(let O=0;O<t.length;O++){const N=t.get(O);if(N.crossTileID)continue;const{key:$,tileAnchorX:W,tileAnchorY:Z}=N,Y=Math.floor((E+W)*b),he=Math.floor((k+Z)*b),ue=this.index.range(Y-v,he-v,Y+v,he+v);for(const me of ue){const ve=this.crossTileIDs[me];if(this.keys[me]===$&&!p.has(ve)){p.add(ve),N.crossTileID=ve;break}}}}}class vg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Kf{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const p in this.indexes){const v=this.indexes[p],b={};for(const E in v){const k=v[E];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+a),b[k.tileID.key]=k}this.indexes[p]=b}this.lng=t}addBucket(t,a,p){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let b=0;b<a.symbolInstances.length;b++)a.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const v=this.usedCrossTileIDs[t.overscaledZ];for(const b in this.indexes){const E=this.indexes[b];if(Number(b)>t.overscaledZ)for(const k in E){const O=E[k];O.tileID.isChildOf(t)&&O.findMatches(a.symbolInstances,t,v)}else{const k=E[t.scaledTo(Number(b)).key];k&&k.findMatches(a.symbolInstances,t,v)}}for(let b=0;b<a.symbolInstances.length;b++){const E=a.symbolInstances.get(b);E.crossTileID||(E.crossTileID=p.generate(),v.add(E.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new yg(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const p of a.crossTileIDs)this.usedCrossTileIDs[t].delete(p)}removeStaleBuckets(t){let a=!1;for(const p in this.indexes){const v=this.indexes[p];for(const b in v)t[v[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[b]),delete v[b],a=!0)}return a}}class Jf{constructor(){this.layerIndexes={},this.crossTileIDs=new vg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,p,v){let b=this.layerIndexes[t.fqid];b===void 0&&(b=this.layerIndexes[t.fqid]=new Kf);let E=!1;const k={};v.name!=="globe"&&b.handleWrapJump(p);for(const O of a){const N=O.getBucket(t);N&&t.fqid===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(O.tileID,N,this.crossTileIDs)&&(E=!0),k[N.bucketInstanceId]=!0)}return b.removeStaleBuckets(k)&&(E=!0),E}pruneUnusedLayers(t){const a={};t.forEach(p=>{a[p]=!0});for(const p in this.layerIndexes)a[p]||delete this.layerIndexes[p]}}const Cu=771;class vr{constructor(t,a,p,v){this.blendFunction=t,this.blendColor=a,this.mask=p,this.blendEquation=v}}vr.Replace=[1,0,1,0],vr.disabled=new vr(vr.Replace,i.aj.transparent,[!1,!1,!1,!1]),vr.unblended=new vr(vr.Replace,i.aj.transparent,[!0,!0,!0,!0]),vr.alphaBlended=new vr([1,Cu,1,Cu],i.aj.transparent,[!0,!0,!0,!0]),vr.alphaBlendedNonPremultiplied=new vr([770,Cu,770,Cu],i.aj.transparent,[!0,!0,!0,!0]),vr.multiply=new vr([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class kn{constructor(t,a,p){this.func=t,this.mask=a,this.range=p}}kn.ReadOnly=!1,kn.ReadWrite=!0,kn.disabled=new kn(519,kn.ReadOnly,[0,1]);const fh=7680;class Jn{constructor(t,a,p,v,b,E){this.test=t,this.ref=a,this.mask=p,this.fail=v,this.depthFail=b,this.pass=E}}Jn.disabled=new Jn({func:519,mask:0},0,0,fh,fh,fh);const mh=1029,va=2305;class Nn{constructor(t,a,p){this.enable=t,this.mode=a,this.frontFace=p}}function Lp(h,t){const a=i.bG(h,3);i.ab.mat4.fromQuat(h,t),i.bI(h,3,a)}function yd(h,t){const a=i.ab.quat.identity([]);return i.ab.quat.rotateZ(a,a,-t),i.ab.quat.rotateX(a,a,-h),a}function Oc(h,t){const a=[h[0],h[1],0],p=[t[0],t[1],0];if(i.ab.vec3.length(a)>=1e-15){const E=i.ab.vec3.normalize([],a);i.ab.vec3.scale(p,E,i.ab.vec3.dot(p,E)),t[0]=p[0],t[1]=p[1]}const v=i.ab.vec3.cross([],t,h);if(i.ab.vec3.len(v)<1e-15)return null;const b=Math.atan2(-v[1],v[0]);return yd(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),b)}Nn.disabled=new Nn(!1,mh,va),Nn.backCCW=new Nn(!0,mh,va),Nn.backCW=new Nn(!0,mh,2304),Nn.frontCW=new Nn(!0,1028,2304),Nn.frontCCW=new Nn(!0,1028,va);class Fc{constructor(t,a){this.position=t,this.orientation=a}get position(){return this._position}set position(t){if(t){const a=t instanceof i.aa?t:new i.aa(t[0],t[1],t[2]);this._renderWorldCopies&&(a.x=i.bF(a.x,0,1)),this._position=a}else this._position=null}lookAtPoint(t,a){if(this.orientation=null,!this.position)return;const p=this.position,v=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(t)):0,b=i.aa.fromLngLat(t,v),E=[b.x-p.x,b.y-p.y,b.z-p.z];a||(a=[0,0,1]),a[2]=Math.abs(a[2]),this.orientation=Oc(E,a)}setPitchBearing(t,a){this.orientation=yd(i.ai(t),i.ai(-a))}}class Mu{constructor(t,a){this._transform=i.ab.mat4.identity([]),this.orientation=a,this.position=t}get mercatorPosition(){const t=this.position;return new i.aa(t[0],t[1],t[2])}get position(){const t=i.bG(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var a;t&&i.bI(this._transform,3,[(a=t)[0],a[1],a[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||i.ab.quat.identity([]),t&&Lp(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),a=this.right();return{bearing:Math.atan2(-a[1],a[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,a){this._orientation=yd(t,a),Lp(this._transform,this._orientation)}forward(){const t=i.bG(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=i.bG(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=i.bG(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,a){const p=new Float64Array(16);return i.ab.mat4.invert(p,this.getWorldToCamera(t,a)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,a,p){const v=this.position;i.ab.vec3.scale(v,v,-t);const b=new Float64Array(16);return i.ab.mat4.fromScaling(b,[p,p,p]),i.ab.mat4.translate(b,b,v),b[10]*=a,b}getWorldToCamera(t,a){const p=new Float64Array(16),v=new Float64Array(4),b=this.position;return i.ab.quat.conjugate(v,this._orientation),i.ab.vec3.scale(b,b,-t),i.ab.mat4.fromQuat(p,v),i.ab.mat4.translate(p,p,b),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=a,p[9]*=a,p[10]*=a,p[11]*=a,p}getCameraToClipPerspective(t,a,p,v){const b=new Float64Array(16);return i.ab.mat4.perspective(b,t,a,p,v),b}getCameraToClipOrthographic(t,a,p,v,b,E){const k=new Float64Array(16);return i.ab.mat4.ortho(k,t,a,p,v,b,E),k}getDistanceToElevation(t,a=!1){const p=t===0?0:i.bH(t,a?i.aS(this.position[1]):this.position[1]),v=this.forward();return(p-this.position[2])/v[2]}clone(){return new Mu([...this.position],[...this.orientation])}}const So={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class To{constructor(t=0,a=0,p=0,v=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=p,this.right=v}interpolate(t,a,p){return a.top!=null&&t.top!=null&&(this.top=i.af(t.top,a.top,p)),a.bottom!=null&&t.bottom!=null&&(this.bottom=i.af(t.bottom,a.bottom,p)),a.left!=null&&t.left!=null&&(this.left=i.af(t.left,a.left,p)),a.right!=null&&t.right!=null&&(this.right=i.af(t.right,a.right,p)),this}getCenter(t,a){const p=i.aw((this.left+t-this.right)/2,0,t),v=i.aw((this.top+a-this.bottom)/2,0,a);return new i.P(p,v)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new To(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const gh=(h,t,a)=>(1-a)*h+a*t,tn=h=>h*h*h*h*h;class _h{constructor(t,a,p,v,b,E,k){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=p??0,this._maxPitch=v??60,this.setProjection(E),this.setMaxBounds(k),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new To,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Mu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new _h(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(t,a=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(t||p)&&this._constrainCamera(a),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const a=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const p=this.getProjection(),v=!i.bn(a,p);return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const a=t!==this.projection.name;return a&&this._calcMatrices(),a}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const a=-t*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=i.aw(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=i.ai(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._setZoom(a),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(t){this._tileCoverLift!==t&&(this._tileCoverLift=t)}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,a=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!a||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;a||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,a=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let v=0,b=0;for(let E=0;E<a.length;E++){const k=new i.P(a[E][0]*this.width,p+a[E][1]*(this.height-p)),O=t.pointCoordinate(k);if(!O)continue;const N=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);v+=O[3]*N,b+=N}return b===0?NaN:v/b}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,a=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*a,v=this._mercatorZfromZoom(t),b=this._mercatorZfromZoom(this._maxZoom),E=Math.max(v-p,b);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const a=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let p;p=t.z<this._camera.position[2]?[a.x,a.y,a.z]:[t.x,t.y,t.z];const v=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,p));return i.aw(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let a=!1;if(t.orientation&&!i.ab.quat.exactEquals(t.orientation,this._camera.orientation)&&(a=this._setCameraOrientation(t.orientation)),t.position){const p=[t.position.x,t.position.y,t.position.z];i.ab.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),a=!0)}a&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,a=new Fc;return a.position=new i.aa(t[0],t[1],t[2]),a.orientation=this._camera.orientation,a._elevation=this.elevation,a._renderWorldCopies=this.renderWorldCopies,a}_setCameraOrientation(t){if(!i.ab.quat.length(t))return!1;i.ab.quat.normalize(t,t);const a=i.ab.vec3.transformQuat([],[0,0,-1],t),p=i.ab.vec3.transformQuat([],[0,-1,0],t);if(p[2]<0)return!1;const v=Oc(a,p);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(t){const a=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;t[2]=i.aw(t[2],v/p,v/a),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,p){this._unmodified=!1,this._edgeInsets.interpolate(t,a,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new i.bQ(0,t)];if(this.renderWorldCopies){const p=this.pointCoordinate(new i.P(0,0)),v=this.pointCoordinate(new i.P(this.width,0)),b=this.pointCoordinate(new i.P(this.width,this.height)),E=this.pointCoordinate(new i.P(0,this.height)),k=Math.floor(Math.min(p.x,v.x,b.x,E.x)),O=Math.floor(Math.max(p.x,v.x,b.x,E.x)),N=1;for(let $=k-N;$<=O+N;$++)$!==0&&a.push(new i.bQ($,t))}return a}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(t,a,p){let v=[];const b=p!==void 0,E=!b;if(E&&this.zoom<a||b&&p[0]===0&&p[1]===0)return v;const k=new Set,O=($,W,Z,Y,he)=>{const ue=i.c5(W,$,Z,Y,he);k.has(ue)||(v.push(new i.aG($,W,Z,Y,he)),k.add(ue))};for(let $=0;$<t.length;$++){const W=t[$];if(E&&W.canonical.z!==a)continue;const Z=W.canonical,Y=W.overscaledZ,he=W.wrap,ue=1<<Z.z,me=Z.x+1<ue,ve=Z.x>0,Se=Z.y+1<ue,Pe=Z.y>0,Me=W.wrap-(ve?0:1),Fe=W.wrap+(me?0:1),De=ve?Z.x-1:ue-1,Oe=me?Z.x+1:0;if(b)p[0]<0?(O(Y,Fe,Z.z,Oe,Z.y),p[1]<0&&Se&&(O(Y,he,Z.z,Z.x,Z.y+1),O(Y,Fe,Z.z,Oe,Z.y+1)),p[1]>0&&Pe&&(O(Y,he,Z.z,Z.x,Z.y-1),O(Y,Fe,Z.z,Oe,Z.y-1))):p[0]>0?(O(Y,Me,Z.z,De,Z.y),p[1]<0&&Se&&(O(Y,he,Z.z,Z.x,Z.y+1),O(Y,Me,Z.z,De,Z.y+1)),p[1]>0&&Pe&&(O(Y,he,Z.z,Z.x,Z.y-1),O(Y,Me,Z.z,De,Z.y-1))):p[1]<0&&Se?O(Y,he,Z.z,Z.x,Z.y+1):Pe&&O(Y,he,Z.z,Z.x,Z.y-1);else{const ze=W.visibleQuadrants;1&ze&&(O(Y,Me,Z.z,De,Z.y),Pe&&(O(Y,he,Z.z,Z.x,Z.y-1),O(Y,Me,Z.z,De,Z.y-1))),2&ze&&(O(Y,Fe,Z.z,Oe,Z.y),Pe&&(O(Y,he,Z.z,Z.x,Z.y-1),O(Y,Fe,Z.z,Oe,Z.y-1))),4&ze&&(O(Y,Me,Z.z,De,Z.y),Se&&(O(Y,he,Z.z,Z.x,Z.y+1),O(Y,Me,Z.z,De,Z.y+1))),8&ze&&(O(Y,Fe,Z.z,Oe,Z.y),Se&&(O(Y,he,Z.z,Z.x,Z.y+1),O(Y,Fe,Z.z,Oe,Z.y+1)))}}const N=[];for(const $ of v)v.some(W=>$.isChildOf(W))||N.push($);if(v=N.filter($=>!t.some(W=>!!($.overscaledZ<a&&W.isChildOf($))||$.equals(W)||$.isChildOf(W))),E){const $=1<<a,W=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Z=[$*W.x,$*W.y],Y=4,he=Y*Y;v=v.filter(ue=>{const me=ue.canonical.x+.5-Z[0],ve=ue.canonical.y+.5-Z[1];return me*me+ve*ve<he})}return v}coveringTiles(t){let a=this.coveringZoomLevel(t);const p=a,v=this.elevation&&this.elevation.exaggeration(),b=v&&!t.isTerrainDEM,E=this.projection.name==="mercator";if(t.minzoom!==void 0&&a<t.minzoom)return[];t.maxzoom!==void 0&&a>t.maxzoom&&(a=t.maxzoom);const k=this.locationCoordinate(this.center),O=this.center.lat,N=1<<a,$=[N*k.x,N*k.y,0],W=this.projection.name==="globe",Z=!W,Y=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,Z),he=W?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ue=N*i.bH(1,this.center.lat),me=this._camera.position[2]/i.bH(1,this.center.lat),ve=[N*he.x,N*he.y,me*(Z?1:ue)],Se=W||v,Pe=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Me=this.isLODDisabled(!0)?a:0;let Fe;if(this._elevation&&t.isTerrainDEM)Fe=1e4*this._elevation.exaggeration();else if(this._elevation){const ut=this._elevation.getMinMaxForVisibleTiles();Fe=ut?ut.max:this._centerAltitude}else Fe=this._centerAltitude;const De=t.isTerrainDEM?-Fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Oe=this.projection.isReprojectedInTileSpace?i.bS(this):1,ze=ut=>{const xt=new i.aa(ut.x+25e-6,ut.y,ut.z),Gt=new i.aa(ut.x,ut.y+25e-6,ut.z),At=ut.toLngLat(),Ct=xt.toLngLat(),on=Gt.toLngLat(),Zt=this.locationCoordinate(At),cn=this.locationCoordinate(Ct),mn=this.locationCoordinate(on),jn=Math.hypot(cn.x-Zt.x,cn.y-Zt.y),In=Math.hypot(mn.x-Zt.x,mn.y-Zt.y);return Math.sqrt(jn*In)*Oe/25e-6},Ne=ut=>{const Lt=Fe,xt=De;return{aabb:i.bV(this,N,0,0,0,ut,xt,Lt,this.projection),zoom:0,x:0,y:0,minZ:xt,maxZ:Lt,wrap:ut,fullyVisible:!1}},je=[];let pt=[];const ot=a,Ve=t.reparseOverscaled?p:a,Je=(me-this._centerAltitude)*ue,It=ut=>{if(!this._elevation||!ut.tileID||!E)return;const Lt=this._elevation.getMinMaxForTile(ut.tileID),xt=ut.aabb;Lt?(xt.min[2]=Lt.min,xt.max[2]=Lt.max,xt.center[2]=(xt.min[2]+xt.max[2])/2):(ut.shouldSplit=Ht(ut),ut.shouldSplit||(xt.min[2]=xt.max[2]=xt.center[2]=this._centerAltitude))},kt=(ut,Lt)=>{if(.707*Lt<ut)return 1;const xt=Lt/ut;return xt/(1.4144271570014144+(Math.pow(1.1,xt-1.4144271570014144+1)-1)/(1.1-1)-1)},Ht=ut=>{if(ut.zoom<Me)return!0;if(ut.zoom===ot)return!1;if(ut.shouldSplit!=null)return ut.shouldSplit;const Lt=ut.aabb.distanceX(ve),xt=ut.aabb.distanceY(ve);let Gt=Je,At=1;if(W){Gt=ut.aabb.distanceZ(ve);const In=Math.pow(2,ut.zoom),Rn=i.aS((ut.y+1)/In),Gn=i.aS(ut.y/In),br=Math.min(Math.max(O,Rn),Gn),dr=i.c9(br)/i.c9(O);if(At=br===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,dr/this._mercatorScaleRatio),this.zoom<=i.c6&&ut.zoom===ot-1&&dr>=.9)return!0}else if(b&&(Gt=ut.aabb.distanceZ(ve)*ue),this.projection.isReprojectedInTileSpace&&p<=5){const In=Math.pow(2,ut.zoom),Rn=ze(new i.aa((ut.x+.5)/In,(ut.y+.5)/In));At=Rn>.85?1:Rn}if(!E){const In=Math.sqrt(Lt*Lt+xt*xt+Gt*Gt);let Rn=(1<<ot-ut.zoom)*Pe*At;return Rn*=kt(Math.max(Gt,Je),In),In<Rn}let Ct=Number.MAX_VALUE,on=0;const Zt=ut.aabb.getCorners(),cn=[];for(const In of Zt){i.ab.vec3.sub(cn,In,ve),W||(b?cn[2]*=ue:cn[2]=Je);const Rn=i.ab.vec3.dot(cn,this._camera.forward());Rn<Ct&&(Ct=Rn,on=Math.abs(cn[2]))}let mn=(1<<ot-ut.zoom)*Pe*At;if(mn*=kt(Math.max(on,Je),Ct),Ct<mn)return!0;const jn=ut.aabb.closestPoint($);return jn[0]===$[0]&&jn[1]===$[1]};if(this.renderWorldCopies)for(let ut=1;ut<=3;ut++)je.push(Ne(-ut)),je.push(Ne(ut));for(je.push(Ne(0));je.length>0;){const ut=je.pop(),Lt=ut.x,xt=ut.y;let Gt=ut.fullyVisible;const At=()=>this.projection.name==="globe"&&(ut.y===0||ut.y===(1<<ut.zoom)-1);if(!Gt){let Ct=Se?ut.aabb.intersects(Y):ut.aabb.intersectsFlat(Y);if(Ct===0&&At()){const on=new i.bT(ut.zoom,Lt,xt);Ct=i.bU(this,N,on,!0).intersects(Y)}if(Ct===0)continue;Gt=Ct===2}if(ut.zoom!==ot&&Ht(ut))for(let Ct=0;Ct<4;Ct++){const on=(Lt<<1)+Ct%2,Zt=(xt<<1)+(Ct>>1),cn={aabb:E?ut.aabb.quadrant(Ct):i.bV(this,N,ut.zoom+1,on,Zt,ut.wrap,ut.minZ,ut.maxZ,this.projection),zoom:ut.zoom+1,x:on,y:Zt,wrap:ut.wrap,fullyVisible:Gt,tileID:void 0,shouldSplit:void 0,minZ:ut.minZ,maxZ:ut.maxZ};b&&!W&&(cn.tileID=new i.aG(ut.zoom+1===ot?Ve:ut.zoom+1,ut.wrap,ut.zoom+1,on,Zt),It(cn)),je.push(cn)}else{const Ct=ut.zoom===ot?Ve:ut.zoom;if(t.minzoom&&t.minzoom>Ct)continue;let on=0;if(!Gt){let jn=Se?ut.aabb.intersectsPrecise(Y):ut.aabb.intersectsPreciseFlat(Y);if(jn===0&&At()){const In=new i.bT(ut.zoom,Lt,xt);jn=i.bU(this,N,In,!0).intersectsPrecise(Y)}if(jn===0)continue;if(t.calculateQuadrantVisibility)if(Y.containsPoint(ut.aabb.center))on=15;else for(let In=0;In<4;In++)ut.aabb.quadrant(In).intersects(Y)!==0&&(on|=1<<In)}const Zt=$[0]-(.5+Lt+(ut.wrap<<ut.zoom))*(1<<a-ut.zoom),cn=$[1]-.5-xt,mn=ut.tileID?ut.tileID:new i.aG(Ct,ut.wrap,ut.zoom,Lt,xt);t.calculateQuadrantVisibility&&(mn.visibleQuadrants=on),pt.push({tileID:mn,distanceSq:Zt*Zt+cn*cn})}}if(this.fogCullDistSq){const ut=this.fogCullDistSq,Lt=this.horizonLineFromTop();pt=pt.filter(xt=>{const Gt=[0,0,0,1],At=[i.ag,i.ag,0,1],Ct=this.calculateFogTileMatrix(xt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Gt,Gt,Ct),i.ab.vec4.transformMat4(At,At,Ct);const on=i.ab.vec4.min([],Gt,At),Zt=i.ab.vec4.max([],Gt,At),cn=i.bW(on,Zt);if(cn===0)return!0;let mn=!1;const jn=this._elevation;if(jn&&cn>ut&&Lt!==0){const In=this.calculateProjMatrix(xt.tileID.toUnwrapped());let Rn;t.isTerrainDEM||(Rn=jn.getMinMaxForTile(xt.tileID)),Rn||(Rn={min:De,max:Fe});const Gn=i.c7(this.rotation),br=[Gn[0]*i.ag,Gn[1]*i.ag,Rn.max];i.ab.vec3.transformMat4(br,br,In),mn=(1-br[1])*this.height*.5<Lt}return cn<ut||mn})}return pt.sort((ut,Lt)=>ut.distanceSq-Lt.distanceSq).map(ut=>ut.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=i.aw(t.lat,-i.bX,i.bX),p=this.projection.project(t.lng,a);return new i.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,a){let p,v;const b=this.centerPoint;if(this.projection.name==="globe"){const k=this.worldSize;p=(a.x-b.x)/k,v=(a.y-b.y)/k}else{const k=this.pointCoordinate(a),O=this.pointCoordinate(b);p=k.x-O.x,v=k.y-O.y}const E=this.locationCoordinate(t);this.setLocation(new i.aa(E.x-p,E.y-v))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,a){const p=a?i.bH(a,t.lat):void 0,v=this.projection.project(t.lng,t.lat);return new i.aa(v.x,v.y,p)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,a){const p=a??this._centerAltitude,v=[t.x,t.y,0,1],b=[t.x,t.y,1,1];i.ab.vec4.transformMat4(v,v,this.pixelMatrixInverse),i.ab.vec4.transformMat4(b,b,this.pixelMatrixInverse);const E=b[3];i.ab.vec4.scale(v,v,1/v[3]),i.ab.vec4.scale(b,b,1/E);const k=v[2],O=b[2];return{p0:v,p1:b,t:k===O?0:(p-k)/(O-k)}}screenPointToMercatorRay(t){const a=[t.x,t.y,0,1],p=[t.x,t.y,1,1];return i.ab.vec4.transformMat4(a,a,this.pixelMatrixInverse),i.ab.vec4.transformMat4(p,p,this.pixelMatrixInverse),i.ab.vec4.scale(a,a,1/a[3]),i.ab.vec4.scale(p,p,1/p[3]),a[2]=i.bH(a[2],this._center.lat)*this.worldSize,p[2]=i.bH(p[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(a,a,1/this.worldSize),i.ab.vec4.scale(p,p,1/this.worldSize),new i.aq([a[0],a[1],a[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],p,a)))}rayIntersectionCoordinate(t){const{p0:a,p1:p,t:v}=t,b=i.bH(a[2],this._center.lat),E=i.bH(p[2],this._center.lat);return new i.aa(i.af(a[0],p[0],v)/this.worldSize,i.af(a[1],p[1],v)/this.worldSize,i.af(b,E,v))}pointCoordinate(t,a=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,a)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let a=this.projection.pointCoordinate3D(this,t.x,t.y);if(a)return new i.aa(a[0],a[1],a[2]);let p=0,v=this.horizonLineFromTop();if(t.y>v)return this.pointCoordinate(t);const b=.02*v,E=t.clone();for(let k=0;k<10&&v-p>b;k++){E.y=i.af(p,v,.66);const O=this.projection.pointCoordinate3D(this,E.x,E.y);O?(v=E.y,a=O):p=E.y}return a?new i.aa(a[0],a[1],a[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(t);const a=this.pointCoordinate(t);return a.y>=0&&a.y<=1}_coordinatePoint(t,a){const p=a&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,v=[t.x*this.worldSize,t.y*this.worldSize,p+t.toAltitude(),1];return i.ab.vec4.transformMat4(v,v,this.pixelMatrix),v[3]>0?new i.P(v[0]/v[3],v[1]/v[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:a}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,b=this.pointLocation3D(new i.P(a,t)),E=this.pointLocation3D(new i.P(v,t)),k=this.pointLocation3D(new i.P(v,p)),O=this.pointLocation3D(new i.P(a,p));let N=Math.min(b.lng,E.lng,k.lng,O.lng),$=Math.max(b.lng,E.lng,k.lng,O.lng),W=Math.min(b.lat,E.lat,k.lat,O.lat),Z=Math.max(b.lat,E.lat,k.lat,O.lat);const Y=Math.pow(2,-this.zoom)/16*270,he=this.projection.name==="globe"?1:4,ue=(me,ve,Se,Pe,Me)=>{const Fe=(me+Se)/2,De=(ve+Pe)/2,Oe=new i.P(Fe,De),{lng:ze,lat:Ne}=this.pointLocation3D(Oe),je=Math.max(0,N-ze,W-Ne,ze-$,Ne-Z);N=Math.min(N,ze),$=Math.max($,ze),W=Math.min(W,Ne),Z=Math.max(Z,Ne),(Me<he||je>Y)&&(ue(me,ve,Fe,De,Me+1),ue(Fe,De,Se,Pe,Me+1))};if(ue(a,t,v,t,1),ue(v,t,v,p,1),ue(v,p,a,p,1),ue(a,p,a,t,1),this.projection.name==="globe"){const[me,ve]=i.bZ(this);me?(Z=90,$=180,N=-180):ve&&(W=-90,$=180,N=-180)}return new i.az(new i.bO(N,W),new i.bO($,Z))}_getBoundsRectangular(t,a){const{top:p,left:v}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,k=new i.P(v,p),O=new i.P(E,p),N=new i.P(E,b),$=new i.P(v,b);let W=this.pointCoordinate(k,t),Z=this.pointCoordinate(O,t);const Y=this.pointCoordinate(N,a),he=this.pointCoordinate($,a),ue=(me,ve)=>(ve.y-me.y)/(ve.x-me.x);return W.y>1&&Z.y>=0?W=new i.aa((1-he.y)/ue(he,W)+he.x,1):W.y<0&&Z.y<=1&&(W=new i.aa(-he.y/ue(he,W)+he.x,0)),Z.y>1&&W.y>=0?Z=new i.aa((1-Y.y)/ue(Y,Z)+Y.x,1):Z.y<0&&W.y<=1&&(Z=new i.aa(-Y.y/ue(Y,Z)+Y.x,0)),new i.az().extend(this.coordinateLocation(W)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(he)).extend(this.coordinateLocation(Y))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const a=t.visibleDemTiles.reduce((p,v)=>{if(v.dem){const b=v.dem.tree;p.min=Math.min(p.min,b.minimums[0]),p.max=Math.max(p.max,b.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(a.min*t.exaggeration(),a.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const a=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-a*(1-this._horizonShift);return t?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,a){return this.projection.createTileMatrix(this,a,t)}calculateDistanceTileData(t){const a=t.key,p=this._distanceTileDataCache;if(p[a])return p[a];const v=t.canonical,b=1/this.height,E=this.cameraWorldSize,k=E/this.zoomScale(v.z),O=(v.x+Math.pow(2,v.z)*t.wrap)*k,N=v.y*k,$=this.point;$.x*=E/this.worldSize,$.y*=E/this.worldSize;const W=this.angle,Z=Math.sin(-W),Y=-Math.cos(-W);return p[a]={bearing:[Z,Y],center:[($.x-O)*b,($.y-N)*b],scale:k/i.ag*b},p[a]}calculateFogTileMatrix(t){const a=t.key,p=this._fogTileMatrixCache;if(p[a])return p[a];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return i.ab.mat4.multiply(v,this.worldToFogMatrix,v),p[a]=new Float32Array(v),p[a]}calculateProjMatrix(t,a=!1,p=!1){const v=t.key;let b;if(b=p?this._expandedProjMatrixCache:a?this._alignedProjMatrixCache:this._projMatrixCache,b[v])return b[v];const E=this.calculatePosMatrix(t,this.worldSize);let k;return k=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:a?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(E,k,E),b[v]=new Float32Array(E),b[v]}calculatePixelsToTileUnitsMatrix(t){const a=t.tileID.key,p=this._pixelsToTileUnitsCache;if(p[a])return p[a];const v=i.b_(t,this);return p[a]=v,p[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,a=i.ab.mat4.fromScaling([],[t,t,t]);return i.ab.mat4.multiply(a,a,this.globeMatrix),a}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const a=i.bH(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(a),v=this._camera.forward(),b=i.bH(1,this._center.lat);p[2]/=b,v[2]/=b,i.ab.vec3.normalize(v,v);const E=t.raycast(p,v,t.exaggeration());if(E){const k=i.ab.vec3.scaleAndAdd([],p,v,E),O=new i.aa(k[0],k[1],i.bH(k[2],i.aS(k[1]))),N=(O.z+i.ab.vec3.length([O.x-p[0],O.y-p[1],O.z-p[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const a=this._elevation,p=i.bH(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(p),b=a.getAtPointOrZero(new i.aa(...v)),E=this.pixelsPerMeter/this.worldSize*b,k=this._minimumHeightOverTerrain(),O=v[2]-E;if(O<=k)if(O<0||t){const N=this.locationCoordinate(this._center,this._centerAltitude),$=[v[0],v[1],N.z-v[2]],W=i.ab.vec3.length($);$[2]-=(k-O)/this._pixelsPerMercatorPixel;const Z=i.ab.vec3.length($);if(Z===0)return;i.ab.vec3.scale($,$,W/Z*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],N.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const Z=this.center;return Z.lat=i.aw(Z.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(Z.lng=i.aw(Z.lng,this.minLng,this.maxLng)),this.center=Z,void(this._constraining=!1)}const a=this._unmodified,{x:p,y:v}=this.point;let b=0,E=p,k=v;const O=this.width/2,N=this.height/2,$=this.worldMinY*this.scale,W=this.worldMaxY*this.scale;if(v-N<$&&(k=$+N),v+N>W&&(k=W-N),W-$<this.height&&(b=Math.max(b,this.height/(W-$)),k=(W+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Z=this.worldMinX*this.scale,Y=this.worldMaxX*this.scale,he=this.worldSize/2-(Z+Y)/2;E=(p+he+this.worldSize)%this.worldSize-he,E-O<Z&&(E=Z+O),E+O>Y&&(E=Y-O),Y-Z<this.width&&(b=Math.max(b,this.width/(Y-Z)),E=(Y+Z)/2)}E===p&&k===v||(this.center=this.unproject(new i.P(E,k))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=a,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const v=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b=this.projection.zAxisUnit==="meters"?p:1,E=this._camera.getWorldToCamera(this.worldSize,b);let k;const O=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(O[8]=2*-t.x/this.width,O[9]=2*t.y/this.height,this.isOrthographic){let Ne=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),je=Ne*this.aspect,pt=-je,ot=-Ne;je-=t.x,pt-=t.x,Ne+=t.y,ot+=t.y,k=this._camera.getCameraToClipOrthographic(pt,je,ot,Ne,this._nearZ,this._farZ),((Ve,Je,It,kt)=>{for(let Ht=0;Ht<16;Ht++)Ve[Ht]=gh(Je[Ht],It[Ht],kt)})(k,k,O,tn(this.pitch>=15?1:this.pitch/15))}else k=O;const N=i.ab.mat4.mul([],O,E);let $=i.ab.mat4.mul([],k,E);if(this.projection.isReprojectedInTileSpace){const Ne=this.locationCoordinate(this.center),je=i.ab.mat4.identity([]);i.ab.mat4.translate(je,je,[Ne.x*this.worldSize,Ne.y*this.worldSize,0]),i.ab.mat4.multiply(je,je,i.c0(this)),i.ab.mat4.translate(je,je,[-Ne.x*this.worldSize,-Ne.y*this.worldSize,0]),i.ab.mat4.multiply($,$,je),i.ab.mat4.multiply(N,N,je),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],$,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=$,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),a){const Ne=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ne[8]=2*-t.x/this.width,Ne[9]=2*t.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Ne,E)}else this.expandedFarZProjMatrix=this.projMatrix;const W=i.ab.mat4.invert([],k);this.frustumCorners=i.c2.fromInvProjectionMatrix(W,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!a);const Z=new Float32Array(16);i.ab.mat4.identity(Z),i.ab.mat4.scale(Z,Z,[1,-1,1]),i.ab.mat4.rotateX(Z,Z,this._pitch),i.ab.mat4.rotateZ(Z,Z,this.angle);const Y=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(Y);const he=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Y[8]=2*-t.x/this.width,Y[9]=2*(t.y+he)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(Z,Y,Z);const ue=this.point,me=ue.x,ve=ue.y,Se=this.width%2/2,Pe=this.height%2/2,Me=Math.cos(this.angle),Fe=Math.sin(this.angle),De=me-Math.round(me)+Me*Se+Fe*Pe,Oe=ve-Math.round(ve)+Me*Pe+Fe*Se,ze=new Float64Array($);if(i.ab.mat4.translate(ze,ze,[De>.5?De-1:De,Oe>.5?Oe-1:Oe,0]),this.alignedProjMatrix=ze,$=i.ab.mat4.create(),i.ab.mat4.scale($,$,[this.width/2,-this.height/2,1]),i.ab.mat4.translate($,$,[1,-1,0]),this.labelPlaneMatrix=$,$=i.ab.mat4.create(),i.ab.mat4.scale($,$,[1,-1,1]),i.ab.mat4.translate($,$,[-1,-1,0]),i.ab.mat4.scale($,$,[2/this.width,2/this.height,1]),this.glCoordMatrix=$,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,N),this._calcFogMatrices(),this._distanceTileDataCache={},$=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!$)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=$,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Ne,Ne,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=$;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,a=this.cameraPixelsPerMeter,p=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,b=[t,t,a];i.ab.vec3.scale(b,b,v),i.ab.vec3.scale(p,p,-1),i.ab.vec3.multiply(p,p,b);const E=i.ab.mat4.create();i.ab.mat4.translate(E,E,p),i.ab.mat4.scale(E,E,b),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,a,v)}_computeCameraPosition(t){const a=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),v=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*a-t/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-p[0]*b,v.y/this.worldSize-p[1]*b,t/this.worldSize*this._centerAltitude-p[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const a=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],v=t[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(b=Math.min((a-p)/v,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,t,b),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,a=this._camera.forward(),{pitch:p,bearing:v}=this._camera.getPitchBearing(),b=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),k=Math.max((t[2]-b)/Math.cos(p),E),O=this._zoomFromMercatorZ(k);i.ab.vec3.scaleAndAdd(t,t,a,k),this._pitch=i.aw(p,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(v,-Math.PI,Math.PI),this._setZoom(i.aw(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let a=0,p=i.bY,v=0,b=1/0;for(;p-a>1e-6&&p>a;){const E=a+.5*(p-a),k=this.tileSize*Math.pow(2,E),O=this.getCameraToCenterDistance(this.projection,E,k),N=this.scaleZoom(O/(t*this.tileSize)),$=Math.abs(E-N);$<b&&(b=$,v=E),E<N?a=E:p=E}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,a){const p=Math.min(t.x,a.x),v=Math.max(t.x,a.x),b=Math.min(t.y,a.y),E=Math.max(t.y,a.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const k=[new i.P(p,b),new i.P(v,E),new i.P(p,E),new i.P(v,b)],O=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const $ of k){const W=this.pointRayIntersection($);if(W.t<0)return!0;const Z=this.rayIntersectionCoordinate(W);if(Z.x<O||Z.y<0||Z.x>N||Z.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(t,a){const p=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,t)),v=this._zoomFromMercatorZ(p)+a;return p-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([a,p,v],b){const E=[a,p,v,1];i.ab.vec4.transformMat4(E,E,b);const k=E[3]=Math.max(E[3],1e-6);return E[0]/=k,E[1]/=k,E[2]/=k,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,t))}}getCameraToCenterDistance(t,a=this.zoom,p=this.worldSize){const v=i.b$(t,a,this.width,this.height,1024),b=t.pixelSpaceConversion(this.center.lat,p,v);let E=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(E=gh(1,E,tn(this.pitch>=15?1:this.pitch/15))),E}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(t,t,this.globeMatrix),t}getFrustum(t){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}const Oa=(h,t)=>{if(t>0&&h.terrain&&i.w("Cutoff is currently disabled on terrain"),t<=0||h.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const a=h.transform,p=Math.max(Math.abs(a._zoom-(h.minCutoffZoom-1)),1),v=a.isLODDisabled(!1)?i.ac(60,45,a.pitch):i.ac(30,15,a.pitch),b=a._farZ-a._nearZ,E=t*a.height,k=((1-(O=v))*a.cameraToCenterDistance+O*(a._farZ+E))*p;var O;return{shouldRenderCutoff:v<1,uniformValues:{u_cutoff_params:[a._nearZ,a._farZ,(k-a._nearZ)/b,(k-E-a._nearZ)/b]}}},Eo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Iu{constructor(t,a){this.aabb=t,this.lastCascade=a}}class Hl{add(t,a){const p=this.receivers[t.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],a.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],a.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],a.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],a.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],a.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],a.max[2])):this.receivers[t.key]=new Iu(a,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,a,p){const v=i.cd.fromPoints(t.points);let b=0;for(const E in this.receivers){const k=this.receivers[E];if(!k||!v.intersectsAabb(k.aabb))continue;k.aabb.min=v.closestPoint(k.aabb.min),k.aabb.max=v.closestPoint(k.aabb.max);const O=k.aabb.getCorners();for(let N=0;N<p.length;N++){let $=!0;for(const W of O){const Z=[W[0]*a,W[1]*a,W[2]];if(i.ab.vec3.transformMat4(Z,Z,p[N].matrix),Z[0]<-1||Z[0]>1||Z[1]<-1||Z[1]>1){$=!1;break}}if(k.lastCascade=N,b=Math.max(b,N),$)break}}return b+1}}class hl{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Hl,this._depthMode=new kn(t.context.gl.LEQUAL,kn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,t.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),t.tp.registerParameter(Eo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),t.tp.registerParameter(Eo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),t.tp.registerParameter(Eo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),t.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,a){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!a||!a.properties)return;const v=a.properties.get("shadow-intensity");if(!a.shadowsEnabled()||v<=0||(this._shadowLayerCount=p.style.order.reduce((he,ue)=>{const me=p.style._mergedLayers[ue];return he+(me.hasShadowPass()&&!me.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const b=p.context,E=Eo.shadowMapResolution,k=Eo.shadowMapResolution;if(this._cascades.length===0||Eo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let he=0;he<Eo.cascadeCount;++he){const ue=p._shadowMapDebug,me=b.gl,ve=b.createFramebuffer(E,k,ue,"texture"),Se=new i.T(b,{width:E,height:k,data:null},me.DEPTH_COMPONENT16);if(ve.depthAttachment.set(Se.texture),ue){const Pe=new i.T(b,{width:E,height:k,data:null},me.RGBA8);ve.colorAttachment.set(Pe.texture)}this._cascades.push({framebuffer:ve,texture:Se,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=Zl(a);let O=0;if(t.elevation){const he=t.elevation,ue=[1e4,-1e4];he.visibleDemTiles.filter(me=>me.dem).forEach(me=>{const ve=me.dem.tree;ue[0]=Math.min(ue[0],ve.minimums[0]),ue[1]=Math.max(ue[1],ve.maximums[0])}),ue[0]!==1e4&&(O=(ue[1]-ue[0])*he.exaggeration())}const N=1.5*t.cameraToCenterDistance,$=3*N,W=new Float64Array(16);for(let he=0;he<this._cascades.length;++he){const ue=this._cascades[he];let me=t.height/50,ve=1;Eo.cascadeCount===1?ve=$:he===0?ve=N:(me=N,ve=$);const[Se,Pe]=Xl(t,this.shadowDirection,me,ve,Eo.shadowMapResolution,O);ue.scale=t.scale,ue.matrix=Se,ue.boundingSphereRadius=Pe,i.ab.mat4.invert(W,ue.matrix),ue.frustum=i.bR.fromInvProjectionMatrix(W,1,0,!0),ue.far=ve}const Z=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Z].far,this._cascades[Z].far],this._uniformValues.u_shadow_intensity=v,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Eo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Eo.shadowMapResolution,this._uniformValues.u_shadowmap_0=So.ShadowMap0,this._uniformValues.u_shadowmap_1=So.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Y=p.transform.elevation;for(const he of this._groundShadowTiles){let ue={min:0,max:0};if(Y){const me=Y.getMinMaxForTile(he);me&&(ue=me)}this.addShadowReceiver(he.toUnwrapped(),ue.min,ue.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(t){this._enabled=t}drawShadowPass(t,a){if(!this.enabled)return;const p=this.painter,v=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),v.viewport.set([0,0,Eo.shadowMapResolution,Eo.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){p.currentShadowCascade=b,v.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),v.clear({color:i.aj.white,depth:1});for(const E of t.order){const k=t._mergedLayers[E];if(!k.hasShadowPass()||k.isHidden(p.transform.zoom))continue;const O=t.getLayerSourceCache(k),N=O?a[O.id]:void 0;(k.type==="model"||N&&N.length)&&p.renderLayer(p,O,k,N)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const t=this.painter,a=t.style,p=t.context,v=a.directionalLight,b=a.ambientLight;if(!v||!b)return;const E=[],k=Oa(t,t.longestCutoffRange);k.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const O=Bc(a,v,b),N=new kn(p.gl.LEQUAL,kn.ReadOnly,t.depthRangeFor3D);for(const $ of this._groundShadowTiles){const W=$.toUnwrapped(),Z=t.isTileAffectedByFog($),Y=t.getOrCreateProgram("groundShadow",{defines:E,overrideFog:Z});this.setupShadows(W,Y),t.uploadCommonUniforms(p,Y,W,null,k);const he={u_matrix:t.transform.calculateProjMatrix(W),u_ground_shadow_factor:O};Y.draw(t,p.gl.TRIANGLES,N,Jn.disabled,vr.multiply,Nn.disabled,he,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?vr.unblended:vr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const a=this.painter.transform,p=a.calculatePosMatrix(t,a.worldSize);return i.ab.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(t){return i.ab.mat4.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,a,p,v=0){if(!this.enabled)return;const b=this.painter.transform,E=this.painter.context,k=E.gl,O=this._uniformValues,N=new Float64Array(16),$=b.calculatePosMatrix(t,b.worldSize);for(let W=0;W<this._cascades.length;W++)i.ab.mat4.multiply(N,this._cascades[W].matrix,$),O[W===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),E.activeTexture.set(k.TEXTURE0+So.ShadowMap0+W),this._cascades[W].texture.bind(k.NEAREST,k.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const W=i.cc(t.canonical),Z=2/b.tileSize*i.ag/Eo.shadowMapResolution,Y=Z*this._cascades[0].boundingSphereRadius,he=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,ue=(p==="vector-tile"?1:3)/Math.pow(2,v-t.canonical.z-(1-b.zoom+Math.floor(b.zoom)));O.u_shadow_normal_offset=[W,Y*ue,he*ue],O.u_shadow_bias=[6e-5,.0012,.012]}else O.u_shadow_bias=[36e-5,.0012,.012];a.setShadowUniformValues(E,O)}setupShadowsFromMatrix(t,a,p=!1){if(!this.enabled)return;const v=this.painter.context,b=v.gl,E=this._uniformValues,k=new Float64Array(16);for(let O=0;O<Eo.cascadeCount;O++)i.ab.mat4.multiply(k,this._cascades[O].matrix,t),E[O===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(k),v.activeTexture.set(b.TEXTURE0+So.ShadowMap0+O),this._cascades[O].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const O=Eo.normalOffset;E.u_shadow_normal_offset=[1,O,O],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];a.setShadowUniformValues(v,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,a,p,v){if(v[2]>=0)return{};const b=function(O,N,$){const W=$/(1<<O.canonical.z);return new i.cd([O.canonical.x*W+O.wrap*$,O.canonical.y*W+O.wrap*$,0],[(O.canonical.x+1)*W+O.wrap*$,(O.canonical.y+1)*W+O.wrap*$,N])}(t,a,p).getCorners(),E=a/-v[2];v[0]<0?(i.ab.vec3.add(b[0],b[0],[v[0]*E,0,0]),i.ab.vec3.add(b[3],b[3],[v[0]*E,0,0])):v[0]>0&&(i.ab.vec3.add(b[1],b[1],[v[0]*E,0,0]),i.ab.vec3.add(b[2],b[2],[v[0]*E,0,0])),v[1]<0?(i.ab.vec3.add(b[0],b[0],[0,v[1]*E,0]),i.ab.vec3.add(b[1],b[1],[0,v[1]*E,0])):v[1]>0&&(i.ab.vec3.add(b[2],b[2],[0,v[1]*E,0]),i.ab.vec3.add(b[3],b[3],[0,v[1]*E,0]));const k={};return k.vertices=b,k.planes=[pl(b[1],b[0],b[4]),pl(b[2],b[1],b[5]),pl(b[3],b[2],b[6]),pl(b[0],b[3],b[7])],k}addShadowReceiver(t,a,p){this._receivers.add(t,i.cd.fromTileIdAndHeight(t,a,p))}getMaxCascadeForTile(t){const a=this._receivers.get(t);return a&&a.lastCascade?a.lastCascade:0}}function pl(h,t,a){const p=i.ab.vec3.sub([],a,t),v=i.ab.vec3.sub([],h,t),b=i.ab.vec3.cross([],p,v),E=i.ab.vec3.length(b);return E===0?[0,0,1,0]:(i.ab.vec3.scale(b,b,1/E),[b[0],b[1],b[2],-i.ab.vec3.dot(b,t)])}function Zl(h){const t=h.properties.get("direction"),a=i.cb(t.x,t.y,t.z);a[2]=i.aw(a[2],0,75);const p=i.ce([a[0],a[1],a[2]]);return i.ab.vec3.fromValues(p.x,p.y,p.z)}function Bc(h,t,a){const p=t.properties.get("color-use-theme")==="none",v=t.properties.get("color"),b=t.properties.get("intensity"),E=t.properties.get("direction"),k=[E.x,E.y,E.z],O=a.properties.get("color-use-theme")==="none",N=a.properties.get("color"),$=a.properties.get("intensity"),W=Math.max(i.ab.vec3.dot([0,0,1],k),0),Z=[0,0,0];i.ab.vec3.scale(Z,N.toRenderColor(O?null:h.getLut(t.scope)).toArray01Linear().slice(0,3),$);const Y=[0,0,0];return i.ab.vec3.scale(Y,v.toRenderColor(p?null:h.getLut(a.scope)).toArray01Linear().slice(0,3),W*b),i.cf([Z[0]>0?Z[0]/(Z[0]+Y[0]):0,Z[1]>0?Z[1]/(Z[1]+Y[1]):0,Z[2]>0?Z[2]/(Z[2]+Y[2]):0])}function Xl(h,t,a,p,v,b){const E=h.zoom,k=h.scale,O=h.worldSize,N=1/O,$=h.aspect,W=Math.sqrt(1+$*$)*Math.tan(.5*h.fovX),Z=W*W,Y=p-a,he=p+a;let ue,me;Z>Y/he?(ue=p,me=p*W):(ue=.5*he*(1+Z),me=.5*Math.sqrt(Y*Y+2*(p*p+a*a)*Z+he*he*Z*Z));const ve=h.projection.pixelsPerMeter(h.center.lat,O),Se=h._camera.getCameraToWorldMercator(),Pe=[0,0,-ue*N];i.ab.vec3.transformMat4(Pe,Pe,Se);let Me=me*N;const Fe=h._edgeInsets;if(!(Fe.left===0&&Fe.top===0&&Fe.right===0&&Fe.bottom===0||Fe.left===Fe.right&&Fe.top===Fe.bottom)){const Gt=h._camera.getWorldToCamera(h.worldSize,h.projection.zAxisUnit==="meters"?ve:1),At=h._camera.getCameraToClipPerspective(h._fov,h.width/h.height,a,p);At[8]=2*-h.centerOffset.x/h.width,At[9]=2*h.centerOffset.y/h.height;const Ct=new Float64Array(16);i.ab.mat4.mul(Ct,At,Gt);const on=new Float64Array(16);i.ab.mat4.invert(on,Ct);const Zt=i.bR.fromInvProjectionMatrix(on,O,E,!0);for(const cn of Zt.points){const mn=((De=cn)[0]/=k,De[1]/=k,De[2]=i.bH(De[2],h._center.lat),De);Me=Math.max(Me,i.ab.vec3.len(i.ab.vec3.subtract([],Pe,mn)))}}var De;Me*=v/(v-1);const Oe=Math.acos(t[2]),ze=Math.atan2(-t[0],-t[1]),Ne=new Mu;Ne.position=Pe,Ne.setPitchBearing(Oe,ze);const je=Ne.getWorldToCamera(O,ve),pt=Me*O,ot=Math.min(h._mercatorZfromZoom(17)*O*-2,-2*pt),Ve=Ne.getCameraToClipOrthographic(-pt,pt,-pt,pt,ot,(pt+b*ve)/t[2]),Je=new Float64Array(16);i.ab.mat4.multiply(Je,Ve,je);const It=i.ab.vec3.fromValues(Math.floor(1e6*Pe[0])/1e6*O,Math.floor(1e6*Pe[1])/1e6*O,0),kt=.5*v,Ht=[0,0,0];i.ab.vec3.transformMat4(Ht,It,Je),i.ab.vec3.scale(Ht,Ht,kt);const ut=[Math.floor(Ht[0]),Math.floor(Ht[1]),Math.floor(Ht[2])],Lt=[0,0,0];i.ab.vec3.sub(Lt,Ht,ut),i.ab.vec3.scale(Lt,Lt,-1/kt);const xt=new Float64Array(16);return i.ab.mat4.identity(xt),i.ab.mat4.translate(xt,xt,Lt),i.ab.mat4.multiply(Je,xt,Je),[Je,pt]}class zp extends i.E{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(t,a){return i.aM(this.requestManager.transformRequest(a,i.R.Model).url).then(p=>{if(!p)return;const v=i.aN(p),b=new i.aO(t,void 0,void 0,v);return b.computeBoundsAndApplyParent(),b}).catch(p=>{if(p&&p.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${t} from ${a}: ${p.message}`)))})}load(t,a){this.models[a]||(this.models[a]={});const p=Object.keys(t);this.numModelsLoading[a]=(this.numModelsLoading[a]||0)+p.length;const v=[];for(const b of p)v.push(this.loadModel(b,t[b]));Promise.allSettled(v).then(b=>{for(let E=0;E<b.length;E++){const{status:k,value:O}=b[E];k==="fulfilled"&&O&&(this.models[a][p[E]]={model:O,numReferences:1})}this.numModelsLoading[a]-=p.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(b=>{this.fire(new i.y(new Error(`Could not load models: ${b.message}`)))})}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,a){return!!this.getModel(t,a)}getModel(t,a){return this.models[a]||(this.models[a]={}),this.models[a][t]?this.models[a][t].model:void 0}addModel(t,a,p){this.models[p]||(this.models[p]={}),this.hasModel(t,p)&&this.models[p][t].numReferences++,this.load({[t]:this.requestManager.normalizeModelURL(a)},p)}addModels(t,a){this.models[a]||(this.models[a]={});const p={};for(const v in t)this.models[a][v]={},p[v]=this.requestManager.normalizeModelURL(t[v]);this.load(p,a)}addModelsFromBucket(t,a){this.models[a]||(this.models[a]={});const p={};for(const v of t)this.hasModel(v,a)?this.models[a][v].numReferences++:p[v]=this.requestManager.normalizeModelURL(v);this.load(p,a)}removeModel(t,a){if(this.models[a]&&this.models[a][t]&&(this.models[a][t].numReferences--,this.models[a][t].numReferences===0)){const p=this.models[a][t].model;delete this.models[a][t],p.destroy()}}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,a){this.models[a]||(this.models[a]={});for(const p in this.models[a])this.models[a][p].model&&this.models[a][p].model.upload(t.context)}}const Qf=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),yh={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Dp(h){return h=h||{},Object.assign(h,yh)}class em extends i.E{constructor(t){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=t,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(t=>{t.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=t.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=t.stylesheet.indoor.buildingFeaturesetId,this._scope=t.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:t=>(t.feature&&t.feature.properties.floorplan&&this.selectFloorplan(t.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(t){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(E,k){const[O,N]=E,{center:$,radius:W}=k,[Z,Y]=$,he=Math.abs(O-Z);return Math.sqrt((he>180?360-he:he)**2+(N-Y)**2)<=W}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const a={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=new i.P(this._map.transform.width/2,this._map.transform.height/2),v=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],b=this._map.queryRenderedFeatures(t?v:p,a);b.length>0&&(this._selectedFloorplan&&b[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=b[0],this._floorplanSelected(!1)))}_floorplanSelected(t){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(b){const[[E,k],[O,N]]=b,$=(O-E+360)%360,W=$>180?360-$:$;return{center:[(E+W/2+360)%360,(k+N)/2],radius:Math.sqrt(W**2+(N-k)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const a=this._floorplanStates[this._indoorData.id].selectedBuilding,p=this._floorplanStates[this._indoorData.id].selectedLevel;let v;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const b of this._indoorData.levels)b.id===this._selectedLevel.id&&(v=b.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:v})),a){const b=this._indoorData.buildings.find(E=>E.id===a);this._buildingSelected(b,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(p){const b=this._indoorData.levels.find(E=>E.id===p);this._updateLevels(b,t)}else t&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(t,a){a&&t&&t.extent&&this._map.fitBounds(t.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=t?t.id:void 0;const p=this._indoorData.levels.filter(v=>t.levels.includes(v.id));this.fire(new i.z("buildingselected",{buildingId:t.id,levels:p}))}_levelSelected(t){if(t==="overview")this._updateLevels(void 0,!0);else{const a=this._indoorData.levels.find(p=>p.id===t);this._updateLevels(a,!0)}this.fire(new i.z("levelselected",{levelId:t==="overview"?void 0:t}))}_updateLevels(t,a){if(!t)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(a&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function p(N){const $=N.indexOf("/floor/");if($===-1)return N;const W=$+7,Z=N.indexOf("/",W);return Z===-1?N.slice(W):N.slice(W,Z)}this._selectedLevel=t,this._floorplanStates[this._indoorData.id].selectedLevel=t?t.id:void 0;const v=[],b={},E={},k={},O={};for(const N of this._indoorData.levels)if(v.push(N.id),b[N.id]=N.height,E[N.id]=N.base,t){if(this.mergeFloors){const $=p(t.id),W=p(N.id);k[N.id]=W===$?"true":"false"}else k[N.id]=N.id===t.id?"true":"false";O[N.id]=N.base<t.base?"true":"false"}else O[N.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",v]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",b]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",k]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",O]),t&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!t.isUnderground),a&&t.extent)){const N=this._map.cameraForBounds(t.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),$=this._map.getZoom(),W=N.zoom?Math.abs($-N.zoom):0;this._map.fitBounds(t.extent,W>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:$})}}selectFloorplan(t){const a={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],v=this._map.queryRenderedFeatures(p,a);if(v.length>0){for(const b of v)if(JSON.parse(b.properties["indoor-data"]).floorplanIDs.includes(t)){this._selectedFloorplan=b,this._floorplanSelected(!0);break}}}selectBuilding(t){const a=this._indoorData.buildings.find(p=>p.id===t);this._buildingSelected(a,!0)}selectLevel(t){this._levelSelected(t)}}function tm(h){if(!h.metadata||!h.metadata.content_area)return;const t=i.q.devicePixelRatio,{left:a,top:p,width:v,height:b}=h.metadata.content_area,E=a*t,k=p*t;return[E,k,E+v*t,k+b*t]}function vh(h){if(h)return h.map(([t,a])=>[t*i.q.devicePixelRatio,a*i.q.devicePixelRatio])}const Nc=(h,t)=>it(h,t&&t.filter(a=>a.identifier!=="source.canvas")),xg=i.ay(Cr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),xa=i.ay(Cr,["setCenter","setZoom","setBearing","setPitch"]),jc=new Set(["background","sky","slot","custom"]),xh={version:8,layers:[],sources:{}},Op={duration:300,delay:0};class us extends i.E{constructor(t,a={}){super(),this.map=t,this.scope=a.scope||"",this.globalId=null,this.fragments=[],this.importDepth=a.importDepth||0,this.importsCache=a.importsCache||new Map,this.resolvedImports=a.resolvedImports||new Set,this.transition=i.l({},Op),this._buildingIndex=new Ul(this),this.crossTileSymbolIndex=new Jf,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=a.styleChanges||new zn,this.dispatcher=a.dispatcher?a.dispatcher:new i.D(i.ci(),this),a.imageManager?this.imageManager=a.imageManager:(this.imageManager=new er(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=a.glyphManager?a.glyphManager:new i.cj(t._requestManager,a.localFontFamily?i.ck.all:a.localIdeographFontFamily?i.ck.ideographs:i.ck.none,a.localFontFamily||a.localIdeographFontFamily),a.modelManager?this.modelManager=a.modelManager:(this.modelManager=new zp(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=a.configOptions?a.configOptions:new Map,this._configDependentLayers=a.configDependentLayers?a.configDependentLayers:new Set,this._config=a.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:a.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=a.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const p=this;this._rtlTextPluginCallback=us.registerForPluginStateChange(v=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(b,E)=>{if(i.cm(b),E&&E.every(k=>k))for(const k in p._sourceCaches){const O=p._sourceCaches[k],N=O.getSource().type;N!=="vector"&&N!=="geojson"||O.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const b=this.getOwnSource(v.sourceId);if(b&&b.vectorLayerIds)for(const E in this._layers){const k=this._layers[E];k.source===b.id&&this._validateLayer(k)}})}load(t){return t?(typeof t=="string"?this.loadURL(t):this.loadJSON(t),this):this}_getGlobalId(t){if(!t)return null;if(typeof t=="string"){if(i.f(t))return t;const a=i.cn(t);if(!a.startsWith("http"))try{return new URL(a,location.href).toString()}catch{return a}return a}return`json://${i.co(JSON.stringify(t))}`}_diffStyle(t,a,p){this.globalId=this._getGlobalId(t);const v=(b,E)=>{try{E(null,this.setState(b,p))}catch(k){E(k,!1)}};if(typeof t=="string"){const b=this.map._requestManager.normalizeStyleURL(t),E=this.map._requestManager.transformRequest(b,i.R.Style);i.n(E,(k,O)=>{k?this.fire(new i.y(k)):O&&v(O,a)})}else typeof t=="object"&&v(t,a)}loadURL(t,a={}){this.fire(new i.z("dataloading",{dataType:"style"}));const p=typeof a.validate=="boolean"?a.validate:!i.f(t);this.globalId=this._getGlobalId(t),t=this.map._requestManager.normalizeStyleURL(t,a.accessToken),this.resolvedImports.add(t);const v=this.importsCache.get(t);if(v)return this._load(v,p);const b=this.map._requestManager.transformRequest(t,i.R.Style);this._request=i.n(b,(E,k)=>{if(this._request=null,E)this.fire(new i.y(E));else if(k)return this.importsCache.set(t,k),this._load(k,p)})}loadJSON(t,a={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(t),this._request=i.q.frame(()=>{this._request=null,this._load(t,a.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(xh,!1)}_loadImports(t,a,p){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const v=[];for(const b of t){const E=this._createFragmentStyle(b),k=new Promise($=>{E.once("style.import.load",$),E.once("error",$)}).then(()=>this.mergeAll());if(v.push(k),this.resolvedImports.has(b.url)){E.loadEmpty();continue}const O=b.data||this.importsCache.get(b.url);O?(E.loadJSON(O,{validate:a}),this._isInternalStyle(O)&&(E.globalId=null)):b.url?E.loadURL(b.url,{validate:a}):E.loadEmpty();const N={style:E,id:b.id,config:b.config};if(p){const $=this.fragments.findIndex(({id:W})=>W===p);this.fragments=this.fragments.slice(0,$).concat(N).concat(this.fragments.slice($))}else this.fragments.push(N)}return Promise.allSettled(v)}getImportGlobalIds(t=this,a=new Set){for(const p of t.fragments)p.style.globalId&&a.add(p.style.globalId),this.getImportGlobalIds(p.style,a);return[...a.values()]}_createFragmentStyle(t){const a=this.scope?i.aC(t.id,this.scope):t.id;let p;const v=this._initialConfig&&this._initialConfig[a];(t.config||v)&&(p=i.l({},t.config,v));const b=new us(this.map,{scope:a,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,colorThemeOverride:t["color-theme"],configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(t){return this.isRootStyle()&&(t.fragment||!!t.schema&&t.fragment!==!1)}_load(t,a){const p=t.indoor?Dp(t.schema):t.schema;if(this._isInternalStyle(t)){const E=i.l({},xh,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(E,a)}if(this.updateConfig(this._config,p),a&&Nc(this,Wi(t)))return;this._loaded=!0,this.stylesheet=i.cp(t);const v=()=>{for(const N in t.sources)this.addSource(N,t.sources[N],{validate:!1,isInitialLoad:!0});t.sprite?this._loadIconset(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const E=Ra(this.stylesheet.layers);if(this._order=E.map(N=>N.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const N=this.stylesheet.lights[0];this.light=new bt(N.properties,N.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new bt(this.stylesheet.light)),this._layers={};for(const N of E){const $=i.cu(N,this.scope,this._styleColorTheme.lut,this.options);$.configDependencies.size!==0&&this._configDependentLayers.add($.fqid),$.setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$;const W=this.getOwnLayerSourceCache($),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();W&&$.canCastShadows()&&Z&&(W.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const k=this.stylesheet.terrain;k&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(k,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const O=this.isRootStyle();t.imports?this._loadImports(t.imports,a).then(()=>{this._reloadImports(),this.fire(new i.z(O?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(O?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const b=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(b){const E=this._evaluateColorThemeData(b);this._loadColorTheme(E).then(()=>{v()}).catch(k=>{i.w(`Couldn't load color theme from the stylesheet: ${k}`),v()})}else this._styleColorTheme.lut=null,v()}isRootStyle(){return this.importDepth===0}mergeAll(){let t,a,p,v,b,E,k,O,N,$;const W={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Z=>{if(Z.stylesheet){if(Z.light!=null&&(t=Z.light),Z.stylesheet.lights)for(const Y of Z.stylesheet.lights)Y.type==="ambient"&&Z.ambientLight!=null&&(a=Z.ambientLight),Y.type==="directional"&&Z.directionalLight!=null&&(p=Z.directionalLight);v=this._prioritizeTerrain(v,Z.terrain,Z.stylesheet.terrain),Z.stylesheet.fog&&Z.fog!=null&&(b=Z.fog),Z.stylesheet.snow&&Z.snow!=null&&(E=Z.snow),Z.stylesheet.rain&&Z.rain!=null&&(k=Z.rain),Z.stylesheet.camera!=null&&($=Z.stylesheet.camera),Z.stylesheet.projection!=null&&(O=Z.stylesheet.projection),Z.stylesheet.transition!=null&&(N=Z.stylesheet.transition),W[Z.scope]=Z._styleColorTheme}}),this.light=t,this.ambientLight=a,this.directionalLight=p,this.fog=b,this.snow=E,this.rain=k,this._styleColorThemeForScope=W,v===null?delete this.terrain:this.terrain=v,this.camera=$||{"camera-projection":"perspective"},this.projection=O||{name:"mercator"},this.transition=i.l({},Op,N),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const a=p=>{for(const v of p.fragments)a(v.style);t(p)};a(this)}_prioritizeTerrain(t,a,p){const v=t&&t.drapeRenderMode===0;return p===null?a&&a.drapeRenderMode===0?a:v?t:null:a!=null&&(!t||v||a&&a.drapeRenderMode===1)?a:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(a=>{t=this._prioritizeTerrain(t,a.terrain,a.stylesheet.terrain)}),t===null?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(a=>{a.stylesheet.projection!=null&&(t=a.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},a={},p={};this.forEachFragmentStyle(v=>{for(const b in v._sourceCaches){const E=i.aC(b,v.scope);t[E]=v._sourceCaches[b]}for(const b in v._otherSourceCaches){const E=i.aC(b,v.scope);a[E]=v._otherSourceCaches[b]}for(const b in v._symbolSourceCaches){const E=i.aC(b,v.scope);p[E]=v._symbolSourceCaches[b]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=a,this._mergedSymbolSourceCaches=p}mergeLayers(){const t={},a=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(b=>{for(const E of b._order){const k=b._layers[E];if(k.type==="slot"){const O=i.cq(E);if(t[O])continue;t[O]=[]}k.slot&&t[k.slot]?t[k.slot].push(k):a.push(k)}}),this._mergedOrder=[];const v=(b=[])=>{for(const E of b)if(E.type==="slot"){const k=i.cq(E.id);t[k]&&v(t[k]),this._mergedSlots.push(k)}else{const k=i.aC(E.id,E.scope);this._mergedOrder.push(k),p[k]=E,E.is3D()&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};v(a),this._mergedOrder.sort((b,E)=>{const k=p[b],O=p[E];return k.hasInitialOcclusionOpacityProperties?O.is3D()?1:0:k.is3D()&&O.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=i.l({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(t){return t.data?function(a,p,v){const b=i.l({},p);for(const k of Object.keys(i.a3.colorTheme))b[k]===void 0&&(b[k]=i.a3.colorTheme[k].default);const E=new i.a4(Qf,a,new Map(v));return E.setTransitionOrValue(b,v),E.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,t,this.options).get("data"):null}_loadColorTheme(t){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const a=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,v)=>{const b="data:image/png;base64,";if(!t||t.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let E=t;E.startsWith(b)||(E=b+E);const k="mapbox-reserved-lut",O=new Image;O.src=E,O.onerror=()=>{this._styleColorTheme.lutLoading=!1,v(new Error("Failed to load image data"))},O.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==a)return void p();this._styleColorTheme.lutLoading=!1;const{width:N,height:$,data:W}=i.q.getImageData(O);if($>32)return void v(new Error("The height of the image must be less than or equal to 32 pixels."));if(N!==$*$)return void v(new Error("The width of the image must be equal to the height squared."));this.getImage(k)&&this.removeImage(k),this.addImage(k,{data:new i.r({width:N,height:$},W),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Z=this.imageManager.getImage(k,this.scope);Z?(this._styleColorTheme.lut={image:Z.data,data:t},p()):v(new Error("Missing LUT image."))}})}getLut(t){const a=this._styleColorThemeForScope[t];return a?a.lut:null}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(a,p,v){let b,E,k;const O=i.q.devicePixelRatio>1?"@2x":"";let N=i.n(p.transformRequest(p.normalizeSpriteURL(a,O,".json"),i.R.SpriteJSON),(Z,Y)=>{N=null,k||(k=Z,b=Y,W())}),$=i.o(p.transformRequest(p.normalizeSpriteURL(a,O,".png"),i.R.SpriteImage),(Z,Y)=>{$=null,k||(k=Z,E=Y,W())});function W(){if(k)v(k);else if(b&&E){const Z=i.q.getImageData(E),Y={};for(const he in b){const{width:ue,height:me,x:ve,y:Se,sdf:Pe,pixelRatio:Me,stretchX:Fe,stretchY:De,content:Oe}=b[he],ze=new i.r({width:ue,height:me});i.r.copy(Z,ze,{x:ve,y:Se},{x:0,y:0},{width:ue,height:me},null),Y[he]={data:ze,pixelRatio:Me,sdf:Pe,stretchX:Fe,stretchY:De,content:Oe,usvg:!1}}v(null,Y)}}return{cancel(){N&&(N.cancel(),N=null),$&&($.cancel(),$=null)}}}(t,this.map._requestManager,(a,p)=>{if(this._spriteRequest=null,a)this.fire(new i.y(a));else if(p)for(const v in p)this.imageManager.addImage(v,this.scope,p[v]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(t){if(!i.f(t)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(t);const a=this.map._spriteFormat==="auto";var p,v;this._spriteRequest=(v=(b,E)=>{if(this._spriteRequest=null,b)a?this._loadSprite(t):this.fire(new i.y(b));else if(E)for(const k in E)this.imageManager.addImage(k,this.scope,E[k]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((p=this.map._requestManager).transformRequest(p.normalizeIconsetURL(t),i.R.Iconset),(b,E)=>{if(b)return void v(b);const k={},O=i.cg(new i.bh(E));for(const N of O.icons){const $={version:1,pixelRatio:i.q.devicePixelRatio,content:tm(N),stretchX:N.metadata?vh(N.metadata.stretch_x_areas):void 0,stretchY:N.metadata?vh(N.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:N};k[N.name]=$}v(null,k)}))}_validateLayer(t){const a=this.getOwnSource(t.source);if(!a)return;const p=t.sourceLayer;p&&(a.type==="geojson"||a.vectorLayerIds&&a.vectorLayerIds.indexOf(p)===-1)&&this.fire(new i.y(new Error(`Source layer "${p}" does not exist on source "${a.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,a)=>{const p=this.fragments[a];return p&&p.style&&(t.data=p.style.serialize()),t})}_serializeSources(){const t={};for(const a in this._sourceCaches){const p=this._sourceCaches[a].getSource();t[p.id]||(t[p.id]=p.serialize())}return t}_serializeLayers(t){const a=[];for(const p of t){const v=this._layers[p];v&&v.type!=="custom"&&a.push(v.serialize())}return a}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(t){return t?this.order:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&t.isDraped(this.getLayerSourceCache(t))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const a=this.getOwnLayer(t);if(a)return a;this.fire(new i.y(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const a=this.getOwnSource(t);if(a)return a;this.fire(new i.y(new Error(`The source '${t}' does not exist in the map's style.`)))}precompilePrograms(t,a){const p=this.map.painter;if(p)for(let v=t.minzoom||0;v<(t.maxzoom||25.5);v++){const b=t.getProgramIds();if(b)for(const E of b){const k=t.getDefaultProgramParams(E,a.zoom,this._styleColorTheme.lut);k&&(p.style=this,this.fog&&(p._fogVisible=!0,k.overrideFog=!0,p.getOrCreateProgram(E,k)),p._fogVisible=!1,k.overrideFog=!1,p.getOrCreateProgram(E,k),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(k.overrideRtt=!0,p.getOrCreateProgram(E,k)))}}}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const a=this.calculateLightsBrightness();t.brightness=a||0,a!==this._brightness&&(this._brightness=a,this.dispatcher.broadcast("setBrightness",a));const p=this._changes.isDirty();let v=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const k in E){const{updatedIds:O,removedIds:N}=E[k];(O||N)&&(this._updateWorkerLayers(k,O,N),v=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this.snow&&this.snow.updateTransitions(t),this.rain&&this.rain.updateTransitions(t),this._changes.reset()}const b={};for(const E in this._mergedSourceCaches){const k=this._mergedSourceCaches[E];b[E]=k.used,k.used=!1,k.tileCoverLift=0}for(const E of this._mergedOrder){const k=this._mergedLayers[E];if(k.recalculate(t,this._availableImages),!k.isHidden(t.zoom)){const O=this.getLayerSourceCache(k);O&&(O.used=!0,O.tileCoverLift=Math.max(O.tileCoverLift,k.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(k,t)}):this.precompilePrograms(k,t))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&v&&this.mergeLayers();for(const E in b){const k=this._mergedSourceCaches[E];b[E]!==k.used&&k.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:k.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.snow&&this.snow.recalculate(t),this.rain&&this.rain.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const a in this._sourceCaches)this._sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,a,p){const v=this.getFragmentStyle(t);v&&this.dispatcher.broadcast("updateLayers",{layers:a?v._serializeLayers(a):[],scope:t,removedIds:p||[],options:v.options})}setState(t,a){if(this._checkLoaded(),Nc(this,Wi(t)))return!1;(t=i.cp(t)).layers=Ra(t.layers);const p=function(E,k){if(!E)return[{command:Cr.setStyle,args:[k]}];let O=[];try{if(!i.bn(E.version,k.version))return[{command:Cr.setStyle,args:[k]}];if(i.bn(E.center,k.center)||O.push({command:Cr.setCenter,args:[k.center]}),i.bn(E.zoom,k.zoom)||O.push({command:Cr.setZoom,args:[k.zoom]}),i.bn(E.bearing,k.bearing)||O.push({command:Cr.setBearing,args:[k.bearing]}),i.bn(E.pitch,k.pitch)||O.push({command:Cr.setPitch,args:[k.pitch]}),i.bn(E.sprite,k.sprite)||O.push({command:Cr.setSprite,args:[k.sprite]}),i.bn(E.glyphs,k.glyphs)||O.push({command:Cr.setGlyphs,args:[k.glyphs]}),i.bn(E.imports,k.imports)||function(Y=[],he=[],ue){he=he||[];const me=(Y=Y||[]).map(Ur),ve=he.map(Ur),Se=Y.reduce(zr,{}),Pe=he.reduce(zr,{}),Me=me.slice();let Fe,De,Oe,ze;for(Fe=0,De=0;Fe<me.length;Fe++)Oe=me[Fe],Pe.hasOwnProperty(Oe)?De++:(ue.push({command:Cr.removeImport,args:[Oe]}),Me.splice(Me.indexOf(Oe,De),1));for(Fe=0,De=0;Fe<ve.length;Fe++)Oe=ve[ve.length-1-Fe],Me[Me.length-1-Fe]!==Oe&&(Se.hasOwnProperty(Oe)?(ue.push({command:Cr.removeImport,args:[Oe]}),Me.splice(Me.lastIndexOf(Oe,Me.length-De),1)):De++,ze=Me[Me.length-Fe],ue.push({command:Cr.addImport,args:[Pe[Oe],ze]}),Me.splice(Me.length-Fe,0,Oe));for(const Ne of he){const je=Se[Ne.id];je&&!i.bn(je,Ne)&&ue.push({command:Cr.updateImport,args:[Ne.id,Ne]})}}(E.imports,k.imports,O),i.bn(E.transition,k.transition)||O.push({command:Cr.setTransition,args:[k.transition]}),i.bn(E.light,k.light)||O.push({command:Cr.setLight,args:[k.light]}),i.bn(E.fog,k.fog)||O.push({command:Cr.setFog,args:[k.fog]}),i.bn(E.snow,k.snow)||O.push({command:Cr.setSnow,args:[k.snow]}),i.bn(E.rain,k.rain)||O.push({command:Cr.setRain,args:[k.rain]}),i.bn(E.projection,k.projection)||O.push({command:Cr.setProjection,args:[k.projection]}),i.bn(E.lights,k.lights)||O.push({command:Cr.setLights,args:[k.lights]}),i.bn(E.camera,k.camera)||O.push({command:Cr.setCamera,args:[k.camera]}),!i.bn(E["color-theme"],k["color-theme"]))return[{command:Cr.setStyle,args:[k]}];const N={},$=[];(function(Y,he,ue,me){let ve;for(ve in he=he||{},Y=Y||{})Y.hasOwnProperty(ve)&&(he.hasOwnProperty(ve)||bo(ve,ue,me));for(ve in he){if(!he.hasOwnProperty(ve))continue;const Se=he[ve];Y.hasOwnProperty(ve)?i.bn(Y[ve],Se)||(Y[ve].type==="geojson"&&Se.type==="geojson"&&Lc(Y,he,ve)?ue.push({command:Cr.setGeoJSONSourceData,args:[ve,Se.data]}):kp(ve,he,ue,me)):$l(ve,he,ue)}})(E.sources,k.sources,$,N);const W=[];E.layers&&E.layers.forEach(Y=>{Y.source&&N[Y.source]?O.push({command:Cr.removeLayer,args:[Y.id]}):W.push(Y)});let Z=E.terrain;Z&&N[Z.source]&&(O.push({command:Cr.setTerrain,args:[void 0]}),Z=void 0),O=O.concat($),i.bn(Z,k.terrain)||O.push({command:Cr.setTerrain,args:[k.terrain]}),function(Y,he,ue){he=he||[];const me=(Y=Y||[]).map(Ur),ve=he.map(Ur),Se=Y.reduce(zr,{}),Pe=he.reduce(zr,{}),Me=me.slice(),Fe=Object.create(null);let De,Oe,ze,Ne,je,pt,ot;for(De=0,Oe=0;De<me.length;De++)ze=me[De],Pe.hasOwnProperty(ze)?Oe++:(ue.push({command:Cr.removeLayer,args:[ze]}),Me.splice(Me.indexOf(ze,Oe),1));for(De=0,Oe=0;De<ve.length;De++)ze=ve[ve.length-1-De],Me[Me.length-1-De]!==ze&&(Se.hasOwnProperty(ze)?(ue.push({command:Cr.removeLayer,args:[ze]}),Me.splice(Me.lastIndexOf(ze,Me.length-Oe),1)):Oe++,pt=Me[Me.length-De],ue.push({command:Cr.addLayer,args:[Pe[ze],pt]}),Me.splice(Me.length-De,0,ze),Fe[ze]=!0);for(De=0;De<ve.length;De++)if(ze=ve[De],Ne=Se[ze],je=Pe[ze],!Fe[ze]&&!i.bn(Ne,je))if(i.bn(Ne.source,je.source)&&i.bn(Ne["source-layer"],je["source-layer"])&&i.bn(Ne.type,je.type)){for(ot in fn(Ne.layout,je.layout,ue,ze,null,Cr.setLayoutProperty),fn(Ne.paint,je.paint,ue,ze,null,Cr.setPaintProperty),i.bn(Ne.slot,je.slot)||ue.push({command:Cr.setSlot,args:[ze,je.slot]}),i.bn(Ne.filter,je.filter)||ue.push({command:Cr.setFilter,args:[ze,je.filter]}),i.bn(Ne.minzoom,je.minzoom)&&i.bn(Ne.maxzoom,je.maxzoom)||ue.push({command:Cr.setLayerZoomRange,args:[ze,je.minzoom,je.maxzoom]}),Ne)Ne.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&ot!=="slot"&&(ot.indexOf("paint.")===0?fn(Ne[ot],je[ot],ue,ze,ot.slice(6),Cr.setPaintProperty):i.bn(Ne[ot],je[ot])||ue.push({command:Cr.setLayerProperty,args:[ze,ot,je[ot]]}));for(ot in je)je.hasOwnProperty(ot)&&!Ne.hasOwnProperty(ot)&&ot!=="layout"&&ot!=="paint"&&ot!=="filter"&&ot!=="metadata"&&ot!=="minzoom"&&ot!=="maxzoom"&&ot!=="slot"&&(ot.indexOf("paint.")===0?fn(Ne[ot],je[ot],ue,ze,ot.slice(6),Cr.setPaintProperty):i.bn(Ne[ot],je[ot])||ue.push({command:Cr.setLayerProperty,args:[ze,ot,je[ot]]}))}else ue.push({command:Cr.removeLayer,args:[ze]}),pt=Me[Me.lastIndexOf(ze)+1],ue.push({command:Cr.addLayer,args:[je,pt]})}(W,k.layers,O)}catch(N){console.warn("Unable to compute style diff:",N),O=[{command:Cr.setStyle,args:[k]}]}return O}(this.serialize(),t).filter(E=>!(E.command in xa));if(p.length===0)return!1;const v=p.filter(E=>!(E.command in xg));if(v.length>0)throw new Error(`Unimplemented: ${v.map(E=>E.command).join(", ")}.`);const b=[];return p.forEach(E=>{b.push(this[E.command].apply(this,E.args))}),a&&Promise.all(b).then(a),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,a){return this.getImage(t)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,a),this._afterImageUpdated(t),this)}updateImage(t,a,p=!1){this.imageManager.updateImage(t,this.scope,a),p&&this._afterImageUpdated(t)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,a,p={}){return this._checkLoaded(),this._validate(tt,`models.${t}`,a,null,p)||(this.modelManager.addModel(t,a,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,a,p={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(ai,`sources.${t}`,a,null,p))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const v=Pp(t,a,this.dispatcher,this);v.scope=this.scope,v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(v.id),source:v.serialize(),sourceId:v.id}));const b=E=>{const k=(E?"symbol:":"other:")+v.id,O=i.aC(k,this.scope),N=this._sourceCaches[k]=new Bs(O,v,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[v.id]=N,N.onAdd(this.map)};b(!1),a.type!=="vector"&&a.type!=="geojson"||b(!0),v.onAdd&&v.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const a=this.getOwnSource(t);if(!a)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===t)return this.fire(new i.y(new Error(`Source "${t}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new i.y(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(t);for(const v of p){const b=i.cq(v.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(v.id),v.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),a.setEventedParent(null),a.onRemove&&a.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,a){this._checkLoaded(),this.getOwnSource(t).setData(a),this._changes.setDirty()}getOwnSource(t){const a=this.getOwnSourceCache(t);return a&&a.getSource()}getOwnSources(){const t=[];for(const a in this._otherSourceCaches){const p=this.getOwnSourceCache(a);p&&t.push(p.getSource())}return t}areTilesLoaded(){const t=this._mergedSourceCaches;for(const a in t){const p=t[a]._tiles;for(const v in p){const b=p[v];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const a=this._getTransitionParameters();for(const v of t){if(this._validate(ia,"lights",v))return;switch(v.type){case"ambient":if(this.ambientLight){const b=this.ambientLight;b.set(v),b.updateTransitions(a)}else this.ambientLight=new no(v,Hr||(Hr=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const b=this.directionalLight;b.set(v),b.updateTransitions(a)}else this.directionalLight=new no(v,Xr||(Xr=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new i.a8(this.z||0,a);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,a=this.ambientLight;if(!t||!a)return;const p=Z=>.2126*(Z[0]<=.03928?Z[0]/12.92:Math.pow((Z[0]+.055)/1.055,2.4))+.7152*(Z[1]<=.03928?Z[1]/12.92:Math.pow((Z[1]+.055)/1.055,2.4))+.0722*(Z[2]<=.03928?Z[2]/12.92:Math.pow((Z[2]+.055)/1.055,2.4)),v=t.properties.get("color").toRenderColor(null).toArray01(),b=t.properties.get("intensity"),E=t.properties.get("direction"),k=1-i.cb(E.x,E.y,E.z)[2]/90,O=p(v)*b*k,N=a.properties.get("color").toRenderColor(null).toArray01(),$=a.properties.get("intensity"),W=p(N)*$;return Number(((O+W)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(i.cr(t)){const a=i.cs(t),p=this.fragments.find(({id:b})=>b===a);if(!p)throw new Error(`Style import '${t}' not found`);const v=i.cq(t);return p.style.getFragmentStyle(v)}{const a=this.fragments.find(({id:p})=>p===t);if(!a)throw new Error(`Style import '${t}' not found`);return a.style}}setFeaturesetSelectors(t){if(!t)return;const a={},p=(v,b="")=>`${v}::${b}`;this.featuresetSelectors={};for(const v in t){const b=this.featuresetSelectors[v]=[];for(const E of t[v].selectors){if(E.featureNamespace){const O=this.getOwnLayer(E.layer);if(!O){i.w(`Layer is undefined for selector: ${E.layer}`);continue}const N=p(O.source,O.sourceLayer);if(N in a&&a[N]!==E.featureNamespace){i.w(`"featureNamespace ${E.featureNamespace} of featureset ${v}'s selector is not associated to the same source, skip this selector`);continue}a[N]=E.featureNamespace}let k;if(E.properties)for(const O in E.properties){const N=i.U(E.properties[O]);N.result==="success"&&(k=k||{},k[O]=N.value)}b.push({layerId:E.layer,namespace:E.featureNamespace,properties:k})}}}getFeaturesetDescriptors(t){const a=this.getFragmentStyle(t);if(!a||!a.stylesheet.featuresets)return[];const p=[];for(const v in a.stylesheet.featuresets)p.push({featuresetId:v,importId:a.scope?a.scope:void 0});return p}getFeaturesetLayers(t,a){const p=this.getFragmentStyle(a),v=p.stylesheet.featuresets;if(!v||!v[t])return this.fire(new i.y(new Error(`The featureset '${t}' does not exist in the map's style and cannot be queried.`))),[];const b=[];for(const E of v[t].selectors){const k=p.getOwnLayer(E.layer);k&&b.push(k)}return b}getConfigProperty(t,a){const p=this.getFragmentStyle(t);if(!p)return null;const v=i.aC(a,p.scope),b=p.options.get(v),E=b?b.value||b.default:null;return E?E.serialize():null}setConfigProperty(t,a,p){const v=this.getFragmentStyle(t);if(!v)return;const b=v.stylesheet.indoor?Dp(v.stylesheet.schema):v.stylesheet.schema;if(!b||!b[a])return;const E=i.U(p);if(E.result!=="success")return void Nc(this,E.value);const k=E.value.expression,O=i.aC(a,v.scope),N=v.options.get(O);if(!N)return;let $;const{minValue:W,maxValue:Z,stepValue:Y,type:he,values:ue}=b[a],me=i.U(b[a].default);me.result==="success"&&($=me.value.expression),$?(this.options.set(O,{...N,value:k,default:$,minValue:W,maxValue:Z,stepValue:Y,type:he,values:ue}),this.updateConfigDependencies(a)):this.fire(new i.y(new Error(`No schema defined for the config option "${a}" in the "${t}" fragment.`)))}getConfig(t){const a=this.getFragmentStyle(t);if(!a)return null;const p=a.stylesheet.schema;if(!p)return null;const v={};for(const b in p){const E=i.aC(b,a.scope),k=a.options.get(E),O=k?k.value||k.default:null;v[b]=O?O.serialize():null}return v}setConfig(t,a){const p=this.getFragmentStyle(t);p&&(p.updateConfig(a,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(t){const a=this.getFragmentStyle(t);return a?a.stylesheet.schema:null}setSchema(t,a){const p=this.getFragmentStyle(t);p&&(p.stylesheet.schema=a,p.updateConfig(p._config,a),this.updateConfigDependencies())}updateConfig(t,a){if(this._config=t,t||a)if(a)for(const p in a){let v,b;const E=i.U(a[p].default);if(E.result==="success"&&(v=E.value.expression),t&&t[p]!==void 0){const Z=i.U(t[p]);Z.result==="success"&&(b=Z.value.expression)}const{minValue:k,maxValue:O,stepValue:N,type:$,values:W}=a[p];if(v){const Z=i.aC(p,this.scope);this.options.set(Z,{default:v,value:b,minValue:k,maxValue:O,stepValue:N,type:$,values:W})}else this.fire(new i.y(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(t){for(const a of this._configDependentLayers){const p=this.getLayer(a);if(p){if(t&&!p.configDependencies.has(t))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(a=>{const p=a._styleColorTheme.colorThemeOverride?a._styleColorTheme.colorThemeOverride:a._styleColorTheme.colorTheme;if(p){const v=a._evaluateColorThemeData(p);(!a._styleColorTheme.lut&&v!==""||a._styleColorTheme.lut&&v!==a._styleColorTheme.lut.data)&&a.setColorTheme(p)}}),this._changes.setDirty()}addLayer(t,a,p={}){this._checkLoaded();const v=t.id;if(this._layers[v])return void this.fire(new i.y(new Error(`Layer with id "${v}" already exists on this map`)));let b;if(t.type==="custom"){if(Nc(this,i.ct(t)))return;b=i.cu(t,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof t.source=="object"&&(this.addSource(v,t.source),t=i.cp(t),t=i.l(t,{source:v})),this._validate(be,`layers.${v}`,t,{arrayIndex:-1},p))return;b=i.cu(t,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:v}})}b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid);let E=this._order.length;if(a){const $=this._order.indexOf(a);if($===-1)return void this.fire(new i.y(new Error(`Layer with id "${a}" does not exist on this map.`)));b.slot===this._layers[a].slot?E=$:i.w(`Layer with id "${a}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,v),this._layerOrderChanged=!0,this._layers[v]=b;const k=this.getOwnLayerSourceCache(b),O=!!this.directionalLight&&this.directionalLight.shadowsEnabled();k&&b.canCastShadows()&&O&&(k.castsShadows=!0);const N=this._changes.getRemovedLayer(b);if(N&&b.source&&k&&b.type!=="custom"){this._changes.discardLayerRemoval(b);const $=i.aC(b.source,b.scope);N.type!==b.type?this._changes.updateSourceCache($,"clear"):(this._changes.updateSourceCache($,"reload"),k.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(t,a){this._checkLoaded();const p=this._checkLayer(t);if(!p||t===a)return;const v=this._order.indexOf(t);this._order.splice(v,1);let b=this._order.length;if(a){const E=this._order.indexOf(a);if(E===-1)return void this.fire(new i.y(new Error(`Layer with id "${a}" does not exist on this map.`)));p.slot===this._layers[a].slot?b=E:i.w(`Layer with id "${a}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const a=this._checkLayer(t);if(!a)return;a.setEventedParent(null);const p=this._order.indexOf(t);this._order.splice(p,1),delete this._layers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(a.fqid),this._changes.removeLayer(a);const v=this.getOwnLayerSourceCache(a);if(v&&v.castsShadows){let b=!1;for(const E in this._layers)if(this._layers[E].source===a.source&&this._layers[E].canCastShadows()){b=!0;break}v.castsShadows=b}a.onRemove&&a.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const a in this._layers)if(this._layers[a].type===t)return!0;return!1}setLayerZoomRange(t,a,p){this._checkLoaded();const v=this._checkLayer(t);v&&(v.minzoom===a&&v.maxzoom===p||(a!=null&&(v.minzoom=a),p!=null&&(v.maxzoom=p),this._updateLayer(v)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(t,a){this._checkLoaded();const p=this._checkLayer(t);p&&p.slot!==a&&(p.slot=a,this._updateLayer(p))}setFilter(t,a,p={}){this._checkLoaded();const v=this._checkLayer(t);if(v&&!i.bn(v.filter,a))return a==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(Re,`layers.${v.id}.filter`,a,{layerType:v.type},p)||(v.filter=i.cp(a),this._updateLayer(v)))}getFilter(t){const a=this._checkLayer(t);if(a)return i.cp(a.filter)}setLayoutProperty(t,a,p,v={}){this._checkLoaded();const b=this._checkLayer(t);if(b&&!i.bn(b.getLayoutProperty(a),p)){if(p!=null&&(!v||v.validate!==!1)&&Nc(b,We.call(Wi,{key:`layers.${t}.layout.${a}`,layerType:b.type,objectKey:a,value:p,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(a,p),b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(t,a){const p=this._checkLayer(t);if(p)return p.getLayoutProperty(a)}setPaintProperty(t,a,p,v={}){this._checkLoaded();const b=this._checkLayer(t);if(!b||i.bn(b.getPaintProperty(a),p)||p!=null&&(!v||v.validate!==!1)&&Nc(b,qe.call(Wi,{key:`layers.${t}.paint.${a}`,layerType:b.type,objectKey:a,value:p,styleSpec:i.a3})))return;const E=b.setPaintProperty(a,p);b.configDependencies.size!==0&&this._configDependentLayers.add(b.fqid),E&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(t,a){const p=this._checkLayer(t);if(p)return p.getPaintProperty(a)}setFeatureState(t,a){if(this._checkLoaded(),"target"in t){if("featuresetId"in t.target){const{featuresetId:O,importId:N}=t.target,$=this.getFragmentStyle(N),W=$.getFeaturesetLayers(O);for(const{source:Z,sourceLayer:Y}of W)$.setFeatureState({id:t.id,source:Z,sourceLayer:Y},a)}else if("layerId"in t.target){const{layerId:O}=t.target,N=this.getLayer(O);this.setFeatureState({id:t.id,source:N.source,sourceLayer:N.sourceLayer},a)}return}const p=t.source,v=t.sourceLayer,b=this._checkSource(p);if(!b)return;const E=b.type;if(E==="geojson"&&v)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!v)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const k=this.getOwnSourceCaches(p);for(const O of k)O.setFeatureState(v,t.id,a)}removeFeatureState(t,a){if(this._checkLoaded(),"target"in t){if("featuresetId"in t.target){const{featuresetId:O,importId:N}=t.target,$=this.getFragmentStyle(N),W=$.getFeaturesetLayers(O);for(const{source:Z,sourceLayer:Y}of W)$.removeFeatureState({id:t.id,source:Z,sourceLayer:Y},a)}else if("layerId"in t.target){const{layerId:O}=t.target,N=this.getLayer(O);this.removeFeatureState({id:t.id,source:N.source,sourceLayer:N.sourceLayer},a)}return}const p=t.source,v=this._checkSource(p);if(!v)return;const b=v.type,E=b==="vector"?t.sourceLayer:void 0;if(b==="vector"&&!E)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(a&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const k=this.getOwnSourceCaches(p);for(const O of k)O.removeFeatureState(E,t.id,a)}getFeatureState(t){if(this._checkLoaded(),"target"in t){let b;if("featuresetId"in t.target){const{featuresetId:E,importId:k}=t.target,O=this.getFragmentStyle(k),N=O.getFeaturesetLayers(E);for(const{source:$,sourceLayer:W}of N){const Z=O.getFeatureState({id:t.id,source:$,sourceLayer:W});if(Z&&!b)b=Z;else if(!i.bn(b,Z))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in t.target){const{layerId:E}=t.target,k=this.getLayer(E);b=this.getFeatureState({id:t.id,source:k.source,sourceLayer:k.sourceLayer})}return b}const a=t.source,p=t.sourceLayer,v=this._checkSource(a);if(v){if(v.type!=="vector"||p)return t.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(a)[0].getFeatureState(p,t.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=i.l({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),a=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:a,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(t){for(const a of Object.values(this._mergedLayers))t(a)&&this._updateLayer(a)}_updateLayer(t){this._changes.updateLayer(t);const a=this.getLayerSourceCache(t),p=i.aC(t.source,t.scope),v=this._changes.getUpdatedSourceCaches();t.source&&!v[p]&&a&&a.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),a.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const a=k=>this._mergedLayers[k].is3D(),p=this.order,v={},b=[];for(let k=p.length-1;k>=0;k--){const O=p[k];if(a(O)){v[O]=k;for(const N of t){const $=N[O];if($)for(const W of $)b.push(W)}}}b.sort((k,O)=>O.intersectionZ-k.intersectionZ);const E=[];for(let k=p.length-1;k>=0;k--){const O=p[k];if(a(O))for(let N=b.length-1;N>=0;N--){const $=b[N].feature;if($.layer&&v[$.layer.id]<k)break;E.push($),b.pop()}else for(const N of t){const $=N[O];if($)for(const W of $)E.push(W.feature)}}return E}queryRenderedFeatures(t,a,p){let v;a&&!Array.isArray(a)&&a.filter&&(this._validate(Re,"queryRenderedFeatures.filter",a.filter,null,a),v=i.aZ(a.filter));const b={},E=$=>{if(jc.has($.type))return;const W=this.getOwnLayerSourceCache($),Z=b[W.id]=b[W.id]||{sourceCache:W,layers:{},has3DLayers:!1};$.is3D()&&(Z.has3DLayers=!0),Z.layers[$.fqid]=Z.layers[$.fqid]||{styleLayer:$,targets:[]},Z.layers[$.fqid].targets.push({filter:v})};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const $ of a.layers){const W=this._layers[$];if(!W)return this.fire(new i.y(new Error(`The layer '${$}' does not exist in the map's style and cannot be queried for features.`))),[];E(W)}}else for(const $ in this._layers)E(this._layers[$]);const k=this._queryRenderedFeatures(t,b,p),O=this._flattenAndSortRenderedFeatures(k),N=[];for(const $ of O)i.cs($.layer.id)===this.scope&&N.push($);return N}queryRenderedFeatureset(t,a,p){let v;a&&!Array.isArray(a)&&a.filter&&(this._validate(Re,"queryRenderedFeatures.filter",a.filter,null,a),v=i.aZ(a.filter));const b="mock",E=[];if(a&&a.target)E.push({...a,targetId:b,filter:v});else{const N=this.getFeaturesetDescriptors();for(const $ of N)E.push({targetId:b,filter:v,target:$});for(const{style:$}of this.fragments){const W=$.getFeaturesetDescriptors();for(const Z of W)E.push({targetId:b,filter:v,target:Z})}}const k=this.queryRenderedTargets(t,E,p),O=[];for(const N of k)for(const $ of N.variants[b])O.push(new i.cw(N,$));return O}queryRenderedTargets(t,a,p){const v={},b=(k,O,N,$)=>{const W=v[O.id]=v[O.id]||{sourceCache:O,layers:{},has3DLayers:!1};W.layers[k.fqid]=W.layers[k.fqid]||{styleLayer:k,targets:[]},k.is3D()&&(W.has3DLayers=!0),W.layers[k.fqid].targets.push($?{...N,namespace:$.namespace,properties:$.properties}:N)};for(const k of a)if("featuresetId"in k.target){const{featuresetId:O,importId:N}=k.target,$=this.getFragmentStyle(N),W=$.featuresetSelectors[O];if(!W){this.fire(new i.y(new Error(`The featureset '${O}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Z of W){const Y=$.getOwnLayer(Z.layerId);Y&&!jc.has(Y.type)&&b(Y,$.getOwnLayerSourceCache(Y),k,Z)}}else if("layerId"in k.target){const{layerId:O}=k.target,N=this.getLayer(O);if(!N||jc.has(N.type))continue;b(N,this.getLayerSourceCache(N),k)}const E=this._queryRenderedFeatures(t,v,p);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(t,a,p){const v=[],b=!!this.map._showQueryGeometry,E=go.createFromScreenPoints(t,p);for(const k in a){const O=dd(E,a[k],this._availableImages,p,b);Object.keys(O).length&&v.push(O)}if(this.placement)for(const k in a){if(!a[k].sourceCache._onlySymbols)continue;const O=Ac(E.screenGeometry,a[k],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(O).length&&v.push(O)}return v}querySourceFeatures(t,a){const p=a&&a.filter;p&&this._validate(Re,"querySourceFeatures.filter",p,null,a);let v=[];const b=this.getOwnSourceCaches(t);for(const E of b)v=v.concat(cl(E,a));return v}addSourceType(t,a,p){return us.getSourceType(t)?p(new Error(`A source type called "${t}" already exists.`)):(us.setSourceType(t,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:a.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,a,p={}){this._checkLoaded();const v=this.light.getLight();let b=!1;for(const k in t)if(!i.bn(t[k],v[k])){b=!0;break}if(!b)return;const E=this._getTransitionParameters();this.light.setLight(t,a,p),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(t,a=1){if(this._checkLoaded(),!t)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),a===0&&delete this.terrain,t===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=t;const v=t.source==null;if(a===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const k="terrain-dem-src";this.addSource(k,p.source),p=i.cp(p),p=i.l(p,{source:k})}const b=i.l({},p),E={};if(this.terrain&&v){b.source=this.terrain.get().source;const k=this.terrain?this.getFragmentStyle(this.terrain.scope):null;k&&(E.style=k.serialize())}if(this._validate(vs,"terrain",b,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!v||this.terrain&&a!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,a),this.fire(new i.z("data",{dataType:"style"}))}else{const b=this.terrain,E=b.get();for(const k of Object.keys(i.a3.terrain))!p.hasOwnProperty(k)&&i.a3.terrain[k].default&&(p[k]=i.a3.terrain[k].default);for(const k in t)if(!i.bn(t[k],E[k])){b.set(t,this.options),this.stylesheet.terrain=t;const O=this._getTransitionParameters({duration:0});b.updateTransitions(O),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const a=this.fog=new Wr(t,this.map.transform,this.scope,this.options);this.stylesheet.fog=a.get();const p=this._getTransitionParameters({duration:0});a.updateTransitions(p)}_createSnow(t){const a=this.snow=new Vr(t,this.map.transform,this.scope,this.options);this.stylesheet.snow=a.get();const p=this._getTransitionParameters({duration:0});a.updateTransitions(p)}_createRain(t){const a=this.rain=new Yo(t,this.map.transform,this.scope,this.options);this.stylesheet.rain=a.get();const p=this._getTransitionParameters({duration:0});a.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const a=this.fog;if(!i.bn(a.get(),t)){a.set(t,this.options),this.stylesheet.fog=a.get();const p=this._getTransitionParameters({duration:0});a.updateTransitions(p)}}else this._createFog(t);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(t){if(this._checkLoaded(),!t)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const a=this.snow;if(!i.bn(a.get(),t)){a.set(t,this.options),this.stylesheet.snow=a.get();const p=this._getTransitionParameters({duration:0});a.updateTransitions(p)}}else this._createSnow(t);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(t){if(this._checkLoaded(),!t)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const a=this.rain;if(!i.bn(a.get(),t)){a.set(t,this.options),this.stylesheet.rain=a.get();const p=this._getTransitionParameters({duration:0});a.updateTransitions(p)}}else this._createRain(t);this._markersNeedUpdate=!0}_reloadColorTheme(){const t=()=>{for(const v in this._layers)this._layers[v].lut=this._styleColorTheme.lut;for(const v in this._sourceCaches)this._sourceCaches[v].clearTiles()},a=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!a)return this._styleColorTheme.lut=null,void t();const p=this._evaluateColorThemeData(a);this._loadColorTheme(p).then(()=>{this.fire(new i.z("colorthemeset")),t()}).catch(v=>{i.w(`Couldn't set color theme: ${v}`)})}setColorTheme(t){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=t,this._reloadColorTheme()}setImportColorTheme(t,a){const p=this.getFragmentStyle(t);p&&(p._styleColorTheme.colorThemeOverride=a,p._reloadColorTheme())}_getTransitionParameters(t){return{now:i.q.now(),transition:i.l(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],a=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?t.push(p):a.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...a)}_createTerrain(t,a){const p=this.terrain=new Et(t,a,this.scope,this.options);a===1&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const v=this._getTransitionParameters({duration:0});p.updateTransitions(v)}_force3DLayerUpdate(){for(const t in this._layers){const a=this._layers[t];a.type==="fill-extrusion"&&this._updateLayer(a)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const a=this._layers[t];a.type==="symbol"&&this._updateLayer(a)}}_validate(t,a,p,v,b={}){if(b&&b.validate===!1)return!1;const E=i.l({},this.serialize());return Nc(this,t.call(Wi,i.l({key:a,style:E,value:p,styleSpec:i.a3},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const a=this.getSourceCaches(t);for(const p of a)p.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const a=this.getSourceCaches(t);for(const p of a)p.resume(),p.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let a;this.directionalLight&&(a=Zl(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(t,void 0,void 0,a)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const a=this._sourceCaches[t];a.resume(),a.reload()}}_updatePlacement(t,a,p,v,b,E,k=!1){let O=!1,N=!1;const $={},W={};for(const Z of this._mergedOrder){const Y=this._mergedLayers[Z];if(Y.type!=="symbol")continue;const he=i.aC(Y.source,Y.scope);let ue=$[he];if(!ue){const ve=this.getLayerSourceCache(Y);if(!ve)continue;const Se=ve.getRenderableIds(!0).map(Pe=>ve.getTileByID(Pe));W[he]=Se.slice(),ue=$[he]=Se.sort((Pe,Me)=>Me.tileID.overscaledZ-Pe.tileID.overscaledZ||(Pe.tileID.isLessThan(Me.tileID)?-1:1))}const me=this.crossTileSymbolIndex.addLayer(Y,ue,a.center.lng,a.projection);O=O||me}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),k=k||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(k||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),a.zoom))&&(this.pauseablePlacement=new Eu(a,this._mergedOrder,k,p,v,b,this.placement,this.fog&&a.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,$,W,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),N=!0),O&&this.pauseablePlacement.placement.setStale()),N||O){this._buildingIndex.onNewFrame(a.zoom);for(let Z=0;Z<this._mergedOrder.length;Z++){const Y=this._mergedLayers[this._mergedOrder[Z]];if(Y.type!=="symbol")continue;const he=this.isLayerClipped(Y);this.placement.updateLayerOpacities(Y,$[i.aC(Y.source,Y.scope)],Z,he?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t,a){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:b})=>b===t.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${t.id}' already exists in the map's style.`)));if(!a)return p.push(t),this._loadImports([t],!0);const v=p.findIndex(({id:b})=>b===a);return v===-1&&this.fire(new i.y(new Error(`Import with id "${a}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,v).concat(t).concat(p.slice(v)),this._loadImports([t],!0,a)}updateImport(t,a){this._checkLoaded();const p=this.stylesheet.imports||[],v=this.getImportIndex(t);return v===-1?this:typeof a=="string"?(this.setImportUrl(t,a),this):(a.url&&a.url!==p[v].url&&this.setImportUrl(t,a.url),i.bn(a.config,p[v].config)||this.setImportConfig(t,a.config),i.bn(a.data,p[v].data)||this.setImportData(t,a.data),this)}moveImport(t,a){this._checkLoaded();let p=this.stylesheet.imports||[];const v=this.getImportIndex(t);if(v===-1)return this;const b=this.getImportIndex(a);if(b===-1)return this;const E=p[v],k=this.fragments[v];return p=p.filter(({id:O})=>O!==t),this.fragments=this.fragments.filter(({id:O})=>O!==t),this.stylesheet.imports=p.slice(0,b).concat(E).concat(p.slice(b)),this.fragments=this.fragments.slice(0,b).concat(k).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(t,a){this._checkLoaded();const p=this.stylesheet.imports||[],v=this.getImportIndex(t);if(v===-1)return this;p[v].url=a;const b=this.fragments[v];return b.style=this._createFragmentStyle(p[v]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(a),this}setImportData(t,a){this._checkLoaded();const p=this.getImportIndex(t),v=this.stylesheet.imports||[];return p===-1?this:a?(this.fragments[p].style.setState(a),this._reloadImports(),this):(delete v[p].data,this.setImportUrl(t,v[p].url))}setImportConfig(t,a){this._checkLoaded();const p=this.getImportIndex(t),v=this.stylesheet.imports||[];if(p===-1)return this;a?v[p].config=a:delete v[p].config;const b=this.fragments[p],E=b.style.stylesheet&&b.style.stylesheet.schema;return b.config=a,b.style.updateConfig(a,E),this.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const a=this.stylesheet.imports||[],p=this.getImportIndex(t);p!==-1&&(a.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(t){const a=(this.stylesheet.imports||[]).findIndex(p=>p.id===t);return a===-1&&this.fire(new i.y(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),a}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const a in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[a];p&&t.push(p.getSource())}return t}getSource(t,a){const p=this.getSourceCache(t,a);return p&&p.getSource()}getLayerSource(t){const a=this.getLayerSourceCache(t);return a&&a.getSource()}getSourceCache(t,a){const p=i.aC(t,a);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(t){const a=i.aC(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[a]:this._mergedOtherSourceCaches[a]}getSourceCaches(t){if(t==null)return Object.values(this._mergedSourceCaches);const a=[];return this._mergedOtherSourceCaches[t]&&a.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&a.push(this._mergedSymbolSourceCaches[t]),a}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const a in t){const p=t[a];p==="reload"?this.reloadSource(a):p==="clear"&&this.clearSource(a)}}updateLayers(t){const a=this._changes.getUpdatedPaintProperties();for(const p of a){const v=this.getLayer(p);v&&v.updateTransitions(t)}}getImages(t,a,p){this.imageManager.getImages(a.icons,a.scope,p),this._updateTilesForChangedImages();const v=b=>{b&&b.setDependencies(a.tileID.key,a.type,a.icons)};v(this._otherSourceCaches[a.source]),v(this._symbolSourceCaches[a.source])}rasterizeImages(t,a,p){this.imageManager.rasterizeImages(a,p)}getGlyphs(t,a,p){this.glyphManager.getGlyphs(a.stacks,a.scope,p)}getResource(t,a,p){return i.cy(a,p)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const a=[];return this._otherSourceCaches[t]&&a.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&a.push(this._symbolSourceCaches[t]),a}_isSourceCacheLoaded(t){const a=this.getOwnSourceCaches(t);return a.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${t}'`))),!1):a.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(t,a){if(!this._clipLayerPresent&&t.type!=="fill-extrusion")return!1;const p=t.type==="fill-extrusion"&&t.sourceLayer==="building";if(t.is3D()){if(p||a&&a.type==="batched-model"||t.type==="model")return!0}else if(t.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(t=>{t.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}us.getSourceType=function(h){return Ic[h]},us.setSourceType=function(h,t){Ic[h]=t},us.registerForPluginStateChange=i.ch;var Fp=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,vd=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,bh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,xd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",fl=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Fa=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Yl=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,bd=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Kl=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,ml=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Ba=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const gl=[];Ua(Fp,gl),Ua(bh,gl),Ua(vd,gl);const Na={"_prelude_fog.vertex.glsl":Fa,"_prelude_terrain.vertex.glsl":fl,"_prelude_shadow.vertex.glsl":ml,"_prelude_fog.fragment.glsl":Yl,"_prelude_shadow.fragment.glsl":Ba,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":bd,"_prelude_raster_particle.glsl":Kl},ja={};Tr("",fl),Tr(Yl,Fa),Tr(Ba,ml),Tr(bd,""),Tr(Kl,"");const wd=Tr(vd,bh),wh=Fp;var Sd={background:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Tr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Tr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Tr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Tr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Tr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Tr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Tr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Tr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Tr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Tr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec2 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
halfwidth=(u_width_scale*a_z_offset_width.y)/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec2 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Tr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Tr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Tr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Tr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Tr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Tr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,xd),skyboxGradient:Tr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,xd),skyboxCapture:Tr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Tr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Tr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Tr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Tr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Tr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Tr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Tr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Tr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ua(h,t){const a=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of a)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=p.split(" ");for(const b of v)t.includes(b)||t.push(b)}}function Tr(h,t){const a=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let v=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);v&&(v=v.map(N=>{const $=N.split(" ");return $[$.length-1]}),v=[...new Set(v)]);const b={},E=[],k=[];if(h=h.replace(a,(N,$)=>(k.push($),"")),(t=t.replace(a,(N,$)=>(E.push($),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let O=[...gl];Ua(h,O),Ua(t,O);for(const N of[...E,...k])Na[N]||console.error(`Undefined include: ${N}`),ja[N]||(ja[N]=[],Ua(Na[N],ja[N])),O=[...O,...ja[N]];return{fragmentSource:h=h.replace(p,(N,$,W,Z,Y)=>(b[Y]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
in ${W} ${Z} ${Y};
#else
uniform ${W} ${Z} u_${Y};
#endif
`:$==="initialize"?`
#ifdef HAS_UNIFORM_u_${Y}
    ${W} ${Z} ${Y} = u_${Y};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    in ${W} ${Z} ${Y};
#endif
`:$==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(p,(N,$,W,Z,Y)=>{const he=Z==="float"?"vec2":Z,ue=Y.match(/color/)?"color":he;return $==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
in ${W} ${Z} a_${Y};
#endif
`:b[Y]?$==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${W} ${he} a_${Y};
out ${W} ${Z} ${Y};
#else
uniform ${W} ${Z} u_${Y};
#endif
`:$==="initialize"?ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${W} ${Z} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${ue}(a_${Y}, u_${Y}_t);
#else
    ${W} ${Z} ${Y} = u_${Y};
#endif
`:$==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    in ${W} ${Z} a_${Y};
    out ${W} ${Z} ${Y};
#endif
`:$==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    ${Y} = a_${Y};
#endif
`:void 0:$==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${W} ${he} a_${Y};
#else
uniform ${W} ${Z} u_${Y};
#endif
`:$==="define-instanced"?ue==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Y}0;
in vec4 a_${Y}1;
in vec4 a_${Y}2;
in vec4 a_${Y}3;
#else
uniform ${W} ${Z} u_${Y};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${W} ${he} a_${Y};
#else
uniform ${W} ${Z} u_${Y};
#endif
`:$==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    ${W} ${Z} ${Y} = a_${Y};
#endif
`:ue==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${W} ${Z} ${Y} = a_${Y};
#else
    ${W} ${Z} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${W} ${Z} ${Y} = unpack_mix_${ue}(a_${Y}, u_${Y}_t);
#else
    ${W} ${Z} ${Y} = u_${Y};
#endif
`}),staticAttributes:v,usedDefines:O,vertexIncludes:E,fragmentIncludes:k}}class Bp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,a,p,v,b,E,k,O){this.context=t;let N=this.boundPaintVertexBuffers.length!==v.length;for(let W=0;!N&&W<v.length;W++)this.boundPaintVertexBuffers[W]!==v[W]&&(N=!0);let $=this.boundDynamicVertexBuffers.length!==k.length;for(let W=0;!$&&W<k.length;W++)this.boundDynamicVertexBuffers[W]!==k[W]&&($=!0);if(!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==p||N||$||this.boundIndexBuffer!==b||this.boundVertexOffset!==E)this.freshBind(a,p,v,b,E,k,O);else{t.bindVertexArrayOES.set(this.vao);for(const W of k)W&&(W.bind(),O&&W.instanceCount&&W.setVertexAttribDivisor(t.gl,a,O));b&&b.dynamicDraw&&b.bind()}}freshBind(t,a,p,v,b,E,k){const O=t.numAttributes,N=this.context,$=N.gl;this.vao&&this.destroy(),this.vao=N.gl.createVertexArray(),N.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=E,a.enableAttributes($,t),a.bind(),a.setVertexAttribPointers($,t,b);for(const W of p)W.enableAttributes($,t),W.bind(),W.setVertexAttribPointers($,t,b);for(const W of E)W&&(W.enableAttributes($,t),W.bind(),W.setVertexAttribPointers($,t,b),k&&W.instanceCount&&W.setVertexAttribDivisor($,t,k));v&&v.bind(),N.currentNumAttributes=O}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function _l(h,t){const a=Math.pow(2,t.canonical.z),p=t.canonical.y;return[new i.aa(0,p/a).toLngLat().lat,new i.aa(0,(p+1)/a).toLngLat().lat]}function Sh(h,t,a,p,v,b,E){const k=h.context,O=k.gl,N=a.hillshadeFBO;if(!N)return;h.prepareDrawTile();const $=h.isTileAffectedByFog(t),W=h.getOrCreateProgram("hillshade",{overrideFog:$});k.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,N.colorAttachment.get());const Z=((me,ve,Se,Pe)=>{const Me=Se.paint.get("hillshade-shadow-color"),Fe=Se.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",De=Se.paint.get("hillshade-highlight-color"),Oe=Se.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",ze=Se.paint.get("hillshade-accent-color"),Ne=Se.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",je=Se.paint.get("hillshade-emissive-strength");let pt=i.ai(Se.paint.get("hillshade-illumination-direction"));if(Se.paint.get("hillshade-illumination-anchor")==="viewport")pt-=me.transform.angle;else if(me.style&&me.style.enable3dLights()&&me.style.directionalLight){const Ve=me.style.directionalLight.properties.get("direction"),Je=i.cb(Ve.x,Ve.y,Ve.z);pt=i.ai(Je[1])}const ot=!me.options.moving;return{u_matrix:Pe||me.transform.calculateProjMatrix(ve.tileID.toUnwrapped(),ot),u_image:0,u_latrange:_l(0,ve.tileID),u_light:[Se.paint.get("hillshade-exaggeration"),pt],u_shadow:Me.toRenderColor(Fe?null:Se.lut),u_highlight:De.toRenderColor(Oe?null:Se.lut),u_emissive_strength:je,u_accent:ze.toRenderColor(Ne?null:Se.lut)}})(h,a,p,h.terrain?t.projMatrix:null);h.uploadCommonUniforms(k,W,t.toUnwrapped());const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:he,tileBoundsSegments:ue}=h.getTileBoundsBuffers(a);W.draw(h,O.TRIANGLES,v,b,E,Nn.disabled,Z,p.id,Y,he,ue)}function yl(h,t,a){if(!t.needsDEMTextureUpload)return;const p=h.context,v=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||h.getTileTexture(a.stride);const b=a.getPixels();t.demTexture?t.demTexture.update(b,{premultiply:!1}):t.demTexture=new i.T(p,b,v.R32F,{premultiply:!1}),t.needsDEMTextureUpload=!1}function nm(h,t,a){const p=h.context,v=p.gl;if(!t.dem)return;const b=t.dem;if(p.activeTexture.set(v.TEXTURE1),yl(h,t,b),!t.demTexture)return;t.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const E=b.dim;p.activeTexture.set(v.TEXTURE0);let k=t.hillshadeFBO;if(!k){const Z=new i.T(p,{width:E,height:E,data:null},v.RGBA8);Z.bind(v.LINEAR,v.CLAMP_TO_EDGE),k=t.hillshadeFBO=p.createFramebuffer(E,E,!0,"renderbuffer"),k.colorAttachment.set(Z.texture)}p.bindFramebuffer.set(k.framebuffer),p.viewport.set([0,0,E,E]);const{tileBoundsBuffer:O,tileBoundsIndexBuffer:N,tileBoundsSegments:$}=h.getMercatorTileBoundsBuffers(),W=[];h.linearFloatFilteringSupported()&&W.push("TERRAIN_DEM_FLOAT_FORMAT"),h.getOrCreateProgram("hillshadePrepare",{defines:W}).draw(h,v.TRIANGLES,kn.disabled,Jn.disabled,vr.unblended,Nn.disabled,((Z,Y)=>{const he=Y.stride,ue=i.ab.mat4.create();return i.ab.mat4.ortho(ue,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(ue,ue,[0,-i.ag,0]),{u_matrix:ue,u_image:1,u_dimension:[he,he],u_zoom:Z.overscaledZ}})(t.tileID,b),a.id,O,N,$),t.needsHillshadePrepare=!1}class _i{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Td extends _i{getDefault(){return i.aj.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class bg extends _i{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Th extends _i{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Eh extends _i{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ri extends _i{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ed extends _i{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Cd extends _i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Au extends _i{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class rm extends _i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class Uc extends _i{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class vl extends _i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class Md extends _i{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Co extends _i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Ch extends _i{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Mh extends _i{getDefault(){return i.aj.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ih extends _i{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class Ah extends _i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class Pu extends _i{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class $c extends _i{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let Id=class extends _i{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class Ad extends _i{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Ru extends _i{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Ph extends _i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class im extends _i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Vc extends _i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class wg extends _i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Sg extends _i{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Np extends _i{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class Jl extends _i{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class om extends _i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class ku extends _i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class bs extends _i{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class Gc extends bs{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class ba extends bs{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,this.attachment(),a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ql extends bs{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,this.attachment(),a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class sm extends ba{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const am=(h,t,a)=>({u_matrix:h,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:a}),xl=(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:a,u_zoom_transition:v,u_merc_center:b,u_image0:0,u_frustum_tl:E,u_frustum_tr:k,u_frustum_br:O,u_frustum_bl:N,u_globe_pos:$,u_globe_radius:W,u_viewport:Z,u_grid_matrix:ue?Float32Array.from(ue):new Float32Array(9),u_skirt_height:Y,u_far_z_cutoff:he});function ec(h,t){return h!=null&&t!=null&&!(!h.hasData()||!t.hasData())&&h.demTexture!=null&&t.demTexture!=null&&h.tileID.key!==t.tileID.key}const Vo=new class{constructor(){this.operations={}}newMorphing(h,t,a,p,v){if(h in this.operations){const b=this.operations[h];b.to.tileID.key!==a.tileID.key&&(b.queued=a)}else this.operations[h]={startTime:p,phase:0,duration:v,from:t,to:a,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const t=this.operations[h];return{from:t.from,to:t.to,phase:t.phase}}update(h){for(const t in this.operations){const a=this.operations[t];for(a.phase=(h-a.startTime)/a.duration;a.phase>=1||!this._validOp(a);)if(!this._nextOp(a,h)){delete this.operations[t];break}}}_nextOp(h,t){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=t,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},Lu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function wa(h,t,a){if(t===0)return 0;const p=t<1&&a===514?.25/t:1;return 6*Math.pow(1.5,22-h)*Math.max(t,1)*p}function tc(h,t){const a=1<<h.z;return!t&&(h.x===0||h.x===a-1)||h.y===0||h.y===a-1}const Us=h=>({u_matrix:h});function Ai(h,t,a,p,v){if(v>0){const b=i.q.now(),E=(b-h.timeAdded)/v,k=t?(b-t.timeAdded)/v:-1,O=a.getSource(),N=p.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),$=!t||Math.abs(t.tileID.overscaledZ-N)>Math.abs(h.tileID.overscaledZ-N),W=$&&h.refreshedUponExpiration?1:i.aw($?E:1-k,0,1);return h.refreshedUponExpiration&&E>=1&&(h.refreshedUponExpiration=!1),t?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}class ki extends Bs{constructor(t){const a={type:"raster-dem",maxzoom:t.transform.maxZoom},p=new i.D(i.ci(),null),v=Pp("mock-dem",a,p,t.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,a){t.state="loaded",a(null)}}class $a extends Bs{constructor(t){const a=Pp("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new i.D(i.ci(),null),t.style);super("proxy",a,!1),a.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,a,p){if(t.freezeTileCoverage)return;this.transform=t;const v=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,E)=>{if(b[E.key]="",!this._tiles[E.key]){const k=new ul(E,this._source.tileSize*E.overscaleFactor(),t.tileZoom);k.state="loaded",this._tiles[E.key]=k}return b},{});for(const b in this._tiles)b in v||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(t){const a=this.proxyCachedFBO[t];if(a!==void 0){const p=Object.values(a);this.renderCachePool.push(...p),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mo extends i.aG{constructor(t,a,p){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=a,this.projMatrix=p}}class ds extends i.cJ{constructor(t,a){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},t.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),t.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),t.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,v,b]=function(O){const N=new i.b4,$=new i.aU,W=131;N.reserve(17161),$.reserve(33800);const Z=i.ag/128,Y=i.ag+Z/2,he=Y+Z;for(let me=-Z;me<he;me+=Z)for(let ve=-Z;ve<he;ve+=Z){const Se=ve<0||ve>Y||me<0||me>Y?24575:0,Pe=i.aw(Math.round(ve),0,i.ag),Me=i.aw(Math.round(me),0,i.ag);N.emplaceBack(Pe+Se,Me)}const ue=(me,ve)=>{const Se=ve*W+me;$.emplaceBack(Se+1,Se,Se+W),$.emplaceBack(Se+W,Se+W+1,Se+1)};for(let me=1;me<129;me++)for(let ve=1;ve<129;ve++)ue(ve,me);return[0,129].forEach(me=>{for(let ve=0;ve<130;ve++)ue(ve,me),ue(me,ve)}),[N,$,32768]}(),E=t.context;this.gridBuffer=E.createVertexBuffer(p,i.b6.members),this.gridIndexBuffer=E.createIndexBuffer(v),this.gridSegments=i.b7.simpleSegment(0,0,p.length,v.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,p.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $a(a.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const k=E.gl;this._overlapStencilMode=new Jn({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=a,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ki(a.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,a,p){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const v=t.terrain.properties,b=t.terrain.drapeRenderMode===0,E=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const k=t.terrain&&t.terrain.scope,O=v.get("source"),N=b?this._mockSourceCache:t.getSourceCache(O,k);if(!N)return void i.w(`Couldn't find terrain source "${O}".`);if(this.sourceCache=N,this._attenuationRange=t.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(a):v.get("exaggeration"),!a.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const $=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const W=this.getScaledDemTileSize();this.sourceCache.update(a,W,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,$(),this._initializing=!0),$(),a.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(a),this._emptyDEMTextureDirty=!0,this._previousZoom=a.zoom}else this._disable()}calculateExaggeration(t){if(this._attenuationRange&&t.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(t.zoom);const a=this._previousCameraAltitude,p=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=p;const v=a!=null?p-a:Number.MAX_VALUE;if(Math.abs(v)<2)return this._exaggeration;const b=t.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(b);let k=b-this._previousZoom;const O=this._previousUpdateTimestamp;let N=b;this._evaluationZoom!=null&&(N=this._evaluationZoom,Math.abs(b-N)>.5&&(k=.5*(b-N+k)),k*v<0&&(N+=k)),this._evaluationZoom=N;const $=E.getExaggeration(N),W=$===E.getExaggeration(Math.max(0,N-.1));if(W&&Math.abs($-this._exaggeration)<.01)return $;let Z=Math.min(.1,.00375*(this._updateTimestamp-O));return(W||$<.1||Math.abs(k)<1e-4)&&(Z=Math.min(.2,4*Z)),i.af(this._exaggeration,$,Z)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const a=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=a.getIds().map(O=>{const N=a.getTileByID(O).tileID;return N.projMatrix=p.calculateProjMatrix(N.toUnwrapped()),N});(function(O,N){const $=N.transform.pointCoordinate(N.transform.getCameraPoint()),W=new i.P($.x,$.y);O.sort((Z,Y)=>{if(Y.overscaledZ-Z.overscaledZ)return Y.overscaledZ-Z.overscaledZ;const he=new i.P(Z.canonical.x+(1<<Z.canonical.z)*Z.wrap,Z.canonical.y),ue=new i.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),me=W.mult(1<<Z.canonical.z);return me.x-=.5,me.y-=.5,me.distSqr(he)-me.distSqr(ue)})})(v,this.painter);const b=this.proxyToSource||{};this.proxyToSource={},v.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const O in E){const N=E[O];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,t[O],b),N.usedForTerrain))continue;const $=t[O];N.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[a.id]=v.map(O=>new Mo(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;const k={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const N=this.terrainTileForTile[O.key];if(!N)continue;const $=N.tileID.key;$ in k||(this._visibleDemTiles.push(N),k[$]=$)}}_assignTerrainTiles(t){this._initializing||t.forEach(a=>{if(this.terrainTileForTile[a.key])return;const p=this._findTileCoveringTileID(a,this.sourceCache);p&&(this.terrainTileForTile[a.key]=p)})}_prepareDEMTextures(){const t=this.painter.context,a=t.gl;for(const p in this.terrainTileForTile){const v=this.terrainTileForTile[p],b=v.dem;!b||v.demTexture&&!v.needsDEMTextureUpload||(t.activeTexture.set(a.TEXTURE1),yl(this.painter,v,b))}}_prepareDemTileUniforms(t,a,p,v){if(!a||a.demTexture==null)return!1;const b=t.tileID.canonical,E=Math.pow(2,a.tileID.canonical.z-b.z),k=v||"";return p[`u_dem_tl${k}`]=[b.x*E%1,b.y*E%1],p[`u_dem_scale${k}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let t=0;const a=this._visibleDemTiles.reduce((p,v)=>{if(!v.dem)return p;const b=v.dem.tree.minimums[0];return b>0&&t++,p+b},0);return t?a/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,a=t.gl;t.activeTexture.set(a.TEXTURE2);const p=this._getLoadedAreaMinimum(),v=new i.cK({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(v,{premultiply:!1}):b=this._emptyDEMTexture=new i.T(t,v,a.R32F,{premultiply:!1}),b}setupElevationDraw(t,a,p){const v=this.painter.context,b=v.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let k=null,O=null,N=1;if(p&&p.morphing&&this._useVertexMorphing){const Y=p.morphing.srcDemTile,he=p.morphing.dstDemTile;N=p.morphing.phase,Y&&he&&(this._prepareDemTileUniforms(t,Y,E,"_prev")&&(O=Y),this._prepareDemTileUniforms(t,he,E)&&(k=he))}const $=Y=>Y&&Y.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST;let W=null;var Z;if(this.enabled?O&&k?(W=k.demTexture,v.activeTexture.set(b.TEXTURE4),O.demTexture.bind($(O),b.CLAMP_TO_EDGE),E.u_dem_lerp=N):(k=this.terrainTileForTile[t.tileID.key],W=this._prepareDemTileUniforms(t,k,E)?k.demTexture:this.emptyDEMTexture):W=this.emptyDEMTexture,v.activeTexture.set(b.TEXTURE2),W&&(E.u_dem_size=(Z=W).size[0]===1?1:Z.size[0]-2,W.bind($(k),b.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,a,E),p&&p.useMeterToDem&&k){const Y=(1<<k.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=Y}if(p&&p.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),a.setTerrainUniformValues(v,E),this.painter.transform.projection.name==="globe"){const Y=this.globeUniformValues(this.painter.transform,t.tileID.canonical,p&&p.useDenormalizedUpVectorScale);a.setGlobeUniformValues(v,Y)}}globeUniformValues(t,a,p){const v=t.projection;return{u_tile_tl_up:v.upVector(a,0,0),u_tile_tr_up:v.upVector(a,i.ag,0),u_tile_br_up:v.upVector(a,i.ag,i.ag),u_tile_bl_up:v.upVector(a,0,i.ag),u_tile_up_scale:p?i.cL(1):v.upVectorScale(a,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const a=this.painter,p=this.painter.context;t.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,a.width,a.height]),a.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,b,E,k,O){if(v.transform.projection.name==="globe")(function(N,$,W,Z,Y){const he=N.context,ue=he.gl;let me,ve;const Se=N.transform,Pe=i.cC(N,he,Se),Me=(Ve,Je)=>{if(ve===Je)return;const It=[Lu[Je],"PROJECTION_GLOBE_VIEW"];Pe&&It.push("CUSTOM_ANTIALIASING");const kt=N.isTileAffectedByFog(Ve);me=N.getOrCreateProgram("globeRaster",{defines:It,overrideFog:kt}),ve=Je},Fe=N.colorModeForRenderPass(),De=new kn(ue.LEQUAL,kn.ReadWrite,N.depthRangeFor3D);Vo.update(Y);const Oe=i.cD(Se),ze=[i.at(Se.center.lng),i.aA(Se.center.lat)],Ne=N.globeSharedBuffers,je=[Se.width*i.q.devicePixelRatio,Se.height*i.q.devicePixelRatio],pt=Float32Array.from(Se.globeMatrix),ot={useDenormalizedUpVectorScale:!0};{const Ve=N.transform,Je=wa(Ve.zoom,$.exaggeration(),$.sourceCache._source.tileSize);ve=-1;const It=ue.TRIANGLES;for(const kt of Z){const Ht=W.getTile(kt),ut=Jn.disabled,Lt=$.prevTerrainTileForTile[kt.key],xt=$.terrainTileForTile[kt.key];ec(Lt,xt)&&Vo.newMorphing(kt.key,Lt,xt,Y,250),he.activeTexture.set(ue.TEXTURE0),Ht.texture&&Ht.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);const Gt=Vo.getMorphValuesForProxy(kt.key),At=Gt?1:0;Gt&&i.J(ot,{morphing:{srcDemTile:Gt.from,dstDemTile:Gt.to,phase:i.cB(Gt.phase)}});const Ct=i.cE(kt.canonical),on=i.cF(Ct.getCenter().lat),Zt=i.cG(kt.canonical,Ct,on,Ve.worldSize/Ve._pixelsPerMercatorPixel),cn=i.bb(i.cH(kt.canonical)),mn=xl(Ve.expandedFarZProjMatrix,pt,Oe,cn,i.ae(Ve.zoom),ze,Ve.frustumCorners.TL,Ve.frustumCorners.TR,Ve.frustumCorners.BR,Ve.frustumCorners.BL,Ve.globeCenterInViewSpace,Ve.globeRadius,je,Je,Ve._farZ,Zt);if(Me(kt,At),me&&($.setupElevationDraw(Ht,me,ot),N.uploadCommonUniforms(he,me,kt.toUnwrapped()),Ne)){const[jn,In,Rn]=Ne.getGridBuffers(on,Je!==0);me.draw(N,It,De,ut,Fe,Nn.backCCW,mn,"globe_raster",jn,In,Rn)}}}if(Ne&&(N.renderDefaultNorthPole||N.renderDefaultSouthPole)){const Ve=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Pe&&Ve.push("CUSTOM_ANTIALIASING"),me=N.getOrCreateProgram("globeRaster",{defines:Ve});for(const Je of Z){const{x:It,y:kt,z:Ht}=Je.canonical,ut=kt===0,Lt=kt===(1<<Ht)-1,[xt,Gt,At,Ct]=Ne.getPoleBuffers(Ht,!1);if(Ct&&(ut||Lt)){const on=W.getTile(Je);he.activeTexture.set(ue.TEXTURE0),on.texture&&on.texture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);let Zt=i.cI(Ht,It,Se);const cn=i.bb(i.cH(Je.canonical)),mn=(jn,In)=>jn.draw(N,ue.TRIANGLES,De,Jn.disabled,Fe,Nn.disabled,xl(Se.expandedFarZProjMatrix,Zt,Zt,cn,0,ze,Se.frustumCorners.TL,Se.frustumCorners.TR,Se.frustumCorners.BR,Se.frustumCorners.BL,Se.globeCenterInViewSpace,Se.globeRadius,je,0,Se._farZ),"globe_pole_raster",In,At,Ct);$.setupElevationDraw(on,me,ot),N.uploadCommonUniforms(he,me,Je.toUnwrapped()),ut&&N.renderDefaultNorthPole&&mn(me,xt),Lt&&N.renderDefaultSouthPole&&(Zt=i.ab.mat4.scale(i.ab.mat4.create(),Zt,[1,-1,1]),mn(me,Gt))}}}})(v,b,E,k,O);else{const N=v.context,$=N.gl;let W,Z;const Y=v.shadowRenderer,he=Oa(v,v.longestCutoffRange),ue=Fe=>{if(Z===Fe)return;const De=[];De.push(Lu[Fe]),he.shouldRenderCutoff&&De.push("RENDER_CUTOFF"),Y&&(De.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Y.useNormalOffset&&De.push("NORMAL_OFFSET")),W=v.getOrCreateProgram("terrainRaster",{defines:De}),Z=Fe},me=v.colorModeForRenderPass(),ve=new kn($.LEQUAL,kn.ReadWrite,v.depthRangeFor3D);Vo.update(O);const Se=v.transform,Pe=wa(Se.zoom,b.exaggeration(),b.sourceCache._source.tileSize);let Me=[0,0,0];if(Y){const Fe=v.style.directionalLight,De=v.style.ambientLight;Fe&&De&&(Me=Bc(v.style,Fe,De))}{Z=-1;const Fe=$.TRIANGLES,[De,Oe]=[b.gridIndexBuffer,b.gridSegments];for(const ze of k){const Ne=E.getTile(ze),je=Jn.disabled,pt=b.prevTerrainTileForTile[ze.key],ot=b.terrainTileForTile[ze.key];ec(pt,ot)&&Vo.newMorphing(ze.key,pt,ot,O,250),N.activeTexture.set($.TEXTURE0),Ne.texture&&Ne.texture.bind($.LINEAR,$.CLAMP_TO_EDGE);const Ve=Vo.getMorphValuesForProxy(ze.key),Je=Ve?1:0;let It;Ve&&(It={morphing:{srcDemTile:Ve.from,dstDemTile:Ve.to,phase:i.cB(Ve.phase)}});const kt=am(ze.projMatrix,tc(ze.canonical,Se.renderWorldCopies)?Pe/10:Pe,Me);if(ue(Je),!W)continue;b.setupElevationDraw(Ne,W,It);const Ht=ze.toUnwrapped();Y&&Y.setupShadows(Ht,W),v.uploadCommonUniforms(N,W,Ht,null,he),W.draw(v,Fe,ve,je,me,Nn.backCCW,kt,"terrain_raster",b.gridBuffer,De,Oe)}}}}(a,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,a.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const a=this.painter,p=this.painter.context,v=this.proxySourceCache,b=this.proxiedCoords[v.id],E=this._drapedRenderBatches.shift(),k=a.style.order,O=[];let N=0;for(const $ of b){const W=v.getTileByID($.proxyTileKey),Z=v.proxyCachedFBO[$.key]?v.proxyCachedFBO[$.key][t]:void 0,Y=Z!==void 0?v.renderCache[Z]:this.pool[N++],he=Z!==void 0;if(W.texture=Y.tex,he&&!Y.dirty){O.push(W.tileID);continue}let ue;p.bindFramebuffer.set(Y.fb.framebuffer),this.renderedToTile=!1,Y.dirty&&(p.clear({color:i.aj.transparent,stencil:0}),Y.dirty=!1);for(let me=E.start;me<=E.end;++me){const ve=a.style._mergedLayers[k[me]];if(ve.isHidden(a.transform.zoom))continue;const Se=a.style.getLayerSourceCache(ve),Pe=Se?this.proxyToSource[$.key][Se.id]:[$];if(!Pe)continue;const Me=Pe;p.viewport.set([0,0,Y.fb.width,Y.fb.height]),ue!==(Se?Se.id:null)&&(this._setupStencil(Y,Pe,ve,Se),ue=Se?Se.id:null),a.renderLayer(a,Se,ve,Me)}if(this._drapedRenderBatches.length===0)for(const me of this._pendingGroundEffectLayers){const ve=a.style._mergedLayers[k[me]];if(ve.isHidden(a.transform.zoom))continue;const Se=a.style.getLayerSourceCache(ve),Pe=Se?this.proxyToSource[$.key][Se.id]:[$];if(!Pe)continue;const Me=Pe;p.viewport.set([0,0,Y.fb.width,Y.fb.height]),ue!==(Se?Se.id:null)&&(this._setupStencil(Y,Pe,ve,Se),ue=Se?Se.id:null),a.renderLayer(a,Se,ve,Me)}this.renderedToTile?(Y.dirty=!0,O.push(W.tileID)):he||--N,N===5&&(N=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,a.width,a.height]),E.end+1}postRender(){}isLayerOrderingCorrect(t){const a=t.order.length;let p=-1,v=a;for(let b=0;b<a;++b)this._style.isLayerDraped(t._mergedLayers[t.order[b]])?p=Math.max(p,b):v=Math.min(v,b);return v>p}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(a=>a.dem).forEach(a=>{t=Math.min(t,a.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,a,p){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const E=b.tileID,k=1<<E.overscaledZ,{x:O,y:N}=E.canonical,$=O/k,W=(O+1)/k,Z=N/k,Y=(N+1)/k;return{minx:$,miny:Z,maxx:W,maxy:Y,t:b.dem.tree.raycastRoot($,Z,W,Y,t,a,p),tile:b}});v.sort((b,E)=>(b.t!==null?b.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const b of v){if(b.t==null)return null;const E=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,t,a,p);if(E!=null)return E}return null}_createFBO(){const t=this.painter.context,a=t.gl,p=this.drapeBufferSize;t.activeTexture.set(a.TEXTURE0);const v=new i.T(t,{width:p[0],height:p[1],data:null},a.RGBA8);v.bind(a.LINEAR,a.CLAMP_TO_EDGE);const b=t.createFramebuffer(p[0],p[1],!0,null);return b.colorAttachment.set(v.texture),b.depthAttachment=new sm(t,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:b,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const a=this._style._mergedLayers[t],p=a.isHidden(this.painter.transform.zoom);return a.type==="hillshade"||a.type==="custom"?!p&&a.shouldRedrape():!p&&a.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const p of this._style.getSources())if(p instanceof ch){t=!0;break}if(!t)return;const a={};for(let p=0;p<this._style.order.length;++p){const v=this._style._mergedLayers[this._style.order[p]],b=this._style.getLayerSourceCache(v);if(b&&!a[b.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof i.a9){a[b.id]=!0;for(const E of this.proxyCoords){const k=this.proxyToSource[E.key][b.id];if(k)for(const O of k)this._clearRenderCacheForTile(b.id,O)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof Jo){t=!0;break}if(!t)return;const a={};for(let p=0;p<this._style.order.length;++p){const v=this._style._mergedLayers[this._style.order[p]],b=this._style.getLayerSourceCache(v);if(!b||a[b.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const E=v.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const O=this.proxyToSource[k.key][b.id];if(O)for(const N of O){const $=Ai(b.getTile(N),b.findLoadedParent(N,0),b,this.painter.transform,E);($.opacity!==1||$.mix!==0)&&this._clearRenderCacheForTile(b.id,N)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const t=this._style.order,a=t.length;if(a===0)return;const p=[];this._pendingGroundEffectLayers=[];let v,b=0,E=this._style._mergedLayers[t[b]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++b<a;)E=this._style._mergedLayers[t[b]];for(;b<a;++b){const k=this._style._mergedLayers[t[b]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?v===void 0&&(v=b):(k.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),v!==void 0&&(p.push({start:v,end:b-1}),v=void 0)))}if(v!==void 0&&p.push({start:v,end:b-1}),p.length!==0){const k=p[p.length-1];this._pendingGroundEffectLayers.every(O=>O>k.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(t){const a=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,a.renderCache.length>a.renderCachePool.length){const E=Object.values(a.proxyCachedFBO);a.proxyCachedFBO={};for(let k=0;k<E.length;++k){const O=Object.values(E[k]);a.renderCachePool.push(...O)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,v=this._tilesDirty;for(let E=p.length-1;E>=0;E--){const k=p[E];if(a.getTileByID(k.key),a.proxyCachedFBO[k.key]!==void 0){const O=t[k.key],N=this.proxyToSource[k.key];let $=0;for(const W in N){const Z=N[W],Y=O[W];if(!Y||Y.length!==Z.length||Z.some((he,ue)=>he!==Y[ue]||v[W]&&v[W].hasOwnProperty(he.key))){$=-1;break}++$}for(const W in a.proxyCachedFBO[k.key])a.renderCache[a.proxyCachedFBO[k.key][W]].dirty=$<0||$!==Object.values(O).length}}const b=[...this._drapedRenderBatches];b.sort((E,k)=>k.end-k.start-(E.end-E.start));for(const E of b)for(const k of p){if(a.proxyCachedFBO[k.key])continue;let O=a.renderCachePool.pop();O===void 0&&a.renderCache.length<50&&(O=a.renderCache.length,a.renderCache.push(this._createFBO())),O!==void 0&&(a.proxyCachedFBO[k.key]={},a.proxyCachedFBO[k.key][E.start]=O,a.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(t,a,p,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,E=b.gl;if(a.length<=1)return void(this._overlapStencilType=!1);let k;if(p.isTileClipped())k=a.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(a[0].overscaledZ>a[a.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(a,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):Jn.disabled}_renderTileClippingMasks(t,a){const p=this.painter,v=this.painter.context,b=v.gl;p._tileClippingMaskIDs={},v.setColorMode(vr.disabled),v.setDepthMode(kn.disabled);const E=p.getOrCreateProgram("clippingMask");for(const k of t){const O=p._tileClippingMaskIDs[k.key]=--a;E.draw(p,b.TRIANGLES,kn.disabled,new Jn({func:b.ALWAYS,mask:0},O,255,b.KEEP,b.KEEP,b.REPLACE),vr.disabled,Nn.disabled,Us(k.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(t){const a=this.painter.transform;if(t.x<0||t.x>a.width||t.y<0||t.y>a.height)return null;const p=[t.x,t.y,1,1];i.ab.vec4.transformMat4(p,p,a.pixelMatrixInverse),i.ab.vec4.scale(p,p,1/p[3]),p[0]/=a.worldSize,p[1]/=a.worldSize;const v=a._camera.position,b=i.bH(1,a.center.lat),E=[v[0],v[1],v[2]/b,0],k=i.ab.vec3.subtract([],p.slice(0,3),E);i.ab.vec3.normalize(k,k);const O=this.raycast(E,k,this._exaggeration);return O!==null&&O?(i.ab.vec3.scaleAndAdd(E,E,k,O),E[3]=E[2],E[2]*=b,E):null}_setupProxiedCoordsForOrtho(t,a,p){if(t.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(t,a,p);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const v=this.proxiedCoords[t.id]=[],b=this.proxyCoords;for(let O=0;O<b.length;O++){const N=b[O],$=this._findTileCoveringTileID(N,t);if($){const W=this._createProxiedId(N,$,p[N.key]&&p[N.key][t.id]);v.push(W),this.proxyToSource[N.key][t.id]=[W]}}let E=!1;const k=new Set;for(let O=0;O<a.length;O++){const N=t.getTile(a[O]);if(!N||!N.hasData())continue;const $=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==N.tileID.canonical.z){const W=this.proxyToSource[$.tileID.key][t.id],Z=this._createProxiedId($.tileID,N,p[$.tileID.key]&&p[$.tileID.key][t.id]);W?W.splice(W.length-1,0,Z):this.proxyToSource[$.tileID.key][t.id]=[Z];const Y=this.proxyToSource[$.tileID.key][t.id];k.has(Y)||k.add(Y),v.push(Z),E=!0}}if(this._sourceTilesOverlap[t.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const O of k)O.sort((N,$)=>$.overscaledZ-N.overscaledZ)}_setupProxiedCoordsForImageSource(t,a,p){if(!t.getSource().loaded())return;const v=this.proxiedCoords[t.id]=[],b=this.proxyCoords,E=t.getSource(),k=E.tileID;if(!k)return;const O=new i.P(k.x,k.y)._div(1<<k.z),N=E.coordinates.map(i.aa.fromLngLat).reduce((W,Z)=>(W.min.x=Math.min(W.min.x,Z.x-O.x),W.min.y=Math.min(W.min.y,Z.y-O.y),W.max.x=Math.max(W.max.x,Z.x-O.x),W.max.y=Math.max(W.max.y,Z.y-O.y),W),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(W,Z)=>{const Y=W.wrap+W.canonical.x/(1<<W.canonical.z),he=W.canonical.y/(1<<W.canonical.z),ue=i.ag/(1<<W.canonical.z),me=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ve=Z.canonical.y/(1<<Z.canonical.z);return Y+ue<me+N.min.x||Y>me+N.max.x||he+ue<ve+N.min.y||he>ve+N.max.y};for(let W=0;W<b.length;W++){const Z=b[W];for(let Y=0;Y<a.length;Y++){const he=t.getTile(a[Y]);if(!he||!he.hasData()||$(Z,he.tileID))continue;const ue=this._createProxiedId(Z,he,p[Z.key]&&p[Z.key][t.id]),me=this.proxyToSource[Z.key][t.id];me?me.push(ue):this.proxyToSource[Z.key][t.id]=[ue],v.push(ue)}}}_createProxiedId(t,a,p){let v=this.orthoMatrix;if(p){const b=p.find(E=>E.key===a.tileID.key);if(b)return b}if(a.tileID.key!==t.key){const b=t.canonical.z-a.tileID.canonical.z;let E,k,O;v=i.ab.mat4.create();const N=a.tileID.wrap-t.wrap<<t.overscaledZ;b>0?(E=i.ag>>b,k=E*((a.tileID.canonical.x<<b)-t.canonical.x+N),O=E*((a.tileID.canonical.y<<b)-t.canonical.y)):(E=i.ag<<-b,k=i.ag*(a.tileID.canonical.x-(t.canonical.x+N<<-b)),O=i.ag*(a.tileID.canonical.y-(t.canonical.y<<-b))),i.ab.mat4.ortho(v,0,E,0,E,0,1),i.ab.mat4.translate(v,v,[k,O,0])}return new Mo(a.tileID,t.key,v)}_findTileCoveringTileID(t,a){let p=a.getTile(t);if(p&&p.hasData())return p;const v=this._findCoveringTileCache[a.id],b=v[t.key];if(p=b?a.getTileByID(b):null,p&&p.hasData()||b===null)return p;let E=p?p.tileID:t,k=E.overscaledZ;const O=a.getSource().minzoom,N=[];if(!b){const W=a.getSource().maxzoom;if(t.canonical.z>=W){const Z=t.canonical.z-W;a.getSource().reparseOverscaled?(k=Math.max(t.canonical.z+2,a.transform.tileZoom),E=new i.aG(k,t.wrap,W,t.canonical.x>>Z,t.canonical.y>>Z)):Z!==0&&(k=W,E=new i.aG(k,t.wrap,W,t.canonical.x>>Z,t.canonical.y>>Z))}E.key!==t.key&&(N.push(E.key),p=a.getTile(E))}const $=W=>{N.forEach(Z=>{v[Z]=W}),N.length=0};for(k-=1;k>=O&&(!p||!p.hasData());k--){p&&$(p.tileID.key);const W=E.calculateScaledKey(k);if(p=a.getTileByID(W),p&&p.hasData())break;const Z=v[W];if(Z===null)break;Z===void 0?N.push(W):p=a.getTileByID(Z)}return $(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,a){let p=this._tilesDirty[t];p||(p=this._tilesDirty[t]={}),p[a.key]=!0}}function nc(h,t,a){const p=function(k,O,N){const $=i.ab.vec3.dot(O,k),W=i.ab.vec3.dot(N,[.2126,.7152,.0722]),Z=(he,ue,me)=>(1-me)*he+me*ue,Y=Z(1-.3*Math.min(W,1),1,Math.min($+1,1));return Z(.92,1,Math.asin(i.aw(O[2],-1,1))/Math.PI+.5)*Y}(h,[0,0,1],t),v=[0,0,0];i.ab.vec3.scale(v,a.slice(0,3),p);const b=[0,0,0];i.ab.vec3.scale(b,t.slice(0,3),h[2]);const E=[0,0,0];return i.ab.vec3.add(E,v,b),i.cf(E)}const Va=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],ws=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Pd{static cacheKey(t,a,p,v){let b=`${a}${v?v.cacheKey:""}`;for(const E of p)t.usedDefines.includes(E)&&(b+=`/${E}`);return b}constructor(t,a,p,v,b,E){const k=t.gl;this.program=k.createProgram(),this.configuration=v,this.name=a,this.fixedDefines=[...E];const O=v?v.getBinderAttributes():[],N=(p.staticAttributes||[]).concat(O);let $=v?v.defines():[];$=$.concat(E.map(me=>`#define ${me}`));const W=`#version 300 es
`;let Z=W+$.concat("precision mediump float;",wh,wd.fragmentSource).join(`
`);for(const me of p.fragmentIncludes)Z+=`
${Na[me]}`;Z+=`
${p.fragmentSource}`;let Y=W+$.concat("precision highp float;",wh,wd.vertexSource).join(`
`);for(const me of p.vertexIncludes)Y+=`
${Na[me]}`;this.forceManualRenderingForInstanceIDShaders=t.forceManualRenderingForInstanceIDShaders&&p.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(Y+=`
uniform int u_instanceID;
`),Y+=`
${p.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(Y=Y.replaceAll("gl_InstanceID","u_instanceID"));const he=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(he,Z),k.compileShader(he),k.attachShader(this.program,he);const ue=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(ue,Y),k.compileShader(ue),k.attachShader(this.program,ue),this.attributes={},this.numAttributes=N.length;for(let me=0;me<this.numAttributes;me++)if(N[me]){const ve=N[me].startsWith("a_")?N[me]:`a_${N[me]}`;k.bindAttribLocation(this.program,me,ve),this.attributes[ve]=me}k.linkProgram(this.program),k.deleteShader(ue),k.deleteShader(he),this.fixedUniforms=b(t),this.binderUniforms=v?v.getUniforms(t):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(me=>({u_instanceID:new i.bN(me)}))(t)),(E.includes("TERRAIN")||a.indexOf("symbol")!==-1||a.indexOf("circle")!==-1)&&(this.terrainUniforms=(me=>({u_dem:new i.bN(me),u_dem_prev:new i.bN(me),u_dem_tl:new i.bK(me),u_dem_scale:new i.bM(me),u_dem_tl_prev:new i.bK(me),u_dem_scale_prev:new i.bM(me),u_dem_size:new i.bM(me),u_dem_lerp:new i.bM(me),u_exaggeration:new i.bM(me),u_depth:new i.bN(me),u_depth_size_inv:new i.bK(me),u_depth_range_unpack:new i.bK(me),u_occluder_half_size:new i.bM(me),u_occlusion_depth_offset:new i.bM(me),u_meter_to_dem:new i.bM(me),u_label_plane_matrix_inv:new i.bJ(me)}))(t)),E.includes("GLOBE")&&(this.globeUniforms=(me=>({u_tile_tl_up:new i.bL(me),u_tile_tr_up:new i.bL(me),u_tile_br_up:new i.bL(me),u_tile_bl_up:new i.bL(me),u_tile_up_scale:new i.bM(me)}))(t)),E.includes("FOG")&&(this.fogUniforms=(me=>({u_fog_matrix:new i.bJ(me),u_fog_range:new i.bK(me),u_fog_color:new i.ca(me),u_fog_horizon_blend:new i.bM(me),u_fog_vertical_limit:new i.bK(me),u_fog_temporal_offset:new i.bM(me),u_frustum_tl:new i.bL(me),u_frustum_tr:new i.bL(me),u_frustum_br:new i.bL(me),u_frustum_bl:new i.bL(me),u_globe_pos:new i.bL(me),u_globe_radius:new i.bM(me),u_globe_transition:new i.bM(me),u_is_globe:new i.bN(me),u_viewport:new i.bK(me)}))(t)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(me=>({u_cutoff_params:new i.ca(me)}))(t)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(me=>({u_lighting_ambient_color:new i.bL(me),u_lighting_directional_dir:new i.bL(me),u_lighting_directional_color:new i.bL(me),u_ground_radiance:new i.bL(me)}))(t)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(me=>({u_light_matrix_0:new i.bJ(me),u_light_matrix_1:new i.bJ(me),u_fade_range:new i.bK(me),u_shadow_normal_offset:new i.bL(me),u_shadow_intensity:new i.bM(me),u_shadow_texel_size:new i.bM(me),u_shadow_map_resolution:new i.bM(me),u_shadow_direction:new i.bL(me),u_shadow_bias:new i.bL(me),u_shadowmap_0:new i.bN(me),u_shadowmap_1:new i.bN(me)}))(t))}}setTerrainUniformValues(t,a){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in a)p[v]&&p[v].set(this.program,v,a[v])}}setGlobeUniformValues(t,a){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in a)p[v]&&p[v].set(this.program,v,a[v])}}setFogUniformValues(t,a){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in a)p[v].set(this.program,v,a[v])}}setCutoffUniformValues(t,a){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in a)p[v].set(this.program,v,a[v])}}setLightsUniformValues(t,a){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in a)p[v].set(this.program,v,a[v])}}setShadowUniformValues(t,a){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;t.program.set(this.program);for(const v in a)p[v].set(this.program,v,a[v])}_drawDebugWireframe(t,a,p,v,b,E,k,O,N,$){const W=t.options.wireframe;if(W.terrain===!1&&W.layers2D===!1&&W.layers3D===!1)return;const Z=t.context;if(!(!(!W.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!W.layers2D||t._terrain&&t._terrain.renderingToTexture||!Va.includes(this.name))||!(!W.layers3D||!ws.includes(this.name))))return;const Y=Z.gl,he=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,b,Z);if(!he)return;const ue=[...this.fixedDefines];ue.push("DEBUG_WIREFRAME");const me=t.getOrCreateProgram(this.name,{config:this.configuration,defines:ue});Z.program.set(me.program);const ve=(Me,Fe,De)=>{if(Fe[Me]&&De[Me])for(const Oe in Fe[Me])De[Me][Oe]&&De[Me][Oe].set(De.program,Oe,Fe[Me][Oe].current)};N&&N.setUniforms(me.program,Z,me.binderUniforms,k,{zoom:O}),ve("fixedUniforms",this,me),ve("terrainUniforms",this,me),ve("globeUniforms",this,me),ve("fogUniforms",this,me),ve("lightsUniforms",this,me),ve("shadowUniforms",this,me),he.bind(),Z.setColorMode(new vr([Y.ONE,Y.ONE_MINUS_SRC_ALPHA,Y.ZERO,Y.ONE],i.aj.transparent,[!0,!0,!0,!1])),Z.setDepthMode(new kn(a.func===Y.LESS?Y.LEQUAL:a.func,kn.ReadOnly,a.range)),Z.setStencilMode(Jn.disabled);const Se=3*E.primitiveLength*2,Pe=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Me=$||1;for(let Fe=0;Fe<Me;++Fe)me.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Fe),Y.drawElements(Y.LINES,Se,Y.UNSIGNED_SHORT,Pe)}else $&&$>1?Y.drawElementsInstanced(Y.LINES,Se,Y.UNSIGNED_SHORT,Pe,$):Y.drawElements(Y.LINES,Se,Y.UNSIGNED_SHORT,Pe);b.bind(),Z.program.set(this.program),Z.setDepthMode(a),Z.setStencilMode(p),Z.setColorMode(v)}checkUniforms(t,a,p){if(this.fixedDefines.includes(a)){for(const v of Object.keys(p))if(!p[v].initialized)throw new Error(`Program '${this.name}', from draw '${t}': uniform ${v} not set but required by ${a} being defined`)}}draw(t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me){const ve=t.context,Se=ve.gl;if(this.failedToCreate)return;ve.program.set(this.program),ve.setDepthMode(p),ve.setStencilMode(v),ve.setColorMode(b),ve.setCullFace(E);for(const Fe of Object.keys(this.fixedUniforms))this.fixedUniforms[Fe].set(this.program,Fe,k[Fe]);he&&he.setUniforms(this.program,ve,this.binderUniforms,Z,{zoom:Y});const Pe={[Se.POINTS]:1,[Se.LINES]:2,[Se.TRIANGLES]:3,[Se.LINE_STRIP]:1}[a];this.checkUniforms(O,"RENDER_SHADOWS",this.shadowUniforms);const Me=me&&me>0?1:void 0;for(const Fe of W.get()){const De=Fe.vaos||(Fe.vaos={});if((De[O]||(De[O]=new Bp)).bind(ve,this,N,he?he.getPaintVertexBuffers():[],$,Fe.vertexOffset,ue||[],Me),this.forceManualRenderingForInstanceIDShaders){const Oe=me||1;for(let ze=0;ze<Oe;++ze)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ze),$?Se.drawElements(a,Fe.primitiveLength*Pe,Se.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2):Se.drawArrays(a,Fe.vertexOffset,Fe.vertexLength)}else me&&me>1?Se.drawElementsInstanced(a,Fe.primitiveLength*Pe,Se.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2,me):$?Se.drawElements(a,Fe.primitiveLength*Pe,Se.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2):Se.drawArrays(a,Fe.vertexOffset,Fe.vertexLength);a===Se.TRIANGLES&&$&&this._drawDebugWireframe(t,p,v,b,$,Fe,Z,Y,he,me)}}}function Rh(h,t){const a=Math.pow(2,t.tileID.overscaledZ),p=t.tileSize*Math.pow(2,h.transform.tileZoom)/a,v=p*(t.tileID.canonical.x+t.tileID.wrap*a),b=p*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(t,1,h.transform.tileZoom),u_pixel_coord_upper:[v>>16,b>>16],u_pixel_coord_lower:[65535&v,65535&b]}}const Rd={terrain:0,flat:1},zu=i.ab.mat4.create(),kd=(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve)=>{const Se=t.style.light,Pe=Se.properties.get("position"),Me=[Pe.x,Pe.y,Pe.z],Fe=i.ab.mat3.create();Se.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Fe,-t.transform.angle),i.ab.vec3.transformMat3(Me,Me,Fe));const De=Se.properties.get("color"),Oe=t.transform,ze={u_matrix:h,u_lightpos:Me,u_lightintensity:Se.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_vertical_gradient:+a,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:zu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Rd[N],u_base_type:Rd[$],u_ao:v,u_edge_radius:b,u_width_scale:E,u_flood_light_color:he,u_vertical_scale:ue,u_flood_light_intensity:me,u_ground_shadow_factor:ve};return Oe.projection.name==="globe"&&(ze.u_tile_id=[k.canonical.x,k.canonical.y,1<<k.canonical.z],ze.u_zoom_transition=W,ze.u_inv_rot_matrix=Y,ze.u_merc_center=Z,ze.u_up_dir=Oe.projection.upVector(new i.bT(0,0,0),Z[0]*i.ag,Z[1]*i.ag),ze.u_height_lift=O),ze},$s=(h,t,a,p,v,b)=>({u_matrix:h,u_edge_radius:t,u_width_scale:a,u_vertical_scale:p,u_height_type:Rd[v],u_base_type:Rd[b]}),Du=(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me)=>{const ve=kd(h,t,a,p,v,b,E,k,N,$,W,Z,Y,he,ue,me,1,[0,0,0]),Se={u_height_factor:-Math.pow(2,k.overscaledZ)/O.tileSize/8};return i.l(ve,Rh(t,O),Se)},rc=(h,t)=>({u_matrix:h,u_emissive_strength:t}),kh=(h,t,a,p)=>i.l(rc(h,t),Rh(a,p)),Lh=(h,t,a)=>({u_matrix:h,u_world:a,u_emissive_strength:t}),Sa=(h,t,a,p,v)=>i.l(kh(h,t,a,p),{u_world:v}),ic=(h,t,a,p)=>{const v=i.ag/a.tileSize;return{u_matrix:h,u_camera_to_center_distance:t.getCameraToCenterDistance(p),u_extrude_scale:[t.pixelsToGLUnits[0]/v,t.pixelsToGLUnits[1]/v]}},oc=(h,t,a=1)=>({u_matrix:h,u_color:t.toRenderColor(null),u_overlay:0,u_overlay_scale:a}),zh=i.ab.mat4.create(),bl=(h,t,a,p,v,b,E)=>{const k=h.transform,O=k.projection.name==="globe",N=O?i.cN(k.zoom,t.canonical)*k._pixelsPerMercatorPixel:i.ar(a,1,b),$={u_matrix:t.projMatrix,u_extrude_scale:N,u_intensity:E,u_inv_rot_matrix:zh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){$.u_inv_rot_matrix=p,$.u_merc_center=v,$.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],$.u_zoom_transition=i.ae(k.zoom);const W=v[0]*i.ag,Z=v[1]*i.ag;$.u_up_dir=k.projection.upVector(new i.bT(0,0,0),W,Z)}return $};function Qo(h,[t,a,p,v],[b,E]){if(b===E)return[0,0,0,0];const k=255*(h-1)/(h*(E-b));return[t*k,a*k,p*k,v*k]}function dn(h,t,[a,p]){return a===p?0:.5/h+(t-a)*(h-1)/(h*(p-a))}const wl=(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve,Se,Pe,Me)=>({u_matrix:h,u_normalize_matrix:t,u_globe_matrix:a,u_merc_matrix:p,u_grid_matrix:v,u_tl_parent:b,u_scale_parent:N,u_fade_t:$.mix,u_opacity:$.opacity*W.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:W.paint.get("raster-brightness-min"),u_brightness_high:W.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(W.paint.get("raster-saturation")),u_contrast_factor:i.cP(W.paint.get("raster-contrast")),u_spin_weights:Ga(W.paint.get("raster-hue-rotate")),u_perspective_transform:Z,u_raster_elevation:Y,u_zoom_transition:E,u_merc_center:k,u_cutoff_params:O,u_colorization_mix:Qo(i.cQ,ue,ve),u_colorization_offset:dn(i.cQ,me,ve),u_color_ramp:he,u_texture_offset:[Pe/(Se+2*Pe),Se/(Se+2*Pe)],u_texture_res:[Se+2*Pe,Se+2*Pe],u_emissive_strength:Me});function Ga(h){h*=Math.PI/180;const t=Math.sin(h),a=Math.cos(h);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const yo=.05,Vs=(h,t,a,p,v,b,E,k,O,N,$,W)=>({u_matrix:h,u_normalize_matrix:t,u_globe_matrix:a,u_merc_matrix:p,u_grid_matrix:v,u_tl_parent:b,u_scale_parent:N,u_fade_t:$.mix,u_opacity:$.opacity,u_image0:0,u_image1:1,u_raster_elevation:W,u_zoom_transition:E,u_merc_center:k,u_cutoff_params:O}),Mn=(h,t,a,p,v,b,E,k,O,N)=>({u_particle_texture:h,u_particle_texture_side_len:t,u_tile_offset:a,u_velocity:p,u_color_ramp:b,u_velocity_res:v,u_max_speed:E,u_uv_offset:k,u_data_scale:[255*O[0],255*O[1]],u_data_offset:N,u_particle_pos_scale:1.1,u_particle_pos_offset:[yo,yo]}),Ld=(h,t,a,p,v,b,E,k,O,N)=>({u_particle_texture:h,u_particle_texture_side_len:t,u_velocity:a,u_velocity_res:p,u_max_speed:v,u_speed_factor:b,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:k,u_data_scale:[255*O[0],255*O[1]],u_data_offset:N,u_particle_pos_scale:1.1,u_particle_pos_offset:[yo,yo]}),Dh=i.ab.mat4.create(),Ss=(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve,Se,Pe,Me,Fe)=>{const De=v.transform,Oe={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:De.getCameraToCenterDistance(Se),u_rotate_symbol:+a,u_aspect_ratio:De.width/De.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:E,u_coord_matrix:k,u_is_text:+N,u_elevation_from_sea:O?1:0,u_pitch_with_map:+p,u_texsize:$,u_texsize_icon:W,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Dh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Dh,u_up_vector:[0,-1,0],u_color_adj_mat:Pe,u_icon_transition:Me||0,u_gamma_scale:p?v.transform.getCameraToCenterDistance(Se)*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Fe||1};return Se.name==="globe"&&(Oe.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],Oe.u_zoom_transition=he,Oe.u_inv_rot_matrix=me,Oe.u_merc_center=ue,Oe.u_camera_forward=De._camera.forward(),Oe.u_ecef_origin=i.cR(De.globeMatrix,Y.toUnwrapped()),Oe.u_tile_matrix=Float32Array.from(De.globeMatrix),Oe.u_up_vector=ve),Oe},es=(h,t,a,p)=>({u_matrix:h,u_emissive_strength:t,u_opacity:a,u_color:p}),Ni=(h,t,a,p,v,b,E,k,O)=>i.l(function(N,$,W,Z,Y,he){const{width:ue,height:me}=Z.imageManager.getPixelSize($),ve=Math.pow(2,he.tileID.overscaledZ),Se=he.tileSize*Math.pow(2,Z.transform.tileZoom)/ve,Pe=Se*(he.tileID.canonical.x+he.tileID.wrap*ve),Me=Se*he.tileID.canonical.y;return{u_image:0,u_pattern_tl:W.tl,u_pattern_br:W.br,u_texsize:[ue,me],u_pattern_size:W.displaySize,u_pattern_units_to_pixels:Y?[Z.transform.width,-1*Z.transform.height]:[1/i.ar(he,1,Z.transform.tileZoom),1/i.ar(he,1,Z.transform.tileZoom)],u_pixel_coord_upper:[Pe>>16,Me>>16],u_pixel_coord_lower:[65535&Pe,65535&Me]}}(0,b,E,p,k,O),{u_matrix:h,u_emissive_strength:t,u_opacity:a}),Ts=new Float32Array(i.ab.mat4.identity([])),Oh=(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y=[0,0,0],he)=>{const ue=v.style.light,me=ue.properties.get("position"),ve=[-me.x,-me.y,me.z],Se=i.ab.mat3.create();ue.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Se,-v.transform.angle),i.ab.vec3.transformMat3(ve,ve,Se));const Pe=$.alphaMode==="MASK",Me=ue.properties.get("color").toRenderColor(null),Fe=Z.paint.get("model-ambient-occlusion-intensity"),De=Z.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),Oe=Z.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:h,u_lighting_matrix:t,u_normal_matrix:a,u_node_matrix:p||Ts,u_lightpos:ve,u_lightintensity:ue.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_camera_pos:Y,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+Pe,u_alphaCutoff:$.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[k[0],k[1],k[2],1],u_metallicFactor:O,u_roughnessFactor:N,u_baseColorTexture:So.BaseColor,u_metallicRoughnessTexture:So.MetallicRoughness,u_normalTexture:So.Normal,u_occlusionTexture:So.Occlusion,u_emissionTexture:So.Emission,u_lutTexture:So.LUT,u_color_mix:[De.r,De.g,De.b,Oe],u_aoIntensity:Fe,u_emissive_strength:W,u_occlusionTextureTransform:he||[0,0,0,0]}},jp=(h,t=Ts,a=Ts)=>({u_matrix:h,u_instance:t,u_node_matrix:a}),zd={fillExtrusion:h=>({u_matrix:new i.bJ(h),u_lightpos:new i.bL(h),u_lightintensity:new i.bM(h),u_lightcolor:new i.bL(h),u_vertical_gradient:new i.bM(h),u_opacity:new i.bM(h),u_edge_radius:new i.bM(h),u_width_scale:new i.bM(h),u_ao:new i.bK(h),u_height_type:new i.bN(h),u_base_type:new i.bN(h),u_tile_id:new i.bL(h),u_zoom_transition:new i.bM(h),u_inv_rot_matrix:new i.bJ(h),u_merc_center:new i.bK(h),u_up_dir:new i.bL(h),u_height_lift:new i.bM(h),u_flood_light_color:new i.bL(h),u_vertical_scale:new i.bM(h),u_flood_light_intensity:new i.bM(h),u_ground_shadow_factor:new i.bL(h)}),fillExtrusionDepth:h=>({u_matrix:new i.bJ(h),u_edge_radius:new i.bM(h),u_width_scale:new i.bM(h),u_vertical_scale:new i.bM(h),u_height_type:new i.bN(h),u_base_type:new i.bN(h)}),fillExtrusionPattern:h=>({u_matrix:new i.bJ(h),u_lightpos:new i.bL(h),u_lightintensity:new i.bM(h),u_lightcolor:new i.bL(h),u_vertical_gradient:new i.bM(h),u_height_factor:new i.bM(h),u_edge_radius:new i.bM(h),u_width_scale:new i.bM(h),u_ao:new i.bK(h),u_height_type:new i.bN(h),u_base_type:new i.bN(h),u_tile_id:new i.bL(h),u_zoom_transition:new i.bM(h),u_inv_rot_matrix:new i.bJ(h),u_merc_center:new i.bK(h),u_up_dir:new i.bL(h),u_height_lift:new i.bM(h),u_image:new i.bN(h),u_texsize:new i.bK(h),u_pixel_coord_upper:new i.bK(h),u_pixel_coord_lower:new i.bK(h),u_tile_units_to_pixels:new i.bM(h),u_opacity:new i.bM(h)}),fillExtrusionGroundEffect:h=>({u_matrix:new i.bJ(h),u_opacity:new i.bM(h),u_ao_pass:new i.bM(h),u_meter_to_tile:new i.bM(h),u_ao:new i.bK(h),u_flood_light_intensity:new i.bM(h),u_flood_light_color:new i.bL(h),u_attenuation:new i.bM(h),u_edge_radius:new i.bM(h),u_fb:new i.bN(h),u_fb_size:new i.bM(h),u_dynamic_offset:new i.bM(h)}),fill:h=>({u_matrix:new i.bJ(h),u_emissive_strength:new i.bM(h)}),fillPattern:h=>({u_matrix:new i.bJ(h),u_emissive_strength:new i.bM(h),u_image:new i.bN(h),u_texsize:new i.bK(h),u_pixel_coord_upper:new i.bK(h),u_pixel_coord_lower:new i.bK(h),u_tile_units_to_pixels:new i.bM(h)}),fillOutline:h=>({u_matrix:new i.bJ(h),u_emissive_strength:new i.bM(h),u_world:new i.bK(h)}),fillOutlinePattern:h=>({u_matrix:new i.bJ(h),u_emissive_strength:new i.bM(h),u_world:new i.bK(h),u_image:new i.bN(h),u_texsize:new i.bK(h),u_pixel_coord_upper:new i.bK(h),u_pixel_coord_lower:new i.bK(h),u_tile_units_to_pixels:new i.bM(h)}),circle:i.cS,collisionBox:h=>({u_matrix:new i.bJ(h),u_camera_to_center_distance:new i.bM(h),u_extrude_scale:new i.bK(h)}),collisionCircle:h=>({u_matrix:new i.bJ(h),u_inv_matrix:new i.bJ(h),u_camera_to_center_distance:new i.bM(h),u_viewport_size:new i.bK(h)}),debug:h=>({u_color:new i.cz(h),u_matrix:new i.bJ(h),u_overlay:new i.bN(h),u_overlay_scale:new i.bM(h)}),clippingMask:h=>({u_matrix:new i.bJ(h)}),heatmap:h=>({u_extrude_scale:new i.bM(h),u_intensity:new i.bM(h),u_matrix:new i.bJ(h),u_inv_rot_matrix:new i.bJ(h),u_merc_center:new i.bK(h),u_tile_id:new i.bL(h),u_zoom_transition:new i.bM(h),u_up_dir:new i.bL(h)}),heatmapTexture:h=>({u_image:new i.bN(h),u_color_ramp:new i.bN(h),u_opacity:new i.bM(h)}),hillshade:h=>({u_matrix:new i.bJ(h),u_image:new i.bN(h),u_latrange:new i.bK(h),u_light:new i.bK(h),u_shadow:new i.cz(h),u_highlight:new i.cz(h),u_emissive_strength:new i.bM(h),u_accent:new i.cz(h)}),hillshadePrepare:h=>({u_matrix:new i.bJ(h),u_image:new i.bN(h),u_dimension:new i.bK(h),u_zoom:new i.bM(h)}),line:i.cT,linePattern:i.cU,raster:h=>({u_matrix:new i.bJ(h),u_normalize_matrix:new i.bJ(h),u_globe_matrix:new i.bJ(h),u_merc_matrix:new i.bJ(h),u_grid_matrix:new i.cA(h),u_tl_parent:new i.bK(h),u_scale_parent:new i.bM(h),u_fade_t:new i.bM(h),u_opacity:new i.bM(h),u_image0:new i.bN(h),u_image1:new i.bN(h),u_brightness_low:new i.bM(h),u_brightness_high:new i.bM(h),u_saturation_factor:new i.bM(h),u_contrast_factor:new i.bM(h),u_spin_weights:new i.bL(h),u_perspective_transform:new i.bK(h),u_raster_elevation:new i.bM(h),u_zoom_transition:new i.bM(h),u_merc_center:new i.bK(h),u_cutoff_params:new i.ca(h),u_colorization_mix:new i.ca(h),u_colorization_offset:new i.bM(h),u_color_ramp:new i.bN(h),u_texture_offset:new i.bK(h),u_texture_res:new i.bK(h),u_emissive_strength:new i.bM(h)}),rasterParticle:h=>({u_matrix:new i.bJ(h),u_normalize_matrix:new i.bJ(h),u_globe_matrix:new i.bJ(h),u_merc_matrix:new i.bJ(h),u_grid_matrix:new i.cA(h),u_tl_parent:new i.bK(h),u_scale_parent:new i.bM(h),u_fade_t:new i.bM(h),u_opacity:new i.bM(h),u_image0:new i.bN(h),u_image1:new i.bN(h),u_raster_elevation:new i.bM(h),u_zoom_transition:new i.bM(h),u_merc_center:new i.bK(h),u_cutoff_params:new i.ca(h)}),rasterParticleTexture:h=>({u_texture:new i.bN(h),u_opacity:new i.bM(h)}),rasterParticleDraw:h=>({u_particle_texture:new i.bN(h),u_particle_texture_side_len:new i.bM(h),u_tile_offset:new i.bK(h),u_velocity:new i.bN(h),u_color_ramp:new i.bN(h),u_velocity_res:new i.bK(h),u_max_speed:new i.bM(h),u_uv_offset:new i.bK(h),u_data_scale:new i.bK(h),u_data_offset:new i.bM(h),u_particle_pos_scale:new i.bM(h),u_particle_pos_offset:new i.bK(h)}),rasterParticleUpdate:h=>({u_particle_texture:new i.bN(h),u_particle_texture_side_len:new i.bM(h),u_velocity:new i.bN(h),u_velocity_res:new i.bK(h),u_max_speed:new i.bM(h),u_speed_factor:new i.bM(h),u_reset_rate:new i.bM(h),u_rand_seed:new i.bM(h),u_uv_offset:new i.bK(h),u_data_scale:new i.bK(h),u_data_offset:new i.bM(h),u_particle_pos_scale:new i.bM(h),u_particle_pos_offset:new i.bK(h)}),symbol:h=>({u_is_size_zoom_constant:new i.bN(h),u_is_size_feature_constant:new i.bN(h),u_size_t:new i.bM(h),u_size:new i.bM(h),u_camera_to_center_distance:new i.bM(h),u_rotate_symbol:new i.bN(h),u_aspect_ratio:new i.bM(h),u_fade_change:new i.bM(h),u_matrix:new i.bJ(h),u_label_plane_matrix:new i.bJ(h),u_coord_matrix:new i.bJ(h),u_is_text:new i.bN(h),u_elevation_from_sea:new i.bN(h),u_pitch_with_map:new i.bN(h),u_texsize:new i.bK(h),u_texsize_icon:new i.bK(h),u_texture:new i.bN(h),u_texture_icon:new i.bN(h),u_gamma_scale:new i.bM(h),u_device_pixel_ratio:new i.bM(h),u_tile_id:new i.bL(h),u_zoom_transition:new i.bM(h),u_inv_rot_matrix:new i.bJ(h),u_merc_center:new i.bK(h),u_camera_forward:new i.bL(h),u_tile_matrix:new i.bJ(h),u_up_vector:new i.bL(h),u_ecef_origin:new i.bL(h),u_is_halo:new i.bN(h),u_icon_transition:new i.bM(h),u_color_adj_mat:new i.bJ(h),u_scale_factor:new i.bM(h)}),background:h=>({u_matrix:new i.bJ(h),u_emissive_strength:new i.bM(h),u_opacity:new i.bM(h),u_color:new i.cz(h)}),backgroundPattern:h=>({u_matrix:new i.bJ(h),u_emissive_strength:new i.bM(h),u_opacity:new i.bM(h),u_image:new i.bN(h),u_pattern_tl:new i.bK(h),u_pattern_br:new i.bK(h),u_texsize:new i.bK(h),u_pattern_size:new i.bK(h),u_pixel_coord_upper:new i.bK(h),u_pixel_coord_lower:new i.bK(h),u_pattern_units_to_pixels:new i.bK(h)}),terrainRaster:h=>({u_matrix:new i.bJ(h),u_image0:new i.bN(h),u_skirt_height:new i.bM(h),u_ground_shadow_factor:new i.bL(h)}),skybox:h=>({u_matrix:new i.bJ(h),u_sun_direction:new i.bL(h),u_cubemap:new i.bN(h),u_opacity:new i.bM(h),u_temporal_offset:new i.bM(h)}),skyboxGradient:h=>({u_matrix:new i.bJ(h),u_color_ramp:new i.bN(h),u_center_direction:new i.bL(h),u_radius:new i.bM(h),u_opacity:new i.bM(h),u_temporal_offset:new i.bM(h)}),skyboxCapture:h=>({u_matrix_3f:new i.cA(h),u_sun_direction:new i.bL(h),u_sun_intensity:new i.bM(h),u_color_tint_r:new i.ca(h),u_color_tint_m:new i.ca(h),u_luminance:new i.bM(h)}),globeRaster:h=>({u_proj_matrix:new i.bJ(h),u_globe_matrix:new i.bJ(h),u_normalize_matrix:new i.bJ(h),u_merc_matrix:new i.bJ(h),u_zoom_transition:new i.bM(h),u_merc_center:new i.bK(h),u_image0:new i.bN(h),u_grid_matrix:new i.cA(h),u_skirt_height:new i.bM(h),u_far_z_cutoff:new i.bM(h),u_frustum_tl:new i.bL(h),u_frustum_tr:new i.bL(h),u_frustum_br:new i.bL(h),u_frustum_bl:new i.bL(h),u_globe_pos:new i.bL(h),u_globe_radius:new i.bM(h),u_viewport:new i.bK(h)}),globeAtmosphere:h=>({u_frustum_tl:new i.bL(h),u_frustum_tr:new i.bL(h),u_frustum_br:new i.bL(h),u_frustum_bl:new i.bL(h),u_horizon:new i.bM(h),u_transition:new i.bM(h),u_fadeout_range:new i.bM(h),u_color:new i.ca(h),u_high_color:new i.ca(h),u_space_color:new i.ca(h),u_temporal_offset:new i.bM(h),u_horizon_angle:new i.bM(h)}),model:h=>({u_matrix:new i.bJ(h),u_lighting_matrix:new i.bJ(h),u_normal_matrix:new i.bJ(h),u_node_matrix:new i.bJ(h),u_lightpos:new i.bL(h),u_lightintensity:new i.bM(h),u_lightcolor:new i.bL(h),u_camera_pos:new i.bL(h),u_opacity:new i.bM(h),u_baseColorFactor:new i.ca(h),u_emissiveFactor:new i.ca(h),u_metallicFactor:new i.bM(h),u_roughnessFactor:new i.bM(h),u_baseTextureIsAlpha:new i.bN(h),u_alphaMask:new i.bN(h),u_alphaCutoff:new i.bM(h),u_baseColorTexture:new i.bN(h),u_metallicRoughnessTexture:new i.bN(h),u_normalTexture:new i.bN(h),u_occlusionTexture:new i.bN(h),u_emissionTexture:new i.bN(h),u_lutTexture:new i.bN(h),u_color_mix:new i.ca(h),u_aoIntensity:new i.bM(h),u_emissive_strength:new i.bM(h),u_occlusionTextureTransform:new i.ca(h)}),modelDepth:h=>({u_matrix:new i.bJ(h),u_instance:new i.bJ(h),u_node_matrix:new i.bJ(h)}),groundShadow:h=>({u_matrix:new i.bJ(h),u_ground_shadow_factor:new i.bL(h)}),stars:h=>({u_matrix:new i.bJ(h),u_up:new i.bL(h),u_right:new i.bL(h),u_intensity_multiplier:new i.bM(h)}),snowParticle:h=>({u_modelview:new i.bJ(h),u_projection:new i.bJ(h),u_time:new i.bM(h),u_cam_pos:new i.bL(h),u_velocityConeAperture:new i.bM(h),u_velocity:new i.bM(h),u_horizontalOscillationRadius:new i.bM(h),u_horizontalOscillationRate:new i.bM(h),u_boxSize:new i.bM(h),u_billboardSize:new i.bM(h),u_simpleShapeParameters:new i.bK(h),u_screenSize:new i.bK(h),u_thinningCenterPos:new i.bK(h),u_thinningShape:new i.bL(h),u_thinningAffectedRatio:new i.bM(h),u_thinningParticleOffset:new i.bM(h),u_particleColor:new i.ca(h),u_direction:new i.bL(h)}),rainParticle:h=>({u_modelview:new i.bJ(h),u_projection:new i.bJ(h),u_time:new i.bM(h),u_cam_pos:new i.bL(h),u_texScreen:new i.bN(h),u_velocityConeAperture:new i.bM(h),u_velocity:new i.bM(h),u_boxSize:new i.bM(h),u_rainDropletSize:new i.bK(h),u_distortionStrength:new i.bM(h),u_rainDirection:new i.bL(h),u_color:new i.ca(h),u_screenSize:new i.bK(h),u_thinningCenterPos:new i.bK(h),u_thinningShape:new i.bL(h),u_thinningAffectedRatio:new i.bM(h),u_thinningParticleOffset:new i.bM(h),u_shapeDirectionalPower:new i.bM(h),u_shapeNormalPower:new i.bM(h),u_mode:new i.bM(h)}),vignette:h=>({u_vignetteShape:new i.bL(h),u_vignetteColor:new i.ca(h)}),occlusion:h=>({u_matrix:new i.bJ(h),u_anchorPos:new i.bL(h),u_screenSizePx:new i.bK(h),u_occluderSizePx:new i.bK(h),u_color:new i.ca(h)})};class la{constructor(t,a,p,v){this.id=la.uniqueIdxCounter,la.uniqueIdxCounter++,this.context=t;const b=t.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||v||a.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=la.uniqueIdxCounter,la.uniqueIdxCounter++;const a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}la.uniqueIdxCounter=0;const Fh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ou{constructor(t,a,p,v,b,E){this.length=a.length,this.attributes=p,this.itemSize=a.bytesPerElement,this.dynamicDraw=v,this.instanceCount=E,this.context=t;const k=t.gl;this.buffer=k.createBuffer(),t.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||b||a.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let p=0;p<this.attributes.length;p++){const v=a.attributes[this.attributes[p].name];v!==void 0&&t.enableVertexAttribArray(v)}}setVertexAttribPointers(t,a,p){for(let v=0;v<this.attributes.length;v++){const b=this.attributes[v],E=a.attributes[b.name];E!==void 0&&t.vertexAttribPointer(E,b.components,t[Fh[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(t,a,p){for(let v=0;v<this.attributes.length;v++){const b=a.attributes[this.attributes[v].name];b!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(b,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ts{constructor(t,a,p,v,b){this.context=t,this.width=a,this.height=p;const E=this.framebuffer=t.gl.createFramebuffer();v&&(this.colorAttachment=new Gc(t,E)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new ba(t,E):new Ql(t,E))}destroy(){const t=this.context.gl;if(this.colorAttachment){const a=this.colorAttachment.get();a&&t.deleteTexture(a)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const a=this.depthAttachment.get();a&&t.deleteRenderbuffer(a)}else{const a=this.depthAttachment.get();a&&t.deleteTexture(a)}t.deleteFramebuffer(this.framebuffer)}}class Gs{constructor(t,a){this.gl=t,this.clearColor=new Td(this),this.clearDepth=new bg(this),this.clearStencil=new Th(this),this.colorMask=new Eh(this),this.depthMask=new Ri(this),this.stencilMask=new Ed(this),this.stencilFunc=new Cd(this),this.stencilOp=new Au(this),this.stencilTest=new rm(this),this.depthRange=new Uc(this),this.depthTest=new vl(this),this.depthFunc=new Md(this),this.blend=new Co(this),this.blendFunc=new Ch(this),this.blendColor=new Mh(this),this.blendEquation=new Ih(this),this.cullFace=new Ah(this),this.cullFaceSide=new Pu(this),this.frontFace=new $c(this),this.program=new Id(this),this.activeTexture=new Ad(this),this.viewport=new Ru(this),this.bindFramebuffer=new Ph(this),this.bindRenderbuffer=new im(this),this.bindTexture=new Vc(this),this.bindVertexBuffer=new wg(this),this.bindElementBuffer=new Sg(this),this.bindVertexArrayOES=new Np(this),this.pixelStoreUnpack=new Jl(this),this.pixelStoreUnpackPremultiplyAlpha=new om(this),this.pixelStoreUnpackFlipY=new ku(this),this.options=a?{...a}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=a&&!!a.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxPointSize=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a,p){return new la(this,t,a,p)}createVertexBuffer(t,a,p,v,b){return new Ou(this,t,a,p,v,b)}createRenderbuffer(t,a,p){const v=this.gl,b=v.createRenderbuffer();return this.bindRenderbuffer.set(b),v.renderbufferStorage(v.RENDERBUFFER,t,a,p),this.bindRenderbuffer.set(null),b}createFramebuffer(t,a,p,v){return new ts(this,t,a,p,v)}clear({color:t,depth:a,stencil:p,colorMask:v}){const b=this.gl;let E=0;t&&(E|=b.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(v||[!0,!0,!0,!0])),a!==void 0&&(E|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),p!==void 0&&(E|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),b.clear(E)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){i.bn(t.blendFunction,vr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let qc;function Bh(h,t,a,p,v,b,E){const k=h.context,O=k.gl,N=h.transform,$=h.getOrCreateProgram("collisionBox"),W=[];let Z=0,Y=0;for(let Me=0;Me<p.length;Me++){const Fe=p[Me],De=t.getTile(Fe),Oe=De.getBucket(a);if(!Oe)continue;const ze=Bi(Fe,Oe,N);let Ne=ze;v[0]===0&&v[1]===0||(Ne=h.translatePosMatrix(ze,De,v,b));const je=E?Oe.textCollisionBox:Oe.iconCollisionBox,pt=Oe.collisionCircleArray;if(pt.length>0){const ot=i.ab.mat4.create(),Ve=Ne;i.ab.mat4.mul(ot,Oe.placementInvProjMatrix,N.glCoordMatrix),i.ab.mat4.mul(ot,ot,Oe.placementViewportMatrix),W.push({circleArray:pt,circleOffset:Y,transform:Ve,invTransform:ot,projection:Oe.getProjection()}),Z+=pt.length/4,Y=Z}je&&(h.terrain&&h.terrain.setupElevationDraw(De,$),$.draw(h,O.LINES,kn.disabled,Jn.disabled,h.colorModeForRenderPass(),Nn.disabled,ic(Ne,N,De,Oe.getProjection()),a.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,N.zoom,null,[je.collisionVertexBuffer,je.collisionVertexBufferExt]))}if(!E||!W.length)return;const he=h.getOrCreateProgram("collisionCircle"),ue=new i.cV;ue.resize(4*Z),ue._trim();let me=0;for(const Me of W)for(let Fe=0;Fe<Me.circleArray.length/4;Fe++){const De=4*Fe,Oe=Me.circleArray[De+0],ze=Me.circleArray[De+1],Ne=Me.circleArray[De+2],je=Me.circleArray[De+3];ue.emplace(me++,Oe,ze,Ne,je,0),ue.emplace(me++,Oe,ze,Ne,je,1),ue.emplace(me++,Oe,ze,Ne,je,2),ue.emplace(me++,Oe,ze,Ne,je,3)}(!qc||qc.length<2*Z)&&(qc=function(Me){const Fe=2*Me,De=new i.aU;De.resize(Fe),De._trim();for(let Oe=0;Oe<Fe;Oe++){const ze=6*Oe;De.uint16[ze+0]=4*Oe+0,De.uint16[ze+1]=4*Oe+1,De.uint16[ze+2]=4*Oe+2,De.uint16[ze+3]=4*Oe+2,De.uint16[ze+4]=4*Oe+3,De.uint16[ze+5]=4*Oe+0}return De}(Z));const ve=k.createIndexBuffer(qc,!0),Se=k.createVertexBuffer(ue,i.cW.members,!0);for(const Me of W){const Fe={u_matrix:Me.transform,u_inv_matrix:Me.invTransform,u_camera_to_center_distance:(Pe=N).getCameraToCenterDistance(Me.projection),u_viewport_size:[Pe.width,Pe.height]};he.draw(h,O.TRIANGLES,kn.disabled,Jn.disabled,h.colorModeForRenderPass(),Nn.disabled,Fe,a.id,Se,ve,i.b7.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,N.zoom)}var Pe;Se.destroy(),ve.destroy()}const qa=i.ab.mat4.create();function Wc(h){const t=h._camera.getWorldToCamera(h.worldSize,1),a=i.ab.mat4.multiply([],t,h.globeMatrix);i.ab.mat4.invert(a,a);const p=[0,0,0],v=[0,1,0,0];return i.ab.vec4.transformMat4(v,v,a),p[0]=v[0],p[1]=v[1],p[2]=v[2],i.ab.vec3.normalize(p,p),p}function Up({width:h,height:t,anchor:a,textOffset:p,textScale:v},b){const{horizontalAlign:E,verticalAlign:k}=i.bD(a),O=-(E-.5)*h,N=-(k-.5)*t,$=i.bC(a,p);return new i.P((O/v+$[0])*b,(N/v+$[1])*b)}function qs(h,t,a,p,v,b,E,k,O,N,$){const W=h.text.placedSymbolArray,Z=h.text.dynamicLayoutVertexArray,Y=h.icon.dynamicLayoutVertexArray,he={},ue=h.getProjection(),me=dl(k,ue,b),ve=b.elevation,Se=ue.upVectorScale(k.canonical,b.center.lat,b.worldSize).metersToTile;Z.clear();for(let Pe=0;Pe<W.length;Pe++){const Me=W.get(Pe),{tileAnchorX:Fe,tileAnchorY:De,numGlyphs:Oe}=Me,ze=Me.hidden||!Me.crossTileID||h.allowVerticalPlacement&&!Me.placedOrientation?null:p[Me.crossTileID];if(ze){let Ne=0,je=0,pt=0;if(ve){const xt=ve?ve.getAtTileOffset(k,Fe,De):0,[Gt,At,Ct]=ue.upVector(k.canonical,Fe,De);Ne=xt*Gt*Se,je=xt*At*Se,pt=xt*Ct*Se}let[ot,Ve,Je,It]=ui(Me.projectedAnchorX+Ne,Me.projectedAnchorY+je,Me.projectedAnchorZ+pt,a?me:E);const kt=Wf(b.getCameraToCenterDistance(ue),It);let Ht=v.evaluateSizeForFeature(h.textSizeData,N,Me)*kt/i.bw;a&&(Ht*=h.tilePixelRatio/O);const ut=Up(ze,Ht);a?({x:ot,y:Ve,z:Je}=ue.projectTilePoint(Fe+ut.x,De+ut.y,k.canonical),[ot,Ve,Je]=ui(ot+Ne,Ve+je,Je+pt,E)):(t&&ut._rotate(-b.angle),ot+=ut.x,Ve+=ut.y,Je=0);const Lt=h.allowVerticalPlacement&&Me.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let xt=0;xt<Oe;xt++)i.bt(Z,ot,Ve,Je,Lt);$&&Me.associatedIconIndex>=0&&(he[Me.associatedIconIndex]={x:ot,y:Ve,z:Je,angle:Lt})}else ka(Oe,Z)}if($){Y.clear();const Pe=h.icon.placedSymbolArray;for(let Me=0;Me<Pe.length;Me++){const Fe=Pe.get(Me),{numGlyphs:De}=Fe,Oe=he[Me];if(Fe.hidden||!Oe)ka(De,Y);else{const{x:ze,y:Ne,z:je,angle:pt}=Oe;for(let ot=0;ot<De;ot++)i.bt(Y,ze,Ne,je,pt)}}h.icon.dynamicLayoutVertexBuffer.updateData(Y)}h.text.dynamicLayoutVertexBuffer.updateData(Z)}function Jr(h,t,a,p,v,b,E={}){const k=a.paint.get("icon-translate"),O=a.paint.get("text-translate"),N=a.paint.get("icon-translate-anchor"),$=a.paint.get("text-translate-anchor"),W=a.layout.get("icon-rotation-alignment"),Z=a.layout.get("text-rotation-alignment"),Y=a.layout.get("icon-pitch-alignment"),he=a.layout.get("text-pitch-alignment"),ue=a.layout.get("icon-keep-upright"),me=a.layout.get("text-keep-upright"),ve=a.paint.get("icon-color-saturation"),Se=a.paint.get("icon-color-contrast"),Pe=a.paint.get("icon-color-brightness-min"),Me=a.paint.get("icon-color-brightness-max"),Fe=a.layout.get("symbol-elevation-reference")==="sea",De=h.context,Oe=De.gl,ze=h.transform,Ne=W==="map",je=Z==="map",pt=Y==="map",ot=he==="map",Ve=a.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Je=!1;const It=h.depthModeForSublayer(0,kn.ReadOnly),kt=[i.at(ze.center.lng),i.aA(ze.center.lat)],Ht=a.layout.get("text-variable-anchor"),ut=ze.projection.name==="globe",Lt=[],xt=[0,-1,0];for(const Gt of p){const At=t.getTile(Gt),Ct=At.getBucket(a);if(!Ct||Ct.projection.name==="mercator"&&ut||Ct.fullyClipped)continue;const on=Ct.projection.name==="globe",Zt=on?i.ae(ze.zoom):0,cn=dl(Gt,Ct.getProjection(),ze),mn=ze.calculatePixelsToTileUnitsMatrix(At),jn=Ht&&Ct.hasTextData(),In=Ct.hasIconTextFit()&&jn&&Ct.hasIconData(),Rn=Ct.getProjection().createInversionMatrix(ze,Gt.canonical),Gn=Br=>{ze.depthOcclusionForSymbolsAndCircles&&(a.hasInitialOcclusionOpacityProperties||h.terrain)&&(Br.push("DEPTH_D24"),Br.push("DEPTH_OCCLUSION"))},br=()=>{const Br=Ne&&a.layout.get("symbol-placement")!=="point",$r=[];Gn($r);const yi=Br||In,Ro=a.paint.get("icon-image-cross-fade").constantOr(0);h.terrainRenderModeElevated()&&pt&&$r.push("PITCH_WITH_MAP_TERRAIN"),on&&($r.push("PROJECTION_GLOBE_VIEW"),yi&&$r.push("PROJECTED_POS_ON_VIEWPORT")),Ro>0&&$r.push("ICON_TRANSITION"),Ct.icon.zOffsetVertexBuffer&&$r.push("Z_OFFSET"),ve===0&&Se===0&&Pe===0&&Me===1||$r.push("COLOR_ADJUSTMENT"),Ct.sdfIcons&&$r.push("RENDER_SDF");const Yi=Ct.icon.programConfigurations.get(a.id),qi=h.getOrCreateProgram("symbol",{config:Yi,defines:$r}),ro=At.imageAtlasTexture?At.imageAtlasTexture.size:[0,0],Ki=Ct.iconSizeData,Ei=i.bp(Ki,ze.zoom),Gr=pt||ze.pitch!==0,ii=Ns(cn,At.tileID.canonical,pt,Ne,ze,Ct.getProjection(),mn),Mr=_o(cn,At.tileID.canonical,pt,Ne,ze,Ct.getProjection(),mn),Ci=h.translatePosMatrix(Mr,At,k,N,!0),io=h.translatePosMatrix(cn,At,k,N),ei=yi?qa:ii,Ho=Ne&&!pt&&!Br;let As=xt;!ut&&!ze.mercatorFromTransition||Ne||(As=Wc(ze));const ms=on?As:xt,gs=a.getColorAdjustmentMatrix(ve,Se,Pe,Me),is=Ss(Ki.kind,Ei,Ho,pt,h,io,ei,Ci,Fe,!1,ro,[0,0],!0,Gt,Zt,kt,Rn,ms,Ct.getProjection(),gs,Ro),os=At.imageAtlasTexture?At.imageAtlasTexture:null,_s=a.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear,Mi=Ct.sdfIcons||h.options.rotating||h.options.zooming||_s||Gr?Oe.LINEAR:Oe.NEAREST,Ja=Ct.sdfIcons&&a.paint.get("icon-halo-width").constantOr(1)!==0,gc=h.terrain&&pt&&Br?i.ab.mat4.invert(i.ab.mat4.create(),ii):qa;if(Br&&Ct.icon){const Xd=ze.elevation,Kh=Xd?Xd.getAtTileOffsetFunc(Gt,ze.center.lat,ze.worldSize,Ct.getProjection()):null,Yd=oa(cn,At.tileID.canonical,pt,Ne,ze,Ct.getProjection(),mn);Dc(Ct,cn,h,!1,Yd,Mr,pt,ue,Kh,Gt)}return{program:qi,buffers:Ct.icon,uniformValues:is,atlasTexture:os,atlasTextureIcon:null,atlasInterpolation:Mi,atlasInterpolationIcon:null,isSDF:Ct.sdfIcons,hasHalo:Ja,tile:At,labelPlaneMatrixInv:gc}},dr=()=>{const Br=je&&a.layout.get("symbol-placement")!=="point",$r=[],yi=Br||Ht||In;h.terrainRenderModeElevated()&&ot&&$r.push("PITCH_WITH_MAP_TERRAIN"),on&&($r.push("PROJECTION_GLOBE_VIEW"),yi&&$r.push("PROJECTED_POS_ON_VIEWPORT")),Ct.text.zOffsetVertexBuffer&&$r.push("Z_OFFSET"),Ct.iconsInText&&$r.push("RENDER_TEXT_AND_SYMBOL"),$r.push("RENDER_SDF"),Gn($r);const Ro=Ct.text.programConfigurations.get(a.id),Yi=h.getOrCreateProgram("symbol",{config:Ro,defines:$r});let qi,ro=[0,0],Ki=null;const Ei=Ct.textSizeData;Ct.iconsInText&&(ro=At.imageAtlasTexture?At.imageAtlasTexture.size:[0,0],Ki=At.imageAtlasTexture?At.imageAtlasTexture:null,qi=ot||ze.pitch!==0||h.options.rotating||h.options.zooming||Ei.kind==="composite"||Ei.kind==="camera"?Oe.LINEAR:Oe.NEAREST);const Gr=At.glyphAtlasTexture?At.glyphAtlasTexture.size:[0,0],ii=a.layout.get("text-size-scale-range"),Mr=i.aw(h.scaleFactor,ii[0],ii[1]),Ci=i.bp(Ei,ze.zoom,Mr),io=Ns(cn,At.tileID.canonical,ot,je,ze,Ct.getProjection(),mn),ei=_o(cn,At.tileID.canonical,ot,je,ze,Ct.getProjection(),mn),Ho=h.translatePosMatrix(ei,At,O,$,!0),As=h.translatePosMatrix(cn,At,O,$),ms=yi?qa:io,gs=je&&!ot&&!Br;let is=xt;!ut&&!ze.mercatorFromTransition||je||(is=Wc(ze));const os=Ss(Ei.kind,Ci,gs,ot,h,As,ms,Ho,Fe,!0,Gr,ro,!0,Gt,Zt,kt,Rn,on?is:xt,Ct.getProjection(),null,null,Mr),_s=At.glyphAtlasTexture?At.glyphAtlasTexture:null,Mi=Oe.LINEAR,Ja=a.paint.get("text-halo-width").constantOr(1)!==0,gc=h.terrain&&ot&&Br?i.ab.mat4.invert(i.ab.mat4.create(),io):qa;if(Br&&Ct.text){const Xd=ze.elevation,Kh=Xd?Xd.getAtTileOffsetFunc(Gt,ze.center.lat,ze.worldSize,Ct.getProjection()):null,Yd=oa(cn,At.tileID.canonical,ot,je,ze,Ct.getProjection(),mn);Dc(Ct,cn,h,!0,Yd,ei,ot,me,Kh,Gt)}return{program:Yi,buffers:Ct.text,uniformValues:os,atlasTexture:_s,atlasTextureIcon:Ki,atlasInterpolation:Mi,atlasInterpolationIcon:qi,isSDF:!0,hasHalo:Ja,tile:At,labelPlaneMatrixInv:gc}},Yr=Ct.icon.segments.get().length,ci=Ct.text.segments.get().length,xr=Yr&&!E.onlyText?br():null,Fr=ci&&!E.onlyIcons?dr():null,Wn=a.paint.get("icon-opacity").constantOr(1),Cn=a.paint.get("text-opacity").constantOr(1);if(Ve&&Ct.canOverlap){Je=!0;const Br=Wn&&!E.onlyText?Ct.icon.segments.get():[],$r=Cn&&!E.onlyIcons?Ct.text.segments.get():[];for(const yi of Br)Lt.push({segments:new i.b7([yi]),sortKey:yi.sortKey,state:xr});for(const yi of $r)Lt.push({segments:new i.b7([yi]),sortKey:yi.sortKey,state:Fr})}else E.onlyText||Lt.push({segments:Wn?Ct.icon.segments:new i.b7([]),sortKey:0,state:xr}),E.onlyIcons||Lt.push({segments:Cn?Ct.text.segments:new i.b7([]),sortKey:0,state:Fr})}Je&&Lt.sort((Gt,At)=>Gt.sortKey-At.sortKey);for(const Gt of Lt){const At=Gt.state;if(At)if(h.terrain?h.terrain.setupElevationDraw(At.tile,At.program,{useDepthForOcclusion:ze.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:At.labelPlaneMatrixInv}):h.setupDepthForOcclusion(ze.depthOcclusionForSymbolsAndCircles,At.program),De.activeTexture.set(Oe.TEXTURE0),At.atlasTexture&&At.atlasTexture.bind(At.atlasInterpolation,Oe.CLAMP_TO_EDGE,!0),At.atlasTextureIcon&&(De.activeTexture.set(Oe.TEXTURE1),At.atlasTextureIcon&&At.atlasTextureIcon.bind(At.atlasInterpolationIcon,Oe.CLAMP_TO_EDGE,!0)),h.uploadCommonLightUniforms(h.context,At.program),At.hasHalo){const Ct=At.uniformValues;Ct.u_is_halo=1,Hc(At.buffers,Gt.segments,a,h,At.program,It,v,b,Ct,2),Ct.u_is_halo=0}else{if(At.isSDF){const Ct=At.uniformValues;At.hasHalo&&(Ct.u_is_halo=1,Hc(At.buffers,Gt.segments,a,h,At.program,It,v,b,Ct,1)),Ct.u_is_halo=0}Hc(At.buffers,Gt.segments,a,h,At.program,It,v,b,At.uniformValues,1)}}}function Hc(h,t,a,p,v,b,E,k,O,N){const $=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.iconTransitioningVertexBuffer,h.globeExtVertexBuffer,h.zOffsetVertexBuffer];v.draw(p,p.context.gl.TRIANGLES,b,E,k,Nn.disabled,O,a.id,h.layoutVertexBuffer,h.indexBuffer,t,a.paint,p.transform.zoom,h.programConfigurations.get(a.id),$,N)}function Zc(h,t,a,p,v,b,E){const k=h.context.gl,O=a.paint.get("fill-pattern"),N=a.is3D(),$=N?h.stencilModeFor3D():Jn.disabled,W=O&&O.constantOr(1);let Z,Y,he,ue,me;E?(Y=W&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=k.LINES):(Y=W?"fillPattern":"fill",Z=k.TRIANGLES);for(const ve of p){const Se=t.getTile(ve);if(W&&!Se.patternsLoaded())continue;const Pe=Se.getBucket(a);if(!Pe)continue;h.prepareDrawTile();const Me=Pe.programConfigurations.get(a.id),Fe=h.isTileAffectedByFog(ve),De=h.getOrCreateProgram(Y,{config:Me,overrideFog:Fe});W&&(h.context.activeTexture.set(k.TEXTURE0),Se.imageAtlasTexture&&Se.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Me.updatePaintBuffers());const Oe=O.constantOr(null);if(Oe&&Se.imageAtlas){const je=Se.imageAtlas,pt=i.A.from(Oe),ot=je.patternPositions[pt.getSerializedPrimary()];ot&&Me.setConstantPatternPositions(ot)}const ze=h.translatePosMatrix(ve.projMatrix,Se,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor")),Ne=a.paint.get("fill-emissive-strength");if(E){ue=Pe.indexBuffer2,me=Pe.segments2;const je=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];he=Y==="fillOutlinePattern"&&W?Sa(ze,Ne,h,Se,je):Lh(ze,Ne,je)}else ue=Pe.indexBuffer,me=Pe.segments,he=W?kh(ze,Ne,h,Se):rc(ze,Ne);h.uploadCommonUniforms(h.context,De,ve.toUnwrapped()),De.draw(h,Z,v,N?$:h.stencilModeForClipping(ve),b,Nn.disabled,he,a.id,Pe.layoutVertexBuffer,ue,me,a.paint,h.transform.zoom,Me,void 0)}}function sc(h,t,a,p,v,b,E,k){a.resetLayerRenderingStats(h);const O=h.context,N=O.gl,$=h.transform,W=a.paint.get("fill-extrusion-pattern"),Z=W.constantOr(1),Y=a.paint.get("fill-extrusion-opacity"),he=h.style.enable3dLights(),ue=a.paint.get(he&&!Z?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),me=[a.paint.get("fill-extrusion-ambient-occlusion-intensity"),ue],ve=a.layout.get("fill-extrusion-edge-radius"),Se=ve>0&&!a.paint.get("fill-extrusion-rounded-roof"),Pe=Se?0:ve,Me=$.projection.name==="globe"?i.d3():0,Fe=$.projection.name==="globe",De=Fe?i.ae($.zoom):0,Oe=[i.at($.center.lng),i.aA($.center.lat)],ze=a.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ne=a.paint.get("fill-extrusion-flood-light-color").toRenderColor(ze?null:a.lut).toArray01().slice(0,3),je=a.paint.get("fill-extrusion-flood-light-intensity"),pt=a.paint.get("fill-extrusion-vertical-scale"),ot=a.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Ve=a.paint.get("fill-extrusion-height-alignment"),Je=a.paint.get("fill-extrusion-base-alignment"),It=Oa(h,a.paint.get("fill-extrusion-cutoff-fade-range")),kt=[];let Ht;Fe&&kt.push("PROJECTION_GLOBE_VIEW"),me[0]>0&&kt.push("FAUX_AO"),Se&&kt.push("ZERO_ROOF_RADIUS"),k&&kt.push("HAS_CENTROID"),je>0&&kt.push("FLOOD_LIGHT"),It.shouldRenderCutoff&&kt.push("RENDER_CUTOFF"),ot&&kt.push("RENDER_WALL_MODE");const ut=h.renderPass==="shadow",Lt=h.shadowRenderer,xt=ut&&!!Lt;h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!0);let Gt=[0,0,0];if(Lt){const on=h.style.directionalLight,Zt=h.style.ambientLight;on&&Zt&&(Gt=Bc(h.style,on,Zt)),ut||(kt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Lt.useNormalOffset&&kt.push("NORMAL_OFFSET")),Ht=kt.concat(["SHADOWS_SINGLE_CASCADE"])}const At=xt?"fillExtrusionDepth":Z?"fillExtrusionPattern":"fillExtrusion",Ct=a.getLayerRenderingStats();for(const on of p){const Zt=t.getTile(on),cn=Zt.getBucket(a);if(!cn||cn.projection.name!==$.projection.name)continue;let mn=!1;Lt&&(mn=Lt.getMaxCascadeForTile(on.toUnwrapped())===0);const jn=h.isTileAffectedByFog(on),In=cn.programConfigurations.get(a.id),Rn=h.getOrCreateProgram(At,{config:In,defines:mn?Ht:kt,overrideFog:jn});if(h.terrain&&h.terrain.setupElevationDraw(Zt,Rn,{useMeterToDem:!0}),!cn.centroidVertexBuffer){const Fr=Rn.attributes.a_centroid_pos;Fr!==void 0&&N.vertexAttrib2f(Fr,0,0)}!ut&&Lt&&Lt.setupShadows(Zt.tileID.toUnwrapped(),Rn,"vector-tile",Zt.tileID.overscaledZ),Z&&(h.context.activeTexture.set(N.TEXTURE0),Zt.imageAtlasTexture&&Zt.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),In.updatePaintBuffers());const Gn=W.constantOr(null);if(Gn&&Zt.imageAtlas){const Fr=Zt.imageAtlas,Wn=i.A.from(Gn),Cn=Fr.patternPositions[Wn.getSerializedPrimary()];Cn&&In.setConstantPatternPositions(Cn)}const br=a.paint.get("fill-extrusion-vertical-gradient"),dr=1/cn.tileToMeter;let Yr;if(ut&&Lt){if(Wt(Zt.tileID,cn,h))continue;const Fr=Lt.calculateShadowPassMatrixFromTile(Zt.tileID.toUnwrapped());Yr=$s(Fr,Pe,dr,pt,Ve,Je)}else{const Fr=h.translatePosMatrix(on.expandedProjMatrix,Zt,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Wn=$.projection.createInversionMatrix($,on.canonical);Yr=Z?Du(Fr,h,br,Y,me,Pe,dr,on,Zt,Me,Ve,Je,De,Oe,Wn,Ne,pt):kd(Fr,h,br,Y,me,Pe,dr,on,Me,Ve,Je,De,Oe,Wn,Ne,pt,je,Gt)}h.uploadCommonUniforms(O,Rn,on.toUnwrapped(),null,It);let ci=cn.segments;if($.projection.name==="mercator"&&!ut&&(ci=cn.getVisibleSegments(Zt.tileID,h.terrain,h.transform.getFrustum(0)),!ci.get().length))continue;if(Ct)if(ut)for(const Fr of ci.get())Ct.numRenderedVerticesInShadowPass+=Fr.primitiveLength;else for(const Fr of ci.get())Ct.numRenderedVerticesInTransparentPass+=Fr.primitiveLength;const xr=[];(h.terrain||k)&&xr.push(cn.centroidVertexBuffer),Fe&&xr.push(cn.layoutVertexExtBuffer),ot&&xr.push(cn.wallVertexBuffer),Rn.draw(h,O.gl.TRIANGLES,v,b,E,Nn.backCCW,Yr,a.id,cn.layoutVertexBuffer,cn.indexBuffer,ci,a.paint,h.transform.zoom,In,xr)}h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!1)}function ca(h,t,a,p,v,b,E,k,O,N,$,W,Z,Y,he,ue,me,ve,Se){const Pe=h.context,Me=Pe.gl,Fe=h.transform,De=h.transform.zoom,Oe=[],ze=Oa(h,a.paint.get("fill-extrusion-cutoff-fade-range"));N==="clear"?(Oe.push("CLEAR_SUBPASS"),Se&&(Oe.push("CLEAR_FROM_TEXTURE"),Pe.activeTexture.set(Me.TEXTURE0),Se.bind(Me.LINEAR,Me.CLAMP_TO_EDGE))):N==="sdf"&&Oe.push("SDF_SUBPASS"),me&&Oe.push("HAS_CENTROID"),ze.shouldRenderCutoff&&Oe.push("RENDER_CUTOFF");const Ne=a.layout.get("fill-extrusion-edge-radius"),je=(pt,ot,Ve,Je,It)=>{const kt=ot.programConfigurations.get(a.id),Ht=h.isTileAffectedByFog(pt),ut=h.getOrCreateProgram("fillExtrusionGroundEffect",{config:kt,defines:Oe,overrideFog:Ht}),Lt=((Gt,At,Ct,on,Zt,cn,mn,jn,In,Rn,Gn)=>({u_matrix:At,u_opacity:Ct,u_ao_pass:on?1:0,u_meter_to_tile:Zt,u_ao:cn,u_flood_light_intensity:mn,u_flood_light_color:jn,u_attenuation:In,u_edge_radius:Rn,u_fb:0,u_fb_size:Gn,u_dynamic_offset:1}))(0,Je,$,O,It,[W,Z*It],Y,he,ue,De>=17?0:Ne*It,Se?Se.size[0]:0),xt=[];me&&xt.push(ot.hiddenByLandmarkVertexBuffer),h.uploadCommonUniforms(Pe,ut,pt.toUnwrapped(),null,ze),ut.draw(h,Pe.gl.TRIANGLES,v,b,E,k,Lt,a.id,ot.vertexBuffer,ot.indexBuffer,Ve,a.paint,De,kt,xt)};for(const pt of p){const ot=t.getTile(pt),Ve=ot.getBucket(a);if(!Ve||Ve.projection.name!==Fe.projection.name||!Ve.groundEffect||Ve.groundEffect&&!Ve.groundEffect.hasData())continue;const Je=Ve.groundEffect,It=1/Ve.tileToMeter;{const kt=h.translatePosMatrix(pt.projMatrix,ot,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ht=Je.getDefaultSegment();je(pt,Je,Ht,kt,It)}if(ve)for(let kt=0;kt<4;kt++){const Ht=i.d4[kt](pt),ut=t.getTile(Ht);if(!ut)continue;const Lt=ut.getBucket(a);if(!Lt||Lt.projection.name!==Fe.projection.name||!Lt.groundEffect||Lt.groundEffect&&!Lt.groundEffect.hasData())continue;const xt=Lt.groundEffect;let Gt,At;kt===0?(Gt=[-i.ag,0,0],At=1):kt===1?(Gt=[i.ag,0,0],At=0):kt===2?(Gt=[0,-i.ag,0],At=3):(Gt=[0,i.ag,0],At=2);const Ct=xt.regionSegments[At];if(!Ct)continue;const on=new Float32Array(16);i.ab.mat4.translate(on,pt.projMatrix,Gt),je(pt,xt,Ct,h.translatePosMatrix(on,ot,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),It)}}}function Nh(h,t,a,p,v,b,E){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const k=b?b.findDEMTileFor(a):null;if(!(k&&k.dem||E))return;b&&k&&k.dem&&p.selfDEMTileTimestamp!==k.dem._timestamp&&(p.borderDoneWithNeighborZ=[-1,-1,-1,-1],p.selfDEMTileTimestamp=k.dem._timestamp);const O=ve=>new i.P(Math.ceil((ve+i.d7)*i.d8),0),N=ve=>{const Se=t.getSource().minzoom,Pe=Fe=>{const De=t.getTileByID(Fe);if(De&&De.hasData())return De.getBucket(v)},Me=[0,-1,1];for(const Fe of Me){if(ve.overscaledZ+Fe<Se)continue;const De=Pe(ve.calculateScaledKey(ve.overscaledZ+Fe));if(De)return De}},$=[0,0,0],W=(ve,Se)=>($[0]=Math.min(ve.min.y,Se.min.y),$[1]=Math.max(ve.max.y,Se.max.y),$[2]=i.ag-Se.min.x>ve.max.x?Se.min.x-i.ag:ve.max.x,$),Z=(ve,Se)=>($[0]=Math.min(ve.min.x,Se.min.x),$[1]=Math.max(ve.max.x,Se.max.x),$[2]=i.ag-Se.min.y>ve.max.y?Se.min.y-i.ag:ve.max.y,$),Y=[(ve,Se)=>W(ve,Se),(ve,Se)=>W(Se,ve),(ve,Se)=>Z(ve,Se),(ve,Se)=>Z(Se,ve)],he=(ve,Se,Pe,Me,Fe,De,Oe)=>{if(!b)return 0;const ze=[[De?Pe:ve,De?ve:Pe,0],[De?Pe:Se,De?Se:Pe,0]],Ne=Oe<0?i.ag+Oe:Oe,je=[De?Ne:(ve+Se)/2,De?(ve+Se)/2:Ne,0];return Pe===0&&Oe<0||Pe!==0&&Oe>0?b.getForTilePoints(Fe,[je],!0,Me):ze.push(je),b.getForTilePoints(a,ze,!0,k),Math.max(ze[0][2],ze[1][2],je[2])/b.exaggeration()};for(let ve=0;ve<4;ve++){const Se=p.borderFeatureIndices[ve];if(Se.length===0)continue;const Pe=i.d4[ve](a),Me=N(Pe);if(!(Me&&Me instanceof i.d5))continue;const Fe=b?b.findDEMTileFor(Pe):null;if(!(Fe&&Fe.dem||E)||(b&&Fe&&Fe.dem&&p.borderDEMTileTimestamp[ve]!==Fe.dem._timestamp&&(p.borderDoneWithNeighborZ[ve]=-1,p.borderDEMTileTimestamp[ve]=Fe.dem._timestamp),p.borderDoneWithNeighborZ[ve]===Me.canonical.z))continue;Me.centroidVertexArray.length===0&&Me.createCentroidsBuffer();const De=(ve<2?1:5)-ve,Oe=Me.borderDoneWithNeighborZ[De]!==p.canonical.z,ze=Me.borderFeatureIndices[De];let Ne=0;if(p.canonical.z!==Me.canonical.z){for(const je of Se)p.showCentroid(p.featuresOnBorder[je]);if(Oe)for(const je of ze)Me.showCentroid(Me.featuresOnBorder[je]);p.borderDoneWithNeighborZ[ve]=Me.canonical.z,Me.borderDoneWithNeighborZ[De]=p.canonical.z}for(const je of Se){const pt=p.featuresOnBorder[je],ot=p.centroidData[pt.centroidDataIndex],Ve=pt.borders[ve];let Je;for(;Ne<ze.length;){Je=Me.featuresOnBorder[ze[Ne]];const It=Je.borders[De];if(It[1]>Ve[0]+3||It[0]>Ve[0]-3)break;Me.showCentroid(Je),Ne++}if(Je&&Ne<ze.length){const It=Ne;let kt=0;for(;!(Je.borders[De][0]>Ve[1]-3)&&(kt++,++Ne!==ze.length);)Je=Me.featuresOnBorder[ze[Ne]];Je=Me.featuresOnBorder[ze[It]];let Ht=!1;if(kt>=1){const xt=Je.borders[De];Math.abs(Ve[0]-xt[0])<3&&Math.abs(Ve[1]-xt[1])<3&&(kt=1,Ht=!0,Ne=It+1)}else if(kt===0){p.showCentroid(pt);continue}const ut=Me.centroidData[Je.centroidDataIndex];E&&Ht&&(((ue=ot).flags|(me=ut).flags)&i.d6?(ue.flags|=i.d6,me.flags|=i.d6):(ue.flags&=~i.d6,me.flags&=~i.d6));const Lt=pt.intersectsCount()>1||Je.intersectsCount()>1;if(kt>1)Ne=It,ot.centroidXY=ut.centroidXY=new i.P(0,0);else if(Fe&&Fe.dem&&!Lt){const xt=Y[ve](ot,ut),Gt=ve%2?i.ag-1:0,At=he(xt[0],Math.min(i.ag-1,xt[1]),Gt,Fe,Pe,ve<2,xt[2]);ot.centroidXY=ut.centroidXY=O(At)}else Lt?ot.centroidXY=ut.centroidXY=new i.P(0,0):(ot.centroidXY=p.encodeBorderCentroid(pt),ut.centroidXY=Me.encodeBorderCentroid(Je));p.writeCentroidToBuffer(ot),Me.writeCentroidToBuffer(ut)}else p.showCentroid(pt)}p.borderDoneWithNeighborZ[ve]=Me.canonical.z,Me.borderDoneWithNeighborZ[De]=p.canonical.z}var ue,me;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(h)}const $p=[1,0,0],ac=[0,1,0],lc=[0,0,1];function Wt(h,t,a){const p=a.transform,v=a.shadowRenderer;if(!v)return!0;const b=h.toUnwrapped(),E=p.tileSize*v._cascades[a.currentShadowCascade].scale;let k=t.maxHeight;if(p.elevation){const ue=p.elevation.getMinMaxForTile(h);ue&&(k+=ue.max)}const O=[...v.shadowDirection];O[2]=-O[2];const N=v.computeSimplifiedTileShadowVolume(b,k,E,O);if(!N)return!1;const $=[$p,ac,lc,O,[O[0],0,O[2]],[0,O[1],O[2]]],W=p.projection.name==="globe",Z=p.scaleZoom(E),Y=i.bR.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,Z,!W),he=v.getCurrentCascadeFrustum();return Y.intersectsPrecise(N.vertices,N.planes,$)===0||he.intersectsPrecise(N.vertices,N.planes,$)===0}function nn(h){return[h[0]*i.d9,h[1]*i.d9,h[2]*i.d9,0]}function Es(h,t,a,p,v,b,E,k,O){const N=p.getSource(),$=a.globeSharedBuffers;if(!$)return;let W,Z,Y;if(t&&(W=p.getTile(t)),N instanceof i.aJ?(Z=N.texture,Y=i.cI(0,0,a.transform)):W&&t&&(Z=W.texture,Y=i.cI(t.canonical.z,t.canonical.x,a.transform)),!Z||!Y)return;h||(Y=i.ab.mat4.scale(i.ab.mat4.create(),Y,[1,-1,1]));const he=a.context,ue=he.gl,me=v.paint.get("raster-resampling")==="nearest"?ue.NEAREST:ue.LINEAR,ve=a.colorModeForDrapableLayerRenderPass(b),Se=E.defines;Se.push("GLOBE_POLES");const Pe=new kn(ue.LEQUAL,kn.ReadWrite,a.depthRangeFor3D),Me=Float32Array.from(a.transform.expandedFarZProjMatrix),Fe=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));a.terrain&&a.terrain.prepareDrawTile(),he.activeTexture.set(ue.TEXTURE0),Z.bind(me,ue.CLAMP_TO_EDGE),he.activeTexture.set(ue.TEXTURE1),Z.bind(me,ue.CLAMP_TO_EDGE),Z.useMipmap&&he.extTextureFilterAnisotropic&&a.transform.pitch>20&&ue.texParameterf(ue.TEXTURE_2D,he.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,he.extTextureFilterAnisotropicMax);const[De,Oe,ze,Ne]=t?$.getPoleBuffers(t.canonical.z,!1):$.getPoleBuffers(0,!0),je=v.paint.get("raster-elevation");let pt;h?(pt=De,a.renderDefaultNorthPole=je!==0):(pt=Oe,a.renderDefaultSouthPole=je!==0);const ot=nn(E.mix),Ve=((It,kt,Ht,ut,Lt,xt,Gt,At,Ct,on,Zt,cn,mn)=>wl(It,kt,Ht,new Float32Array(16),new Float32Array(9),[0,0],ut,[0,0],[0,0,0,0],1,{opacity:1,mix:0},xt,[0,0],At,2,on,Zt,cn,1,0,mn))(Me,Fe,Y,i.ae(a.transform.zoom),0,v,0,je,0,ot,E.offset,E.range,b),Je=a.getOrCreateProgram("raster",{defines:Se});a.uploadCommonUniforms(he,Je,null),Je.draw(a,ue.TRIANGLES,Pe,O,ve,k,Ve,v.id,pt,ze,Ne)}function bi(h){const t=h._nearZ,a=h.projection.farthestPixelDistance(h),p=a-t,v=.2*h.height,b=t+v;return[t,a,(b-v-t)/p,(b-t)/p]}function ft(h,t,a,p){if(h)return t instanceof ll&&h instanceof hd?t.getTextureDescriptor(h,a,!0):{texture:h.texture,mix:nn(p.mix),offset:p.offset,buffer:0,tileSize:1}}var Wa=i.da([{name:"a_index",type:"Int16",components:1}]);class Ta{constructor(t,a,p,v){const b={width:p[0],height:p[1],data:null},E=t.gl;this.targetColorTexture=new i.T(t,b,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(t,b,E.RGBA8,{useMipmap:!1}),this.context=t,this.updateParticleTexture(a,v),this.lastInvalidatedAt=0}updateParticleTexture(t,a){if(this.particleTextureDimension===a.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,v=a.width*a.height;this.particleTexture0=new i.T(this.context,a,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,a,p.RGBA8,{premultiply:!1,useMipmap:!1});const b=new i.db;b.reserve(v);for(let E=0;E<v;E++)b.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(b,Wa.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=a.width}update(t){return!(this.lastInvalidatedAt<t&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Dd(h,t,a){if(!h)return null;const p=t.getTextureDescriptor(h,a,!0);if(!p)return null;let{texture:v,mix:b,offset:E,tileSize:k,buffer:O,format:N}=p;if(!v||!N)return null;let $=!1;return N==="uint32"&&($=!0,b[3]=0,b=Qo(i.dc,b,[0,a.paint.get("raster-particle-max-speed")]),E=dn(i.dc,E,[0,a.paint.get("raster-particle-max-speed")])),{texture:v,textureOffset:[O/(k+2*O),k/(k+2*O)],tileSize:k,scalarData:$,scale:b,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[N]]}}function Vp(h){const t=h._nearZ,a=h.projection.farthestPixelDistance(h),p=a-t,v=.2*h.height,b=t+v;return[t,a,(b-v-t)/p,(b-t)/p]}const Ha=new i.aj(1,0,0,1),Sl=new i.aj(0,1,0,1),Tl=new i.aj(0,0,1,1),lm=new i.aj(1,0,1,1),jh=new i.aj(0,1,1,1);function cc(h,t,a,p,v,b,E){const k=h.context,O=h.transform,N=k.gl,$=O.projection.name==="globe",W=$?["PROJECTION_GLOBE_VIEW"]:[];let Z=i.ab.mat4.clone(a.projMatrix);if($&&i.ae(O.zoom)>0){const ot=i.ba(a.canonical,O),Ve=i.dd(ot);Z=i.ab.mat4.multiply(new Float32Array(16),O.globeMatrix,Ve),i.ab.mat4.multiply(Z,O.projMatrix,Z)}const Y=i.ab.mat4.create();Y[12]+=2*v/(i.q.devicePixelRatio*O.width),Y[13]+=2*b/(i.q.devicePixelRatio*O.height),i.ab.mat4.multiply(Z,Y,Z);const he=h.getOrCreateProgram("debug",{defines:W}),ue=t.getTileByID(a.key);h.terrain&&h.terrain.setupElevationDraw(ue,he);const me=kn.disabled,ve=Jn.disabled,Se=h.colorModeForRenderPass(),Pe="$debug";k.activeTexture.set(N.TEXTURE0),h.emptyTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),$?ue._makeGlobeTileDebugBuffers(h.context,O):ue._makeDebugTileBoundsBuffers(h.context,O.projection);const Me=ue._tileDebugBuffer||h.debugBuffer,Fe=ue._tileDebugIndexBuffer||h.debugIndexBuffer,De=ue._tileDebugSegments||h.debugSegments;if(he.draw(h,N.LINE_STRIP,me,ve,Se,Nn.disabled,oc(Z,p),Pe,Me,Fe,De,null,null,null,[ue._globeTileDebugBorderBuffer]),E){const ot=ue.latestRawTileData,Ve=Math.floor((ot&&ot.byteLength||0)/1024);let Je=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(Je+=` => ${a.overscaledZ}`),Je+=` ${ue.state}`,Je+=` ${Ve}kb`,function(It,kt){It.initDebugOverlayCanvas();const Ht=It.debugOverlayCanvas,ut=It.context.gl,Lt=It.debugOverlayCanvas.getContext("2d");Lt.clearRect(0,0,Ht.width,Ht.height),Lt.shadowColor="white",Lt.shadowBlur=2,Lt.lineWidth=1.5,Lt.strokeStyle="white",Lt.textBaseline="top",Lt.font="bold 36px Open Sans, sans-serif",Lt.fillText(kt,5,5),Lt.strokeText(kt,5,5),It.debugOverlayTexture.update(Ht),It.debugOverlayTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE)}(h,Je)}const Oe=t.getTile(a).tileSize,ze=512/Math.min(Oe,512)*(a.overscaledZ/O.zoom)*.5,Ne=ue._tileDebugTextBuffer||h.debugBuffer,je=ue._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,pt=ue._tileDebugTextSegments||h.debugSegments;he.draw(h,N.TRIANGLES,me,ve,vr.alphaBlended,Nn.disabled,oc(Z,i.aj.transparent,ze),Pe,Ne,je,pt,null,null,null,[ue._globeTileDebugTextBuffer])}function El(h,t,a,p){Cl(h,0,t+a/2,h.transform.width,a,p)}function Ws(h,t,a,p){Cl(h,t-a/2,0,a,h.transform.height,p)}function Cl(h,t,a,p,v,b){const E=h.context,k=E.gl;k.enable(k.SCISSOR_TEST),k.scissor(t*i.q.devicePixelRatio,a*i.q.devicePixelRatio,p*i.q.devicePixelRatio,v*i.q.devicePixelRatio),E.clear({color:b}),k.disable(k.SCISSOR_TEST)}const Fu=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Za}=Fu;function Hs(h,t,a,p){h.emplaceBack(t,a,p)}class ns{constructor(t){this.vertexArray=new i.de,this.indices=new i.aU,Hs(this.vertexArray,-1,-1,1),Hs(this.vertexArray,1,-1,1),Hs(this.vertexArray,-1,1,1),Hs(this.vertexArray,1,1,1),Hs(this.vertexArray,-1,-1,-1),Hs(this.vertexArray,1,-1,-1),Hs(this.vertexArray,-1,1,-1),Hs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Za),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function uc(h,t,a,p,v,b){const E=h.context.gl,k=t.paint.get("sky-atmosphere-color"),O=t.paint.get("sky-atmosphere-halo-color"),N=t.paint.get("sky-atmosphere-sun-intensity"),$=((W,Z,Y,he,ue)=>({u_matrix_3f:W,u_sun_direction:Z,u_sun_intensity:Y,u_color_tint_r:[he.r,he.g,he.b,he.a],u_color_tint_m:[ue.r,ue.g,ue.b,ue.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),p),v,N,k,O);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+b,t.skyboxTexture,0),a.draw(h,E.TRIANGLES,kn.disabled,Jn.disabled,vr.unblended,Nn.frontCW,$,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const Gp=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Qr{constructor(t){const a=new i.df;a.emplaceBack(-1,1,1,0,0),a.emplaceBack(1,1,1,1,0),a.emplaceBack(1,-1,1,1,1),a.emplaceBack(-1,-1,1,0,1);const p=new i.aU;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(a,Gp.members),this.indexBuffer=t.createIndexBuffer(p),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Uh=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Xc{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class li{constructor(t){this.colorModeAlphaBlendedWriteRGB=new vr([1,Cu,1,Cu],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new vr([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new Xc,this.updateNeeded=!0,t.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),t.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),t.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),t.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(t){const a=t.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Qr(a);const p=this.params.sizeRange,v=this.params.intensityRange,b=function($){const W=i.di(30),Z=[];for(let Y=0;Y<$;++Y){const he=2*Math.PI*W(),ue=Math.acos(1-2*W())-.5*Math.PI;Z.push(i.ab.vec3.fromValues(Math.cos(ue)*Math.cos(he),Math.cos(ue)*Math.sin(he),Math.sin(ue)))}return Z}(this.params.starsCount),E=i.di(300),k=new i.dg,O=new i.aU;let N=0;for(let $=0;$<b.length;++$){const W=i.ab.vec3.scale([],b[$],200),Z=Math.max(0,1+.01*p*(1*E()-.5)),Y=Math.max(0,1+.01*v*(1*E()-.5));k.emplaceBack(W[0],W[1],W[2],-1,-1,Z,Y),k.emplaceBack(W[0],W[1],W[2],1,-1,Z,Y),k.emplaceBack(W[0],W[1],W[2],1,1,Z,Y),k.emplaceBack(W[0],W[1],W[2],-1,1,Z,Y),O.emplaceBack(N+0,N+1,N+2),O.emplaceBack(N+0,N+2,N+3),N+=4}this.starsVx=a.createVertexBuffer(k,Uh.members),this.starsIdx=a.createIndexBuffer(O),this.starsSegments=i.b7.simpleSegment(0,0,k.length,O.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,a){const p=t.context,v=p.gl,b=t.transform,E=new kn(v.LEQUAL,kn.ReadOnly,[0,1]),k=i.ae(b.zoom),O=t.style.getLut(a.scope),N=a.properties.get("color-use-theme")==="none",$=a.properties.get("color").toRenderColor(N?null:O).toArray01(),W=a.properties.get("high-color-use-theme")==="none",Z=a.properties.get("high-color").toRenderColor(W?null:O).toArray01(),Y=a.properties.get("space-color-use-theme")==="none",he=a.properties.get("space-color").toRenderColor(Y?null:O).toArray01PremultipliedAlpha(),ue=5e-4,me=i.dh(a.properties.get("horizon-blend"),0,1,ue,.25),ve=i.cC(t,p,b)&&me===ue?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,Se=t.frameCounter/1e3%1,Pe=i.ab.vec3.length(b.globeCenterInViewSpace),Me=Math.sqrt(Math.pow(Pe,2)-Math.pow(ve,2)),Fe=Math.acos(Me/Pe),De=Oe=>{const ze=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Oe&&ze.push("ALPHA_PASS");const Ne=t.getOrCreateProgram("globeAtmosphere",{defines:ze}),je=((ot,Ve,Je,It,kt,Ht,ut,Lt,xt,Gt,At,Ct)=>({u_frustum_tl:ot,u_frustum_tr:Ve,u_frustum_br:Je,u_frustum_bl:It,u_horizon:kt,u_transition:Ht,u_fadeout_range:ut,u_color:Lt,u_high_color:xt,u_space_color:Gt,u_temporal_offset:At,u_horizon_angle:Ct}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,k,me,$,Z,he,Se,Fe);t.uploadCommonUniforms(p,Ne);const pt=this.atmosphereBuffer;pt&&Ne.draw(t,v.TRIANGLES,E,Jn.disabled,Oe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Nn.backCW,je,Oe?"atmosphere_glow_alpha":"atmosphere_glow",pt.vertexBuffer,pt.indexBuffer,pt.segments)};De(!1),De(!0)}drawStars(t,a){const p=i.aw(a.properties.get("star-intensity"),0,1);if(p===0)return;const v=t.context,b=v.gl,E=t.transform,k=t.getOrCreateProgram("stars"),O=i.ab.quat.identity([]);i.ab.quat.rotateX(O,O,-E._pitch),i.ab.quat.rotateZ(O,O,-E.angle),i.ab.quat.rotateX(O,O,i.ai(E._center.lat)),i.ab.quat.rotateY(O,O,-i.ai(E._center.lng));const N=i.ab.mat4.fromQuat(new Float32Array(16),O),$=i.ab.mat4.multiply([],E.starsProjMatrix,N),W=i.ab.mat3.fromMat4([],N),Z=i.ab.mat3.invert([],W),Y=[0,1,0];i.ab.vec3.transformMat3(Y,Y,Z),i.ab.vec3.scale(Y,Y,this.params.sizeMultiplier);const he=[1,0,0];i.ab.vec3.transformMat3(he,he,Z),i.ab.vec3.scale(he,he,this.params.sizeMultiplier);const ue=(me=Y,ve=he,Se=p,{u_matrix:Float32Array.from($),u_up:me,u_right:ve,u_intensity_multiplier:Se});var me,ve,Se;t.uploadCommonUniforms(v,k),this.starsVx&&this.starsIdx&&k.draw(t,b.TRIANGLES,kn.disabled,Jn.disabled,this.colorModeAlphaBlendedWriteRGB,Nn.disabled,ue,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Dr(h,t){const a=[...h],p=t.cameraWorldSizeForFog/t.worldSize,v=i.ab.mat4.identity([]);return i.ab.mat4.scale(v,v,[p,p,1]),i.ab.mat4.multiply(a,v,a),i.ab.mat4.multiply(a,t.worldToFogMatrix,a),a}function Bu(h,t,a,p,v){const b=a.material,E=p.context,{baseColorTexture:k,metallicRoughnessTexture:O}=b.pbrMetallicRoughness,{normalTexture:N,occlusionTexture:$,emissionTexture:W}=b;function Z(he,ue,me){if(he&&(h.push(ue),E.activeTexture.set(E.gl.TEXTURE0+me),he.gfxTexture)){const{minFilter:ve,magFilter:Se,wrapS:Pe,wrapT:Me}=he.sampler;he.gfxTexture.bindExtraParam(ve,Se,Pe,Me)}}Z(k,"HAS_TEXTURE_u_baseColorTexture",So.BaseColor),Z(O,"HAS_TEXTURE_u_metallicRoughnessTexture",So.MetallicRoughness),Z(N,"HAS_TEXTURE_u_normalTexture",So.Normal),Z($,"HAS_TEXTURE_u_occlusionTexture",So.Occlusion),Z(W,"HAS_TEXTURE_u_emissionTexture",So.Emission),v&&(v.texture||(v.texture=new i.dk(p.context,v.image,[v.image.height,v.image.height,v.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+So.LUT),v.texture&&v.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),h.push("APPLY_LUT_ON_GPU")),a.texcoordBuffer&&(h.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(a.texcoordBuffer)),a.colorBuffer&&(h.push(a.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(a.colorBuffer)),a.normalBuffer&&(h.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(a.normalBuffer)),a.pbrBuffer&&(h.push("HAS_ATTRIBUTE_a_pbr"),h.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(a.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||h.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||h.push("DIFFUSE_SHADED"),h.push("USE_STANDARD_DERIVATIVES");const Y=p.shadowRenderer;Y&&(h.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Y.useNormalOffset&&h.push("NORMAL_OFFSET"))}function Go(h,t,a,p,v,b){const E=a.paint.get("model-opacity").constantOr(1),k=t.context,O=new kn(t.context.gl.LEQUAL,kn.ReadWrite,t.depthRangeFor3D),N=t.transform,$=h.mesh,W=$.material,Z=W.pbrMetallicRoughness,Y=t.style.fog;let he;he=t.transform.projection.zAxisUnit==="pixels"?[...h.nodeModelMatrix]:i.ab.mat4.multiply([],p.zScaleMatrix,h.nodeModelMatrix),i.ab.mat4.multiply(he,p.negCameraPosMatrix,he);const ue=i.ab.mat4.invert([],he);i.ab.mat4.transpose(ue,ue);const me=a.paint.get("model-color-use-theme").constantOr("default")==="none",ve=a.paint.get("model-emissive-strength").constantOr(0),Se=Oh(new Float32Array(h.worldViewProjection),new Float32Array(he),new Float32Array(ue),null,t,E,Z.baseColorFactor.toRenderColor(null),W.emissiveFactor,Z.metallicFactor,Z.roughnessFactor,W,ve,a),Pe={defines:[]},Me=[],Fe=t.shadowRenderer;Fe&&(Fe.useNormalOffset=!1),Bu(Pe.defines,Me,$,t,me?null:a.lut);let De=null;if(Y){const Ne=Dr(h.nodeModelMatrix,t.transform);if(De=new Float32Array(Ne),N.projection.name!=="globe"){const je=$.aabb.min,pt=$.aabb.max,[ot,Ve]=Y.getOpacityForBounds(Ne,je[0],je[1],pt[0],pt[1]);Pe.overrideFog=ot>=an||Ve>=an}}const Oe=Oa(t,a.paint.get("model-cutoff-fade-range"));Oe.shouldRenderCutoff&&Pe.defines.push("RENDER_CUTOFF");const ze=t.getOrCreateProgram("model",Pe);t.uploadCommonUniforms(k,ze,null,De,Oe),t.renderPass!=="shadow"&&Fe&&Fe.setupShadowsFromMatrix(h.nodeModelMatrix,ze),ze.draw(t,k.gl.TRIANGLES,O,v,b,$.material.doubleSided?Nn.disabled:Nn.backCCW,Se,a.id,$.vertexBuffer,$.indexBuffer,$.segments,a.paint,t.transform.zoom,void 0,Me)}function Li(h,t,a,p,v,b,E){let k;k=h.projection.name==="globe"?i.dl(a,h):[...a],i.ab.mat4.multiply(k,k,t.matrix);const O=i.ab.mat4.multiply([],p,k);if(t.meshes)for(const N of t.meshes){if(N.material.alphaMode!=="BLEND"){E.push({mesh:N,depth:0,modelIndex:v,worldViewProjection:O,nodeModelMatrix:k});continue}const $=i.ab.vec3.transformMat4([],N.centroid,O);$[2]>0&&b.push({mesh:N,depth:$[2],modelIndex:v,worldViewProjection:O,nodeModelMatrix:k})}if(t.children)for(const N of t.children)Li(h,N,a,p,v,b,E)}function ji(h,t,a,p){const v=a.shadowRenderer;if(!v)return;const b=v.getShadowPassDepthMode(),E=v.getShadowPassColorMode(),k=v.calculateShadowPassMatrixFromMatrix(t),O=jp(k);a.getOrCreateProgram("modelDepth",{defines:a._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(a,a.context.gl.TRIANGLES,b,Jn.disabled,E,Nn.backCCW,O,p.id,h.vertexBuffer,h.indexBuffer,h.segments,p.paint,a.transform.zoom,void 0,void 0)}function vo(h,t,a){const p=t.updateZoomBasedPaintProperties(),v=function(b,E,k){let O,N,$,W=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&W>0){const Z=b.terrain,Y=Z.findDEMTileFor(k);Y&&Y.dem?O=i.dn.create(Z,k,Y):W=0}if(W===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),W===E.validForExaggeration&&(W===0||O&&O._demTile&&O._demTile.tileID===E.validForDEMTile.id&&O._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const Z in E.instancesPerModel){const Y=E.instancesPerModel[Z];for(let he=0;he<Y.instancedDataArray.length;++he){const ue=(O?W*O.getElevationAt(0|Y.instancedDataArray.float32[16*he],0|Y.instancedDataArray.float32[16*he+1],!0,!0):0)+Y.instancesEvaluatedElevation[he];Y.instancedDataArray.float32[16*he+6]=ue,N=N?Math.min(E.terrainElevationMin,ue):ue,$=$?Math.max(E.terrainElevationMax,ue):ue}}return E.terrainElevationMin=N||0,E.terrainElevationMax=$||0,E.validForExaggeration=W,E.validForDEMTile=O&&O._demTile?{id:O._demTile.tileID,timestamp:O._dem._timestamp}:{id:void 0,timestamp:0},!0}(h,t,a);(p||v)&&(t.uploaded=!1,t.upload(h.context))}const hs={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function ua(h,t){const a=1<<h.canonical.z,p=t.getFreeCameraOptions().position,v=t.elevation,b=h.canonical.x/a,E=(h.canonical.x+1)/a,k=h.canonical.y/a,O=(h.canonical.y+1)/a;let N=t._centerAltitude;if(v){const Y=v.getMinMaxForTile(h);Y&&Y.max>N&&(N=Y.max)}const $=i.aw(p.x,b,E)-p.x,W=i.aw(p.y,k,O)-p.y,Z=i.bH(N,t.center.lat)-p.z;return t._zoomFromMercatorZ(Math.sqrt($*$+W*W+Z*Z))}function Zs(h,t,a,p,v,b,E){const k=h.context,O=h.renderPass==="shadow",N=h.shadowRenderer,$=O&&N?N.getShadowPassDepthMode():new kn(k.gl.LEQUAL,kn.ReadWrite,h.depthRangeFor3D),W=h.isTileAffectedByFog(b);if(a.meshes)for(const Z of a.meshes){const Y=["MODEL_POSITION_ON_GPU"],he=[];let ue,me,ve;p.instancedDataArray.length>20&&Y.push("INSTANCED_ARRAYS");const Se=Oa(h,t.paint.get("model-cutoff-fade-range"));if(Se.shouldRenderCutoff&&Y.push("RENDER_CUTOFF"),O&&N)ue=h.getOrCreateProgram("modelDepth",{defines:Y}),me=jp(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(a.matrix)),ve=N.getShadowPassColorMode();else{Bu(Y,he,Z,h,t.paint.get("model-color-use-theme").constantOr("default")==="none"?null:t.lut),ue=h.getOrCreateProgram("model",{defines:Y,overrideFog:W});const Me=Z.material,Fe=Me.pbrMetallicRoughness,De=t.paint.get("model-opacity").constantOr(1),Oe=t.paint.get("model-emissive-strength").constantOr(0);me=Oh(b.expandedProjMatrix,Float32Array.from(a.matrix),new Float32Array(16),null,h,De,Fe.baseColorFactor.toRenderColor(null),Me.emissiveFactor,Fe.metallicFactor,Fe.roughnessFactor,Me,Oe,t,v),N&&(E.shadowUniformsInitialized?ue.setShadowUniformValues(k,N.getShadowUniformValues()):(N.setupShadows(b.toUnwrapped(),ue,"model-tile",b.overscaledZ),E.shadowUniformsInitialized=!0)),ve=Se.shouldRenderCutoff||De<1||Me.alphaMode!=="OPAQUE"?vr.alphaBlended:vr.unblended}h.uploadCommonUniforms(k,ue,b.toUnwrapped(),null,Se);const Pe=Z.material.doubleSided?Nn.disabled:Nn.backCCW;if(p.instancedDataArray.length>20)he.push(p.instancedDataBuffer),ue.draw(h,k.gl.TRIANGLES,$,Jn.disabled,ve,Pe,me,t.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,t.paint,h.transform.zoom,void 0,he,p.instancedDataArray.length);else{const Me=O?"u_instance":"u_normal_matrix";for(let Fe=0;Fe<p.instancedDataArray.length;++Fe)me[Me]=new Float32Array(p.instancedDataArray.arrayBuffer,64*Fe,16),ue.draw(h,k.gl.TRIANGLES,$,Jn.disabled,ve,Pe,me,t.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,t.paint,h.transform.zoom,void 0,he)}}if(a.children)for(const Z of a.children)Zs(h,t,Z,p,v,b,E)}const dc=[1,-1,1];function Io(h,t,a,p){if(!a.modelManager)return!0;const v=a.modelManager;if(!a.shadowRenderer)return!0;const b=a.shadowRenderer,E=t.aabb;let k=!0,O=h.maxHeight;if(O===0){let $=0;for(const W in h.instancesPerModel){const Z=v.getModel(W,p);Z?$=Math.max($,Math.max(Math.max(Z.aabb.max[0],Z.aabb.max[1]),Z.aabb.max[2])):k=!1}O=h.maxScale*$*1.41+h.maxVerticalOffset,k&&(h.maxHeight=O)}E.max[2]=O,E.min[2]+=h.terrainElevationMin,E.max[2]+=h.terrainElevationMax,i.ab.vec3.transformMat4(E.min,E.min,t.tileMatrix),i.ab.vec3.transformMat4(E.max,E.max,t.tileMatrix);const N=E.intersects(b.getCurrentCascadeFrustum());return a.currentShadowCascade===0&&(h.isInsideFirstShadowMapFrustum=N===2),N===0}function Nu(h,t){const a=h.uniformValues.u_cutoff_params[0],p=h.uniformValues.u_cutoff_params[1],v=h.uniformValues.u_cutoff_params[2],b=h.uniformValues.u_cutoff_params[3];return p===a||b===v?1:i.aw(((t-a)/(p-a)-v)/(b-v),0,1)}function Od(h,t,a,p){if(t.pitch<20)return 1;const v=t.getWorldToCameraMatrix();i.ab.mat4.multiply(v,v,h);const b=i.ab.vec4.fromValues(a.min[0],a.min[1],a.min[2],1);let E=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,v),k=E,O=E;b[1]=a.max[1],E=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,v),k=E[1]<k[1]?E:k,O=E[1]>O[1]?E:O,b[0]=a.max[0],E=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,v),k=E[1]<k[1]?E:k,O=E[1]>O[1]?E:O,b[1]=a.min[1],E=i.ab.vec4.transformMat4(i.ab.vec4.create(),b,v),k=E[1]<k[1]?E:k,O=E[1]>O[1]?E:O;const N=i.aw(p[0],0,1),$=100*t.pixelsPerMeter*i.aw(p[1],0,1),W=i.aw(p[2],0,1),Z=i.ab.vec4.lerp(i.ab.vec4.create(),k,O,N),Y=Math.tan(.5*t.fovX),he=-Z[2]*Y;if($===0)return Z[1]<-Math.abs(he)?W:1;const ue=(-Math.abs(he)-Z[1])/$,me=(Se,Pe,Me)=>(1-Me)*Se+Me*Pe,ve=i.aw(me(1,W,ue),W,1);return me(1,ve,i.aw((t.pitch-20)/20,0,1))}class Fd{}class da{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,a,p){{const W=this._storage.get(a.id);if(W)return W.lastUsedFrameIdx=t,W.buf}const v=p.gl,b=v.getBufferParameter(v.ELEMENT_ARRAY_BUFFER,v.BUFFER_SIZE),E=new ArrayBuffer(b),k=new Int16Array(E);v.getBufferSubData(v.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const O=new i.dq;for(let W=0;W<b/2;W+=3){const Z=k[W],Y=k[W+1],he=k[W+2];O.emplaceBack(Z,Y),O.emplaceBack(Y,he),O.emplaceBack(he,Z)}const N=p.bindVertexArrayOES.current,$=new Fd;return $.buf=new la(p,O),$.lastUsedFrameIdx=t,this._storage.set(a.id,$),p.bindVertexArrayOES.set(N),$.buf}update(t){for(const[a,p]of this._storage)t-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(a))}destroy(){for(const[t,a]of this._storage)a.buf.destroy(),this._storage.delete(t)}}class Ao{constructor(t){this.occluderSize=30,this.depthOffset=-1e-4,t.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),t.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Yc=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class ju{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Uu{constructor(t,a){this.revealStart=11,this.revealRange=2,t.registerParameter(this,[...a,"Reveal"],"revealStart",{min:0,max:17,step:.05}),t.registerParameter(this,[...a,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const $h=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class Po{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(t,a){const p=t.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new i.dr,k=new i.aU;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),k.emplaceBack(0,1,2),k.emplaceBack(0,2,3),this.vignetteVx=t.context.createVertexBuffer(E,$h.members),this.vignetteIdx=t.context.createIndexBuffer(k)}const v=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){t.uploadCommonUniforms(t.context,p);const E={u_vignetteShape:(b={vignetteShape:[a.start,a.range,Math.pow(10,a.fadePower)],vignetteColor:[a.color.r,a.color.g,a.color.b,a.color.a*a.strength]}).vignetteShape,u_vignetteColor:b.vignetteColor};p.draw(t,t.context.gl.TRIANGLES,kn.disabled,Jn.disabled,vr.alphaBlended,Nn.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,v,{})}var b}}class Vh{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(t,a){const p=t.getFreeCameraOptions().position,v=p.toAltitude(),b=p.toLngLat(),E=i.ai(b.lng),k=i.ai(b.lat),O=t.pixelsPerMeter/a,N=E*i.ds,$=i.ds*Math.log(Math.tan(Math.PI/4+k/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const W=-this._offsetYPrev+$,Z=-this._elevationPrev+v;this._accumulatedOffsetX+=(-this._offsetXPrev+N)*O,this._accumulatedOffsetY+=W*O,this._accumulatedElevation+=Z*O,this._offsetXPrev=N,this._offsetYPrev=$,this._elevationPrev=v}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Bd(h,t){return[-(h[0]-Math.floor(h[0]/t)*t),-(h[1]-Math.floor(h[1]/t)*t),-(h[2]-Math.floor(h[2]/t)*t)]}function Kc(h){const t=i.di(1323123451230),a=[];for(let p=0;p<h;++p){const v=2*t()-1,b=2*t()-1,E=2*t()-1;a.push(i.ab.vec3.fromValues(v,b,E))}return a}function ps(h,t,a,p,v){const b=i.aw((v-a)/(p-a),0,1);return(1-b)*h+b*t}class Nd{constructor(t){this._movement=new Vh,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Po,this._ppmScaleFactor=t}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(t,a){const p=t.transform;this._movement.update(p,this._ppmScaleFactor);const v=p.starsProjMatrix,b=i.ab.quat.identity([]);i.ab.quat.rotateX(b,b,i.ai(90)-p._pitch),i.ab.quat.rotateZ(b,b,-p.angle);const E=i.ab.mat4.fromQuat(new Float32Array(16),b),k=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),O=i.ab.mat4.transpose([],k),N=i.ab.mat4.multiply([],O,E),$=Date.now()/1e3;return this._accumulatedTimeFromStart+=($-this._prevTime)*a,this._prevTime=$,{projectionMatrix:v,modelviewMatrix:N}}}class Gh extends Nd{constructor(t){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Uu(t.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(t){const a=t.context;if(!this.particlesVx){const p=Kc(this.particlesCount),v=new i.dt,b=new i.aU;let E=0;const k=i.di(1323123451230);for(let O=0;O<p.length;++O){const N=p[O],$=[2*k()-1,k(),k(),k()];v.emplaceBack(N[0],N[1],N[2],-1,-1,...$),v.emplaceBack(N[0],N[1],N[2],1,-1,...$),v.emplaceBack(N[0],N[1],N[2],1,1,...$),v.emplaceBack(N[0],N[1],N[2],-1,1,...$),b.emplaceBack(E+0,E+1,E+2),b.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=a.createVertexBuffer(v,Yc.members),this.particlesIdx=a.createIndexBuffer(b)}}draw(t){if(!this._params.overrideStyleParameters&&!t.style.rain)return;const a=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},p=t.transform.zoom;if(a.revealStart>p)return;const v=ps(0,1,a.revealStart,a.revealStart+a.revealRange,p);if(!this.particlesVx||!this.particlesIdx)return;const b=structuredClone(this._params);let E=[-b.direction.x,b.direction.y,-100];i.ab.vec3.normalize(E,E);const k=structuredClone(this._vignetteParams);k.strength*=v,b.overrideStyleParameters||(b.intensity=t.style.rain.state.density,b.timeFactor=t.style.rain.state.intensity,b.color=structuredClone(t.style.rain.state.color),E=structuredClone(t.style.rain.state.direction),b.screenThinning.intensity=t.style.rain.state.centerThinning,b.dropletSizeX=t.style.rain.state.dropletSize[0],b.dropletSizeYScale=t.style.rain.state.dropletSize[1]/t.style.rain.state.dropletSize[0],b.distortionStrength=100*t.style.rain.state.distortionStrength,k.strength=1,k.color=structuredClone(t.style.rain.state.vignetteColor));const O=this.updateOnRender(t,b.timeFactor),N=t.context,$=N.gl,W=t.transform;this.screenTexture&&this.screenTexture.size[0]===t.width&&this.screenTexture.size[1]===t.height||(this.screenTexture=new i.T(N,{width:t.width,height:t.height,data:null},$.RGBA8)),b.distortionStrength>0&&(N.activeTexture.set($.TEXTURE0),this.screenTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),$.copyTexSubImage2D($.TEXTURE_2D,0,0,0,0,0,t.width,t.height));const Z=t.getOrCreateProgram("rainParticle");t.uploadCommonUniforms(N,Z),N.activeTexture.set($.TEXTURE0),this.screenTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const Y=[b.color.r,b.color.g,b.color.b,b.color.a],he=(ue,me)=>{const ve=Bd(this._movement.getPosition(),ue),Se=b.dropletSizeX,Pe=b.dropletSizeX*b.dropletSizeYScale,Me=t.width/2,Fe=t.height/2,De=ps(0,b.screenThinning.start,0,1,b.screenThinning.intensity),Oe=ps(.001,b.screenThinning.range,0,1,b.screenThinning.intensity),ze=ps(0,b.screenThinning.particleOffset,0,1,b.screenThinning.intensity),Ne=(je={modelview:O.modelviewMatrix,projection:O.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ve,velocityConeAperture:b.velocityConeAperture,velocity:b.velocity,boxSize:ue,rainDropletSize:[Se,Pe],distortionStrength:b.distortionStrength,rainDirection:E,color:Y,screenSize:[W.width,W.height],thinningCenterPos:[Me,Fe],thinningShape:[De,Oe,Math.pow(10,b.screenThinning.fadePower)],thinningAffectedRatio:b.screenThinning.affectedRatio,thinningParticleOffset:ze,shapeDirectionalPower:b.shapeDirPower,shapeNormalPower:b.shapeNormalPower,mode:me?0:1},{u_modelview:Float32Array.from(je.modelview),u_projection:Float32Array.from(je.projection),u_time:je.time,u_cam_pos:je.camPos,u_texScreen:0,u_velocityConeAperture:je.velocityConeAperture,u_velocity:je.velocity,u_boxSize:je.boxSize,u_rainDropletSize:je.rainDropletSize,u_distortionStrength:je.distortionStrength,u_rainDirection:je.rainDirection,u_color:je.color,u_screenSize:je.screenSize,u_thinningCenterPos:je.thinningCenterPos,u_thinningShape:je.thinningShape,u_thinningAffectedRatio:je.thinningAffectedRatio,u_thinningParticleOffset:je.thinningParticleOffset,u_shapeDirectionalPower:je.shapeDirectionalPower,u_shapeNormalPower:je.shapeNormalPower,u_mode:je.mode});var je;const pt=Math.round(v*b.intensity*this.particlesCount),ot=i.b7.simpleSegment(0,0,4*pt,2*pt);Z.draw(t,$.TRIANGLES,kn.disabled,Jn.disabled,vr.alphaBlended,Nn.disabled,Ne,"rain_particles",this.particlesVx,this.particlesIdx,ot,{})};b.distortionStrength>0&&he(b.boxSize,!0),he(b.boxSize,!1),this._vignette.draw(t,k)}}const Jc=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class hc extends Nd{constructor(t){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Uu(t.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(t){const a=t.context;if(!this.particlesVx){const p=Kc(this.particlesCount),v=new i.du,b=new i.aU;let E=0;const k=i.di(1323123451230);for(let O=0;O<p.length;++O){const N=p[O],$=k(),W=k(),Z=k(),Y=[O/p.length,$,W,Z],he=[k(),k()];v.emplaceBack(N[0],N[1],N[2],-1,-1,...Y,...he),v.emplaceBack(N[0],N[1],N[2],1,-1,...Y,...he),v.emplaceBack(N[0],N[1],N[2],1,1,...Y,...he),v.emplaceBack(N[0],N[1],N[2],-1,1,...Y,...he),b.emplaceBack(E+0,E+1,E+2),b.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=a.createVertexBuffer(v,Jc.members),this.particlesIdx=a.createIndexBuffer(b)}}draw(t){if(!this._params.overrideStyleParameters&&!t.style.snow)return;const a=structuredClone(this._params);let p=[-a.direction.x,a.direction.y,-100];i.ab.vec3.normalize(p,p);const v=structuredClone(this._vignetteParams),b=a.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=t.transform.zoom;if(b.revealStart>E)return;const k=ps(0,1,b.revealStart,b.revealStart+b.revealRange,E);v.strength*=k,a.overrideStyleParameters||(a.intensity=t.style.snow.state.density,a.timeFactor=t.style.snow.state.intensity,a.color=structuredClone(t.style.snow.state.color),p=structuredClone(t.style.snow.state.direction),a.screenThinning.intensity=t.style.snow.state.centerThinning,a.billboardSize=2.79*t.style.snow.state.flakeSize,v.strength=1,v.color=structuredClone(t.style.snow.state.vignetteColor));const O=this.updateOnRender(t,a.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const N=t.context,$=N.gl,W=t.transform,Z=t.getOrCreateProgram("snowParticle");t.uploadCommonUniforms(N,Z),((Y,he,ue)=>{const me=Bd(this._movement.getPosition(),Y),ve=W.width/2,Se=W.height/2,Pe=ps(0,ue.screenThinning.start,0,1,ue.screenThinning.intensity),Me=ps(.001,ue.screenThinning.range,0,1,ue.screenThinning.intensity),Fe=ps(0,ue.screenThinning.particleOffset,0,1,ue.screenThinning.intensity),De=(Oe={modelview:O.modelviewMatrix,projection:O.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:me,velocityConeAperture:ue.velocityConeAperture,velocity:ue.velocity,horizontalOscillationRadius:ue.horizontalOscillationRadius,horizontalOscillationRate:ue.horizontalOscillationRate,boxSize:Y,billboardSize:1*ue.billboardSize,simpleShapeParameters:[ue.shapeFadeStart,ue.shapeFadePower],screenSize:[W.width,W.height],thinningCenterPos:[ve,Se],thinningShape:[Pe,Me,Math.pow(10,ue.screenThinning.fadePower)],thinningAffectedRatio:ue.screenThinning.affectedRatio,thinningParticleOffset:Fe,color:[ue.color.r,ue.color.g,ue.color.b,ue.color.a],direction:p},{u_modelview:Float32Array.from(Oe.modelview),u_projection:Float32Array.from(Oe.projection),u_time:Oe.time,u_cam_pos:Oe.camPos,u_velocityConeAperture:Oe.velocityConeAperture,u_velocity:Oe.velocity,u_horizontalOscillationRadius:Oe.horizontalOscillationRadius,u_horizontalOscillationRate:Oe.horizontalOscillationRate,u_boxSize:Oe.boxSize,u_billboardSize:Oe.billboardSize,u_simpleShapeParameters:Oe.simpleShapeParameters,u_screenSize:Oe.screenSize,u_thinningCenterPos:Oe.thinningCenterPos,u_thinningShape:Oe.thinningShape,u_thinningAffectedRatio:Oe.thinningAffectedRatio,u_thinningParticleOffset:Oe.thinningParticleOffset,u_particleColor:Oe.color,u_direction:Oe.direction});var Oe;const ze=Math.round(k*ue.intensity*this.particlesCount),Ne=i.b7.simpleSegment(0,0,4*ze,2*ze);this.particlesVx&&this.particlesIdx&&Z.draw(t,$.TRIANGLES,kn.disabled,Jn.disabled,vr.alphaBlended,Nn.disabled,De,"snow_particles",this.particlesVx,this.particlesIdx,Ne,{})})(a.boxSize,0,a),this._vignette.draw(t,v)}}const pc={symbol:function(h,t,a,p,v){if(h.renderPass!=="translucent")return;const b=Jn.disabled,E=h.colorModeForRenderPass(),k=a.layout.get("text-variable-anchor"),O=a.layout.get("text-size-scale-range"),N=i.aw(h.scaleFactor,O[0],O[1]);k&&function(Z,Y,he,ue,me,ve,Se,Pe){const Me=Y.transform,Fe=me==="map",De=ve==="map";for(const Oe of Z){const ze=ue.getTile(Oe),Ne=ze.getBucket(he);if(!Ne||!Ne.text||!Ne.text.segments.get().length)continue;const je=i.bp(Ne.textSizeData,Me.zoom,Pe),pt=dl(Oe,Ne.getProjection(),Me),ot=Me.calculatePixelsToTileUnitsMatrix(ze),Ve=Ns(pt,ze.tileID.canonical,De,Fe,Me,Ne.getProjection(),ot),Je=Ne.hasIconTextFit()&&Ne.hasIconData();if(je){const It=Math.pow(2,Me.zoom-ze.tileID.overscaledZ);qs(Ne,Fe,De,Se,i.cX,Me,Ve,Oe,It,je,Je)}}}(p,h,a,t,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),v,N);const $=a.paint.get("icon-opacity").constantOr(1)!==0,W=a.paint.get("text-opacity").constantOr(1)!==0;a.layout.get("symbol-sort-key").constantOr(1)!==void 0&&($||W)?Jr(h,t,a,p,b,E):($&&Jr(h,t,a,p,b,E,{onlyIcons:!0}),W&&Jr(h,t,a,p,b,E,{onlyText:!0})),t.map.showCollisionBoxes&&(Bh(h,t,a,p,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),Bh(h,t,a,p,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))},circle:function(h,t,a,p){if(h.renderPass!=="translucent")return;const v=a.paint.get("circle-opacity"),b=a.paint.get("circle-stroke-width"),E=a.paint.get("circle-stroke-opacity"),k=a.layout.get("circle-sort-key").constantOr(1)!==void 0,O=a.paint.get("circle-emissive-strength");if(v.constantOr(1)===0&&(b.constantOr(1)===0||E.constantOr(1)===0))return;const N=h.context,$=N.gl,W=h.transform,Z=h.depthModeForSublayer(0,kn.ReadOnly),Y=Jn.disabled,he=h.colorModeForDrapableLayerRenderPass(O),ue=W.projection.name==="globe",me=[i.at(W.center.lng),i.aA(W.center.lat)],ve=[];for(let Pe=0;Pe<p.length;Pe++){const Me=p[Pe],Fe=t.getTile(Me),De=Fe.getBucket(a);if(!De||De.projection.name!==W.projection.name)continue;const Oe=De.programConfigurations.get(a.id),ze=i.cY(a),Ne=h.isTileAffectedByFog(Me);ue&&ze.push("PROJECTION_GLOBE_VIEW"),ze.push("DEPTH_D24"),h.terrain&&W.depthOcclusionForSymbolsAndCircles&&ze.push("DEPTH_OCCLUSION");const je=h.getOrCreateProgram("circle",{config:Oe,defines:ze,overrideFog:Ne}),pt=De.layoutVertexBuffer,ot=De.globeExtVertexBuffer,Ve=De.indexBuffer,Je=W.projection.createInversionMatrix(W,Me.canonical),It={programConfiguration:Oe,program:je,layoutVertexBuffer:pt,globeExtVertexBuffer:ot,indexBuffer:Ve,uniformValues:i.cZ(h,Me,Fe,Je,me,a),tile:Fe};if(k){const kt=De.segments.get();for(const Ht of kt)ve.push({segments:new i.b7([Ht]),sortKey:Ht.sortKey,state:It})}else ve.push({segments:De.segments,sortKey:0,state:It})}k&&ve.sort((Pe,Me)=>Pe.sortKey-Me.sortKey);const Se={useDepthForOcclusion:W.depthOcclusionForSymbolsAndCircles};for(const Pe of ve){const{programConfiguration:Me,program:Fe,layoutVertexBuffer:De,globeExtVertexBuffer:Oe,indexBuffer:ze,uniformValues:Ne,tile:je}=Pe.state,pt=Pe.segments;h.terrain&&h.terrain.setupElevationDraw(je,Fe,Se),h.uploadCommonUniforms(N,Fe,je.tileID.toUnwrapped()),Fe.draw(h,$.TRIANGLES,Z,Y,he,Nn.disabled,Ne,a.id,De,ze,pt,a.paint,W.zoom,Me,[Oe])}},heatmap:function(h,t,a,p){if(a.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const v=h.context,b=v.gl,E=Jn.disabled,k=new vr([b.ONE,b.ONE,b.ONE,b.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(Y,he,ue,me){const ve=Y.gl,Se=he.width*me,Pe=he.height*me;Y.activeTexture.set(ve.TEXTURE1),Y.viewport.set([0,0,Se,Pe]);let Me=ue.heatmapFbo;if(!Me||Me&&(Me.width!==Se||Me.height!==Pe)){Me&&Me.destroy();const Fe=ve.createTexture();ve.bindTexture(ve.TEXTURE_2D,Fe),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,ve.LINEAR),Me=ue.heatmapFbo=Y.createFramebuffer(Se,Pe,!0,null),function(De,Oe,ze,Ne,je,pt){const ot=De.gl;ot.texImage2D(ot.TEXTURE_2D,0,De.extRenderToTextureHalfFloat?ot.RGBA16F:ot.RGBA,je,pt,0,ot.RGBA,De.extRenderToTextureHalfFloat?ot.HALF_FLOAT:ot.UNSIGNED_BYTE,null),Ne.colorAttachment.set(ze)}(Y,0,Fe,Me,Se,Pe)}else ve.bindTexture(ve.TEXTURE_2D,Me.colorAttachment.get()),Y.bindFramebuffer.set(Me.framebuffer)})(v,h,a,h.transform.projection.name==="globe"?.5:.25),v.clear({color:i.aj.transparent});const O=h.transform,N=O.projection.name==="globe",$=N?["PROJECTION_GLOBE_VIEW"]:[],W=N?Nn.frontCCW:Nn.disabled,Z=[i.at(O.center.lng),i.aA(O.center.lat)];for(let Y=0;Y<p.length;Y++){const he=p[Y];if(t.hasRenderableParent(he))continue;const ue=t.getTile(he),me=ue.getBucket(a);if(!me||me.projection.name!==O.projection.name)continue;const ve=h.isTileAffectedByFog(he),Se=me.programConfigurations.get(a.id),Pe=h.getOrCreateProgram("heatmap",{config:Se,defines:$,overrideFog:ve}),{zoom:Me}=h.transform;h.terrain&&h.terrain.setupElevationDraw(ue,Pe),h.uploadCommonUniforms(v,Pe,he.toUnwrapped());const Fe=O.projection.createInversionMatrix(O,he.canonical);Pe.draw(h,b.TRIANGLES,kn.disabled,E,k,W,bl(h,he,ue,Fe,Z,Me,a.paint.get("heatmap-intensity")),a.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,a.paint,h.transform.zoom,Se,N?[me.globeExtVertexBuffer]:null)}v.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(v,b){const E=v.context,k=E.gl,O=b.heatmapFbo;if(!O)return;E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,O.colorAttachment.get()),E.activeTexture.set(k.TEXTURE1);let N=b.colorRampTexture;N||(N=b.colorRampTexture=new i.T(E,b.colorRamp,k.RGBA8)),N.bind(k.LINEAR,k.CLAMP_TO_EDGE),v.getOrCreateProgram("heatmapTexture").draw(v,k.TRIANGLES,kn.disabled,Jn.disabled,v.colorModeForRenderPass(),Nn.disabled,(($,W,Z,Y)=>({u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}))(0,b),b.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,b.paint,v.transform.zoom)}(h,a))},line:function(h,t,a,p){if(h.renderPass!=="translucent")return;const v=a.paint.get("line-opacity"),b=a.paint.get("line-width");if(v.constantOr(1)===0||b.constantOr(1)===0)return;const E=a.paint.get("line-emissive-strength"),k=a.paint.get("line-occlusion-opacity"),O=a.layout.get("line-elevation-reference"),N=a.layout.get("line-width-unit")==="meters",$=O==="sea",W=h.context,Z=W.gl,Y=!a.isDraped();if(Y&&h.transform.projection.name==="globe")return;const he=a.layout.get("line-cross-slope"),ue=he!==void 0,me=he<1,ve=Y?new kn(h.depthOcclusion?Z.GREATER:Z.LEQUAL,kn.ReadOnly,h.depthRangeFor3D):h.depthModeForSublayer(0,kn.ReadOnly),Se=h.colorModeForDrapableLayerRenderPass(E),Pe=h.terrain&&h.terrain.renderingToTexture,Me=Pe?1:i.q.devicePixelRatio,Fe=a.paint.get("line-dasharray"),De=Fe.constantOr(1),Oe=a.layout.get("line-cap"),ze=Fe.constantOr(null),Ne=Oe.constantOr(null),je=a.paint.get("line-pattern"),pt=je.constantOr(1),ot=je.constantOr(null),Ve=a.paint.get("line-opacity").constantOr(1);let Je=!pt&&Ve!==1||h.depthOcclusion&&k>0&&k<1;const It=a.paint.get("line-gradient"),kt=pt?"linePattern":"line",Ht=i.c_(a);let ut;if(Pe&&h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(Je=!1),k!==0&&h.depthOcclusion){const xt=a.paint._values["line-opacity"];xt&&xt.value&&xt.value.kind==="constant"?ut=xt.value:i.w(`Occlusion opacity for layer ${a.id} is supported only when line-opacity isn't data-driven.`)}if(Y&&(h.forceTerrainMode=!0),!Y&&k!==0&&h.terrain&&!Pe)return void i.w(`Occlusion opacity for layer ${a.id} is supported on terrain only if the layer has line-z-offset enabled.`);const Lt=Je&&Y?h.stencilModeFor3D():Jn.disabled;Y&&(Ht.push("ELEVATED"),ue&&Ht.push(me?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),$&&Ht.push("ELEVATION_REFERENCE_SEA")),b.value.kind!=="constant"&&b.value.isLineProgressConstant===!1&&Ht.push("VARIABLE_LINE_WIDTH");for(const xt of p){const Gt=t.getTile(xt);if(pt&&!Gt.patternsLoaded())continue;const At=Gt.getBucket(a);if(!At)continue;h.prepareDrawTile();const Ct=At.programConfigurations.get(a.id),on=h.isTileAffectedByFog(xt),Zt=h.getOrCreateProgram(kt,{config:Ct,defines:Ht,overrideFog:on,overrideRtt:!Y&&void 0});if(ot&&Gt.imageAtlas){const dr=i.A.from(ot),Yr=Gt.imageAtlas.patternPositions[dr.getSerializedPrimary()];Yr&&Ct.setConstantPatternPositions(Yr)}if(!pt&&ze&&Ne&&Gt.lineAtlas){const dr=Gt.lineAtlas.getDash(ze,Ne);dr&&Ct.setConstantPatternPositions(dr)}let[cn,mn]=a.paint.get("line-trim-offset");(Ne==="round"||Ne==="square")&&cn!==mn&&(cn===0&&(cn-=1),mn===1&&(mn+=1));const jn=Pe?xt.projMatrix:null,In=N?1/At.tileToMeter/i.ar(Gt,1,h.transform.zoom):1,Rn=N?1/At.tileToMeter/i.ar(Gt,1,Math.floor(h.transform.zoom)):1,Gn=pt?i.c$(h,Gt,a,jn,Me,In,Rn,[cn,mn]):i.d0(h,Gt,a,jn,At.lineClipsArray.length,Me,In,Rn,[cn,mn]);if(It){const dr=At.gradients[a.id];let Yr=dr.texture;if(a.gradientVersion!==dr.version){let ci=256;if(a.stepInterpolant){const xr=t.getSource().maxzoom,Fr=xt.canonical.z===xr?Math.ceil(1<<h.transform.maxZoom-xt.canonical.z):1;ci=i.aw(i.d1(At.maxLineLength/i.ag*1024*Fr),256,W.maxTextureSize)}dr.gradient=i.d2({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:ci,image:dr.gradient||void 0,clips:At.lineClipsArray}),dr.texture?dr.texture.update(dr.gradient):dr.texture=new i.T(W,dr.gradient,Z.RGBA8),dr.version=a.gradientVersion,Yr=dr.texture}W.activeTexture.set(Z.TEXTURE1),Yr.bind(a.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}De&&(W.activeTexture.set(Z.TEXTURE0),Gt.lineAtlasTexture&&Gt.lineAtlasTexture.bind(Z.LINEAR,Z.REPEAT),Ct.updatePaintBuffers()),pt&&(W.activeTexture.set(Z.TEXTURE0),Gt.imageAtlasTexture&&Gt.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ct.updatePaintBuffers()),Y&&!$&&h.terrain.setupElevationDraw(Gt,Zt),h.uploadCommonUniforms(W,Zt,xt.toUnwrapped());const br=dr=>{ut!=null&&(ut.value=Ve*k),Zt.draw(h,Z.TRIANGLES,ve,dr,Se,Nn.disabled,Gn,a.id,At.layoutVertexBuffer,At.indexBuffer,At.segments,a.paint,h.transform.zoom,Ct,[At.layoutVertexBuffer2,At.patternVertexBuffer,At.zOffsetVertexBuffer]),ut!=null&&(ut.value=Ve)};if(Je&&!Y){const dr=h.stencilModeForClipping(xt).ref;dr===0&&Pe&&W.clear({stencil:0});const Yr={func:Z.EQUAL,mask:255};Gn.u_alpha_discard_threshold=.8,br(new Jn(Yr,dr,255,Z.KEEP,Z.KEEP,Z.INVERT)),Gn.u_alpha_discard_threshold=0,br(new Jn(Yr,dr,255,Z.KEEP,Z.KEEP,Z.KEEP))}else Je&&Y&&(Gn.u_alpha_discard_threshold=.001),br(Y?Lt:h.stencilModeForClipping(xt))}Y&&(h.forceTerrainMode=!1),Je&&(h.resetStencilClippingMasks(),Pe&&W.clear({stencil:0})),k===0||h.depthOcclusion||Pe||h.layersWithOcclusionOpacity.push(h.currentLayer)},fill:function(h,t,a,p){const v=a.paint.get("fill-color"),b=a.paint.get("fill-opacity"),E=a.is3D(),k=new kn(h.context.gl.LEQUAL,kn.ReadWrite,h.depthRangeFor3D);if(b.constantOr(1)===0)return;const O=a.paint.get("fill-emissive-strength"),N=h.colorModeForDrapableLayerRenderPass(O),$=a.paint.get("fill-pattern"),W=h.opaquePassEnabledForLayer()&&!$.constantOr(1)&&v.constantOr(i.aj.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===W){const Z=E?k:h.depthModeForSublayer(1,h.renderPass==="opaque"?kn.ReadWrite:kn.ReadOnly);Zc(h,t,a,p,Z,N,!1)}if(!E&&h.renderPass==="translucent"&&a.paint.get("fill-antialias")){const Z=E?k:h.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,kn.ReadOnly);Zc(h,t,a,p,Z,N,!0)}},"fill-extrusion":function(h,t,a,p){const v=a.paint.get("fill-extrusion-opacity"),b=h.context,E=b.gl,k=h.terrain,O=k&&k.renderingToTexture;if(v===0)return;const N=h.conflationActive&&h.style.isLayerClipped(a,t.getSource()),$=h.style.order.indexOf(a.fqid);if(N&&function(W,Z,Y,he,ue){for(const me of he){const ve=Z.getTile(me).getBucket(Y);ve&&(ve.updateReplacement(me,W.replacementSource,ue),ve.uploadCentroid(W.context))}}(h,t,a,p,$),k||N)for(const W of p){const Z=t.getTile(W).getBucket(a);Z&&Nh(h.context,t,W,Z,a,k,N)}if(h.renderPass==="shadow"&&h.shadowRenderer){const W=h.shadowRenderer;if(k&&v<.65&&a._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const Z=W.getShadowPassDepthMode(),Y=W.getShadowPassColorMode();sc(h,t,a,p,Z,Jn.disabled,Y,N)}else if(h.renderPass==="translucent"){const W=!a.paint.get("fill-extrusion-pattern").constantOr(1),Z=a.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!O&&Z.a!==0){const Y=new kn(h.context.gl.LEQUAL,kn.ReadWrite,h.depthRangeFor3D);v===1&&W?sc(h,t,a,p,Y,Jn.disabled,vr.unblended,N):(sc(h,t,a,p,Y,Jn.disabled,vr.disabled,N),sc(h,t,a,p,Y,h.stencilModeFor3D(),h.colorModeForRenderPass(),N),h.resetStencilClippingMasks())}if(h.style.enable3dLights()&&W&&(!k&&h.transform.projection.name!=="globe"||O)){const Y=a.paint.get("fill-extrusion-opacity"),he=a.paint.get("fill-extrusion-ambient-occlusion-intensity"),ue=a.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),me=a.paint.get("fill-extrusion-flood-light-intensity"),ve=a.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Se=a.paint.get("fill-extrusion-flood-light-color").toRenderColor(ve?null:a.lut).toArray01().slice(0,3),Pe=he>0&&ue>0,Me=me>0,Fe=(Oe,ze,Ne)=>(1-Ne)*Oe+Ne*ze,De=Oe=>{const ze=h.depthModeForSublayer(1,kn.ReadOnly,E.LEQUAL,!0),Ne=a.paint.get(Oe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),je=Fe(.1,3,Ne),pt=h._showOverdrawInspector;if(!pt){const ot=new Jn({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Ve=new vr([E.ONE,E.ONE,E.ONE,E.ONE],i.aj.transparent,[!1,!1,!1,!0],E.MIN);ca(h,t,a,p,ze,ot,Ve,Nn.disabled,Oe,"sdf",Y,he,ue,me,Se,je,N,!1)}{const ot=pt?Jn.disabled:new Jn({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),Ve=pt?h.colorModeForRenderPass():new vr([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],i.aj.transparent,[!0,!0,!0,!0]);ca(h,t,a,p,ze,ot,Ve,Nn.disabled,Oe,"color",Y,he,ue,me,Se,je,N,!1)}};if(O){const Oe=(ze,Ne,je)=>{const pt=h.depthModeForSublayer(1,kn.ReadOnly,E.LEQUAL,!1),ot=a.paint.get(ze?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ve=Fe(.1,3,ot);{const Je=new vr([E.ONE,E.ONE,E.ONE,E.ONE],i.aj.transparent,[!1,!1,!1,!0]);ca(h,t,a,p,pt,Jn.disabled,Je,Nn.disabled,ze,"clear",Y,he,ue,me,Se,Ve,N,Ne)}{const Je=new Jn({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),It=new vr([E.ONE,E.ONE,E.ONE,E.ONE],i.aj.transparent,[!1,!1,!1,!0],E.MIN);ca(h,t,a,p,pt,Je,It,Nn.disabled,ze,"sdf",Y,he,ue,me,Se,Ve,N,Ne)}{const Je=ze?E.ZERO:E.ONE_MINUS_DST_ALPHA,It=new Jn({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),kt=new vr([Je,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],i.aj.transparent,[!0,!0,!0,!0]);ca(h,t,a,p,pt,It,kt,Nn.disabled,ze,"color",Y,he,ue,me,Se,Ve,N,Ne)}{const Je=new vr([E.ONE,E.ONE,E.ONE,ze?E.ZERO:E.ONE],i.aj.transparent,[!1,!1,!1,!0],ze?E.FUNC_ADD:E.MAX);ca(h,t,a,p,pt,Jn.disabled,Je,Nn.disabled,ze,"clear",Y,he,ue,me,Se,Ve,N,Ne,je)}};if(Pe||Me){let ze;if(h.prepareDrawTile(),k){const Ne=k.drapeBufferSize[0],je=k.drapeBufferSize[1];ze=k.framebufferCopyTexture,ze&&(!ze||ze.size[0]===Ne&&ze.size[1]===je)||(ze&&ze.destroy(),ze=k.framebufferCopyTexture=new i.T(b,new i.r({width:Ne,height:je}),E.RGBA8)),ze.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,Ne,je)}Pe&&Oe(!0,!1,ze),Me&&Oe(!1,!0,ze)}}else Pe&&De(!0),Me&&De(!1),(Pe||Me)&&h.resetStencilClippingMasks()}}},hillshade:function(h,t,a,p){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent"||h.style.disableElevatedTerrain)return;const v=h.context,b=h.terrain&&h.terrain.renderingToTexture,[E,k]=h.renderPass!=="translucent"||b?[{},p]:h.stencilConfigForOverlap(p);for(const O of k){const N=t.getTile(O);if(N.needsHillshadePrepare&&h.renderPass==="offscreen")nm(h,N,a);else if(h.renderPass==="translucent"){const $=h.depthModeForSublayer(0,kn.ReadOnly),W=a.paint.get("hillshade-emissive-strength"),Z=h.colorModeForDrapableLayerRenderPass(W),Y=b&&h.terrain?h.terrain.stencilModeForRTTOverlap(O):E[O.overscaledZ];Sh(h,O,N,a,$,Y,Z)}}v.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,t,a,p,v,b){if(h.renderPass!=="translucent"||a.paint.get("raster-opacity")===0)return;const E=h.transform.projection.name==="globe",k=a.paint.get("raster-elevation")!==0,O=k&&E;if(h.renderElevatedRasterBackface&&!O)return;const N=h.context,$=N.gl,W=t.getSource(),Z=function(De,Oe,ze,Ne){const je=Oe.paint.get("raster-color"),pt=De.type==="raster-array",ot=[],Ve=Oe.paint.get("raster-resampling"),Je=Oe.paint.get("raster-color-mix");let It=Oe.paint.get("raster-color-range");const kt=[Je[0],Je[1],Je[2],0],Ht=Je[3];let ut=Ve==="nearest"?Ne.NEAREST:Ne.LINEAR;if(pt&&(ot.push("RASTER_ARRAY"),je||ot.push("RASTER_COLOR"),Ve==="linear"&&ot.push("RASTER_ARRAY_LINEAR"),ut=Ne.NEAREST,!It&&De.rasterLayers)){const Lt=De.rasterLayers.find(({id:xt})=>xt===Oe.sourceLayer);Lt&&Lt.fields&&Lt.fields.range&&(It=Lt.fields.range)}if(It=It||[0,1],je){ot.push("RASTER_COLOR"),ze.activeTexture.set(Ne.TEXTURE2),Oe.updateColorRamp(It);let Lt=Oe.colorRampTexture;Lt||(Lt=Oe.colorRampTexture=new i.T(ze,Oe.colorRamp,Ne.RGBA8)),Lt.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}return{mix:kt,range:It,offset:Ht,defines:ot,resampling:ut}}(W,a,N,$);if(W instanceof i.aJ&&!p.length&&!E)return;const Y=a.paint.get("raster-emissive-strength"),he=h.colorModeForDrapableLayerRenderPass(Y),ue=h.terrain&&h.terrain.renderingToTexture,me=!h.options.moving,ve=a.paint.get("raster-resampling")==="nearest"?$.NEAREST:$.LINEAR;if(W instanceof i.aJ&&!p.length&&(W.onNorthPole||W.onSouthPole)){const De=k?h.stencilModeFor3D():Jn.disabled;return void Es(!!W.onNorthPole,null,h,t,a,Y,Z,Nn.disabled,De)}if(!p.length)return;const[Se,Pe]=W instanceof i.aJ||ue?[{},p]:h.stencilConfigForOverlap(p),Me=Pe[Pe.length-1].overscaledZ;O&&Z.defines.push("PROJECTION_GLOBE_VIEW"),k&&Z.defines.push("RENDER_CUTOFF");const Fe=(De,Oe,ze)=>{for(const Ne of De){const je=Ne.toUnwrapped(),pt=t.getTile(Ne);if(ue&&(!pt||!pt.hasData()))continue;N.activeTexture.set($.TEXTURE0);const ot=ft(pt,W,a,Z);if(!ot||!ot.texture)continue;const{texture:Ve,mix:Je,offset:It,tileSize:kt,buffer:Ht}=ot;let ut,Lt;ue?(ut=kn.disabled,Lt=Ne.projMatrix):k?(ut=new kn($.LEQUAL,kn.ReadWrite,h.depthRangeFor3D),Lt=E?Float32Array.from(h.transform.expandedFarZProjMatrix):h.transform.calculateProjMatrix(je,me)):(ut=h.depthModeForSublayer(Ne.overscaledZ-Me,a.paint.get("raster-opacity")===1?kn.ReadWrite:kn.ReadOnly,$.LESS),Lt=h.transform.calculateProjMatrix(je,me));const xt=h.terrain&&ue?h.terrain.stencilModeForRTTOverlap(Ne):Se[Ne.overscaledZ],Gt=b?0:a.paint.get("raster-fade-duration");pt.registerFadeDuration(Gt);const At=t.findLoadedParent(Ne,0),Ct=Ai(pt,At,t,h.transform,Gt);let on,Zt;h.terrain&&h.terrain.prepareDrawTile(),N.activeTexture.set($.TEXTURE0),Ve.bind(ve,$.CLAMP_TO_EDGE),N.activeTexture.set($.TEXTURE1),At?(At.texture&&At.texture.bind(ve,$.CLAMP_TO_EDGE),on=Math.pow(2,At.tileID.overscaledZ-pt.tileID.overscaledZ),Zt=[pt.tileID.canonical.x*on%1,pt.tileID.canonical.y*on%1]):Ve.bind(ve,$.CLAMP_TO_EDGE),Ve.useMipmap&&N.extTextureFilterAnisotropic&&h.transform.pitch>20&&$.texParameterf($.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const cn=h.transform;let mn;const jn=k?bi(cn):[0,0,0,0];let In,Rn,Gn,br,dr,Yr=0;if(O&&W instanceof i.aJ&&W.coordinates.length>3)In=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),Rn=Float32Array.from(cn.globeMatrix),Gn=Float32Array.from(i.cD(cn)),br=[i.at(cn.center.lng),i.aA(cn.center.lat)],mn=W.elevatedGlobePerspectiveTransform,dr=W.elevatedGlobeGridMatrix||new Float32Array(9);else if(O){const Wn=i.cE(Ne.canonical);Yr=i.cF(Wn.getCenter().lat),In=Float32Array.from(i.bb(i.cH(Ne.canonical))),Rn=Float32Array.from(cn.globeMatrix),Gn=Float32Array.from(i.cD(cn)),br=[i.at(cn.center.lng),i.aA(cn.center.lat)],mn=[0,0],dr=Float32Array.from(i.cG(Ne.canonical,Wn,Yr,cn.worldSize/cn._pixelsPerMercatorPixel))}else mn=W instanceof i.aJ?W.perspectiveTransform:[0,0],In=new Float32Array(16),Rn=new Float32Array(9),Gn=new Float32Array(16),br=[0,0],dr=new Float32Array(9);const ci=wl(Lt,In,Rn,Gn,dr,Zt||[0,0],i.ae(h.transform.zoom),br,jn,on||1,Ct,a,mn,k?a.paint.get("raster-elevation"):0,2,Je,It,Z.range,kt,Ht,Y),xr=h.isTileAffectedByFog(Ne),Fr=h.getOrCreateProgram("raster",{defines:Z.defines,overrideFog:xr});if(h.uploadCommonUniforms(N,Fr,je),W instanceof i.aJ){const Wn=W.elevatedGlobeVertexBuffer,Cn=W.elevatedGlobeIndexBuffer;if(ue||!E)W.boundsBuffer&&W.boundsSegments&&Fr.draw(h,$.TRIANGLES,ut,Jn.disabled,he,Nn.disabled,ci,a.id,W.boundsBuffer,h.quadTriangleIndexBuffer,W.boundsSegments);else if(Wn&&Cn){const Br=cn.zoom<=i.c6?W.elevatedGlobeSegments:W.getSegmentsForLongitude(cn.center.lng);Br&&Fr.draw(h,$.TRIANGLES,ut,Jn.disabled,he,Oe,ci,a.id,Wn,Cn,Br)}}else if(O){ut=new kn($.LEQUAL,kn.ReadOnly,h.depthRangeFor3D);const Wn=h.globeSharedBuffers;if(Wn){const[Cn,Br,$r]=Wn.getGridBuffers(Yr,!1);Fr.draw(h,$.TRIANGLES,ut,ze||xt,h.colorModeForRenderPass(),Oe,ci,a.id,Cn,Br,$r)}}else{const{tileBoundsBuffer:Wn,tileBoundsIndexBuffer:Cn,tileBoundsSegments:Br}=h.getTileBoundsBuffers(pt);Fr.draw(h,$.TRIANGLES,ut,xt,he,Nn.disabled,ci,a.id,Wn,Cn,Br)}}if(!(W instanceof i.aJ)&&O)for(const Ne of De){const je=Ne.canonical.y===(1<<Ne.canonical.z)-1;Ne.canonical.y===0&&Es(!0,Ne,h,t,a,Y,Z,Oe,ze||Jn.disabled),je&&Es(!1,Ne,h,t,a,Y,Z,Oe===Nn.frontCW?Nn.backCW:Nn.frontCW,ze||Jn.disabled)}};O?Fe(Pe,h.renderElevatedRasterBackface?Nn.backCW:Nn.frontCW,h.stencilModeFor3D()):Fe(Pe,Nn.disabled,void 0),h.resetStencilClippingMasks()},"raster-particle":function(h,t,a,p,v,b){h.renderPass==="offscreen"&&function(E,k,O,N){if(!N.length)return;const $=E.context,W=$.gl,Z=k.getSource();if(!(Z instanceof ll))return;const Y=Math.ceil(Math.sqrt(O.paint.get("raster-particle-count")));let he=O.particlePositionRGBAImage;if(!he||he.width!==Y){const Pe=function(Me){const Fe=Me*Me,De=new Uint8Array(4*Fe),Oe=function(Ne){return Ne|=0,Ne=Math.imul(2747636419^Ne,2654435769),Ne=Math.imul(Ne^Ne>>>16,2654435769),((Ne=Math.imul(Ne^Ne>>>16,2654435769))>>>0)/4294967296},ze=1/1.1;for(let Ne=0;Ne<Fe;Ne++){const je=ze*(Oe(2*Ne+0)+yo),pt=ze*(Oe(2*Ne+1)+yo),ot=255*je%1,Ve=255*pt%1,Je=ot,It=pt-Ve/255,kt=Ve;De[4*Ne+0]=255*(je-ot/255),De[4*Ne+1]=255*Je,De[4*Ne+2]=255*It,De[4*Ne+3]=255*kt}return De}(Y);he=O.particlePositionRGBAImage=new i.r({width:Y,height:Y},Pe)}let ue=O.particleFramebuffer;ue?ue.width!==Y&&(ue.destroy(),ue=O.particleFramebuffer=$.createFramebuffer(Y,Y,!0,null)):ue=O.particleFramebuffer=$.createFramebuffer(Y,Y,!0,null);const me=[];for(const Pe of N){const Me=k.getTile(Pe);if(!(Me instanceof hd))continue;const Fe=Dd(Me,Z,O);if(!Fe)continue;const De=[Me.tileSize,Me.tileSize];let Oe=O.tileFramebuffer;Oe||(Oe=O.tileFramebuffer=$.createFramebuffer(De[0],De[1],!0,null));let ze=Me.rasterParticleState;ze||(ze=Me.rasterParticleState=new Ta($,Pe,De,he));const Ne=ze.update(O.lastInvalidatedAt);ze.particleTextureDimension!==Y&&ze.updateParticleTexture(Pe,he);const je=ze.targetColorTexture;ze.targetColorTexture=ze.backgroundColorTexture,ze.backgroundColorTexture=je;const pt=ze.particleTexture0;ze.particleTexture0=ze.particleTexture1,ze.particleTexture1=pt,me.push([Pe,Fe,ze,Ne])}if(me.length===0)return;const ve=i.q.now(),Se=O.previousDrawTimestamp?.001*(ve-O.previousDrawTimestamp):.0167;if(O.previousDrawTimestamp=ve,O.hasColorMap()){$.activeTexture.set(W.TEXTURE0+2);let Pe=O.colorRampTexture;Pe||(Pe=O.colorRampTexture=new i.T($,O.colorRamp,W.RGBA8)),Pe.bind(W.LINEAR,W.CLAMP_TO_EDGE)}$.bindFramebuffer.set(O.tileFramebuffer.framebuffer),function(Pe,Me,Fe){const De=Pe.context,Oe=De.gl,ze=Me.tileFramebuffer;De.activeTexture.set(Oe.TEXTURE0);const Ne={u_texture:0,u_opacity:1.05*(pt=Me.paint.get("raster-particle-fade-opacity-factor"))/(pt+.05)},je=Pe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var pt;for(const ot of Fe){const[,,Ve,Je]=ot;ze.colorAttachment.set(Ve.targetColorTexture.texture),De.viewport.set([0,0,ze.width,ze.height]),De.clear({color:i.aj.transparent}),Je&&(Ve.backgroundColorTexture.bind(Oe.NEAREST,Oe.CLAMP_TO_EDGE),je.draw(Pe,Oe.TRIANGLES,kn.disabled,Jn.disabled,vr.alphaBlended,Nn.disabled,Ne,Me.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments))}}(E,O,me),function(Pe,Me,Fe,De){const Oe=Pe.context,ze=Oe.gl,Ne=Fe.tileFramebuffer,je=Pe.transform.projection.name==="globe",pt=Fe.paint.get("raster-particle-max-speed");for(const ot of De){const[Ve,Je,It]=ot;Oe.activeTexture.set(ze.TEXTURE0+0),Je.texture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),Ne.colorAttachment.set(It.targetColorTexture.texture);const kt=Pe.getOrCreateProgram("rasterParticleDraw",{defines:Je.defines,overrideFog:!1});Oe.activeTexture.set(ze.TEXTURE0+1);const Ht=Je.scalarData?[]:[0,1,2,3].map(xt=>i.d4[xt](Ve));Ht.push(Ve);const ut=Ve.canonical.x,Lt=Ve.canonical.y;for(const xt of Ht){const Gt=Me.getTile(je?xt.wrapped():xt);if(!Gt)continue;const At=Gt.rasterParticleState;if(!At)continue;const Ct=xt.canonical.x+(1<<xt.canonical.z)*(xt.wrap-Ve.wrap),on=xt.canonical.y;At.particleTexture0.bind(ze.NEAREST,ze.CLAMP_TO_EDGE);const Zt=Mn(1,At.particleTexture0.size[0],[Ct-ut,on-Lt],0,Je.texture.size,2,pt,Je.textureOffset,Je.scale,Je.offset);kt.draw(Pe,ze.POINTS,kn.disabled,Jn.disabled,vr.alphaBlended,Nn.disabled,Zt,Fe.id,At.particleIndexBuffer,void 0,At.particleSegment)}}}(E,k,O,me),$.bindFramebuffer.set(O.particleFramebuffer.framebuffer),function(Pe,Me,Fe,De){const Oe=Pe.context,ze=Oe.gl,Ne=Me.paint.get("raster-particle-max-speed"),je=De*Me.paint.get("raster-particle-speed-factor")*.15,pt=function(Ve){return Math.pow(Ve,6)}(.01+1*Me.paint.get("raster-particle-reset-rate-factor")),ot=Me.particleFramebuffer;Oe.viewport.set([0,0,ot.width,ot.height]);for(const Ve of Fe){const[,Je,It]=Ve;Oe.activeTexture.set(ze.TEXTURE0+0),Je.texture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),Oe.activeTexture.set(ze.TEXTURE0+1);const kt=It.particleTexture0;kt.bind(ze.NEAREST,ze.CLAMP_TO_EDGE);const Ht=Ld(1,kt.size[0],0,Je.texture.size,Ne,je,pt,Je.textureOffset,Je.scale,Je.offset);ot.colorAttachment.set(It.particleTexture1.texture),Oe.clear({color:i.aj.transparent}),Pe.getOrCreateProgram("rasterParticleUpdate",{defines:Je.defines}).draw(Pe,ze.TRIANGLES,kn.disabled,Jn.disabled,vr.unblended,Nn.disabled,Ht,Me.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments)}}(E,O,me,Se)}(h,t,a,p),h.renderPass==="translucent"&&(function(E,k,O,N,$){const W=E.context,Z=W.gl,Y=k.getSource().tileSize,he=5*(1-i.ac(i.bY,i.bY+1,E.transform.zoom))*Y+O.paint.get("raster-particle-elevation"),ue=!E.options.moving,me=E.transform.projection.name==="globe";if(!N.length)return;const[ve,Se]=E.stencilConfigForOverlap(N),Pe=[];me&&Pe.push("PROJECTION_GLOBE_VIEW");const Me=E.stencilModeFor3D();for(const Fe of Se){const De=Fe.toUnwrapped(),Oe=k.getTile(Fe);if(!Oe.rasterParticleState)continue;const ze=Oe.rasterParticleState,Ne=100;Oe.registerFadeDuration(Ne);const je=k.findLoadedParent(Fe,0),pt=Ai(Oe,je,k,E.transform,Ne);let ot,Ve;E.terrain&&E.terrain.prepareDrawTile(),W.activeTexture.set(Z.TEXTURE0),ze.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),W.activeTexture.set(Z.TEXTURE1),je&&je.rasterParticleState?(je.rasterParticleState.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ot=Math.pow(2,je.tileID.overscaledZ-Oe.tileID.overscaledZ),Ve=[Oe.tileID.canonical.x*ot%1,Oe.tileID.canonical.y*ot%1]):ze.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const Je=me?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(De,ue),It=E.transform,kt=Vp(It),Ht=i.cE(Fe.canonical),ut=i.cF(Ht.getCenter().lat);let Lt,xt,Gt,At,Ct;me?(Lt=Float32Array.from(i.bb(i.cH(Fe.canonical))),xt=Float32Array.from(It.globeMatrix),Gt=Float32Array.from(i.cD(It)),At=[i.at(It.center.lng),i.aA(It.center.lat)],Ct=Float32Array.from(i.cG(Fe.canonical,Ht,ut,It.worldSize/It._pixelsPerMercatorPixel))):(Lt=new Float32Array(16),xt=new Float32Array(9),Gt=new Float32Array(16),At=[0,0],Ct=new Float32Array(9));const on=Vs(Je,Lt,xt,Gt,Ct,Ve||[0,0],i.ae(E.transform.zoom),At,kt,ot||1,pt,he),Zt=E.isTileAffectedByFog(Fe),cn=E.getOrCreateProgram("rasterParticle",{defines:Pe,overrideFog:Zt});if(E.uploadCommonUniforms(W,cn,De),me){const mn=new kn(Z.LEQUAL,kn.ReadOnly,E.depthRangeFor3D),jn=0,In=E.globeSharedBuffers;if(In){const[Rn,Gn,br]=In.getGridBuffers(ut,jn!==0);cn.draw(E,Z.TRIANGLES,mn,Me,vr.alphaBlended,E.renderElevatedRasterBackface?Nn.frontCCW:Nn.backCCW,on,O.id,Rn,Gn,br)}}else{const mn=E.depthModeForSublayer(0,kn.ReadOnly),jn=ve[Fe.overscaledZ],{tileBoundsBuffer:In,tileBoundsIndexBuffer:Rn,tileBoundsSegments:Gn}=E.getTileBoundsBuffers(Oe);cn.draw(E,Z.TRIANGLES,mn,jn,vr.alphaBlended,Nn.disabled,on,O.id,In,Rn,Gn)}}E.resetStencilClippingMasks()}(h,t,a,p),h.style.map.triggerRepaint())},background:function(h,t,a,p){const v=a.paint.get("background-color"),b=a.paint.get("background-color-use-theme").constantOr("default")==="none",E=a.paint.get("background-opacity"),k=a.paint.get("background-emissive-strength"),O=a.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const N=h.context,$=N.gl,W=h.transform,Z=W.tileSize,Y=a.paint.get("background-pattern");let he;if(Y!==void 0&&(Y===null||(he=h.imageManager.getPattern(Y.toString(),a.scope,h.style.getLut(a.scope)),!he)))return;const ue=!Y&&v.a===1&&E===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==ue)return;const me=Jn.disabled,ve=h.depthModeForSublayer(0,ue==="opaque"?kn.ReadWrite:kn.ReadOnly),Se=h.colorModeForDrapableLayerRenderPass(k),Pe=Y?"backgroundPattern":"background";let Me,Fe=p;if(Fe||(Me=h.getBackgroundTiles(),Fe=Object.values(Me).map(De=>De.tileID)),Y&&(N.activeTexture.set($.TEXTURE0),h.imageManager.bind(h.context,a.scope)),O){const De=h.getOrCreateProgram(Pe,{overrideFog:!1,overrideRtt:!0}),Oe=new Float32Array(i.ab.mat4.identity([])),ze=new i.aG(0,0,0,0,0),Ne=Y?Ni(Oe,k,E,h,0,a.scope,he,O,{tileID:ze,tileSize:Z}):es(Oe,k,E,v.toRenderColor(b?null:a.lut));De.draw(h,$.TRIANGLES,ve,me,Se,Nn.disabled,Ne,a.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments)}else for(const De of Fe){const Oe=h.isTileAffectedByFog(De),ze=h.getOrCreateProgram(Pe,{overrideFog:Oe}),Ne=De.toUnwrapped(),je=p?De.projMatrix:h.transform.calculateProjMatrix(Ne);h.prepareDrawTile();const pt=t?t.getTile(De):Me?Me[De.key]:new ul(De,Z,W.zoom,h),ot=Y?Ni(je,k,E,h,0,a.scope,he,O,{tileID:De,tileSize:Z}):es(je,k,E,v.toRenderColor(b?null:a.lut));h.uploadCommonUniforms(N,ze,Ne);const{tileBoundsBuffer:Ve,tileBoundsIndexBuffer:Je,tileBoundsSegments:It}=h.getTileBoundsBuffers(pt);ze.draw(h,$.TRIANGLES,ve,me,Se,Nn.disabled,ot,a.id,Ve,Je,It)}},sky:function(h,t,a){const p=h._atmosphere?i.ae(h.transform.zoom):1,v=a.paint.get("sky-opacity")*p;if(v===0)return;const b=h.context,E=a.paint.get("sky-type"),k=new kn(b.gl.LEQUAL,kn.ReadOnly,[0,1]),O=h.frameCounter/1e3%1;E==="atmosphere"?h.renderPass==="offscreen"?a.needsSkyboxCapture(h)&&(function(N,$,W,Z){const Y=N.context,he=Y.gl;let ue=$.skyboxFbo;if(!ue){ue=$.skyboxFbo=Y.createFramebuffer(32,32,!0,null),$.skyboxGeometry=new ns(Y),$.skyboxTexture=Y.gl.createTexture(),he.bindTexture(he.TEXTURE_CUBE_MAP,$.skyboxTexture),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MAG_FILTER,he.LINEAR);for(let Pe=0;Pe<6;++Pe)he.texImage2D(he.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,0,he.RGBA,32,32,0,he.RGBA,he.UNSIGNED_BYTE,null)}Y.bindFramebuffer.set(ue.framebuffer),Y.viewport.set([0,0,32,32]);const me=$.getCenter(N,!0),ve=N.getOrCreateProgram("skyboxCapture"),Se=new Float64Array(16);i.ab.mat4.identity(Se),i.ab.mat4.rotateY(Se,Se,.5*-Math.PI),uc(N,$,ve,Se,me,0),i.ab.mat4.identity(Se),i.ab.mat4.rotateY(Se,Se,.5*Math.PI),uc(N,$,ve,Se,me,1),i.ab.mat4.identity(Se),i.ab.mat4.rotateX(Se,Se,.5*-Math.PI),uc(N,$,ve,Se,me,2),i.ab.mat4.identity(Se),i.ab.mat4.rotateX(Se,Se,.5*Math.PI),uc(N,$,ve,Se,me,3),i.ab.mat4.identity(Se),uc(N,$,ve,Se,me,4),i.ab.mat4.identity(Se),i.ab.mat4.rotateY(Se,Se,Math.PI),uc(N,$,ve,Se,me,5),Y.viewport.set([0,0,N.width,N.height])}(h,a),a.markSkyboxValid(h)):h.renderPass==="sky"&&function(N,$,W,Z,Y){const he=N.context,ue=he.gl,me=N.transform,ve=N.getOrCreateProgram("skybox");he.activeTexture.set(ue.TEXTURE0),ue.bindTexture(ue.TEXTURE_CUBE_MAP,$.skyboxTexture);const Se=((Pe,Me,Fe,De,Oe)=>({u_matrix:Pe,u_sun_direction:Me,u_cubemap:0,u_opacity:De,u_temporal_offset:Oe}))(me.skyboxMatrix,$.getCenter(N,!1),0,Z,Y);N.uploadCommonUniforms(he,ve),ve.draw(N,ue.TRIANGLES,W,Jn.disabled,N.colorModeForRenderPass(),Nn.backCW,Se,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(h,a,k,v,O):E==="gradient"&&h.renderPass==="sky"&&function(N,$,W,Z,Y){const he=N.context,ue=he.gl,me=N.transform,ve=N.getOrCreateProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new ns(he)),he.activeTexture.set(ue.TEXTURE0);let Se=$.colorRampTexture;Se||(Se=$.colorRampTexture=new i.T(he,$.colorRamp,ue.RGBA8)),Se.bind(ue.LINEAR,ue.CLAMP_TO_EDGE);const Pe=((Me,Fe,De,Oe,ze)=>({u_matrix:Me,u_color_ramp:0,u_center_direction:Fe,u_radius:i.ai(De),u_opacity:Oe,u_temporal_offset:ze}))(me.skyboxMatrix,$.getCenter(N,!1),$.paint.get("sky-gradient-radius"),Z,Y);N.uploadCommonUniforms(he,ve),ve.draw(N,ue.TRIANGLES,W,Jn.disabled,N.colorModeForRenderPass(),Nn.backCW,Pe,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(h,a,k,v,O)},debug:function(h,t,a,p,v,b){for(let E=0;E<a.length;E++)if(v){const N=new i.aj(p.r*.8,p.g*.8,p.b*.8,1);cc(h,t,a[E],p,-1,-1,b),cc(h,t,a[E],p,-1,1,b),cc(h,t,a[E],p,1,1,b),cc(h,t,a[E],p,1,-1,b),cc(h,t,a[E],N,0,0,b)}else cc(h,t,a[E],p,0,0,b)},custom:function(h,t,a,p){const v=h.context,b=a.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||h.renderPass==="offscreen")&&a.isDraped(t)){if(h.renderPass==="offscreen"){const E=b.prerender;if(E){if(h.setCustomLayerDefaults(),v.setColorMode(h.colorModeForRenderPass()),h.transform.projection.name==="globe"){const k=h.transform.pointMerc;E.call(b,v.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),i.ae(h.transform.zoom),[k.x,k.y],h.transform.pixelsPerMeterRatio)}else E.call(b,v.gl,h.transform.customLayerMatrix());v.setDirty(),h.setBaseState()}}else if(h.renderPass==="translucent"){if(h.terrain&&h.terrain.renderingToTexture){const k=b.renderToTile;if(k){const O=p[0].canonical,N=new i.aa(O.x+p[0].wrap*(1<<O.z),O.y,O.z);v.setDepthMode(kn.disabled),v.setStencilMode(Jn.disabled),v.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),k.call(b,v.gl,N),v.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),v.setColorMode(h.colorModeForRenderPass()),v.setStencilMode(Jn.disabled);const E=b.renderingMode==="3d"?new kn(h.context.gl.LEQUAL,kn.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,kn.ReadOnly);if(v.setDepthMode(E),h.transform.projection.name==="globe"){const k=h.transform.pointMerc;b.render(v.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),i.ae(h.transform.zoom),[k.x,k.y],h.transform.pixelsPerMeterRatio)}else b.render(v.gl,h.transform.customLayerMatrix());v.setDirty(),h.setBaseState(),v.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(h,t,a,p){if(h.renderPass==="opaque")return;const v=a.paint.get("model-opacity").constantOr(1);if(v===0)return;const b=a.paint.get("model-cast-shadows");if(h.renderPass==="shadow"&&(!b||h.terrain&&v<.65&&a._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const E=h.shadowRenderer,k=a.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,k||(E.enabled=!1));const O=()=>{E&&(E.useNormalOffset=!0,k||(E.enabled=!0))},N=t.getSource();if(h.renderPass==="light-beam"&&N.type!=="batched-model")return;if(N.type==="vector"||N.type==="geojson")return function(ve,Se,Pe,Me,Fe){const De=ve.transform;if(De.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${De.projection.name} projection is not yet implemented`);const Oe=De.getFreeCameraOptions().position;if(!ve.modelManager)return;const ze=ve.modelManager;Pe.modelManager=ze;const Ne=ve.shadowRenderer;if(!Pe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const je=Pe._unevaluatedLayout._values["model-id"],pt={...Pe.layout.get("model-id").parameters},ot=ve.style.order.indexOf(Pe.fqid);for(const Ve of Me){const Je=Se.getTile(Ve).getBucket(Pe);if(!Je||Je.projection.name!==De.projection.name)continue;const It=Je.getModelUris();It&&!Je.modelsRequested&&(ze.addModelsFromBucket(It,Fe),Je.modelsRequested=!0);const kt=ua(Ve,De);pt.zoom=kt;const Ht=je.possiblyEvaluate(pt);if(vo(ve,Je,Ve),hs.shadowUniformsInitialized=!1,hs.useSingleShadowCascade=!!Ne&&Ne.getMaxCascadeForTile(Ve.toUnwrapped())===0,ve.renderPass==="shadow"&&Ne){if(ve.currentShadowCascade===1&&Je.isInsideFirstShadowMapFrustum)continue;const xt=De.calculatePosMatrix(Ve.toUnwrapped(),De.worldSize);if(hs.tileMatrix.set(xt),hs.shadowTileMatrix=Float32Array.from(Ne.calculateShadowPassMatrixFromMatrix(xt)),hs.aabb.min.fill(0),hs.aabb.max[0]=hs.aabb.max[1]=i.ag,hs.aabb.max[2]=0,Io(Je,hs,ve,Pe.scope))continue}const ut=1<<Ve.canonical.z,Lt=[((Oe.x-Ve.wrap)*ut-Ve.canonical.x)*i.ag,(Oe.y*ut-Ve.canonical.y)*i.ag,Oe.z*ut*i.ag];ve.conflationActive&&Object.keys(Je.instancesPerModel).length>0&&ve.style.isLayerClipped(Pe,Se.getSource())&&Je.updateReplacement(Ve,ve.replacementSource,ot,Fe)&&(Je.uploaded=!1,Je.upload(ve.context));for(let xt in Je.instancesPerModel){const Gt=Je.instancesPerModel[xt];Gt.features.length>0&&(xt=Ht.evaluate(Gt.features[0].feature,{}));const At=ze.getModel(xt,Fe);if(At&&At.uploaded)for(const Ct of At.nodes)Zs(ve,Pe,Ct,Gt,Lt,Ve,hs)}}}(h,t,a,p,N.type==="vector"?a.scope:""),void O();if(!N.loaded())return;if(N.type==="batched-model")return function(ve,Se,Pe,Me){Pe.resetLayerRenderingStats(ve);const Fe=ve.context,De=ve.transform,Oe=ve.style.fog,ze=ve.shadowRenderer;if(De.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${De.projection.name} projection is not yet implemented`);const Ne=ve.transform.getFreeCameraOptions().position,je=i.ab.vec3.scale([],[Ne.x,Ne.y,Ne.z],ve.transform.worldSize),pt=i.ab.vec3.negate([],je),ot=i.ab.mat4.identity([]),Ve=i.dj(De.center.lat,De.zoom),Je=i.ab.mat4.fromScaling([],[1,1,1/Ve]);i.ab.mat4.translate(ot,ot,pt);const It=Pe.paint.get("model-opacity").constantOr(1),kt=new kn(Fe.gl.LEQUAL,kn.ReadWrite,ve.depthRangeFor3D),Ht=new kn(Fe.gl.LEQUAL,kn.ReadOnly,ve.depthRangeFor3D),ut=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Lt=ve.renderPass==="shadow",xt=Lt&&ze?ze.getCurrentCascadeFrustum():De.getFrustum(De.scaleZoom(De.worldSize)),Gt=Pe.paint.get("model-front-cutoff"),At=Gt[2]<1,Ct=Oa(ve,Pe.paint.get("model-cutoff-fade-range")),on=Pe.getLayerRenderingStats();(function(Zt,cn,mn,jn){const In=Zt.terrain?Zt.terrain.exaggeration():0,Rn=Zt.transform.zoom;for(const Gn of jn){const br=cn.getTile(Gn).getBucket(mn);br&&(Zt.conflationActive&&br.updateReplacement(Gn,Zt.replacementSource),br.evaluateScale(Zt,mn),Zt.terrain&&In>0&&br.elevationUpdate(Zt.terrain,In,Gn,mn.source),br.needsReEvaluation(Zt,Rn,mn)&&br.evaluate(mn))}})(ve,Se,Pe,Me),function(){let Zt,cn,mn;At?(Zt=Me.length-1,cn=-1,mn=-1):(Zt=0,cn=Me.length,mn=1);const jn=new Float64Array(16),In=i.ab.vec3.create(),Rn=new i.P(0,0);for(let Gn=Zt;Gn!==cn;Gn+=mn){const br=Me[Gn],dr=Se.getTile(br).getBucket(Pe);if(!dr||!dr.uploaded)continue;let Yr=!1;ze&&(Yr=ze.getMaxCascadeForTile(br.toUnwrapped())===0);const ci=De.calculatePosMatrix(br.toUnwrapped(),De.worldSize),xr=dr.modelTraits;!Lt&&At&&(i.ab.mat4.invert(jn,ci),i.ab.vec3.transformMat4(In,je,jn),Rn.x=In[0],Rn.y=In[1]);const Fr=[];for(const Wn of dr.getNodesInfo()){if(Wn.hiddenByReplacement||!Wn.node.meshes)continue;const Cn=Wn.node;let Br=0;ve.terrain&&Cn.elevation&&(Br=Cn.elevation*ve.terrain.exaggeration());const $r=(()=>{const Mr=Wn.aabb;return ut.min=[...Mr.min],ut.max=[...Mr.max],ut.min[2]+=Br,ut.max[2]+=Br,i.ab.vec3.transformMat4(ut.min,ut.min,ci),i.ab.vec3.transformMat4(ut.max,ut.max,ci),ut})(),yi=Wn.evaluatedScale;if(yi[0]<=1&&yi[1]<=1&&yi[2]<=1&&$r.intersects(xt)===0)continue;if(!Lt&&At){const Mr=.16666666666666666;Wn.cameraCollisionOpacity=je[0]>$r.min[0]&&je[0]<$r.max[0]&&je[1]>$r.min[1]&&je[1]<$r.max[1]&&je[2]*Ve<$r.max[2]&&Cn.footprint&&i.bA(Rn,Cn.footprint)?Math.max(Wn.cameraCollisionOpacity-Mr,0):Math.min(1,Wn.cameraCollisionOpacity+Mr)}const Ro=[...ci],Yi=Cn.anchor?Cn.anchor[0]:0,qi=Cn.anchor?Cn.anchor[1]:0;i.ab.mat4.translate(Ro,Ro,[Yi*(yi[0]-1),qi*(yi[1]-1),Br]),i.ab.vec3.exactEquals(yi,i.dm)||i.ab.mat4.scale(Ro,Ro,yi);const ro=i.ab.mat4.multiply([],Ro,Cn.matrix),Ki=i.ab.mat4.multiply([],De.expandedFarZProjMatrix,ro),Ei=i.ab.mat4.multiply([],De.expandedFarZProjMatrix,Ro),Gr=i.ab.vec4.transformMat4([],[Yi,qi,Br,1],Ki)[2];Cn.hidden=!1;let ii=It;Lt||(At&&(ii*=Wn.cameraCollisionOpacity,ii*=Od(Ro,De,Wn.aabb,Gt)),ii*=Nu(Ct,Gr)),ii!==0?Fr.push({nodeInfo:Wn,depth:Gr,opacity:ii,wvpForNode:Ki,wvpForTile:Ei,nodeModelMatrix:ro,tileModelMatrix:Ro}):Cn.hidden=!0}Lt||Fr.sort((Wn,Cn)=>!At||Wn.opacity===1&&Cn.opacity===1?Wn.depth<Cn.depth?-1:1:Wn.opacity===1?-1:Cn.opacity===1?1:Wn.depth>Cn.depth?-1:1);for(const Wn of Fr){const Cn=Wn.nodeInfo,Br=Cn.node;let $r=i.ab.mat4.multiply([],Je,Wn.tileModelMatrix);i.ab.mat4.multiply($r,ot,$r);const yi=i.ab.mat4.invert([],$r);i.ab.mat4.transpose(yi,yi),i.ab.mat4.scale(yi,yi,dc),$r=i.ab.mat4.multiply($r,$r,Br.matrix);const Ro=ve.renderPass==="light-beam",Yi=Pe.paint.get("model-color-use-theme").constantOr("default")==="none",qi=xr&i.dp.HasMapboxMeshFeatures,ro=qi?0:Cn.evaluatedRMEA[0][2];for(let Ki=0;Ki<Br.meshes.length;++Ki){const Ei=Br.meshes[Ki],Gr=Ki===Br.lightMeshIndex;let ii=Wn.wvpForNode;if(Gr){if(!Ro&&!ve.terrain&&ve.shadowRenderer){ve.currentLayer<ve.firstLightBeamLayer&&(ve.firstLightBeamLayer=ve.currentLayer);continue}ii=Wn.wvpForTile}else if(Ro)continue;const Mr={defines:[]},Ci=[];if(!Lt&&ze&&(ze.useNormalOffset=!!Ei.normalBuffer),Bu(Mr.defines,Ci,Ei,ve,Yi?null:Pe.lut),qi||Mr.defines.push("DIFFUSE_SHADED"),Yr&&Mr.defines.push("SHADOWS_SINGLE_CASCADE"),on&&(Lt?on.numRenderedVerticesInShadowPass+=Ei.vertexArray.length:on.numRenderedVerticesInTransparentPass+=Ei.vertexArray.length),Lt){ji(Ei,Wn.nodeModelMatrix,ve,Pe);continue}let io=null;if(Oe){const is=Dr(Wn.nodeModelMatrix,ve.transform);if(io=new Float32Array(is),De.projection.name!=="globe"){const os=Ei.aabb.min,_s=Ei.aabb.max,[Mi,Ja]=Oe.getOpacityForBounds(is,os[0],os[1],_s[0],_s[1]);Mr.overrideFog=Mi>=an||Ja>=an}}const ei=Ei.material;let Ho;ei.occlusionTexture&&ei.occlusionTexture.offsetScale&&(Ho=ei.occlusionTexture.offsetScale,Mr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const As=ve.getOrCreateProgram("model",Mr);!Lt&&ze&&ze.setupShadowsFromMatrix(Wn.tileModelMatrix,As,ze.useNormalOffset),ve.uploadCommonUniforms(Fe,As,null,io);const ms=ei.pbrMetallicRoughness;ms.metallicFactor=.9,ms.roughnessFactor=.5;const gs=Oh(new Float32Array(ii),new Float32Array($r),new Float32Array(yi),new Float32Array(Br.matrix),ve,Wn.opacity,ms.baseColorFactor.toRenderColor(null),ei.emissiveFactor,ms.metallicFactor,ms.roughnessFactor,ei,ro,Pe,[0,0,0],Ho);!Gr&&(Cn.hasTranslucentParts||Wn.opacity<1)&&As.draw(ve,Fe.gl.TRIANGLES,kt,Jn.disabled,vr.disabled,Nn.backCCW,gs,Pe.id,Ei.vertexBuffer,Ei.indexBuffer,Ei.segments,Pe.paint,ve.transform.zoom,void 0,Ci),As.draw(ve,Fe.gl.TRIANGLES,Gr?Ht:kt,Jn.disabled,Gr||Wn.opacity<1||Cn.hasTranslucentParts?vr.alphaBlended:vr.unblended,Nn.backCCW,gs,Pe.id,Ei.vertexBuffer,Ei.indexBuffer,Ei.segments,Pe.paint,ve.transform.zoom,void 0,Ci)}}}}()}(h,t,a,p),void O();if(N.type!=="model")return;const $=N.getModels(),W=[],Z=h.transform.getFreeCameraOptions().position,Y=i.ab.vec3.scale([],[Z.x,Z.y,Z.z],h.transform.worldSize);i.ab.vec3.negate(Y,Y);const he=[],ue=[];let me=0;for(const ve of $){const Se=a.paint.get("model-rotation").constantOr(null),Pe=a.paint.get("model-scale").constantOr(null),Me=a.paint.get("model-translation").constantOr(null);ve.computeModelMatrix(h,Se,Pe,Me,!0,!0,!1);const Fe=i.ab.mat4.identity([]),De=i.dj(ve.position.lat,h.transform.zoom),Oe=i.ab.mat4.fromScaling([],[1,1,1/De]);i.ab.mat4.translate(Fe,Fe,Y),W.push({zScaleMatrix:Oe,negCameraPosMatrix:Fe});for(const ze of ve.nodes)Li(h.transform,ze,ve.matrix,h.transform.expandedFarZProjMatrix,me,he,ue);me++}if(he.sort((ve,Se)=>Se.depth-ve.depth),h.renderPass!=="shadow"){if(v===1)for(const ve of ue)Go(ve,h,a,W[ve.modelIndex],Jn.disabled,h.colorModeForRenderPass());else{for(const ve of ue)Go(ve,h,a,W[ve.modelIndex],Jn.disabled,vr.disabled);for(const ve of ue)Go(ve,h,a,W[ve.modelIndex],h.stencilModeFor3D(),h.colorModeForRenderPass());h.resetStencilClippingMasks()}for(const ve of he)Go(ve,h,a,W[ve.modelIndex],Jn.disabled,h.colorModeForRenderPass());O()}else{for(const ve of ue)ji(ve.mesh,ve.nodeModelMatrix,h,a);for(const ve of he)ji(ve.mesh,ve.nodeModelMatrix,h,a);O()}}},Qc={model:function(h,t,a){const p=t.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(a.modelManager&&a.modelManager.upload(a,p.type==="vector"?h.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const v=p.getModels();for(const b of v)b.upload(a.context)},raster:function(h,t,a){const p=t.getSource();if(!(p instanceof ll&&p.loaded()))return;const v=h.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!v)return;const b=h.paint.get("raster-array-band")||p.getInitialBand(v);if(b==null)return;const E=t.getIds().map(k=>t.getTileByID(k));for(const k of E)k.updateNeeded(v,b)&&p.prepareTile(k,v,b)},"raster-particle":function(h,t,a){const p=t.getSource();if(!(p instanceof ll&&p.loaded()))return;const v=h.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!v)return;const b=h.paint.get("raster-particle-array-band")||p.getInitialBand(v);if(b==null)return;const E=t.getIds().map(k=>t.getTileByID(k));for(const k of E)k.updateNeeded(v,b)&&p.prepareTile(k,v,b)}};class qh{constructor(t,a,p,v,b){this.context=new Gs(t,a),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=b,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const O of E)this._debugParams.enabledLayers[O]=!0;b.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),b.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),b.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),b.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),b.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const O of E)b.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],O);this.occlusionParams=new Ao(b),this.setup(),this.numSublayers=Bs.maxUnderzooming+Bs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new hl(this),this._wireframeDebugCache=new da,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const k=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,k,t.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=v}updateTerrain(t,a){const p=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ds(this,t));const v=this._terrain;this.transform.elevation=p?v:null,v.update(t,this.transform,a),this.transform.elevation&&!v.enabled&&(this.transform.elevation=null)}_updateFog(t){const a=t.fog;if(!a||this.transform.projection.name==="globe"||a.getOpacity(this.transform.pitch)<1||a.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,v]=a.getFovAdjustedRange(this.transform._fov);if(p>v)return void(this.transform.fogCullDistSq=null);const b=p+.78*(v-p);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(t){t&&!this._terrain&&(this._terrain=new ds(this,this.style)),this._forceTerrainMode=t}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,a){if(this.width=t*i.q.devicePixelRatio,this.height=a*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const t=this.context,a=new i.b4;a.emplaceBack(0,0),a.emplaceBack(i.ag,0),a.emplaceBack(0,i.ag),a.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=t.createVertexBuffer(a,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const p=new i.b4;p.emplaceBack(0,0),p.emplaceBack(i.ag,0),p.emplaceBack(0,i.ag),p.emplaceBack(i.ag,i.ag),this.debugBuffer=t.createVertexBuffer(p,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const v=new i.b4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(v,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const b=new i.aT;b.emplaceBack(0,0,0,0),b.emplaceBack(i.ag,0,i.ag,0),b.emplaceBack(0,i.ag,0,i.ag),b.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=t.createVertexBuffer(b,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const E=new i.aU;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(E);const k=new i.b5;for(const N of[0,1,3,2,0])k.emplaceBack(N);this.debugIndexBuffer=t.createIndexBuffer(k),this.emptyTexture=new i.T(t,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA8),this.identityMat=i.ab.mat4.create();const O=this.context.gl;this.stencilClearMode=new Jn({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,kn.disabled,this.stencilClearMode,vr.disabled,Nn.disabled,Us(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,a,p){if(!a||this.currentStencilSource===a.id||!t.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let k=!1;for(const O of p)if(this._tileClippingMaskIDs[O.key]===void 0){k=!0;break}if(!k)return}this.currentStencilSource=a.id;const v=this.context,b=v.gl;this.nextStencilID+p.length>256&&this.clearStencil(),v.setColorMode(vr.disabled),v.setDepthMode(kn.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of p){const O=a.getTile(k),N=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:W,tileBoundsSegments:Z}=this.getTileBoundsBuffers(O);E.draw(this,b.TRIANGLES,kn.disabled,new Jn({func:b.ALWAYS,mask:0},N,255,b.KEEP,b.KEEP,b.REPLACE),vr.disabled,Nn.disabled,Us(k.projMatrix),"$clipping",$,W,Z)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new Jn({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const a=this.context.gl;return new Jn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,p=t.sort((E,k)=>k.overscaledZ-E.overscaledZ),v=p[p.length-1].overscaledZ,b=p[0].overscaledZ-v+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const E={};for(let k=0;k<b;k++)E[k+v]=new Jn({func:a.GEQUAL,mask:255},k+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=b,[E,p]}return[{[v]:Jn.disabled},p]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new vr([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?vr.unblended:vr.alphaBlended}colorModeForDrapableLayerRenderPass(t){const a=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new vr([a.ONE,a.ONE_MINUS_SRC_ALPHA,a.CONSTANT_ALPHA,a.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,a,p,v=!1){if(this.depthOcclusion)return new kn(this.context.gl.GREATER,kn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!v)return kn.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new kn(p||this.context.gl.LEQUAL,a,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const t=this.context.gl,a=Math.ceil(this.width),p=Math.ceil(this.height),v=this.context.bindFramebuffer.get(),b=t.getParameter(t.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===a&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),a!==0&&p!==0&&(this.depthFBO=new ts(this.context,a,p,!1,"texture"),this.depthTexture=new i.T(this.context,{width:a,height:p,data:null},t.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(v),t.bindTexture(t.TEXTURE_2D,b),this.depthFBO&&(t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),t.blitFramebuffer(0,0,a,p,0,0,a,p,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((t,a)=>t+a/this._fpsHistory.length,0))}render(t,a){const p=i.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=t.map.repaint,this.style=t,this.options=a;const v=this.style._mergedLayers,b=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(Ve=>{const Je=v[Ve];return!(Je.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Je.type]});let E=!1,k=!1;for(const Ve of b){const Je=v[Ve];Je.type==="circle"&&(E=!0),Je.type==="symbol"&&(Je.hasInitialOcclusionOpacityProperties?k=!0:E=!0)}const O=b.map(Ve=>v[Ve]),N=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let $=0,W=!1;for(const Ve in N){const Je=N[Ve];Je.used&&(Je.prepare(this.context),Je.getSource().usedInConflation&&++$)}let Z=!1;for(const Ve of O)Ve.isHidden(this.transform.zoom)||(Ve.type==="clip"&&(Z=!0),this.prepareLayer(Ve));const Y={},he={},ue={},me={},ve={};for(const Ve in N){const Je=N[Ve];Y[Ve]=Je.getVisibleCoordinates(),he[Ve]=Y[Ve].slice().reverse(),ue[Ve]=Je.getVisibleCoordinates(!0).reverse(),me[Ve]=Je.getShadowCasterCoordinates(),ve[Ve]=Je.sortCoordinatesByDistance(Y[Ve])}const Se=Ve=>{const Je=this.style.getLayerSourceCache(Ve);return Je&&Je.used?Je.getSource():null};if($||Z||this._clippingActiveLastFrame){const Ve=[],Je=[];let It=0;for(const kt of O)this.isSourceForClippingOrConflation(kt,Se(kt))&&(Ve.push(kt),Je.push(It)),It++;if(Z||Ve.length>1||this._clippingActiveLastFrame){Z=!1;const kt=[];for(let Ht=0;Ht<Ve.length;Ht++){const ut=Ve[Ht],Lt=Je[Ht],xt=this.style.getLayerSourceCache(ut);if(!xt||!xt.used||!xt.getSource().usedInConflation&&ut.type!=="clip")continue;let Gt=i.dx,At=i.by.None;const Ct=[];let on=!0;if(ut.type==="clip"){Gt=Lt;for(const Zt of ut.layout.get("clip-layer-types"))At|=Zt==="model"?i.by.Model:Zt==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const Zt of ut.layout.get("clip-layer-scope"))Ct.push(Zt);ut.isHidden(this.transform.zoom)?on=!1:Z=!0}on&&kt.push({layer:ut.fqid,cache:xt,order:Gt,clipMask:At,clipScope:Ct})}this.replacementSource.setSources(kt),W=!0}}this._clippingActiveLastFrame=Z,W||this.replacementSource.clear(),this.conflationActive=W,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Ve=0;Ve<O.length;Ve++){const Je=O[Ve],It=Je.cutoffRange();if(this.longestCutoffRange=Math.max(It,this.longestCutoffRange),It>0){const kt=Se(Je);kt&&(this.minCutoffZoom=Math.max(kt.minzoom,this.minCutoffZoom)),Je.minzoom&&(this.minCutoffZoom=Math.max(Je.minzoom,this.minCutoffZoom))}Je.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Ve),this._lastOcclusionLayer=Ve)}const Pe=this.style&&this.style.fog;Pe?(this._fogVisible=Pe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Pe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ue),this.opaquePassCutoff=0);const Me=this._shadowRenderer;if(Me){Me.updateShadowParameters(this.transform,this.style.directionalLight);for(const Ve in N)for(const Je of Y[Ve]){let It={min:0,max:0};this.terrain&&(It=this.terrain.getMinMaxForTile(Je)||It),Me.addShadowReceiver(Je.toUnwrapped(),It.min,It.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new li(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Fe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),De=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Fe&&!this._snow&&(this._snow=new hc(this)),!Fe&&this._snow&&(this._snow.destroy(),delete this._snow),De&&!this._rain&&(this._rain=new Gh(this)),!De&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Dn.has(this.context.gl))return;this.renderPass="offscreen";for(const Ve of O){const Je=t.getLayerSourceCache(Ve);if(!Ve.hasOffscreenPass()||Ve.isHidden(this.transform.zoom))continue;const It=Je?he[Je.id]:void 0;(Ve.type==="custom"||Ve.type==="raster"||Ve.type==="raster-particle"||Ve.isSky()||It&&It.length)&&this.renderLayer(this,Je,Ve,It)}this.depthRangeFor3D=[0,1-(O.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,me)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Oe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),ze=(()=>{if(a.showOverdrawInspector)return i.aj.black;const Ve=this.style.fog;if(Ve&&this.transform.projection.supportsFog){const Je=this.style.getLut(Ve.scope);if(!Oe){const It=Ve.properties.get("color-use-theme")==="none",kt=Ve.properties.get("color").toRenderColor(It?null:Je).toArray01();return new i.aj(...kt)}if(Oe){const It=Ve.properties.get("space-color-use-theme")==="none",kt=Ve.properties.get("space-color").toRenderColor(It?null:Je).toArray01();return new i.aj(...kt)}}return i.aj.transparent})();if(this.context.clear({color:ze,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Oe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const Ve=O[this.currentLayer],Je=t.getLayerSourceCache(Ve);if(Ve.isSky())continue;const It=Je?(Ve.is3D()?ve:he)[Je.id]:void 0;this._renderTileClippingMasks(Ve,Je,It),this.renderLayer(this,Je,Ve,It)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Oe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const Ve=O[this.currentLayer],Je=t.getLayerSourceCache(Ve);Ve.isSky()&&this.renderLayer(this,Je,Ve,Je?he[Je.id]:void 0)}function Ne(Ve,Je){let It;return Je&&(It=(Ve.type==="symbol"?ue:Ve.is3D()?ve:he)[Je.id]),It}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<b.length;){const Ve=O[this.currentLayer];if(Ve.type==="raster"||Ve.type==="raster-particle"){const Je=t.getLayerSourceCache(Ve);this.renderLayer(this,Je,Ve,Ne(Ve,Je))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let je=0;Me&&(je=Me.getShadowCastingLayerCount());let pt=!1,ot=-1;for(let Ve=0;Ve<b.length;++Ve){const Je=O[Ve];Je.isHidden(this.transform.zoom)||Je.is3D()&&(ot=Ve)}for(k&&ot===-1&&(E=!0);this.currentLayer<b.length;){const Ve=O[this.currentLayer],Je=t.getLayerSourceCache(Ve);if(Ve.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Ve)){if(Ve.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(E&&!pt&&this.terrain&&!this.transform.isOrthographic&&(pt=!0,this.blitDepth()),k&&ot!==-1&&this.currentLayer===ot+1&&!this.transform.isOrthographic&&this.blitDepth(),Ve.is3D()||this.terrain||this._renderTileClippingMasks(Ve,Je,Je?Y[Je.id]:void 0),this.renderLayer(this,Je,Ve,Ne(Ve,Je)),!this.terrain&&Me&&je>0&&Ve.hasShadowPass()&&--je==0&&(Me.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const It=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=It;this.currentLayer++){const kt=O[this.currentLayer];if(!kt.hasLightBeamPass())continue;const Ht=t.getLayerSourceCache(kt);this.renderLayer(this,Ht,kt,Ht?he[Ht.id]:void 0)}this.currentLayer=It,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const It=this.currentLayer;this.depthOcclusion=!0;for(const kt of this.layersWithOcclusionOpacity){this.currentLayer=kt;const Ht=O[this.currentLayer],ut=t.getLayerSourceCache(Ht),Lt=ut?he[ut.id]:void 0;Ht.is3D()||this.terrain||this._renderTileClippingMasks(Ht,ut,ut?Y[ut.id]:void 0),this.renderLayer(this,ut,Ht,Lt)}this.depthOcclusion=!1,this.currentLayer=It,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Ve=null;O.forEach(Je=>{const It=t.getLayerSourceCache(Je);It&&!Je.isHidden(this.transform.zoom)&&It.getVisibleCoordinates().length&&(!Ve||Ve.getSource().maxzoom<It.getSource().maxzoom)&&(Ve=It)}),Ve&&this.options.showTileBoundaries&&pc.debug(this,Ve,Ve.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&pc.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Ve){const Je=Ve.transform.padding;El(Ve,Ve.transform.height-(Je.top||0),3,Ha),El(Ve,Je.bottom||0,3,Sl),Ws(Ve,Je.left||0,3,Tl),Ws(Ve,Ve.transform.width-(Je.right||0),3,lm);const It=Ve.transform.centerPoint;(function(kt,Ht,ut,Lt){Cl(kt,Ht-1,ut-10,2,20,Lt),Cl(kt,Ht-10,ut-1,20,2,Lt)})(Ve,It.x,Ve.transform.height-It.y,jh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),W||(this.conflationActive=!1)}prepareLayer(t){this.gpuTimingStart(t);const{unsupportedLayers:a}=this.transform.projection,p=!a||!a.includes(t.type);if(Qc[t.type]&&(p||this.terrain&&t.type==="custom")){const v=this.style.getLayerSourceCache(t);Qc[t.type](t,v,this)}this.gpuTimingEnd()}renderLayer(t,a,p,v){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||v&&v.length)&&(this.id=p.id,this.gpuTimingStart(p),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(p.type)&&(!t.terrain||p.type!=="custom")||p.type==="clip"||pc[p.type](t,a,p,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery,p=this.context.gl;let v=this.gpuTimers[t.id];v||(v=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:p.createQuery()}),v.calls++,p.beginQuery(a.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,a=this.context.gl,p=a.createQuery();this.deferredRenderGpuTimeQueries.push(p),a.beginQuery(t.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const a={};for(const p in t){const v=t[p],b=this.context.extTimerQuery,E=b.getQueryParameter(v.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(v.query),a[p]=E}return a}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const a=this.context.gl;let p=0;for(const v of t)p+=a.getQueryParameter(v,a.QUERY_RESULT)/1e6,a.deleteQuery(v);return p}translatePosMatrix(t,a,p,v,b){if(!p[0]&&!p[1])return t;const E=b?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(E){const N=Math.sin(E),$=Math.cos(E);p=[p[0]*$-p[1]*N,p[0]*N+p[1]*$]}const k=[b?p[0]:i.ar(a,p[0],this.transform.zoom),b?p[1]:i.ar(a,p[1],this.transform.zoom),0],O=new Float32Array(16);return i.ab.mat4.translate(O,t,k),O}saveTileTexture(t){const a=t.size[0],p=this._tileTextures[a];p?p.push(t):this._tileTextures[a]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,a,p){const v=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,b=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):v||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||b.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||v||a!==void 0&&!a||b.push("FOG","FOG_DITHERING"),v&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(t,a){this.cache=this.cache||{};const p=a&&a.defines||[],v=a&&a.config,b=this.currentGlobalDefines(t,a&&a.overrideFog,a&&a.overrideRtt).concat(p),E=Pd.cacheKey(Sd[t],t,b,v);return this.cache[E]||(this.cache[E]=new Pd(this.context,t,Sd[t],v,zd[t],b)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,a){if(this.style.enable3dLights()){const p=this.style.directionalLight,v=this.style.ambientLight;if(p&&v){const b=((E,k,O)=>{const N=E.properties.get("direction"),$=E.properties.get("color-use-theme")==="none",W=E.properties.get("color").toRenderColor($?null:O.getLut(E.scope)).toArray01(),Z=E.properties.get("intensity"),Y=k.properties.get("color-use-theme")==="none",he=k.properties.get("color").toRenderColor(Y?null:O.getLut(k.scope)).toArray01(),ue=k.properties.get("intensity"),me=[N.x,N.y,N.z],ve=i.cM(he,ue),Se=i.cM(W,Z);return{u_lighting_ambient_color:ve,u_lighting_directional_dir:me,u_lighting_directional_color:Se,u_ground_radiance:nc(me,Se,ve)}})(p,v,this.style);a.setLightsUniformValues(t,b)}}}uploadCommonUniforms(t,a,p,v,b){if(this.uploadCommonLightUniforms(t,a),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const k=E.getOpacity(this.transform.pitch),O=((N,$,W,Z,Y,he,ue,me,ve,Se,Pe,Me)=>{const Fe=N.transform,De=$.properties.get("color-use-theme")==="none",Oe=$.properties.get("color").toRenderColor(De?null:N.style.getLut($.scope)).toArray01();Oe[3]=Z;const ze=N.frameCounter/1e3%1,[Ne,je]=$.properties.get("vertical-range");return{u_fog_matrix:W?Fe.calculateFogTileMatrix(W):Me||N.identityMat,u_fog_range:$.getFovAdjustedRange(Fe._fov),u_fog_color:Oe,u_fog_horizon_blend:$.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ne,je),je],u_fog_temporal_offset:ze,u_frustum_tl:Y,u_frustum_tr:he,u_frustum_br:ue,u_frustum_bl:me,u_globe_pos:ve,u_globe_radius:Se,u_viewport:Pe,u_globe_transition:i.ae(Fe.zoom),u_is_globe:+(Fe.projection.name==="globe")}})(this,E,p,k,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],v);a.setFogUniformValues(t,O)}b&&a.setCutoffUniformValues(t,b.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),a}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,a=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const v of p)a[v.key]=t[v.key]||new ul(v,512,this.transform.tileZoom,this);return a}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(t,a){return!(!t.is3D()||t.type!=="clip"&&(t.minzoom&&t.minzoom>this.transform.zoom||(this.style._clipLayerPresent||t.sourceLayer!=="building")&&(!a||a.type!=="batched-model")))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let a=this._cachedTileFogOpacities[t.key];return a||(this._cachedTileFogOpacities[t.key]=a=this.style.fog.getOpacityForTile(t)),a[0]>=an||a[1]>=an}setupDepthForOcclusion(t,a,p){const v=this.context,b=v.gl,E=!!p;var k;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),v.activeTexture.set(b.TEXTURE3),t&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((k=this.depthRangeFor3D)[1]-k[0]),-1-2*k[0]/(k[1]-k[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),v.activeTexture.set(b.TEXTURE0),E||a.setTerrainUniformValues(v,p)}}function eu(h,t){let a=!1,p=null;const v=()=>{p=null,a&&(h(),p=setTimeout(v,t),a=!1)};return()=>(a=!0,p||v(),p)}class Wh{constructor(t){this._hashName=t&&encodeURIComponent(t),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=eu(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const a=jd(t);if(this._hashName){const p=this._hashName;let v=!1;const b=location.hash.slice(1).split("&").map(E=>{const k=E.split("=")[0];return k===p?(v=!0,`${k}=${a}`):E}).filter(E=>E);return v||b.push(`${p}=${a}`),`#${b.join("&")}`}return`#${a}`}_getCurrentHash(){const t=location.hash.replace("#","");if(this._hashName){let a;return t.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(a=p)}),(a&&a[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const a=this._getCurrentHash();if(a.length>=3&&!a.some(p=>isNaN(p))){const p=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(a[3]||0):t.getBearing();return t.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:p,pitch:+(a[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function jd(h,t){const a=h.getCenter(),p=Math.round(100*h.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,v),E=Math.round(a.lng*b)/b,k=Math.round(a.lat*b)/b,O=h.getBearing(),N=h.getPitch();let $=t?`/${E}/${k}/${p}`:`${p}/${k}/${E}`;return(O||N)&&($+="/"+Math.round(10*O)/10),N&&($+=`/${Math.round(N)}`),$}const $u={linearity:.3,easing:i.dy(0,0,.3,1)},qp=i.l({deceleration:2500,maxSpeed:1400},$u),Hh=i.l({deceleration:20,maxSpeed:1400},$u),Wp=i.l({deceleration:1e3,maxSpeed:360},$u),Hp=i.l({deceleration:1e3,maxSpeed:90},$u);class Zp{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=i.q.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const a={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)a.zoom+=b.zoomDelta||0,a.bearing+=b.bearingDelta||0,a.pitch+=b.pitchDelta||0,b.panDelta&&a.pan._add(b.panDelta),b.around&&(a.around=b.around),b.pinchAround&&(a.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(a.pan.mag()){const b=Vu(a.pan.mag(),p,i.l({},qp,t||{}));v.offset=a.pan.mult(b.amount/a.pan.mag()),v.center=this._map.transform.center,Ud(v,b)}if(a.zoom){const b=Vu(a.zoom,p,Hh);v.zoom=this._map.transform.zoom+b.amount,Ud(v,b)}if(a.bearing){const b=Vu(a.bearing,p,Wp);v.bearing=this._map.transform.bearing+i.aw(b.amount,-179,179),Ud(v,b)}if(a.pitch){const b=Vu(a.pitch,p,Hp);v.pitch=this._map.transform.pitch+b.amount,Ud(v,b)}if(v.zoom||v.bearing){const b=a.pinchAround===void 0?a.around:a.pinchAround;v.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Ud(h,t){(!h.duration||h.duration<t.duration)&&(h.duration=t.duration,h.easing=t.easing)}function Vu(h,t,a){const{maxSpeed:p,linearity:v,deceleration:b}=a,E=i.aw(h*v/(t/1e3),-p,p),k=Math.abs(E)/(b*v);return{easing:a.easing,duration:1e3*k,amount:E*(k/2)}}class Cs extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,p,v={}){const b=$e(a.getCanvasContainer(),p),E=a.unproject(b);super(t,i.l({point:b,lngLat:E,originalEvent:p},v)),this._defaultPrevented=!1,this.target=a}}class $d extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,p){const v=t==="touchend"?p.changedTouches:p.touches,b=Ze(a.getCanvasContainer(),v),E=b.map(O=>a.unproject(O)),k=b.reduce((O,N,$,W)=>O.add(N.div(W.length)),new i.P(0,0));super(t,{points:b,point:k,lngLats:E,lngLat:a.unproject(k),originalEvent:p}),this._defaultPrevented=!1}}class Xp extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a){super("wheel",{originalEvent:a}),this._defaultPrevented=!1}}class Yp{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Xp(this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new Cs(t.type,this._map,t))}mouseup(t){this._map.fire(new Cs(t.type,this._map,t))}preclick(t){const a=i.l({},t);a.type="preclick",this._map.fire(new Cs(a.type,this._map,a))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Cs(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Cs(t.type,this._map,t))}mouseover(t){this._map.fire(new Cs(t.type,this._map,t))}mouseout(t){this._map.fire(new Cs(t.type,this._map,t))}touchstart(t){return this._firePreventable(new $d(t.type,this._map,t))}touchmove(t){this._map.fire(new $d(t.type,this._map,t))}touchend(t){this._map.fire(new $d(t.type,this._map,t))}touchcancel(t){this._map.fire(new $d(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kp{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Cs(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Cs(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zh{constructor(t,a){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(ie(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const p=a,v=this._startPos,b=this._lastPos;if(!v||!b||b.equals(p)||!this._box&&p.dist(v)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=j("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const E=Math.min(v.x,p.x),k=Math.max(v.x,p.x),O=Math.min(v.y,p.y),N=Math.max(v.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${O}px)`,this._box.style.width=k-E+"px",this._box.style.height=N-O+"px")})}mouseupWindow(t,a){if(!this._active)return;const p=this._startPos,v=a;if(p&&t.button===0){if(this.reset(),xe(),p.x!==v.x||p.y!==v.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:t})),{cameraAnimation:b=>b.fitScreenCoordinates(p,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ce(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new i.z(t,{originalEvent:a}))}}function Jp(h,t){const a={};for(let p=0;p<h.length;p++)a[h[p].identifier]=t[p];return a}class Ui{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,a,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){const b=new i.P(0,0);for(const E of v)b._add(E);return b.div(v.length)}(a),this.touches=Jp(p,a)))}touchmove(t,a,p){if(this.aborted||!this.centroid)return;const v=Jp(p,a);for(const b in this.touches){const E=v[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(t,a,p){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Xh{constructor(t){this.singleTap=new Ui(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,a,p){this.singleTap.touchstart(t,a,p)}touchmove(t,a,p){this.singleTap.touchmove(t,a,p)}touchend(t,a,p){const v=this.singleTap.touchend(t,a,p);if(v){const b=t.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(v)<30;if(b&&E||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Ea{constructor(){this._zoomIn=new Xh({numTouches:1,numTaps:2}),this._zoomOut=new Xh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,p){this._zoomIn.touchstart(t,a,p),this._zoomOut.touchstart(t,a,p)}touchmove(t,a,p){this._zoomIn.touchmove(t,a,p),this._zoomOut.touchmove(t,a,p)}touchend(t,a,p){const v=this._zoomIn.touchend(t,a,p),b=this._zoomOut.touchend(t,a,p);return v?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(v)},{originalEvent:t})}):b?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(b)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Qp={0:1,2:2};class Xa{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,a){return!1}_move(t,a){return{}}mousedown(t,a){if(this._lastPoint)return;const p=ae(t);this._correctButton(t,p)&&(this._lastPoint=a,this._eventButton=p)}mousemoveWindow(t,a){const p=this._lastPoint;if(p){if(t.preventDefault(),this._eventButton!=null&&function(v,b){const E=Qp[b];return v.buttons===void 0||(v.buttons&E)!==E}(t,this._eventButton))this.reset();else if(this._moved||!(a.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(p,a)}}mouseupWindow(t){this._lastPoint&&ae(t)===this._eventButton&&(this._moved&&xe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ef extends Xa{mousedown(t,a){super.mousedown(t,a),this._lastPoint&&(this._active=!0)}_correctButton(t,a){return a===0&&!t.ctrlKey}_move(t,a){return{around:a,panDelta:a.sub(t)}}}class Vd extends Xa{_correctButton(t,a){return a===0&&t.ctrlKey||a===2}_move(t,a){const p=.8*(a.x-t.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(t){t.preventDefault()}}class Gu extends Xa{_correctButton(t,a){return a===0&&t.ctrlKey||a===2}_move(t,a){const p=-.5*(a.y-t.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(t){t.preventDefault()}}class Ca{constructor(t,a){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(t,a,p){return this._calculateTransform(t,a,p)}touchmove(t,a,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,a,p)}}touchend(t,a,p){this._calculateTransform(t,a,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,p){p.length>0&&(this._active=!0);const v=Jp(p,a),b=new i.P(0,0),E=new i.P(0,0);let k=0;for(const N in v){const $=v[N],W=this._touches[N];W&&(b._add($),E._add($.sub(W)),k++,v[N]=$)}if(this._touches=v,k<this._minTouches||!E.mag())return;const O=E.div(k);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(k),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Ma{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,a,p){return{}}touchstart(t,a,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,p){const v=this._firstTwoTouches;if(!v)return;t.preventDefault();const[b,E]=v,k=wi(p,a,b),O=wi(p,a,E);if(!k||!O)return;const N=this._aroundCenter?null:k.add(O).div(2);return this._move([k,O],N,t)}touchend(t,a,p){if(!this._firstTwoTouches)return;const[v,b]=this._firstTwoTouches,E=wi(p,a,v),k=wi(p,a,b);E&&k||(this._active&&xe(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function wi(h,t,a){for(let p=0;p<h.length;p++)if(h[p].identifier===a)return t[p]}function Xs(h,t){return Math.log(h/t)/Math.LN2}class tf extends Ma{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const p=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Xs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xs(this._distance,p),pinchAround:a}}}function qu(h,t){return 180*h.angleWith(t)/Math.PI}class nf extends Ma{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a){const p=this._vector;if(this._vector=t[0].sub(t[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:qu(this._vector,p),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const v=qu(t,p);return Math.abs(v)<a}}function Yh(h){return Math.abs(h.y)>Math.abs(h.x)}class Wu extends Ma{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,Yh(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,p){const v=this._lastPoints;if(!v)return;const b=t[0].sub(v[0]),E=t[1].sub(v[1]);return this._map._cooperativeGestures&&!i.dz()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(b,E,p.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(b.y+E.y)/2*-.5})}gestureBeginsVertically(t,a,p){if(this._valid!==void 0)return this._valid;const v=t.mag()>=2,b=a.mag()>=2;if(!v&&!b)return;if(!v||!b)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=t.y>0==a.y>0;return Yh(t)&&Yh(a)&&E}}const cm={panStep:100,bearingStep:15,pitchStep:10};class Tg{constructor(){const t=cm;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,p=0,v=0,b=0,E=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?p=-1:(t.preventDefault(),b=-1);break;case 39:t.shiftKey?p=1:(t.preventDefault(),b=1);break;case 38:t.shiftKey?v=1:(t.preventDefault(),E=-1);break;case 40:t.shiftKey?v=-1:(t.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,v=0),{cameraAnimation:k=>{const O=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:rs,zoom:a?Math.round(O)+a*(t.shiftKey?2:1):O,bearing:k.getBearing()+p*this._bearingStep,pitch:k.getPitch()+v*this._pitchStep,offset:[-b*this._panStep,-E*this._panStep],center:k.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function rs(h){return h*(2-h)}const Oo=4.000244140625,tu=1/450;class nu{constructor(t,a){this._map=t,this._el=t.getCanvasContainer(),this._handler=a,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=tu,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const p=i.q.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,a!==0&&a%Oo==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=a,this._timeout=window.setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(v*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=$e(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:a,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const a=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Oo?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&$!==0&&($=1/$);const W=a(),Z=Math.pow(2,W),Y=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(Y*$))),this._type==="wheel"&&(this._startZoom=W,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:a(),v=this._startZoom,b=this._easing;let E,k=!1;if(this._type==="wheel"&&v&&b){const N=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),$=b(N);E=i.af(v,p,$),N<1?this._frameId||(this._frameId=!0):k=!0}else E=p,k=!0;this._active=!0,k&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let O=E-a();return O*this._lastDelta<0&&(O=0),{noInertia:!0,needsRenderFrame:!k,zoomDelta:O,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=i.dA;if(this._prevEase){const p=this._prevEase,v=(i.q.now()-p.start)/p.duration,b=p.easing(v+.01)-p.easing(v),E=.27/Math.sqrt(b*b+1e-4)*.01,k=Math.sqrt(.0729-E*E);a=i.dy(E,k,.25,1)}return this._prevEase={start:i.q.now(),duration:t,easing:a},a}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Ya{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ha{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,a){return t.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(t.shiftKey?-1:1),around:p.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ml{constructor(){this._tap=new Xh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,a,p){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=a[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(t,a,p))}touchmove(t,a,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const v=a[0],b=v.y-this._swipePoint.y;return this._swipePoint=v,t.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(t,a,p)}touchend(t,a,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(t,a,p)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Il{constructor(t,a,p){this._el=t,this._mousePan=a,this._touchPan=p}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Al{constructor(t,a,p){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class rf{constructor(t,a,p,v){this._el=t,this._touchZoom=a,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Gd=h=>h.zoom||h.drag||h.pitch||h.rotate;class um extends i.z{}class of{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,a){const p=i.ab.vec3.sub([],a,t);this.radius=i.ab.vec3.length(p[2]<0?i.ab.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(t){i.ab.vec3.div(t,t,this.constants),i.ab.vec3.normalize(t,t),i.ab.vec3.mul(t,t,this.constants);const a=i.ab.vec3.scale([],t,this.radius);if(a[2]>0){const p=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(a,[0,0,1])),v=i.ab.vec3.scale([],i.ab.vec3.normalize([],[a[0],a[1],0]),this.radius),b=i.ab.vec3.add([],a,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],v,p),a),2));a[0]=b[0],a[1]=b[1]}return a}}function ru(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class qo{constructor(t,a){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zp(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new of,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(a),i.aP(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,b,E]of this._listeners){const k=v===document?this.handleWindowEvent:this.handleEvent;v.addEventListener(b,k,E)}}destroy(){for(const[t,a,p]of this._listeners){const v=t===document?this.handleWindowEvent:this.handleEvent;t.removeEventListener(a,v,p)}}_addDefaultHandlers(t){const a=this._map,p=a.getCanvasContainer();this._add("mapEvent",new Yp(a,t));const v=a.boxZoom=new Zh(a,t);this._add("boxZoom",v);const b=new Ea,E=new ha;a.doubleClickZoom=new Ya(E,b),this._add("tapZoom",b),this._add("clickZoom",E);const k=new Ml;this._add("tapDragZoom",k);const O=a.touchPitch=new Wu(a);this._add("touchPitch",O);const N=new Vd(t),$=new Gu(t);a.dragRotate=new Al(t,N,$),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const W=new ef(t),Z=new Ca(a,t);a.dragPan=new Il(p,W,Z),this._add("mousePan",W),this._add("touchPan",Z,["touchZoom","touchRotate"]);const Y=new nf,he=new tf;a.touchZoomRotate=new rf(p,he,Y,k),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",he,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Kp(a));const ue=a.scrollZoom=new nu(a,this);this._add("scrollZoom",ue,["mousePan"]);const me=a.keyboard=new Tg;this._add("keyboard",me);for(const ve of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[ve]&&a[ve].enable(t[ve])}_add(t,a,p){this._handlers.push({handlerName:t,handler:a,allowed:p}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,a,p){for(const v in t)if(v!==p&&(!a||a.indexOf(v)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const a=[];for(const p of t)this._el.contains(p.target)&&a.push(p);return a}handleEvent(t,a){this._updatingCamera=!0;const p=t.type==="renderFrame",v=p?void 0:t,b={needsRenderFrame:!1},E={},k={},O=t.touches?this._getMapTouches(t.touches):void 0,N=O?Ze(this._el,O):p?void 0:$e(this._el,t);for(const{handlerName:Z,handler:Y,allowed:he}of this._handlers){if(!Y.isEnabled())continue;let ue;this._blockedByActive(k,he,Z)?Y.reset():Y[a||t.type]&&(ue=Y[a||t.type](t,N,O),this.mergeHandlerResult(b,E,ue,Z,v),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()),(ue||Y.isActive())&&(k[Z]=Y)}const $={};for(const Z in this._previousActiveHandlers)k[Z]||($[Z]=v);this._previousActiveHandlers=k,(Object.keys($).length||ru(b))&&(this._changes.push([b,E,$]),this._triggerRenderFrame()),(Object.keys(k).length||ru(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:W}=b;W&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],W(this._map))}mergeHandlerResult(t,a,p,v,b){if(!p)return;i.l(t,p);const E={handlerName:v,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(a.zoom=E),p.panDelta!==void 0&&(a.drag=E),p.pitchDelta!==void 0&&(a.pitch=E),p.bearingDelta!==void 0&&(a.rotate=E)}_applyChanges(){const t={},a={},p={};for(const[v,b,E]of this._changes)v.panDelta&&(t.panDelta=(t.panDelta||new i.P(0,0))._add(v.panDelta)),v.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(t.around=v.around),v.aroundCoord!==void 0&&(t.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(t.pinchAround=v.pinchAround),v.noInertia&&(t.noInertia=v.noInertia),i.l(a,b),i.l(p,E);this._updateMapTransform(t,a,p),this._changes=[]}_updateMapTransform(t,a,p){const v=this._map,b=v.transform,E=Se=>[Se.x,Se.y,Se.z];if((Se=>{const Pe=this._eventsInProgress.drag;return Pe&&!this._handlersById[Pe.handlerName].isActive()})()&&!ru(t)){const Se=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),Se!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&v._stop(!0),!ru(t))return void this._fireEvents(a,p,!0);let{panDelta:k,zoomDelta:O,bearingDelta:N,pitchDelta:$,around:W,aroundCoord:Z,pinchAround:Y}=t;b._isCameraConstrained&&(O>0&&(O=0),b._isCameraConstrained=!1),Y!==void 0&&(W=Y),(O||(Se=>a[Se]&&!this._eventsInProgress[Se])("drag"))&&W&&(this._dragOrigin=E(b.pointCoordinate3D(W)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",v._stop(!0),W=W||v.transform.centerPoint,N&&(b.bearing+=N),$&&(b.pitch+=$),b._updateCameraState();const he=[0,0,0];if(k)if(b.projection.name==="mercator"){const Se=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(W).dir),Pe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(W.sub(k)).dir);he[0]=Pe[0]-Se[0],he[1]=Pe[1]-Se[1]}else{const Se=b.pointCoordinate(W);if(b.projection.name==="globe"){k=k.rotate(-b.angle);const Pe=b._pixelsPerMercatorPixel/b.worldSize;he[0]=-k.x*i.dB(i.aS(Se.y))*Pe,he[1]=-k.y*i.dB(b.center.lat)*Pe}else{const Pe=b.pointCoordinate(W.sub(k));Se&&Pe&&(he[0]=Pe.x-Se.x,he[1]=Pe.y-Se.y)}}const ue=b.zoom,me=[0,0,0];if(O){const Se=E(Z||b.pointCoordinate3D(W)),Pe={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Se,b._camera.position))};if(Pe.dir[2]<0){const Me=b.zoomDeltaToMovement(Se,O);i.ab.vec3.scale(me,Pe.dir,Me)}}const ve=i.ab.vec3.add(he,he,me);b._translateCameraConstrained(ve),O&&Math.abs(b.zoom-ue)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,p,!0)}_fireEvents(t,a,p){const v=Gd(this._eventsInProgress),b=Gd(t),E={};for(const $ in t){const{originalEvent:W}=t[$];this._eventsInProgress[$]||(E[`${$}start`]=W),this._eventsInProgress[$]=t[$]}!v&&b&&this._fireEvent("movestart",b.originalEvent);for(const $ in E)this._fireEvent($,E[$]);b&&this._fireEvent("move",b.originalEvent);for(const $ in t){const{originalEvent:W}=t[$];this._fireEvent($,W)}const k={};let O;for(const $ in this._eventsInProgress){const{handlerName:W,originalEvent:Z}=this._eventsInProgress[$];this._handlersById[W].isActive()||(delete this._eventsInProgress[$],O=a[W]||Z,k[`${$}end`]=O)}for(const $ in k)this._fireEvent($,k[$]);const N=Gd(this._eventsInProgress);if(p&&(v||b)&&!N){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=Z=>Z!==0&&-this._bearingSnap<Z&&Z<this._bearingSnap;$?(W($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:O})):(this._map.fire(new i.z("moveend",{originalEvent:O})),W(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new i.z(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new um("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Hu="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class qd extends i.E{constructor(t,a){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this._respectPrefersReducedMotion=a.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,p){return t=i.P.convert(t).mult(-1),this.panTo(this.transform.center,i.l({offset:t},a),p)}panTo(t,a,p){return this.easeTo(i.l({center:t},a),p)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,p){return this.easeTo(i.l({zoom:t},a),p)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,p){return this.easeTo(i.l({bearing:t},a),p)}resetNorth(t,a){return this.rotateTo(0,i.l({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=i.az.convert(t);const p=a&&a.bearing||0,v=a&&a.pitch||0,b=t.getNorthWest(),E=t.getSouthEast();return this._cameraForBounds(this.transform,b,E,p,v,a)}_extendPadding(t){const a={top:0,right:0,bottom:0,left:0};return t==null?i.l({},a,this.transform.padding):typeof t=="number"?{top:t,bottom:t,right:t,left:t}:i.l({},a,t)}_extendCameraOptions(t){return(t=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=this._extendPadding(t.padding),t}_minimumAABBFrustumDistance(t,a){const p=a.max[0]-a.min[0],v=a.max[1]-a.min[1];return p/v>t.aspect?p/(2*Math.tan(.5*t.fovX)*t.aspect):v/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,a,p,v,b,E){const k=t.clone(),O=this._extendCameraOptions(E);k.bearing=v,k.pitch=b;const N=i.bO.convert(a),$=i.bO.convert(p),W=.5*(N.lat+$.lat),Z=.5*(N.lng+$.lng),Y=i.dC(W,Z),he=i.ab.vec3.normalize([],Y),ue=i.ab.vec3.normalize([],i.ab.vec3.cross([],he,[0,1,0])),me=i.ab.vec3.cross([],ue,he),ve=[ue[0],ue[1],ue[2],0,me[0],me[1],me[2],0,he[0],he[1],he[2],0,0,0,0,1],Se=[Y,i.dC(N.lat,N.lng),i.dC($.lat,N.lng),i.dC($.lat,$.lng),i.dC(N.lat,$.lng),i.dC(W,N.lng),i.dC(W,$.lng),i.dC(N.lat,Z),i.dC($.lat,Z)];let Pe=i.cd.fromPoints(Se.map(xt=>[i.ab.vec3.dot(ue,xt),i.ab.vec3.dot(me,xt),i.ab.vec3.dot(he,xt)]));const Me=i.ab.vec3.transformMat4([],Pe.center,ve);i.ab.vec3.squaredLength(Me)===0&&i.ab.vec3.set(Me,0,0,1),i.ab.vec3.normalize(Me,Me),i.ab.vec3.scale(Me,Me,i.ax),k.center=i.dD(Me);const Fe=k.getWorldToCameraMatrix(),De=i.ab.mat4.invert(new Float64Array(16),Fe);Pe=i.cd.applyTransform(Pe,i.ab.mat4.multiply([],Fe,ve));const Oe=this._extendAABB(Pe,k,O,v);if(!Oe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Pe=Oe,i.ab.vec3.transformMat4(Me,Me,Fe);const ze=.5*(Pe.max[2]-Pe.min[2]),Ne=this._minimumAABBFrustumDistance(k,Pe),je=i.ab.vec3.scale([],[0,0,1],ze),pt=i.ab.vec3.add(je,Me,je),ot=Ne+(k.pitch===0?0:i.ab.vec3.distance(Me,pt)),Ve=k.globeCenterInViewSpace,Je=i.ab.vec3.sub([],Me,[Ve[0],Ve[1],Ve[2]]);i.ab.vec3.normalize(Je,Je),i.ab.vec3.scale(Je,Je,ot);const It=i.ab.vec3.add([],Me,Je);i.ab.vec3.transformMat4(It,It,De);const kt=i.ds/i.ax,Ht=i.ab.vec3.length(It),ut=i.bH(Math.max(Ht*kt-i.ds,Number.EPSILON),0),Lt=Math.min(k.zoomFromMercatorZAdjusted(ut),O.maxZoom);return Lt>.5*(i.c6+i.bY)?(k.setProjection({name:"mercator"}),k.zoom=Lt,this._cameraForBounds(k,a,p,v,b,E)):{center:k.center,zoom:Lt,bearing:v,pitch:b}}_extendAABB(t,a,p,v){const b=.5*((p.padding.left||0)+(p.padding.right||0)),E=.5*((p.padding.top||0)+(p.padding.bottom||0)),k=E,O=b,N=b,$=E,W=a.width-(O+N),Z=a.height-(k+$),Y=i.ab.vec3.sub([],t.max,t.min),he=Math.min(W/Y[0],Z/Y[1]),ue=Math.min(a.scaleZoom(a.scale*he),p.maxZoom);if(isNaN(ue))return null;const me=a.scale/a.zoomScale(ue),ve=new i.cd([t.min[0]-O*me,t.min[1]-$*me,t.min[2]],[t.max[0]+N*me,t.max[1]+k*me,t.max[2]]),Se=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new i.P(p.offset.x,p.offset.y):i.P.convert(p.offset)).rotate(-i.ai(v));return ve.center[0]-=Se.x*me,ve.center[1]+=Se.y*me,ve}queryTerrainElevation(t,a){const p=this.transform.elevation;return p?(a=i.l({},{exaggerated:!0},a),p.getAtPoint(i.aa.fromLngLat(t),null,a.exaggerated)):null}_cameraForBounds(t,a,p,v,b,E){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,a,p,v,b,E);const k=t.clone(),O=this._extendCameraOptions(E);k.bearing=v,k.pitch=b;const N=i.bO.convert(a),$=i.bO.convert(p),W=new i.bO(N.lng,$.lat),Z=new i.bO($.lng,N.lat),Y=k.project(N),he=k.project($),ue=this.queryTerrainElevation(N),me=this.queryTerrainElevation($),ve=this.queryTerrainElevation(W),Se=this.queryTerrainElevation(Z),Pe=[[Y.x,Y.y,Math.min(ue||0,me||0,ve||0,Se||0)],[he.x,he.y,Math.max(ue||0,me||0,ve||0,Se||0)]];let Me=i.cd.fromPoints(Pe);const Fe=k.getWorldToCameraMatrix(),De=i.ab.mat4.invert(new Float64Array(16),Fe);Me=i.cd.applyTransform(Me,Fe);const Oe=this._extendAABB(Me,k,O,v);if(!Oe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Me=Oe;const ze=.5*i.ab.vec3.sub([],Me.max,Me.min)[2],Ne=this._minimumAABBFrustumDistance(k,Me),je=[0,0,1,0];i.ab.vec4.transformMat4(je,je,Fe),i.ab.vec4.normalize(je,je);const pt=i.ab.vec3.scale([],je,Ne+ze),ot=i.ab.vec3.add([],Me.center,pt);i.ab.vec3.transformMat4(Me.center,Me.center,De),i.ab.vec3.transformMat4(ot,ot,De);const Ve=k.unproject(new i.P(Me.center[0],Me.center[1])),Je=i.dE(k.projection,Ve),It=Math.pow(2,Je),kt=Math.min(k._zoomFromMercatorZ(ot[2]*k.pixelsPerMeter*It/k.worldSize),O.maxZoom);return k.mercatorFromTransition&&kt<.5*(i.c6+i.bY)?(k.setProjection({name:"globe"}),k.zoom=kt,this._cameraForBounds(k,a,p,v,b,E)):{center:Ve,zoom:kt,bearing:v,pitch:b}}fitBounds(t,a,p){const v=this.cameraForBounds(t,a);return this._fitInternal(v,a,p)}fitScreenCoordinates(t,a,p,v,b){const E=i.P.convert(t),k=i.P.convert(a),O=new i.P(Math.min(E.x,k.x),Math.min(E.y,k.y)),N=new i.P(Math.max(E.x,k.x),Math.max(E.y,k.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,k))return this;const $=this.transform.pointLocation3D(O),W=this.transform.pointLocation3D(N),Z=this.transform.pointLocation3D(new i.P(O.x,N.y)),Y=this.transform.pointLocation3D(new i.P(N.x,O.y)),he=[Math.min($.lng,W.lng,Z.lng,Y.lng),Math.min($.lat,W.lat,Z.lat,Y.lat)],ue=[Math.max($.lng,W.lng,Z.lng,Y.lng),Math.max($.lat,W.lat,Z.lat,Y.lat)],me=v&&v.pitch?v.pitch:this.getPitch(),ve=this._cameraForBounds(this.transform,he,ue,p,me,v);return this._fitInternal(ve,v,b)}_fitInternal(t,a,p){return t?(a=i.l(t,a)).linear?this.easeTo(a,p):this.flyTo(a,p):this}jumpTo(t,a){this.stop();const p=t.preloadOnly?this.transform.clone():this.transform;let v=!1,b=!1,E=!1;"zoom"in t&&p.zoom!==+t.zoom&&(v=!0,p.zoom=+t.zoom),t.center!==void 0&&(p.center=i.bO.convert(t.center)),"bearing"in t&&p.bearing!==+t.bearing&&(b=!0,p.bearing=+t.bearing),"pitch"in t&&p.pitch!==+t.pitch&&(E=!0,p.pitch=+t.pitch);const k=typeof t.padding=="number"?this._extendPadding(t.padding):t.padding;if(t.padding!=null&&!p.isPaddingEqual(k))if(t.retainPadding===!1){const O=p.clone();O.padding=k,p.setLocationAtPoint(p.center,O.centerPoint)}else p.padding=k;return t.preloadOnly?(this._preloadTiles(p),this):(this.fire(new i.z("movestart",a)).fire(new i.z("move",a)),v&&this.fire(new i.z("zoomstart",a)).fire(new i.z("zoom",a)).fire(new i.z("zoomend",a)),b&&this.fire(new i.z("rotatestart",a)).fire(new i.z("rotate",a)).fire(new i.z("rotateend",a)),E&&this.fire(new i.z("pitchstart",a)).fire(new i.z("pitch",a)).fire(new i.z("pitchend",a)),this.fire(new i.z("moveend",a)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Hu),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,a){const p=this.transform;if(!p.projection.supportsFreeCamera)return i.w(Hu),this;this.stop();const v=p.zoom,b=p.pitch,E=p.bearing;p.setFreeCameraOptions(t);const k=v!==p.zoom,O=b!==p.pitch,N=E!==p.bearing;return this.fire(new i.z("movestart",a)).fire(new i.z("move",a)),k&&this.fire(new i.z("zoomstart",a)).fire(new i.z("zoom",a)).fire(new i.z("zoomend",a)),N&&this.fire(new i.z("rotatestart",a)).fire(new i.z("rotate",a)).fire(new i.z("rotateend",a)),O&&this.fire(new i.z("pitchstart",a)).fire(new i.z("pitch",a)).fire(new i.z("pitchend",a)),this.fire(new i.z("moveend",a)),this}easeTo(t,a){this._stop(!1,t.easeId),((t=i.l({offset:[0,0],duration:500,easing:i.dA},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const p=this.transform,v=this.getZoom(),b=this.getBearing(),E=this.getPitch(),k=this.getPadding(),O="zoom"in t?+t.zoom:v,N="bearing"in t?this._normalizeBearing(t.bearing,b):b,$="pitch"in t?+t.pitch:E,W=this._extendPadding(t.padding),Z=i.P.convert(t.offset);let Y,he,ue;if(p.projection.name==="globe"){const je=i.aa.fromLngLat(p.center),pt=Z.rotate(-p.angle);je.x+=pt.x/p.worldSize,je.y+=pt.y/p.worldSize;const ot=je.toLngLat(),Ve=i.bO.convert(t.center||ot);this._normalizeCenter(Ve),Y=p.centerPoint.add(pt),he=new i.P(je.x,je.y).mult(p.worldSize),ue=new i.P(i.at(Ve.lng),i.aA(Ve.lat)).mult(p.worldSize).sub(he)}else{Y=p.centerPoint.add(Z);const je=p.pointLocation(Y),pt=i.bO.convert(t.center||je);this._normalizeCenter(pt),he=p.project(je),ue=p.project(pt).sub(he)}const me=p.zoomScale(O-v);let ve,Se;t.around&&(ve=i.bO.convert(t.around),Se=p.locationPoint(ve));const Pe=this._zooming||O!==v,Me=this._rotating||b!==N,Fe=this._pitching||$!==E,De=!p.isPaddingEqual(W),Oe=t.retainPadding===!1?p.clone():p,ze=je=>pt=>{if(Pe&&(je.zoom=i.af(v,O,pt)),Me&&(je.bearing=i.af(b,N,pt)),Fe&&(je.pitch=i.af(E,$,pt)),De&&(Oe.interpolatePadding(k,W,pt),Y=Oe.centerPoint.add(Z)),ve)je.setLocationAtPoint(ve,Se);else{const ot=je.zoomScale(je.zoom-v),Ve=O>v?Math.min(2,me):Math.max(.5,me),Je=Math.pow(Ve,1-pt),It=je.unproject(he.add(ue.mult(pt*Je)).mult(ot));je.setLocationAtPoint(je.renderWorldCopies?It.wrap():It,Y)}return t.preloadOnly||this._fireMoveEvents(a),je};if(t.preloadOnly){const je=this._emulate(ze,t.duration,p);return this._preloadTiles(je),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Pe,this._rotating=Me,this._pitching=Fe,this._padding=De,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,Ne),this._ease(ze(p),je=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(a,je)},t),this}_prepareEase(t,a,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),a||p.moving||this.fire(new i.z("movestart",t)),this._zooming&&!p.zooming&&this.fire(new i.z("zoomstart",t)),this._rotating&&!p.rotating&&this.fire(new i.z("rotatestart",t)),this._pitching&&!p.pitching&&this.fire(new i.z("pitchstart",t))}_fireMoveEvents(t){this.fire(new i.z("move",t)),this._zooming&&this.fire(new i.z("zoom",t)),this._rotating&&this.fire(new i.z("rotate",t)),this._pitching&&this.fire(new i.z("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,v=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new i.z("zoomend",t)),v&&this.fire(new i.z("rotateend",t)),b&&this.fire(new i.z("pitchend",t)),this.fire(new i.z("moveend",t))}flyTo(t,a){if(this._prefersReducedMotion(t)){const xt=i.ay(t,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(xt,a)}this.stop(),t=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},t);const p=this.transform,v=this.getZoom(),b=this.getBearing(),E=this.getPitch(),k=this.getPadding(),O="zoom"in t?i.aw(+t.zoom,p.minZoom,p.maxZoom):v,N="bearing"in t?this._normalizeBearing(t.bearing,b):b,$="pitch"in t?+t.pitch:E,W=this._extendPadding(t.padding),Z=p.zoomScale(O-v),Y=i.P.convert(t.offset);let he=p.centerPoint.add(Y);const ue=p.pointLocation(he),me=i.bO.convert(t.center||ue);this._normalizeCenter(me);const ve=p.project(ue),Se=p.project(me).sub(ve);let Pe=t.curve;const Me=Math.max(p.width,p.height),Fe=Me/Z,De=Se.mag();if("minZoom"in t){const xt=i.aw(Math.min(t.minZoom,v,O),p.minZoom,p.maxZoom),Gt=Me/p.zoomScale(xt-v);Pe=Math.sqrt(Gt/De*2)}const Oe=Pe*Pe;function ze(xt){const Gt=(Fe*Fe-Me*Me+(xt?-1:1)*Oe*Oe*De*De)/(2*(xt?Fe:Me)*Oe*De);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function Ne(xt){return(Math.exp(xt)-Math.exp(-xt))/2}function je(xt){return(Math.exp(xt)+Math.exp(-xt))/2}const pt=ze(0);let ot=function(xt){return je(pt)/je(pt+Pe*xt)},Ve=function(xt){return Me*((je(pt)*(Ne(Gt=pt+Pe*xt)/je(Gt))-Ne(pt))/Oe)/De;var Gt},Je=(ze(1)-pt)/Pe;if(Math.abs(De)<1e-6||!isFinite(Je)){if(Math.abs(Me-Fe)<1e-6)return this.easeTo(t,a);const xt=Fe<Me?-1:1;Je=Math.abs(Math.log(Fe/Me))/Pe,Ve=function(){return 0},ot=function(Gt){return Math.exp(xt*Pe*Gt)}}t.duration="duration"in t?+t.duration:1e3*Je/("screenSpeed"in t?+t.screenSpeed/Pe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const It=b!==N,kt=$!==E,Ht=!p.isPaddingEqual(W),ut=t.retainPadding===!1?p.clone():p,Lt=xt=>Gt=>{const At=Gt*Je,Ct=1/ot(At);xt.zoom=Gt===1?O:v+xt.scaleZoom(Ct),It&&(xt.bearing=i.af(b,N,Gt)),kt&&(xt.pitch=i.af(E,$,Gt)),Ht&&(ut.interpolatePadding(k,W,Gt),he=ut.centerPoint.add(Y));const on=Gt===1?me:xt.unproject(ve.add(Se.mult(Ve(At))).mult(Ct));return xt.setLocationAtPoint(xt.renderWorldCopies?on.wrap():on,he),xt._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(a),xt};if(t.preloadOnly){const xt=this._emulate(Lt,t.duration,p);return this._preloadTiles(xt),this}return this._zooming=!0,this._rotating=It,this._pitching=kt,this._padding=Ht,this._prepareEase(a,!1),this._ease(Lt(p),()=>this._afterEase(a),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(t){}_cancelRenderFrame(t){}_stop(t,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,a)}if(!t){const p=this.handlers;p&&p.stop(!1)}return this}_ease(t,a,p){p.animate===!1||p.duration===0?(t(1),a()):(this._easeStart=i.q.now(),this._easeOptions=p,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),a=this._onEaseFrame;a&&a(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,a){t=i.bF(t,-180,180);const p=Math.abs(t-a);return Math.abs(t-360-a)<p&&(t-=360),Math.abs(t+360-a)<p&&(t+=360),t}_normalizeCenter(t){const a=this.transform;if(a.maxBounds||a.projection.name!=="globe"&&!a.renderWorldCopies)return;const p=t.lng-a.center.lng;t.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,a,p){const v=Math.ceil(15*a/1e3),b=[],E=t(p.clone());for(let k=0;k<=v;k++){const O=E(k/v);b.push(O.clone())}return b}_preloadTiles(t,a){}}class dm{constructor(t={}){this.options=t,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const a=this.options&&this.options.compact,p=t._getUIString("AttributionControl.ToggleAttribution");this._map=t,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=j("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const v=j("span","mapboxgl-ctrl-icon",this._compactButton);return v.setAttribute("aria-hidden","true"),v.setAttribute("title",p),this._innerContainer=j("div","mapboxgl-ctrl-attrib-inner",this._container),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(t){const p=a.reduce((v,b,E)=>(b.value&&(v+=`${b.key}=${b.value}${E<a.length-1?"&":""}`),v),"?");t.href=`${i.e.FEEDBACK_URL}/${p}#${jd(this._map,!0)}`,t.rel="noopener nofollow"}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const a=this._map.style._mergedSourceCaches;for(const v in a){const b=a[v];if(b.used){const E=b.getSource();E.attribution&&t.indexOf(E.attribution)<0&&t.push(E.attribution)}}t.sort((v,b)=>v.length-b.length),t=t.filter((v,b)=>{for(let E=b+1;E<t.length;E++)if(t[E].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const p=t.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,t.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class fc{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=j("div","mapboxgl-ctrl");const a=j("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const a in t){const p=t[a].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const a=t[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}}}class Zu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,p=a?this._queue.concat(a):this._queue;for(const v of p)if(v.id===t)return void(v.cancelled=!0)}run(t=0){const a=this._currentlyRunning=this._queue;this._queue=[];for(const p of a)if(!p.cancelled&&(p.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Ys{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const a=i.cB((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-a)+this._end*a}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,a,p){this._start=this.getValue(a),this._end=t,this._startTime=a,this._endTime=a+p}}const fs={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Ms=["mouseenter","mouseover","mouseleave","mouseout"];class mc extends i.z{constructor(t,a,p,v){const{point:b,lngLat:E,originalEvent:k,target:O}=t;super(t.type,{point:b,lngLat:E,originalEvent:k,target:O}),this.preventDefault=()=>{t.preventDefault()},this.id=a,this.interaction=p,this.feature=v}}class iu{constructor(t){this.map=t,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.delegatedHandlers=new Map,this.handleType=this.handleType.bind(this)}add(t,a){if(this.typeById.has(t))throw new Error(`Interaction id "${t}" already exists.`);const{type:p,filter:v}=a;v&&this.filters.set(t,i.aZ(v));const b=this.interactionsByType.get(p)||new Map;if(b.size===0){if(Ms.includes(p)){const{mousemove:E,mouseout:k}=this._createDelegatedHandlers(t,a);this.map.on("mousemove",E),this.map.on("mouseout",k),this.delegatedHandlers.set(t,{mousemove:E,mouseout:k})}else this.map.on(p,this.handleType);this.interactionsByType.set(p,b)}b.set(t,a),this.typeById.set(t,p)}get(t){const a=this.typeById.get(t);if(!a)return;const p=this.interactionsByType.get(a);return p?p.get(t):void 0}remove(t){const a=this.typeById.get(t);if(!a)return;this.typeById.delete(t),this.filters.delete(t);const p=this.interactionsByType.get(a);if(p){if(p.delete(t),this.delegatedHandlers.has(t)){const{mousemove:v,mouseout:b}=this.delegatedHandlers.get(t);this.map.off("mousemove",v),this.map.off("mouseout",b),this.delegatedHandlers.delete(t)}p.size===0&&this.map.off(a,this.handleType)}}queryTargets(t,a){const p=[];for(const[v,b]of a)b.target&&p.push({targetId:v,target:b.target,filter:this.filters.get(v)});return this.map.style.queryRenderedTargets(t,p,this.map.transform)}handleType(t,a){const p=this.interactionsByType.get(t.type),v=Array.from(p).reverse();a=a||this.queryTargets(t.point,v);let b=!1;for(const E of a){for(const[k,O]of v){if(!O.target)continue;const N=E.variants?E.variants[k]:null;if(N){for(const $ of N){const W=new i.cw(E,$);if(O.handler(new mc(t,k,O,W))!==!1){b=!0;break}}if(b)break}}if(b)break}if(!b)for(const[E,k]of v){const{handler:O,target:N}=k;if(!N&&O(new mc(t,E,k,null))!==!1)break}}_createDelegatedHandlers(t,a){switch(a.type){case"mouseenter":case"mouseover":{let p=!1,v=new Set;return{mousemove:b=>{const E=this.queryTargets(b.point,[[t,a]]),k=new Set;if(!E.length)return p=!1,void v.clear();const O=[];for(const N of E)v.has(N.id)||(k.add(N.id),O.push(N));p&&!O.length||(p=!0,v=k,b.type=a.type,this.handleType(b,O))},mouseout:()=>{p=!1,v.clear()}}}case"mouseleave":case"mouseout":{let p=[];return{mousemove:v=>{const b=this.queryTargets(v.point,[[t,a]]);if(!b.length)return v.type=a.type,this.handleType(v,p),void(p=b);const E=[],k=new Set(b.map(O=>O.id));for(const O of p)k.has(O.id)||E.push(O);E.length&&(v.type=a.type,this.handleType(v,E)),p=b},mouseout:v=>{p.length&&(v.type=a.type,this.handleType(v,p),p=[])}}}}}}function Wd(h,t){if(Array.isArray(h)&&Array.isArray(t)){const a=new Set(h),p=new Set(t);return a.size===p.size&&h.every(v=>p.has(v))}return i.bn(h,t)}const Or={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Pl={showCompass:!0,showZoom:!0,visualizePitch:!1};class Hd{constructor(t,a,p=!1){this._clickTolerance=10,this.element=a,this.mouseRotate=new Vd({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,p&&(this.mousePitch=new Gu({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),a.addEventListener("mousedown",this.mousedown),a.addEventListener("touchstart",this.touchstart,{passive:!1}),a.addEventListener("touchmove",this.touchmove),a.addEventListener("touchend",this.touchend),a.addEventListener("touchcancel",this.reset)}down(t,a){this.mouseRotate.mousedown(t,a),this.mousePitch&&this.mousePitch.mousedown(t,a),ie()}move(t,a){const p=this.map,v=this.mouseRotate.mousemoveWindow(t,a),b=v&&v.bearingDelta;if(b&&p.setBearing(p.getBearing()+b),this.mousePitch){const E=this.mousePitch.mousemoveWindow(t,a),k=E&&E.pitchDelta;k&&p.setPitch(p.getPitch()+k)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ce(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(i.l({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),$e(this.element,t)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,$e(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ze(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=Ze(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Wo(h,t,a){if(h=new i.bO(h.lng,h.lat),t){const p=new i.bO(h.lng-360,h.lat),v=new i.bO(h.lng+360,h.lat),b=360*Math.ceil(Math.abs(h.lng-a.center.lng)/360),E=a.locationPoint(h).distSqr(t),k=t.x<0||t.y<0||t.x>a.width||t.y>a.height;a.locationPoint(p).distSqr(t)<E&&(k||Math.abs(p.lng-a.center.lng)<b)?h=p:a.locationPoint(v).distSqr(t)<E&&(k||Math.abs(v.lng-a.center.lng)<b)&&(h=v)}for(;Math.abs(h.lng-a.center.lng)>180;){const p=a.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=a.width&&p.y<=a.height)break;h.lng>a.center.lng?h.lng-=360:h.lng+=360}return h}const Zd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ka extends i.E{constructor(t,a){if(super(),(t instanceof HTMLElement||a)&&(t=i.l({element:t},a)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=i.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=j("div");const b=41,E=27,k=ne("svg",{display:"block",height:b*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${b}`},this._element),O=ne("radialGradient",{id:"shadowGradient"},ne("defs",{},k));ne("stop",{offset:"10%","stop-opacity":.4},O),ne("stop",{offset:"100%","stop-opacity":.05},O),ne("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},k),ne("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},k),ne("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},k),ne("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},k),this._offset=i.P.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const p=this._element.classList;for(const b in Zd)p.remove(`mapboxgl-marker-anchor-${b}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const v=t&&t.className?t.className.trim().split(/\s+/):[];p.add(...v),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=i.bO.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const a=t.code,p=t.charCode||t.keyCode;a!=="Space"&&a!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(t){const a=t.originalEvent.target,p=this._element;this._popup&&(a===p||p.contains(a))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,a=this._pos;if(!t||!a)return!1;const p=t.unproject(a),v=t.getFreeCameraOptions();if(!v.position)return!1;const b=v.position.toLngLat();return b.distanceTo(p)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const a=this._pos;if(!a||a.x<0||a.x>t.transform.width||a.y<0||a.y>t.transform.height)return void this._clearFadeTimer();const p=t.unproject(a);let v;t._showingGlobe()&&i.dH(t.transform,this._lngLat)?v=0:(v=1-t._queryFogOpacity(p),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const a=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${Zd[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${a.x}px,${a.y}px)
        `}_calculateXYTransform(){const t=this._pos,a=this._map,p=this.getPitchAlignment();if(!a||!t||p!=="map")return"";if(!a._showingGlobe()){const O=a.getPitch();return O?`rotateX(${O}deg)`:""}const v=i.c4(i.dI(a.transform,this._lngLat)),b=t.sub(i.dJ(a.transform)),E=Math.abs(b.x)+Math.abs(b.y);if(E===0)return"";const k=v/E;return`rotateX(${-b.y*k}deg) rotateY(${b.x*k}deg)`}_calculateZTransform(){const t=this._pos,a=this._map;if(!a||!t)return"";let p=0;const v=this.getRotationAlignment();if(v==="map")if(a._showingGlobe()){const b=a.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),E=a.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);p=i.c4(Math.atan2(E.y,E.x))-90}else p=-a.getBearing();else if(v==="horizon"){const b=i.ac(4,6,a.getZoom()),E=i.dJ(a.transform);E.y+=b*a.transform.height;const k=t.sub(E),O=i.c4(Math.atan2(k.y,k.x));p=(O>90?O-270:O+90)*(1-b)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(t){cancelAnimationFrame(this._updateFrameId);const a=this._map;a&&(a.transform.renderWorldCopies&&(this._lngLat=Wo(this._lngLat,this._pos,a.transform)),this._pos=a.project(this._lngLat),t===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),a._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(a._showingGlobe()||a.getTerrain()||a.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=i.P.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const a=this._map;if(!a)return;const p=this._pointerdownPos,v=this._positionDelta;if(p&&v){if(!this._isDragging){const b=this._clickTolerance||a._clickTolerance;if(t.point.dist(p)<b)return;this._isDragging=!0}this._pos=t.point.sub(v),this._lngLat=a.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(t){const a=this._map,p=this._pos;a&&p&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(p),this._pointerdownPos=t.point,this._state="pending",a.on("mousemove",this._onMove),a.on("touchmove",this._onMove),a.once("mouseup",this._onUp),a.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const a=this._map;return a&&(t?(a.on("mousedown",this._addDragHandler),a.on("touchstart",this._addDragHandler)):(a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const pa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},vi={maxWidth:100,unit:"metric"},Is={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ln={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ou=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Fo(h=new i.P(0,0),t="bottom"){if(typeof h=="number"){const a=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(t){case"top":return new i.P(0,h);case"top-left":return new i.P(a,a);case"top-right":return new i.P(-a,a);case"bottom":return new i.P(0,-h);case"bottom-left":return new i.P(a,-a);case"bottom-right":return new i.P(-a,-a);case"left":return new i.P(h,0);case"right":return new i.P(-h,0)}return new i.P(0,0)}return h instanceof i.P||Array.isArray(h)?i.P.convert(h):i.P.convert(h[t]||[0,0])}return{version:I,supported:H.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends qd{constructor(h){B.mark(F.create);const t=h;if((h=i.l({},Or,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&i.dF(window)&&(h.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new _h(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._repaint=!!h.repaint,this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new Zu,this._domRenderTaskQueue=new Zu,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},fs,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._tessellationStep=h.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=h.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ys(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=h.scaleFactor,this._requestManager=new st(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,this._contextCreateOptions=h.contextCreateOptions?{...h.contextCreateOptions}:{},typeof h.container=="string"){const a=document.getElementById(h.container);if(!a)throw new Error(`Container '${h.container.toString()}' not found.`);this._container=a}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),this._spriteFormat=h.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new ju),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new qo(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,(h.style||!h.testMode)&&this.setStyle(h.style||i.e.DEFAULT_STYLE,{config:h.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this.indoor=new em(this),h.hash&&(this._hash=new Wh(typeof h.hash=="string"&&h.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){t.center==null&&t.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch});const a=h.bounds;a&&(this.resize(),this.fitBounds(a,i.l({},h.fitBoundsOptions,{duration:0})))}this.resize(),h.attributionControl&&this.addControl(new dm({customAttribution:h.customAttribution})),this._logoControl=new fc,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new i.z(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new i.z(`${a.dataType}dataloading`,a))}),this._interactions=new iu(this)}_getMapId(){return this._mapId}addControl(h,t){if(t===void 0&&(t=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[t];return t.indexOf("bottom")!==-1?p.insertBefore(a,p.firstChild):p.appendChild(a),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(h);return t>-1&&this._controls.splice(t,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new i.z("movestart",h)).fire(new i.z("move",h)),this.fire(new i.z("resize",h)),t&&this.fire(new i.z("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(i.az.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(h){return this._scaleFactor=h,this.painter.scaleFactor=h,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(t=>t.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?navigator.language:Array.isArray(h)?h.length===0?void 0:h.map(t=>t==="auto"?navigator.language:t):h}setLanguage(h){const t=this._parseLanguage(h);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const a of this._controls)a._setLanguage&&a._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,t=h.projection.name;let a;t==="globe"&&h.zoom>=i.bY?(h.setMercatorFromTransition(),a=!0):t==="mercator"&&h.zoom<i.bY&&(h.setProjection({name:"globe"}),a=!0),a&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,t){return this._updateProjection(h||t||{name:"mercator"})}_updateProjection(h){let t;return t=h.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),t&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(h){return this.transform.locationPoint3D(i.bO.convert(h))}unproject(h){return this.transform.pointLocation3D(i.P.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,t,a){const p=v=>{let b=[];if(Array.isArray(t)){const E=t.filter(k=>this.getLayer(k));b=E.length?this.queryRenderedFeatures(v,{layers:E}):[]}else b=this.queryRenderedFeatures(v,{target:t});return b};if(h==="mouseenter"||h==="mouseover"){let v=!1;return{listener:a,targets:t,delegates:{mousemove:E=>{const k=p(E.point);k.length?v||(v=!0,a.call(this,new Cs(h,this,E.originalEvent,{features:k}))):v=!1},mouseout:()=>{v=!1}}}}if(h==="mouseleave"||h==="mouseout"){let v=!1;return{listener:a,targets:t,delegates:{mousemove:k=>{p(k.point).length?v=!0:v&&(v=!1,a.call(this,new Cs(h,this,k.originalEvent)))},mouseout:k=>{v&&(v=!1,a.call(this,new Cs(h,this,k.originalEvent)))}}}}{const v=b=>{const E=p(b.point);E.length&&(b.features=E,a.call(this,b),delete b.features)};return{listener:a,targets:t,delegates:{[h]:v}}}}on(h,t,a){if(typeof t=="function"||a===void 0)return super.on(h,t);if(typeof t=="string"&&(t=[t]),!this._areTargetsValid(t))return this;const p=this._createDelegatedListener(h,t,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const v in p.delegates)this.on(v,p.delegates[v]);return this}once(h,t,a){if(typeof t=="function"||a===void 0)return super.once(h,t);if(typeof t=="string"&&(t=[t]),!this._areTargetsValid(t))return this;const p=this._createDelegatedListener(h,t,a);for(const v in p.delegates)this.once(v,p.delegates[v]);return this}off(h,t,a){if(typeof t=="function"||a===void 0)return super.off(h,t);if(typeof t=="string"&&(t=[t]),!this._areTargetsValid(t))return this;const p=this._delegatedListeners?this._delegatedListeners[h]:void 0;return p&&(v=>{for(let b=0;b<v.length;b++){const E=v[b];if(E.listener===a&&Wd(E.targets,t)){for(const k in E.delegates)this.off(k,E.delegates[k]);return v.splice(b,1),this}}})(p),this}queryRenderedFeatures(h,t){if(!this.style)return[];if(h===void 0||h instanceof i.P||Array.isArray(h)||t!==void 0||(t=h,h=void 0),h=h||[[0,0],[this.transform.width,this.transform.height]],!t){const b=this.style.queryRenderedFeatures(h,void 0,this.transform),E=this.style.queryRenderedFeatureset(h,void 0,this.transform);return b.concat(E)}let a=!0;if(t.target&&(a=this._isTargetValid(t.target),a&&!t.layers))return this.style.queryRenderedFeatureset(h,t,this.transform);let p=!0;if(t.layers&&Array.isArray(t.layers)){for(const b of t.layers)if(!this._isValidId(b)){p=!1;break}if(p&&!t.target)return this.style.queryRenderedFeatures(h,t,this.transform)}let v=[];return p&&(v=v.concat(this.style.queryRenderedFeatures(h,t,this.transform))),a&&(v=v.concat(this.style.queryRenderedFeatureset(h,t,this.transform))),v}querySourceFeatures(h,t){return!h||typeof h=="string"&&!this._isValidId(h)?[]:this.style.querySourceFeatures(h,t)}isPointOnSurface(h){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&i.w(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(h))}addInteraction(h,t){return this._interactions.add(h,t),this}removeInteraction(h){return this._interactions.remove(h),this}setStyle(h,t){return t=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t),this.style&&h&&t.diff!==!1&&t.localFontFamily===this._localFontFamily&&t.localIdeographFontFamily===this._localIdeographFontFamily&&!t.config?(this.style._diffStyle(h,(a,p)=>{a?(i.w(`Unable to perform style diff: ${String(a.message||a.error||a)}. Rebuilding the style from scratch.`),this._updateStyle(h,t)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(h,t))}_getUIString(h){const t=this._locale[h];if(t==null)throw new Error(`Missing UI string '${h}'`);return t}_updateStyle(h,t){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h){const a=i.l({},t);t&&t.config&&(a.initialConfig=t.config,delete a.config),this.style=new us(this,a).load(h),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new us(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(h){return h==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(h)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${h}".`))),!1)}_isTargetValid(h){return"featuresetId"in h?this._isValidId("importId"in h?h.importId:h.featuresetId):"layerId"in h&&this._isValidId(h.layerId)}_areTargetsValid(h){if(Array.isArray(h)){for(const t of h)if(!this._isValidId(t))return!1;return!0}return this._isTargetValid(h)}addSource(h,t){return this._isValidId(h)?(this._lazyInitEmptyStyle(),this.style.addSource(h,t),this._update(!0)):this}isSourceLoaded(h){return!!this._isValidId(h)&&!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(h,t,a){this._lazyInitEmptyStyle(),this.style.addSourceType(h,t,a)}removeSource(h){return this._isValidId(h)?(this.style.removeSource(h),this._updateTerrain(),this._update(!0)):this}getSource(h){return this._isValidId(h)?this.style.getOwnSource(h):null}addImage(h,t,{pixelRatio:a=1,sdf:p=!1,stretchX:v,stretchY:b,content:E}={}){if(this._lazyInitEmptyStyle(),t instanceof HTMLImageElement||ImageBitmap&&t instanceof ImageBitmap){const{width:k,height:O,data:N}=i.q.getImageData(t);this.style.addImage(h,{data:new i.r({width:k,height:O},N),pixelRatio:a,stretchX:v,stretchY:b,content:E,sdf:p,version:0,usvg:!1})}else if(t.width===void 0||t.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:k,height:O}=t,N=t;this.style.addImage(h,{data:new i.r({width:k,height:O},new Uint8Array(N.data)),pixelRatio:a,stretchX:v,stretchY:b,content:E,sdf:p,usvg:!1,version:0,userImage:N}),N.onAdd&&N.onAdd(this,h)}}updateImage(h,t){this._lazyInitEmptyStyle();const a=this.style.getImage(h);if(!a)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=t instanceof HTMLImageElement||ImageBitmap&&t instanceof ImageBitmap?i.q.getImageData(t):t,{width:v,height:b,data:E}=p;if(v===void 0||b===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==(a.usvg?a.icon.usvg_tree.width:a.data.width)||b!==(a.usvg?a.icon.usvg_tree.height:a.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${v}, ${b})
                must be that same as the previous version of the image
                (${a.data.width}, ${a.data.height})`)));const k=!(t instanceof HTMLImageElement||ImageBitmap&&t instanceof ImageBitmap);let O=!1;a.usvg?(a.data=new i.r({width:v,height:b},new Uint8Array(E)),a.usvg=!1,a.icon=void 0,O=!0):a.data.replace(E,k),this.style.updateImage(h,a,O)}hasImage(h){return h?!!this.style&&!!this.style.getImage(h):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,t){i.o(this._requestManager.transformRequest(h,i.R.Image),(a,p)=>{t(a,p instanceof HTMLImageElement?i.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(h,t){this._lazyInitEmptyStyle(),this.style.addModel(h,t)}hasModel(h){return h?this.style.hasModel(h):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(h){this.style.removeModel(h)}listModels(){return this.style.listModels()}addLayer(h,t){return this._isValidId(h.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(h,t),this._update(!0)):this}getSlot(h){const t=this.getLayer(h);return t&&t.slot||null}setSlot(h,t){return this.style.setSlot(h,t),this.style.mergeLayers(),this._update(!0)}addImport(h,t){return this.style.addImport(h,t),this}updateImport(h,t){return typeof t!="string"&&t.id!==h?(this.removeImport(h),this.addImport(t)):(this.style.updateImport(h,t),this._update(!0))}removeImport(h){return this.style.removeImport(h),this}moveImport(h,t){return this.style.moveImport(h,t),this._update(!0)}moveLayer(h,t){return this._isValidId(h)?(this.style.moveLayer(h,t),this._update(!0)):this}removeLayer(h){return this._isValidId(h)?(this.style.removeLayer(h),this._update(!0)):this}getLayer(h){if(!this._isValidId(h))return null;const t=this.style.getOwnLayer(h);return t?t.type==="custom"?t.implementation:t.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(h,t,a){return this._isValidId(h)?(this.style.setLayerZoomRange(h,t,a),this._update(!0)):this}setFilter(h,t,a={}){return this._isValidId(h)?(this.style.setFilter(h,t,a),this._update(!0)):this}getFilter(h){return this._isValidId(h)?this.style.getFilter(h):null}setPaintProperty(h,t,a,p={}){return this._isValidId(h)?(this.style.setPaintProperty(h,t,a,p),this._update(!0)):this}getPaintProperty(h,t){return this._isValidId(h)?this.style.getPaintProperty(h,t):null}setLayoutProperty(h,t,a,p={}){return this._isValidId(h)?(this.style.setLayoutProperty(h,t,a,p),this._update(!0)):this}getLayoutProperty(h,t){return this._isValidId(h)?this.style.getLayoutProperty(h,t):null}getSchema(h){return this.style.getSchema(h)}setSchema(h,t){return this.style.setSchema(h,t),this._update(!0)}getConfig(h){return this.style.getConfig(h)}setConfig(h,t){return this.style.setConfig(h,t),this._update(!0)}getConfigProperty(h,t){return this.style.getConfigProperty(h,t)}setConfigProperty(h,t,a){return this.style.setConfigProperty(h,t,a),this._update(!0)}getFeaturesetDescriptors(h){return this.style.getFeaturesetDescriptors(h)}setLights(h){if(this._lazyInitEmptyStyle(),h&&h.length===1&&h[0].type==="flat"){const t=h[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(h),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const h=this.style.getLights()||[];return h.length===0&&h.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),h}setLight(h,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:h}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(h){return this._lazyInitEmptyStyle(),this.style.setSnow(h),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(h){return this._lazyInitEmptyStyle(),this.style.setRain(h),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(h){return this._lazyInitEmptyStyle(),this.style.setColorTheme(h),this._update(!0)}setImportColorTheme(h,t){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(h,t),this._update(!0)}setCamera(h){return this.style.setCamera(h),this._triggerCameraUpdate(h)}_triggerCameraUpdate(h){return this._update(this.transform.setOrthographicProjectionAtLowPitch(h["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(h),this.transform):0}setFeatureState(h,t){return h.source&&!this._isValidId(h.source)?this:(this.style.setFeatureState(h,t),this._update())}removeFeatureState(h,t){return h.source&&!this._isValidId(h.source)?this:(this.style.removeFeatureState(h,t),this._update())}getFeatureState(h){return h.source&&!this._isValidId(h.source)?null:this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let a,p,v,b=this._container;for(;b&&(!p||!v);){const E=window.getComputedStyle(b).transform;E&&E!=="none"&&(a=E.match(/matrix.*\((.+)\)/)[1].split(", "),a[0]&&a[0]!=="0"&&a[0]!=="1"&&(p=a[0]),a[3]&&a[3]!=="0"&&a[3]!=="1"&&(v=a[3])),b=b.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=v?Math.abs(t/v):t}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=j("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=j("div","mapboxgl-canvas-container",h);this._canvas=j("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const a=this._controlContainer=j("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(v=>{p[v]=j("div",`mapboxgl-ctrl-${v}`,a)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,t){const a=i.q.devicePixelRatio||1;this._canvas.width=a*Math.ceil(h),this._canvas.height=a*Math.ceil(t),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${t}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const t=this._markers.indexOf(h);t!==-1&&this._markers.splice(t,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const t=this._popups.indexOf(h);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const h=i.l({},H.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",h);t?(pn(t,!0),this.painter=new qh(t,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",a=>{a.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(t)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let t;this.fire(new i.z("renderstart")),++this._frameId;const a=this.painter.context.extTimerQuery,p=i.q.now(),v=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=v.createQuery(),v.beginQuery(a.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const N=this.transform.zoom,$=this.transform.pitch,W=i.q.now(),Z=new i.a8(N,{now:W,fadeDuration:b,pitch:$,transition:this.style.transition});this.style.update(Z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(p);const k=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),k&&(this._placementDirty=k.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,B.mark(F.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const N=i.q.now()-p;v.endQuery(a.TIME_ELAPSED_EXT),setTimeout(()=>{const $=v.getQueryParameter(t,v.QUERY_RESULT)/1e6;v.deleteQuery(t),this.fire(new i.z("gpu-timing-frame",{cpuTime:N,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){const N=this.painter.collectGpuTimers();setTimeout(()=>{const $=this.painter.queryGpuTimers(N);this.fire(new i.z("gpu-timing-layer",{layerTimes:$}))},50)}if(this.listens("gpu-timing-deferred-render")){const N=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const $=this.painter.queryGpuTimeDeferredRender(N);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:$}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(O||this._repaint)this.triggerRepaint();else{const N=this.idle();if(N&&(E=this._updateAverageElevation(p,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),N&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const $=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:$})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,B.mark(F.fullLoad),this._performanceMetricsCollection&&hn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const t of this._markers)h&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!h||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(h,t=!1){const a=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&a(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(t||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const v=this.transform.averageElevation;let b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=h;const E=Math.abs(v-b);if(E>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(b),a(b);this._averageElevation.easeTo(b,h,300)}else if(E>1e-4)return this._averageElevation.jumpTo(b),a(b)}return!!this._averageElevation.isEasing(h)&&a(this._averageElevation.getValue(h))}_authenticate(){Le(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===Xe||h.status===401)){const t=this.painter.context.gl;pn(t,!1),this._logoControl instanceof fc&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),gn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&$t(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const a=this.painter.context.gl,p=a.createFramebuffer();function v(b){a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,b,0);const E=new Uint8Array(a.drawingBufferWidth*a.drawingBufferHeight*4);return a.readPixels(0,0,a.drawingBufferWidth,a.drawingBufferHeight,a.RGBA,a.UNSIGNED_BYTE,E),E}return a.bindFramebuffer(a.FRAMEBUFFER,p),this._canvasPixelComparison(v(h),t.canvasCopies.map(v),t.timeStamps)}_canvasPixelComparison(h,t,a){let p=a[1]-a[0];const v=h.length/4;for(let b=0;b<t.length;b++){const E=t[b];let k=0;for(let O=0;O<E.length;O+=4)E[O]===h[O]&&E[O+1]===h[O+1]&&E[O+2]===h[O+2]&&E[O+3]===h[O+3]&&(k+=1);p+=(a[b+2]-a[b+1])*(1-k/v)}return p}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Dn.delete(this.painter.context.gl),xn.remove(),Nt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=i.q.frame(t=>{const a=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,a&&this._render(t)}))}_preloadTiles(h){const t=this.style?this.style.getSourceCaches():[];return i.bl(t,(a,p)=>a._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(h){this._showParseStatus!==h&&(this._showParseStatus=h,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(h){this._showLayers2DWireframe!==h&&(this._showLayers2DWireframe=h,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(h){this._showLayers3DWireframe!==h&&(this._showLayers3DWireframe=h,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,this._tp.refreshUI(),h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,this._tp.refreshUI(),h&&this._update())}_setCacheLimits(h,t){i.dG(h,t)}get version(){return I}},NavigationControl:class{constructor(h={}){this.options=i.l({},Pl,h),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),j("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),j("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const a=this._map;a&&(this.options.visualizePitch?a.resetNorthPitch({},{originalEvent:t}):a.resetNorth({},{originalEvent:t}))}),this._compassIcon=j("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const t=h.getZoom(),a=t===h.getMaxZoom(),p=t===h.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hd(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,t){const a=j("button",h,this._container);return a.type="button",a.addEventListener("click",t),a}_setButtonTitle(h,t){if(!this._map)return;const a=this._map._getUIString(`NavigationControl.${t}`);h.setAttribute("aria-label",a),h.firstElementChild&&h.firstElementChild.setAttribute("title",a)}},GeolocateControl:class extends i.E{constructor(h={}){super();const t=navigator.geolocation;this.options=i.l({geolocation:t},pa,h),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=eu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const t=(a=!!this.options.geolocation)=>{this._supportsGeolocation=a,h(a)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(a=>t(a.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(h){const t=this._map.getMaxBounds(),a=h.coords;return!!t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",h)),this._finish()}}_updateCamera(h){const t=new i.bO(h.coords.longitude,h.coords.latitude),a=h.coords.accuracy,p=this._map.getBearing(),v=i.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(a),v,{geolocateSource:!0})}_updateMarker(h){if(h){const t=new i.bO(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,t=i.bH(1,h._center.lat)*h.worldSize,a=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=j("button","mapboxgl-ctrl-geolocate",this._container),j("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j("div","mapboxgl-user-location"),this._dotElement.appendChild(j("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(j("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ka({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=j("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ka({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dm,ScaleControl:class{constructor(h={}){this.options=i.l({},vi,h),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,t=this._map,a=t._containerHeight/2,p=t._containerWidth/2-h/2,v=t.unproject([p,a]),b=t.unproject([p+h,a]),E=v.distanceTo(b);if(this.options.unit==="imperial"){const k=3.2808*E;k>5280?this._setScale(h,k/5280,"mile"):this._setScale(h,k,"foot")}else this.options.unit==="nautical"?this._setScale(h,E/1852,"nautical-mile"):E>=1e3?this._setScale(h,E/1e3,"kilometer"):this._setScale(h,E,"meter")}_setScale(h,t,a){this._map._requestDomTask(()=>{const p=function(b){const E=Math.pow(10,`${Math.floor(b)}`.length-1);let k=b/E;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(O){const N=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*N)/N}(k),E*k}(t),v=p/t;this._container.innerHTML=this._isNumberFormatSupported&&a!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:a}).format(p):`${p}&nbsp;${Is[a]}`,this._container.style.width=h*v+"px"})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h={}){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=j("button","mapboxgl-ctrl-fullscreen",this._controlContainer);j("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(h){super(),this.options=i.l(Object.create(Ln),h),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=i.bO.convert(h),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const t=document.createDocumentFragment(),a=document.createElement("body");let p;for(a.innerHTML=h;p=a.firstChild,p;)t.appendChild(p);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=j("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(h),this.options.closeButton){const a=this._closeButton=j("button","mapboxgl-popup-close-button",t);a.type="button",a.setAttribute("aria-label","Close popup"),a.setAttribute("aria-hidden","true"),a.innerHTML="&#215;",a.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let t;return this._classList.delete(h)?t=!1:(this._classList.add(h),t=!0),this._updateClassList(),t}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const t=this._map,a=this._container,p=this._pos;if(!t||!a||!p)return"bottom";const v=a.offsetWidth,b=a.offsetHeight,E=p.x<v/2,k=p.x>t.transform.width-v/2;if(p.y+h<b)return E?"top-left":k?"top-right":"top";if(p.y>t.transform.height-b){if(E)return"bottom-left";if(k)return"bottom-right"}return E?"left":k?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),h.className=t.join(" ")}_update(h){const t=this._map,a=this._content;if(!t||!this._lngLat&&!this._trackPointer||!a)return;let p=this._container;if(p||(p=this._container=j("div","mapboxgl-popup",t.getContainer()),this._tip=j("div","mapboxgl-popup-tip",p),p.appendChild(a)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wo(this._lngLat,this._pos,t.transform)),!this._trackPointer||h){const v=this._pos=this._trackPointer&&h instanceof i.P?h:t.project(this._lngLat),b=Fo(this.options.offset),E=this._anchor=this._getAnchor(b.y),k=Fo(this.options.offset,E),O=v.add(k).round();t._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${Zd[E]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&t._showingGlobe()){const v=i.dH(t.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(ou);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:Ka,Style:us,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:Fc,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(h){i.e.ACCESS_TOKEN=h},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(h){i.e.API_URL=h},get workerCount(){return i.dO.workerCount},set workerCount(h){i.dO.workerCount=h},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){i.e.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){i.dP(h)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(h){i.dQ.workerUrl=h},get workerClass(){return i.dQ.workerClass},set workerClass(h){i.dQ.workerClass=h},get workerParams(){return i.dQ.workerParams},set workerParams(h){i.dQ.workerParams=h},get dracoUrl(){return i.dR()},set dracoUrl(h){i.dS(h)},get meshoptUrl(){return i.dT()},set meshoptUrl(h){i.dU(h)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var T=m;return T})}(jv)),jv.exports}var LR=uW();const zR=Uf(LR),dW=rA({__proto__:null,default:zR},[LR]),y1=new jG({radius:75,maxZoom:20}),hW=()=>{const{state:{filteredStations:n},dispatch:r,mapRef:s}=mo(),[u,m]=fe.useState([]),[y,T]=fe.useState([]),[i,I]=fe.useState([-180,-85,180,85]),[F,B]=fe.useState(0),[G,J]=fe.useState(null),[te,H]=fe.useState(null),[j,ne]=fe.useState(null),[oe,pe]=fe.useState([]);fe.useEffect(()=>{rS.getStations(r)},[]),fe.useEffect(()=>{const ie=n.map(ce=>({type:"Feature",properties:{cluster:!1,stationId:ce._id,price:ce.price,name:ce.name,description:ce.description,lng:ce.lng,lat:ce.lat,images:ce.images,uPhoto:ce.uPhoto,uName:ce.uName},geometry:{type:"Point",coordinates:[parseFloat(ce.lng),parseFloat(ce.lat)]}}));m(ie)},[n]),fe.useEffect(()=>{y1.load(u),T(y1.getClusters(i,F))},[u,F,i]),fe.useEffect(()=>{s.current&&I(s.current.getMap().getBounds().toArray().flat())},[s==null?void 0:s.current]);const se=async ie=>{var ce;if(!te){r({type:"UPDATE_ALERT",payload:{open:!0,severity:"warning",message:"Please enable location first using the top-left button"}});return}try{const xe=await(await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${te.lng},${te.lat};${ie.lng},${ie.lat}?steps=true&geometries=geojson&access_token=pk.eyJ1IjoiemFja292ZXJsb2FkIiwiYSI6ImNtNmdqdDBqajAxcXcya3NhcHR1emg3cWkifQ.8XjrjoDMu-4xhqCXir6-_Q`)).json();if(xe.routes&&xe.routes[0]){ne({type:"Feature",properties:{},geometry:xe.routes[0].geometry});const $e=xe.routes[0].geometry.coordinates,Ze=$e.reduce((ae,ke)=>ae.extend(ke),new zR.LngLatBounds($e[0],$e[0]));(ce=s.current)==null||ce.getMap().fitBounds(Ze,{padding:100,duration:1e3})}}catch(we){console.error("Error fetching route:",we),r({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Error getting route. Please try again."}})}};return fe.useEffect(()=>{if(te&&n.length){const ie=BG(te,n);pe(ie)}},[te,n]),_e.jsxs(iR,{initialViewState:{longitude:77.7523,latitude:20.932},mapboxAccessToken:"pk.eyJ1IjoiemFja292ZXJsb2FkIiwiYSI6ImNtNmdqdDBqajAxcXcya3NhcHR1emg3cWkifQ.8XjrjoDMu-4xhqCXir6-_Q",mapStyle:"mapbox://styles/mapbox/streets-v11",style:{width:"100%",height:"100vh"},ref:s,onZoomEnd:ie=>B(Math.round(ie.viewState.zoom)),children:[y.map(ie=>{const{cluster:ce,point_count:we}=ie.properties,[xe,$e]=ie.geometry.coordinates;return ce?_e.jsx(J1,{longitude:xe,latitude:$e,children:_e.jsx("div",{className:"cluster-marker",style:{width:`${10+we/u.length*20}px`,height:`${10+we/u.length*20}px`},onClick:()=>{const Ze=Math.min(y1.getClusterExpansionZoom(ie.id),20);s.current.flyTo({center:[xe,$e],zoom:Ze,speed:1})},children:we})},`cluster-${ie.id}`):_e.jsx(J1,{longitude:xe,latitude:$e,children:_e.jsx(Lx,{title:ie.properties.uName,children:_e.jsx(ug,{src:ie.properties.uPhoto,component:xu,elevation:2,onClick:()=>J(ie.properties)})})},`station-${ie.properties.stationId}`)}),_e.jsx(sR,{position:"top-left",trackUserLocation:!0,onGeolocate:ie=>{H({lng:ie.coords.longitude,lat:ie.coords.latitude})}}),_e.jsx(oR,{position:"bottom-right"}),j&&_e.jsx(zG,{id:"route",type:"geojson",data:j,children:_e.jsx(LG,{id:"route",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3887be","line-width":5,"line-opacity":.75}})}),G&&_e.jsxs(kG,{longitude:G.lng,latitude:G.lat,maxWidth:"auto",closeOnClick:!1,focusAfterOpen:!1,offset:25,onClose:()=>{J(null),ne(null)},children:[_e.jsx(lW,{popupInfo:G}),_e.jsx("button",{className:"view-route-btn",onClick:()=>se(G),style:{marginTop:"10px"},children:"Get Directions"})]})]})},pW=()=>{const{state:{filteredStations:n},dispatch:r}=mo();return _e.jsx(cy,{children:_e.jsx($w,{gap:12,sx:{mb:8,gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr)) !important"},children:n.map(s=>_e.jsx(dP,{children:_e.jsxs(Rx,{sx:{height:"100% !important"},children:[_e.jsx(Y_,{sx:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7)0%, rgba(0,0,0,0.3)70%, rgba(0,0,0,0)100%"},title:s.price===10?"Cost-Efficient":"$"+s.price+"Rapid Charger",actionIcon:_e.jsx(Lx,{title:s.uName,sx:{mr:"5px"},children:_e.jsx(ug,{src:s.uPhoto})}),position:"top"}),_e.jsx("img",{src:s.images[0],alt:s.name,loading:"lazy",style:{cursor:"pointer"},onClick:()=>r({type:"UPDATE_STATION",payload:s})}),_e.jsx(Y_,{title:s.name,actionIcon:_e.jsx(kx,{sx:{color:"rgba(255, 255, 255, 0.8)",mr:"5px"},name:"station-rating",defaultValue:3.5,precision:.5,emptyIcon:_e.jsx(zP,{sx:{color:"rgba(255, 255, 255, 0.8)"}})})})]})},s._id))})})},fW="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Flevix.com%20--%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='150px'%20height='150px'%20viewBox='0%200%20150%20150'%20enable-background='new%200%200%20150%20150'%20xml:space='preserve'%3e%3ccircle%20opacity='0'%20fill='none'%20stroke='%231B75BB'%20stroke-width='2'%20stroke-miterlimit='10'%20cx='74.911'%20cy='76.481'%20r='26.329'%3e%3canimate%20attributeName='opacity'%20values='0;.8;0'%20begin='.4'%20dur='2s'%20repeatCount='indefinite'%20/%3e%3c/circle%3e%3ccircle%20opacity='0'%20fill='none'%20stroke='%231B75BB'%20stroke-width='2'%20stroke-miterlimit='10'%20cx='74.911'%20cy='76.481'%20r='15.19'%3e%3canimate%20attributeName='opacity'%20values='0;.9;0'%20begin='.2'%20dur='2s'%20repeatCount='indefinite'%20/%3e%3c/circle%3e%3ccircle%20opacity='0'%20fill='none'%20stroke='%231B75BB'%20stroke-width='2'%20stroke-miterlimit='10'%20cx='74.911'%20cy='76.481'%20r='5.063'%3e%3canimate%20attributeName='opacity'%20values='0;1;0'%20begin='0'%20dur='2s'%20repeatCount='indefinite'%20/%3e%3c/circle%3e%3ccircle%20opacity='0'%20fill='none'%20stroke='%231B75BB'%20stroke-width='2'%20stroke-miterlimit='10'%20cx='74.911'%20cy='76.481'%20r='37.975'%3e%3canimate%20attributeName='opacity'%20values='0;.5;0'%20begin='.6'%20dur='2s'%20repeatCount='indefinite'%20/%3e%3c/circle%3e%3c/svg%3e";let jI;const UI=({mainProps:n,optionalProps:r,minLength:s})=>{const{dispatch:u}=mo(),[m,y]=fe.useState(!1),[T,i]=fe.useState(!1),[I,F]=fe.useState(!1),B=G=>{u({type:"UPDATE_DETAILS",payload:{[G.target.name]:G.target.value}}),m||y(!0),clearTimeout(jI),jI=setTimeout(()=>{y(!1),G.target.value.length<s?(T||i(!0),I&&F(!1)):(T&&i(!1),I||F(!0))},1e3)};return _e.jsx(Ff,{...n,...r,error:T,helperText:T&&`This field must be ${s} characters or more`,color:I?"success":"primary",variant:"outlined",onChange:B,required:!0,slotProps:{endAdornment:_e.jsx(Gw,{position:"end",children:m?_e.jsx(ug,{src:fW,sx:{height:70}}):I&&_e.jsx(h$,{color:"success"})})}})},mW=()=>{const{state:{details:{name:n,description:r,price:s}},dispatch:u}=mo(),[m,y]=fe.useState(s?40:10),T=I=>{const F=Number(I.target.value);y(F),u(F===10?{type:"UPDATE_DETAILS",payload:{price:10}}:{type:"UPDATE_DETAILS",payload:{price:40}})},i=I=>{u({type:"UPDATE_DETAILS",payload:{price:I.target.value}})};return _e.jsxs(_p,{sx:{alignItems:"center","& .MuiTextField-root":{width:"100%",maxWidth:500,m:1}},children:[_e.jsx(vP,{children:_e.jsxs(x6,{name:"costType",value:m,row:!0,onChange:T,children:[_e.jsx(LC,{value:0,control:_e.jsx(YC,{}),label:"Cost-Efficient Charger"}),_e.jsx(LC,{value:1,control:_e.jsx(YC,{}),label:"Rapid Charger"}),!!m&&_e.jsx(Ff,{sx:{width:"7ch !important"},variant:"standard",slotProps:{htmlInput:{type:"number",min:1,max:50},startAdornment:_e.jsx(Gw,{position:"start",children:"$"})},value:s,onChange:i,name:"price"})]})}),_e.jsx(UI,{mainProps:{name:"name",label:"Name",value:n},minLength:5}),_e.jsx(UI,{mainProps:{name:"description",label:"Description",value:r},minLength:10,optionalProps:{multiline:!0,rows:4}})]})};function qf(n,r,s,u){function m(y){return y instanceof s?y:new s(function(T){T(y)})}return new(s||(s=Promise))(function(y,T){function i(B){try{F(u.next(B))}catch(G){T(G)}}function I(B){try{F(u.throw(B))}catch(G){T(G)}}function F(B){B.done?y(B.value):m(B.value).then(i,I)}F((u=u.apply(n,r||[])).next())})}const gW=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function ag(n,r,s){const u=_W(n),{webkitRelativePath:m}=n,y=typeof r=="string"?r:typeof m=="string"&&m.length>0?m:`./${n.name}`;return typeof u.path!="string"&&$I(u,"path",y),$I(u,"relativePath",y),u}function _W(n){const{name:r}=n;if(r&&r.lastIndexOf(".")!==-1&&!n.type){const u=r.split(".").pop().toLowerCase(),m=gW.get(u);m&&Object.defineProperty(n,"type",{value:m,writable:!1,configurable:!1,enumerable:!0})}return n}function $I(n,r,s){Object.defineProperty(n,r,{value:s,writable:!1,configurable:!1,enumerable:!0})}const yW=[".DS_Store","Thumbs.db"];function vW(n){return qf(this,void 0,void 0,function*(){return ix(n)&&xW(n.dataTransfer)?TW(n.dataTransfer,n.type):bW(n)?wW(n):Array.isArray(n)&&n.every(r=>"getFile"in r&&typeof r.getFile=="function")?SW(n):[]})}function xW(n){return ix(n)}function bW(n){return ix(n)&&ix(n.target)}function ix(n){return typeof n=="object"&&n!==null}function wW(n){return ow(n.target.files).map(r=>ag(r))}function SW(n){return qf(this,void 0,void 0,function*(){return(yield Promise.all(n.map(s=>s.getFile()))).map(s=>ag(s))})}function TW(n,r){return qf(this,void 0,void 0,function*(){if(n.items){const s=ow(n.items).filter(m=>m.kind==="file");if(r!=="drop")return s;const u=yield Promise.all(s.map(EW));return VI(DR(u))}return VI(ow(n.files).map(s=>ag(s)))})}function VI(n){return n.filter(r=>yW.indexOf(r.name)===-1)}function ow(n){if(n===null)return[];const r=[];for(let s=0;s<n.length;s++){const u=n[s];r.push(u)}return r}function EW(n){if(typeof n.webkitGetAsEntry!="function")return GI(n);const r=n.webkitGetAsEntry();return r&&r.isDirectory?OR(r):GI(n,r)}function DR(n){return n.reduce((r,s)=>[...r,...Array.isArray(s)?DR(s):[s]],[])}function GI(n,r){return qf(this,void 0,void 0,function*(){var s;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const y=yield n.getAsFileSystemHandle();if(y===null)throw new Error(`${n} is not a File`);if(y!==void 0){const T=yield y.getFile();return T.handle=y,ag(T)}}const u=n.getAsFile();if(!u)throw new Error(`${n} is not a File`);return ag(u,(s=r==null?void 0:r.fullPath)!==null&&s!==void 0?s:void 0)})}function CW(n){return qf(this,void 0,void 0,function*(){return n.isDirectory?OR(n):MW(n)})}function OR(n){const r=n.createReader();return new Promise((s,u)=>{const m=[];function y(){r.readEntries(T=>qf(this,void 0,void 0,function*(){if(T.length){const i=Promise.all(T.map(CW));m.push(i),y()}else try{const i=yield Promise.all(m);s(i)}catch(i){u(i)}}),T=>{u(T)})}y()})}function MW(n){return qf(this,void 0,void 0,function*(){return new Promise((r,s)=>{n.file(u=>{const m=ag(u,n.fullPath);r(m)},u=>{s(u)})})})}var Av={},qI;function IW(){return qI||(qI=1,Av.__esModule=!0,Av.default=function(n,r){if(n&&r){var s=Array.isArray(r)?r:r.split(",");if(s.length===0)return!0;var u=n.name||"",m=(n.type||"").toLowerCase(),y=m.replace(/\/.*$/,"");return s.some(function(T){var i=T.trim().toLowerCase();return i.charAt(0)==="."?u.toLowerCase().endsWith(i):i.endsWith("/*")?y===i.replace(/\/.*$/,""):m===i})}return!0}),Av}var AW=IW();const v1=Uf(AW);function WI(n){return kW(n)||RW(n)||BR(n)||PW()}function PW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RW(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function kW(n){if(Array.isArray(n))return sw(n)}function HI(n,r){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);r&&(u=u.filter(function(m){return Object.getOwnPropertyDescriptor(n,m).enumerable})),s.push.apply(s,u)}return s}function ZI(n){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?HI(Object(s),!0).forEach(function(u){FR(n,u,s[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):HI(Object(s)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(s,u))})}return n}function FR(n,r,s){return r in n?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,n}function Q_(n,r){return DW(n)||zW(n,r)||BR(n,r)||LW()}function LW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BR(n,r){if(n){if(typeof n=="string")return sw(n,r);var s=Object.prototype.toString.call(n).slice(8,-1);if(s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set")return Array.from(n);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return sw(n,r)}}function sw(n,r){(r==null||r>n.length)&&(r=n.length);for(var s=0,u=new Array(r);s<r;s++)u[s]=n[s];return u}function zW(n,r){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var u=[],m=!0,y=!1,T,i;try{for(s=s.call(n);!(m=(T=s.next()).done)&&(u.push(T.value),!(r&&u.length===r));m=!0);}catch(I){y=!0,i=I}finally{try{!m&&s.return!=null&&s.return()}finally{if(y)throw i}}return u}}function DW(n){if(Array.isArray(n))return n}var OW=typeof v1=="function"?v1:v1.default,FW="file-invalid-type",BW="file-too-large",NW="file-too-small",jW="too-many-files",UW=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=r.split(","),u=s.length>1?"one of ".concat(s.join(", ")):s[0];return{code:FW,message:"File type must be ".concat(u)}},XI=function(r){return{code:BW,message:"File is larger than ".concat(r," ").concat(r===1?"byte":"bytes")}},YI=function(r){return{code:NW,message:"File is smaller than ".concat(r," ").concat(r===1?"byte":"bytes")}},$W={code:jW,message:"Too many files"};function NR(n,r){var s=n.type==="application/x-moz-file"||OW(n,r);return[s,s?null:UW(r)]}function jR(n,r,s){if(Ef(n.size))if(Ef(r)&&Ef(s)){if(n.size>s)return[!1,XI(s)];if(n.size<r)return[!1,YI(r)]}else{if(Ef(r)&&n.size<r)return[!1,YI(r)];if(Ef(s)&&n.size>s)return[!1,XI(s)]}return[!0,null]}function Ef(n){return n!=null}function VW(n){var r=n.files,s=n.accept,u=n.minSize,m=n.maxSize,y=n.multiple,T=n.maxFiles,i=n.validator;return!y&&r.length>1||y&&T>=1&&r.length>T?!1:r.every(function(I){var F=NR(I,s),B=Q_(F,1),G=B[0],J=jR(I,u,m),te=Q_(J,1),H=te[0],j=i?i(I):null;return G&&H&&!j})}function ox(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function Pv(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(r){return r==="Files"||r==="application/x-moz-file"}):!!n.target&&!!n.target.files}function KI(n){n.preventDefault()}function GW(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function qW(n){return n.indexOf("Edge/")!==-1}function WW(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return GW(n)||qW(n)}function nd(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return function(u){for(var m=arguments.length,y=new Array(m>1?m-1:0),T=1;T<m;T++)y[T-1]=arguments[T];return r.some(function(i){return!ox(u)&&i&&i.apply(void 0,[u].concat(y)),ox(u)})}}function HW(){return"showOpenFilePicker"in window}function ZW(n){if(Ef(n)){var r=Object.entries(n).filter(function(s){var u=Q_(s,2),m=u[0],y=u[1],T=!0;return UR(m)||(console.warn('Skipped "'.concat(m,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),T=!1),(!Array.isArray(y)||!y.every($R))&&(console.warn('Skipped "'.concat(m,'" because an invalid file extension was provided.')),T=!1),T}).reduce(function(s,u){var m=Q_(u,2),y=m[0],T=m[1];return ZI(ZI({},s),{},FR({},y,T))},{});return[{description:"Files",accept:r}]}return n}function XW(n){if(Ef(n))return Object.entries(n).reduce(function(r,s){var u=Q_(s,2),m=u[0],y=u[1];return[].concat(WI(r),[m],WI(y))},[]).filter(function(r){return UR(r)||$R(r)}).join(",")}function YW(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function KW(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function UR(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function $R(n){return/^.*\.[\w]+$/.test(n)}var JW=["children"],QW=["open"],eH=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],tH=["refKey","onChange","onClick"];function nH(n){return oH(n)||iH(n)||VR(n)||rH()}function rH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iH(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function oH(n){if(Array.isArray(n))return aw(n)}function x1(n,r){return lH(n)||aH(n,r)||VR(n,r)||sH()}function sH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VR(n,r){if(n){if(typeof n=="string")return aw(n,r);var s=Object.prototype.toString.call(n).slice(8,-1);if(s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set")return Array.from(n);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return aw(n,r)}}function aw(n,r){(r==null||r>n.length)&&(r=n.length);for(var s=0,u=new Array(r);s<r;s++)u[s]=n[s];return u}function aH(n,r){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var u=[],m=!0,y=!1,T,i;try{for(s=s.call(n);!(m=(T=s.next()).done)&&(u.push(T.value),!(r&&u.length===r));m=!0);}catch(I){y=!0,i=I}finally{try{!m&&s.return!=null&&s.return()}finally{if(y)throw i}}return u}}function lH(n){if(Array.isArray(n))return n}function JI(n,r){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);r&&(u=u.filter(function(m){return Object.getOwnPropertyDescriptor(n,m).enumerable})),s.push.apply(s,u)}return s}function Lo(n){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?JI(Object(s),!0).forEach(function(u){lw(n,u,s[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):JI(Object(s)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(s,u))})}return n}function lw(n,r,s){return r in n?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,n}function sx(n,r){if(n==null)return{};var s=cH(n,r),u,m;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(n);for(m=0;m<y.length;m++)u=y[m],!(r.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(n,u)&&(s[u]=n[u])}return s}function cH(n,r){if(n==null)return{};var s={},u=Object.keys(n),m,y;for(y=0;y<u.length;y++)m=u[y],!(r.indexOf(m)>=0)&&(s[m]=n[m]);return s}var uS=fe.forwardRef(function(n,r){var s=n.children,u=sx(n,JW),m=qR(u),y=m.open,T=sx(m,QW);return fe.useImperativeHandle(r,function(){return{open:y}},[y]),Vi.createElement(fe.Fragment,null,s(Lo(Lo({},T),{},{open:y})))});uS.displayName="Dropzone";var GR={disabled:!1,getFilesFromEvent:vW,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};uS.defaultProps=GR;uS.propTypes={children:Qi.func,accept:Qi.objectOf(Qi.arrayOf(Qi.string)),multiple:Qi.bool,preventDropOnDocument:Qi.bool,noClick:Qi.bool,noKeyboard:Qi.bool,noDrag:Qi.bool,noDragEventsBubbling:Qi.bool,minSize:Qi.number,maxSize:Qi.number,maxFiles:Qi.number,disabled:Qi.bool,getFilesFromEvent:Qi.func,onFileDialogCancel:Qi.func,onFileDialogOpen:Qi.func,useFsAccessApi:Qi.bool,autoFocus:Qi.bool,onDragEnter:Qi.func,onDragLeave:Qi.func,onDragOver:Qi.func,onDrop:Qi.func,onDropAccepted:Qi.func,onDropRejected:Qi.func,onError:Qi.func,validator:Qi.func};var cw={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function qR(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Lo(Lo({},GR),n),s=r.accept,u=r.disabled,m=r.getFilesFromEvent,y=r.maxSize,T=r.minSize,i=r.multiple,I=r.maxFiles,F=r.onDragEnter,B=r.onDragLeave,G=r.onDragOver,J=r.onDrop,te=r.onDropAccepted,H=r.onDropRejected,j=r.onFileDialogCancel,ne=r.onFileDialogOpen,oe=r.useFsAccessApi,pe=r.autoFocus,se=r.preventDropOnDocument,ie=r.noClick,ce=r.noKeyboard,we=r.noDrag,xe=r.noDragEventsBubbling,$e=r.onError,Ze=r.validator,ae=fe.useMemo(function(){return XW(s)},[s]),ke=fe.useMemo(function(){return ZW(s)},[s]),ct=fe.useMemo(function(){return typeof ne=="function"?ne:QI},[ne]),Xe=fe.useMemo(function(){return typeof j=="function"?j:QI},[j]),st=fe.useRef(null),et=fe.useRef(null),gt=fe.useReducer(uH,cw),zt=x1(gt,2),at=zt[0],Ye=zt[1],Bt=at.isFocused,nt=at.isFileDialogActive,Rt=fe.useRef(typeof window<"u"&&window.isSecureContext&&oe&&HW()),Nt=function(){!Rt.current&&nt&&setTimeout(function(){if(et.current){var Ft=et.current.files;Ft.length||(Ye({type:"closeDialog"}),Xe())}},300)};fe.useEffect(function(){return window.addEventListener("focus",Nt,!1),function(){window.removeEventListener("focus",Nt,!1)}},[et,nt,Xe,Rt]);var gn=fe.useRef([]),Mt=function(Ft){st.current&&st.current.contains(Ft.target)||(Ft.preventDefault(),gn.current=[])};fe.useEffect(function(){return se&&(document.addEventListener("dragover",KI,!1),document.addEventListener("drop",Mt,!1)),function(){se&&(document.removeEventListener("dragover",KI),document.removeEventListener("drop",Mt))}},[st,se]),fe.useEffect(function(){return!u&&pe&&st.current&&st.current.focus(),function(){}},[st,pe,u]);var $t=fe.useCallback(function(Dt){$e?$e(Dt):console.error(Dt)},[$e]),Ut=fe.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),cr(Dt),gn.current=[].concat(nH(gn.current),[Dt.target]),Pv(Dt)&&Promise.resolve(m(Dt)).then(function(Ft){if(!(ox(Dt)&&!xe)){var sn=Ft.length,Tn=sn>0&&VW({files:Ft,accept:ae,minSize:T,maxSize:y,multiple:i,maxFiles:I,validator:Ze}),Pn=sn>0&&!Tn;Ye({isDragAccept:Tn,isDragReject:Pn,isDragActive:!0,type:"setDraggedFiles"}),F&&F(Dt)}}).catch(function(Ft){return $t(Ft)})},[m,F,$t,xe,ae,T,y,i,I,Ze]),hn=fe.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),cr(Dt);var Ft=Pv(Dt);if(Ft&&Dt.dataTransfer)try{Dt.dataTransfer.dropEffect="copy"}catch{}return Ft&&G&&G(Dt),!1},[G,xe]),xn=fe.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),cr(Dt);var Ft=gn.current.filter(function(Tn){return st.current&&st.current.contains(Tn)}),sn=Ft.indexOf(Dt.target);sn!==-1&&Ft.splice(sn,1),gn.current=Ft,!(Ft.length>0)&&(Ye({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Pv(Dt)&&B&&B(Dt))},[st,B,xe]),Le=fe.useCallback(function(Dt,Ft){var sn=[],Tn=[];Dt.forEach(function(Pn){var ur=NR(Pn,ae),Bn=x1(ur,2),Hn=Bn[0],Zr=Bn[1],Lr=jR(Pn,T,y),qr=x1(Lr,2),Yn=qr[0],Ar=qr[1],si=Ze?Ze(Pn):null;if(Hn&&Yn&&!si)sn.push(Pn);else{var $n=[Zr,Ar];si&&($n=$n.concat(si)),Tn.push({file:Pn,errors:$n.filter(function(Zi){return Zi})})}}),(!i&&sn.length>1||i&&I>=1&&sn.length>I)&&(sn.forEach(function(Pn){Tn.push({file:Pn,errors:[$W]})}),sn.splice(0)),Ye({acceptedFiles:sn,fileRejections:Tn,isDragReject:Tn.length>0,type:"setFiles"}),J&&J(sn,Tn,Ft),Tn.length>0&&H&&H(Tn,Ft),sn.length>0&&te&&te(sn,Ft)},[Ye,i,ae,T,y,I,J,te,H,Ze]),Dn=fe.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),cr(Dt),gn.current=[],Pv(Dt)&&Promise.resolve(m(Dt)).then(function(Ft){ox(Dt)&&!xe||Le(Ft,Dt)}).catch(function(Ft){return $t(Ft)}),Ye({type:"reset"})},[m,Le,$t,xe]),pn=fe.useCallback(function(){if(Rt.current){Ye({type:"openDialog"}),ct();var Dt={multiple:i,types:ke};window.showOpenFilePicker(Dt).then(function(Ft){return m(Ft)}).then(function(Ft){Le(Ft,null),Ye({type:"closeDialog"})}).catch(function(Ft){YW(Ft)?(Xe(Ft),Ye({type:"closeDialog"})):KW(Ft)?(Rt.current=!1,et.current?(et.current.value=null,et.current.click()):$t(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):$t(Ft)});return}et.current&&(Ye({type:"openDialog"}),ct(),et.current.value=null,et.current.click())},[Ye,ct,Xe,oe,Le,$t,ke,i]),zn=fe.useCallback(function(Dt){!st.current||!st.current.isEqualNode(Dt.target)||(Dt.key===" "||Dt.key==="Enter"||Dt.keyCode===32||Dt.keyCode===13)&&(Dt.preventDefault(),pn())},[st,pn]),_t=fe.useCallback(function(){Ye({type:"focus"})},[]),er=fe.useCallback(function(){Ye({type:"blur"})},[]),pr=fe.useCallback(function(){ie||(WW()?setTimeout(pn,0):pn())},[ie,pn]),qn=function(Ft){return u?null:Ft},_n=function(Ft){return ce?null:qn(Ft)},ir=function(Ft){return we?null:qn(Ft)},cr=function(Ft){xe&&Ft.stopPropagation()},Er=fe.useMemo(function(){return function(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ft=Dt.refKey,sn=Ft===void 0?"ref":Ft,Tn=Dt.role,Pn=Dt.onKeyDown,ur=Dt.onFocus,Bn=Dt.onBlur,Hn=Dt.onClick,Zr=Dt.onDragEnter,Lr=Dt.onDragOver,qr=Dt.onDragLeave,Yn=Dt.onDrop,Ar=sx(Dt,eH);return Lo(Lo(lw({onKeyDown:_n(nd(Pn,zn)),onFocus:_n(nd(ur,_t)),onBlur:_n(nd(Bn,er)),onClick:qn(nd(Hn,pr)),onDragEnter:ir(nd(Zr,Ut)),onDragOver:ir(nd(Lr,hn)),onDragLeave:ir(nd(qr,xn)),onDrop:ir(nd(Yn,Dn)),role:typeof Tn=="string"&&Tn!==""?Tn:"presentation"},sn,st),!u&&!ce?{tabIndex:0}:{}),Ar)}},[st,zn,_t,er,pr,Ut,hn,xn,Dn,ce,we,u]),On=fe.useCallback(function(Dt){Dt.stopPropagation()},[]),fi=fe.useMemo(function(){return function(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ft=Dt.refKey,sn=Ft===void 0?"ref":Ft,Tn=Dt.onChange,Pn=Dt.onClick,ur=sx(Dt,tH),Bn=lw({accept:ae,multiple:i,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:qn(nd(Tn,Dn)),onClick:qn(nd(Pn,On)),tabIndex:-1},sn,et);return Lo(Lo({},Bn),ur)}},[et,s,i,Dn,u]);return Lo(Lo({},at),{},{isFocused:Bt&&!u,getRootProps:Er,getInputProps:fi,rootRef:st,inputRef:et,open:qn(pn)})}function uH(n,r){switch(r.type){case"focus":return Lo(Lo({},n),{},{isFocused:!0});case"blur":return Lo(Lo({},n),{},{isFocused:!1});case"openDialog":return Lo(Lo({},cw),{},{isFileDialogActive:!0});case"closeDialog":return Lo(Lo({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return Lo(Lo({},n),{},{isDragActive:r.isDragActive,isDragAccept:r.isDragAccept,isDragReject:r.isDragReject});case"setFiles":return Lo(Lo({},n),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections,isDragReject:r.isDragReject});case"reset":return Lo({},cw);default:return n}}function QI(){}const dH=async n=>{try{const{error:r}=await Nf.storage.from("parkitnchargeapp").remove([n]);if(console.log("Deleted from Supabase"),r)throw r;return!0}catch(r){throw console.error("Error deleting file:",r),r}},hH=()=>{const{state:{images:n,currentUser:r},dispatch:s}=mo();fe.useEffect(()=>{(async()=>{if(r!=null&&r.id)try{const{data:y,error:T}=await Nf.storage.from("parkitnchargeapp").list(`stations/${r.id}`);if(T)throw T;y.forEach(async i=>{const{data:I}=Nf.storage.from("parkitnchargeapp").getPublicUrl(`stations/${r.id}/${i.name}`);s({type:"UPDATE_IMAGES",payload:{url:I.publicUrl,name:i.name}})})}catch(y){console.error("Error fetching images:",y),s({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Error fetching images"}})}})()},[r,s]);const u=async m=>{if(!m||typeof m!="object"||!m.url){console.error("Invalid image object:",m);return}const y=m.url;s({type:"DELETE_IMAGE",payload:m});const T=y==null?void 0:y.split("/public/")[1];if(!T){console.error("File path could not be extracted from the URL");return}try{await dH(T)}catch(i){console.error("Error deleting file:",i)}};return _e.jsx($w,{rowHeight:250,sx:{"&.MuiImageList-root":{gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))!important"}},children:n.map((m,y)=>_e.jsxs(Rx,{cols:1,rows:1,children:[_e.jsx("img",{src:m&&m.url,alt:"stations",loading:"lazy",style:{height:"100%"}}),_e.jsx(Y_,{position:"top",sx:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7)0%, rgba(0,0,0,0.3)70%, rgba(0,0,0,0)100%)"},actionIcon:_e.jsx(fu,{sx:{color:"white"},onClick:()=>u(m),children:_e.jsx(d$,{})})})]},y))})},pH=({value:n})=>_e.jsxs(Zo,{children:[_e.jsx(Tx,{size:60,thickness:5,variant:"determinate",value:n}),_e.jsx(Zo,{sx:{position:"absolute",top:0,right:0,bottom:0,left:0,display:"flex",justifyContent:"center",alignItems:"center"},children:_e.jsx(so,{variant:"caption",component:"div",color:"white",fontSize:"1rem",children:Math.round(n)+"%"})})]}),fH=(n,r,s,u)=>new Promise((m,y)=>{console.log("Starting upload with:",{subFolder:r,imageName:s}),Nf.storage.from("parkitnchargeapp").upload(r+"/"+s,n,{onProgress:i=>{const I=i.loaded/i.total*100;u(I)}}).then(async i=>{if(console.log("Upload result:",i),i.error){console.error("Upload error:",i.error),y(i.error);return}try{const{data:I,error:F}=await Nf.storage.from("parkitnchargeapp").getPublicUrl(`${r}/${s}`);if(F){console.error("Error getting public URL:",F),y(F);return}if(!I||!I.publicUrl){const B=new Error("Failed to get public URL");console.error(B),y(B);return}console.log("Successfully got public URL:",I.publicUrl),m(I.publicUrl)}catch(I){console.error("Get URL error:",I),y(I)}},i=>{console.error("Storage error:",i),y(i)})}),mH=({file:n})=>{const[r,s]=fe.useState(0),[u,m]=fe.useState(null),[y,T]=fe.useState(!1),{state:{currentUser:i},dispatch:I}=mo(),F=fe.useCallback(async()=>{const B=nR()+"."+n.name.split(".").pop();try{const G=await fH(n,`stations/${i==null?void 0:i.id}`,B,s);if(console.log("Received URL from upload:",G),!G)throw new Error("No URL received from upload");I({type:"UPDATE_IMAGES",payload:G}),s(100),T(!0),setTimeout(()=>{m(null)},2e3)}catch(G){console.error("Upload error:",G),I({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:`Upload failed: ${G.message}`}}),console.error("Upload error:",G)}},[n,i,I]);return fe.useEffect(()=>{n&&(m(URL.createObjectURL(n)),F())},[n,F]),u&&_e.jsxs(Rx,{cols:1,rows:1,children:[_e.jsx("img",{src:u,alt:"gallery",loading:"lazy"}),_e.jsx(Zo,{sx:gH,children:y?_e.jsx(p$,{sx:{width:60,height:60,color:"lightgreen"}}):_e.jsx(pH,{value:r})})]})},gH={position:"absolute",top:0,right:0,bottom:0,left:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0, .5)"},_H=({files:n})=>_e.jsx($w,{rowHeight:250,sx:{"&.MuiImageList-root":{gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))!important"}},children:n.map((r,s)=>_e.jsx(mH,{file:r},s))}),yH=()=>{const[n,r]=fe.useState([]),s=fe.useCallback(T=>{r(T)},[]),{getRootProps:u,getInputProps:m,isDragActive:y}=qR({onDrop:s,accept:{"image/*":[]}});return _e.jsxs(_e.Fragment,{children:[_e.jsx(xu,{sx:{cursor:"pointer",background:"#fafafa",color:"#bdbdbd",border:"1px dashed #ccc","&:hover":{border:"1px solid #ccc"}},children:_e.jsxs("div",{style:{padding:"16px"},...u(),children:[_e.jsx("input",{...m()}),y?_e.jsx("p",{style:{color:"green"},children:"Drop the files here..."}):_e.jsx("p",{children:"Drag n Drop some files here, or click to select files"}),_e.jsx("em",{children:"(images with *.jpeg, *.png, *.jpg extension will be accepted)"})]})}),_e.jsx(_H,{files:n}),_e.jsx(hH,{})]})},vH=()=>{const{dispatch:n}=mo(),r=new mR({accessToken:"pk.eyJ1IjoiemFja292ZXJsb2FkIiwiYSI6ImNtNmdqdDBqajAxcXcya3NhcHR1emg3cWkifQ.8XjrjoDMu-4xhqCXir6-_Q",marker:!1,collapsed:!0});return fg(()=>r),r.on("result",s=>{const u=s.result.geometry.coordinates;n({type:"UPDATE_LOCATION",payload:{lng:u[0],lat:u[1]}})}),null},xH=()=>{const{state:{location:{lng:n,lat:r}},dispatch:s}=mo(),u=fe.useRef();return fe.useEffect(()=>{!n&&!r&&fetch("https://ipapi.co/json").then(m=>m.json()).then(m=>{u.current.flyTo({center:[m.longitude,m.latitude]}),s({type:"UPDATE_LOCATION",payload:{lng:m.longitude,lat:m.latitude}})})},[]),_e.jsx(Zo,{sx:{height:400,position:"relative"},children:_e.jsxs(iR,{ref:u,mapboxAccessToken:"pk.eyJ1IjoiemFja292ZXJsb2FkIiwiYSI6ImNtNmdqdDBqajAxcXcya3NhcHR1emg3cWkifQ.8XjrjoDMu-4xhqCXir6-_Q",initialViewState:{longitude:n,latitude:r,zoom:8},mapStyle:"mapbox://styles/mapbox/streets-v11",children:[_e.jsx(J1,{latitude:r,longitude:n,draggable:!0,onDragEnd:m=>s({type:"UPDATE_LOCATION",payload:{lng:m.lngLat.lng,lat:m.lngLat.lat}})}),_e.jsx(oR,{position:"bottom-right"}),_e.jsx(sR,{position:"top-left",trackUserLocation:!0,onGeolocate:m=>s({type:"UPDATE_LOCATION",payload:{lng:m.coords.longitude,lat:m.coords.latitude}})}),_e.jsx(vH,{})]})})},bH=({setPage:n})=>{const{state:{images:r,details:s,location:u,currentUser:m},dispatch:y}=mo(),[T,i]=fe.useState(0),[I,F]=fe.useState([{label:"Location",completed:!1},{label:"Details",completed:!1},{label:"Images",completed:!1}]),[B,G]=fe.useState(!1),J=()=>{if(T<I.length-1)i(oe=>oe+1);else{const oe=H();i(oe)}},te=()=>!(T<I.length-1||H()!==-1),H=()=>I.findIndex(oe=>!oe.completed);fe.useEffect(()=>{r.length?I[2].completed||j(2,!0):I[2].completed&&j(2,!1)},[r]),fe.useEffect(()=>{s.name.length>4&&s.description.length>9?I[1].completed||j(1,!0):I[1].completed&&j(1,!1)},[s]),fe.useEffect(()=>{u.lng||u.lat?I[0].completed||j(0,!0):I[0].completed&&j(0,!1)},[u]);const j=(oe,pe)=>{F(se=>(se[oe].completed=pe,[...se]))};fe.useEffect(()=>{H()===-1?B||G(!0):B&&G(!1)},[I]);const ne=()=>{console.log("Images array:",r);const oe=r.map(se=>typeof se=="object"?se.url:se);if(oe.length===0){y({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Please upload at least one image"}});return}const pe={lng:u.lng,lat:u.lat,price:s.price,name:s.name,description:s.description,images:oe};console.log("Submitting station:",pe),rS.createStation(pe,m,y,n)};return _e.jsxs(cy,{sx:{my:4},children:[_e.jsx(n$,{alternativeLabel:!0,nonLinear:!0,activeStep:T,sx:{mb:3},children:I.map((oe,pe)=>_e.jsx(PU,{completed:oe.completed,children:_e.jsx(WU,{onClick:()=>i(pe),children:oe.label})},oe.label))}),_e.jsxs(Zo,{sx:{pb:7},children:[{0:_e.jsx(xH,{}),1:_e.jsx(mW,{}),2:_e.jsx(yH,{})}[T],_e.jsxs(_p,{direction:"row",sx:{pt:2,justifyContent:"space-around"},children:[_e.jsx(cd,{color:"inherit",disabled:!T,onClick:()=>i(oe=>oe-1),children:"Back"}),_e.jsx(cd,{disabled:te(),onClick:J,children:"Next"})]}),B&&_e.jsx(_p,{sx:{alignItems:"center"},children:_e.jsx(cd,{variant:"contained",endIcon:_e.jsx(Xw,{}),onClick:ne,children:"Submit"})})]})]})},wH=()=>{const{dispatch:n}=mo();return _e.jsx(cy,{sx:{py:5},children:_e.jsxs(YA,{severity:"error",variant:"outlined",children:[_e.jsx(dF,{children:"Forbidden Access"}),"Please login or register to access this page",_e.jsx(cd,{variant:"outlined",sx:{ml:2},startIcon:_e.jsx(LP,{}),onClick:()=>n({type:"OPEN_LOGIN"}),children:"login"})]})})},SH=({children:n})=>{const{state:{currentUser:r}}=mo();return r?n:_e.jsx(wH,{})},TH=()=>{const[n,r]=fe.useState(0),s=fe.useRef();return fe.useEffect(()=>{s.current.ownerDocument.body.scrollTop=0},[n]),_e.jsxs(Zo,{ref:s,children:[{0:_e.jsx(hW,{}),1:_e.jsx(pW,{}),2:_e.jsx(SH,{children:_e.jsx(bH,{setPage:r})})}[n],_e.jsx(xu,{elevation:3,sx:{position:"fixed",bottom:0,left:0,right:0,zIndex:2},children:_e.jsxs(dB,{showLabels:!0,value:n,onChange:(u,m)=>{r(m)},children:[_e.jsx(pb,{label:"Map",icon:_e.jsx(y$,{})}),_e.jsx(pb,{label:"Stations",icon:_e.jsx(g$,{})}),_e.jsx(pb,{label:"Add",icon:_e.jsx(u$,{})})]})})]})},EH=({stationId:n})=>{const[r,s]=fe.useState(""),[u,m]=fe.useState(0),{dispatch:y,state:{currentUser:T}}=mo(),i=async()=>{if(!(T!=null&&T.token)){y({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Please login to submit feedback"}});return}if(!r||!u){y({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:"Please provide both rating and feedback"}});return}console.log("Submitting feedback:",{stationId:n,feedback:r,rating:u});try{await rS.submitFeedback(n,{text:r,rating:u},T.token,y)&&(s(""),m(0))}catch(I){y({type:"UPDATE_ALERT",payload:{open:!0,severity:"error",message:I.message}})}finally{y({type:"STOP_LOADING"})}};return _e.jsxs(Zo,{sx:{mt:2,p:2,bgcolor:"background.paper",borderRadius:1},children:[_e.jsx(so,{variant:"h6",gutterBottom:!0,children:"Rate Your Experience"}),_e.jsx(kx,{value:u,onChange:(I,F)=>m(F),precision:.5,size:"large",sx:{mb:2}}),_e.jsx(Ff,{fullWidth:!0,multiline:!0,rows:3,value:r,onChange:I=>s(I.target.value),placeholder:"Share your experience with this charging station...",sx:{mb:2}}),_e.jsx(cd,{variant:"contained",onClick:i,disabled:!r||!u,children:"Submit Review"})]})},Rv=43200,eA=1440,tA=Symbol.for("constructDateFrom");function WR(n,r){return typeof n=="function"?n(r):n&&typeof n=="object"&&tA in n?n[tA](r):n instanceof Date?new n.constructor(r):new Date(r)}function Ep(n,r){return WR(n,n)}let CH={};function MH(){return CH}function nA(n){const r=Ep(n),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+n-+s}function dS(n,...r){const s=WR.bind(null,n||r.find(u=>typeof u=="object"));return r.map(s)}function Uv(n,r){const s=+Ep(n)-+Ep(r);return s<0?-1:s>0?1:s}function IH(n,r,s){const[u,m]=dS(s==null?void 0:s.in,n,r),y=u.getFullYear()-m.getFullYear(),T=u.getMonth()-m.getMonth();return y*12+T}function AH(n){return r=>{const u=(n?Math[n]:Math.trunc)(r);return u===0?0:u}}function PH(n,r){return+Ep(n)-+Ep(r)}function RH(n,r){const s=Ep(n);return s.setHours(23,59,59,999),s}function kH(n,r){const s=Ep(n),u=s.getMonth();return s.setFullYear(s.getFullYear(),u+1,0),s.setHours(23,59,59,999),s}function LH(n,r){const s=Ep(n);return+RH(s)==+kH(s)}function zH(n,r,s){const[u,m,y]=dS(s==null?void 0:s.in,n,n,r),T=Uv(m,y),i=Math.abs(IH(m,y));if(i<1)return 0;m.getMonth()===1&&m.getDate()>27&&m.setDate(30),m.setMonth(m.getMonth()-T*i);let I=Uv(m,y)===-T;LH(u)&&i===1&&Uv(u,y)===1&&(I=!1);const F=T*(i-+I);return F===0?0:F}function DH(n,r,s){const u=PH(n,r)/1e3;return AH(s==null?void 0:s.roundingMethod)(u)}const OH={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},FH=(n,r,s)=>{let u;const m=OH[n];return typeof m=="string"?u=m:r===1?u=m.one:u=m.other.replace("{{count}}",r.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+u:u+" ago":u};function b1(n){return(r={})=>{const s=r.width?String(r.width):n.defaultWidth;return n.formats[s]||n.formats[n.defaultWidth]}}const BH={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},NH={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jH={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},UH={date:b1({formats:BH,defaultWidth:"full"}),time:b1({formats:NH,defaultWidth:"full"}),dateTime:b1({formats:jH,defaultWidth:"full"})},$H={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},VH=(n,r,s,u)=>$H[n];function S_(n){return(r,s)=>{const u=s!=null&&s.context?String(s.context):"standalone";let m;if(u==="formatting"&&n.formattingValues){const T=n.defaultFormattingWidth||n.defaultWidth,i=s!=null&&s.width?String(s.width):T;m=n.formattingValues[i]||n.formattingValues[T]}else{const T=n.defaultWidth,i=s!=null&&s.width?String(s.width):n.defaultWidth;m=n.values[i]||n.values[T]}const y=n.argumentCallback?n.argumentCallback(r):r;return m[y]}}const GH={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},qH={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},WH={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},HH={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ZH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},XH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},YH=(n,r)=>{const s=Number(n),u=s%100;if(u>20||u<10)switch(u%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},KH={ordinalNumber:YH,era:S_({values:GH,defaultWidth:"wide"}),quarter:S_({values:qH,defaultWidth:"wide",argumentCallback:n=>n-1}),month:S_({values:WH,defaultWidth:"wide"}),day:S_({values:HH,defaultWidth:"wide"}),dayPeriod:S_({values:ZH,defaultWidth:"wide",formattingValues:XH,defaultFormattingWidth:"wide"})};function T_(n){return(r,s={})=>{const u=s.width,m=u&&n.matchPatterns[u]||n.matchPatterns[n.defaultMatchWidth],y=r.match(m);if(!y)return null;const T=y[0],i=u&&n.parsePatterns[u]||n.parsePatterns[n.defaultParseWidth],I=Array.isArray(i)?QH(i,G=>G.test(T)):JH(i,G=>G.test(T));let F;F=n.valueCallback?n.valueCallback(I):I,F=s.valueCallback?s.valueCallback(F):F;const B=r.slice(T.length);return{value:F,rest:B}}}function JH(n,r){for(const s in n)if(Object.prototype.hasOwnProperty.call(n,s)&&r(n[s]))return s}function QH(n,r){for(let s=0;s<n.length;s++)if(r(n[s]))return s}function e9(n){return(r,s={})=>{const u=r.match(n.matchPattern);if(!u)return null;const m=u[0],y=r.match(n.parsePattern);if(!y)return null;let T=n.valueCallback?n.valueCallback(y[0]):y[0];T=s.valueCallback?s.valueCallback(T):T;const i=r.slice(m.length);return{value:T,rest:i}}}const t9=/^(\d+)(th|st|nd|rd)?/i,n9=/\d+/i,r9={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},i9={any:[/^b/i,/^(a|c)/i]},o9={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},s9={any:[/1/i,/2/i,/3/i,/4/i]},a9={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},l9={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},c9={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},u9={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},d9={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},h9={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},p9={ordinalNumber:e9({matchPattern:t9,parsePattern:n9,valueCallback:n=>parseInt(n,10)}),era:T_({matchPatterns:r9,defaultMatchWidth:"wide",parsePatterns:i9,defaultParseWidth:"any"}),quarter:T_({matchPatterns:o9,defaultMatchWidth:"wide",parsePatterns:s9,defaultParseWidth:"any",valueCallback:n=>n+1}),month:T_({matchPatterns:a9,defaultMatchWidth:"wide",parsePatterns:l9,defaultParseWidth:"any"}),day:T_({matchPatterns:c9,defaultMatchWidth:"wide",parsePatterns:u9,defaultParseWidth:"any"}),dayPeriod:T_({matchPatterns:d9,defaultMatchWidth:"any",parsePatterns:h9,defaultParseWidth:"any"})},f9={code:"en-US",formatDistance:FH,formatLong:UH,formatRelative:VH,localize:KH,match:p9,options:{weekStartsOn:0,firstWeekContainsDate:1}};function m9(n,r,s){const u=MH(),m=(s==null?void 0:s.locale)??u.locale??f9,y=2520,T=Uv(n,r);if(isNaN(T))throw new RangeError("Invalid time value");const i=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:T}),[I,F]=dS(s==null?void 0:s.in,...T>0?[r,n]:[n,r]),B=DH(F,I),G=(nA(F)-nA(I))/1e3,J=Math.round((B-G)/60);let te;if(J<2)return s!=null&&s.includeSeconds?B<5?m.formatDistance("lessThanXSeconds",5,i):B<10?m.formatDistance("lessThanXSeconds",10,i):B<20?m.formatDistance("lessThanXSeconds",20,i):B<40?m.formatDistance("halfAMinute",0,i):B<60?m.formatDistance("lessThanXMinutes",1,i):m.formatDistance("xMinutes",1,i):J===0?m.formatDistance("lessThanXMinutes",1,i):m.formatDistance("xMinutes",J,i);if(J<45)return m.formatDistance("xMinutes",J,i);if(J<90)return m.formatDistance("aboutXHours",1,i);if(J<eA){const H=Math.round(J/60);return m.formatDistance("aboutXHours",H,i)}else{if(J<y)return m.formatDistance("xDays",1,i);if(J<Rv){const H=Math.round(J/eA);return m.formatDistance("xDays",H,i)}else if(J<Rv*2)return te=Math.round(J/Rv),m.formatDistance("aboutXMonths",te,i)}if(te=zH(F,I),te<12){const H=Math.round(J/Rv);return m.formatDistance("xMonths",H,i)}else{const H=te%12,j=Math.trunc(te/12);return H<3?m.formatDistance("aboutXYears",j,i):H<9?m.formatDistance("overXYears",j,i):m.formatDistance("almostXYears",j+1,i)}}const g9=({feedback:n=[]})=>_e.jsxs(Zo,{sx:{mt:3},children:[_e.jsxs(so,{variant:"h6",gutterBottom:!0,children:["User Reviews (",n.length,")"]}),n.map((r,s)=>_e.jsxs(Zo,{sx:{mb:2},children:[_e.jsxs(Zo,{sx:{display:"flex",alignItems:"center",mb:1},children:[_e.jsx(kx,{value:r.rating,readOnly:!0,precision:.5}),_e.jsx(so,{variant:"body2",sx:{ml:2,color:"text.secondary"},children:m9(new Date(r.createdAt),new Date,{addSuffix:!0})})]}),_e.jsx(so,{variant:"body1",sx:{mb:1},children:r.text}),_e.jsx(D5,{label:r.sentiment,color:r.sentiment==="positive"?"success":r.sentiment==="negative"?"error":"default",size:"small"}),s<n.length-1&&_e.jsx(U1,{sx:{my:2}})]},s)),n.length===0&&_e.jsx(so,{color:"text.secondary",children:"No reviews yet. Be the first to review this station!"})]}),_9=fe.forwardRef((n,r)=>_e.jsx(gP,{direction:"up",...n,ref:r})),y9=()=>{var y;const{state:{station:n},dispatch:r}=mo(),[s,u]=fe.useState(null);if(fe.useEffect(()=>{if(n){const T=`https://api.mapbox.com/geocoding/v5/mapbox.places/${n.lng},${n.lat}.json?access_token=pk.eyJ1IjoiemFja292ZXJsb2FkIiwiYSI6ImNtNmdqdDBqajAxcXcya3NhcHR1emg3cWkifQ.8XjrjoDMu-4xhqCXir6-_Q`;fetch(T).then(i=>i.json()).then(i=>{u(i.features[0])})}},[n]),!n)return null;const m=()=>{r({type:"UPDATE_STATION",payload:null})};return _e.jsxs(jw,{fullScreen:!0,open:!!n,onClose:m,slots:{transition:_9},children:[_e.jsx(KA,{position:"relative",children:_e.jsxs(V1,{children:[_e.jsx(so,{variant:"h6",component:"h3",sx:{ml:2,flex:1},children:n==null?void 0:n.name}),_e.jsx(fu,{color:"inherit",onClick:m,children:_e.jsx(Zw,{})})]})}),_e.jsxs(cy,{sx:{pt:5},children:[_e.jsxs(lS,{modules:[nW,RR,aW,iW],centeredSlides:!0,slidesPerView:2,grabCursor:!0,navigation:!0,autoplay:!0,lazy:"true",zoom:!0,effect:"coverflow",coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},children:[(y=n==null?void 0:n.images)==null?void 0:y.map((T,i)=>_e.jsx(cS,{children:_e.jsx("div",{className:"swiper-zoom-container",children:_e.jsx("img",{src:T,alt:`station-${i+1}`,style:{width:"100%",objectFit:"cover"}})})},`image-${i}`)),_e.jsx(Lx,{title:(n==null?void 0:n.uName)||"",sx:{position:"absolute",bottom:"8px",left:"8px",zIndex:2},children:_e.jsx(ug,{src:n==null?void 0:n.uPhoto})})]}),_e.jsxs(_p,{sx:{p:3},spacing:2,children:[_e.jsxs(_p,{direction:"row",sx:{justifyContent:"space-between",flexWrap:"wrap"},children:[_e.jsxs(Zo,{children:[_e.jsx(so,{variant:"h6",component:"span",children:"Price Per Unit:"}),_e.jsx(so,{component:"span",children:(n==null?void 0:n.price)===10?"Normal Charge Speed":"$"+(n==null?void 0:n.price)})]}),_e.jsxs(Zo,{sx:{display:"flex",alignItems:"center"},children:[_e.jsx(so,{variant:"h6",component:"span",children:"Ratings:"}),_e.jsx(kx,{name:"station-rating",defaultValue:3.5,precision:.5,emptyIcon:_e.jsx(zP,{})})]})]}),_e.jsxs(_p,{direction:"row",sx:{justifyContent:"space-between",flexWrap:"wrap"},children:[_e.jsxs(Zo,{children:[_e.jsx(so,{variant:"h6",component:"span",children:"Place Name:"}),_e.jsx(so,{component:"span",children:s==null?void 0:s.text})]}),_e.jsxs(Zo,{sx:{display:"flex",alignItems:"center"},children:[_e.jsx(so,{variant:"h6",component:"span",children:"Address:"}),_e.jsx(so,{component:"span",children:s==null?void 0:s.place_name})]})]}),_e.jsxs(_p,{children:[_e.jsx(so,{variant:"h6",component:"span",children:"Details:"}),_e.jsx(so,{component:"span",children:n==null?void 0:n.description})]}),_e.jsx(_p,{children:_e.jsxs(Zo,{sx:{mt:4},children:[_e.jsx(EH,{stationId:n._id}),_e.jsx(g9,{feedback:n.feedback})]})})]})]})]})},v9=()=>_e.jsxs(_e.Fragment,{children:[_e.jsx(H8,{}),_e.jsx(W8,{}),_e.jsx(O8,{}),_e.jsx(q8,{}),_e.jsx(TH,{}),_e.jsx(y9,{})]});P3.createRoot(document.getElementById("root")).render(_e.jsx(M$,{children:_e.jsx(v9,{})}));export{Uf as g};
